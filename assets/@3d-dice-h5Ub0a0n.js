const Md="modulepreload",gd=function(Z){return"/"+Z},Js={},xs=function(l,e,t){let a=Promise.resolve();if(e&&e.length>0){const s=document.getElementsByTagName("link");a=Promise.all(e.map(d=>{if(d=gd(d),d in Js)return;Js[d]=!0;const i=d.endsWith(".css"),c=i?'[rel="stylesheet"]':"";if(!!t)for(let m=s.length-1;m>=0;m--){const o=s[m];if(o.href===d&&(!i||o.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${c}`))return;const h=document.createElement("link");if(h.rel=i?"stylesheet":Md,i||(h.as="script",h.crossOrigin=""),h.href=d,document.head.appendChild(h),i)return new Promise((m,o)=>{h.addEventListener("load",m),h.addEventListener("error",()=>o(new Error(`Unable to preload CSS for ${d}`)))})}))}return a.then(()=>l()).catch(s=>{const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=s,window.dispatchEvent(d),!d.defaultPrevented)throw s})};var Cd=Object.defineProperty,vd=(Z,l,e)=>l in Z?Cd(Z,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):Z[l]=e,pt=(Z,l,e)=>(vd(Z,typeof l!="symbol"?l+"":l,e),e),os=(Z,l,e)=>{if(!l.has(Z))throw TypeError("Cannot "+e)},Ul=(Z,l,e)=>(os(Z,l,"read from private field"),e?e.call(Z):l.get(Z)),ae=(Z,l,e)=>{if(l.has(Z))throw TypeError("Cannot add the same private member more than once");l instanceof WeakSet?l.add(Z):l.set(Z,e)},Re=(Z,l,e,t)=>(os(Z,l,"write to private field"),t?t.call(Z,e):l.set(Z,e),e),xt=(Z,l,e,t)=>({set _(a){Re(Z,l,a,e)},get _(){return Ul(Z,l,t)}}),ct=(Z,l,e)=>(os(Z,l,"access private method"),e);function kd(Z){const{selector:l,id:e}=Z;if(!l||typeof l!="string")throw new Error("You must provide a DOM selector as the first argument in order to render the Dice Box");let t;const a=document.querySelector(l);if(!(a!=null&&a.nodeName))throw new Error(`DiceBox target DOM node: '${l}' not found or not available yet. Try invoking inside a DOMContentLoaded event`);return a.nodeName.toLowerCase()!=="canvas"?(t=document.createElement("canvas"),t.id=e,a.appendChild(t)):t=a,t}const ad="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHB0KHAsdCxtKXtyZXR1cm4gcCooMS1tKSt0Km19dmFyIFp0PXR5cGVvZiBkb2N1bWVudDwidSImJmRvY3VtZW50LmN1cnJlbnRTY3JpcHQ/ZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmM6dm9pZCAwO3R5cGVvZiBfX2ZpbGVuYW1lPCJ1IiYmKFp0PVp0fHxfX2ZpbGVuYW1lKTtmdW5jdGlvbiBnbChwKXtwPXB8fHt9O3ZhciB0O3R8fCh0PXR5cGVvZiBwPCJ1Ij9wOnt9KTt2YXIgbTt0LnJlYWR5PW5ldyBQcm9taXNlKGZ1bmN0aW9uKGUpe209ZX0pO3ZhciBkPXt9LGo7Zm9yKGogaW4gdCl0Lmhhc093blByb3BlcnR5KGopJiYoZFtqXT10W2pdKTt2YXIgVj0hMSxYPSExLFU9ITEsRz0hMTtWPXR5cGVvZiB3aW5kb3c9PSJvYmplY3QiLFg9dHlwZW9mIGltcG9ydFNjcmlwdHM9PSJmdW5jdGlvbiIsVT10eXBlb2YgcHJvY2Vzcz09Im9iamVjdCImJnR5cGVvZiBwcm9jZXNzLnZlcnNpb25zPT0ib2JqZWN0IiYmdHlwZW9mIHByb2Nlc3MudmVyc2lvbnMubm9kZT09InN0cmluZyIsRz0hViYmIVUmJiFYO3ZhciB2PSIiLFEsdHQsd3QsejtVPyh2PVg/cmVxdWlyZSgicGF0aCIpLmRpcm5hbWUodikrIi8iOl9fZGlybmFtZSsiLyIsUT1mdW5jdGlvbihlLG8pe3JldHVybiB3dHx8KHd0PXJlcXVpcmUoImZzIikpLHp8fCh6PXJlcXVpcmUoInBhdGgiKSksZT16Lm5vcm1hbGl6ZShlKSx3dC5yZWFkRmlsZVN5bmMoZSxvP251bGw6InV0ZjgiKX0sdHQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9UShlLCEwKSxlLmJ1ZmZlcnx8KGU9bmV3IFVpbnQ4QXJyYXkoZSkpLEx0KGUuYnVmZmVyKSxlfSwxPHByb2Nlc3MuYXJndi5sZW5ndGgmJnByb2Nlc3MuYXJndlsxXS5yZXBsYWNlKC9cXC9nLCIvIikscHJvY2Vzcy5hcmd2LnNsaWNlKDIpLHByb2Nlc3Mub24oInVuY2F1Z2h0RXhjZXB0aW9uIixmdW5jdGlvbihlKXt0aHJvdyBlfSkscHJvY2Vzcy5vbigidW5oYW5kbGVkUmVqZWN0aW9uIixHdCksdC5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIltFbXNjcmlwdGVuIE1vZHVsZSBvYmplY3RdIn0pOkc/KHR5cGVvZiByZWFkPCJ1IiYmKFE9ZnVuY3Rpb24oZSl7cmV0dXJuIHJlYWQoZSl9KSx0dD1mdW5jdGlvbihlKXtyZXR1cm4gdHlwZW9mIHJlYWRidWZmZXI9PSJmdW5jdGlvbiI/bmV3IFVpbnQ4QXJyYXkocmVhZGJ1ZmZlcihlKSk6KGU9cmVhZChlLCJiaW5hcnkiKSxMdCh0eXBlb2YgZT09Im9iamVjdCIpLGUpfSx0eXBlb2YgcHJpbnQ8InUiJiYodHlwZW9mIGNvbnNvbGU+InUiJiYoY29uc29sZT17fSksY29uc29sZS5sb2c9cHJpbnQsY29uc29sZS53YXJuPWNvbnNvbGUuZXJyb3I9dHlwZW9mIHByaW50RXJyPCJ1Ij9wcmludEVycjpwcmludCkpOihWfHxYKSYmKFg/dj1zZWxmLmxvY2F0aW9uLmhyZWY6ZG9jdW1lbnQuY3VycmVudFNjcmlwdCYmKHY9ZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmMpLFp0JiYodj1adCksdj12LmluZGV4T2YoImJsb2I6IikhPT0wP3Yuc3Vic3RyKDAsdi5sYXN0SW5kZXhPZigiLyIpKzEpOiIiLFE9ZnVuY3Rpb24oZSl7dmFyIG89bmV3IFhNTEh0dHBSZXF1ZXN0O3JldHVybiBvLm9wZW4oIkdFVCIsZSwhMSksby5zZW5kKG51bGwpLG8ucmVzcG9uc2VUZXh0fSxYJiYodHQ9ZnVuY3Rpb24oZSl7dmFyIG89bmV3IFhNTEh0dHBSZXF1ZXN0O3JldHVybiBvLm9wZW4oIkdFVCIsZSwhMSksby5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIixvLnNlbmQobnVsbCksbmV3IFVpbnQ4QXJyYXkoby5yZXNwb25zZSl9KSk7dmFyIHp0PXQucHJpbnR8fGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSksT3Q9dC5wcmludEVycnx8Y29uc29sZS53YXJuLmJpbmQoY29uc29sZSk7Zm9yKGogaW4gZClkLmhhc093blByb3BlcnR5KGopJiYodFtqXT1kW2pdKTtkPW51bGw7dmFyIGVlPVtdLEJ0LGZ0O3Qud2FzbUJpbmFyeSYmKGZ0PXQud2FzbUJpbmFyeSksdC5ub0V4aXRSdW50aW1lJiZ0Lm5vRXhpdFJ1bnRpbWUsdHlwZW9mIFdlYkFzc2VtYmx5IT0ib2JqZWN0IiYmT3QoIm5vIG5hdGl2ZSB3YXNtIHN1cHBvcnQgZGV0ZWN0ZWQiKTt2YXIga3QsV3Q9bmV3IFdlYkFzc2VtYmx5LlRhYmxlKHtpbml0aWFsOjQ3NSxlbGVtZW50OiJhbnlmdW5jIn0pLG9lPSExO2Z1bmN0aW9uIEx0KGUsbyl7ZXx8R3QoIkFzc2VydGlvbiBmYWlsZWQ6ICIrbyl9dmFyIEN0LEh0LFl0LFh0LG5lLFB0PXQuSU5JVElBTF9NRU1PUll8fDY3MTA4ODY0OyhrdD10Lndhc21NZW1vcnk/dC53YXNtTWVtb3J5Om5ldyBXZWJBc3NlbWJseS5NZW1vcnkoe2luaXRpYWw6UHQvNjU1MzYsbWF4aW11bTpQdC82NTUzNn0pKSYmKEN0PWt0LmJ1ZmZlciksUHQ9Q3QuYnl0ZUxlbmd0aDt2YXIgZXQ9Q3Q7Q3Q9ZXQsdC5IRUFQOD1uZXcgSW50OEFycmF5KGV0KSx0LkhFQVAxNj1uZXcgSW50MTZBcnJheShldCksdC5IRUFQMzI9WXQ9bmV3IEludDMyQXJyYXkoZXQpLHQuSEVBUFU4PUh0PW5ldyBVaW50OEFycmF5KGV0KSx0LkhFQVBVMTY9bmV3IFVpbnQxNkFycmF5KGV0KSx0LkhFQVBVMzI9bmV3IFVpbnQzMkFycmF5KGV0KSx0LkhFQVBGMzI9WHQ9bmV3IEZsb2F0MzJBcnJheShldCksdC5IRUFQRjY0PW5lPW5ldyBGbG9hdDY0QXJyYXkoZXQpLFl0WzQ0OTJdPTUyNjEwMDg7ZnVuY3Rpb24gVXQoZSl7Zm9yKDswPGUubGVuZ3RoOyl7dmFyIG89ZS5zaGlmdCgpO2lmKHR5cGVvZiBvPT0iZnVuY3Rpb24iKW8odCk7ZWxzZXt2YXIgbj1vLmhpO3R5cGVvZiBuPT0ibnVtYmVyIj9vLmNpPT09dm9pZCAwP3QuZHluQ2FsbF92KG4pOnQuZHluQ2FsbF92aShuLG8uY2kpOm4oby5jaT09PXZvaWQgMD9udWxsOm8uY2kpfX19dmFyIHJlPVtdLF9lPVtdLFZ0PVtdLEllPVtdLE9lPSExO2Z1bmN0aW9uIE9sKCl7dmFyIGU9dC5wcmVSdW4uc2hpZnQoKTtyZS51bnNoaWZ0KGUpfXZhciBRdD0wLHF0PW51bGw7dC5wcmVsb2FkZWRJbWFnZXM9e30sdC5wcmVsb2FkZWRBdWRpb3M9e307ZnVuY3Rpb24gR3QoZSl7dGhyb3cgdC5vbkFib3J0JiZ0Lm9uQWJvcnQoZSksZSs9IiIsenQoZSksT3QoZSksb2U9ITAsbmV3IFdlYkFzc2VtYmx5LlJ1bnRpbWVFcnJvcigiYWJvcnQoIitlKyIpLiBCdWlsZCB3aXRoIC1zIEFTU0VSVElPTlM9MSBmb3IgbW9yZSBpbmZvLiIpfWZ1bmN0aW9uIGdlKGUpe3ZhciBvPXh0O3JldHVybiBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGg/by5zdGFydHNXaXRoKGUpOm8uaW5kZXhPZihlKT09PTB9ZnVuY3Rpb24gQmUoKXtyZXR1cm4gZ2UoImRhdGE6YXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtO2Jhc2U2NCwiKX12YXIgeHQ9ImFtbW8ud2FzbS53YXNtIjtpZighQmUoKSl7dmFyIFBlPXh0O3h0PXQubG9jYXRlRmlsZT90LmxvY2F0ZUZpbGUoUGUsdik6ditQZX1mdW5jdGlvbiB4ZSgpe3RyeXtpZihmdClyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoZnQpO2lmKHR0KXJldHVybiB0dCh4dCk7dGhyb3ciYm90aCBhc3luYyBhbmQgc3luYyBmZXRjaGluZyBvZiB0aGUgd2FzbSBmYWlsZWQifWNhdGNoKGUpe0d0KGUpfX1mdW5jdGlvbiBCbCgpe3JldHVybiBmdHx8IVYmJiFYfHx0eXBlb2YgZmV0Y2ghPSJmdW5jdGlvbiJ8fGdlKCJmaWxlOi8vIik/bmV3IFByb21pc2UoZnVuY3Rpb24oZSl7ZSh4ZSgpKX0pOmZldGNoKHh0LHtjcmVkZW50aWFsczoic2FtZS1vcmlnaW4ifSkudGhlbihmdW5jdGlvbihlKXtpZighZS5vayl0aHJvdyJmYWlsZWQgdG8gbG9hZCB3YXNtIGJpbmFyeSBmaWxlIGF0ICciK3h0KyInIjtyZXR1cm4gZS5hcnJheUJ1ZmZlcigpfSkuY2F0Y2goZnVuY3Rpb24oKXtyZXR1cm4geGUoKX0pfXZhciBQbD17MTM3NjpmdW5jdGlvbihlLG8sbixyLGMsRCxOLHl0KXtpZihlPXQuZ2V0Q2FjaGUodC5Db25jcmV0ZUNvbnRhY3RSZXN1bHRDYWxsYmFjaylbZV0sIWUuaGFzT3duUHJvcGVydHkoImFkZFNpbmdsZVJlc3VsdCIpKXRocm93ImEgSlNJbXBsZW1lbnRhdGlvbiBtdXN0IGltcGxlbWVudCBhbGwgZnVuY3Rpb25zLCB5b3UgZm9yZ290IENvbmNyZXRlQ29udGFjdFJlc3VsdENhbGxiYWNrOjphZGRTaW5nbGVSZXN1bHQuIjtyZXR1cm4gZS5hZGRTaW5nbGVSZXN1bHQobyxuLHIsYyxELE4seXQpfX07X2UucHVzaCh7aGk6ZnVuY3Rpb24oKXtUZSgpfX0pO3ZhciBkZT1bXSx4bD17ZTpmdW5jdGlvbigpe0d0KCl9LGI6ZnVuY3Rpb24oZSxvLG4pe2RlLmxlbmd0aD0wO3ZhciByO2ZvcihuPj49MjtyPUh0W28rK107KWRlLnB1c2goMTA1PnI/bmVbKytuPj4xXTpZdFtuXSksKytuO3JldHVybiBQbFtlXS5hcHBseShudWxsLGRlKX0sYzpmdW5jdGlvbihlLG8sbil7SHQuY29weVdpdGhpbihlLG8sbytuKX0sZDpmdW5jdGlvbigpe0d0KCJPT00iKX0sYTpmdW5jdGlvbihlKXt2YXIgbz1EYXRlLm5vdygpO3JldHVybiBZdFtlPj4yXT1vLzFlM3wwLFl0W2UrND4+Ml09byUxZTMqMWUzfDAsMH0sbWVtb3J5Omt0LHRhYmxlOld0fTsoZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGMpe3QuYXNtPWMuZXhwb3J0cyxRdC0tLHQubW9uaXRvclJ1bkRlcGVuZGVuY2llcyYmdC5tb25pdG9yUnVuRGVwZW5kZW5jaWVzKFF0KSxRdD09MCYmcXQmJihjPXF0LHF0PW51bGwsYygpKX1mdW5jdGlvbiBvKGMpe2UoYy5pbnN0YW5jZSl9ZnVuY3Rpb24gbihjKXtyZXR1cm4gQmwoKS50aGVuKGZ1bmN0aW9uKEQpe3JldHVybiBXZWJBc3NlbWJseS5pbnN0YW50aWF0ZShELHIpfSkudGhlbihjLGZ1bmN0aW9uKEQpe090KCJmYWlsZWQgdG8gYXN5bmNocm9ub3VzbHkgcHJlcGFyZSB3YXNtOiAiK0QpLEd0KEQpfSkuY2F0Y2goRD0+e2NvbnNvbGUuZXJyb3IoImVycm9yIixEKSxjb25zb2xlLmVycm9yKGBBbW1vIGZpbGUgJyR7eHR9JyBub3QgZm91bmQuIFRoaXMgaXMgcmVxdWlyZWQgdG8gcnVuIHRoZSBwaHlzaWNzIHNpbXVsYXRpb24uIElzIHlvdXIgJ2Fzc2V0UGF0aCcgY29uZmlnIG9wdGlvbiBjb3JyZWN0IGFuZCBpcyB0aGVyZSBhbiAnYW1tbycgZm9sZGVyIHdpdGggdGhlICdhbW1vLndhc20ud2FzbScgZmlsZT8gRW5zdXJlIHlvdXIgc2VydmVyIGhhcyB0aGUgcHJvcGVyIG1pbWUgdHlwZSBmb3IgJy53YXNtJyBmaWxlcy5gKX0pfXZhciByPXthOnhsfTtpZihRdCsrLHQubW9uaXRvclJ1bkRlcGVuZGVuY2llcyYmdC5tb25pdG9yUnVuRGVwZW5kZW5jaWVzKFF0KSx0Lmluc3RhbnRpYXRlV2FzbSl0cnl7cmV0dXJuIHQuaW5zdGFudGlhdGVXYXNtKHIsZSl9Y2F0Y2goYyl7cmV0dXJuIE90KCJNb2R1bGUuaW5zdGFudGlhdGVXYXNtIGNhbGxiYWNrIGZhaWxlZCB3aXRoIGVycm9yOiAiK2MpLCExfXJldHVybiBmdW5jdGlvbigpe2lmKGZ0fHx0eXBlb2YgV2ViQXNzZW1ibHkuaW5zdGFudGlhdGVTdHJlYW1pbmchPSJmdW5jdGlvbiJ8fEJlKCl8fGdlKCJmaWxlOi8vIil8fHR5cGVvZiBmZXRjaCE9ImZ1bmN0aW9uIilyZXR1cm4gbihvKTtmZXRjaCh4dCx7Y3JlZGVudGlhbHM6InNhbWUtb3JpZ2luIn0pLnRoZW4oZnVuY3Rpb24oYyl7cmV0dXJuIFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlU3RyZWFtaW5nKGMscikudGhlbihvLGZ1bmN0aW9uKEQpe3JldHVybiBPdCgid2FzbSBzdHJlYW1pbmcgY29tcGlsZSBmYWlsZWQ6ICIrRCksT3QoImZhbGxpbmcgYmFjayB0byBBcnJheUJ1ZmZlciBpbnN0YW50aWF0aW9uIiksbihvKX0pfSl9KCkse319KSgpO3ZhciBUZT10Ll9fX3dhc21fY2FsbF9jdG9ycz1mdW5jdGlvbigpe3JldHVybihUZT10Ll9fX3dhc21fY2FsbF9jdG9ycz10LmFzbS5mKS5hcHBseShudWxsLGFyZ3VtZW50cyl9O3QuX19fZW1fanNfX2FycmF5X2JvdW5kc19jaGVja19lcnJvcj1mdW5jdGlvbigpe3JldHVybih0Ll9fX2VtX2pzX19hcnJheV9ib3VuZHNfY2hlY2tfZXJyb3I9dC5hc20uZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfTt2YXIgRmU9dC5fZWJfYnRDb2xsaXNpb25Xb3JsZF9nZXREaXNwYXRjaGVyXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRmU9dC5fZWJfYnRDb2xsaXNpb25Xb3JsZF9nZXREaXNwYXRjaGVyXzA9dC5hc20uaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2dldFBhaXJDYWNoZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKE1lPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfZ2V0UGFpckNhY2hlXzA9dC5hc20uaSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxBZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2dldERpc3BhdGNoSW5mb18wPWZ1bmN0aW9uKCl7cmV0dXJuKEFlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfZ2V0RGlzcGF0Y2hJbmZvXzA9dC5hc20uaikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx3ZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2FkZENvbGxpc2lvbk9iamVjdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKHdlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20uaykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxrZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2FkZENvbGxpc2lvbk9iamVjdF8yPWZ1bmN0aW9uKCl7cmV0dXJuKGtlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzI9dC5hc20ubCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxMZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2FkZENvbGxpc2lvbk9iamVjdF8zPWZ1bmN0aW9uKCl7cmV0dXJuKExlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzM9dC5hc20ubSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxIZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX3JlbW92ZUNvbGxpc2lvbk9iamVjdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKEhlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfcmVtb3ZlQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20ubikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxZZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2dldEJyb2FkcGhhc2VfMD1mdW5jdGlvbigpe3JldHVybihZZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2dldEJyb2FkcGhhc2VfMD10LmFzbS5vKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFZlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfY29udmV4U3dlZXBUZXN0XzU9ZnVuY3Rpb24oKXtyZXR1cm4oVmU9dC5fZWJfYnRDb2xsaXNpb25Xb3JsZF9jb252ZXhTd2VlcFRlc3RfNT10LmFzbS5wKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfY29udGFjdFBhaXJUZXN0XzM9ZnVuY3Rpb24oKXtyZXR1cm4oUWU9dC5fZWJfYnRDb2xsaXNpb25Xb3JsZF9jb250YWN0UGFpclRlc3RfMz10LmFzbS5xKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEVlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfY29udGFjdFRlc3RfMj1mdW5jdGlvbigpe3JldHVybihFZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2NvbnRhY3RUZXN0XzI9dC5hc20ucikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxYZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX3VwZGF0ZVNpbmdsZUFhYmJfMT1mdW5jdGlvbigpe3JldHVybihYZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX3VwZGF0ZVNpbmdsZUFhYmJfMT10LmFzbS5zKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFVlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihVZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX19fZGVzdHJveV9fXzA9dC5hc20udCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHZT10Ll9lYl9idFF1YWRXb3JkX3hfMD1mdW5jdGlvbigpe3JldHVybihHZT10Ll9lYl9idFF1YWRXb3JkX3hfMD10LmFzbS51KS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE5lPXQuX2ViX2J0UXVhZFdvcmRfeV8wPWZ1bmN0aW9uKCl7cmV0dXJuKE5lPXQuX2ViX2J0UXVhZFdvcmRfeV8wPXQuYXNtLnYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0semU9dC5fZWJfYnRRdWFkV29yZF96XzA9ZnVuY3Rpb24oKXtyZXR1cm4oemU9dC5fZWJfYnRRdWFkV29yZF96XzA9dC5hc20udykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxZT10Ll9lYl9idFF1YWRXb3JkX3dfMD1mdW5jdGlvbigpe3JldHVybihxZT10Ll9lYl9idFF1YWRXb3JkX3dfMD10LmFzbS54KS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFplPXQuX2ViX2J0UXVhZFdvcmRfc2V0WF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFplPXQuX2ViX2J0UXVhZFdvcmRfc2V0WF8xPXQuYXNtLnkpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sS2U9dC5fZWJfYnRRdWFkV29yZF9zZXRZXzE9ZnVuY3Rpb24oKXtyZXR1cm4oS2U9dC5fZWJfYnRRdWFkV29yZF9zZXRZXzE9dC5hc20ueikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSwkZT10Ll9lYl9idFF1YWRXb3JkX3NldFpfMT1mdW5jdGlvbigpe3JldHVybigkZT10Ll9lYl9idFF1YWRXb3JkX3NldFpfMT10LmFzbS5BKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEplPXQuX2ViX2J0UXVhZFdvcmRfc2V0V18xPWZ1bmN0aW9uKCl7cmV0dXJuKEplPXQuX2ViX2J0UXVhZFdvcmRfc2V0V18xPXQuYXNtLkIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdG89dC5fZWJfYnRRdWFkV29yZF9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKHRvPXQuX2ViX2J0UXVhZFdvcmRfX19kZXN0cm95X19fMD10LmFzbS5DKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGVvPXQuX2ViX2J0TW90aW9uU3RhdGVfZ2V0V29ybGRUcmFuc2Zvcm1fMT1mdW5jdGlvbigpe3JldHVybihlbz10Ll9lYl9idE1vdGlvblN0YXRlX2dldFdvcmxkVHJhbnNmb3JtXzE9dC5hc20uRCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvbz10Ll9lYl9idE1vdGlvblN0YXRlX3NldFdvcmxkVHJhbnNmb3JtXzE9ZnVuY3Rpb24oKXtyZXR1cm4ob289dC5fZWJfYnRNb3Rpb25TdGF0ZV9zZXRXb3JsZFRyYW5zZm9ybV8xPXQuYXNtLkUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbm89dC5fZWJfYnRNb3Rpb25TdGF0ZV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKG5vPXQuX2ViX2J0TW90aW9uU3RhdGVfX19kZXN0cm95X19fMD10LmFzbS5GKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHJvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldEFuaXNvdHJvcGljRnJpY3Rpb25fMj1mdW5jdGlvbigpe3JldHVybihybz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRBbmlzb3Ryb3BpY0ZyaWN0aW9uXzI9dC5hc20uRykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxfbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRDb2xsaXNpb25TaGFwZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKF9vPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldENvbGxpc2lvblNoYXBlXzA9dC5hc20uSCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxpbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRDb250YWN0UHJvY2Vzc2luZ1RocmVzaG9sZF8xPWZ1bmN0aW9uKCl7cmV0dXJuKGlvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldENvbnRhY3RQcm9jZXNzaW5nVGhyZXNob2xkXzE9dC5hc20uSSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxhbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRBY3RpdmF0aW9uU3RhdGVfMT1mdW5jdGlvbigpe3JldHVybihhbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRBY3RpdmF0aW9uU3RhdGVfMT10LmFzbS5KKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHNvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2ZvcmNlQWN0aXZhdGlvblN0YXRlXzE9ZnVuY3Rpb24oKXtyZXR1cm4oc289dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfZm9yY2VBY3RpdmF0aW9uU3RhdGVfMT10LmFzbS5LKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHBvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2FjdGl2YXRlXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocG89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfYWN0aXZhdGVfMD10LmFzbS5MKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGxvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2FjdGl2YXRlXzE9ZnVuY3Rpb24oKXtyZXR1cm4obG89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfYWN0aXZhdGVfMT10LmFzbS5NKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHVvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2lzQWN0aXZlXzA9ZnVuY3Rpb24oKXtyZXR1cm4odW89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfaXNBY3RpdmVfMD10LmFzbS5OKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGNvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2lzS2luZW1hdGljT2JqZWN0XzA9ZnVuY3Rpb24oKXtyZXR1cm4oY289dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfaXNLaW5lbWF0aWNPYmplY3RfMD10LmFzbS5PKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2lzU3RhdGljT2JqZWN0XzA9ZnVuY3Rpb24oKXtyZXR1cm4oeW89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfaXNTdGF0aWNPYmplY3RfMD10LmFzbS5QKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGhvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2lzU3RhdGljT3JLaW5lbWF0aWNPYmplY3RfMD1mdW5jdGlvbigpe3JldHVybihobz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9pc1N0YXRpY09yS2luZW1hdGljT2JqZWN0XzA9dC5hc20uUSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxmbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRSZXN0aXR1dGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKGZvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldFJlc3RpdHV0aW9uXzA9dC5hc20uUikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxtbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRGcmljdGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKG1vPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldEZyaWN0aW9uXzA9dC5hc20uUykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxibz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRSb2xsaW5nRnJpY3Rpb25fMD1mdW5jdGlvbigpe3JldHVybihibz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRSb2xsaW5nRnJpY3Rpb25fMD10LmFzbS5UKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGdvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFJlc3RpdHV0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oZ289dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0UmVzdGl0dXRpb25fMT10LmFzbS5VKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFdvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldEZyaWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oV289dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0RnJpY3Rpb25fMT10LmFzbS5WKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LENvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFJvbGxpbmdGcmljdGlvbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKENvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFJvbGxpbmdGcmljdGlvbl8xPXQuYXNtLlcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sam89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfZ2V0V29ybGRUcmFuc2Zvcm1fMD1mdW5jdGlvbigpe3JldHVybihqbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRXb3JsZFRyYW5zZm9ybV8wPXQuYXNtLlgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdm89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfZ2V0Q29sbGlzaW9uRmxhZ3NfMD1mdW5jdGlvbigpe3JldHVybih2bz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRDb2xsaXNpb25GbGFnc18wPXQuYXNtLlkpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRG89dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0Q29sbGlzaW9uRmxhZ3NfMT1mdW5jdGlvbigpe3JldHVybihEbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRDb2xsaXNpb25GbGFnc18xPXQuYXNtLlopLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sUm89dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0V29ybGRUcmFuc2Zvcm1fMT1mdW5jdGlvbigpe3JldHVybihSbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRXb3JsZFRyYW5zZm9ybV8xPXQuYXNtLl8pLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sU289dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0Q29sbGlzaW9uU2hhcGVfMT1mdW5jdGlvbigpe3JldHVybihTbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRDb2xsaXNpb25TaGFwZV8xPXQuYXNtLiQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSW89dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0Q2NkTW90aW9uVGhyZXNob2xkXzE9ZnVuY3Rpb24oKXtyZXR1cm4oSW89dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0Q2NkTW90aW9uVGhyZXNob2xkXzE9dC5hc20uYWEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sT289dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0Q2NkU3dlcHRTcGhlcmVSYWRpdXNfMT1mdW5jdGlvbigpe3JldHVybihPbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRDY2RTd2VwdFNwaGVyZVJhZGl1c18xPXQuYXNtLmJhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEJvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldFVzZXJJbmRleF8wPWZ1bmN0aW9uKCl7cmV0dXJuKEJvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldFVzZXJJbmRleF8wPXQuYXNtLmNhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFBvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFVzZXJJbmRleF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFBvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFVzZXJJbmRleF8xPXQuYXNtLmRhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHhvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldFVzZXJQb2ludGVyXzA9ZnVuY3Rpb24oKXtyZXR1cm4oeG89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfZ2V0VXNlclBvaW50ZXJfMD10LmFzbS5lYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxUbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRVc2VyUG9pbnRlcl8xPWZ1bmN0aW9uKCl7cmV0dXJuKFRvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFVzZXJQb2ludGVyXzE9dC5hc20uZmEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRm89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfZ2V0QnJvYWRwaGFzZUhhbmRsZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKEZvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldEJyb2FkcGhhc2VIYW5kbGVfMD10LmFzbS5nYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKE1vPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X19fZGVzdHJveV9fXzA9dC5hc20uaGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQW89dC5fZWJfQ29udGFjdFJlc3VsdENhbGxiYWNrX2FkZFNpbmdsZVJlc3VsdF83PWZ1bmN0aW9uKCl7cmV0dXJuKEFvPXQuX2ViX0NvbnRhY3RSZXN1bHRDYWxsYmFja19hZGRTaW5nbGVSZXN1bHRfNz10LmFzbS5pYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx3bz10Ll9lYl9Db250YWN0UmVzdWx0Q2FsbGJhY2tfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybih3bz10Ll9lYl9Db250YWN0UmVzdWx0Q2FsbGJhY2tfX19kZXN0cm95X19fMD10LmFzbS5qYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxrbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19oYXNIaXRfMD1mdW5jdGlvbigpe3JldHVybihrbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19oYXNIaXRfMD10LmFzbS5rYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxMbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8wPWZ1bmN0aW9uKCl7cmV0dXJuKExvPXQuX2ViX0NvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2NvbGxpc2lvbkZpbHRlckdyb3VwXzA9dC5hc20ubGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSG89dC5fZWJfQ29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21fY29sbGlzaW9uRmlsdGVyR3JvdXBfMT1mdW5jdGlvbigpe3JldHVybihIbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8xPXQuYXNtLm1hKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFlvPXQuX2ViX0NvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2NvbGxpc2lvbkZpbHRlck1hc2tfMD1mdW5jdGlvbigpe3JldHVybihZbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jb2xsaXNpb25GaWx0ZXJNYXNrXzA9dC5hc20ubmEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVm89dC5fZWJfQ29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21fY29sbGlzaW9uRmlsdGVyTWFza18xPWZ1bmN0aW9uKCl7cmV0dXJuKFZvPXQuX2ViX0NvbnZleFJlc3VsdENhbGxiYWNrX3NldF9tX2NvbGxpc2lvbkZpbHRlck1hc2tfMT10LmFzbS5vYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxRbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb25fMD1mdW5jdGlvbigpe3JldHVybihRbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb25fMD10LmFzbS5wYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxFbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb25fMT1mdW5jdGlvbigpe3JldHVybihFbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb25fMT10LmFzbS5xYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxYbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKFhvPXQuX2ViX0NvbnZleFJlc3VsdENhbGxiYWNrX19fZGVzdHJveV9fXzA9dC5hc20ucmEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVW89dC5fZWJfYnRDb2xsaXNpb25TaGFwZV9zZXRMb2NhbFNjYWxpbmdfMT1mdW5jdGlvbigpe3JldHVybihVbz10Ll9lYl9idENvbGxpc2lvblNoYXBlX3NldExvY2FsU2NhbGluZ18xPXQuYXNtLnNhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEdvPXQuX2ViX2J0Q29sbGlzaW9uU2hhcGVfZ2V0TG9jYWxTY2FsaW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oR289dC5fZWJfYnRDb2xsaXNpb25TaGFwZV9nZXRMb2NhbFNjYWxpbmdfMD10LmFzbS50YSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxObz10Ll9lYl9idENvbGxpc2lvblNoYXBlX2NhbGN1bGF0ZUxvY2FsSW5lcnRpYV8yPWZ1bmN0aW9uKCl7cmV0dXJuKE5vPXQuX2ViX2J0Q29sbGlzaW9uU2hhcGVfY2FsY3VsYXRlTG9jYWxJbmVydGlhXzI9dC5hc20udWEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sem89dC5fZWJfYnRDb2xsaXNpb25TaGFwZV9zZXRNYXJnaW5fMT1mdW5jdGlvbigpe3JldHVybih6bz10Ll9lYl9idENvbGxpc2lvblNoYXBlX3NldE1hcmdpbl8xPXQuYXNtLnZhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHFvPXQuX2ViX2J0Q29sbGlzaW9uU2hhcGVfZ2V0TWFyZ2luXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocW89dC5fZWJfYnRDb2xsaXNpb25TaGFwZV9nZXRNYXJnaW5fMD10LmFzbS53YSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxabz10Ll9lYl9idENvbGxpc2lvblNoYXBlX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oWm89dC5fZWJfYnRDb2xsaXNpb25TaGFwZV9fX2Rlc3Ryb3lfX18wPXQuYXNtLnhhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEtvPXQuX2ViX2J0RGlzcGF0Y2hlcl9nZXROdW1NYW5pZm9sZHNfMD1mdW5jdGlvbigpe3JldHVybihLbz10Ll9lYl9idERpc3BhdGNoZXJfZ2V0TnVtTWFuaWZvbGRzXzA9dC5hc20ueWEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sJG89dC5fZWJfYnREaXNwYXRjaGVyX2dldE1hbmlmb2xkQnlJbmRleEludGVybmFsXzE9ZnVuY3Rpb24oKXtyZXR1cm4oJG89dC5fZWJfYnREaXNwYXRjaGVyX2dldE1hbmlmb2xkQnlJbmRleEludGVybmFsXzE9dC5hc20uemEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSm89dC5fZWJfYnREaXNwYXRjaGVyX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oSm89dC5fZWJfYnREaXNwYXRjaGVyX19fZGVzdHJveV9fXzA9dC5hc20uQWEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdG49dC5fZWJfYnREeW5hbWljc1dvcmxkX2FkZEFjdGlvbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKHRuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9hZGRBY3Rpb25fMT10LmFzbS5CYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlbj10Ll9lYl9idER5bmFtaWNzV29ybGRfcmVtb3ZlQWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oZW49dC5fZWJfYnREeW5hbWljc1dvcmxkX3JlbW92ZUFjdGlvbl8xPXQuYXNtLkNhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG9uPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9nZXRTb2x2ZXJJbmZvXzA9ZnVuY3Rpb24oKXtyZXR1cm4ob249dC5fZWJfYnREeW5hbWljc1dvcmxkX2dldFNvbHZlckluZm9fMD10LmFzbS5EYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxubj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMT1mdW5jdGlvbigpe3JldHVybihubj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMT10LmFzbS5FYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxybj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMj1mdW5jdGlvbigpe3JldHVybihybj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMj10LmFzbS5GYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxfbj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMz1mdW5jdGlvbigpe3JldHVybihfbj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMz10LmFzbS5HYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxhbj10Ll9lYl9idER5bmFtaWNzV29ybGRfZ2V0RGlzcGF0Y2hlcl8wPWZ1bmN0aW9uKCl7cmV0dXJuKGFuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9nZXREaXNwYXRjaGVyXzA9dC5hc20uSGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sc249dC5fZWJfYnREeW5hbWljc1dvcmxkX2dldFBhaXJDYWNoZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKHNuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9nZXRQYWlyQ2FjaGVfMD10LmFzbS5JYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxwbj10Ll9lYl9idER5bmFtaWNzV29ybGRfZ2V0RGlzcGF0Y2hJbmZvXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocG49dC5fZWJfYnREeW5hbWljc1dvcmxkX2dldERpc3BhdGNoSW5mb18wPXQuYXNtLkphKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGxuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9hZGRDb2xsaXNpb25PYmplY3RfMT1mdW5jdGlvbigpe3JldHVybihsbj10Ll9lYl9idER5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20uS2EpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdW49dC5fZWJfYnREeW5hbWljc1dvcmxkX2FkZENvbGxpc2lvbk9iamVjdF8yPWZ1bmN0aW9uKCl7cmV0dXJuKHVuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9hZGRDb2xsaXNpb25PYmplY3RfMj10LmFzbS5MYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxjbj10Ll9lYl9idER5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzM9ZnVuY3Rpb24oKXtyZXR1cm4oY249dC5fZWJfYnREeW5hbWljc1dvcmxkX2FkZENvbGxpc2lvbk9iamVjdF8zPXQuYXNtLk1hKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHluPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9yZW1vdmVDb2xsaXNpb25PYmplY3RfMT1mdW5jdGlvbigpe3JldHVybih5bj10Ll9lYl9idER5bmFtaWNzV29ybGRfcmVtb3ZlQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20uTmEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saG49dC5fZWJfYnREeW5hbWljc1dvcmxkX2dldEJyb2FkcGhhc2VfMD1mdW5jdGlvbigpe3JldHVybihobj10Ll9lYl9idER5bmFtaWNzV29ybGRfZ2V0QnJvYWRwaGFzZV8wPXQuYXNtLk9hKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGZuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9jb252ZXhTd2VlcFRlc3RfNT1mdW5jdGlvbigpe3JldHVybihmbj10Ll9lYl9idER5bmFtaWNzV29ybGRfY29udmV4U3dlZXBUZXN0XzU9dC5hc20uUGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbW49dC5fZWJfYnREeW5hbWljc1dvcmxkX2NvbnRhY3RQYWlyVGVzdF8zPWZ1bmN0aW9uKCl7cmV0dXJuKG1uPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9jb250YWN0UGFpclRlc3RfMz10LmFzbS5RYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxibj10Ll9lYl9idER5bmFtaWNzV29ybGRfY29udGFjdFRlc3RfMj1mdW5jdGlvbigpe3JldHVybihibj10Ll9lYl9idER5bmFtaWNzV29ybGRfY29udGFjdFRlc3RfMj10LmFzbS5SYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxnbj10Ll9lYl9idER5bmFtaWNzV29ybGRfdXBkYXRlU2luZ2xlQWFiYl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGduPXQuX2ViX2J0RHluYW1pY3NXb3JsZF91cGRhdGVTaW5nbGVBYWJiXzE9dC5hc20uU2EpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZG49dC5fZWJfYnREeW5hbWljc1dvcmxkX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oZG49dC5fZWJfYnREeW5hbWljc1dvcmxkX19fZGVzdHJveV9fXzA9dC5hc20uVGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sV249dC5fZWJfVm9pZFB0cl9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKFduPXQuX2ViX1ZvaWRQdHJfX19kZXN0cm95X19fMD10LmFzbS5VYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxDbj10Ll9lYl9idFZlY3RvcjNfYnRWZWN0b3IzXzA9ZnVuY3Rpb24oKXtyZXR1cm4oQ249dC5fZWJfYnRWZWN0b3IzX2J0VmVjdG9yM18wPXQuYXNtLlZhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGpuPXQuX2ViX2J0VmVjdG9yM19idFZlY3RvcjNfMz1mdW5jdGlvbigpe3JldHVybihqbj10Ll9lYl9idFZlY3RvcjNfYnRWZWN0b3IzXzM9dC5hc20uV2EpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdm49dC5fZWJfYnRWZWN0b3IzX2xlbmd0aF8wPWZ1bmN0aW9uKCl7cmV0dXJuKHZuPXQuX2ViX2J0VmVjdG9yM19sZW5ndGhfMD10LmFzbS5YYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxEbj10Ll9lYl9idFZlY3RvcjNfeF8wPWZ1bmN0aW9uKCl7cmV0dXJuKERuPXQuX2ViX2J0VmVjdG9yM194XzA9dC5hc20uWWEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sUm49dC5fZWJfYnRWZWN0b3IzX3lfMD1mdW5jdGlvbigpe3JldHVybihSbj10Ll9lYl9idFZlY3RvcjNfeV8wPXQuYXNtLlphKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFNuPXQuX2ViX2J0VmVjdG9yM196XzA9ZnVuY3Rpb24oKXtyZXR1cm4oU249dC5fZWJfYnRWZWN0b3IzX3pfMD10LmFzbS5fYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxJbj10Ll9lYl9idFZlY3RvcjNfc2V0WF8xPWZ1bmN0aW9uKCl7cmV0dXJuKEluPXQuX2ViX2J0VmVjdG9yM19zZXRYXzE9dC5hc20uJGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sT249dC5fZWJfYnRWZWN0b3IzX3NldFlfMT1mdW5jdGlvbigpe3JldHVybihPbj10Ll9lYl9idFZlY3RvcjNfc2V0WV8xPXQuYXNtLmFiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEJuPXQuX2ViX2J0VmVjdG9yM19zZXRaXzE9ZnVuY3Rpb24oKXtyZXR1cm4oQm49dC5fZWJfYnRWZWN0b3IzX3NldFpfMT10LmFzbS5iYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxQbj10Ll9lYl9idFZlY3RvcjNfc2V0VmFsdWVfMz1mdW5jdGlvbigpe3JldHVybihQbj10Ll9lYl9idFZlY3RvcjNfc2V0VmFsdWVfMz10LmFzbS5jYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx4bj10Ll9lYl9idFZlY3RvcjNfbm9ybWFsaXplXzA9ZnVuY3Rpb24oKXtyZXR1cm4oeG49dC5fZWJfYnRWZWN0b3IzX25vcm1hbGl6ZV8wPXQuYXNtLmRiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFRuPXQuX2ViX2J0VmVjdG9yM19yb3RhdGVfMj1mdW5jdGlvbigpe3JldHVybihUbj10Ll9lYl9idFZlY3RvcjNfcm90YXRlXzI9dC5hc20uZWIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRm49dC5fZWJfYnRWZWN0b3IzX2RvdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKEZuPXQuX2ViX2J0VmVjdG9yM19kb3RfMT10LmFzbS5mYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNbj10Ll9lYl9idFZlY3RvcjNfb3BfbXVsXzE9ZnVuY3Rpb24oKXtyZXR1cm4oTW49dC5fZWJfYnRWZWN0b3IzX29wX211bF8xPXQuYXNtLmdiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEFuPXQuX2ViX2J0VmVjdG9yM19vcF9hZGRfMT1mdW5jdGlvbigpe3JldHVybihBbj10Ll9lYl9idFZlY3RvcjNfb3BfYWRkXzE9dC5hc20uaGIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sd249dC5fZWJfYnRWZWN0b3IzX29wX3N1Yl8xPWZ1bmN0aW9uKCl7cmV0dXJuKHduPXQuX2ViX2J0VmVjdG9yM19vcF9zdWJfMT10LmFzbS5pYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxrbj10Ll9lYl9idFZlY3RvcjNfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihrbj10Ll9lYl9idFZlY3RvcjNfX19kZXN0cm95X19fMD10LmFzbS5qYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxMbj10Ll9lYl9idFF1YXRlcm5pb25fYnRRdWF0ZXJuaW9uXzQ9ZnVuY3Rpb24oKXtyZXR1cm4oTG49dC5fZWJfYnRRdWF0ZXJuaW9uX2J0UXVhdGVybmlvbl80PXQuYXNtLmtiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEhuPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRWYWx1ZV80PWZ1bmN0aW9uKCl7cmV0dXJuKEhuPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRWYWx1ZV80PXQuYXNtLmxiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFluPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRFdWxlclpZWF8zPWZ1bmN0aW9uKCl7cmV0dXJuKFluPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRFdWxlclpZWF8zPXQuYXNtLm1iKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFZuPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRSb3RhdGlvbl8yPWZ1bmN0aW9uKCl7cmV0dXJuKFZuPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRSb3RhdGlvbl8yPXQuYXNtLm5iKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFuPXQuX2ViX2J0UXVhdGVybmlvbl9ub3JtYWxpemVfMD1mdW5jdGlvbigpe3JldHVybihRbj10Ll9lYl9idFF1YXRlcm5pb25fbm9ybWFsaXplXzA9dC5hc20ub2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRW49dC5fZWJfYnRRdWF0ZXJuaW9uX2xlbmd0aDJfMD1mdW5jdGlvbigpe3JldHVybihFbj10Ll9lYl9idFF1YXRlcm5pb25fbGVuZ3RoMl8wPXQuYXNtLnBiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFhuPXQuX2ViX2J0UXVhdGVybmlvbl9sZW5ndGhfMD1mdW5jdGlvbigpe3JldHVybihYbj10Ll9lYl9idFF1YXRlcm5pb25fbGVuZ3RoXzA9dC5hc20ucWIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVW49dC5fZWJfYnRRdWF0ZXJuaW9uX2RvdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFVuPXQuX2ViX2J0UXVhdGVybmlvbl9kb3RfMT10LmFzbS5yYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHbj10Ll9lYl9idFF1YXRlcm5pb25fbm9ybWFsaXplZF8wPWZ1bmN0aW9uKCl7cmV0dXJuKEduPXQuX2ViX2J0UXVhdGVybmlvbl9ub3JtYWxpemVkXzA9dC5hc20uc2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTm49dC5fZWJfYnRRdWF0ZXJuaW9uX2dldEF4aXNfMD1mdW5jdGlvbigpe3JldHVybihObj10Ll9lYl9idFF1YXRlcm5pb25fZ2V0QXhpc18wPXQuYXNtLnRiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHpuPXQuX2ViX2J0UXVhdGVybmlvbl9pbnZlcnNlXzA9ZnVuY3Rpb24oKXtyZXR1cm4oem49dC5fZWJfYnRRdWF0ZXJuaW9uX2ludmVyc2VfMD10LmFzbS51YikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxbj10Ll9lYl9idFF1YXRlcm5pb25fZ2V0QW5nbGVfMD1mdW5jdGlvbigpe3JldHVybihxbj10Ll9lYl9idFF1YXRlcm5pb25fZ2V0QW5nbGVfMD10LmFzbS52YikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxabj10Ll9lYl9idFF1YXRlcm5pb25fZ2V0QW5nbGVTaG9ydGVzdFBhdGhfMD1mdW5jdGlvbigpe3JldHVybihabj10Ll9lYl9idFF1YXRlcm5pb25fZ2V0QW5nbGVTaG9ydGVzdFBhdGhfMD10LmFzbS53YikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxLbj10Ll9lYl9idFF1YXRlcm5pb25fYW5nbGVfMT1mdW5jdGlvbigpe3JldHVybihLbj10Ll9lYl9idFF1YXRlcm5pb25fYW5nbGVfMT10LmFzbS54YikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSwkbj10Ll9lYl9idFF1YXRlcm5pb25fYW5nbGVTaG9ydGVzdFBhdGhfMT1mdW5jdGlvbigpe3JldHVybigkbj10Ll9lYl9idFF1YXRlcm5pb25fYW5nbGVTaG9ydGVzdFBhdGhfMT10LmFzbS55YikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxKbj10Ll9lYl9idFF1YXRlcm5pb25fb3BfYWRkXzE9ZnVuY3Rpb24oKXtyZXR1cm4oSm49dC5fZWJfYnRRdWF0ZXJuaW9uX29wX2FkZF8xPXQuYXNtLnpiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHRyPXQuX2ViX2J0UXVhdGVybmlvbl9vcF9zdWJfMT1mdW5jdGlvbigpe3JldHVybih0cj10Ll9lYl9idFF1YXRlcm5pb25fb3Bfc3ViXzE9dC5hc20uQWIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZXI9dC5fZWJfYnRRdWF0ZXJuaW9uX29wX211bF8xPWZ1bmN0aW9uKCl7cmV0dXJuKGVyPXQuX2ViX2J0UXVhdGVybmlvbl9vcF9tdWxfMT10LmFzbS5CYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvcj10Ll9lYl9idFF1YXRlcm5pb25fb3BfbXVscV8xPWZ1bmN0aW9uKCl7cmV0dXJuKG9yPXQuX2ViX2J0UXVhdGVybmlvbl9vcF9tdWxxXzE9dC5hc20uQ2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbnI9dC5fZWJfYnRRdWF0ZXJuaW9uX29wX2Rpdl8xPWZ1bmN0aW9uKCl7cmV0dXJuKG5yPXQuX2ViX2J0UXVhdGVybmlvbl9vcF9kaXZfMT10LmFzbS5EYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxycj10Ll9lYl9idFF1YXRlcm5pb25feF8wPWZ1bmN0aW9uKCl7cmV0dXJuKHJyPXQuX2ViX2J0UXVhdGVybmlvbl94XzA9dC5hc20uRWIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sX3I9dC5fZWJfYnRRdWF0ZXJuaW9uX3lfMD1mdW5jdGlvbigpe3JldHVybihfcj10Ll9lYl9idFF1YXRlcm5pb25feV8wPXQuYXNtLkZiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGlyPXQuX2ViX2J0UXVhdGVybmlvbl96XzA9ZnVuY3Rpb24oKXtyZXR1cm4oaXI9dC5fZWJfYnRRdWF0ZXJuaW9uX3pfMD10LmFzbS5HYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxhcj10Ll9lYl9idFF1YXRlcm5pb25fd18wPWZ1bmN0aW9uKCl7cmV0dXJuKGFyPXQuX2ViX2J0UXVhdGVybmlvbl93XzA9dC5hc20uSGIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sc3I9dC5fZWJfYnRRdWF0ZXJuaW9uX3NldFhfMT1mdW5jdGlvbigpe3JldHVybihzcj10Ll9lYl9idFF1YXRlcm5pb25fc2V0WF8xPXQuYXNtLkliKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHByPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRZXzE9ZnVuY3Rpb24oKXtyZXR1cm4ocHI9dC5fZWJfYnRRdWF0ZXJuaW9uX3NldFlfMT10LmFzbS5KYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxscj10Ll9lYl9idFF1YXRlcm5pb25fc2V0Wl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGxyPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRaXzE9dC5hc20uS2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdXI9dC5fZWJfYnRRdWF0ZXJuaW9uX3NldFdfMT1mdW5jdGlvbigpe3JldHVybih1cj10Ll9lYl9idFF1YXRlcm5pb25fc2V0V18xPXQuYXNtLkxiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGNyPXQuX2ViX2J0UXVhdGVybmlvbl9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKGNyPXQuX2ViX2J0UXVhdGVybmlvbl9fX2Rlc3Ryb3lfX18wPXQuYXNtLk1iKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlyPXQuX2ViX2J0TWF0cml4M3gzX3NldEV1bGVyWllYXzM9ZnVuY3Rpb24oKXtyZXR1cm4oeXI9dC5fZWJfYnRNYXRyaXgzeDNfc2V0RXVsZXJaWVhfMz10LmFzbS5OYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxocj10Ll9lYl9idE1hdHJpeDN4M19nZXRSb3RhdGlvbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGhyPXQuX2ViX2J0TWF0cml4M3gzX2dldFJvdGF0aW9uXzE9dC5hc20uT2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZnI9dC5fZWJfYnRNYXRyaXgzeDNfZ2V0Um93XzE9ZnVuY3Rpb24oKXtyZXR1cm4oZnI9dC5fZWJfYnRNYXRyaXgzeDNfZ2V0Um93XzE9dC5hc20uUGIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbXI9dC5fZWJfYnRNYXRyaXgzeDNfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihtcj10Ll9lYl9idE1hdHJpeDN4M19fX2Rlc3Ryb3lfX18wPXQuYXNtLlFiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGJyPXQuX2ViX2J0VHJhbnNmb3JtX2J0VHJhbnNmb3JtXzA9ZnVuY3Rpb24oKXtyZXR1cm4oYnI9dC5fZWJfYnRUcmFuc2Zvcm1fYnRUcmFuc2Zvcm1fMD10LmFzbS5SYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxncj10Ll9lYl9idFRyYW5zZm9ybV9idFRyYW5zZm9ybV8yPWZ1bmN0aW9uKCl7cmV0dXJuKGdyPXQuX2ViX2J0VHJhbnNmb3JtX2J0VHJhbnNmb3JtXzI9dC5hc20uU2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZHI9dC5fZWJfYnRUcmFuc2Zvcm1fc2V0SWRlbnRpdHlfMD1mdW5jdGlvbigpe3JldHVybihkcj10Ll9lYl9idFRyYW5zZm9ybV9zZXRJZGVudGl0eV8wPXQuYXNtLlRiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFdyPXQuX2ViX2J0VHJhbnNmb3JtX3NldE9yaWdpbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKFdyPXQuX2ViX2J0VHJhbnNmb3JtX3NldE9yaWdpbl8xPXQuYXNtLlViKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LENyPXQuX2ViX2J0VHJhbnNmb3JtX3NldFJvdGF0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oQ3I9dC5fZWJfYnRUcmFuc2Zvcm1fc2V0Um90YXRpb25fMT10LmFzbS5WYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxqcj10Ll9lYl9idFRyYW5zZm9ybV9nZXRPcmlnaW5fMD1mdW5jdGlvbigpe3JldHVybihqcj10Ll9lYl9idFRyYW5zZm9ybV9nZXRPcmlnaW5fMD10LmFzbS5XYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx2cj10Ll9lYl9idFRyYW5zZm9ybV9nZXRSb3RhdGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKHZyPXQuX2ViX2J0VHJhbnNmb3JtX2dldFJvdGF0aW9uXzA9dC5hc20uWGIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRHI9dC5fZWJfYnRUcmFuc2Zvcm1fZ2V0QmFzaXNfMD1mdW5jdGlvbigpe3JldHVybihEcj10Ll9lYl9idFRyYW5zZm9ybV9nZXRCYXNpc18wPXQuYXNtLlliKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFJyPXQuX2ViX2J0VHJhbnNmb3JtX3NldEZyb21PcGVuR0xNYXRyaXhfMT1mdW5jdGlvbigpe3JldHVybihScj10Ll9lYl9idFRyYW5zZm9ybV9zZXRGcm9tT3BlbkdMTWF0cml4XzE9dC5hc20uWmIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sU3I9dC5fZWJfYnRUcmFuc2Zvcm1faW52ZXJzZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFNyPXQuX2ViX2J0VHJhbnNmb3JtX2ludmVyc2VfMD10LmFzbS5fYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxJcj10Ll9lYl9idFRyYW5zZm9ybV9vcF9tdWxfMT1mdW5jdGlvbigpe3JldHVybihJcj10Ll9lYl9idFRyYW5zZm9ybV9vcF9tdWxfMT10LmFzbS4kYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxPcj10Ll9lYl9idFRyYW5zZm9ybV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKE9yPXQuX2ViX2J0VHJhbnNmb3JtX19fZGVzdHJveV9fXzA9dC5hc20uYWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQnI9dC5fZWJfYnREZWZhdWx0TW90aW9uU3RhdGVfYnREZWZhdWx0TW90aW9uU3RhdGVfMD1mdW5jdGlvbigpe3JldHVybihCcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9idERlZmF1bHRNb3Rpb25TdGF0ZV8wPXQuYXNtLmJjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFByPXQuX2ViX2J0RGVmYXVsdE1vdGlvblN0YXRlX2J0RGVmYXVsdE1vdGlvblN0YXRlXzE9ZnVuY3Rpb24oKXtyZXR1cm4oUHI9dC5fZWJfYnREZWZhdWx0TW90aW9uU3RhdGVfYnREZWZhdWx0TW90aW9uU3RhdGVfMT10LmFzbS5jYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx4cj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9idERlZmF1bHRNb3Rpb25TdGF0ZV8yPWZ1bmN0aW9uKCl7cmV0dXJuKHhyPXQuX2ViX2J0RGVmYXVsdE1vdGlvblN0YXRlX2J0RGVmYXVsdE1vdGlvblN0YXRlXzI9dC5hc20uZGMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVHI9dC5fZWJfYnREZWZhdWx0TW90aW9uU3RhdGVfZ2V0V29ybGRUcmFuc2Zvcm1fMT1mdW5jdGlvbigpe3JldHVybihUcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9nZXRXb3JsZFRyYW5zZm9ybV8xPXQuYXNtLmVjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEZyPXQuX2ViX2J0RGVmYXVsdE1vdGlvblN0YXRlX3NldFdvcmxkVHJhbnNmb3JtXzE9ZnVuY3Rpb24oKXtyZXR1cm4oRnI9dC5fZWJfYnREZWZhdWx0TW90aW9uU3RhdGVfc2V0V29ybGRUcmFuc2Zvcm1fMT10LmFzbS5mYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9nZXRfbV9ncmFwaGljc1dvcmxkVHJhbnNfMD1mdW5jdGlvbigpe3JldHVybihNcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9nZXRfbV9ncmFwaGljc1dvcmxkVHJhbnNfMD10LmFzbS5nYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxBcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9zZXRfbV9ncmFwaGljc1dvcmxkVHJhbnNfMT1mdW5jdGlvbigpe3JldHVybihBcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9zZXRfbV9ncmFwaGljc1dvcmxkVHJhbnNfMT10LmFzbS5oYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx3cj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKHdyPXQuX2ViX2J0RGVmYXVsdE1vdGlvblN0YXRlX19fZGVzdHJveV9fXzA9dC5hc20uaWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sa3I9dC5fZWJfYnRDb2xsaXNpb25PYmplY3RXcmFwcGVyX2dldFdvcmxkVHJhbnNmb3JtXzA9ZnVuY3Rpb24oKXtyZXR1cm4oa3I9dC5fZWJfYnRDb2xsaXNpb25PYmplY3RXcmFwcGVyX2dldFdvcmxkVHJhbnNmb3JtXzA9dC5hc20uamMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTHI9dC5fZWJfYnRDb2xsaXNpb25PYmplY3RXcmFwcGVyX2dldENvbGxpc2lvbk9iamVjdF8wPWZ1bmN0aW9uKCl7cmV0dXJuKExyPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0V3JhcHBlcl9nZXRDb2xsaXNpb25PYmplY3RfMD10LmFzbS5rYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxIcj10Ll9lYl9idENvbGxpc2lvbk9iamVjdFdyYXBwZXJfZ2V0Q29sbGlzaW9uU2hhcGVfMD1mdW5jdGlvbigpe3JldHVybihIcj10Ll9lYl9idENvbGxpc2lvbk9iamVjdFdyYXBwZXJfZ2V0Q29sbGlzaW9uU2hhcGVfMD10LmFzbS5sYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxZcj10Ll9lYl9idENvbnN0Q29sbGlzaW9uT2JqZWN0QXJyYXlfc2l6ZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFlyPXQuX2ViX2J0Q29uc3RDb2xsaXNpb25PYmplY3RBcnJheV9zaXplXzA9dC5hc20ubWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVnI9dC5fZWJfYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5X2F0XzE9ZnVuY3Rpb24oKXtyZXR1cm4oVnI9dC5fZWJfYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5X2F0XzE9dC5hc20ubmMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sUXI9dC5fZWJfYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5X19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oUXI9dC5fZWJfYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5X19fZGVzdHJveV9fXzA9dC5hc20ub2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRXI9dC5fZWJfYnRTY2FsYXJBcnJheV9zaXplXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRXI9dC5fZWJfYnRTY2FsYXJBcnJheV9zaXplXzA9dC5hc20ucGMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWHI9dC5fZWJfYnRTY2FsYXJBcnJheV9hdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFhyPXQuX2ViX2J0U2NhbGFyQXJyYXlfYXRfMT10LmFzbS5xYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxVcj10Ll9lYl9idFNjYWxhckFycmF5X19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oVXI9dC5fZWJfYnRTY2FsYXJBcnJheV9fX2Rlc3Ryb3lfX18wPXQuYXNtLnJjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEdyPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRQb3NpdGlvbldvcmxkT25BXzA9ZnVuY3Rpb24oKXtyZXR1cm4oR3I9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldFBvc2l0aW9uV29ybGRPbkFfMD10LmFzbS5zYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxOcj10Ll9lYl9idE1hbmlmb2xkUG9pbnRfZ2V0UG9zaXRpb25Xb3JsZE9uQl8wPWZ1bmN0aW9uKCl7cmV0dXJuKE5yPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRQb3NpdGlvbldvcmxkT25CXzA9dC5hc20udGMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0senI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldEFwcGxpZWRJbXB1bHNlXzA9ZnVuY3Rpb24oKXtyZXR1cm4oenI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldEFwcGxpZWRJbXB1bHNlXzA9dC5hc20udWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scXI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldERpc3RhbmNlXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocXI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldERpc3RhbmNlXzA9dC5hc20udmMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWnI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldF9tX2xvY2FsUG9pbnRBXzA9ZnVuY3Rpb24oKXtyZXR1cm4oWnI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldF9tX2xvY2FsUG9pbnRBXzA9dC5hc20ud2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sS3I9dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX2xvY2FsUG9pbnRBXzE9ZnVuY3Rpb24oKXtyZXR1cm4oS3I9dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX2xvY2FsUG9pbnRBXzE9dC5hc20ueGMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sJHI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldF9tX2xvY2FsUG9pbnRCXzA9ZnVuY3Rpb24oKXtyZXR1cm4oJHI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldF9tX2xvY2FsUG9pbnRCXzA9dC5hc20ueWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSnI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX2xvY2FsUG9pbnRCXzE9ZnVuY3Rpb24oKXtyZXR1cm4oSnI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX2xvY2FsUG9pbnRCXzE9dC5hc20uemMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdF89dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldF9tX3Bvc2l0aW9uV29ybGRPbkJfMD1mdW5jdGlvbigpe3JldHVybih0Xz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfZ2V0X21fcG9zaXRpb25Xb3JsZE9uQl8wPXQuYXNtLkFjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGVfPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9zZXRfbV9wb3NpdGlvbldvcmxkT25CXzE9ZnVuY3Rpb24oKXtyZXR1cm4oZV89dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX3Bvc2l0aW9uV29ybGRPbkJfMT10LmFzbS5CYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvXz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfZ2V0X21fcG9zaXRpb25Xb3JsZE9uQV8wPWZ1bmN0aW9uKCl7cmV0dXJuKG9fPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRfbV9wb3NpdGlvbldvcmxkT25BXzA9dC5hc20uQ2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbl89dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX3Bvc2l0aW9uV29ybGRPbkFfMT1mdW5jdGlvbigpe3JldHVybihuXz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfc2V0X21fcG9zaXRpb25Xb3JsZE9uQV8xPXQuYXNtLkRjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHJfPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRfbV9ub3JtYWxXb3JsZE9uQl8wPWZ1bmN0aW9uKCl7cmV0dXJuKHJfPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRfbV9ub3JtYWxXb3JsZE9uQl8wPXQuYXNtLkVjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9fPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9zZXRfbV9ub3JtYWxXb3JsZE9uQl8xPWZ1bmN0aW9uKCl7cmV0dXJuKF9fPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9zZXRfbV9ub3JtYWxXb3JsZE9uQl8xPXQuYXNtLkZjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGlfPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRfbV91c2VyUGVyc2lzdGVudERhdGFfMD1mdW5jdGlvbigpe3JldHVybihpXz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfZ2V0X21fdXNlclBlcnNpc3RlbnREYXRhXzA9dC5hc20uR2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYV89dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX3VzZXJQZXJzaXN0ZW50RGF0YV8xPWZ1bmN0aW9uKCl7cmV0dXJuKGFfPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9zZXRfbV91c2VyUGVyc2lzdGVudERhdGFfMT10LmFzbS5IYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxzXz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihzXz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfX19kZXN0cm95X19fMD10LmFzbS5JYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxwXz10Ll9lYl9Db25jcmV0ZUNvbnRhY3RSZXN1bHRDYWxsYmFja19Db25jcmV0ZUNvbnRhY3RSZXN1bHRDYWxsYmFja18wPWZ1bmN0aW9uKCl7cmV0dXJuKHBfPXQuX2ViX0NvbmNyZXRlQ29udGFjdFJlc3VsdENhbGxiYWNrX0NvbmNyZXRlQ29udGFjdFJlc3VsdENhbGxiYWNrXzA9dC5hc20uSmMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbF89dC5fZWJfQ29uY3JldGVDb250YWN0UmVzdWx0Q2FsbGJhY2tfYWRkU2luZ2xlUmVzdWx0Xzc9ZnVuY3Rpb24oKXtyZXR1cm4obF89dC5fZWJfQ29uY3JldGVDb250YWN0UmVzdWx0Q2FsbGJhY2tfYWRkU2luZ2xlUmVzdWx0Xzc9dC5hc20uS2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdV89dC5fZWJfQ29uY3JldGVDb250YWN0UmVzdWx0Q2FsbGJhY2tfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybih1Xz10Ll9lYl9Db25jcmV0ZUNvbnRhY3RSZXN1bHRDYWxsYmFja19fX2Rlc3Ryb3lfX18wPXQuYXNtLkxjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGNfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX2dldF9tX3NoYXBlUGFydF8wPWZ1bmN0aW9uKCl7cmV0dXJuKGNfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX2dldF9tX3NoYXBlUGFydF8wPXQuYXNtLk1jKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX3NldF9tX3NoYXBlUGFydF8xPWZ1bmN0aW9uKCl7cmV0dXJuKHlfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX3NldF9tX3NoYXBlUGFydF8xPXQuYXNtLk5jKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGhfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX2dldF9tX3RyaWFuZ2xlSW5kZXhfMD1mdW5jdGlvbigpe3JldHVybihoXz10Ll9lYl9Mb2NhbFNoYXBlSW5mb19nZXRfbV90cmlhbmdsZUluZGV4XzA9dC5hc20uT2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZl89dC5fZWJfTG9jYWxTaGFwZUluZm9fc2V0X21fdHJpYW5nbGVJbmRleF8xPWZ1bmN0aW9uKCl7cmV0dXJuKGZfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX3NldF9tX3RyaWFuZ2xlSW5kZXhfMT10LmFzbS5QYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxtXz10Ll9lYl9Mb2NhbFNoYXBlSW5mb19fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKG1fPXQuX2ViX0xvY2FsU2hhcGVJbmZvX19fZGVzdHJveV9fXzA9dC5hc20uUWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYl89dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfTG9jYWxDb252ZXhSZXN1bHRfNT1mdW5jdGlvbigpe3JldHVybihiXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9Mb2NhbENvbnZleFJlc3VsdF81PXQuYXNtLlJjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGdfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X2dldF9tX2hpdENvbGxpc2lvbk9iamVjdF8wPWZ1bmN0aW9uKCl7cmV0dXJuKGdfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X2dldF9tX2hpdENvbGxpc2lvbk9iamVjdF8wPXQuYXNtLlNjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGRfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2hpdENvbGxpc2lvbk9iamVjdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKGRfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2hpdENvbGxpc2lvbk9iamVjdF8xPXQuYXNtLlRjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFdfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X2dldF9tX2xvY2FsU2hhcGVJbmZvXzA9ZnVuY3Rpb24oKXtyZXR1cm4oV189dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfZ2V0X21fbG9jYWxTaGFwZUluZm9fMD10LmFzbS5VYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxDXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9zZXRfbV9sb2NhbFNoYXBlSW5mb18xPWZ1bmN0aW9uKCl7cmV0dXJuKENfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2xvY2FsU2hhcGVJbmZvXzE9dC5hc20uVmMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sal89dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfZ2V0X21faGl0Tm9ybWFsTG9jYWxfMD1mdW5jdGlvbigpe3JldHVybihqXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9nZXRfbV9oaXROb3JtYWxMb2NhbF8wPXQuYXNtLldjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHZfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2hpdE5vcm1hbExvY2FsXzE9ZnVuY3Rpb24oKXtyZXR1cm4odl89dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfc2V0X21faGl0Tm9ybWFsTG9jYWxfMT10LmFzbS5YYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxEXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9nZXRfbV9oaXRQb2ludExvY2FsXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRF89dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfZ2V0X21faGl0UG9pbnRMb2NhbF8wPXQuYXNtLlljKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFJfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2hpdFBvaW50TG9jYWxfMT1mdW5jdGlvbigpe3JldHVybihSXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9zZXRfbV9oaXRQb2ludExvY2FsXzE9dC5hc20uWmMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sU189dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfZ2V0X21faGl0RnJhY3Rpb25fMD1mdW5jdGlvbigpe3JldHVybihTXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9nZXRfbV9oaXRGcmFjdGlvbl8wPXQuYXNtLl9jKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LElfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2hpdEZyYWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oSV89dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfc2V0X21faGl0RnJhY3Rpb25fMT10LmFzbS4kYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxPXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKE9fPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X19fZGVzdHJveV9fXzA9dC5hc20uYWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQl89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja18yPWZ1bmN0aW9uKCl7cmV0dXJuKEJfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfMj10LmFzbS5iZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxQXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfaGFzSGl0XzA9ZnVuY3Rpb24oKXtyZXR1cm4oUF89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX2hhc0hpdF8wPXQuYXNtLmNkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHhfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9oaXRDb2xsaXNpb25PYmplY3RfMD1mdW5jdGlvbigpe3JldHVybih4Xz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21faGl0Q29sbGlzaW9uT2JqZWN0XzA9dC5hc20uZGQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVF89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX3NldF9tX2hpdENvbGxpc2lvbk9iamVjdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFRfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9oaXRDb2xsaXNpb25PYmplY3RfMT10LmFzbS5lZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxGXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21fY29udmV4RnJvbVdvcmxkXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRl89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2NvbnZleEZyb21Xb3JsZF8wPXQuYXNtLmZkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE1fPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb252ZXhGcm9tV29ybGRfMT1mdW5jdGlvbigpe3JldHVybihNXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21fY29udmV4RnJvbVdvcmxkXzE9dC5hc20uZ2QpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQV89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2NvbnZleFRvV29ybGRfMD1mdW5jdGlvbigpe3JldHVybihBXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21fY29udmV4VG9Xb3JsZF8wPXQuYXNtLmhkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHdfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb252ZXhUb1dvcmxkXzE9ZnVuY3Rpb24oKXtyZXR1cm4od189dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX3NldF9tX2NvbnZleFRvV29ybGRfMT10LmFzbS5pZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxrXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21faGl0Tm9ybWFsV29ybGRfMD1mdW5jdGlvbigpe3JldHVybihrXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21faGl0Tm9ybWFsV29ybGRfMD10LmFzbS5qZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxMXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21faGl0Tm9ybWFsV29ybGRfMT1mdW5jdGlvbigpe3JldHVybihMXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21faGl0Tm9ybWFsV29ybGRfMT10LmFzbS5rZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxIXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21faGl0UG9pbnRXb3JsZF8wPWZ1bmN0aW9uKCl7cmV0dXJuKEhfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9oaXRQb2ludFdvcmxkXzA9dC5hc20ubGQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWV89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX3NldF9tX2hpdFBvaW50V29ybGRfMT1mdW5jdGlvbigpe3JldHVybihZXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21faGl0UG9pbnRXb3JsZF8xPXQuYXNtLm1kKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFZfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8wPWZ1bmN0aW9uKCl7cmV0dXJuKFZfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8wPXQuYXNtLm5kKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFFfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8xPXQuYXNtLm9kKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEVfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jb2xsaXNpb25GaWx0ZXJNYXNrXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRV89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2NvbGxpc2lvbkZpbHRlck1hc2tfMD10LmFzbS5wZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxYXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21fY29sbGlzaW9uRmlsdGVyTWFza18xPWZ1bmN0aW9uKCl7cmV0dXJuKFhfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb2xsaXNpb25GaWx0ZXJNYXNrXzE9dC5hc20ucWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVV89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2Nsb3Nlc3RIaXRGcmFjdGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKFVfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb25fMD10LmFzbS5yZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21fY2xvc2VzdEhpdEZyYWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oR189dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX3NldF9tX2Nsb3Nlc3RIaXRGcmFjdGlvbl8xPXQuYXNtLnNkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE5fPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKE5fPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19fX2Rlc3Ryb3lfX18wPXQuYXNtLnRkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHpfPXQuX2ViX2J0Q29udmV4U2hhcGVfc2V0TG9jYWxTY2FsaW5nXzE9ZnVuY3Rpb24oKXtyZXR1cm4oel89dC5fZWJfYnRDb252ZXhTaGFwZV9zZXRMb2NhbFNjYWxpbmdfMT10LmFzbS51ZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxXz10Ll9lYl9idENvbnZleFNoYXBlX2dldExvY2FsU2NhbGluZ18wPWZ1bmN0aW9uKCl7cmV0dXJuKHFfPXQuX2ViX2J0Q29udmV4U2hhcGVfZ2V0TG9jYWxTY2FsaW5nXzA9dC5hc20udmQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWl89dC5fZWJfYnRDb252ZXhTaGFwZV9jYWxjdWxhdGVMb2NhbEluZXJ0aWFfMj1mdW5jdGlvbigpe3JldHVybihaXz10Ll9lYl9idENvbnZleFNoYXBlX2NhbGN1bGF0ZUxvY2FsSW5lcnRpYV8yPXQuYXNtLndkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEtfPXQuX2ViX2J0Q29udmV4U2hhcGVfc2V0TWFyZ2luXzE9ZnVuY3Rpb24oKXtyZXR1cm4oS189dC5fZWJfYnRDb252ZXhTaGFwZV9zZXRNYXJnaW5fMT10LmFzbS54ZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSwkXz10Ll9lYl9idENvbnZleFNoYXBlX2dldE1hcmdpbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKCRfPXQuX2ViX2J0Q29udmV4U2hhcGVfZ2V0TWFyZ2luXzA9dC5hc20ueWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSl89dC5fZWJfYnRDb252ZXhTaGFwZV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKEpfPXQuX2ViX2J0Q29udmV4U2hhcGVfX19kZXN0cm95X19fMD10LmFzbS56ZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0aT10Ll9lYl9idEJveFNoYXBlX2J0Qm94U2hhcGVfMT1mdW5jdGlvbigpe3JldHVybih0aT10Ll9lYl9idEJveFNoYXBlX2J0Qm94U2hhcGVfMT10LmFzbS5BZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlaT10Ll9lYl9idEJveFNoYXBlX3NldE1hcmdpbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGVpPXQuX2ViX2J0Qm94U2hhcGVfc2V0TWFyZ2luXzE9dC5hc20uQmQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sb2k9dC5fZWJfYnRCb3hTaGFwZV9nZXRNYXJnaW5fMD1mdW5jdGlvbigpe3JldHVybihvaT10Ll9lYl9idEJveFNoYXBlX2dldE1hcmdpbl8wPXQuYXNtLkNkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG5pPXQuX2ViX2J0Qm94U2hhcGVfc2V0TG9jYWxTY2FsaW5nXzE9ZnVuY3Rpb24oKXtyZXR1cm4obmk9dC5fZWJfYnRCb3hTaGFwZV9zZXRMb2NhbFNjYWxpbmdfMT10LmFzbS5EZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxyaT10Ll9lYl9idEJveFNoYXBlX2dldExvY2FsU2NhbGluZ18wPWZ1bmN0aW9uKCl7cmV0dXJuKHJpPXQuX2ViX2J0Qm94U2hhcGVfZ2V0TG9jYWxTY2FsaW5nXzA9dC5hc20uRWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sX2k9dC5fZWJfYnRCb3hTaGFwZV9jYWxjdWxhdGVMb2NhbEluZXJ0aWFfMj1mdW5jdGlvbigpe3JldHVybihfaT10Ll9lYl9idEJveFNoYXBlX2NhbGN1bGF0ZUxvY2FsSW5lcnRpYV8yPXQuYXNtLkZkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGlpPXQuX2ViX2J0Qm94U2hhcGVfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihpaT10Ll9lYl9idEJveFNoYXBlX19fZGVzdHJveV9fXzA9dC5hc20uR2QpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYWk9dC5fZWJfYnRJbnRBcnJheV9zaXplXzA9ZnVuY3Rpb24oKXtyZXR1cm4oYWk9dC5fZWJfYnRJbnRBcnJheV9zaXplXzA9dC5hc20uSGQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sc2k9dC5fZWJfYnRJbnRBcnJheV9hdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKHNpPXQuX2ViX2J0SW50QXJyYXlfYXRfMT10LmFzbS5JZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxwaT10Ll9lYl9idEludEFycmF5X19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocGk9dC5fZWJfYnRJbnRBcnJheV9fX2Rlc3Ryb3lfX18wPXQuYXNtLkpkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGxpPXQuX2ViX2J0RmFjZV9nZXRfbV9pbmRpY2VzXzA9ZnVuY3Rpb24oKXtyZXR1cm4obGk9dC5fZWJfYnRGYWNlX2dldF9tX2luZGljZXNfMD10LmFzbS5LZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx1aT10Ll9lYl9idEZhY2Vfc2V0X21faW5kaWNlc18xPWZ1bmN0aW9uKCl7cmV0dXJuKHVpPXQuX2ViX2J0RmFjZV9zZXRfbV9pbmRpY2VzXzE9dC5hc20uTGQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sY2k9dC5fZWJfYnRGYWNlX2dldF9tX3BsYW5lXzE9ZnVuY3Rpb24oKXtyZXR1cm4oY2k9dC5fZWJfYnRGYWNlX2dldF9tX3BsYW5lXzE9dC5hc20uTWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0seWk9dC5fZWJfYnRGYWNlX3NldF9tX3BsYW5lXzI9ZnVuY3Rpb24oKXtyZXR1cm4oeWk9dC5fZWJfYnRGYWNlX3NldF9tX3BsYW5lXzI9dC5hc20uTmQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saGk9dC5fZWJfYnRGYWNlX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oaGk9dC5fZWJfYnRGYWNlX19fZGVzdHJveV9fXzA9dC5hc20uT2QpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZmk9dC5fZWJfYnRWZWN0b3IzQXJyYXlfc2l6ZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKGZpPXQuX2ViX2J0VmVjdG9yM0FycmF5X3NpemVfMD10LmFzbS5QZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxtaT10Ll9lYl9idFZlY3RvcjNBcnJheV9hdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKG1pPXQuX2ViX2J0VmVjdG9yM0FycmF5X2F0XzE9dC5hc20uUWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYmk9dC5fZWJfYnRWZWN0b3IzQXJyYXlfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihiaT10Ll9lYl9idFZlY3RvcjNBcnJheV9fX2Rlc3Ryb3lfX18wPXQuYXNtLlJkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGdpPXQuX2ViX2J0RmFjZUFycmF5X3NpemVfMD1mdW5jdGlvbigpe3JldHVybihnaT10Ll9lYl9idEZhY2VBcnJheV9zaXplXzA9dC5hc20uU2QpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZGk9dC5fZWJfYnRGYWNlQXJyYXlfYXRfMT1mdW5jdGlvbigpe3JldHVybihkaT10Ll9lYl9idEZhY2VBcnJheV9hdF8xPXQuYXNtLlRkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFdpPXQuX2ViX2J0RmFjZUFycmF5X19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oV2k9dC5fZWJfYnRGYWNlQXJyYXlfX19kZXN0cm95X19fMD10LmFzbS5VZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxDaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fZ2V0X21fdmVydGljZXNfMD1mdW5jdGlvbigpe3JldHVybihDaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fZ2V0X21fdmVydGljZXNfMD10LmFzbS5WZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxqaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fc2V0X21fdmVydGljZXNfMT1mdW5jdGlvbigpe3JldHVybihqaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fc2V0X21fdmVydGljZXNfMT10LmFzbS5XZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx2aT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fZ2V0X21fZmFjZXNfMD1mdW5jdGlvbigpe3JldHVybih2aT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fZ2V0X21fZmFjZXNfMD10LmFzbS5YZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxEaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fc2V0X21fZmFjZXNfMT1mdW5jdGlvbigpe3JldHVybihEaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fc2V0X21fZmFjZXNfMT10LmFzbS5ZZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxSaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihSaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fX19kZXN0cm95X19fMD10LmFzbS5aZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxTaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9idENvbnZleEh1bGxTaGFwZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFNpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2J0Q29udmV4SHVsbFNoYXBlXzA9dC5hc20uX2QpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSWk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfYnRDb252ZXhIdWxsU2hhcGVfMT1mdW5jdGlvbigpe3JldHVybihJaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9idENvbnZleEh1bGxTaGFwZV8xPXQuYXNtLiRkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE9pPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2J0Q29udmV4SHVsbFNoYXBlXzI9ZnVuY3Rpb24oKXtyZXR1cm4oT2k9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfYnRDb252ZXhIdWxsU2hhcGVfMj10LmFzbS5hZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxCaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9hZGRQb2ludF8xPWZ1bmN0aW9uKCl7cmV0dXJuKEJpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2FkZFBvaW50XzE9dC5hc20uYmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sUGk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfYWRkUG9pbnRfMj1mdW5jdGlvbigpe3JldHVybihQaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9hZGRQb2ludF8yPXQuYXNtLmNlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHhpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX3NldE1hcmdpbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKHhpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX3NldE1hcmdpbl8xPXQuYXNtLmRlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFRpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2dldE1hcmdpbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKFRpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2dldE1hcmdpbl8wPXQuYXNtLmVlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEZpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2dldE51bVZlcnRpY2VzXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRmk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfZ2V0TnVtVmVydGljZXNfMD10LmFzbS5mZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9pbml0aWFsaXplUG9seWhlZHJhbEZlYXR1cmVzXzE9ZnVuY3Rpb24oKXtyZXR1cm4oTWk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfaW5pdGlhbGl6ZVBvbHloZWRyYWxGZWF0dXJlc18xPXQuYXNtLmdlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEFpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX3JlY2FsY0xvY2FsQWFiYl8wPWZ1bmN0aW9uKCl7cmV0dXJuKEFpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX3JlY2FsY0xvY2FsQWFiYl8wPXQuYXNtLmhlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHdpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2dldENvbnZleFBvbHloZWRyb25fMD1mdW5jdGlvbigpe3JldHVybih3aT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9nZXRDb252ZXhQb2x5aGVkcm9uXzA9dC5hc20uaWUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sa2k9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfc2V0TG9jYWxTY2FsaW5nXzE9ZnVuY3Rpb24oKXtyZXR1cm4oa2k9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfc2V0TG9jYWxTY2FsaW5nXzE9dC5hc20uamUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTGk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfZ2V0TG9jYWxTY2FsaW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oTGk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfZ2V0TG9jYWxTY2FsaW5nXzA9dC5hc20ua2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSGk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfY2FsY3VsYXRlTG9jYWxJbmVydGlhXzI9ZnVuY3Rpb24oKXtyZXR1cm4oSGk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfY2FsY3VsYXRlTG9jYWxJbmVydGlhXzI9dC5hc20ubGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWWk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihZaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9fX2Rlc3Ryb3lfX18wPXQuYXNtLm1lKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFZpPXQuX2ViX2J0RGVmYXVsdENvbGxpc2lvbkNvbnN0cnVjdGlvbkluZm9fYnREZWZhdWx0Q29sbGlzaW9uQ29uc3RydWN0aW9uSW5mb18wPWZ1bmN0aW9uKCl7cmV0dXJuKFZpPXQuX2ViX2J0RGVmYXVsdENvbGxpc2lvbkNvbnN0cnVjdGlvbkluZm9fYnREZWZhdWx0Q29sbGlzaW9uQ29uc3RydWN0aW9uSW5mb18wPXQuYXNtLm5lKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFpPXQuX2ViX2J0RGVmYXVsdENvbGxpc2lvbkNvbnN0cnVjdGlvbkluZm9fX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihRaT10Ll9lYl9idERlZmF1bHRDb2xsaXNpb25Db25zdHJ1Y3Rpb25JbmZvX19fZGVzdHJveV9fXzA9dC5hc20ub2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRWk9dC5fZWJfYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbl9idERlZmF1bHRDb2xsaXNpb25Db25maWd1cmF0aW9uXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRWk9dC5fZWJfYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbl9idERlZmF1bHRDb2xsaXNpb25Db25maWd1cmF0aW9uXzA9dC5hc20ucGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWGk9dC5fZWJfYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbl9idERlZmF1bHRDb2xsaXNpb25Db25maWd1cmF0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oWGk9dC5fZWJfYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbl9idERlZmF1bHRDb2xsaXNpb25Db25maWd1cmF0aW9uXzE9dC5hc20ucWUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVWk9dC5fZWJfYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbl9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKFVpPXQuX2ViX2J0RGVmYXVsdENvbGxpc2lvbkNvbmZpZ3VyYXRpb25fX19kZXN0cm95X19fMD10LmFzbS5yZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHaT10Ll9lYl9idFBlcnNpc3RlbnRNYW5pZm9sZF9idFBlcnNpc3RlbnRNYW5pZm9sZF8wPWZ1bmN0aW9uKCl7cmV0dXJuKEdpPXQuX2ViX2J0UGVyc2lzdGVudE1hbmlmb2xkX2J0UGVyc2lzdGVudE1hbmlmb2xkXzA9dC5hc20uc2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTmk9dC5fZWJfYnRQZXJzaXN0ZW50TWFuaWZvbGRfZ2V0Qm9keTBfMD1mdW5jdGlvbigpe3JldHVybihOaT10Ll9lYl9idFBlcnNpc3RlbnRNYW5pZm9sZF9nZXRCb2R5MF8wPXQuYXNtLnRlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHppPXQuX2ViX2J0UGVyc2lzdGVudE1hbmlmb2xkX2dldEJvZHkxXzA9ZnVuY3Rpb24oKXtyZXR1cm4oemk9dC5fZWJfYnRQZXJzaXN0ZW50TWFuaWZvbGRfZ2V0Qm9keTFfMD10LmFzbS51ZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxaT10Ll9lYl9idFBlcnNpc3RlbnRNYW5pZm9sZF9nZXROdW1Db250YWN0c18wPWZ1bmN0aW9uKCl7cmV0dXJuKHFpPXQuX2ViX2J0UGVyc2lzdGVudE1hbmlmb2xkX2dldE51bUNvbnRhY3RzXzA9dC5hc20udmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWmk9dC5fZWJfYnRQZXJzaXN0ZW50TWFuaWZvbGRfZ2V0Q29udGFjdFBvaW50XzE9ZnVuY3Rpb24oKXtyZXR1cm4oWmk9dC5fZWJfYnRQZXJzaXN0ZW50TWFuaWZvbGRfZ2V0Q29udGFjdFBvaW50XzE9dC5hc20ud2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sS2k9dC5fZWJfYnRQZXJzaXN0ZW50TWFuaWZvbGRfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihLaT10Ll9lYl9idFBlcnNpc3RlbnRNYW5pZm9sZF9fX2Rlc3Ryb3lfX18wPXQuYXNtLnhlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LCRpPXQuX2ViX2J0Q29sbGlzaW9uRGlzcGF0Y2hlcl9idENvbGxpc2lvbkRpc3BhdGNoZXJfMT1mdW5jdGlvbigpe3JldHVybigkaT10Ll9lYl9idENvbGxpc2lvbkRpc3BhdGNoZXJfYnRDb2xsaXNpb25EaXNwYXRjaGVyXzE9dC5hc20ueWUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSmk9dC5fZWJfYnRDb2xsaXNpb25EaXNwYXRjaGVyX2dldE51bU1hbmlmb2xkc18wPWZ1bmN0aW9uKCl7cmV0dXJuKEppPXQuX2ViX2J0Q29sbGlzaW9uRGlzcGF0Y2hlcl9nZXROdW1NYW5pZm9sZHNfMD10LmFzbS56ZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0YT10Ll9lYl9idENvbGxpc2lvbkRpc3BhdGNoZXJfZ2V0TWFuaWZvbGRCeUluZGV4SW50ZXJuYWxfMT1mdW5jdGlvbigpe3JldHVybih0YT10Ll9lYl9idENvbGxpc2lvbkRpc3BhdGNoZXJfZ2V0TWFuaWZvbGRCeUluZGV4SW50ZXJuYWxfMT10LmFzbS5BZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlYT10Ll9lYl9idENvbGxpc2lvbkRpc3BhdGNoZXJfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihlYT10Ll9lYl9idENvbGxpc2lvbkRpc3BhdGNoZXJfX19kZXN0cm95X19fMD10LmFzbS5CZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvYT10Ll9lYl9idE92ZXJsYXBwaW5nUGFpckNhbGxiYWNrX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4ob2E9dC5fZWJfYnRPdmVybGFwcGluZ1BhaXJDYWxsYmFja19fX2Rlc3Ryb3lfX18wPXQuYXNtLkNlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG5hPXQuX2ViX2J0T3ZlcmxhcHBpbmdQYWlyQ2FjaGVfc2V0SW50ZXJuYWxHaG9zdFBhaXJDYWxsYmFja18xPWZ1bmN0aW9uKCl7cmV0dXJuKG5hPXQuX2ViX2J0T3ZlcmxhcHBpbmdQYWlyQ2FjaGVfc2V0SW50ZXJuYWxHaG9zdFBhaXJDYWxsYmFja18xPXQuYXNtLkRlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHJhPXQuX2ViX2J0T3ZlcmxhcHBpbmdQYWlyQ2FjaGVfZ2V0TnVtT3ZlcmxhcHBpbmdQYWlyc18wPWZ1bmN0aW9uKCl7cmV0dXJuKHJhPXQuX2ViX2J0T3ZlcmxhcHBpbmdQYWlyQ2FjaGVfZ2V0TnVtT3ZlcmxhcHBpbmdQYWlyc18wPXQuYXNtLkVlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9hPXQuX2ViX2J0T3ZlcmxhcHBpbmdQYWlyQ2FjaGVfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihfYT10Ll9lYl9idE92ZXJsYXBwaW5nUGFpckNhY2hlX19fZGVzdHJveV9fXzA9dC5hc20uRmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saWE9dC5fZWJfYnRCcm9hZHBoYXNlSW50ZXJmYWNlX2dldE92ZXJsYXBwaW5nUGFpckNhY2hlXzA9ZnVuY3Rpb24oKXtyZXR1cm4oaWE9dC5fZWJfYnRCcm9hZHBoYXNlSW50ZXJmYWNlX2dldE92ZXJsYXBwaW5nUGFpckNhY2hlXzA9dC5hc20uR2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYWE9dC5fZWJfYnRCcm9hZHBoYXNlSW50ZXJmYWNlX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oYWE9dC5fZWJfYnRCcm9hZHBoYXNlSW50ZXJmYWNlX19fZGVzdHJveV9fXzA9dC5hc20uSGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sc2E9dC5fZWJfYnRDb2xsaXNpb25Db25maWd1cmF0aW9uX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oc2E9dC5fZWJfYnRDb2xsaXNpb25Db25maWd1cmF0aW9uX19fZGVzdHJveV9fXzA9dC5hc20uSWUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scGE9dC5fZWJfYnREYnZ0QnJvYWRwaGFzZV9idERidnRCcm9hZHBoYXNlXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocGE9dC5fZWJfYnREYnZ0QnJvYWRwaGFzZV9idERidnRCcm9hZHBoYXNlXzA9dC5hc20uSmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbGE9dC5fZWJfYnREYnZ0QnJvYWRwaGFzZV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKGxhPXQuX2ViX2J0RGJ2dEJyb2FkcGhhc2VfX19kZXN0cm95X19fMD10LmFzbS5LZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx1YT10Ll9lYl9idEJyb2FkcGhhc2VQcm94eV9nZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8wPWZ1bmN0aW9uKCl7cmV0dXJuKHVhPXQuX2ViX2J0QnJvYWRwaGFzZVByb3h5X2dldF9tX2NvbGxpc2lvbkZpbHRlckdyb3VwXzA9dC5hc20uTGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sY2E9dC5fZWJfYnRCcm9hZHBoYXNlUHJveHlfc2V0X21fY29sbGlzaW9uRmlsdGVyR3JvdXBfMT1mdW5jdGlvbigpe3JldHVybihjYT10Ll9lYl9idEJyb2FkcGhhc2VQcm94eV9zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8xPXQuYXNtLk1lKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlhPXQuX2ViX2J0QnJvYWRwaGFzZVByb3h5X2dldF9tX2NvbGxpc2lvbkZpbHRlck1hc2tfMD1mdW5jdGlvbigpe3JldHVybih5YT10Ll9lYl9idEJyb2FkcGhhc2VQcm94eV9nZXRfbV9jb2xsaXNpb25GaWx0ZXJNYXNrXzA9dC5hc20uTmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saGE9dC5fZWJfYnRCcm9hZHBoYXNlUHJveHlfc2V0X21fY29sbGlzaW9uRmlsdGVyTWFza18xPWZ1bmN0aW9uKCl7cmV0dXJuKGhhPXQuX2ViX2J0QnJvYWRwaGFzZVByb3h5X3NldF9tX2NvbGxpc2lvbkZpbHRlck1hc2tfMT10LmFzbS5PZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxmYT10Ll9lYl9idEJyb2FkcGhhc2VQcm94eV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKGZhPXQuX2ViX2J0QnJvYWRwaGFzZVByb3h5X19fZGVzdHJveV9fXzA9dC5hc20uUGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbWE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb18zPWZ1bmN0aW9uKCl7cmV0dXJuKG1hPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fMz10LmFzbS5RZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxiYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvXzQ9ZnVuY3Rpb24oKXtyZXR1cm4oYmE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb180PXQuYXNtLlJlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGdhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9saW5lYXJEYW1waW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oZ2E9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2xpbmVhckRhbXBpbmdfMD10LmFzbS5TZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxkYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fbGluZWFyRGFtcGluZ18xPWZ1bmN0aW9uKCl7cmV0dXJuKGRhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9saW5lYXJEYW1waW5nXzE9dC5hc20uVGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sV2E9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2FuZ3VsYXJEYW1waW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oV2E9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2FuZ3VsYXJEYW1waW5nXzA9dC5hc20uVWUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQ2E9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2FuZ3VsYXJEYW1waW5nXzE9ZnVuY3Rpb24oKXtyZXR1cm4oQ2E9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2FuZ3VsYXJEYW1waW5nXzE9dC5hc20uVmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0samE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2ZyaWN0aW9uXzA9ZnVuY3Rpb24oKXtyZXR1cm4oamE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2ZyaWN0aW9uXzA9dC5hc20uV2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdmE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2ZyaWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4odmE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2ZyaWN0aW9uXzE9dC5hc20uWGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRGE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX3JvbGxpbmdGcmljdGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKERhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9yb2xsaW5nRnJpY3Rpb25fMD10LmFzbS5ZZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxSYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fcm9sbGluZ0ZyaWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oUmE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX3JvbGxpbmdGcmljdGlvbl8xPXQuYXNtLlplKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFNhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9yZXN0aXR1dGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKFNhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9yZXN0aXR1dGlvbl8wPXQuYXNtLl9lKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LElhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9yZXN0aXR1dGlvbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKElhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9yZXN0aXR1dGlvbl8xPXQuYXNtLiRlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE9hPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9saW5lYXJTbGVlcGluZ1RocmVzaG9sZF8wPWZ1bmN0aW9uKCl7cmV0dXJuKE9hPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9saW5lYXJTbGVlcGluZ1RocmVzaG9sZF8wPXQuYXNtLmFmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEJhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9saW5lYXJTbGVlcGluZ1RocmVzaG9sZF8xPWZ1bmN0aW9uKCl7cmV0dXJuKEJhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9saW5lYXJTbGVlcGluZ1RocmVzaG9sZF8xPXQuYXNtLmJmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFBhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9hbmd1bGFyU2xlZXBpbmdUaHJlc2hvbGRfMD1mdW5jdGlvbigpe3JldHVybihQYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYW5ndWxhclNsZWVwaW5nVGhyZXNob2xkXzA9dC5hc20uY2YpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0seGE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2FuZ3VsYXJTbGVlcGluZ1RocmVzaG9sZF8xPWZ1bmN0aW9uKCl7cmV0dXJuKHhhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9hbmd1bGFyU2xlZXBpbmdUaHJlc2hvbGRfMT10LmFzbS5kZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxUYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbERhbXBpbmdfMD1mdW5jdGlvbigpe3JldHVybihUYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbERhbXBpbmdfMD10LmFzbS5lZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxGYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbERhbXBpbmdfMT1mdW5jdGlvbigpe3JldHVybihGYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbERhbXBpbmdfMT10LmFzbS5mZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbERhbXBpbmdGYWN0b3JfMD1mdW5jdGlvbigpe3JldHVybihNYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbERhbXBpbmdGYWN0b3JfMD10LmFzbS5nZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxBYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbERhbXBpbmdGYWN0b3JfMT1mdW5jdGlvbigpe3JldHVybihBYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbERhbXBpbmdGYWN0b3JfMT10LmFzbS5oZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx3YT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbExpbmVhckRhbXBpbmdUaHJlc2hvbGRTcXJfMD1mdW5jdGlvbigpe3JldHVybih3YT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbExpbmVhckRhbXBpbmdUaHJlc2hvbGRTcXJfMD10LmFzbS5qZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxrYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbExpbmVhckRhbXBpbmdUaHJlc2hvbGRTcXJfMT1mdW5jdGlvbigpe3JldHVybihrYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbExpbmVhckRhbXBpbmdUaHJlc2hvbGRTcXJfMT10LmFzbS5rZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxMYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbEFuZ3VsYXJEYW1waW5nVGhyZXNob2xkU3FyXzA9ZnVuY3Rpb24oKXtyZXR1cm4oTGE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ1RocmVzaG9sZFNxcl8wPXQuYXNtLmxmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEhhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9hZGRpdGlvbmFsQW5ndWxhckRhbXBpbmdUaHJlc2hvbGRTcXJfMT1mdW5jdGlvbigpe3JldHVybihIYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbEFuZ3VsYXJEYW1waW5nVGhyZXNob2xkU3FyXzE9dC5hc20ubWYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWWE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ0ZhY3Rvcl8wPWZ1bmN0aW9uKCl7cmV0dXJuKFlhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9hZGRpdGlvbmFsQW5ndWxhckRhbXBpbmdGYWN0b3JfMD10LmFzbS5uZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxWYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbEFuZ3VsYXJEYW1waW5nRmFjdG9yXzE9ZnVuY3Rpb24oKXtyZXR1cm4oVmE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ0ZhY3Rvcl8xPXQuYXNtLm9mKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKFFhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19fX2Rlc3Ryb3lfX18wPXQuYXNtLnBmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEVhPXQuX2ViX2J0UmlnaWRCb2R5X2J0UmlnaWRCb2R5XzE9ZnVuY3Rpb24oKXtyZXR1cm4oRWE9dC5fZWJfYnRSaWdpZEJvZHlfYnRSaWdpZEJvZHlfMT10LmFzbS5xZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxYYT10Ll9lYl9idFJpZ2lkQm9keV9nZXRDZW50ZXJPZk1hc3NUcmFuc2Zvcm1fMD1mdW5jdGlvbigpe3JldHVybihYYT10Ll9lYl9idFJpZ2lkQm9keV9nZXRDZW50ZXJPZk1hc3NUcmFuc2Zvcm1fMD10LmFzbS5yZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxVYT10Ll9lYl9idFJpZ2lkQm9keV9zZXRDZW50ZXJPZk1hc3NUcmFuc2Zvcm1fMT1mdW5jdGlvbigpe3JldHVybihVYT10Ll9lYl9idFJpZ2lkQm9keV9zZXRDZW50ZXJPZk1hc3NUcmFuc2Zvcm1fMT10LmFzbS5zZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHYT10Ll9lYl9idFJpZ2lkQm9keV9zZXRTbGVlcGluZ1RocmVzaG9sZHNfMj1mdW5jdGlvbigpe3JldHVybihHYT10Ll9lYl9idFJpZ2lkQm9keV9zZXRTbGVlcGluZ1RocmVzaG9sZHNfMj10LmFzbS50ZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxOYT10Ll9lYl9idFJpZ2lkQm9keV9nZXRMaW5lYXJEYW1waW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oTmE9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0TGluZWFyRGFtcGluZ18wPXQuYXNtLnVmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHphPXQuX2ViX2J0UmlnaWRCb2R5X2dldEFuZ3VsYXJEYW1waW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oemE9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0QW5ndWxhckRhbXBpbmdfMD10LmFzbS52ZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxYT10Ll9lYl9idFJpZ2lkQm9keV9zZXREYW1waW5nXzI9ZnVuY3Rpb24oKXtyZXR1cm4ocWE9dC5fZWJfYnRSaWdpZEJvZHlfc2V0RGFtcGluZ18yPXQuYXNtLndmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFphPXQuX2ViX2J0UmlnaWRCb2R5X3NldE1hc3NQcm9wc18yPWZ1bmN0aW9uKCl7cmV0dXJuKFphPXQuX2ViX2J0UmlnaWRCb2R5X3NldE1hc3NQcm9wc18yPXQuYXNtLnhmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEthPXQuX2ViX2J0UmlnaWRCb2R5X2dldExpbmVhckZhY3Rvcl8wPWZ1bmN0aW9uKCl7cmV0dXJuKEthPXQuX2ViX2J0UmlnaWRCb2R5X2dldExpbmVhckZhY3Rvcl8wPXQuYXNtLnlmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LCRhPXQuX2ViX2J0UmlnaWRCb2R5X3NldExpbmVhckZhY3Rvcl8xPWZ1bmN0aW9uKCl7cmV0dXJuKCRhPXQuX2ViX2J0UmlnaWRCb2R5X3NldExpbmVhckZhY3Rvcl8xPXQuYXNtLnpmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEphPXQuX2ViX2J0UmlnaWRCb2R5X2FwcGx5VG9ycXVlXzE9ZnVuY3Rpb24oKXtyZXR1cm4oSmE9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlUb3JxdWVfMT10LmFzbS5BZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0cz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUxvY2FsVG9ycXVlXzE9ZnVuY3Rpb24oKXtyZXR1cm4odHM9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlMb2NhbFRvcnF1ZV8xPXQuYXNtLkJmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGVzPXQuX2ViX2J0UmlnaWRCb2R5X2FwcGx5Rm9yY2VfMj1mdW5jdGlvbigpe3JldHVybihlcz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUZvcmNlXzI9dC5hc20uQ2YpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sb3M9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlDZW50cmFsRm9yY2VfMT1mdW5jdGlvbigpe3JldHVybihvcz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUNlbnRyYWxGb3JjZV8xPXQuYXNtLkRmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG5zPXQuX2ViX2J0UmlnaWRCb2R5X2FwcGx5Q2VudHJhbExvY2FsRm9yY2VfMT1mdW5jdGlvbigpe3JldHVybihucz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUNlbnRyYWxMb2NhbEZvcmNlXzE9dC5hc20uRWYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scnM9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlUb3JxdWVJbXB1bHNlXzE9ZnVuY3Rpb24oKXtyZXR1cm4ocnM9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlUb3JxdWVJbXB1bHNlXzE9dC5hc20uRmYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sX3M9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlJbXB1bHNlXzI9ZnVuY3Rpb24oKXtyZXR1cm4oX3M9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlJbXB1bHNlXzI9dC5hc20uR2YpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saXM9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlDZW50cmFsSW1wdWxzZV8xPWZ1bmN0aW9uKCl7cmV0dXJuKGlzPXQuX2ViX2J0UmlnaWRCb2R5X2FwcGx5Q2VudHJhbEltcHVsc2VfMT10LmFzbS5IZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxhcz10Ll9lYl9idFJpZ2lkQm9keV91cGRhdGVJbmVydGlhVGVuc29yXzA9ZnVuY3Rpb24oKXtyZXR1cm4oYXM9dC5fZWJfYnRSaWdpZEJvZHlfdXBkYXRlSW5lcnRpYVRlbnNvcl8wPXQuYXNtLklmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHNzPXQuX2ViX2J0UmlnaWRCb2R5X2dldExpbmVhclZlbG9jaXR5XzA9ZnVuY3Rpb24oKXtyZXR1cm4oc3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0TGluZWFyVmVsb2NpdHlfMD10LmFzbS5KZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxwcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRBbmd1bGFyVmVsb2NpdHlfMD1mdW5jdGlvbigpe3JldHVybihwcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRBbmd1bGFyVmVsb2NpdHlfMD10LmFzbS5LZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxscz10Ll9lYl9idFJpZ2lkQm9keV9zZXRMaW5lYXJWZWxvY2l0eV8xPWZ1bmN0aW9uKCl7cmV0dXJuKGxzPXQuX2ViX2J0UmlnaWRCb2R5X3NldExpbmVhclZlbG9jaXR5XzE9dC5hc20uTGYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdXM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0QW5ndWxhclZlbG9jaXR5XzE9ZnVuY3Rpb24oKXtyZXR1cm4odXM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0QW5ndWxhclZlbG9jaXR5XzE9dC5hc20uTWYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sY3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0TW90aW9uU3RhdGVfMD1mdW5jdGlvbigpe3JldHVybihjcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRNb3Rpb25TdGF0ZV8wPXQuYXNtLk5mKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlzPXQuX2ViX2J0UmlnaWRCb2R5X3NldE1vdGlvblN0YXRlXzE9ZnVuY3Rpb24oKXtyZXR1cm4oeXM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0TW90aW9uU3RhdGVfMT10LmFzbS5PZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxocz10Ll9lYl9idFJpZ2lkQm9keV9nZXRBbmd1bGFyRmFjdG9yXzA9ZnVuY3Rpb24oKXtyZXR1cm4oaHM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0QW5ndWxhckZhY3Rvcl8wPXQuYXNtLlBmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGZzPXQuX2ViX2J0UmlnaWRCb2R5X3NldEFuZ3VsYXJGYWN0b3JfMT1mdW5jdGlvbigpe3JldHVybihmcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRBbmd1bGFyRmFjdG9yXzE9dC5hc20uUWYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbXM9dC5fZWJfYnRSaWdpZEJvZHlfdXBjYXN0XzE9ZnVuY3Rpb24oKXtyZXR1cm4obXM9dC5fZWJfYnRSaWdpZEJvZHlfdXBjYXN0XzE9dC5hc20uUmYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYnM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0QWFiYl8yPWZ1bmN0aW9uKCl7cmV0dXJuKGJzPXQuX2ViX2J0UmlnaWRCb2R5X2dldEFhYmJfMj10LmFzbS5TZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxncz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUdyYXZpdHlfMD1mdW5jdGlvbigpe3JldHVybihncz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUdyYXZpdHlfMD10LmFzbS5UZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxkcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRHcmF2aXR5XzA9ZnVuY3Rpb24oKXtyZXR1cm4oZHM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0R3Jhdml0eV8wPXQuYXNtLlVmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFdzPXQuX2ViX2J0UmlnaWRCb2R5X3NldEdyYXZpdHlfMT1mdW5jdGlvbigpe3JldHVybihXcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRHcmF2aXR5XzE9dC5hc20uVmYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQ3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0QnJvYWRwaGFzZVByb3h5XzA9ZnVuY3Rpb24oKXtyZXR1cm4oQ3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0QnJvYWRwaGFzZVByb3h5XzA9dC5hc20uV2YpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sanM9dC5fZWJfYnRSaWdpZEJvZHlfY2xlYXJGb3JjZXNfMD1mdW5jdGlvbigpe3JldHVybihqcz10Ll9lYl9idFJpZ2lkQm9keV9jbGVhckZvcmNlc18wPXQuYXNtLlhmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHZzPXQuX2ViX2J0UmlnaWRCb2R5X3NldEFuaXNvdHJvcGljRnJpY3Rpb25fMj1mdW5jdGlvbigpe3JldHVybih2cz10Ll9lYl9idFJpZ2lkQm9keV9zZXRBbmlzb3Ryb3BpY0ZyaWN0aW9uXzI9dC5hc20uWWYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRHM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0Q29sbGlzaW9uU2hhcGVfMD1mdW5jdGlvbigpe3JldHVybihEcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRDb2xsaXNpb25TaGFwZV8wPXQuYXNtLlpmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFJzPXQuX2ViX2J0UmlnaWRCb2R5X3NldENvbnRhY3RQcm9jZXNzaW5nVGhyZXNob2xkXzE9ZnVuY3Rpb24oKXtyZXR1cm4oUnM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0Q29udGFjdFByb2Nlc3NpbmdUaHJlc2hvbGRfMT10LmFzbS5fZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxTcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRBY3RpdmF0aW9uU3RhdGVfMT1mdW5jdGlvbigpe3JldHVybihTcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRBY3RpdmF0aW9uU3RhdGVfMT10LmFzbS4kZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxJcz10Ll9lYl9idFJpZ2lkQm9keV9mb3JjZUFjdGl2YXRpb25TdGF0ZV8xPWZ1bmN0aW9uKCl7cmV0dXJuKElzPXQuX2ViX2J0UmlnaWRCb2R5X2ZvcmNlQWN0aXZhdGlvblN0YXRlXzE9dC5hc20uYWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sT3M9dC5fZWJfYnRSaWdpZEJvZHlfYWN0aXZhdGVfMD1mdW5jdGlvbigpe3JldHVybihPcz10Ll9lYl9idFJpZ2lkQm9keV9hY3RpdmF0ZV8wPXQuYXNtLmJnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEJzPXQuX2ViX2J0UmlnaWRCb2R5X2FjdGl2YXRlXzE9ZnVuY3Rpb24oKXtyZXR1cm4oQnM9dC5fZWJfYnRSaWdpZEJvZHlfYWN0aXZhdGVfMT10LmFzbS5jZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxQcz10Ll9lYl9idFJpZ2lkQm9keV9pc0FjdGl2ZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFBzPXQuX2ViX2J0UmlnaWRCb2R5X2lzQWN0aXZlXzA9dC5hc20uZGcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0seHM9dC5fZWJfYnRSaWdpZEJvZHlfaXNLaW5lbWF0aWNPYmplY3RfMD1mdW5jdGlvbigpe3JldHVybih4cz10Ll9lYl9idFJpZ2lkQm9keV9pc0tpbmVtYXRpY09iamVjdF8wPXQuYXNtLmVnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFRzPXQuX2ViX2J0UmlnaWRCb2R5X2lzU3RhdGljT2JqZWN0XzA9ZnVuY3Rpb24oKXtyZXR1cm4oVHM9dC5fZWJfYnRSaWdpZEJvZHlfaXNTdGF0aWNPYmplY3RfMD10LmFzbS5mZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxGcz10Ll9lYl9idFJpZ2lkQm9keV9pc1N0YXRpY09yS2luZW1hdGljT2JqZWN0XzA9ZnVuY3Rpb24oKXtyZXR1cm4oRnM9dC5fZWJfYnRSaWdpZEJvZHlfaXNTdGF0aWNPcktpbmVtYXRpY09iamVjdF8wPXQuYXNtLmdnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE1zPXQuX2ViX2J0UmlnaWRCb2R5X2dldFJlc3RpdHV0aW9uXzA9ZnVuY3Rpb24oKXtyZXR1cm4oTXM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0UmVzdGl0dXRpb25fMD10LmFzbS5oZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxBcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRGcmljdGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKEFzPXQuX2ViX2J0UmlnaWRCb2R5X2dldEZyaWN0aW9uXzA9dC5hc20uaWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sd3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0Um9sbGluZ0ZyaWN0aW9uXzA9ZnVuY3Rpb24oKXtyZXR1cm4od3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0Um9sbGluZ0ZyaWN0aW9uXzA9dC5hc20uamcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sa3M9dC5fZWJfYnRSaWdpZEJvZHlfc2V0UmVzdGl0dXRpb25fMT1mdW5jdGlvbigpe3JldHVybihrcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRSZXN0aXR1dGlvbl8xPXQuYXNtLmtnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LExzPXQuX2ViX2J0UmlnaWRCb2R5X3NldEZyaWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oTHM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0RnJpY3Rpb25fMT10LmFzbS5sZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxIcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRSb2xsaW5nRnJpY3Rpb25fMT1mdW5jdGlvbigpe3JldHVybihIcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRSb2xsaW5nRnJpY3Rpb25fMT10LmFzbS5tZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxZcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRXb3JsZFRyYW5zZm9ybV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFlzPXQuX2ViX2J0UmlnaWRCb2R5X2dldFdvcmxkVHJhbnNmb3JtXzA9dC5hc20ubmcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVnM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0Q29sbGlzaW9uRmxhZ3NfMD1mdW5jdGlvbigpe3JldHVybihWcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRDb2xsaXNpb25GbGFnc18wPXQuYXNtLm9nKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFzPXQuX2ViX2J0UmlnaWRCb2R5X3NldENvbGxpc2lvbkZsYWdzXzE9ZnVuY3Rpb24oKXtyZXR1cm4oUXM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0Q29sbGlzaW9uRmxhZ3NfMT10LmFzbS5wZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxFcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRXb3JsZFRyYW5zZm9ybV8xPWZ1bmN0aW9uKCl7cmV0dXJuKEVzPXQuX2ViX2J0UmlnaWRCb2R5X3NldFdvcmxkVHJhbnNmb3JtXzE9dC5hc20ucWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWHM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0Q29sbGlzaW9uU2hhcGVfMT1mdW5jdGlvbigpe3JldHVybihYcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRDb2xsaXNpb25TaGFwZV8xPXQuYXNtLnJnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFVzPXQuX2ViX2J0UmlnaWRCb2R5X3NldENjZE1vdGlvblRocmVzaG9sZF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFVzPXQuX2ViX2J0UmlnaWRCb2R5X3NldENjZE1vdGlvblRocmVzaG9sZF8xPXQuYXNtLnNnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEdzPXQuX2ViX2J0UmlnaWRCb2R5X3NldENjZFN3ZXB0U3BoZXJlUmFkaXVzXzE9ZnVuY3Rpb24oKXtyZXR1cm4oR3M9dC5fZWJfYnRSaWdpZEJvZHlfc2V0Q2NkU3dlcHRTcGhlcmVSYWRpdXNfMT10LmFzbS50ZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxOcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRVc2VySW5kZXhfMD1mdW5jdGlvbigpe3JldHVybihOcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRVc2VySW5kZXhfMD10LmFzbS51ZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx6cz10Ll9lYl9idFJpZ2lkQm9keV9zZXRVc2VySW5kZXhfMT1mdW5jdGlvbigpe3JldHVybih6cz10Ll9lYl9idFJpZ2lkQm9keV9zZXRVc2VySW5kZXhfMT10LmFzbS52ZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRVc2VyUG9pbnRlcl8wPWZ1bmN0aW9uKCl7cmV0dXJuKHFzPXQuX2ViX2J0UmlnaWRCb2R5X2dldFVzZXJQb2ludGVyXzA9dC5hc20ud2cpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWnM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0VXNlclBvaW50ZXJfMT1mdW5jdGlvbigpe3JldHVybihacz10Ll9lYl9idFJpZ2lkQm9keV9zZXRVc2VyUG9pbnRlcl8xPXQuYXNtLnhnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEtzPXQuX2ViX2J0UmlnaWRCb2R5X2dldEJyb2FkcGhhc2VIYW5kbGVfMD1mdW5jdGlvbigpe3JldHVybihLcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRCcm9hZHBoYXNlSGFuZGxlXzA9dC5hc20ueWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sJHM9dC5fZWJfYnRSaWdpZEJvZHlfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybigkcz10Ll9lYl9idFJpZ2lkQm9keV9fX2Rlc3Ryb3lfX18wPXQuYXNtLnpnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEpzPXQuX2ViX2J0U2VxdWVudGlhbEltcHVsc2VDb25zdHJhaW50U29sdmVyX2J0U2VxdWVudGlhbEltcHVsc2VDb25zdHJhaW50U29sdmVyXzA9ZnVuY3Rpb24oKXtyZXR1cm4oSnM9dC5fZWJfYnRTZXF1ZW50aWFsSW1wdWxzZUNvbnN0cmFpbnRTb2x2ZXJfYnRTZXF1ZW50aWFsSW1wdWxzZUNvbnN0cmFpbnRTb2x2ZXJfMD10LmFzbS5BZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0cD10Ll9lYl9idFNlcXVlbnRpYWxJbXB1bHNlQ29uc3RyYWludFNvbHZlcl9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKHRwPXQuX2ViX2J0U2VxdWVudGlhbEltcHVsc2VDb25zdHJhaW50U29sdmVyX19fZGVzdHJveV9fXzA9dC5hc20uQmcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZXA9dC5fZWJfYnRDb25zdHJhaW50U29sdmVyX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oZXA9dC5fZWJfYnRDb25zdHJhaW50U29sdmVyX19fZGVzdHJveV9fXzA9dC5hc20uQ2cpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sb3A9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV90aW1lU3RlcF8wPWZ1bmN0aW9uKCl7cmV0dXJuKG9wPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fdGltZVN0ZXBfMD10LmFzbS5EZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxucD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX3RpbWVTdGVwXzE9ZnVuY3Rpb24oKXtyZXR1cm4obnA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV90aW1lU3RlcF8xPXQuYXNtLkVnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHJwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fc3RlcENvdW50XzA9ZnVuY3Rpb24oKXtyZXR1cm4ocnA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9zdGVwQ291bnRfMD10LmFzbS5GZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxfcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX3N0ZXBDb3VudF8xPWZ1bmN0aW9uKCl7cmV0dXJuKF9wPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fc3RlcENvdW50XzE9dC5hc20uR2cpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saXA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9kaXNwYXRjaEZ1bmNfMD1mdW5jdGlvbigpe3JldHVybihpcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX2Rpc3BhdGNoRnVuY18wPXQuYXNtLkhnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGFwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fZGlzcGF0Y2hGdW5jXzE9ZnVuY3Rpb24oKXtyZXR1cm4oYXA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV9kaXNwYXRjaEZ1bmNfMT10LmFzbS5JZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxzcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX3RpbWVPZkltcGFjdF8wPWZ1bmN0aW9uKCl7cmV0dXJuKHNwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fdGltZU9mSW1wYWN0XzA9dC5hc20uSmcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scHA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV90aW1lT2ZJbXBhY3RfMT1mdW5jdGlvbigpe3JldHVybihwcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX3RpbWVPZkltcGFjdF8xPXQuYXNtLktnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGxwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fdXNlQ29udGludW91c18wPWZ1bmN0aW9uKCl7cmV0dXJuKGxwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fdXNlQ29udGludW91c18wPXQuYXNtLkxnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHVwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fdXNlQ29udGludW91c18xPWZ1bmN0aW9uKCl7cmV0dXJuKHVwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fdXNlQ29udGludW91c18xPXQuYXNtLk1nKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGNwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fZW5hYmxlU2F0Q29udmV4XzA9ZnVuY3Rpb24oKXtyZXR1cm4oY3A9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9lbmFibGVTYXRDb252ZXhfMD10LmFzbS5OZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx5cD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX2VuYWJsZVNhdENvbnZleF8xPWZ1bmN0aW9uKCl7cmV0dXJuKHlwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fZW5hYmxlU2F0Q29udmV4XzE9dC5hc20uT2cpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saHA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9lbmFibGVTUFVfMD1mdW5jdGlvbigpe3JldHVybihocD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX2VuYWJsZVNQVV8wPXQuYXNtLlBnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGZwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fZW5hYmxlU1BVXzE9ZnVuY3Rpb24oKXtyZXR1cm4oZnA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV9lbmFibGVTUFVfMT10LmFzbS5RZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxtcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX3VzZUVwYV8wPWZ1bmN0aW9uKCl7cmV0dXJuKG1wPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fdXNlRXBhXzA9dC5hc20uUmcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYnA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV91c2VFcGFfMT1mdW5jdGlvbigpe3JldHVybihicD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX3VzZUVwYV8xPXQuYXNtLlNnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGdwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fYWxsb3dlZENjZFBlbmV0cmF0aW9uXzA9ZnVuY3Rpb24oKXtyZXR1cm4oZ3A9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9hbGxvd2VkQ2NkUGVuZXRyYXRpb25fMD10LmFzbS5UZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxkcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX2FsbG93ZWRDY2RQZW5ldHJhdGlvbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGRwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fYWxsb3dlZENjZFBlbmV0cmF0aW9uXzE9dC5hc20uVWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sV3A9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV91c2VDb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVV0aWxfMD1mdW5jdGlvbigpe3JldHVybihXcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX3VzZUNvbnZleENvbnNlcnZhdGl2ZURpc3RhbmNlVXRpbF8wPXQuYXNtLlZnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LENwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fdXNlQ29udmV4Q29uc2VydmF0aXZlRGlzdGFuY2VVdGlsXzE9ZnVuY3Rpb24oKXtyZXR1cm4oQ3A9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV91c2VDb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVV0aWxfMT10LmFzbS5XZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxqcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX2NvbnZleENvbnNlcnZhdGl2ZURpc3RhbmNlVGhyZXNob2xkXzA9ZnVuY3Rpb24oKXtyZXR1cm4oanA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9jb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVRocmVzaG9sZF8wPXQuYXNtLlhnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHZwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fY29udmV4Q29uc2VydmF0aXZlRGlzdGFuY2VUaHJlc2hvbGRfMT1mdW5jdGlvbigpe3JldHVybih2cD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX2NvbnZleENvbnNlcnZhdGl2ZURpc3RhbmNlVGhyZXNob2xkXzE9dC5hc20uWWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRHA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKERwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fX19kZXN0cm95X19fMD10LmFzbS5aZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxScD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX2dldF9tX3NwbGl0SW1wdWxzZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFJwPXQuX2ViX2J0Q29udGFjdFNvbHZlckluZm9fZ2V0X21fc3BsaXRJbXB1bHNlXzA9dC5hc20uX2cpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sU3A9dC5fZWJfYnRDb250YWN0U29sdmVySW5mb19zZXRfbV9zcGxpdEltcHVsc2VfMT1mdW5jdGlvbigpe3JldHVybihTcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX3NldF9tX3NwbGl0SW1wdWxzZV8xPXQuYXNtLiRnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LElwPXQuX2ViX2J0Q29udGFjdFNvbHZlckluZm9fZ2V0X21fc3BsaXRJbXB1bHNlUGVuZXRyYXRpb25UaHJlc2hvbGRfMD1mdW5jdGlvbigpe3JldHVybihJcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX2dldF9tX3NwbGl0SW1wdWxzZVBlbmV0cmF0aW9uVGhyZXNob2xkXzA9dC5hc20uYWgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sT3A9dC5fZWJfYnRDb250YWN0U29sdmVySW5mb19zZXRfbV9zcGxpdEltcHVsc2VQZW5ldHJhdGlvblRocmVzaG9sZF8xPWZ1bmN0aW9uKCl7cmV0dXJuKE9wPXQuX2ViX2J0Q29udGFjdFNvbHZlckluZm9fc2V0X21fc3BsaXRJbXB1bHNlUGVuZXRyYXRpb25UaHJlc2hvbGRfMT10LmFzbS5iaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxCcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX2dldF9tX251bUl0ZXJhdGlvbnNfMD1mdW5jdGlvbigpe3JldHVybihCcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX2dldF9tX251bUl0ZXJhdGlvbnNfMD10LmFzbS5jaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxQcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX3NldF9tX251bUl0ZXJhdGlvbnNfMT1mdW5jdGlvbigpe3JldHVybihQcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX3NldF9tX251bUl0ZXJhdGlvbnNfMT10LmFzbS5kaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx4cD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oeHA9dC5fZWJfYnRDb250YWN0U29sdmVySW5mb19fX2Rlc3Ryb3lfX18wPXQuYXNtLmVoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFRwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkXzQ9ZnVuY3Rpb24oKXtyZXR1cm4oVHA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfND10LmFzbS5maCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxGcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zZXRHcmF2aXR5XzE9ZnVuY3Rpb24oKXtyZXR1cm4oRnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc2V0R3Jhdml0eV8xPXQuYXNtLmdoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE1wPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX2dldEdyYXZpdHlfMD1mdW5jdGlvbigpe3JldHVybihNcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9nZXRHcmF2aXR5XzA9dC5hc20uaGgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkUmlnaWRCb2R5XzE9ZnVuY3Rpb24oKXtyZXR1cm4oQXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkUmlnaWRCb2R5XzE9dC5hc20uaWgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sd3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkUmlnaWRCb2R5XzM9ZnVuY3Rpb24oKXtyZXR1cm4od3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkUmlnaWRCb2R5XzM9dC5hc20uamgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sa3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfcmVtb3ZlUmlnaWRCb2R5XzE9ZnVuY3Rpb24oKXtyZXR1cm4oa3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfcmVtb3ZlUmlnaWRCb2R5XzE9dC5hc20ua2gpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTHA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc3RlcFNpbXVsYXRpb25fMT1mdW5jdGlvbigpe3JldHVybihMcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zdGVwU2ltdWxhdGlvbl8xPXQuYXNtLmxoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEhwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3N0ZXBTaW11bGF0aW9uXzI9ZnVuY3Rpb24oKXtyZXR1cm4oSHA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc3RlcFNpbXVsYXRpb25fMj10LmFzbS5taCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxZcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zdGVwU2ltdWxhdGlvbl8zPWZ1bmN0aW9uKCl7cmV0dXJuKFlwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3N0ZXBTaW11bGF0aW9uXzM9dC5hc20ubmgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc2V0Q29udGFjdEFkZGVkQ2FsbGJhY2tfMT1mdW5jdGlvbigpe3JldHVybihWcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zZXRDb250YWN0QWRkZWRDYWxsYmFja18xPXQuYXNtLm9oKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldENvbnRhY3RQcm9jZXNzZWRDYWxsYmFja18xPWZ1bmN0aW9uKCl7cmV0dXJuKFFwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldENvbnRhY3RQcm9jZXNzZWRDYWxsYmFja18xPXQuYXNtLnBoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEVwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldENvbnRhY3REZXN0cm95ZWRDYWxsYmFja18xPWZ1bmN0aW9uKCl7cmV0dXJuKEVwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldENvbnRhY3REZXN0cm95ZWRDYWxsYmFja18xPXQuYXNtLnFoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFhwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX2dldERpc3BhdGNoZXJfMD1mdW5jdGlvbigpe3JldHVybihYcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9nZXREaXNwYXRjaGVyXzA9dC5hc20ucmgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0UGFpckNhY2hlXzA9ZnVuY3Rpb24oKXtyZXR1cm4oVXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0UGFpckNhY2hlXzA9dC5hc20uc2gpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sR3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0RGlzcGF0Y2hJbmZvXzA9ZnVuY3Rpb24oKXtyZXR1cm4oR3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0RGlzcGF0Y2hJbmZvXzA9dC5hc20udGgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzE9ZnVuY3Rpb24oKXtyZXR1cm4oTnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20udWgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0senA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzI9ZnVuY3Rpb24oKXtyZXR1cm4oenA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzI9dC5hc20udmgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzM9ZnVuY3Rpb24oKXtyZXR1cm4ocXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzM9dC5hc20ud2gpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfcmVtb3ZlQ29sbGlzaW9uT2JqZWN0XzE9ZnVuY3Rpb24oKXtyZXR1cm4oWnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfcmVtb3ZlQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20ueGgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sS3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0QnJvYWRwaGFzZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKEtwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX2dldEJyb2FkcGhhc2VfMD10LmFzbS55aCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSwkcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9jb252ZXhTd2VlcFRlc3RfNT1mdW5jdGlvbigpe3JldHVybigkcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9jb252ZXhTd2VlcFRlc3RfNT10LmFzbS56aCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxKcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9jb250YWN0UGFpclRlc3RfMz1mdW5jdGlvbigpe3JldHVybihKcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9jb250YWN0UGFpclRlc3RfMz10LmFzbS5BaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0bD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9jb250YWN0VGVzdF8yPWZ1bmN0aW9uKCl7cmV0dXJuKHRsPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX2NvbnRhY3RUZXN0XzI9dC5hc20uQmgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZWw9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfdXBkYXRlU2luZ2xlQWFiYl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGVsPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3VwZGF0ZVNpbmdsZUFhYmJfMT10LmFzbS5DaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvbD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9hZGRBY3Rpb25fMT1mdW5jdGlvbigpe3JldHVybihvbD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9hZGRBY3Rpb25fMT10LmFzbS5EaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxubD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9yZW1vdmVBY3Rpb25fMT1mdW5jdGlvbigpe3JldHVybihubD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9yZW1vdmVBY3Rpb25fMT10LmFzbS5FaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxybD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9nZXRTb2x2ZXJJbmZvXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocmw9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0U29sdmVySW5mb18wPXQuYXNtLkZoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9sPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldEludGVybmFsVGlja0NhbGxiYWNrXzE9ZnVuY3Rpb24oKXtyZXR1cm4oX2w9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMT10LmFzbS5HaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxpbD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zZXRJbnRlcm5hbFRpY2tDYWxsYmFja18yPWZ1bmN0aW9uKCl7cmV0dXJuKGlsPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldEludGVybmFsVGlja0NhbGxiYWNrXzI9dC5hc20uSGgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYWw9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMz1mdW5jdGlvbigpe3JldHVybihhbD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zZXRJbnRlcm5hbFRpY2tDYWxsYmFja18zPXQuYXNtLkloKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHNsPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oc2w9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfX19kZXN0cm95X19fMD10LmFzbS5KaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxwbD10Ll9lYl9idEFjdGlvbkludGVyZmFjZV91cGRhdGVBY3Rpb25fMj1mdW5jdGlvbigpe3JldHVybihwbD10Ll9lYl9idEFjdGlvbkludGVyZmFjZV91cGRhdGVBY3Rpb25fMj10LmFzbS5LaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxsbD10Ll9lYl9idEFjdGlvbkludGVyZmFjZV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKGxsPXQuX2ViX2J0QWN0aW9uSW50ZXJmYWNlX19fZGVzdHJveV9fXzA9dC5hc20uTGgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdWw9dC5fZW1zY3JpcHRlbl9lbnVtX1BIWV9TY2FsYXJUeXBlX1BIWV9GTE9BVD1mdW5jdGlvbigpe3JldHVybih1bD10Ll9lbXNjcmlwdGVuX2VudW1fUEhZX1NjYWxhclR5cGVfUEhZX0ZMT0FUPXQuYXNtLk1oKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGNsPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfRE9VQkxFPWZ1bmN0aW9uKCl7cmV0dXJuKGNsPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfRE9VQkxFPXQuYXNtLk5oKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlsPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfSU5URUdFUj1mdW5jdGlvbigpe3JldHVybih5bD10Ll9lbXNjcmlwdGVuX2VudW1fUEhZX1NjYWxhclR5cGVfUEhZX0lOVEVHRVI9dC5hc20uT2gpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saGw9dC5fZW1zY3JpcHRlbl9lbnVtX1BIWV9TY2FsYXJUeXBlX1BIWV9TSE9SVD1mdW5jdGlvbigpe3JldHVybihobD10Ll9lbXNjcmlwdGVuX2VudW1fUEhZX1NjYWxhclR5cGVfUEhZX1NIT1JUPXQuYXNtLlBoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGZsPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfRklYRURQT0lOVDg4PWZ1bmN0aW9uKCl7cmV0dXJuKGZsPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfRklYRURQT0lOVDg4PXQuYXNtLlFoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG1sPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfVUNIQVI9ZnVuY3Rpb24oKXtyZXR1cm4obWw9dC5fZW1zY3JpcHRlbl9lbnVtX1BIWV9TY2FsYXJUeXBlX1BIWV9VQ0hBUj10LmFzbS5SaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfTt0Ll9tYWxsb2M9ZnVuY3Rpb24oKXtyZXR1cm4odC5fbWFsbG9jPXQuYXNtLlNoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHQuX2ZyZWU9ZnVuY3Rpb24oKXtyZXR1cm4odC5fZnJlZT10LmFzbS5UaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0LmR5bkNhbGxfdmk9ZnVuY3Rpb24oKXtyZXR1cm4odC5keW5DYWxsX3ZpPXQuYXNtLlVoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHQuZHluQ2FsbF92PWZ1bmN0aW9uKCl7cmV0dXJuKHQuZHluQ2FsbF92PXQuYXNtLlZoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHQuYWRkRnVuY3Rpb249ZnVuY3Rpb24oZSxvKXtpZighQnQpe0J0PW5ldyBXZWFrTWFwO2Zvcih2YXIgbj0wO248V3QubGVuZ3RoO24rKyl7dmFyIHI9V3QuZ2V0KG4pO3ImJkJ0LnNldChyLG4pfX1pZihCdC5oYXMoZSkpZT1CdC5nZXQoZSk7ZWxzZXtpZihlZS5sZW5ndGgpbj1lZS5wb3AoKTtlbHNle249V3QubGVuZ3RoO3RyeXtXdC5ncm93KDEpfWNhdGNoKHl0KXt0aHJvdyB5dCBpbnN0YW5jZW9mIFJhbmdlRXJyb3I/IlVuYWJsZSB0byBncm93IHdhc20gdGFibGUuIFNldCBBTExPV19UQUJMRV9HUk9XVEguIjp5dH19dHJ5e1d0LnNldChuLGUpfWNhdGNoKHl0KXtpZighKHl0IGluc3RhbmNlb2YgVHlwZUVycm9yKSl0aHJvdyB5dDtpZih0eXBlb2YgV2ViQXNzZW1ibHkuRnVuY3Rpb249PSJmdW5jdGlvbiIpe3ZhciBjPXtpOiJpMzIiLGo6Imk2NCIsZjoiZjMyIixkOiJmNjQifSxEPXtwYXJhbWV0ZXJzOltdLHJlc3VsdHM6b1swXT09InYiP1tdOltjW29bMF1dXX07Zm9yKHI9MTtyPG8ubGVuZ3RoOysrcilELnBhcmFtZXRlcnMucHVzaChjW29bcl1dKTtvPW5ldyBXZWJBc3NlbWJseS5GdW5jdGlvbihELGUpfWVsc2V7Yz1bMSwwLDEsOTZdLEQ9by5zbGljZSgwLDEpLG89by5zbGljZSgxKTt2YXIgTj17aToxMjcsajoxMjYsZjoxMjUsZDoxMjR9O2ZvcihjLnB1c2goby5sZW5ndGgpLHI9MDtyPG8ubGVuZ3RoOysrciljLnB1c2goTltvW3JdXSk7RD09InYiP2MucHVzaCgwKTpjPWMuY29uY2F0KFsxLE5bRF1dKSxjWzFdPWMubGVuZ3RoLTIsbz1uZXcgVWludDhBcnJheShbMCw5NywxMTUsMTA5LDEsMCwwLDBdLmNvbmNhdChjLFsyLDcsMSwxLDEwMSwxLDEwMiwwLDAsNyw1LDEsMSwxMDIsMCwwXSkpLG89bmV3IFdlYkFzc2VtYmx5Lk1vZHVsZShvKSxvPW5ldyBXZWJBc3NlbWJseS5JbnN0YW5jZShvLHtlOntmOmV9fSkuZXhwb3J0cy5mfVd0LnNldChuLG8pfUJ0LnNldChlLG4pLGU9bn1yZXR1cm4gZX07dmFyIGllO3F0PWZ1bmN0aW9uIGUoKXtpZXx8V2UoKSxpZXx8KHF0PWUpfTtmdW5jdGlvbiBXZSgpe2Z1bmN0aW9uIGUoKXtpZighaWUmJihpZT0hMCx0LmNhbGxlZFJ1bj0hMCwhb2UpKXtpZihPZT0hMCxVdChfZSksVXQoVnQpLG0odCksdC5vblJ1bnRpbWVJbml0aWFsaXplZCYmdC5vblJ1bnRpbWVJbml0aWFsaXplZCgpLHQucG9zdFJ1bilmb3IodHlwZW9mIHQucG9zdFJ1bj09ImZ1bmN0aW9uIiYmKHQucG9zdFJ1bj1bdC5wb3N0UnVuXSk7dC5wb3N0UnVuLmxlbmd0aDspe3ZhciBvPXQucG9zdFJ1bi5zaGlmdCgpO0llLnVuc2hpZnQobyl9VXQoSWUpfX1pZighKDA8UXQpKXtpZih0LnByZVJ1bilmb3IodHlwZW9mIHQucHJlUnVuPT0iZnVuY3Rpb24iJiYodC5wcmVSdW49W3QucHJlUnVuXSk7dC5wcmVSdW4ubGVuZ3RoOylPbCgpO1V0KHJlKSwwPFF0fHwodC5zZXRTdGF0dXM/KHQuc2V0U3RhdHVzKCJSdW5uaW5nLi4uIiksc2V0VGltZW91dChmdW5jdGlvbigpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXt0LnNldFN0YXR1cygiIil9LDEpLGUoKX0sMSkpOmUoKSl9fWlmKHQucnVuPVdlLHQucHJlSW5pdClmb3IodHlwZW9mIHQucHJlSW5pdD09ImZ1bmN0aW9uIiYmKHQucHJlSW5pdD1bdC5wcmVJbml0XSk7MDx0LnByZUluaXQubGVuZ3RoOyl0LnByZUluaXQucG9wKCkoKTtXZSgpO2Z1bmN0aW9uIGIoKXt9Yi5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksYi5wcm90b3R5cGUuY29uc3RydWN0b3I9YixiLnByb3RvdHlwZS5YaD1iLGIuWWg9e30sdC5XcmFwcGVyT2JqZWN0PWI7ZnVuY3Rpb24gQShlKXtyZXR1cm4oZXx8YikuWWh9dC5nZXRDYWNoZT1BO2Z1bmN0aW9uIGEoZSxvKXt2YXIgbj1BKG8pLHI9bltlXTtyZXR1cm4gcnx8KHI9T2JqZWN0LmNyZWF0ZSgob3x8YikucHJvdG90eXBlKSxyLldoPWUsbltlXT1yKX10LndyYXBQb2ludGVyPWEsdC5jYXN0T2JqZWN0PWZ1bmN0aW9uKGUsbyl7cmV0dXJuIGEoZS5XaCxvKX0sdC5OVUxMPWEoMCksdC5kZXN0cm95PWZ1bmN0aW9uKGUpe2lmKCFlLl9fZGVzdHJveV9fKXRocm93IkVycm9yOiBDYW5ub3QgZGVzdHJveSBvYmplY3QuIChEaWQgeW91IGNyZWF0ZSBpdCB5b3Vyc2VsZj8pIjtlLl9fZGVzdHJveV9fKCksZGVsZXRlIEEoZS5YaClbZS5XaF19LHQuY29tcGFyZT1mdW5jdGlvbihlLG8pe3JldHVybiBlLldoPT09by5XaH0sdC5nZXRQb2ludGVyPWZ1bmN0aW9uKGUpe3JldHVybiBlLldofSx0LmdldENsYXNzPWZ1bmN0aW9uKGUpe3JldHVybiBlLlhofTt2YXIgRXQ9MCxhZT0wLHNlPTAscGU9W10sbGU9MDtmdW5jdGlvbiBDZSgpe2lmKGxlKXtmb3IodmFyIGU9MDtlPHBlLmxlbmd0aDtlKyspdC5fZnJlZShwZVtlXSk7cGUubGVuZ3RoPTAsdC5fZnJlZShFdCksRXQ9MCxhZSs9bGUsbGU9MH1FdHx8KGFlKz0xMjgsRXQ9dC5fbWFsbG9jKGFlKSxMdChFdCkpLHNlPTB9ZnVuY3Rpb24gYmwoZSl7aWYodHlwZW9mIGU9PSJvYmplY3QiKXtMdChFdCk7dmFyIG89ZS5sZW5ndGgqWHQuQllURVNfUEVSX0VMRU1FTlQ7aWYobz1vKzcmLTgsc2Urbz49YWUpe0x0KDA8byksbGUrPW87dmFyIG49dC5fbWFsbG9jKG8pO3BlLnB1c2gobil9ZWxzZSBuPUV0K3NlLHNlKz1vO3N3aXRjaChvPW4sbj1vPj4+MCxYdC5CWVRFU19QRVJfRUxFTUVOVCl7Y2FzZSAyOm4+Pj49MTticmVhaztjYXNlIDQ6bj4+Pj0yO2JyZWFrO2Nhc2UgODpuPj4+PTN9Zm9yKHZhciByPTA7cjxlLmxlbmd0aDtyKyspWHRbbityXT1lW3JdO3JldHVybiBvfXJldHVybiBlfWZ1bmN0aW9uIEwoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRDb2xsaXNpb25Xb3JsZCwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1MLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxMLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1MLEwucHJvdG90eXBlLlhoPUwsTC5ZaD17fSx0LmJ0Q29sbGlzaW9uV29ybGQ9TCxMLnByb3RvdHlwZS5nZXREaXNwYXRjaGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGEoRmUodGhpcy5XaCksSyl9LEwucHJvdG90eXBlLmdldFBhaXJDYWNoZT1mdW5jdGlvbigpe3JldHVybiBhKE1lKHRoaXMuV2gpLEopfSxMLnByb3RvdHlwZS5nZXREaXNwYXRjaEluZm89ZnVuY3Rpb24oKXtyZXR1cm4gYShBZSh0aGlzLldoKSxzKX0sTC5wcm90b3R5cGUuYWRkQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/d2UocixlKTpuPT09dm9pZCAwP2tlKHIsZSxvKTpMZShyLGUsbyxuKX0sTC5wcm90b3R5cGUucmVtb3ZlQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxIZShvLGUpfSxMLnByb3RvdHlwZS5nZXRCcm9hZHBoYXNlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoWWUodGhpcy5XaCksc3QpfSxMLnByb3RvdHlwZS5jb252ZXhTd2VlcFRlc3Q9ZnVuY3Rpb24oZSxvLG4scixjKXt2YXIgRD10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLHImJnR5cGVvZiByPT0ib2JqZWN0IiYmKHI9ci5XaCksYyYmdHlwZW9mIGM9PSJvYmplY3QiJiYoYz1jLldoKSxWZShELGUsbyxuLHIsYyl9LEwucHJvdG90eXBlLmNvbnRhY3RQYWlyVGVzdD1mdW5jdGlvbihlLG8sbil7dmFyIHI9dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSxRZShyLGUsbyxuKX0sTC5wcm90b3R5cGUuY29udGFjdFRlc3Q9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxFZShuLGUsbyl9LEwucHJvdG90eXBlLnVwZGF0ZVNpbmdsZUFhYmI9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFhlKG8sZSl9LEwucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7VWUodGhpcy5XaCl9O2Z1bmN0aW9uIHcoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRRdWFkV29yZCwgbm8gY29uc3RydWN0b3IgaW4gSURMIn13LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSx3LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj13LHcucHJvdG90eXBlLlhoPXcsdy5ZaD17fSx0LmJ0UXVhZFdvcmQ9dyx3LnByb3RvdHlwZS54PXcucHJvdG90eXBlLng9ZnVuY3Rpb24oKXtyZXR1cm4gR2UodGhpcy5XaCl9LHcucHJvdG90eXBlLnk9dy5wcm90b3R5cGUueT1mdW5jdGlvbigpe3JldHVybiBOZSh0aGlzLldoKX0sdy5wcm90b3R5cGUuej13LnByb3RvdHlwZS56PWZ1bmN0aW9uKCl7cmV0dXJuIHplKHRoaXMuV2gpfSx3LnByb3RvdHlwZS53PWZ1bmN0aW9uKCl7cmV0dXJuIHFlKHRoaXMuV2gpfSx3LnByb3RvdHlwZS5zZXRYPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxaZShvLGUpfSx3LnByb3RvdHlwZS5zZXRZPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxLZShvLGUpfSx3LnByb3RvdHlwZS5zZXRaPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSwkZShvLGUpfSx3LnByb3RvdHlwZS5zZXRXPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxKZShvLGUpfSx3LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe3RvKHRoaXMuV2gpfTtmdW5jdGlvbiBudCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidE1vdGlvblN0YXRlLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifW50LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxudC5wcm90b3R5cGUuY29uc3RydWN0b3I9bnQsbnQucHJvdG90eXBlLlhoPW50LG50LlloPXt9LHQuYnRNb3Rpb25TdGF0ZT1udCxudC5wcm90b3R5cGUuZ2V0V29ybGRUcmFuc2Zvcm09ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGVvKG8sZSl9LG50LnByb3RvdHlwZS5zZXRXb3JsZFRyYW5zZm9ybT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksb28obyxlKX0sbnQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7bm8odGhpcy5XaCl9O2Z1bmN0aW9uIEMoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRDb2xsaXNpb25PYmplY3QsIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9Qy5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksQy5wcm90b3R5cGUuY29uc3RydWN0b3I9QyxDLnByb3RvdHlwZS5YaD1DLEMuWWg9e30sdC5idENvbGxpc2lvbk9iamVjdD1DLEMucHJvdG90eXBlLnNldEFuaXNvdHJvcGljRnJpY3Rpb249ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxybyhuLGUsbyl9LEMucHJvdG90eXBlLmdldENvbGxpc2lvblNoYXBlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoX28odGhpcy5XaCksSCl9LEMucHJvdG90eXBlLnNldENvbnRhY3RQcm9jZXNzaW5nVGhyZXNob2xkPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxpbyhvLGUpfSxDLnByb3RvdHlwZS5zZXRBY3RpdmF0aW9uU3RhdGU9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGFvKG8sZSl9LEMucHJvdG90eXBlLmZvcmNlQWN0aXZhdGlvblN0YXRlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxzbyhvLGUpfSxDLnByb3RvdHlwZS5hY3RpdmF0ZT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZT09PXZvaWQgMD9wbyhvKTpsbyhvLGUpfSxDLnByb3RvdHlwZS5pc0FjdGl2ZT1mdW5jdGlvbigpe3JldHVybiEhdW8odGhpcy5XaCl9LEMucHJvdG90eXBlLmlzS2luZW1hdGljT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuISFjbyh0aGlzLldoKX0sQy5wcm90b3R5cGUuaXNTdGF0aWNPYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4hIXlvKHRoaXMuV2gpfSxDLnByb3RvdHlwZS5pc1N0YXRpY09yS2luZW1hdGljT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuISFobyh0aGlzLldoKX0sQy5wcm90b3R5cGUuZ2V0UmVzdGl0dXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gZm8odGhpcy5XaCl9LEMucHJvdG90eXBlLmdldEZyaWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIG1vKHRoaXMuV2gpfSxDLnByb3RvdHlwZS5nZXRSb2xsaW5nRnJpY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gYm8odGhpcy5XaCl9LEMucHJvdG90eXBlLnNldFJlc3RpdHV0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxnbyhvLGUpfSxDLnByb3RvdHlwZS5zZXRGcmljdGlvbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksV28obyxlKX0sQy5wcm90b3R5cGUuc2V0Um9sbGluZ0ZyaWN0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxDbyhvLGUpfSxDLnByb3RvdHlwZS5nZXRXb3JsZFRyYW5zZm9ybT1mdW5jdGlvbigpe3JldHVybiBhKGpvKHRoaXMuV2gpLE8pfSxDLnByb3RvdHlwZS5nZXRDb2xsaXNpb25GbGFncz1mdW5jdGlvbigpe3JldHVybiB2byh0aGlzLldoKX0sQy5wcm90b3R5cGUuc2V0Q29sbGlzaW9uRmxhZ3M9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLERvKG8sZSl9LEMucHJvdG90eXBlLnNldFdvcmxkVHJhbnNmb3JtPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxSbyhvLGUpfSxDLnByb3RvdHlwZS5zZXRDb2xsaXNpb25TaGFwZT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksU28obyxlKX0sQy5wcm90b3R5cGUuc2V0Q2NkTW90aW9uVGhyZXNob2xkPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxJbyhvLGUpfSxDLnByb3RvdHlwZS5zZXRDY2RTd2VwdFNwaGVyZVJhZGl1cz1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksT28obyxlKX0sQy5wcm90b3R5cGUuZ2V0VXNlckluZGV4PWZ1bmN0aW9uKCl7cmV0dXJuIEJvKHRoaXMuV2gpfSxDLnByb3RvdHlwZS5zZXRVc2VySW5kZXg9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFBvKG8sZSl9LEMucHJvdG90eXBlLmdldFVzZXJQb2ludGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGEoeG8odGhpcy5XaCksYnQpfSxDLnByb3RvdHlwZS5zZXRVc2VyUG9pbnRlcj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksVG8obyxlKX0sQy5wcm90b3R5cGUuZ2V0QnJvYWRwaGFzZUhhbmRsZT1mdW5jdGlvbigpe3JldHVybiBhKEZvKHRoaXMuV2gpLEIpfSxDLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe01vKHRoaXMuV2gpfTtmdW5jdGlvbiBtdCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBDb250YWN0UmVzdWx0Q2FsbGJhY2ssIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9bXQucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLG10LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1tdCxtdC5wcm90b3R5cGUuWGg9bXQsbXQuWWg9e30sdC5Db250YWN0UmVzdWx0Q2FsbGJhY2s9bXQsbXQucHJvdG90eXBlLmFkZFNpbmdsZVJlc3VsdD1mdW5jdGlvbihlLG8sbixyLGMsRCxOKXt2YXIgeXQ9dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksciYmdHlwZW9mIHI9PSJvYmplY3QiJiYocj1yLldoKSxjJiZ0eXBlb2YgYz09Im9iamVjdCImJihjPWMuV2gpLEQmJnR5cGVvZiBEPT0ib2JqZWN0IiYmKEQ9RC5XaCksTiYmdHlwZW9mIE49PSJvYmplY3QiJiYoTj1OLldoKSxBbyh5dCxlLG8sbixyLGMsRCxOKX0sbXQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7d28odGhpcy5XaCl9O2Z1bmN0aW9uIFIoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgQ29udmV4UmVzdWx0Q2FsbGJhY2ssIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9Ui5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksUi5wcm90b3R5cGUuY29uc3RydWN0b3I9UixSLnByb3RvdHlwZS5YaD1SLFIuWWg9e30sdC5Db252ZXhSZXN1bHRDYWxsYmFjaz1SLFIucHJvdG90eXBlLmhhc0hpdD1mdW5jdGlvbigpe3JldHVybiEha28odGhpcy5XaCl9LFIucHJvdG90eXBlLmdldF9tX2NvbGxpc2lvbkZpbHRlckdyb3VwPVIucHJvdG90eXBlLlpoPWZ1bmN0aW9uKCl7cmV0dXJuIExvKHRoaXMuV2gpfSxSLnByb3RvdHlwZS5zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cD1SLnByb3RvdHlwZS5haT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksSG8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KFIucHJvdG90eXBlLCJtX2NvbGxpc2lvbkZpbHRlckdyb3VwIix7Z2V0OlIucHJvdG90eXBlLlpoLHNldDpSLnByb3RvdHlwZS5haX0pLFIucHJvdG90eXBlLmdldF9tX2NvbGxpc2lvbkZpbHRlck1hc2s9Ui5wcm90b3R5cGUuJGg9ZnVuY3Rpb24oKXtyZXR1cm4gWW8odGhpcy5XaCl9LFIucHJvdG90eXBlLnNldF9tX2NvbGxpc2lvbkZpbHRlck1hc2s9Ui5wcm90b3R5cGUuYmk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFZvKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSLnByb3RvdHlwZSwibV9jb2xsaXNpb25GaWx0ZXJNYXNrIix7Z2V0OlIucHJvdG90eXBlLiRoLHNldDpSLnByb3RvdHlwZS5iaX0pLFIucHJvdG90eXBlLmdldF9tX2Nsb3Nlc3RIaXRGcmFjdGlvbj1SLnByb3RvdHlwZS5kaT1mdW5jdGlvbigpe3JldHVybiBRbyh0aGlzLldoKX0sUi5wcm90b3R5cGUuc2V0X21fY2xvc2VzdEhpdEZyYWN0aW9uPVIucHJvdG90eXBlLmZpPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxFbyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoUi5wcm90b3R5cGUsIm1fY2xvc2VzdEhpdEZyYWN0aW9uIix7Z2V0OlIucHJvdG90eXBlLmRpLHNldDpSLnByb3RvdHlwZS5maX0pLFIucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7WG8odGhpcy5XaCl9O2Z1bmN0aW9uIEgoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRDb2xsaXNpb25TaGFwZSwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1ILnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxILnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1ILEgucHJvdG90eXBlLlhoPUgsSC5ZaD17fSx0LmJ0Q29sbGlzaW9uU2hhcGU9SCxILnByb3RvdHlwZS5zZXRMb2NhbFNjYWxpbmc9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFVvKG8sZSl9LEgucHJvdG90eXBlLmdldExvY2FsU2NhbGluZz1mdW5jdGlvbigpe3JldHVybiBhKEdvKHRoaXMuV2gpLHkpfSxILnByb3RvdHlwZS5jYWxjdWxhdGVMb2NhbEluZXJ0aWE9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxObyhuLGUsbyl9LEgucHJvdG90eXBlLnNldE1hcmdpbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksem8obyxlKX0sSC5wcm90b3R5cGUuZ2V0TWFyZ2luPWZ1bmN0aW9uKCl7cmV0dXJuIHFvKHRoaXMuV2gpfSxILnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe1pvKHRoaXMuV2gpfTtmdW5jdGlvbiBLKCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0RGlzcGF0Y2hlciwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1LLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxLLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1LLEsucHJvdG90eXBlLlhoPUssSy5ZaD17fSx0LmJ0RGlzcGF0Y2hlcj1LLEsucHJvdG90eXBlLmdldE51bU1hbmlmb2xkcz1mdW5jdGlvbigpe3JldHVybiBLbyh0aGlzLldoKX0sSy5wcm90b3R5cGUuZ2V0TWFuaWZvbGRCeUluZGV4SW50ZXJuYWw9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKCRvKG8sZSkscSl9LEsucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7Sm8odGhpcy5XaCl9O2Z1bmN0aW9uIHgoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnREeW5hbWljc1dvcmxkLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifXgucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoTC5wcm90b3R5cGUpLHgucHJvdG90eXBlLmNvbnN0cnVjdG9yPXgseC5wcm90b3R5cGUuWGg9eCx4LlloPXt9LHQuYnREeW5hbWljc1dvcmxkPXgseC5wcm90b3R5cGUuYWRkQWN0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx0bihvLGUpfSx4LnByb3RvdHlwZS5yZW1vdmVBY3Rpb249ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGVuKG8sZSl9LHgucHJvdG90eXBlLmdldFNvbHZlckluZm89ZnVuY3Rpb24oKXtyZXR1cm4gYShvbih0aGlzLldoKSxTKX0seC5wcm90b3R5cGUuc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2s9ZnVuY3Rpb24oZSxvLG4pe3ZhciByPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksbz09PXZvaWQgMD9ubihyLGUpOm49PT12b2lkIDA/cm4ocixlLG8pOl9uKHIsZSxvLG4pfSx4LnByb3RvdHlwZS5nZXREaXNwYXRjaGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGEoYW4odGhpcy5XaCksSyl9LHgucHJvdG90eXBlLmdldFBhaXJDYWNoZT1mdW5jdGlvbigpe3JldHVybiBhKHNuKHRoaXMuV2gpLEopfSx4LnByb3RvdHlwZS5nZXREaXNwYXRjaEluZm89ZnVuY3Rpb24oKXtyZXR1cm4gYShwbih0aGlzLldoKSxzKX0seC5wcm90b3R5cGUuYWRkQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/bG4ocixlKTpuPT09dm9pZCAwP3VuKHIsZSxvKTpjbihyLGUsbyxuKX0seC5wcm90b3R5cGUucmVtb3ZlQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx5bihvLGUpfSx4LnByb3RvdHlwZS5nZXRCcm9hZHBoYXNlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoaG4odGhpcy5XaCksc3QpfSx4LnByb3RvdHlwZS5jb252ZXhTd2VlcFRlc3Q9ZnVuY3Rpb24oZSxvLG4scixjKXt2YXIgRD10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLHImJnR5cGVvZiByPT0ib2JqZWN0IiYmKHI9ci5XaCksYyYmdHlwZW9mIGM9PSJvYmplY3QiJiYoYz1jLldoKSxmbihELGUsbyxuLHIsYyl9LHgucHJvdG90eXBlLmNvbnRhY3RQYWlyVGVzdD1mdW5jdGlvbihlLG8sbil7dmFyIHI9dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSxtbihyLGUsbyxuKX0seC5wcm90b3R5cGUuY29udGFjdFRlc3Q9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxibihuLGUsbyl9LHgucHJvdG90eXBlLnVwZGF0ZVNpbmdsZUFhYmI9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGduKG8sZSl9LHgucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7ZG4odGhpcy5XaCl9O2Z1bmN0aW9uIGJ0KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIFZvaWRQdHIsIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9YnQucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLGJ0LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1idCxidC5wcm90b3R5cGUuWGg9YnQsYnQuWWg9e30sdC5Wb2lkUHRyPWJ0LGJ0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe1duKHRoaXMuV2gpfTtmdW5jdGlvbiB5KGUsbyxuKXtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSx0aGlzLldoPWU9PT12b2lkIDA/Q24oKTpvPT09dm9pZCAwP19lYl9idFZlY3RvcjNfYnRWZWN0b3IzXzEoZSk6bj09PXZvaWQgMD9fZWJfYnRWZWN0b3IzX2J0VmVjdG9yM18yKGUsbyk6am4oZSxvLG4pLEEoeSlbdGhpcy5XaF09dGhpc315LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSx5LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj15LHkucHJvdG90eXBlLlhoPXkseS5ZaD17fSx0LmJ0VmVjdG9yMz15LHkucHJvdG90eXBlLmxlbmd0aD15LnByb3RvdHlwZS5sZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gdm4odGhpcy5XaCl9LHkucHJvdG90eXBlLng9eS5wcm90b3R5cGUueD1mdW5jdGlvbigpe3JldHVybiBEbih0aGlzLldoKX0seS5wcm90b3R5cGUueT15LnByb3RvdHlwZS55PWZ1bmN0aW9uKCl7cmV0dXJuIFJuKHRoaXMuV2gpfSx5LnByb3RvdHlwZS56PXkucHJvdG90eXBlLno9ZnVuY3Rpb24oKXtyZXR1cm4gU24odGhpcy5XaCl9LHkucHJvdG90eXBlLnNldFg9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEluKG8sZSl9LHkucHJvdG90eXBlLnNldFk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLE9uKG8sZSl9LHkucHJvdG90eXBlLnNldFo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEJuKG8sZSl9LHkucHJvdG90eXBlLnNldFZhbHVlPWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLFBuKHIsZSxvLG4pfSx5LnByb3RvdHlwZS5ub3JtYWxpemU9eS5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7eG4odGhpcy5XaCl9LHkucHJvdG90eXBlLnJvdGF0ZT15LnByb3RvdHlwZS5yb3RhdGU9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksYShUbihuLGUsbykseSl9LHkucHJvdG90eXBlLmRvdD1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEZuKG8sZSl9LHkucHJvdG90eXBlLm9wX211bD1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGEoTW4obyxlKSx5KX0seS5wcm90b3R5cGUub3BfYWRkPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksYShBbihvLGUpLHkpfSx5LnByb3RvdHlwZS5vcF9zdWI9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKHduKG8sZSkseSl9LHkucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7a24odGhpcy5XaCl9O2Z1bmN0aW9uIGYoZSxvLG4scil7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksciYmdHlwZW9mIHI9PSJvYmplY3QiJiYocj1yLldoKSx0aGlzLldoPUxuKGUsbyxuLHIpLEEoZilbdGhpcy5XaF09dGhpc31mLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHcucHJvdG90eXBlKSxmLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1mLGYucHJvdG90eXBlLlhoPWYsZi5ZaD17fSx0LmJ0UXVhdGVybmlvbj1mLGYucHJvdG90eXBlLnNldFZhbHVlPWZ1bmN0aW9uKGUsbyxuLHIpe3ZhciBjPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksciYmdHlwZW9mIHI9PSJvYmplY3QiJiYocj1yLldoKSxIbihjLGUsbyxuLHIpfSxmLnByb3RvdHlwZS5zZXRFdWxlclpZWD1mdW5jdGlvbihlLG8sbil7dmFyIHI9dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSxZbihyLGUsbyxuKX0sZi5wcm90b3R5cGUuc2V0Um90YXRpb249ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxWbihuLGUsbyl9LGYucHJvdG90eXBlLm5vcm1hbGl6ZT1mLnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXtRbih0aGlzLldoKX0sZi5wcm90b3R5cGUubGVuZ3RoMj1mdW5jdGlvbigpe3JldHVybiBFbih0aGlzLldoKX0sZi5wcm90b3R5cGUubGVuZ3RoPWYucHJvdG90eXBlLmxlbmd0aD1mdW5jdGlvbigpe3JldHVybiBYbih0aGlzLldoKX0sZi5wcm90b3R5cGUuZG90PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksVW4obyxlKX0sZi5wcm90b3R5cGUubm9ybWFsaXplZD1mdW5jdGlvbigpe3JldHVybiBhKEduKHRoaXMuV2gpLGYpfSxmLnByb3RvdHlwZS5nZXRBeGlzPWZ1bmN0aW9uKCl7cmV0dXJuIGEoTm4odGhpcy5XaCkseSl9LGYucHJvdG90eXBlLmludmVyc2U9Zi5wcm90b3R5cGUuaW52ZXJzZT1mdW5jdGlvbigpe3JldHVybiBhKHpuKHRoaXMuV2gpLGYpfSxmLnByb3RvdHlwZS5nZXRBbmdsZT1mdW5jdGlvbigpe3JldHVybiBxbih0aGlzLldoKX0sZi5wcm90b3R5cGUuZ2V0QW5nbGVTaG9ydGVzdFBhdGg9ZnVuY3Rpb24oKXtyZXR1cm4gWm4odGhpcy5XaCl9LGYucHJvdG90eXBlLmFuZ2xlPWYucHJvdG90eXBlLmFuZ2xlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksS24obyxlKX0sZi5wcm90b3R5cGUuYW5nbGVTaG9ydGVzdFBhdGg9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSwkbihvLGUpfSxmLnByb3RvdHlwZS5vcF9hZGQ9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKEpuKG8sZSksZil9LGYucHJvdG90eXBlLm9wX3N1Yj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGEodHIobyxlKSxmKX0sZi5wcm90b3R5cGUub3BfbXVsPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksYShlcihvLGUpLGYpfSxmLnByb3RvdHlwZS5vcF9tdWxxPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksYShvcihvLGUpLGYpfSxmLnByb3RvdHlwZS5vcF9kaXY9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKG5yKG8sZSksZil9LGYucHJvdG90eXBlLng9Zi5wcm90b3R5cGUueD1mdW5jdGlvbigpe3JldHVybiBycih0aGlzLldoKX0sZi5wcm90b3R5cGUueT1mLnByb3RvdHlwZS55PWZ1bmN0aW9uKCl7cmV0dXJuIF9yKHRoaXMuV2gpfSxmLnByb3RvdHlwZS56PWYucHJvdG90eXBlLno9ZnVuY3Rpb24oKXtyZXR1cm4gaXIodGhpcy5XaCl9LGYucHJvdG90eXBlLnc9ZnVuY3Rpb24oKXtyZXR1cm4gYXIodGhpcy5XaCl9LGYucHJvdG90eXBlLnNldFg9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHNyKG8sZSl9LGYucHJvdG90eXBlLnNldFk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHByKG8sZSl9LGYucHJvdG90eXBlLnNldFo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGxyKG8sZSl9LGYucHJvdG90eXBlLnNldFc9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHVyKG8sZSl9LGYucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7Y3IodGhpcy5XaCl9O2Z1bmN0aW9uIHJ0KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0TWF0cml4M3gzLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifXJ0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxydC5wcm90b3R5cGUuY29uc3RydWN0b3I9cnQscnQucHJvdG90eXBlLlhoPXJ0LHJ0LlloPXt9LHQuYnRNYXRyaXgzeDM9cnQscnQucHJvdG90eXBlLnNldEV1bGVyWllYPWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLHlyKHIsZSxvLG4pfSxydC5wcm90b3R5cGUuZ2V0Um90YXRpb249ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGhyKG8sZSl9LHJ0LnByb3RvdHlwZS5nZXRSb3c9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKGZyKG8sZSkseSl9LHJ0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe21yKHRoaXMuV2gpfTtmdW5jdGlvbiBPKGUsbyl7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLHRoaXMuV2g9ZT09PXZvaWQgMD9icigpOm89PT12b2lkIDA/X2ViX2J0VHJhbnNmb3JtX2J0VHJhbnNmb3JtXzEoZSk6Z3IoZSxvKSxBKE8pW3RoaXMuV2hdPXRoaXN9Ty5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksTy5wcm90b3R5cGUuY29uc3RydWN0b3I9TyxPLnByb3RvdHlwZS5YaD1PLE8uWWg9e30sdC5idFRyYW5zZm9ybT1PLE8ucHJvdG90eXBlLnNldElkZW50aXR5PWZ1bmN0aW9uKCl7ZHIodGhpcy5XaCl9LE8ucHJvdG90eXBlLnNldE9yaWdpbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksV3IobyxlKX0sTy5wcm90b3R5cGUuc2V0Um90YXRpb249ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLENyKG8sZSl9LE8ucHJvdG90eXBlLmdldE9yaWdpbj1mdW5jdGlvbigpe3JldHVybiBhKGpyKHRoaXMuV2gpLHkpfSxPLnByb3RvdHlwZS5nZXRSb3RhdGlvbj1mdW5jdGlvbigpe3JldHVybiBhKHZyKHRoaXMuV2gpLGYpfSxPLnByb3RvdHlwZS5nZXRCYXNpcz1mdW5jdGlvbigpe3JldHVybiBhKERyKHRoaXMuV2gpLHJ0KX0sTy5wcm90b3R5cGUuc2V0RnJvbU9wZW5HTE1hdHJpeD1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO0NlKCksdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1ibChlKSksUnIobyxlKX0sTy5wcm90b3R5cGUuaW52ZXJzZT1PLnByb3RvdHlwZS5pbnZlcnNlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoU3IodGhpcy5XaCksTyl9LE8ucHJvdG90eXBlLm9wX211bD1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGEoSXIobyxlKSxPKX0sTy5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtPcih0aGlzLldoKX07ZnVuY3Rpb24gRShlLG8pe2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSx0aGlzLldoPWU9PT12b2lkIDA/QnIoKTpvPT09dm9pZCAwP1ByKGUpOnhyKGUsbyksQShFKVt0aGlzLldoXT10aGlzfUUucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobnQucHJvdG90eXBlKSxFLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1FLEUucHJvdG90eXBlLlhoPUUsRS5ZaD17fSx0LmJ0RGVmYXVsdE1vdGlvblN0YXRlPUUsRS5wcm90b3R5cGUuZ2V0V29ybGRUcmFuc2Zvcm09ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFRyKG8sZSl9LEUucHJvdG90eXBlLnNldFdvcmxkVHJhbnNmb3JtPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxGcihvLGUpfSxFLnByb3RvdHlwZS5nZXRfbV9ncmFwaGljc1dvcmxkVHJhbnM9RS5wcm90b3R5cGUuemk9ZnVuY3Rpb24oKXtyZXR1cm4gYShNcih0aGlzLldoKSxPKX0sRS5wcm90b3R5cGUuc2V0X21fZ3JhcGhpY3NXb3JsZFRyYW5zPUUucHJvdG90eXBlLnRqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxBcihvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoRS5wcm90b3R5cGUsIm1fZ3JhcGhpY3NXb3JsZFRyYW5zIix7Z2V0OkUucHJvdG90eXBlLnppLHNldDpFLnByb3RvdHlwZS50an0pLEUucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7d3IodGhpcy5XaCl9O2Z1bmN0aW9uIGd0KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0Q29sbGlzaW9uT2JqZWN0V3JhcHBlciwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1ndC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksZ3QucHJvdG90eXBlLmNvbnN0cnVjdG9yPWd0LGd0LnByb3RvdHlwZS5YaD1ndCxndC5ZaD17fSx0LmJ0Q29sbGlzaW9uT2JqZWN0V3JhcHBlcj1ndCxndC5wcm90b3R5cGUuZ2V0V29ybGRUcmFuc2Zvcm09ZnVuY3Rpb24oKXtyZXR1cm4gYShrcih0aGlzLldoKSxPKX0sZ3QucHJvdG90eXBlLmdldENvbGxpc2lvbk9iamVjdD1mdW5jdGlvbigpe3JldHVybiBhKExyKHRoaXMuV2gpLEMpfSxndC5wcm90b3R5cGUuZ2V0Q29sbGlzaW9uU2hhcGU9ZnVuY3Rpb24oKXtyZXR1cm4gYShIcih0aGlzLldoKSxIKX07ZnVuY3Rpb24gbHQoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5LCBubyBjb25zdHJ1Y3RvciBpbiBJREwifWx0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxsdC5wcm90b3R5cGUuY29uc3RydWN0b3I9bHQsbHQucHJvdG90eXBlLlhoPWx0LGx0LlloPXt9LHQuYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5PWx0LGx0LnByb3RvdHlwZS5zaXplPWx0LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIFlyKHRoaXMuV2gpfSxsdC5wcm90b3R5cGUuYXQ9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKFZyKG8sZSksQyl9LGx0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe1FyKHRoaXMuV2gpfTtmdW5jdGlvbiB1dCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidFNjYWxhckFycmF5LCBubyBjb25zdHJ1Y3RvciBpbiBJREwifXV0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSx1dC5wcm90b3R5cGUuY29uc3RydWN0b3I9dXQsdXQucHJvdG90eXBlLlhoPXV0LHV0LlloPXt9LHQuYnRTY2FsYXJBcnJheT11dCx1dC5wcm90b3R5cGUuc2l6ZT11dC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiBFcih0aGlzLldoKX0sdXQucHJvdG90eXBlLmF0PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksWHIobyxlKX0sdXQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7VXIodGhpcy5XaCl9O2Z1bmN0aW9uIGgoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRNYW5pZm9sZFBvaW50LCBubyBjb25zdHJ1Y3RvciBpbiBJREwifWgucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLGgucHJvdG90eXBlLmNvbnN0cnVjdG9yPWgsaC5wcm90b3R5cGUuWGg9aCxoLlloPXt9LHQuYnRNYW5pZm9sZFBvaW50PWgsaC5wcm90b3R5cGUuZ2V0UG9zaXRpb25Xb3JsZE9uQT1mdW5jdGlvbigpe3JldHVybiBhKEdyKHRoaXMuV2gpLHkpfSxoLnByb3RvdHlwZS5nZXRQb3NpdGlvbldvcmxkT25CPWZ1bmN0aW9uKCl7cmV0dXJuIGEoTnIodGhpcy5XaCkseSl9LGgucHJvdG90eXBlLmdldEFwcGxpZWRJbXB1bHNlPWZ1bmN0aW9uKCl7cmV0dXJuIHpyKHRoaXMuV2gpfSxoLnByb3RvdHlwZS5nZXREaXN0YW5jZT1mdW5jdGlvbigpe3JldHVybiBxcih0aGlzLldoKX0saC5wcm90b3R5cGUuZ2V0X21fbG9jYWxQb2ludEE9aC5wcm90b3R5cGUuSWk9ZnVuY3Rpb24oKXtyZXR1cm4gYShacih0aGlzLldoKSx5KX0saC5wcm90b3R5cGUuc2V0X21fbG9jYWxQb2ludEE9aC5wcm90b3R5cGUuQ2o9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEtyKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShoLnByb3RvdHlwZSwibV9sb2NhbFBvaW50QSIse2dldDpoLnByb3RvdHlwZS5JaSxzZXQ6aC5wcm90b3R5cGUuQ2p9KSxoLnByb3RvdHlwZS5nZXRfbV9sb2NhbFBvaW50Qj1oLnByb3RvdHlwZS5KaT1mdW5jdGlvbigpe3JldHVybiBhKCRyKHRoaXMuV2gpLHkpfSxoLnByb3RvdHlwZS5zZXRfbV9sb2NhbFBvaW50Qj1oLnByb3RvdHlwZS5Eaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksSnIobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGgucHJvdG90eXBlLCJtX2xvY2FsUG9pbnRCIix7Z2V0OmgucHJvdG90eXBlLkppLHNldDpoLnByb3RvdHlwZS5Ean0pLGgucHJvdG90eXBlLmdldF9tX3Bvc2l0aW9uV29ybGRPbkI9aC5wcm90b3R5cGUuUGk9ZnVuY3Rpb24oKXtyZXR1cm4gYSh0Xyh0aGlzLldoKSx5KX0saC5wcm90b3R5cGUuc2V0X21fcG9zaXRpb25Xb3JsZE9uQj1oLnByb3RvdHlwZS5Kaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZV8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGgucHJvdG90eXBlLCJtX3Bvc2l0aW9uV29ybGRPbkIiLHtnZXQ6aC5wcm90b3R5cGUuUGksc2V0OmgucHJvdG90eXBlLkpqfSksaC5wcm90b3R5cGUuZ2V0X21fcG9zaXRpb25Xb3JsZE9uQT1oLnByb3RvdHlwZS5PaT1mdW5jdGlvbigpe3JldHVybiBhKG9fKHRoaXMuV2gpLHkpfSxoLnByb3RvdHlwZS5zZXRfbV9wb3NpdGlvbldvcmxkT25BPWgucHJvdG90eXBlLklqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxuXyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaC5wcm90b3R5cGUsIm1fcG9zaXRpb25Xb3JsZE9uQSIse2dldDpoLnByb3RvdHlwZS5PaSxzZXQ6aC5wcm90b3R5cGUuSWp9KSxoLnByb3RvdHlwZS5nZXRfbV9ub3JtYWxXb3JsZE9uQj1oLnByb3RvdHlwZS5MaT1mdW5jdGlvbigpe3JldHVybiBhKHJfKHRoaXMuV2gpLHkpfSxoLnByb3RvdHlwZS5zZXRfbV9ub3JtYWxXb3JsZE9uQj1oLnByb3RvdHlwZS5Gaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksX18obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGgucHJvdG90eXBlLCJtX25vcm1hbFdvcmxkT25CIix7Z2V0OmgucHJvdG90eXBlLkxpLHNldDpoLnByb3RvdHlwZS5Gan0pLGgucHJvdG90eXBlLmdldF9tX3VzZXJQZXJzaXN0ZW50RGF0YT1oLnByb3RvdHlwZS5iaj1mdW5jdGlvbigpe3JldHVybiBpXyh0aGlzLldoKX0saC5wcm90b3R5cGUuc2V0X21fdXNlclBlcnNpc3RlbnREYXRhPWgucHJvdG90eXBlLldqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhXyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaC5wcm90b3R5cGUsIm1fdXNlclBlcnNpc3RlbnREYXRhIix7Z2V0OmgucHJvdG90eXBlLmJqLHNldDpoLnByb3RvdHlwZS5Xan0pLGgucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7c18odGhpcy5XaCl9O2Z1bmN0aW9uIGR0KCl7dGhpcy5XaD1wXygpLEEoZHQpW3RoaXMuV2hdPXRoaXN9ZHQucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobXQucHJvdG90eXBlKSxkdC5wcm90b3R5cGUuY29uc3RydWN0b3I9ZHQsZHQucHJvdG90eXBlLlhoPWR0LGR0LlloPXt9LHQuQ29uY3JldGVDb250YWN0UmVzdWx0Q2FsbGJhY2s9ZHQsZHQucHJvdG90eXBlLmFkZFNpbmdsZVJlc3VsdD1mdW5jdGlvbihlLG8sbixyLGMsRCxOKXt2YXIgeXQ9dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksciYmdHlwZW9mIHI9PSJvYmplY3QiJiYocj1yLldoKSxjJiZ0eXBlb2YgYz09Im9iamVjdCImJihjPWMuV2gpLEQmJnR5cGVvZiBEPT0ib2JqZWN0IiYmKEQ9RC5XaCksTiYmdHlwZW9mIE49PSJvYmplY3QiJiYoTj1OLldoKSxsXyh5dCxlLG8sbixyLGMsRCxOKX0sZHQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7dV8odGhpcy5XaCl9O2Z1bmN0aW9uIFQoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgTG9jYWxTaGFwZUluZm8sIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9VC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksVC5wcm90b3R5cGUuY29uc3RydWN0b3I9VCxULnByb3RvdHlwZS5YaD1ULFQuWWg9e30sdC5Mb2NhbFNoYXBlSW5mbz1ULFQucHJvdG90eXBlLmdldF9tX3NoYXBlUGFydD1ULnByb3RvdHlwZS5TaT1mdW5jdGlvbigpe3JldHVybiBjXyh0aGlzLldoKX0sVC5wcm90b3R5cGUuc2V0X21fc2hhcGVQYXJ0PVQucHJvdG90eXBlLk1qPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx5XyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoVC5wcm90b3R5cGUsIm1fc2hhcGVQYXJ0Iix7Z2V0OlQucHJvdG90eXBlLlNpLHNldDpULnByb3RvdHlwZS5Nan0pLFQucHJvdG90eXBlLmdldF9tX3RyaWFuZ2xlSW5kZXg9VC5wcm90b3R5cGUuWWk9ZnVuY3Rpb24oKXtyZXR1cm4gaF8odGhpcy5XaCl9LFQucHJvdG90eXBlLnNldF9tX3RyaWFuZ2xlSW5kZXg9VC5wcm90b3R5cGUuU2o9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGZfKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShULnByb3RvdHlwZSwibV90cmlhbmdsZUluZGV4Iix7Z2V0OlQucHJvdG90eXBlLllpLHNldDpULnByb3RvdHlwZS5Tan0pLFQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7bV8odGhpcy5XaCl9O2Z1bmN0aW9uIFcoZSxvLG4scixjKXtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSxyJiZ0eXBlb2Ygcj09Im9iamVjdCImJihyPXIuV2gpLGMmJnR5cGVvZiBjPT0ib2JqZWN0IiYmKGM9Yy5XaCksdGhpcy5XaD1iXyhlLG8sbixyLGMpLEEoVylbdGhpcy5XaF09dGhpc31XLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxXLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1XLFcucHJvdG90eXBlLlhoPVcsVy5ZaD17fSx0LkxvY2FsQ29udmV4UmVzdWx0PVcsVy5wcm90b3R5cGUuZ2V0X21faGl0Q29sbGlzaW9uT2JqZWN0PVcucHJvdG90eXBlLmVpPWZ1bmN0aW9uKCl7cmV0dXJuIGEoZ18odGhpcy5XaCksQyl9LFcucHJvdG90eXBlLnNldF9tX2hpdENvbGxpc2lvbk9iamVjdD1XLnByb3RvdHlwZS5naT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZF8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KFcucHJvdG90eXBlLCJtX2hpdENvbGxpc2lvbk9iamVjdCIse2dldDpXLnByb3RvdHlwZS5laSxzZXQ6Vy5wcm90b3R5cGUuZ2l9KSxXLnByb3RvdHlwZS5nZXRfbV9sb2NhbFNoYXBlSW5mbz1XLnByb3RvdHlwZS5LaT1mdW5jdGlvbigpe3JldHVybiBhKFdfKHRoaXMuV2gpLFQpfSxXLnByb3RvdHlwZS5zZXRfbV9sb2NhbFNoYXBlSW5mbz1XLnByb3RvdHlwZS5Faj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksQ18obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KFcucHJvdG90eXBlLCJtX2xvY2FsU2hhcGVJbmZvIix7Z2V0OlcucHJvdG90eXBlLktpLHNldDpXLnByb3RvdHlwZS5Fan0pLFcucHJvdG90eXBlLmdldF9tX2hpdE5vcm1hbExvY2FsPVcucHJvdG90eXBlLkJpPWZ1bmN0aW9uKCl7cmV0dXJuIGEoal8odGhpcy5XaCkseSl9LFcucHJvdG90eXBlLnNldF9tX2hpdE5vcm1hbExvY2FsPVcucHJvdG90eXBlLnZqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx2XyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoVy5wcm90b3R5cGUsIm1faGl0Tm9ybWFsTG9jYWwiLHtnZXQ6Vy5wcm90b3R5cGUuQmksc2V0OlcucHJvdG90eXBlLnZqfSksVy5wcm90b3R5cGUuZ2V0X21faGl0UG9pbnRMb2NhbD1XLnByb3RvdHlwZS5EaT1mdW5jdGlvbigpe3JldHVybiBhKERfKHRoaXMuV2gpLHkpfSxXLnByb3RvdHlwZS5zZXRfbV9oaXRQb2ludExvY2FsPVcucHJvdG90eXBlLnhqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxSXyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoVy5wcm90b3R5cGUsIm1faGl0UG9pbnRMb2NhbCIse2dldDpXLnByb3RvdHlwZS5EaSxzZXQ6Vy5wcm90b3R5cGUueGp9KSxXLnByb3RvdHlwZS5nZXRfbV9oaXRGcmFjdGlvbj1XLnByb3RvdHlwZS5BaT1mdW5jdGlvbigpe3JldHVybiBTXyh0aGlzLldoKX0sVy5wcm90b3R5cGUuc2V0X21faGl0RnJhY3Rpb249Vy5wcm90b3R5cGUudWo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLElfKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXLnByb3RvdHlwZSwibV9oaXRGcmFjdGlvbiIse2dldDpXLnByb3RvdHlwZS5BaSxzZXQ6Vy5wcm90b3R5cGUudWp9KSxXLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe09fKHRoaXMuV2gpfTtmdW5jdGlvbiB1KGUsbyl7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLHRoaXMuV2g9Ql8oZSxvKSxBKHUpW3RoaXMuV2hdPXRoaXN9dS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShSLnByb3RvdHlwZSksdS5wcm90b3R5cGUuY29uc3RydWN0b3I9dSx1LnByb3RvdHlwZS5YaD11LHUuWWg9e30sdC5DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2s9dSx1LnByb3RvdHlwZS5oYXNIaXQ9ZnVuY3Rpb24oKXtyZXR1cm4hIVBfKHRoaXMuV2gpfSx1LnByb3RvdHlwZS5nZXRfbV9oaXRDb2xsaXNpb25PYmplY3Q9dS5wcm90b3R5cGUuZWk9ZnVuY3Rpb24oKXtyZXR1cm4gYSh4Xyh0aGlzLldoKSxDKX0sdS5wcm90b3R5cGUuc2V0X21faGl0Q29sbGlzaW9uT2JqZWN0PXUucHJvdG90eXBlLmdpPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxUXyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodS5wcm90b3R5cGUsIm1faGl0Q29sbGlzaW9uT2JqZWN0Iix7Z2V0OnUucHJvdG90eXBlLmVpLHNldDp1LnByb3RvdHlwZS5naX0pLHUucHJvdG90eXBlLmdldF9tX2NvbnZleEZyb21Xb3JsZD11LnByb3RvdHlwZS5zaT1mdW5jdGlvbigpe3JldHVybiBhKEZfKHRoaXMuV2gpLHkpfSx1LnByb3RvdHlwZS5zZXRfbV9jb252ZXhGcm9tV29ybGQ9dS5wcm90b3R5cGUubWo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLE1fKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LnByb3RvdHlwZSwibV9jb252ZXhGcm9tV29ybGQiLHtnZXQ6dS5wcm90b3R5cGUuc2ksc2V0OnUucHJvdG90eXBlLm1qfSksdS5wcm90b3R5cGUuZ2V0X21fY29udmV4VG9Xb3JsZD11LnByb3RvdHlwZS50aT1mdW5jdGlvbigpe3JldHVybiBhKEFfKHRoaXMuV2gpLHkpfSx1LnByb3RvdHlwZS5zZXRfbV9jb252ZXhUb1dvcmxkPXUucHJvdG90eXBlLm5qPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx3XyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodS5wcm90b3R5cGUsIm1fY29udmV4VG9Xb3JsZCIse2dldDp1LnByb3RvdHlwZS50aSxzZXQ6dS5wcm90b3R5cGUubmp9KSx1LnByb3RvdHlwZS5nZXRfbV9oaXROb3JtYWxXb3JsZD11LnByb3RvdHlwZS5DaT1mdW5jdGlvbigpe3JldHVybiBhKGtfKHRoaXMuV2gpLHkpfSx1LnByb3RvdHlwZS5zZXRfbV9oaXROb3JtYWxXb3JsZD11LnByb3RvdHlwZS53aj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksTF8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHUucHJvdG90eXBlLCJtX2hpdE5vcm1hbFdvcmxkIix7Z2V0OnUucHJvdG90eXBlLkNpLHNldDp1LnByb3RvdHlwZS53an0pLHUucHJvdG90eXBlLmdldF9tX2hpdFBvaW50V29ybGQ9dS5wcm90b3R5cGUuRWk9ZnVuY3Rpb24oKXtyZXR1cm4gYShIXyh0aGlzLldoKSx5KX0sdS5wcm90b3R5cGUuc2V0X21faGl0UG9pbnRXb3JsZD11LnByb3RvdHlwZS55aj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksWV8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHUucHJvdG90eXBlLCJtX2hpdFBvaW50V29ybGQiLHtnZXQ6dS5wcm90b3R5cGUuRWksc2V0OnUucHJvdG90eXBlLnlqfSksdS5wcm90b3R5cGUuZ2V0X21fY29sbGlzaW9uRmlsdGVyR3JvdXA9dS5wcm90b3R5cGUuWmg9ZnVuY3Rpb24oKXtyZXR1cm4gVl8odGhpcy5XaCl9LHUucHJvdG90eXBlLnNldF9tX2NvbGxpc2lvbkZpbHRlckdyb3VwPXUucHJvdG90eXBlLmFpPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxRXyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodS5wcm90b3R5cGUsIm1fY29sbGlzaW9uRmlsdGVyR3JvdXAiLHtnZXQ6dS5wcm90b3R5cGUuWmgsc2V0OnUucHJvdG90eXBlLmFpfSksdS5wcm90b3R5cGUuZ2V0X21fY29sbGlzaW9uRmlsdGVyTWFzaz11LnByb3RvdHlwZS4kaD1mdW5jdGlvbigpe3JldHVybiBFXyh0aGlzLldoKX0sdS5wcm90b3R5cGUuc2V0X21fY29sbGlzaW9uRmlsdGVyTWFzaz11LnByb3RvdHlwZS5iaT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksWF8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHUucHJvdG90eXBlLCJtX2NvbGxpc2lvbkZpbHRlck1hc2siLHtnZXQ6dS5wcm90b3R5cGUuJGgsc2V0OnUucHJvdG90eXBlLmJpfSksdS5wcm90b3R5cGUuZ2V0X21fY2xvc2VzdEhpdEZyYWN0aW9uPXUucHJvdG90eXBlLmRpPWZ1bmN0aW9uKCl7cmV0dXJuIFVfKHRoaXMuV2gpfSx1LnByb3RvdHlwZS5zZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb249dS5wcm90b3R5cGUuZmk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEdfKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LnByb3RvdHlwZSwibV9jbG9zZXN0SGl0RnJhY3Rpb24iLHtnZXQ6dS5wcm90b3R5cGUuZGksc2V0OnUucHJvdG90eXBlLmZpfSksdS5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtOXyh0aGlzLldoKX07ZnVuY3Rpb24gb3QoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRDb252ZXhTaGFwZSwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1vdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShILnByb3RvdHlwZSksb3QucHJvdG90eXBlLmNvbnN0cnVjdG9yPW90LG90LnByb3RvdHlwZS5YaD1vdCxvdC5ZaD17fSx0LmJ0Q29udmV4U2hhcGU9b3Qsb3QucHJvdG90eXBlLnNldExvY2FsU2NhbGluZz1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksel8obyxlKX0sb3QucHJvdG90eXBlLmdldExvY2FsU2NhbGluZz1mdW5jdGlvbigpe3JldHVybiBhKHFfKHRoaXMuV2gpLHkpfSxvdC5wcm90b3R5cGUuY2FsY3VsYXRlTG9jYWxJbmVydGlhPWZ1bmN0aW9uKGUsbyl7dmFyIG49dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksWl8obixlLG8pfSxvdC5wcm90b3R5cGUuc2V0TWFyZ2luPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxLXyhvLGUpfSxvdC5wcm90b3R5cGUuZ2V0TWFyZ2luPWZ1bmN0aW9uKCl7cmV0dXJuICRfKHRoaXMuV2gpfSxvdC5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtKXyh0aGlzLldoKX07ZnVuY3Rpb24gJChlKXtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHRoaXMuV2g9dGkoZSksQSgkKVt0aGlzLldoXT10aGlzfSQucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoSC5wcm90b3R5cGUpLCQucHJvdG90eXBlLmNvbnN0cnVjdG9yPSQsJC5wcm90b3R5cGUuWGg9JCwkLlloPXt9LHQuYnRCb3hTaGFwZT0kLCQucHJvdG90eXBlLnNldE1hcmdpbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZWkobyxlKX0sJC5wcm90b3R5cGUuZ2V0TWFyZ2luPWZ1bmN0aW9uKCl7cmV0dXJuIG9pKHRoaXMuV2gpfSwkLnByb3RvdHlwZS5zZXRMb2NhbFNjYWxpbmc9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG5pKG8sZSl9LCQucHJvdG90eXBlLmdldExvY2FsU2NhbGluZz1mdW5jdGlvbigpe3JldHVybiBhKHJpKHRoaXMuV2gpLHkpfSwkLnByb3RvdHlwZS5jYWxjdWxhdGVMb2NhbEluZXJ0aWE9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxfaShuLGUsbyl9LCQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7aWkodGhpcy5XaCl9O2Z1bmN0aW9uIF90KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0SW50QXJyYXksIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9X3QucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLF90LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1fdCxfdC5wcm90b3R5cGUuWGg9X3QsX3QuWWg9e30sdC5idEludEFycmF5PV90LF90LnByb3RvdHlwZS5zaXplPV90LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGFpKHRoaXMuV2gpfSxfdC5wcm90b3R5cGUuYXQ9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxzaShvLGUpfSxfdC5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtwaSh0aGlzLldoKX07ZnVuY3Rpb24gRigpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidEZhY2UsIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9Ri5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksRi5wcm90b3R5cGUuY29uc3RydWN0b3I9RixGLnByb3RvdHlwZS5YaD1GLEYuWWg9e30sdC5idEZhY2U9RixGLnByb3RvdHlwZS5nZXRfbV9pbmRpY2VzPUYucHJvdG90eXBlLkZpPWZ1bmN0aW9uKCl7cmV0dXJuIGEobGkodGhpcy5XaCksX3QpfSxGLnByb3RvdHlwZS5zZXRfbV9pbmRpY2VzPUYucHJvdG90eXBlLnpqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx1aShvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoRi5wcm90b3R5cGUsIm1faW5kaWNlcyIse2dldDpGLnByb3RvdHlwZS5GaSxzZXQ6Ri5wcm90b3R5cGUuemp9KSxGLnByb3RvdHlwZS5nZXRfbV9wbGFuZT1GLnByb3RvdHlwZS5OaT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGNpKG8sZSl9LEYucHJvdG90eXBlLnNldF9tX3BsYW5lPUYucHJvdG90eXBlLkhqPWZ1bmN0aW9uKGUsbyl7dmFyIG49dGhpcy5XaDtDZSgpLGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSx5aShuLGUsbyl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGLnByb3RvdHlwZSwibV9wbGFuZSIse2dldDpGLnByb3RvdHlwZS5OaSxzZXQ6Ri5wcm90b3R5cGUuSGp9KSxGLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe2hpKHRoaXMuV2gpfTtmdW5jdGlvbiBpdCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidFZlY3RvcjNBcnJheSwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1pdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksaXQucHJvdG90eXBlLmNvbnN0cnVjdG9yPWl0LGl0LnByb3RvdHlwZS5YaD1pdCxpdC5ZaD17fSx0LmJ0VmVjdG9yM0FycmF5PWl0LGl0LnByb3RvdHlwZS5zaXplPWl0LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGZpKHRoaXMuV2gpfSxpdC5wcm90b3R5cGUuYXQ9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKG1pKG8sZSkseSl9LGl0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe2JpKHRoaXMuV2gpfTtmdW5jdGlvbiBhdCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidEZhY2VBcnJheSwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1hdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksYXQucHJvdG90eXBlLmNvbnN0cnVjdG9yPWF0LGF0LnByb3RvdHlwZS5YaD1hdCxhdC5ZaD17fSx0LmJ0RmFjZUFycmF5PWF0LGF0LnByb3RvdHlwZS5zaXplPWF0LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGdpKHRoaXMuV2gpfSxhdC5wcm90b3R5cGUuYXQ9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKGRpKG8sZSksRil9LGF0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe1dpKHRoaXMuV2gpfTtmdW5jdGlvbiBNKCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0Q29udmV4UG9seWhlZHJvbiwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1NLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxNLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1NLE0ucHJvdG90eXBlLlhoPU0sTS5ZaD17fSx0LmJ0Q29udmV4UG9seWhlZHJvbj1NLE0ucHJvdG90eXBlLmdldF9tX3ZlcnRpY2VzPU0ucHJvdG90eXBlLmNqPWZ1bmN0aW9uKCl7cmV0dXJuIGEoQ2kodGhpcy5XaCksaXQpfSxNLnByb3RvdHlwZS5zZXRfbV92ZXJ0aWNlcz1NLnByb3RvdHlwZS5Yaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksamkobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KE0ucHJvdG90eXBlLCJtX3ZlcnRpY2VzIix7Z2V0Ok0ucHJvdG90eXBlLmNqLHNldDpNLnByb3RvdHlwZS5Yan0pLE0ucHJvdG90eXBlLmdldF9tX2ZhY2VzPU0ucHJvdG90eXBlLnhpPWZ1bmN0aW9uKCl7cmV0dXJuIGEodmkodGhpcy5XaCksYXQpfSxNLnByb3RvdHlwZS5zZXRfbV9mYWNlcz1NLnByb3RvdHlwZS5yaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksRGkobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KE0ucHJvdG90eXBlLCJtX2ZhY2VzIix7Z2V0Ok0ucHJvdG90eXBlLnhpLHNldDpNLnByb3RvdHlwZS5yan0pLE0ucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7UmkodGhpcy5XaCl9O2Z1bmN0aW9uIFkoZSxvKXtDZSgpLHR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9YmwoZSkpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksdGhpcy5XaD1lPT09dm9pZCAwP1NpKCk6bz09PXZvaWQgMD9JaShlKTpPaShlLG8pLEEoWSlbdGhpcy5XaF09dGhpc31ZLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKEgucHJvdG90eXBlKSxZLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1ZLFkucHJvdG90eXBlLlhoPVksWS5ZaD17fSx0LmJ0Q29udmV4SHVsbFNoYXBlPVksWS5wcm90b3R5cGUuYWRkUG9pbnQ9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxvPT09dm9pZCAwP0JpKG4sZSk6UGkobixlLG8pfSxZLnByb3RvdHlwZS5zZXRNYXJnaW49ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHhpKG8sZSl9LFkucHJvdG90eXBlLmdldE1hcmdpbj1mdW5jdGlvbigpe3JldHVybiBUaSh0aGlzLldoKX0sWS5wcm90b3R5cGUuZ2V0TnVtVmVydGljZXM9ZnVuY3Rpb24oKXtyZXR1cm4gRmkodGhpcy5XaCl9LFkucHJvdG90eXBlLmluaXRpYWxpemVQb2x5aGVkcmFsRmVhdHVyZXM9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSwhIU1pKG8sZSl9LFkucHJvdG90eXBlLnJlY2FsY0xvY2FsQWFiYj1mdW5jdGlvbigpe0FpKHRoaXMuV2gpfSxZLnByb3RvdHlwZS5nZXRDb252ZXhQb2x5aGVkcm9uPWZ1bmN0aW9uKCl7cmV0dXJuIGEod2kodGhpcy5XaCksTSl9LFkucHJvdG90eXBlLnNldExvY2FsU2NhbGluZz1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksa2kobyxlKX0sWS5wcm90b3R5cGUuZ2V0TG9jYWxTY2FsaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIGEoTGkodGhpcy5XaCkseSl9LFkucHJvdG90eXBlLmNhbGN1bGF0ZUxvY2FsSW5lcnRpYT1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLEhpKG4sZSxvKX0sWS5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtZaSh0aGlzLldoKX07ZnVuY3Rpb24ganQoKXt0aGlzLldoPVZpKCksQShqdClbdGhpcy5XaF09dGhpc31qdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksanQucHJvdG90eXBlLmNvbnN0cnVjdG9yPWp0LGp0LnByb3RvdHlwZS5YaD1qdCxqdC5ZaD17fSx0LmJ0RGVmYXVsdENvbGxpc2lvbkNvbnN0cnVjdGlvbkluZm89anQsanQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7UWkodGhpcy5XaCl9O2Z1bmN0aW9uIHZ0KGUpe2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksdGhpcy5XaD1lPT09dm9pZCAwP0VpKCk6WGkoZSksQSh2dClbdGhpcy5XaF09dGhpc312dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksdnQucHJvdG90eXBlLmNvbnN0cnVjdG9yPXZ0LHZ0LnByb3RvdHlwZS5YaD12dCx2dC5ZaD17fSx0LmJ0RGVmYXVsdENvbGxpc2lvbkNvbmZpZ3VyYXRpb249dnQsdnQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7VWkodGhpcy5XaCl9O2Z1bmN0aW9uIHEoKXt0aGlzLldoPUdpKCksQShxKVt0aGlzLldoXT10aGlzfXEucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLHEucHJvdG90eXBlLmNvbnN0cnVjdG9yPXEscS5wcm90b3R5cGUuWGg9cSxxLlloPXt9LHQuYnRQZXJzaXN0ZW50TWFuaWZvbGQ9cSxxLnByb3RvdHlwZS5nZXRCb2R5MD1mdW5jdGlvbigpe3JldHVybiBhKE5pKHRoaXMuV2gpLEMpfSxxLnByb3RvdHlwZS5nZXRCb2R5MT1mdW5jdGlvbigpe3JldHVybiBhKHppKHRoaXMuV2gpLEMpfSxxLnByb3RvdHlwZS5nZXROdW1Db250YWN0cz1mdW5jdGlvbigpe3JldHVybiBxaSh0aGlzLldoKX0scS5wcm90b3R5cGUuZ2V0Q29udGFjdFBvaW50PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksYShaaShvLGUpLGgpfSxxLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe0tpKHRoaXMuV2gpfTtmdW5jdGlvbiBjdChlKXtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHRoaXMuV2g9JGkoZSksQShjdClbdGhpcy5XaF09dGhpc31jdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShLLnByb3RvdHlwZSksY3QucHJvdG90eXBlLmNvbnN0cnVjdG9yPWN0LGN0LnByb3RvdHlwZS5YaD1jdCxjdC5ZaD17fSx0LmJ0Q29sbGlzaW9uRGlzcGF0Y2hlcj1jdCxjdC5wcm90b3R5cGUuZ2V0TnVtTWFuaWZvbGRzPWZ1bmN0aW9uKCl7cmV0dXJuIEppKHRoaXMuV2gpfSxjdC5wcm90b3R5cGUuZ2V0TWFuaWZvbGRCeUluZGV4SW50ZXJuYWw9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKHRhKG8sZSkscSl9LGN0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe2VhKHRoaXMuV2gpfTtmdW5jdGlvbiBUdCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidE92ZXJsYXBwaW5nUGFpckNhbGxiYWNrLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifVR0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxUdC5wcm90b3R5cGUuY29uc3RydWN0b3I9VHQsVHQucHJvdG90eXBlLlhoPVR0LFR0LlloPXt9LHQuYnRPdmVybGFwcGluZ1BhaXJDYWxsYmFjaz1UdCxUdC5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtvYSh0aGlzLldoKX07ZnVuY3Rpb24gSigpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidE92ZXJsYXBwaW5nUGFpckNhY2hlLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifUoucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLEoucHJvdG90eXBlLmNvbnN0cnVjdG9yPUosSi5wcm90b3R5cGUuWGg9SixKLlloPXt9LHQuYnRPdmVybGFwcGluZ1BhaXJDYWNoZT1KLEoucHJvdG90eXBlLnNldEludGVybmFsR2hvc3RQYWlyQ2FsbGJhY2s9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG5hKG8sZSl9LEoucHJvdG90eXBlLmdldE51bU92ZXJsYXBwaW5nUGFpcnM9ZnVuY3Rpb24oKXtyZXR1cm4gcmEodGhpcy5XaCl9LEoucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7X2EodGhpcy5XaCl9O2Z1bmN0aW9uIHN0KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0QnJvYWRwaGFzZUludGVyZmFjZSwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1zdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksc3QucHJvdG90eXBlLmNvbnN0cnVjdG9yPXN0LHN0LnByb3RvdHlwZS5YaD1zdCxzdC5ZaD17fSx0LmJ0QnJvYWRwaGFzZUludGVyZmFjZT1zdCxzdC5wcm90b3R5cGUuZ2V0T3ZlcmxhcHBpbmdQYWlyQ2FjaGU9ZnVuY3Rpb24oKXtyZXR1cm4gYShpYSh0aGlzLldoKSxKKX0sc3QucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7YWEodGhpcy5XaCl9O2Z1bmN0aW9uIEZ0KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0Q29sbGlzaW9uQ29uZmlndXJhdGlvbiwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1GdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksRnQucHJvdG90eXBlLmNvbnN0cnVjdG9yPUZ0LEZ0LnByb3RvdHlwZS5YaD1GdCxGdC5ZaD17fSx0LmJ0Q29sbGlzaW9uQ29uZmlndXJhdGlvbj1GdCxGdC5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtzYSh0aGlzLldoKX07ZnVuY3Rpb24gRHQoKXt0aGlzLldoPXBhKCksQShEdClbdGhpcy5XaF09dGhpc31EdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksRHQucHJvdG90eXBlLmNvbnN0cnVjdG9yPUR0LER0LnByb3RvdHlwZS5YaD1EdCxEdC5ZaD17fSx0LmJ0RGJ2dEJyb2FkcGhhc2U9RHQsRHQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7bGEodGhpcy5XaCl9O2Z1bmN0aW9uIEIoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRCcm9hZHBoYXNlUHJveHksIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9Qi5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksQi5wcm90b3R5cGUuY29uc3RydWN0b3I9QixCLnByb3RvdHlwZS5YaD1CLEIuWWg9e30sdC5idEJyb2FkcGhhc2VQcm94eT1CLEIucHJvdG90eXBlLmdldF9tX2NvbGxpc2lvbkZpbHRlckdyb3VwPUIucHJvdG90eXBlLlpoPWZ1bmN0aW9uKCl7cmV0dXJuIHVhKHRoaXMuV2gpfSxCLnByb3RvdHlwZS5zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cD1CLnByb3RvdHlwZS5haT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksY2EobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KEIucHJvdG90eXBlLCJtX2NvbGxpc2lvbkZpbHRlckdyb3VwIix7Z2V0OkIucHJvdG90eXBlLlpoLHNldDpCLnByb3RvdHlwZS5haX0pLEIucHJvdG90eXBlLmdldF9tX2NvbGxpc2lvbkZpbHRlck1hc2s9Qi5wcm90b3R5cGUuJGg9ZnVuY3Rpb24oKXtyZXR1cm4geWEodGhpcy5XaCl9LEIucHJvdG90eXBlLnNldF9tX2NvbGxpc2lvbkZpbHRlck1hc2s9Qi5wcm90b3R5cGUuYmk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGhhKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCLnByb3RvdHlwZSwibV9jb2xsaXNpb25GaWx0ZXJNYXNrIix7Z2V0OkIucHJvdG90eXBlLiRoLHNldDpCLnByb3RvdHlwZS5iaX0pLEIucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7ZmEodGhpcy5XaCl9O2Z1bmN0aW9uIF8oZSxvLG4scil7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksciYmdHlwZW9mIHI9PSJvYmplY3QiJiYocj1yLldoKSx0aGlzLldoPXI9PT12b2lkIDA/bWEoZSxvLG4pOmJhKGUsbyxuLHIpLEEoXylbdGhpcy5XaF09dGhpc31fLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxfLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1fLF8ucHJvdG90eXBlLlhoPV8sXy5ZaD17fSx0LmJ0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mbz1fLF8ucHJvdG90eXBlLmdldF9tX2xpbmVhckRhbXBpbmc9Xy5wcm90b3R5cGUuR2k9ZnVuY3Rpb24oKXtyZXR1cm4gZ2EodGhpcy5XaCl9LF8ucHJvdG90eXBlLnNldF9tX2xpbmVhckRhbXBpbmc9Xy5wcm90b3R5cGUuQWo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGRhKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfLnByb3RvdHlwZSwibV9saW5lYXJEYW1waW5nIix7Z2V0Ol8ucHJvdG90eXBlLkdpLHNldDpfLnByb3RvdHlwZS5Ban0pLF8ucHJvdG90eXBlLmdldF9tX2FuZ3VsYXJEYW1waW5nPV8ucHJvdG90eXBlLm9pPWZ1bmN0aW9uKCl7cmV0dXJuIFdhKHRoaXMuV2gpfSxfLnByb3RvdHlwZS5zZXRfbV9hbmd1bGFyRGFtcGluZz1fLnByb3RvdHlwZS5qaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksQ2EobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX2FuZ3VsYXJEYW1waW5nIix7Z2V0Ol8ucHJvdG90eXBlLm9pLHNldDpfLnByb3RvdHlwZS5qan0pLF8ucHJvdG90eXBlLmdldF9tX2ZyaWN0aW9uPV8ucHJvdG90eXBlLnlpPWZ1bmN0aW9uKCl7cmV0dXJuIGphKHRoaXMuV2gpfSxfLnByb3RvdHlwZS5zZXRfbV9mcmljdGlvbj1fLnByb3RvdHlwZS5zaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksdmEobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX2ZyaWN0aW9uIix7Z2V0Ol8ucHJvdG90eXBlLnlpLHNldDpfLnByb3RvdHlwZS5zan0pLF8ucHJvdG90eXBlLmdldF9tX3JvbGxpbmdGcmljdGlvbj1fLnByb3RvdHlwZS5SaT1mdW5jdGlvbigpe3JldHVybiBEYSh0aGlzLldoKX0sXy5wcm90b3R5cGUuc2V0X21fcm9sbGluZ0ZyaWN0aW9uPV8ucHJvdG90eXBlLkxqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxSYShvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoXy5wcm90b3R5cGUsIm1fcm9sbGluZ0ZyaWN0aW9uIix7Z2V0Ol8ucHJvdG90eXBlLlJpLHNldDpfLnByb3RvdHlwZS5Man0pLF8ucHJvdG90eXBlLmdldF9tX3Jlc3RpdHV0aW9uPV8ucHJvdG90eXBlLlFpPWZ1bmN0aW9uKCl7cmV0dXJuIFNhKHRoaXMuV2gpfSxfLnByb3RvdHlwZS5zZXRfbV9yZXN0aXR1dGlvbj1fLnByb3RvdHlwZS5Laj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksSWEobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX3Jlc3RpdHV0aW9uIix7Z2V0Ol8ucHJvdG90eXBlLlFpLHNldDpfLnByb3RvdHlwZS5Lan0pLF8ucHJvdG90eXBlLmdldF9tX2xpbmVhclNsZWVwaW5nVGhyZXNob2xkPV8ucHJvdG90eXBlLkhpPWZ1bmN0aW9uKCl7cmV0dXJuIE9hKHRoaXMuV2gpfSxfLnByb3RvdHlwZS5zZXRfbV9saW5lYXJTbGVlcGluZ1RocmVzaG9sZD1fLnByb3RvdHlwZS5Caj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksQmEobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX2xpbmVhclNsZWVwaW5nVGhyZXNob2xkIix7Z2V0Ol8ucHJvdG90eXBlLkhpLHNldDpfLnByb3RvdHlwZS5Can0pLF8ucHJvdG90eXBlLmdldF9tX2FuZ3VsYXJTbGVlcGluZ1RocmVzaG9sZD1fLnByb3RvdHlwZS5waT1mdW5jdGlvbigpe3JldHVybiBQYSh0aGlzLldoKX0sXy5wcm90b3R5cGUuc2V0X21fYW5ndWxhclNsZWVwaW5nVGhyZXNob2xkPV8ucHJvdG90eXBlLmtqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx4YShvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoXy5wcm90b3R5cGUsIm1fYW5ndWxhclNsZWVwaW5nVGhyZXNob2xkIix7Z2V0Ol8ucHJvdG90eXBlLnBpLHNldDpfLnByb3RvdHlwZS5ran0pLF8ucHJvdG90eXBlLmdldF9tX2FkZGl0aW9uYWxEYW1waW5nPV8ucHJvdG90eXBlLmtpPWZ1bmN0aW9uKCl7cmV0dXJuISFUYSh0aGlzLldoKX0sXy5wcm90b3R5cGUuc2V0X21fYWRkaXRpb25hbERhbXBpbmc9Xy5wcm90b3R5cGUuZmo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEZhKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfLnByb3RvdHlwZSwibV9hZGRpdGlvbmFsRGFtcGluZyIse2dldDpfLnByb3RvdHlwZS5raSxzZXQ6Xy5wcm90b3R5cGUuZmp9KSxfLnByb3RvdHlwZS5nZXRfbV9hZGRpdGlvbmFsRGFtcGluZ0ZhY3Rvcj1fLnByb3RvdHlwZS5saT1mdW5jdGlvbigpe3JldHVybiBNYSh0aGlzLldoKX0sXy5wcm90b3R5cGUuc2V0X21fYWRkaXRpb25hbERhbXBpbmdGYWN0b3I9Xy5wcm90b3R5cGUuZ2o9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEFhKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfLnByb3RvdHlwZSwibV9hZGRpdGlvbmFsRGFtcGluZ0ZhY3RvciIse2dldDpfLnByb3RvdHlwZS5saSxzZXQ6Xy5wcm90b3R5cGUuZ2p9KSxfLnByb3RvdHlwZS5nZXRfbV9hZGRpdGlvbmFsTGluZWFyRGFtcGluZ1RocmVzaG9sZFNxcj1fLnByb3RvdHlwZS5taT1mdW5jdGlvbigpe3JldHVybiB3YSh0aGlzLldoKX0sXy5wcm90b3R5cGUuc2V0X21fYWRkaXRpb25hbExpbmVhckRhbXBpbmdUaHJlc2hvbGRTcXI9Xy5wcm90b3R5cGUuaGo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGthKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfLnByb3RvdHlwZSwibV9hZGRpdGlvbmFsTGluZWFyRGFtcGluZ1RocmVzaG9sZFNxciIse2dldDpfLnByb3RvdHlwZS5taSxzZXQ6Xy5wcm90b3R5cGUuaGp9KSxfLnByb3RvdHlwZS5nZXRfbV9hZGRpdGlvbmFsQW5ndWxhckRhbXBpbmdUaHJlc2hvbGRTcXI9Xy5wcm90b3R5cGUuamk9ZnVuY3Rpb24oKXtyZXR1cm4gTGEodGhpcy5XaCl9LF8ucHJvdG90eXBlLnNldF9tX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ1RocmVzaG9sZFNxcj1fLnByb3RvdHlwZS5laj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksSGEobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ1RocmVzaG9sZFNxciIse2dldDpfLnByb3RvdHlwZS5qaSxzZXQ6Xy5wcm90b3R5cGUuZWp9KSxfLnByb3RvdHlwZS5nZXRfbV9hZGRpdGlvbmFsQW5ndWxhckRhbXBpbmdGYWN0b3I9Xy5wcm90b3R5cGUuaWk9ZnVuY3Rpb24oKXtyZXR1cm4gWWEodGhpcy5XaCl9LF8ucHJvdG90eXBlLnNldF9tX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ0ZhY3Rvcj1fLnByb3RvdHlwZS5kaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksVmEobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ0ZhY3RvciIse2dldDpfLnByb3RvdHlwZS5paSxzZXQ6Xy5wcm90b3R5cGUuZGp9KSxfLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe1FhKHRoaXMuV2gpfTtmdW5jdGlvbiBsKGUpe2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksdGhpcy5XaD1FYShlKSxBKGwpW3RoaXMuV2hdPXRoaXN9bC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShDLnByb3RvdHlwZSksbC5wcm90b3R5cGUuY29uc3RydWN0b3I9bCxsLnByb3RvdHlwZS5YaD1sLGwuWWg9e30sdC5idFJpZ2lkQm9keT1sLGwucHJvdG90eXBlLmdldENlbnRlck9mTWFzc1RyYW5zZm9ybT1mdW5jdGlvbigpe3JldHVybiBhKFhhKHRoaXMuV2gpLE8pfSxsLnByb3RvdHlwZS5zZXRDZW50ZXJPZk1hc3NUcmFuc2Zvcm09ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFVhKG8sZSl9LGwucHJvdG90eXBlLnNldFNsZWVwaW5nVGhyZXNob2xkcz1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLEdhKG4sZSxvKX0sbC5wcm90b3R5cGUuZ2V0TGluZWFyRGFtcGluZz1mdW5jdGlvbigpe3JldHVybiBOYSh0aGlzLldoKX0sbC5wcm90b3R5cGUuZ2V0QW5ndWxhckRhbXBpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gemEodGhpcy5XaCl9LGwucHJvdG90eXBlLnNldERhbXBpbmc9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxxYShuLGUsbyl9LGwucHJvdG90eXBlLnNldE1hc3NQcm9wcz1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLFphKG4sZSxvKX0sbC5wcm90b3R5cGUuZ2V0TGluZWFyRmFjdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIGEoS2EodGhpcy5XaCkseSl9LGwucHJvdG90eXBlLnNldExpbmVhckZhY3Rvcj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksJGEobyxlKX0sbC5wcm90b3R5cGUuYXBwbHlUb3JxdWU9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEphKG8sZSl9LGwucHJvdG90eXBlLmFwcGx5TG9jYWxUb3JxdWU9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHRzKG8sZSl9LGwucHJvdG90eXBlLmFwcGx5Rm9yY2U9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxlcyhuLGUsbyl9LGwucHJvdG90eXBlLmFwcGx5Q2VudHJhbEZvcmNlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvcyhvLGUpfSxsLnByb3RvdHlwZS5hcHBseUNlbnRyYWxMb2NhbEZvcmNlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxucyhvLGUpfSxsLnByb3RvdHlwZS5hcHBseVRvcnF1ZUltcHVsc2U9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHJzKG8sZSl9LGwucHJvdG90eXBlLmFwcGx5SW1wdWxzZT1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLF9zKG4sZSxvKX0sbC5wcm90b3R5cGUuYXBwbHlDZW50cmFsSW1wdWxzZT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksaXMobyxlKX0sbC5wcm90b3R5cGUudXBkYXRlSW5lcnRpYVRlbnNvcj1mdW5jdGlvbigpe2FzKHRoaXMuV2gpfSxsLnByb3RvdHlwZS5nZXRMaW5lYXJWZWxvY2l0eT1mdW5jdGlvbigpe3JldHVybiBhKHNzKHRoaXMuV2gpLHkpfSxsLnByb3RvdHlwZS5nZXRBbmd1bGFyVmVsb2NpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gYShwcyh0aGlzLldoKSx5KX0sbC5wcm90b3R5cGUuc2V0TGluZWFyVmVsb2NpdHk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGxzKG8sZSl9LGwucHJvdG90eXBlLnNldEFuZ3VsYXJWZWxvY2l0eT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksdXMobyxlKX0sbC5wcm90b3R5cGUuZ2V0TW90aW9uU3RhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gYShjcyh0aGlzLldoKSxudCl9LGwucHJvdG90eXBlLnNldE1vdGlvblN0YXRlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx5cyhvLGUpfSxsLnByb3RvdHlwZS5nZXRBbmd1bGFyRmFjdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIGEoaHModGhpcy5XaCkseSl9LGwucHJvdG90eXBlLnNldEFuZ3VsYXJGYWN0b3I9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGZzKG8sZSl9LGwucHJvdG90eXBlLnVwY2FzdD1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGEobXMobyxlKSxsKX0sbC5wcm90b3R5cGUuZ2V0QWFiYj1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLGJzKG4sZSxvKX0sbC5wcm90b3R5cGUuYXBwbHlHcmF2aXR5PWZ1bmN0aW9uKCl7Z3ModGhpcy5XaCl9LGwucHJvdG90eXBlLmdldEdyYXZpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gYShkcyh0aGlzLldoKSx5KX0sbC5wcm90b3R5cGUuc2V0R3Jhdml0eT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksV3MobyxlKX0sbC5wcm90b3R5cGUuZ2V0QnJvYWRwaGFzZVByb3h5PWZ1bmN0aW9uKCl7cmV0dXJuIGEoQ3ModGhpcy5XaCksQil9LGwucHJvdG90eXBlLmNsZWFyRm9yY2VzPWZ1bmN0aW9uKCl7anModGhpcy5XaCl9LGwucHJvdG90eXBlLnNldEFuaXNvdHJvcGljRnJpY3Rpb249ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSx2cyhuLGUsbyl9LGwucHJvdG90eXBlLmdldENvbGxpc2lvblNoYXBlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoRHModGhpcy5XaCksSCl9LGwucHJvdG90eXBlLnNldENvbnRhY3RQcm9jZXNzaW5nVGhyZXNob2xkPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxScyhvLGUpfSxsLnByb3RvdHlwZS5zZXRBY3RpdmF0aW9uU3RhdGU9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFNzKG8sZSl9LGwucHJvdG90eXBlLmZvcmNlQWN0aXZhdGlvblN0YXRlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxJcyhvLGUpfSxsLnByb3RvdHlwZS5hY3RpdmF0ZT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZT09PXZvaWQgMD9PcyhvKTpCcyhvLGUpfSxsLnByb3RvdHlwZS5pc0FjdGl2ZT1mdW5jdGlvbigpe3JldHVybiEhUHModGhpcy5XaCl9LGwucHJvdG90eXBlLmlzS2luZW1hdGljT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuISF4cyh0aGlzLldoKX0sbC5wcm90b3R5cGUuaXNTdGF0aWNPYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4hIVRzKHRoaXMuV2gpfSxsLnByb3RvdHlwZS5pc1N0YXRpY09yS2luZW1hdGljT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuISFGcyh0aGlzLldoKX0sbC5wcm90b3R5cGUuZ2V0UmVzdGl0dXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gTXModGhpcy5XaCl9LGwucHJvdG90eXBlLmdldEZyaWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIEFzKHRoaXMuV2gpfSxsLnByb3RvdHlwZS5nZXRSb2xsaW5nRnJpY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gd3ModGhpcy5XaCl9LGwucHJvdG90eXBlLnNldFJlc3RpdHV0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxrcyhvLGUpfSxsLnByb3RvdHlwZS5zZXRGcmljdGlvbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksTHMobyxlKX0sbC5wcm90b3R5cGUuc2V0Um9sbGluZ0ZyaWN0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxIcyhvLGUpfSxsLnByb3RvdHlwZS5nZXRXb3JsZFRyYW5zZm9ybT1mdW5jdGlvbigpe3JldHVybiBhKFlzKHRoaXMuV2gpLE8pfSxsLnByb3RvdHlwZS5nZXRDb2xsaXNpb25GbGFncz1mdW5jdGlvbigpe3JldHVybiBWcyh0aGlzLldoKX0sbC5wcm90b3R5cGUuc2V0Q29sbGlzaW9uRmxhZ3M9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFFzKG8sZSl9LGwucHJvdG90eXBlLnNldFdvcmxkVHJhbnNmb3JtPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxFcyhvLGUpfSxsLnByb3RvdHlwZS5zZXRDb2xsaXNpb25TaGFwZT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksWHMobyxlKX0sbC5wcm90b3R5cGUuc2V0Q2NkTW90aW9uVGhyZXNob2xkPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxVcyhvLGUpfSxsLnByb3RvdHlwZS5zZXRDY2RTd2VwdFNwaGVyZVJhZGl1cz1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksR3MobyxlKX0sbC5wcm90b3R5cGUuZ2V0VXNlckluZGV4PWZ1bmN0aW9uKCl7cmV0dXJuIE5zKHRoaXMuV2gpfSxsLnByb3RvdHlwZS5zZXRVc2VySW5kZXg9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHpzKG8sZSl9LGwucHJvdG90eXBlLmdldFVzZXJQb2ludGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGEocXModGhpcy5XaCksYnQpfSxsLnByb3RvdHlwZS5zZXRVc2VyUG9pbnRlcj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksWnMobyxlKX0sbC5wcm90b3R5cGUuZ2V0QnJvYWRwaGFzZUhhbmRsZT1mdW5jdGlvbigpe3JldHVybiBhKEtzKHRoaXMuV2gpLEIpfSxsLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpeyRzKHRoaXMuV2gpfTtmdW5jdGlvbiBSdCgpe3RoaXMuV2g9SnMoKSxBKFJ0KVt0aGlzLldoXT10aGlzfVJ0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxSdC5wcm90b3R5cGUuY29uc3RydWN0b3I9UnQsUnQucHJvdG90eXBlLlhoPVJ0LFJ0LlloPXt9LHQuYnRTZXF1ZW50aWFsSW1wdWxzZUNvbnN0cmFpbnRTb2x2ZXI9UnQsUnQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7dHAodGhpcy5XaCl9O2Z1bmN0aW9uIE10KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0Q29uc3RyYWludFNvbHZlciwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1NdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksTXQucHJvdG90eXBlLmNvbnN0cnVjdG9yPU10LE10LnByb3RvdHlwZS5YaD1NdCxNdC5ZaD17fSx0LmJ0Q29uc3RyYWludFNvbHZlcj1NdCxNdC5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtlcCh0aGlzLldoKX07ZnVuY3Rpb24gcygpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidERpc3BhdGNoZXJJbmZvLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifXMucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLHMucHJvdG90eXBlLmNvbnN0cnVjdG9yPXMscy5wcm90b3R5cGUuWGg9cyxzLlloPXt9LHQuYnREaXNwYXRjaGVySW5mbz1zLHMucHJvdG90eXBlLmdldF9tX3RpbWVTdGVwPXMucHJvdG90eXBlLlhpPWZ1bmN0aW9uKCl7cmV0dXJuIG9wKHRoaXMuV2gpfSxzLnByb3RvdHlwZS5zZXRfbV90aW1lU3RlcD1zLnByb3RvdHlwZS5Saj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbnAobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMucHJvdG90eXBlLCJtX3RpbWVTdGVwIix7Z2V0OnMucHJvdG90eXBlLlhpLHNldDpzLnByb3RvdHlwZS5San0pLHMucHJvdG90eXBlLmdldF9tX3N0ZXBDb3VudD1zLnByb3RvdHlwZS5WaT1mdW5jdGlvbigpe3JldHVybiBycCh0aGlzLldoKX0scy5wcm90b3R5cGUuc2V0X21fc3RlcENvdW50PXMucHJvdG90eXBlLlBqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxfcChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fc3RlcENvdW50Iix7Z2V0OnMucHJvdG90eXBlLlZpLHNldDpzLnByb3RvdHlwZS5Qan0pLHMucHJvdG90eXBlLmdldF9tX2Rpc3BhdGNoRnVuYz1zLnByb3RvdHlwZS51aT1mdW5jdGlvbigpe3JldHVybiBpcCh0aGlzLldoKX0scy5wcm90b3R5cGUuc2V0X21fZGlzcGF0Y2hGdW5jPXMucHJvdG90eXBlLm9qPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhcChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fZGlzcGF0Y2hGdW5jIix7Z2V0OnMucHJvdG90eXBlLnVpLHNldDpzLnByb3RvdHlwZS5van0pLHMucHJvdG90eXBlLmdldF9tX3RpbWVPZkltcGFjdD1zLnByb3RvdHlwZS5XaT1mdW5jdGlvbigpe3JldHVybiBzcCh0aGlzLldoKX0scy5wcm90b3R5cGUuc2V0X21fdGltZU9mSW1wYWN0PXMucHJvdG90eXBlLlFqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxwcChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fdGltZU9mSW1wYWN0Iix7Z2V0OnMucHJvdG90eXBlLldpLHNldDpzLnByb3RvdHlwZS5Ran0pLHMucHJvdG90eXBlLmdldF9tX3VzZUNvbnRpbnVvdXM9cy5wcm90b3R5cGUuWmk9ZnVuY3Rpb24oKXtyZXR1cm4hIWxwKHRoaXMuV2gpfSxzLnByb3RvdHlwZS5zZXRfbV91c2VDb250aW51b3VzPXMucHJvdG90eXBlLlRqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx1cChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fdXNlQ29udGludW91cyIse2dldDpzLnByb3RvdHlwZS5aaSxzZXQ6cy5wcm90b3R5cGUuVGp9KSxzLnByb3RvdHlwZS5nZXRfbV9lbmFibGVTYXRDb252ZXg9cy5wcm90b3R5cGUud2k9ZnVuY3Rpb24oKXtyZXR1cm4hIWNwKHRoaXMuV2gpfSxzLnByb3RvdHlwZS5zZXRfbV9lbmFibGVTYXRDb252ZXg9cy5wcm90b3R5cGUucWo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHlwKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLnByb3RvdHlwZSwibV9lbmFibGVTYXRDb252ZXgiLHtnZXQ6cy5wcm90b3R5cGUud2ksc2V0OnMucHJvdG90eXBlLnFqfSkscy5wcm90b3R5cGUuZ2V0X21fZW5hYmxlU1BVPXMucHJvdG90eXBlLnZpPWZ1bmN0aW9uKCl7cmV0dXJuISFocCh0aGlzLldoKX0scy5wcm90b3R5cGUuc2V0X21fZW5hYmxlU1BVPXMucHJvdG90eXBlLnBqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxmcChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fZW5hYmxlU1BVIix7Z2V0OnMucHJvdG90eXBlLnZpLHNldDpzLnByb3RvdHlwZS5wan0pLHMucHJvdG90eXBlLmdldF9tX3VzZUVwYT1zLnByb3RvdHlwZS5haj1mdW5jdGlvbigpe3JldHVybiEhbXAodGhpcy5XaCl9LHMucHJvdG90eXBlLnNldF9tX3VzZUVwYT1zLnByb3RvdHlwZS5Waj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksYnAobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMucHJvdG90eXBlLCJtX3VzZUVwYSIse2dldDpzLnByb3RvdHlwZS5haixzZXQ6cy5wcm90b3R5cGUuVmp9KSxzLnByb3RvdHlwZS5nZXRfbV9hbGxvd2VkQ2NkUGVuZXRyYXRpb249cy5wcm90b3R5cGUubmk9ZnVuY3Rpb24oKXtyZXR1cm4gZ3AodGhpcy5XaCl9LHMucHJvdG90eXBlLnNldF9tX2FsbG93ZWRDY2RQZW5ldHJhdGlvbj1zLnByb3RvdHlwZS5paj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZHAobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMucHJvdG90eXBlLCJtX2FsbG93ZWRDY2RQZW5ldHJhdGlvbiIse2dldDpzLnByb3RvdHlwZS5uaSxzZXQ6cy5wcm90b3R5cGUuaWp9KSxzLnByb3RvdHlwZS5nZXRfbV91c2VDb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVV0aWw9cy5wcm90b3R5cGUuJGk9ZnVuY3Rpb24oKXtyZXR1cm4hIVdwKHRoaXMuV2gpfSxzLnByb3RvdHlwZS5zZXRfbV91c2VDb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVV0aWw9cy5wcm90b3R5cGUuVWo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLENwKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLnByb3RvdHlwZSwibV91c2VDb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVV0aWwiLHtnZXQ6cy5wcm90b3R5cGUuJGksc2V0OnMucHJvdG90eXBlLlVqfSkscy5wcm90b3R5cGUuZ2V0X21fY29udmV4Q29uc2VydmF0aXZlRGlzdGFuY2VUaHJlc2hvbGQ9cy5wcm90b3R5cGUucmk9ZnVuY3Rpb24oKXtyZXR1cm4ganAodGhpcy5XaCl9LHMucHJvdG90eXBlLnNldF9tX2NvbnZleENvbnNlcnZhdGl2ZURpc3RhbmNlVGhyZXNob2xkPXMucHJvdG90eXBlLmxqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx2cChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fY29udmV4Q29uc2VydmF0aXZlRGlzdGFuY2VUaHJlc2hvbGQiLHtnZXQ6cy5wcm90b3R5cGUucmksc2V0OnMucHJvdG90eXBlLmxqfSkscy5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtEcCh0aGlzLldoKX07ZnVuY3Rpb24gUygpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidENvbnRhY3RTb2x2ZXJJbmZvLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifVMucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLFMucHJvdG90eXBlLmNvbnN0cnVjdG9yPVMsUy5wcm90b3R5cGUuWGg9UyxTLlloPXt9LHQuYnRDb250YWN0U29sdmVySW5mbz1TLFMucHJvdG90eXBlLmdldF9tX3NwbGl0SW1wdWxzZT1TLnByb3RvdHlwZS5UaT1mdW5jdGlvbigpe3JldHVybiEhUnAodGhpcy5XaCl9LFMucHJvdG90eXBlLnNldF9tX3NwbGl0SW1wdWxzZT1TLnByb3RvdHlwZS5Oaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksU3AobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KFMucHJvdG90eXBlLCJtX3NwbGl0SW1wdWxzZSIse2dldDpTLnByb3RvdHlwZS5UaSxzZXQ6Uy5wcm90b3R5cGUuTmp9KSxTLnByb3RvdHlwZS5nZXRfbV9zcGxpdEltcHVsc2VQZW5ldHJhdGlvblRocmVzaG9sZD1TLnByb3RvdHlwZS5VaT1mdW5jdGlvbigpe3JldHVybiBJcCh0aGlzLldoKX0sUy5wcm90b3R5cGUuc2V0X21fc3BsaXRJbXB1bHNlUGVuZXRyYXRpb25UaHJlc2hvbGQ9Uy5wcm90b3R5cGUuT2o9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLE9wKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTLnByb3RvdHlwZSwibV9zcGxpdEltcHVsc2VQZW5ldHJhdGlvblRocmVzaG9sZCIse2dldDpTLnByb3RvdHlwZS5VaSxzZXQ6Uy5wcm90b3R5cGUuT2p9KSxTLnByb3RvdHlwZS5nZXRfbV9udW1JdGVyYXRpb25zPVMucHJvdG90eXBlLk1pPWZ1bmN0aW9uKCl7cmV0dXJuIEJwKHRoaXMuV2gpfSxTLnByb3RvdHlwZS5zZXRfbV9udW1JdGVyYXRpb25zPVMucHJvdG90eXBlLkdqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxQcChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoUy5wcm90b3R5cGUsIm1fbnVtSXRlcmF0aW9ucyIse2dldDpTLnByb3RvdHlwZS5NaSxzZXQ6Uy5wcm90b3R5cGUuR2p9KSxTLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe3hwKHRoaXMuV2gpfTtmdW5jdGlvbiBJKGUsbyxuLHIpe2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLHImJnR5cGVvZiByPT0ib2JqZWN0IiYmKHI9ci5XaCksdGhpcy5XaD1UcChlLG8sbixyKSxBKEkpW3RoaXMuV2hdPXRoaXN9SS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh4LnByb3RvdHlwZSksSS5wcm90b3R5cGUuY29uc3RydWN0b3I9SSxJLnByb3RvdHlwZS5YaD1JLEkuWWg9e30sdC5idERpc2NyZXRlRHluYW1pY3NXb3JsZD1JLEkucHJvdG90eXBlLnNldEdyYXZpdHk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEZwKG8sZSl9LEkucHJvdG90eXBlLmdldEdyYXZpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gYShNcCh0aGlzLldoKSx5KX0sSS5wcm90b3R5cGUuYWRkUmlnaWRCb2R5PWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/QXAocixlKTpuPT09dm9pZCAwP19lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9hZGRSaWdpZEJvZHlfMihyLGUsbyk6d3AocixlLG8sbil9LEkucHJvdG90eXBlLnJlbW92ZVJpZ2lkQm9keT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksa3AobyxlKX0sSS5wcm90b3R5cGUuc3RlcFNpbXVsYXRpb249ZnVuY3Rpb24oZSxvLG4pe3ZhciByPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/THAocixlKTpuPT09dm9pZCAwP0hwKHIsZSxvKTpZcChyLGUsbyxuKX0sSS5wcm90b3R5cGUuc2V0Q29udGFjdEFkZGVkQ2FsbGJhY2s9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFZwKG8sZSl9LEkucHJvdG90eXBlLnNldENvbnRhY3RQcm9jZXNzZWRDYWxsYmFjaz1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksUXAobyxlKX0sSS5wcm90b3R5cGUuc2V0Q29udGFjdERlc3Ryb3llZENhbGxiYWNrPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxFcChvLGUpfSxJLnByb3RvdHlwZS5nZXREaXNwYXRjaGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGEoWHAodGhpcy5XaCksSyl9LEkucHJvdG90eXBlLmdldFBhaXJDYWNoZT1mdW5jdGlvbigpe3JldHVybiBhKFVwKHRoaXMuV2gpLEopfSxJLnByb3RvdHlwZS5nZXREaXNwYXRjaEluZm89ZnVuY3Rpb24oKXtyZXR1cm4gYShHcCh0aGlzLldoKSxzKX0sSS5wcm90b3R5cGUuYWRkQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/TnAocixlKTpuPT09dm9pZCAwP3pwKHIsZSxvKTpxcChyLGUsbyxuKX0sSS5wcm90b3R5cGUucmVtb3ZlQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxacChvLGUpfSxJLnByb3RvdHlwZS5nZXRCcm9hZHBoYXNlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoS3AodGhpcy5XaCksc3QpfSxJLnByb3RvdHlwZS5jb252ZXhTd2VlcFRlc3Q9ZnVuY3Rpb24oZSxvLG4scixjKXt2YXIgRD10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLHImJnR5cGVvZiByPT0ib2JqZWN0IiYmKHI9ci5XaCksYyYmdHlwZW9mIGM9PSJvYmplY3QiJiYoYz1jLldoKSwkcChELGUsbyxuLHIsYyl9LEkucHJvdG90eXBlLmNvbnRhY3RQYWlyVGVzdD1mdW5jdGlvbihlLG8sbil7dmFyIHI9dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSxKcChyLGUsbyxuKX0sSS5wcm90b3R5cGUuY29udGFjdFRlc3Q9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSx0bChuLGUsbyl9LEkucHJvdG90eXBlLnVwZGF0ZVNpbmdsZUFhYmI9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGVsKG8sZSl9LEkucHJvdG90eXBlLmFkZEFjdGlvbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksb2wobyxlKX0sSS5wcm90b3R5cGUucmVtb3ZlQWN0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxubChvLGUpfSxJLnByb3RvdHlwZS5nZXRTb2x2ZXJJbmZvPWZ1bmN0aW9uKCl7cmV0dXJuIGEocmwodGhpcy5XaCksUyl9LEkucHJvdG90eXBlLnNldEludGVybmFsVGlja0NhbGxiYWNrPWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/X2wocixlKTpuPT09dm9pZCAwP2lsKHIsZSxvKTphbChyLGUsbyxuKX0sSS5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtzbCh0aGlzLldoKX07ZnVuY3Rpb24gU3QoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRBY3Rpb25JbnRlcmZhY2UsIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9cmV0dXJuIFN0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxTdC5wcm90b3R5cGUuY29uc3RydWN0b3I9U3QsU3QucHJvdG90eXBlLlhoPVN0LFN0LlloPXt9LHQuYnRBY3Rpb25JbnRlcmZhY2U9U3QsU3QucHJvdG90eXBlLnVwZGF0ZUFjdGlvbj1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLHBsKG4sZSxvKX0sU3QucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7bGwodGhpcy5XaCl9LGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3QuUEhZX0ZMT0FUPXVsKCksdC5QSFlfRE9VQkxFPWNsKCksdC5QSFlfSU5URUdFUj15bCgpLHQuUEhZX1NIT1JUPWhsKCksdC5QSFlfRklYRURQT0lOVDg4PWZsKCksdC5QSFlfVUNIQVI9bWwoKX1PZT9lKCk6VnQudW5zaGlmdChlKX0oKSx0LkNPTlRBQ1RfQURERURfQ0FMTEJBQ0tfU0lHTkFUVVJFPSJpaWlpaWlpaSIsdC5DT05UQUNUX0RFU1RST1lFRF9DQUxMQkFDS19TSUdOQVRVUkU9ImlpIix0LkNPTlRBQ1RfUFJPQ0VTU0VEX0NBTExCQUNLX1NJR05BVFVSRT0iaWlpaSIsdC5JTlRFUk5BTF9USUNLX0NBTExCQUNLX1NJR05BVFVSRT0idmlmIix0aGlzLkFtbW89dCxwLnJlYWR5fWxldCBBdD1bXSxOdD1bXSxJdD17fSxaLGcsdWUsS3QsY2UsJHQ9MTUwLEp0PTE1MCxodD0xLHRlPSExLGplPTYwLGk9ey4uLntzaXplOjkuNSxzdGFydGluZ0hlaWdodDo4LHNwaW5Gb3JjZTo2LHRocm93Rm9yY2U6NSxncmF2aXR5OjEsbWFzczoxLGZyaWN0aW9uOi44LHJlc3RpdHV0aW9uOi4xLGxpbmVhckRhbXBpbmc6LjUsYW5ndWxhckRhbXBpbmc6LjQsc2V0dGxlVGltZW91dDo1ZTN9fSx5ZSxrO3NlbGYub25tZXNzYWdlPXA9Pntzd2l0Y2gocC5kYXRhLmFjdGlvbil7Y2FzZSJyb2xsRGllIjpiZShwLmRhdGEuc2lkZXMpO2JyZWFrO2Nhc2UiaW5pdCI6ZGwocC5kYXRhKS50aGVuKCgpPT57c2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOiJpbml0LWNvbXBsZXRlIn0pfSk7YnJlYWs7Y2FzZSJjbGVhckRpY2UiOlJsKCk7YnJlYWs7Y2FzZSJyZW1vdmVEaWUiOkRlKHAuZGF0YS5pZCk7YnJlYWs7Y2FzZSJyZXNpemUiOiR0PXAuZGF0YS53aWR0aCxKdD1wLmRhdGEuaGVpZ2h0LGh0PSR0L0p0LG1lKGkuc2l6ZSxpLnN0YXJ0aW5nSGVpZ2h0KzEwKTticmVhaztjYXNlInVwZGF0ZUNvbmZpZyI6V2wocC5kYXRhLm9wdGlvbnMpO2JyZWFrO2Nhc2UiY29ubmVjdCI6dWU9cC5wb3J0c1swXSx1ZS5vbm1lc3NhZ2U9dD0+e3N3aXRjaCh0LmRhdGEuYWN0aW9uKXtjYXNlImluaXRCdWZmZXIiOms9bmV3IEZsb2F0MzJBcnJheSh0LmRhdGEuZGljZUJ1ZmZlciksa1swXT0tMTticmVhaztjYXNlImxvYWRNb2RlbHMiOkNsKHQuZGF0YS5vcHRpb25zKTticmVhaztjYXNlImFkZERpZSI6dC5kYXRhLm9wdGlvbnMubmV3U3RhcnRQb2ludCYmaGUoKTtjb25zdCBtPURsKHQuZGF0YS5vcHRpb25zKTtiZShtKTticmVhaztjYXNlInJvbGxEaWUiOmJlKHQuZGF0YS5pZCk7YnJlYWs7Y2FzZSJyZW1vdmVEaWUiOkRlKHQuZGF0YS5pZCk7YnJlYWs7Y2FzZSJzdG9wU2ltdWxhdGlvbiI6dGU9ITA7YnJlYWs7Y2FzZSJyZXN1bWVTaW11bGF0aW9uIjp0LmRhdGEubmV3U3RhcnRQb2ludCYmaGUoKSx0ZT0hMSxTZSgpO2JyZWFrO2Nhc2Uic3RlcFNpbXVsYXRpb24iOms9bmV3IEZsb2F0MzJBcnJheSh0LmRhdGEuZGljZUJ1ZmZlciksU2UoKTticmVhaztkZWZhdWx0OmNvbnNvbGUuZXJyb3IoImFjdGlvbiBub3QgZm91bmQgaW4gcGh5c2ljcyB3b3JrZXIgZnJvbSB3b3JsZE9mZnNjcmVlbiB3b3JrZXI6Iix0LmRhdGEuYWN0aW9uKX19O2JyZWFrO2RlZmF1bHQ6Y29uc29sZS5lcnJvcigiYWN0aW9uIG5vdCBmb3VuZCBpbiBwaHlzaWNzIHdvcmtlcjoiLHAuZGF0YS5hY3Rpb24pfX07Y29uc3QgZGw9YXN5bmMgcD0+eyR0PXAud2lkdGgsSnQ9cC5oZWlnaHQsaHQ9JHQvSnQsaT17Li4uaSwuLi5wLm9wdGlvbnN9LGkuZ3Jhdml0eT09PTB8fGkuZ3Jhdml0eStpLm1hc3MvMyxpLm1hc3M9MStpLm1hc3MvMyxpLnNwaW5Gb3JjZT1pLnNwaW5Gb3JjZS9qZSxpLnRocm93Rm9yY2U9aS50aHJvd0ZvcmNlLzIvaS5tYXNzKigxK2kuc2NhbGUvNiksaS5zdGFydGluZ0hlaWdodD1pLnN0YXJ0aW5nSGVpZ2h0PDE/MTppLnN0YXJ0aW5nSGVpZ2h0O2NvbnN0IHQ9e2xvY2F0ZUZpbGU6KCk9PmAke2kub3JpZ2luK2kuYXNzZXRQYXRofWFtbW8vYW1tby53YXNtLndhc21gfTtnPWF3YWl0IG5ldyBnbCh0KSxLdD1uZXcgZy5idFRyYW5zZm9ybSxjZT1uZXcgZy5idFZlY3RvcjMoMCwwLDApLHllPVAoMCwwLDApLGhlKCksWj1TbCgpLG1lKGkuc2l6ZSxpLnN0YXJ0aW5nSGVpZ2h0KzEwKX0sV2w9cD0+e2k9ey4uLmksLi4ucH0saS5tYXNzPTEraS5tYXNzLzMsaS5ncmF2aXR5PWkuZ3Jhdml0eT09PTA/MDppLmdyYXZpdHkraS5tYXNzLzMsaS5zcGluRm9yY2U9aS5zcGluRm9yY2UvamUsaS50aHJvd0ZvcmNlPWkudGhyb3dGb3JjZS8yL2kubWFzcyooMStpLnNjYWxlLzYpLGkuc3RhcnRpbmdIZWlnaHQ9aS5zdGFydGluZ0hlaWdodDwxPzE6aS5zdGFydGluZ0hlaWdodCx2ZSgpLG1lKGkuc2l6ZSxpLnN0YXJ0aW5nSGVpZ2h0KzEwKSxaLnNldEdyYXZpdHkoUCgwLC05LjgxKmkuZ3Jhdml0eSwwKSksT2JqZWN0LnZhbHVlcyhJdCkubWFwKHQ9Pnt0LmNvbnZleEh1bGwuc2V0TG9jYWxTY2FsaW5nKFAoaS5zY2FsZSxpLnNjYWxlLGkuc2NhbGUpKX0pfSxDbD1hc3luYyh7Y29sbGlkZXJzOnAsbWVzaE5hbWU6dH0pPT57bGV0IG09ITEsZD0hMTtwLmZvckVhY2goKGosVik9PntJdFt0KyJfIitqLm5hbWVdPWosSXRbdCsiXyIrai5uYW1lXS5jb252ZXhIdWxsPWpsKGopLGR8fChkPWouaWQ9PT0iZDEwX2NvbGxpZGVyIiksbXx8KG09ai5pZD09PSJkMTAwX2NvbGxpZGVyIil9KSwhbSYmZCYmKEl0W2Ake3R9X2QxMDBfY29sbGlkZXJgXT1JdFtgJHt0fV9kMTBfY29sbGlkZXJgXSl9LFA9KHAsdCxtKT0+KGNlLnNldFZhbHVlKHAsdCxtKSxjZSksaGU9KCk9PntsZXQgcD1pLnNpemUsdD0uNSxtPXAqaHQvMi10LGQ9cCpodC8tMit0LGo9cC8yLXQsVj1wLy0yK3QsWD1wdChtLGQsTWF0aC5yYW5kb20oKSksVT1wdChqLFYsTWF0aC5yYW5kb20oKSksRz1NYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkpLHY9TWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSxRPU1hdGgucm91bmQoTWF0aC5yYW5kb20oKSk7aS5zdGFydFBvc2l0aW9uPVtRP1g6dj9kOm0saS5zdGFydGluZ0hlaWdodCxRP0c/VjpqOlVdfSxqbD1wPT57Y29uc3QgdD1uZXcgZy5idENvbnZleEh1bGxTaGFwZTtsZXQgbT1wLnBvc2l0aW9ucy5sZW5ndGg7Zm9yKGxldCBkPTA7ZDxtO2QrPTMpe2xldCBqPVAocC5wb3NpdGlvbnNbZF0scC5wb3NpdGlvbnNbZCsxXSxwLnBvc2l0aW9uc1tkKzJdKTt0LmFkZFBvaW50KGosITApfXJldHVybiB0LnNldExvY2FsU2NhbGluZyhQKHAuc2NhbGluZ1swXSppLnNjYWxlLHAuc2NhbGluZ1sxXSppLnNjYWxlLHAuc2NhbGluZ1syXSppLnNjYWxlKSksdH0sdmw9KHAsdCk9Pntjb25zdHttYXNzOm09LjEsY29sbGlzaW9uRmxhZ3M6ZD0wLHBvczpqPVswLDAsMF0scXVhdDpWPVtwdCgtMS41LDEuNSxNYXRoLnJhbmRvbSgpKSxwdCgtMS41LDEuNSxNYXRoLnJhbmRvbSgpKSxwdCgtMS41LDEuNSxNYXRoLnJhbmRvbSgpKSwtMV0sc2NhbGU6WD1bMSwxLDFdLGZyaWN0aW9uOlU9aS5mcmljdGlvbixyZXN0aXR1dGlvbjpHPWkucmVzdGl0dXRpb259PXQsdj1uZXcgZy5idFRyYW5zZm9ybTt2LnNldElkZW50aXR5KCksdi5zZXRPcmlnaW4oUChqWzBdLGpbMV0salsyXSkpLHYuc2V0Um90YXRpb24obmV3IGcuYnRRdWF0ZXJuaW9uKFZbMF0sVlsxXSxWWzJdLFZbM10pKTtjb25zdCBRPW5ldyBnLmJ0RGVmYXVsdE1vdGlvblN0YXRlKHYpLHR0PVAoMCwwLDApO20+MCYmcC5jYWxjdWxhdGVMb2NhbEluZXJ0aWEobSx0dCk7Y29uc3Qgd3Q9bmV3IGcuYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvKG0sUSxwLHR0KSx6PW5ldyBnLmJ0UmlnaWRCb2R5KHd0KTtyZXR1cm4gbT4wJiZ6LnNldEFjdGl2YXRpb25TdGF0ZSg0KSx6LnNldENvbGxpc2lvbkZsYWdzKGQpLHouc2V0RnJpY3Rpb24oVSksei5zZXRSZXN0aXR1dGlvbihHKSx6LnNldERhbXBpbmcoaS5saW5lYXJEYW1waW5nLGkuYW5ndWxhckRhbXBpbmcpLHp9O2xldCBmZT1bXTtjb25zdCBtZT0ocCx0KT0+e2NvbnN0IG09W10sZD1QKDAsMCwwKSxqPW5ldyBnLmJ0VHJhbnNmb3JtO2ouc2V0SWRlbnRpdHkoKSxqLnNldE9yaWdpbihQKDAsLS41LDApKTtjb25zdCBWPW5ldyBnLmJ0Qm94U2hhcGUoUChwKmh0LDEscCkpLFg9bmV3IGcuYnREZWZhdWx0TW90aW9uU3RhdGUoaiksVT1uZXcgZy5idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm8oMCxYLFYsZCksRz1uZXcgZy5idFJpZ2lkQm9keShVKTtHLnNldEZyaWN0aW9uKGkuZnJpY3Rpb24pLEcuc2V0UmVzdGl0dXRpb24oaS5yZXN0aXR1dGlvbiksWi5hZGRSaWdpZEJvZHkoRyksbS5wdXNoKEcpO2NvbnN0IHY9bmV3IGcuYnRUcmFuc2Zvcm07di5zZXRJZGVudGl0eSgpLHYuc2V0T3JpZ2luKFAoMCx0LS41LDApKTtjb25zdCBRPW5ldyBnLmJ0Qm94U2hhcGUoUChwKmh0LDEscCkpLHR0PW5ldyBnLmJ0RGVmYXVsdE1vdGlvblN0YXRlKHYpLHd0PW5ldyBnLmJ0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mbygwLHR0LFEsZCksej1uZXcgZy5idFJpZ2lkQm9keSh3dCk7ei5zZXRGcmljdGlvbihpLmZyaWN0aW9uKSx6LnNldFJlc3RpdHV0aW9uKGkucmVzdGl0dXRpb24pLFouYWRkUmlnaWRCb2R5KHopLG0ucHVzaCh6KTtjb25zdCB6dD1uZXcgZy5idFRyYW5zZm9ybTt6dC5zZXRJZGVudGl0eSgpLHp0LnNldE9yaWdpbihQKDAsMCxwLy0yLS41KSk7Y29uc3QgT3Q9bmV3IGcuYnRCb3hTaGFwZShQKHAqaHQsdCwxKSksZWU9bmV3IGcuYnREZWZhdWx0TW90aW9uU3RhdGUoenQpLEJ0PW5ldyBnLmJ0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mbygwLGVlLE90LGQpLGZ0PW5ldyBnLmJ0UmlnaWRCb2R5KEJ0KTtmdC5zZXRGcmljdGlvbihpLmZyaWN0aW9uKSxmdC5zZXRSZXN0aXR1dGlvbihpLnJlc3RpdHV0aW9uKSxaLmFkZFJpZ2lkQm9keShmdCksbS5wdXNoKGZ0KTtjb25zdCBrdD1uZXcgZy5idFRyYW5zZm9ybTtrdC5zZXRJZGVudGl0eSgpLGt0LnNldE9yaWdpbihQKDAsMCxwLzIrLjUpKTtjb25zdCBXdD1uZXcgZy5idEJveFNoYXBlKFAocCpodCx0LDEpKSxvZT1uZXcgZy5idERlZmF1bHRNb3Rpb25TdGF0ZShrdCksTHQ9bmV3IGcuYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvKDAsb2UsV3QsZCksQ3Q9bmV3IGcuYnRSaWdpZEJvZHkoTHQpO0N0LnNldEZyaWN0aW9uKGkuZnJpY3Rpb24pLEN0LnNldFJlc3RpdHV0aW9uKGkucmVzdGl0dXRpb24pLFouYWRkUmlnaWRCb2R5KEN0KSxtLnB1c2goQ3QpO2NvbnN0IEh0PW5ldyBnLmJ0VHJhbnNmb3JtO0h0LnNldElkZW50aXR5KCksSHQuc2V0T3JpZ2luKFAocCpodC8tMi0uNSwwLDApKTtjb25zdCBZdD1uZXcgZy5idEJveFNoYXBlKFAoMSx0LHApKSxYdD1uZXcgZy5idERlZmF1bHRNb3Rpb25TdGF0ZShIdCksbmU9bmV3IGcuYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvKDAsWHQsWXQsZCksUHQ9bmV3IGcuYnRSaWdpZEJvZHkobmUpO1B0LnNldEZyaWN0aW9uKGkuZnJpY3Rpb24pLFB0LnNldFJlc3RpdHV0aW9uKGkucmVzdGl0dXRpb24pLFouYWRkUmlnaWRCb2R5KFB0KSxtLnB1c2goUHQpO2NvbnN0IGV0PW5ldyBnLmJ0VHJhbnNmb3JtO2V0LnNldElkZW50aXR5KCksZXQuc2V0T3JpZ2luKFAocCpodC8yKy41LDAsMCkpO2NvbnN0IFV0PW5ldyBnLmJ0Qm94U2hhcGUoUCgxLHQscCkpLHJlPW5ldyBnLmJ0RGVmYXVsdE1vdGlvblN0YXRlKGV0KSxfZT1uZXcgZy5idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm8oMCxyZSxVdCxkKSxWdD1uZXcgZy5idFJpZ2lkQm9keShfZSk7VnQuc2V0RnJpY3Rpb24oaS5mcmljdGlvbiksVnQuc2V0UmVzdGl0dXRpb24oaS5yZXN0aXR1dGlvbiksWi5hZGRSaWdpZEJvZHkoVnQpLG0ucHVzaChWdCksZmUubGVuZ3RoJiZ2ZSgpLGZlPVsuLi5tXX0sdmU9KCk9PntmZS5mb3JFYWNoKHA9PloucmVtb3ZlUmlnaWRCb2R5KHApKX0sRGw9cD0+e3ZhciB0dDtjb25zdHtzaWRlczp0LGlkOm0sbWVzaE5hbWU6ZCxzY2FsZTpqfT1wO2xldCBYPWAke051bWJlci5pc0ludGVnZXIodCk/YGQke3R9YDp0fV9jb2xsaWRlcmA7Y29uc3QgVT1gJHtkfV8ke1h9YCx2PSgoKHR0PUl0W1VdKT09bnVsbD92b2lkIDA6dHQucGh5c2ljc01hc3MpfHwuMSkqaS5tYXNzKmkuc2NhbGUsUT12bChJdFtVXS5jb252ZXhIdWxsLHttYXNzOnYsc2NhbGluZzpJdFtVXS5zY2FsaW5nLHBvczppLnN0YXJ0UG9zaXRpb259KTtyZXR1cm4gUS5pZD1tLFEudGltZW91dD1pLnNldHRsZVRpbWVvdXQsUS5tYXNzPXYsWi5hZGRSaWdpZEJvZHkoUSksQXQucHVzaChRKSxRfSxiZT1wPT57cC5zZXRMaW5lYXJWZWxvY2l0eShQKHB0KC1pLnN0YXJ0UG9zaXRpb25bMF0qLjUsLWkuc3RhcnRQb3NpdGlvblswXSppLnRocm93Rm9yY2UsTWF0aC5yYW5kb20oKSkscHQoLWkuc3RhcnRQb3NpdGlvblsxXSwtaS5zdGFydFBvc2l0aW9uWzFdKjIsTWF0aC5yYW5kb20oKSkscHQoLWkuc3RhcnRQb3NpdGlvblsyXSouNSwtaS5zdGFydFBvc2l0aW9uWzJdKmkudGhyb3dGb3JjZSxNYXRoLnJhbmRvbSgpKSkpO2NvbnN0IHQ9bmV3IGcuYnRWZWN0b3IzKHB0KC1pLnNwaW5Gb3JjZSxpLnNwaW5Gb3JjZSxNYXRoLnJhbmRvbSgpKSxwdCgtaS5zcGluRm9yY2UsaS5zcGluRm9yY2UsTWF0aC5yYW5kb20oKSkscHQoLWkuc3BpbkZvcmNlLGkuc3BpbkZvcmNlLE1hdGgucmFuZG9tKCkpKSxtPU1hdGguYWJzKGkuc2NhbGUtMSkraS5zY2FsZSppLnNjYWxlKihwLm1hc3MvaS5tYXNzKSouNzU7cC5hcHBseUltcHVsc2UodCxQKG0sbSxtKSl9LERlPXA9PntOdD1OdC5maWx0ZXIodD0+e2xldCBtPXQuaWQ9PT1wO3JldHVybiBtJiZaLnJlbW92ZVJpZ2lkQm9keSh0KSwhbX0pfSxSbD0oKT0+e2suYnl0ZUxlbmd0aCYmay5maWxsKDApLHRlPSEwLEF0LmZvckVhY2gocD0+Wi5yZW1vdmVSaWdpZEJvZHkocCkpLE50LmZvckVhY2gocD0+Wi5yZW1vdmVSaWdpZEJvZHkocCkpLEF0PVtdLE50PVtdfSxTbD0oKT0+e2NvbnN0IHA9bmV3IGcuYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbix0PW5ldyBnLmJ0RGJ2dEJyb2FkcGhhc2UsbT1uZXcgZy5idFNlcXVlbnRpYWxJbXB1bHNlQ29uc3RyYWludFNvbHZlcixkPW5ldyBnLmJ0Q29sbGlzaW9uRGlzcGF0Y2hlcihwKSxqPW5ldyBnLmJ0RGlzY3JldGVEeW5hbWljc1dvcmxkKGQsdCxtLHApO3JldHVybiBqLnNldEdyYXZpdHkoUCgwLC05LjgxKmkuZ3Jhdml0eSwwKSksan0sSWw9cD0+e2NvbnN0IHQ9cC8xZTM7Wi5zdGVwU2ltdWxhdGlvbih0LDIsMS85MCksa1swXT1BdC5sZW5ndGg7Zm9yKGxldCBtPUF0Lmxlbmd0aC0xO20+PTA7bS0tKXtjb25zdCBkPUF0W21dLGo9ZC5nZXRMaW5lYXJWZWxvY2l0eSgpLmxlbmd0aCgpLFY9ZC5nZXRBbmd1bGFyVmVsb2NpdHkoKS5sZW5ndGgoKTtpZihqPC4wMSYmVjwuMDA1fHxkLnRpbWVvdXQ8MCl7a1ttKjgrMV09ZC5pZCxrW20qOCsyXT0tMSxkLmFzbGVlcD0hMCxkLnNldE1hc3NQcm9wcygwKSxkLmZvcmNlQWN0aXZhdGlvblN0YXRlKDMpLGQuc2V0TGluZWFyVmVsb2NpdHkoeWUpLGQuc2V0QW5ndWxhclZlbG9jaXR5KHllKSxOdC5wdXNoKEF0LnNwbGljZShtLDEpWzBdKTtjb250aW51ZX1kLnRpbWVvdXQtPXA7Y29uc3QgWD1kLmdldE1vdGlvblN0YXRlKCk7aWYoWCl7WC5nZXRXb3JsZFRyYW5zZm9ybShLdCk7bGV0IFU9S3QuZ2V0T3JpZ2luKCksRz1LdC5nZXRSb3RhdGlvbigpLHY9bSo4KzE7a1t2XT1kLmlkLGtbdisxXT1VLngoKSxrW3YrMl09VS55KCksa1t2KzNdPVUueigpLGtbdis0XT1HLngoKSxrW3YrNV09Ry55KCksa1t2KzZdPUcueigpLGtbdis3XT1HLncoKX19fTtsZXQgUmU9bmV3IERhdGUoKS5nZXRUaW1lKCk7Y29uc3QgU2U9KCk9PntsZXQgcD1uZXcgRGF0ZSgpLmdldFRpbWUoKTtjb25zdCB0PXAtUmU7UmU9cCwhdGUmJmsuYnl0ZUxlbmd0aCYmKElsKHQpLHVlLnBvc3RNZXNzYWdlKHthY3Rpb246InVwZGF0ZXMiLGRpY2VCdWZmZXI6ay5idWZmZXJ9LFtrLmJ1ZmZlcl0pKX19KSgpOwo=",Us=typeof window<"u"&&window.Blob&&new Blob([atob(ad)],{type:"text/javascript;charset=utf-8"});function Hd(){const Z=Us&&(window.URL||window.webkitURL).createObjectURL(Us);try{return Z?new Worker(Z):new Worker("data:application/javascript;base64,"+ad)}finally{Z&&(window.URL||window.webkitURL).revokeObjectURL(Z)}}const Id=Z=>{let l;return function(){let e=this,t=arguments;l&&window.cancelAnimationFrame(l),l=window.requestAnimationFrame(function(){Z.apply(e,t)})}},Ed=(Z={dedupe:!1})=>{const{dedupe:l}=Z;let e=[],t;const a=d=>(l&&(e=[]),e.push(d),t||(t=s()),t.finally(()=>{t=void 0})),s=async()=>{const d=[];for(;e.length;){const i=e.shift();d.push(await i())}return d};return{push:a,queue:e,flush:()=>t||Promise.resolve([])}},sd=Z=>JSON.parse(JSON.stringify(Z));let fs=class{static value(){const l=window.crypto||window.msCrypto,e=new Uint32Array(1);return l.getRandomValues(e)[0]/2**32}static range(l,e){return Math.floor(Math.pow(10,14)*this.value()*this.value())%(e-l+1)+l}};const Kd=Z=>{let l=!1,e=Z.slice(Z.startsWith("#")?1:0);e.length===3?e=[...e].map(a=>a+a).join(""):e.length===8&&(l=!0),e=parseInt(e,16);let t={r:e>>>16,g:(e&65280)>>>8,b:e&255};return l&&(t.r=e>>>24,t.g=(e&16711680)>>>16,t.b=(e&65280)>>>8,t.a=e&255),t},Bd={id:`dice-canvas-${Date.now()}`,enableShadows:!0,shadowTransparency:.8,lightIntensity:1,delay:10,scale:5,theme:"default",themeColor:"#2e8555",offscreen:!0,assetPath:"/assets/dice-box/",origin:typeof window<"u"?window.location.origin:"",meshFile:"models/default.json",suspendSimulation:!1};var St,Ht,Xa,ua,ee,ra,ia,Ue,Ga,ca,$a,dd,ls,id,es,cd,na,ts,Za,as;let wh=class{constructor(l,e={}){if(ae(this,$a),ae(this,ls),ae(this,es),ae(this,na),ae(this,Za),pt(this,"rollCollectionData",{}),pt(this,"rollGroupData",{}),pt(this,"rollDiceData",{}),pt(this,"themeData",[]),pt(this,"themesLoadedData",{}),ae(this,St,0),ae(this,Ht,0),ae(this,Xa,0),ae(this,ua,0),ae(this,ee,{}),ae(this,ra,void 0),ae(this,ia,void 0),ae(this,Ue,void 0),ae(this,Ga,void 0),ae(this,ca,void 0),pt(this,"noop",()=>{}),typeof e!="object")throw new Error("Config options should be an object. Config reference: https://fantasticdice.games/docs/usage/config#configuration-options");const{onDieComplete:t,onRollComplete:a,onRemoveComplete:s,onThemeConfigLoaded:d,onThemeLoaded:i,...c}=e;this.config={...Bd,...c},this.onDieComplete=e.onDieComplete||this.noop,this.onRollComplete=e.onRollComplete||this.noop,this.onRemoveComplete=e.onRemoveComplete||this.noop,this.onThemeLoaded=e.onThemeLoaded||this.noop,this.onThemeConfigLoaded=e.onThemeConfigLoaded||this.noop,this.canvas=kd({selector:l,id:this.config.id}),this.isVisible=!0,this.loadThemeQueue=Ed({dedupe:!0})}resizeWorld(){const l=Id(()=>{Ul(this,ee).resize({width:this.canvas.clientWidth,height:this.canvas.clientHeight}),Ul(this,Ue).postMessage({action:"resize",width:this.canvas.clientWidth,height:this.canvas.clientHeight})});window.addEventListener("resize",l)}async init(){return ct(this,ls,id).call(this),await ct(this,$a,dd).call(this),this.resizeWorld(),Ul(this,ee).onRollResult=l=>{const e=this.rollDiceData[l.rollId],t=this.rollGroupData[e.groupId],a=this.rollCollectionData[e.collectionId];t.rolls[e.rollId].value=l.value,a.completedRolls++,a.completedRolls==a.rolls.length&&a.resolve(Object.values(a.rolls).map(({collectionId:c,id:n,meshName:h,...m})=>m));const{collectionId:s,id:d,...i}=e;this.onDieComplete(i)},Ul(this,ee).onRollComplete=()=>{this.onRollComplete(this.getRollResults())},Ul(this,ee).onDieRemoved=l=>{let e=this.rollDiceData[l];const t=this.rollCollectionData[e.removeCollectionId];t.completedRolls++,delete this.rollDiceData[e.rollId];const a=this.rollGroupData[e.groupId];delete a.rolls[e.rollId];const s=ct(this,Za,as).call(this,e.groupId);a.value=s.value,a.qty=s.rollsArray.length,t.completedRolls==t.rolls.length&&t.resolve(Object.values(t.rolls).map(({id:m,...o})=>o));const{collectionId:d,id:i,removeCollectionId:c,meshName:n,...h}=e;this.onRemoveComplete(h)},await Promise.all([Ul(this,ra),Ul(this,Ga)]),ct(this,es,cd).call(this),await this.loadThemeQueue.push(()=>this.loadTheme(this.config.theme)),this}async getThemeConfig(l){const e=`${this.config.origin}${this.config.assetPath}themes/${l}`;let t;l==="default"?t={name:"Default Colors",material:{type:"color",diffuseTexture:{light:"diffuse-light.png",dark:"diffuse-dark.png"},diffuseLevel:1,bumpTexture:"normal.png",bumpLevel:.5,specularTexture:"specular.jpg",specularPower:1}}:t=await fetch(`${e}/theme.config.json`).then(d=>{if(d.ok){const i=d.headers.get("content-type");if(i&&i.indexOf("application/json")!==-1||d.type&&d.type==="basic")return d.json();throw new Error(`Incorrect contentType: ${i}. Expected "application/json" or "basic"`)}else throw new Error(`Unable to fetch config file for theme: '${l}'. Request rejected with status ${d.status}: ${d.statusText}`)}).catch(d=>console.error(d));let a=this.config.origin+this.config.assetPath+this.config.meshFile,s="default";if(!t)throw new Error("No theme config data to work with.");if(t.hasOwnProperty("meshFile")&&(a=`${e}/${t.meshFile}`,t.hasOwnProperty("meshName")?s=t.meshName:(console.warn("You should provide a meshName in your theme.config.json file"),s=t.meshFile.replace(/(.*)\..{2,4}$/,"$1"))),t.hasOwnProperty("diceAvailable")||(t.diceAvailable=["d4","d6","d8","d10","d12","d20","d100"]),t.hasOwnProperty("extends")){let d=this.themesLoadedData[t.extends];d||(d=await this.loadTheme(t.extends).catch(i=>console.error(i))),d&&(t.diceInherited=[...t.diceInherited||[]],d.diceAvailable.map(i=>{t.diceInherited[i]=d.systemName}))}return Object.assign(t,{basePath:e,meshFilePath:a,meshName:s,theme:l}),t}async loadTheme(l){if(this.themesLoadedData[l])return this.themesLoadedData[l];const e=this.themesLoadedData[l]=await this.getThemeConfig(l).catch(t=>console.error(t));if(this.onThemeConfigLoaded(e),!!e)return await Ul(this,ee).loadTheme(e).catch(t=>console.error(t)),this.onThemeLoaded(e),e}async updateConfig(l){const e={...this.config,...l};return await this.loadThemeQueue.push(()=>this.loadTheme(e.theme)),this.config=e,Ul(this,ee).updateConfig(e),Ul(this,Ue).postMessage({action:"updateConfig",options:e}),this}clear(){return Re(this,St,0),Re(this,Ht,0),Re(this,Xa,0),Re(this,ua,0),this.rollCollectionData={},this.rollGroupData={},this.rollDiceData={},Ul(this,ee).clear(),Ul(this,Ue).postMessage({action:"clearDice"}),this}hide(){return this.canvas.style.display="none",this.isVisible=!1,this}show(){return this.canvas.style.display="block",this.isVisible=!0,this.resizeWorld(),this}roll(l,{theme:e=this.config.theme,themeColor:t=this.config.themeColor,newStartPoint:a=!0}={}){this.clear();const s=xt(this,St)._++;this.rollCollectionData[s]=new Ia({id:s,notation:l,theme:e,themeColor:t,newStartPoint:a});const d=this.createNotationArray(l,this.themesLoadedData[e].diceAvailable);return ct(this,na,ts).call(this,d,s),this.rollCollectionData[s].promise}add(l,{theme:e=this.config.theme,themeColor:t=this.config.themeColor,newStartPoint:a=!0}={}){const s=xt(this,St)._++;this.rollCollectionData[s]=new Ia({id:s,notation:l,theme:e,themeColor:t,newStartPoint:a});const d=this.createNotationArray(l,this.themesLoadedData[e].diceAvailable);return ct(this,na,ts).call(this,d,s),this.rollCollectionData[s].promise}reroll(l,{remove:e=!1,hide:t=!1,newStartPoint:a=!0}={}){const s=(Array.isArray(l)?l:[l]).map(({value:d,...i})=>i);return e===!0&&this.remove(s,{hide:t}),this.add(s,{newStartPoint:a})}remove(l,{hide:e=!1}={}){const t=Array.isArray(l)?l:[l],a=xt(this,St)._++;return this.rollCollectionData[a]=new Ia({id:a,notation:l,rolls:t}),t.map(s=>{this.rollDiceData[s.rollId].removeCollectionId=a;let d=this.rollDiceData[s.rollId].id;Ul(this,ee).remove({id:d,rollId:s.rollId}),Ul(this,Ue).postMessage({action:"removeDie",id:d})}),this.rollCollectionData[a].promise}createNotationArray(l,e){const t=Array.isArray(l)?l:[l];let a=[];const s=c=>{if(c.hasOwnProperty("qty")||(c.qty=1),c.hasOwnProperty("sides"))return c.sides==="100"&&(c.sides=100,c.data="single"),!0;{const n="Roll notation is missing sides";throw new Error(n)}},d=c=>{c=c.toString();let n=c.split(".");return n[1]?n[1]=parseInt(n[1])+1:n[1]=1,n[0]+"."+n[1]},i=c=>{c.hasOwnProperty("rollId")&&this.rollDiceData.hasOwnProperty(c.rollId)&&(c.rollId=d(c.rollId))};return t.forEach(c=>{typeof c=="string"?a.push(this.parse(c,e)):typeof t=="object"&&(i(c),s(c)&&a.push(c))}),a}parse(l,e){const t=/(\d+)([dD]{1}\d+)(.*)$/i,a=/(\d+)[dD]([0%]+)(.*)$/i,s=/(\d+)[dD](f+[ate]*)(.*)$/i,d=/(\d+)[dD]([\d\w]+)([+-]{0,1}\d+)?/i,i=/([+-])(\d+)/,c=l.trim().replace(/\s+/g,""),n=(u,V)=>{if(u=Number(u),Number.isNaN(u)||!Number.isInteger(u)||u<1)throw new Error(V);return u},h=c.match(a)||c.match(t)||c.match(s)||c.match(d);let m=0;const o="Invalid notation: "+l;if(!h||!h.length||h.length<3)throw new Error(o);if(h[3]&&i.test(h[3])){const u=h[3].match(i);let V=n(u[2],o);u[1].trim()==="-"&&(V*=-1),m=V}const b={qty:n(h[1],o),modifier:m};return c.match(a)?(b.sides=h[2],b.data="single"):c.match(s)?b.sides="fate":(e.includes(c.match(d)[2]),b.sides=h[2]),b}getRollResults(){return Object.entries(this.rollGroupData).map(([l,e])=>{const t=ct(this,Za,as).call(this,l);e.value=t.value,e.qty=t.rollsArray.length;const a={...e};return a.rolls=t.rollsArray,a})}};St=new WeakMap,Ht=new WeakMap,Xa=new WeakMap,ua=new WeakMap,ee=new WeakMap,ra=new WeakMap,ia=new WeakMap,Ue=new WeakMap,Ga=new WeakMap,ca=new WeakMap,$a=new WeakSet,dd=async function(){Re(this,ra,new Promise((l,e)=>{Re(this,ia,l)}));const Z=()=>{Ul(this,ia).call(this)};if("OffscreenCanvas"in window&&"transferControlToOffscreen"in this.canvas&&this.config.offscreen){const l=await xs(()=>Promise.resolve().then(()=>jd),void 0).then(e=>e.default);Re(this,ee,new l({canvas:this.canvas,options:this.config,onInitComplete:Z}))}else{this.config.offscreen&&(console.warn("This browser does not support OffscreenCanvas. Using standard canvas fallback."),this.config.offscreen=!1);const l=await xs(()=>Promise.resolve().then(()=>Qh),void 0).then(e=>e.default);Re(this,ee,new l({canvas:this.canvas,options:this.config,onInitComplete:Z}))}},ls=new WeakSet,id=function(){Re(this,Ue,new Hd),Re(this,Ga,new Promise((Z,l)=>{Re(this,ca,Z)})),Ul(this,Ue).onmessage=Z=>{switch(Z.data.action){case"init-complete":Ul(this,ca).call(this)}},Ul(this,Ue).postMessage({action:"init",width:this.canvas.clientWidth,height:this.canvas.clientHeight,options:this.config})},es=new WeakSet,cd=function(){const Z=new MessageChannel;Ul(this,ee).connect(Z.port1),Ul(this,Ue).postMessage({action:"connect"},[Z.port2])},na=new WeakSet,ts=async function(Z,l){const e=this.rollCollectionData[l];let t=e.newStartPoint;Z.forEach(async a=>{if(!a.sides)throw new Error("Improper dice notation or unable to parse notation");const s=a.theme||e.theme||this.config.theme,d=a.themeColor||e.themeColor||this.config.themeColor,i={},c=a.groupId!==void 0;let n;const h=()=>this.loadTheme(s);await this.loadThemeQueue.push(h);const{meshName:m,diceAvailable:o,diceInherited:b={},material:{type:u}}=this.themesLoadedData[s],V=Object.keys(b);let G="",p;u==="color"&&(p=Kd(d),G=p.r*.299+p.g*.587+p.b*.114>175?"_dark":"_light");for(var y=0,L=a.qty;y<L;y++){let N=a.rollId!==void 0?a.rollId:xt(this,Xa)._++,J=a.id!==void 0?a.id:xt(this,ua)._++;n=c?a.groupId:Ul(this,Ht);const R=Number.isInteger(a.sides)?`d${a.sides}`:a.sides,S={sides:a.sides,data:a.data,dieType:R,groupId:n,collectionId:e.id,rollId:N,id:J,theme:s,themeColor:d,meshName:m};if(i[N]=S,this.rollDiceData[N]=S,e.rolls.push(this.rollDiceData[N]),S.sides==="fate"&&!o.includes(R)&&!V.includes(R)){console.warn(`fate die unavailable in '${s}' theme. Using fallback.`);const T=-1,k=1;S.value=fs.range(T,k),Ul(this,ee).addNonDie(S)}else if(this.config.suspendSimulation||!o.includes(R)&&!V.includes(R)){console.warn(this.config.suspendSimulation?"3D simulation suspended. Using fallback.":`${S.sides} die unavailable in '${s}' theme. Using fallback.`);const T=Number.isInteger(S.sides)?S.sides:parseInt(S.sides.replace(/\D/g,""));S.value=fs.range(1,T),Ul(this,ee).addNonDie(S)}else{let T;if(V.includes(R)){const k=b[R];T=this.themesLoadedData[k]}Ul(this,ee).add({...S,newStartPoint:t,theme:(T==null?void 0:T.systemName)||s,meshName:(T==null?void 0:T.meshName)||m,colorSuffix:G})}t=!1}c?Object.assign(this.rollGroupData[n].rolls,i):(a.rolls=i,a.id=n,this.rollGroupData[n]=a,++xt(this,Ht)._)})},Za=new WeakSet,as=function(Z){const l=this.rollGroupData[Z],e=Object.values(l.rolls).map(({collectionId:a,id:s,meshName:d,...i})=>i);let t=e.reduce((a,s)=>{const d=isNaN(s.value)?0:s.value;return a+d},0);return t+=l.modifier?l.modifier:0,{value:t,rollsArray:e}};let Ia=class{constructor(l){Object.assign(this,l),this.rolls=l.rolls||[],this.completedRolls=0;const e=this;this.promise=new Promise((t,a)=>{e.resolve=t,e.reject=a})}};var Qd=Object.defineProperty,Pd=(Z,l,e)=>l in Z?Qd(Z,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):Z[l]=e,yt=(Z,l,e)=>(Pd(Z,typeof l!="symbol"?l+"":l,e),e),bs=(Z,l,e)=>{if(!l.has(Z))throw TypeError("Cannot "+e)},Ze=(Z,l,e)=>(bs(Z,l,"read from private field"),e?e.call(Z):l.get(Z)),Ea=(Z,l,e)=>{if(l.has(Z))throw TypeError("Cannot add the same private member more than once");l instanceof WeakSet?l.add(Z):l.set(Z,e)},Ts=(Z,l,e,t)=>(bs(Z,l,"write to private field"),t?t.call(Z,e):l.set(Z,e),e),wd=(Z,l,e)=>(bs(Z,l,"access private method"),e);const nd="dmFyIExsPU9iamVjdC5kZWZpbmVQcm9wZXJ0eTt2YXIgTmw9KFgsU2UseWUpPT5TZSBpbiBYP0xsKFgsU2Use2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOnllfSk6WFtTZV09eWU7dmFyIGJ0PShYLFNlLHllKT0+KE5sKFgsdHlwZW9mIFNlIT0ic3ltYm9sIj9TZSsiIjpTZSx5ZSkseWUpLGpzPShYLFNlLHllKT0+e2lmKCFTZS5oYXMoWCkpdGhyb3cgVHlwZUVycm9yKCJDYW5ub3QgIit5ZSl9O3ZhciBZPShYLFNlLHllKT0+KGpzKFgsU2UsInJlYWQgZnJvbSBwcml2YXRlIGZpZWxkIikseWU/eWUuY2FsbChYKTpTZS5nZXQoWCkpLG50PShYLFNlLHllKT0+e2lmKFNlLmhhcyhYKSl0aHJvdyBUeXBlRXJyb3IoIkNhbm5vdCBhZGQgdGhlIHNhbWUgcHJpdmF0ZSBtZW1iZXIgbW9yZSB0aGFuIG9uY2UiKTtTZSBpbnN0YW5jZW9mIFdlYWtTZXQ/U2UuYWRkKFgpOlNlLnNldChYLHllKX0sbHQ9KFgsU2UseWUseGUpPT4oanMoWCxTZSwid3JpdGUgdG8gcHJpdmF0ZSBmaWVsZCIpLHhlP3hlLmNhbGwoWCx5ZSk6U2Uuc2V0KFgseWUpLHllKSx5aT0oWCxTZSx5ZSx4ZSk9Pih7c2V0IF8oQmUpe2x0KFgsU2UsQmUseWUpfSxnZXQgXygpe3JldHVybiBZKFgsU2UseGUpfX0pLHpyPShYLFNlLHllKT0+KGpzKFgsU2UsImFjY2VzcyBwcml2YXRlIG1ldGhvZCIpLHllKTsoZnVuY3Rpb24oKXt2YXIgWGUsQWksRnQsUmksTXQsVHQsSmUsY3MsQXQsVmksV2ksZ3QsemksdXMsR3I7InVzZSBzdHJpY3QiO2NsYXNzIFh7c3RhdGljIFdpdGhpbkVwc2lsb24oZSx0LGk9MTQwMTI5OGUtNTEpe3JldHVybiBNYXRoLmFicyhlLXQpPD1pfXN0YXRpYyBUb0hleChlKXtjb25zdCB0PWUudG9TdHJpbmcoMTYpO3JldHVybiBlPD0xNT8oIjAiK3QpLnRvVXBwZXJDYXNlKCk6dC50b1VwcGVyQ2FzZSgpfXN0YXRpYyBTaWduKGUpe3JldHVybiBlPStlLGU9PT0wfHxpc05hTihlKT9lOmU+MD8xOi0xfXN0YXRpYyBDbGFtcChlLHQ9MCxpPTEpe3JldHVybiBNYXRoLm1pbihpLE1hdGgubWF4KHQsZSkpfXN0YXRpYyBMb2cyKGUpe3JldHVybiBNYXRoLmxvZyhlKSpNYXRoLkxPRzJFfXN0YXRpYyBJTG9nMihlKXtpZihNYXRoLmxvZzIpcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5sb2cyKGUpKTtpZihlPDApcmV0dXJuIE5hTjtpZihlPT09MClyZXR1cm4tMS8wO2xldCB0PTA7aWYoZTwxKXtmb3IoO2U8MTspdCsrLGU9ZSoyO3Q9LXR9ZWxzZSBpZihlPjEpZm9yKDtlPjE7KXQrKyxlPU1hdGguZmxvb3IoZS8yKTtyZXR1cm4gdH1zdGF0aWMgUmVwZWF0KGUsdCl7cmV0dXJuIGUtTWF0aC5mbG9vcihlL3QpKnR9c3RhdGljIE5vcm1hbGl6ZShlLHQsaSl7cmV0dXJuKGUtdCkvKGktdCl9c3RhdGljIERlbm9ybWFsaXplKGUsdCxpKXtyZXR1cm4gZSooaS10KSt0fXN0YXRpYyBEZWx0YUFuZ2xlKGUsdCl7bGV0IGk9WC5SZXBlYXQodC1lLDM2MCk7cmV0dXJuIGk+MTgwJiYoaS09MzYwKSxpfXN0YXRpYyBQaW5nUG9uZyhlLHQpe2NvbnN0IGk9WC5SZXBlYXQoZSx0KjIpO3JldHVybiB0LU1hdGguYWJzKGktdCl9c3RhdGljIFNtb290aFN0ZXAoZSx0LGkpe2xldCBzPVguQ2xhbXAoaSk7cmV0dXJuIHM9LTIqcypzKnMrMypzKnMsdCpzK2UqKDEtcyl9c3RhdGljIE1vdmVUb3dhcmRzKGUsdCxpKXtsZXQgcz0wO3JldHVybiBNYXRoLmFicyh0LWUpPD1pP3M9dDpzPWUrWC5TaWduKHQtZSkqaSxzfXN0YXRpYyBNb3ZlVG93YXJkc0FuZ2xlKGUsdCxpKXtjb25zdCBzPVguRGVsdGFBbmdsZShlLHQpO2xldCByPTA7cmV0dXJuLWk8cyYmczxpP3I9dDoodD1lK3Mscj1YLk1vdmVUb3dhcmRzKGUsdCxpKSkscn1zdGF0aWMgTGVycChlLHQsaSl7cmV0dXJuIGUrKHQtZSkqaX1zdGF0aWMgTGVycEFuZ2xlKGUsdCxpKXtsZXQgcz1YLlJlcGVhdCh0LWUsMzYwKTtyZXR1cm4gcz4xODAmJihzLT0zNjApLGUrcypYLkNsYW1wKGkpfXN0YXRpYyBJbnZlcnNlTGVycChlLHQsaSl7bGV0IHM9MDtyZXR1cm4gZSE9dD9zPVguQ2xhbXAoKGktZSkvKHQtZSkpOnM9MCxzfXN0YXRpYyBIZXJtaXRlKGUsdCxpLHMscil7Y29uc3Qgbj1yKnIsYT1yKm4sbz0yKmEtMypuKzEsaD0tMiphKzMqbixsPWEtMipuK3IsdT1hLW47cmV0dXJuIGUqbytpKmgrdCpsK3MqdX1zdGF0aWMgSGVybWl0ZTFzdERlcml2YXRpdmUoZSx0LGkscyxyKXtjb25zdCBuPXIqcjtyZXR1cm4obi1yKSo2KmUrKDMqbi00KnIrMSkqdCsoLW4rcikqNippKygzKm4tMipyKSpzfXN0YXRpYyBSYW5kb21SYW5nZShlLHQpe3JldHVybiBlPT09dD9lOk1hdGgucmFuZG9tKCkqKHQtZSkrZX1zdGF0aWMgUmFuZ2VUb1BlcmNlbnQoZSx0LGkpe3JldHVybihlLXQpLyhpLXQpfXN0YXRpYyBQZXJjZW50VG9SYW5nZShlLHQsaSl7cmV0dXJuKGktdCkqZSt0fXN0YXRpYyBOb3JtYWxpemVSYWRpYW5zKGUpe3JldHVybiBlLT1YLlR3b1BpKk1hdGguZmxvb3IoKGUrTWF0aC5QSSkvWC5Ud29QaSksZX1zdGF0aWMgSENGKGUsdCl7Y29uc3QgaT1lJXQ7cmV0dXJuIGk9PT0wP3Q6WC5IQ0YodCxpKX19WC5Ud29QaT1NYXRoLlBJKjI7Y29uc3QgU2U9MS8yLjIseWU9Mi4yLHhlPS4wMDE7Y2xhc3MgQmV7c3RhdGljIEJ1aWxkQXJyYXkoZSx0KXtjb25zdCBpPVtdO2ZvcihsZXQgcz0wO3M8ZTsrK3MpaS5wdXNoKHQoKSk7cmV0dXJuIGl9c3RhdGljIEJ1aWxkVHVwbGUoZSx0KXtyZXR1cm4gQmUuQnVpbGRBcnJheShlLHQpfX1mdW5jdGlvbiBYcihjLGUsdCl7Y29uc3QgaT1jW2VdO2lmKHR5cGVvZiBpIT0iZnVuY3Rpb24iKXJldHVybiBudWxsO2NvbnN0IHM9ZnVuY3Rpb24oKXtjb25zdCByPWMubGVuZ3RoLG49cy5wcmV2aW91cy5hcHBseShjLGFyZ3VtZW50cyk7cmV0dXJuIHQoZSxyKSxufTtyZXR1cm4gaS5uZXh0PXMscy5wcmV2aW91cz1pLGNbZV09cywoKT0+e2NvbnN0IHI9cy5wcmV2aW91cztpZighcilyZXR1cm47Y29uc3Qgbj1zLm5leHQ7bj8oci5uZXh0PW4sbi5wcmV2aW91cz1yKTooci5uZXh0PXZvaWQgMCxjW2VdPXIpLHMubmV4dD12b2lkIDAscy5wcmV2aW91cz12b2lkIDB9fWNvbnN0IEhyPVsicHVzaCIsInNwbGljZSIsInBvcCIsInNoaWZ0IiwidW5zaGlmdCJdO2Z1bmN0aW9uICRzKGMsZSl7Y29uc3QgdD1Ici5tYXAoaT0+WHIoYyxpLGUpKTtyZXR1cm4oKT0+e3QuZm9yRWFjaChpPT57aT09bnVsbHx8aSgpfSl9fWNvbnN0IFFzPXt9O2Z1bmN0aW9uIGl0KGMsZSl7UXNbY109ZX1mdW5jdGlvbiByaShjKXtyZXR1cm4gUXNbY119Y2xhc3MgVWV7c3RhdGljIFNldE1hdHJpeFByZWNpc2lvbihlKXtpZihVZS5NYXRyaXhUcmFja1ByZWNpc2lvbkNoYW5nZT0hMSxlJiYhVWUuTWF0cml4VXNlNjRCaXRzJiZVZS5NYXRyaXhUcmFja2VkTWF0cmljZXMpZm9yKGxldCB0PTA7dDxVZS5NYXRyaXhUcmFja2VkTWF0cmljZXMubGVuZ3RoOysrdCl7Y29uc3QgaT1VZS5NYXRyaXhUcmFja2VkTWF0cmljZXNbdF0scz1pLl9tO2kuX209bmV3IEFycmF5KDE2KTtmb3IobGV0IHI9MDtyPDE2OysrcilpLl9tW3JdPXNbcl19VWUuTWF0cml4VXNlNjRCaXRzPWUsVWUuTWF0cml4Q3VycmVudFR5cGU9VWUuTWF0cml4VXNlNjRCaXRzP0FycmF5OkZsb2F0MzJBcnJheSxVZS5NYXRyaXhUcmFja2VkTWF0cmljZXM9bnVsbH19VWUuTWF0cml4VXNlNjRCaXRzPSExLFVlLk1hdHJpeFRyYWNrUHJlY2lzaW9uQ2hhbmdlPSEwLFVlLk1hdHJpeEN1cnJlbnRUeXBlPUZsb2F0MzJBcnJheSxVZS5NYXRyaXhUcmFja2VkTWF0cmljZXM9W107Y2xhc3MgZmV7c3RhdGljIGdldCBMYXN0Q3JlYXRlZEVuZ2luZSgpe3JldHVybiB0aGlzLkluc3RhbmNlcy5sZW5ndGg9PT0wP251bGw6dGhpcy5JbnN0YW5jZXNbdGhpcy5JbnN0YW5jZXMubGVuZ3RoLTFdfXN0YXRpYyBnZXQgTGFzdENyZWF0ZWRTY2VuZSgpe3JldHVybiB0aGlzLl9MYXN0Q3JlYXRlZFNjZW5lfX1mZS5JbnN0YW5jZXM9bmV3IEFycmF5LGZlLl9MYXN0Q3JlYXRlZFNjZW5lPW51bGwsZmUuVXNlRmFsbGJhY2tUZXh0dXJlPSEwLGZlLkZhbGxiYWNrVGV4dHVyZT0iIjtjb25zdCBzdD1jPT5wYXJzZUludChjLnRvU3RyaW5nKCkucmVwbGFjZSgvXFcvZywiIikpO2NsYXNzIHZle2NvbnN0cnVjdG9yKGU9MCx0PTApe3RoaXMueD1lLHRoaXMueT10fXRvU3RyaW5nKCl7cmV0dXJuYHtYOiAke3RoaXMueH0gWTogJHt0aGlzLnl9fWB9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIlZlY3RvcjIifWdldEhhc2hDb2RlKCl7Y29uc3QgZT1zdCh0aGlzLngpLHQ9c3QodGhpcy55KTtsZXQgaT1lO3JldHVybiBpPWkqMzk3XnQsaX10b0FycmF5KGUsdD0wKXtyZXR1cm4gZVt0XT10aGlzLngsZVt0KzFdPXRoaXMueSx0aGlzfWZyb21BcnJheShlLHQ9MCl7cmV0dXJuIHZlLkZyb21BcnJheVRvUmVmKGUsdCx0aGlzKSx0aGlzfWFzQXJyYXkoKXtjb25zdCBlPW5ldyBBcnJheTtyZXR1cm4gdGhpcy50b0FycmF5KGUsMCksZX1jb3B5RnJvbShlKXtyZXR1cm4gdGhpcy54PWUueCx0aGlzLnk9ZS55LHRoaXN9Y29weUZyb21GbG9hdHMoZSx0KXtyZXR1cm4gdGhpcy54PWUsdGhpcy55PXQsdGhpc31zZXQoZSx0KXtyZXR1cm4gdGhpcy5jb3B5RnJvbUZsb2F0cyhlLHQpfWFkZChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54K2UueCx0aGlzLnkrZS55KX1hZGRUb1JlZihlLHQpe3JldHVybiB0Lng9dGhpcy54K2UueCx0Lnk9dGhpcy55K2UueSx0fWFkZEluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCs9ZS54LHRoaXMueSs9ZS55LHRoaXN9YWRkVmVjdG9yMyhlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54K2UueCx0aGlzLnkrZS55KX1zdWJ0cmFjdChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54LWUueCx0aGlzLnktZS55KX1zdWJ0cmFjdFRvUmVmKGUsdCl7cmV0dXJuIHQueD10aGlzLngtZS54LHQueT10aGlzLnktZS55LHR9c3VidHJhY3RJblBsYWNlKGUpe3JldHVybiB0aGlzLngtPWUueCx0aGlzLnktPWUueSx0aGlzfW11bHRpcGx5SW5QbGFjZShlKXtyZXR1cm4gdGhpcy54Kj1lLngsdGhpcy55Kj1lLnksdGhpc31tdWx0aXBseShlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54KmUueCx0aGlzLnkqZS55KX1tdWx0aXBseVRvUmVmKGUsdCl7cmV0dXJuIHQueD10aGlzLngqZS54LHQueT10aGlzLnkqZS55LHR9bXVsdGlwbHlCeUZsb2F0cyhlLHQpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngqZSx0aGlzLnkqdCl9ZGl2aWRlKGUpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngvZS54LHRoaXMueS9lLnkpfWRpdmlkZVRvUmVmKGUsdCl7cmV0dXJuIHQueD10aGlzLngvZS54LHQueT10aGlzLnkvZS55LHR9ZGl2aWRlSW5QbGFjZShlKXtyZXR1cm4gdGhpcy5kaXZpZGVUb1JlZihlLHRoaXMpfW5lZ2F0ZSgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigtdGhpcy54LC10aGlzLnkpfW5lZ2F0ZUluUGxhY2UoKXtyZXR1cm4gdGhpcy54Kj0tMSx0aGlzLnkqPS0xLHRoaXN9bmVnYXRlVG9SZWYoZSl7cmV0dXJuIGUuY29weUZyb21GbG9hdHModGhpcy54Ki0xLHRoaXMueSotMSl9c2NhbGVJblBsYWNlKGUpe3JldHVybiB0aGlzLngqPWUsdGhpcy55Kj1lLHRoaXN9c2NhbGUoZSl7Y29uc3QgdD1uZXcgdGhpcy5jb25zdHJ1Y3RvcigwLDApO3JldHVybiB0aGlzLnNjYWxlVG9SZWYoZSx0KSx0fXNjYWxlVG9SZWYoZSx0KXtyZXR1cm4gdC54PXRoaXMueCplLHQueT10aGlzLnkqZSx0fXNjYWxlQW5kQWRkVG9SZWYoZSx0KXtyZXR1cm4gdC54Kz10aGlzLngqZSx0LnkrPXRoaXMueSplLHR9ZXF1YWxzKGUpe3JldHVybiBlJiZ0aGlzLng9PT1lLngmJnRoaXMueT09PWUueX1lcXVhbHNXaXRoRXBzaWxvbihlLHQ9eGUpe3JldHVybiBlJiZYLldpdGhpbkVwc2lsb24odGhpcy54LGUueCx0KSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMueSxlLnksdCl9Zmxvb3IoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoTWF0aC5mbG9vcih0aGlzLngpLE1hdGguZmxvb3IodGhpcy55KSl9ZnJhY3QoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54LU1hdGguZmxvb3IodGhpcy54KSx0aGlzLnktTWF0aC5mbG9vcih0aGlzLnkpKX1yb3RhdGVUb1JlZihlLHQpe2NvbnN0IGk9TWF0aC5jb3MoZSkscz1NYXRoLnNpbihlKTtyZXR1cm4gdC54PWkqdGhpcy54LXMqdGhpcy55LHQueT1zKnRoaXMueCtpKnRoaXMueSx0fWxlbmd0aCgpe3JldHVybiBNYXRoLnNxcnQodGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55KX1sZW5ndGhTcXVhcmVkKCl7cmV0dXJuIHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueX1ub3JtYWxpemUoKXtyZXR1cm4gdmUuTm9ybWFsaXplVG9SZWYodGhpcyx0aGlzKSx0aGlzfWNsb25lKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueCx0aGlzLnkpfXN0YXRpYyBaZXJvKCl7cmV0dXJuIG5ldyB2ZSgwLDApfXN0YXRpYyBPbmUoKXtyZXR1cm4gbmV3IHZlKDEsMSl9c3RhdGljIGdldCBaZXJvUmVhZE9ubHkoKXtyZXR1cm4gdmUuX1plcm9SZWFkT25seX1zdGF0aWMgRnJvbUFycmF5KGUsdD0wKXtyZXR1cm4gbmV3IHZlKGVbdF0sZVt0KzFdKX1zdGF0aWMgRnJvbUFycmF5VG9SZWYoZSx0LGkpe3JldHVybiBpLng9ZVt0XSxpLnk9ZVt0KzFdLGl9c3RhdGljIENhdG11bGxSb20oZSx0LGkscyxyKXtjb25zdCBuPXIqcixhPXIqbixvPS41KigyKnQueCsoLWUueCtpLngpKnIrKDIqZS54LTUqdC54KzQqaS54LXMueCkqbisoLWUueCszKnQueC0zKmkueCtzLngpKmEpLGg9LjUqKDIqdC55KygtZS55K2kueSkqcisoMiplLnktNSp0LnkrNCppLnktcy55KSpuKygtZS55KzMqdC55LTMqaS55K3MueSkqYSk7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKG8saCl9c3RhdGljIENsYW1wKGUsdCxpKXtsZXQgcz1lLng7cz1zPmkueD9pLng6cyxzPXM8dC54P3QueDpzO2xldCByPWUueTtyZXR1cm4gcj1yPmkueT9pLnk6cixyPXI8dC55P3QueTpyLG5ldyBlLmNvbnN0cnVjdG9yKHMscil9c3RhdGljIEhlcm1pdGUoZSx0LGkscyxyKXtjb25zdCBuPXIqcixhPXIqbixvPTIqYS0zKm4rMSxoPS0yKmErMypuLGw9YS0yKm4rcix1PWEtbixkPWUueCpvK2kueCpoK3QueCpsK3MueCp1LGY9ZS55Km8raS55KmgrdC55Kmwrcy55KnU7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKGQsZil9c3RhdGljIEhlcm1pdGUxc3REZXJpdmF0aXZlKGUsdCxpLHMscil7Y29uc3Qgbj1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gdGhpcy5IZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKSxufXN0YXRpYyBIZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKXtjb25zdCBhPXIqcjtyZXR1cm4gbi54PShhLXIpKjYqZS54KygzKmEtNCpyKzEpKnQueCsoLWErcikqNippLngrKDMqYS0yKnIpKnMueCxuLnk9KGEtcikqNiplLnkrKDMqYS00KnIrMSkqdC55KygtYStyKSo2KmkueSsoMyphLTIqcikqcy55LG59c3RhdGljIExlcnAoZSx0LGkpe2NvbnN0IHM9ZS54Kyh0LngtZS54KSppLHI9ZS55Kyh0LnktZS55KSppO3JldHVybiBuZXcgZS5jb25zdHJ1Y3RvcihzLHIpfXN0YXRpYyBEb3QoZSx0KXtyZXR1cm4gZS54KnQueCtlLnkqdC55fXN0YXRpYyBOb3JtYWxpemUoZSl7Y29uc3QgdD1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gdGhpcy5Ob3JtYWxpemVUb1JlZihlLHQpLHR9c3RhdGljIE5vcm1hbGl6ZVRvUmVmKGUsdCl7Y29uc3QgaT1lLmxlbmd0aCgpO3JldHVybiBpPT09MHx8KHQueD1lLngvaSx0Lnk9ZS55L2kpLHR9c3RhdGljIE1pbmltaXplKGUsdCl7Y29uc3QgaT1lLng8dC54P2UueDp0Lngscz1lLnk8dC55P2UueTp0Lnk7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKGkscyl9c3RhdGljIE1heGltaXplKGUsdCl7Y29uc3QgaT1lLng+dC54P2UueDp0Lngscz1lLnk+dC55P2UueTp0Lnk7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKGkscyl9c3RhdGljIFRyYW5zZm9ybShlLHQpe2NvbnN0IGk9bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIHZlLlRyYW5zZm9ybVRvUmVmKGUsdCxpKSxpfXN0YXRpYyBUcmFuc2Zvcm1Ub1JlZihlLHQsaSl7Y29uc3Qgcz10Lm0scj1lLngqc1swXStlLnkqc1s0XStzWzEyXSxuPWUueCpzWzFdK2UueSpzWzVdK3NbMTNdO3JldHVybiBpLng9cixpLnk9bixpfXN0YXRpYyBQb2ludEluVHJpYW5nbGUoZSx0LGkscyl7Y29uc3Qgcj0uNSooLWkueSpzLngrdC55KigtaS54K3MueCkrdC54KihpLnktcy55KStpLngqcy55KSxuPXI8MD8tMToxLGE9KHQueSpzLngtdC54KnMueSsocy55LXQueSkqZS54Kyh0Lngtcy54KSplLnkpKm4sbz0odC54KmkueS10LnkqaS54Kyh0LnktaS55KSplLngrKGkueC10LngpKmUueSkqbjtyZXR1cm4gYT4wJiZvPjAmJmErbzwyKnIqbn1zdGF0aWMgRGlzdGFuY2UoZSx0KXtyZXR1cm4gTWF0aC5zcXJ0KHZlLkRpc3RhbmNlU3F1YXJlZChlLHQpKX1zdGF0aWMgRGlzdGFuY2VTcXVhcmVkKGUsdCl7Y29uc3QgaT1lLngtdC54LHM9ZS55LXQueTtyZXR1cm4gaSppK3Mqc31zdGF0aWMgQ2VudGVyKGUsdCl7Y29uc3QgaT1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gdmUuQ2VudGVyVG9SZWYoZSx0LGkpfXN0YXRpYyBDZW50ZXJUb1JlZihlLHQsaSl7cmV0dXJuIGkuY29weUZyb21GbG9hdHMoKGUueCt0LngpLzIsKGUueSt0LnkpLzIpfXN0YXRpYyBEaXN0YW5jZU9mUG9pbnRGcm9tU2VnbWVudChlLHQsaSl7Y29uc3Qgcz12ZS5EaXN0YW5jZVNxdWFyZWQodCxpKTtpZihzPT09MClyZXR1cm4gdmUuRGlzdGFuY2UoZSx0KTtjb25zdCByPWkuc3VidHJhY3QodCksbj1NYXRoLm1heCgwLE1hdGgubWluKDEsdmUuRG90KGUuc3VidHJhY3QodCkscikvcykpLGE9dC5hZGQoci5tdWx0aXBseUJ5RmxvYXRzKG4sbikpO3JldHVybiB2ZS5EaXN0YW5jZShlLGEpfX12ZS5fWmVyb1JlYWRPbmx5PXZlLlplcm8oKTtjbGFzcyBwe2NvbnN0cnVjdG9yKGU9MCx0PTAsaT0wKXt0aGlzLl9pc0RpcnR5PSEwLHRoaXMuX3g9ZSx0aGlzLl95PXQsdGhpcy5fej1pfWdldCB4KCl7cmV0dXJuIHRoaXMuX3h9c2V0IHgoZSl7dGhpcy5feD1lLHRoaXMuX2lzRGlydHk9ITB9Z2V0IHkoKXtyZXR1cm4gdGhpcy5feX1zZXQgeShlKXt0aGlzLl95PWUsdGhpcy5faXNEaXJ0eT0hMH1nZXQgeigpe3JldHVybiB0aGlzLl96fXNldCB6KGUpe3RoaXMuX3o9ZSx0aGlzLl9pc0RpcnR5PSEwfXRvU3RyaW5nKCl7cmV0dXJuYHtYOiAke3RoaXMuX3h9IFk6ICR7dGhpcy5feX0gWjogJHt0aGlzLl96fX1gfWdldENsYXNzTmFtZSgpe3JldHVybiJWZWN0b3IzIn1nZXRIYXNoQ29kZSgpe2NvbnN0IGU9c3QodGhpcy5feCksdD1zdCh0aGlzLl95KSxpPXN0KHRoaXMuX3opO2xldCBzPWU7cmV0dXJuIHM9cyozOTdedCxzPXMqMzk3Xmksc31hc0FycmF5KCl7Y29uc3QgZT1bXTtyZXR1cm4gdGhpcy50b0FycmF5KGUsMCksZX10b0FycmF5KGUsdD0wKXtyZXR1cm4gZVt0XT10aGlzLl94LGVbdCsxXT10aGlzLl95LGVbdCsyXT10aGlzLl96LHRoaXN9ZnJvbUFycmF5KGUsdD0wKXtyZXR1cm4gcC5Gcm9tQXJyYXlUb1JlZihlLHQsdGhpcyksdGhpc310b1F1YXRlcm5pb24oKXtyZXR1cm4gWi5Sb3RhdGlvbllhd1BpdGNoUm9sbCh0aGlzLl95LHRoaXMuX3gsdGhpcy5feil9YWRkSW5QbGFjZShlKXtyZXR1cm4gdGhpcy5hZGRJblBsYWNlRnJvbUZsb2F0cyhlLl94LGUuX3ksZS5feil9YWRkSW5QbGFjZUZyb21GbG9hdHMoZSx0LGkpe3JldHVybiB0aGlzLngrPWUsdGhpcy55Kz10LHRoaXMueis9aSx0aGlzfWFkZChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feCtlLl94LHRoaXMuX3krZS5feSx0aGlzLl96K2UuX3opfWFkZFRvUmVmKGUsdCl7cmV0dXJuIHQuY29weUZyb21GbG9hdHModGhpcy5feCtlLl94LHRoaXMuX3krZS5feSx0aGlzLl96K2UuX3opfXN1YnRyYWN0SW5QbGFjZShlKXtyZXR1cm4gdGhpcy54LT1lLl94LHRoaXMueS09ZS5feSx0aGlzLnotPWUuX3osdGhpc31zdWJ0cmFjdChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feC1lLl94LHRoaXMuX3ktZS5feSx0aGlzLl96LWUuX3opfXN1YnRyYWN0VG9SZWYoZSx0KXtyZXR1cm4gdGhpcy5zdWJ0cmFjdEZyb21GbG9hdHNUb1JlZihlLl94LGUuX3ksZS5feix0KX1zdWJ0cmFjdEZyb21GbG9hdHMoZSx0LGkpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLl94LWUsdGhpcy5feS10LHRoaXMuX3otaSl9c3VidHJhY3RGcm9tRmxvYXRzVG9SZWYoZSx0LGkscyl7cmV0dXJuIHMuY29weUZyb21GbG9hdHModGhpcy5feC1lLHRoaXMuX3ktdCx0aGlzLl96LWkpfW5lZ2F0ZSgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigtdGhpcy5feCwtdGhpcy5feSwtdGhpcy5feil9bmVnYXRlSW5QbGFjZSgpe3JldHVybiB0aGlzLngqPS0xLHRoaXMueSo9LTEsdGhpcy56Kj0tMSx0aGlzfW5lZ2F0ZVRvUmVmKGUpe3JldHVybiBlLmNvcHlGcm9tRmxvYXRzKHRoaXMuX3gqLTEsdGhpcy5feSotMSx0aGlzLl96Ki0xKX1zY2FsZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCo9ZSx0aGlzLnkqPWUsdGhpcy56Kj1lLHRoaXN9c2NhbGUoZSl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuX3gqZSx0aGlzLl95KmUsdGhpcy5feiplKX1zY2FsZVRvUmVmKGUsdCl7cmV0dXJuIHQuY29weUZyb21GbG9hdHModGhpcy5feCplLHRoaXMuX3kqZSx0aGlzLl96KmUpfWdldE5vcm1hbFRvUmVmKGUpe2NvbnN0IHQ9dGhpcy5sZW5ndGgoKTtsZXQgaT1NYXRoLmFjb3ModGhpcy55L3QpO2NvbnN0IHM9TWF0aC5hdGFuMih0aGlzLnosdGhpcy54KTtpPk1hdGguUEkvMj9pLT1NYXRoLlBJLzI6aSs9TWF0aC5QSS8yO2NvbnN0IHI9dCpNYXRoLnNpbihpKSpNYXRoLmNvcyhzKSxuPXQqTWF0aC5jb3MoaSksYT10Kk1hdGguc2luKGkpKk1hdGguc2luKHMpO3JldHVybiBlLnNldChyLG4sYSksZX1hcHBseVJvdGF0aW9uUXVhdGVybmlvblRvUmVmKGUsdCl7Y29uc3QgaT1lLncqdGhpcy54K2UueSp0aGlzLnotZS56KnRoaXMueSxzPWUudyp0aGlzLnkrZS56KnRoaXMueC1lLngqdGhpcy56LHI9ZS53KnRoaXMueitlLngqdGhpcy55LWUueSp0aGlzLngsbj0tZS54KnRoaXMueC1lLnkqdGhpcy55LWUueip0aGlzLno7cmV0dXJuIHQueD1pKmUudytuKi1lLngrcyotZS56LXIqLWUueSx0Lnk9cyplLncrbiotZS55K3IqLWUueC1pKi1lLnosdC56PXIqZS53K24qLWUueitpKi1lLnktcyotZS54LHR9YXBwbHlSb3RhdGlvblF1YXRlcm5pb25JblBsYWNlKGUpe3JldHVybiB0aGlzLmFwcGx5Um90YXRpb25RdWF0ZXJuaW9uVG9SZWYoZSx0aGlzKX1hcHBseVJvdGF0aW9uUXVhdGVybmlvbihlKXtyZXR1cm4gdGhpcy5hcHBseVJvdGF0aW9uUXVhdGVybmlvblRvUmVmKGUsbmV3IHRoaXMuY29uc3RydWN0b3IpfXNjYWxlQW5kQWRkVG9SZWYoZSx0KXtyZXR1cm4gdC5hZGRJblBsYWNlRnJvbUZsb2F0cyh0aGlzLl94KmUsdGhpcy5feSplLHRoaXMuX3oqZSl9cHJvamVjdE9uUGxhbmUoZSx0KXtjb25zdCBpPW5ldyB0aGlzLmNvbnN0cnVjdG9yO3JldHVybiB0aGlzLnByb2plY3RPblBsYW5lVG9SZWYoZSx0LGkpLGl9cHJvamVjdE9uUGxhbmVUb1JlZihlLHQsaSl7Y29uc3Qgcz1lLm5vcm1hbCxyPWUuZCxuPUsuVmVjdG9yM1swXTt0aGlzLnN1YnRyYWN0VG9SZWYodCxuKSxuLm5vcm1hbGl6ZSgpO2NvbnN0IGE9cC5Eb3QobixzKTtpZihNYXRoLmFicyhhKTxNYXRoLnBvdygxMCwtMTApKWkuc2V0QWxsKDEvMCk7ZWxzZXtjb25zdCBvPS0ocC5Eb3QodCxzKStyKS9hLGg9bi5zY2FsZUluUGxhY2Uobyk7dC5hZGRUb1JlZihoLGkpfXJldHVybiBpfWVxdWFscyhlKXtyZXR1cm4gZSYmdGhpcy5feD09PWUuX3gmJnRoaXMuX3k9PT1lLl95JiZ0aGlzLl96PT09ZS5fen1lcXVhbHNXaXRoRXBzaWxvbihlLHQ9eGUpe3JldHVybiBlJiZYLldpdGhpbkVwc2lsb24odGhpcy5feCxlLl94LHQpJiZYLldpdGhpbkVwc2lsb24odGhpcy5feSxlLl95LHQpJiZYLldpdGhpbkVwc2lsb24odGhpcy5feixlLl96LHQpfWVxdWFsc1RvRmxvYXRzKGUsdCxpKXtyZXR1cm4gdGhpcy5feD09PWUmJnRoaXMuX3k9PT10JiZ0aGlzLl96PT09aX1tdWx0aXBseUluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCo9ZS5feCx0aGlzLnkqPWUuX3ksdGhpcy56Kj1lLl96LHRoaXN9bXVsdGlwbHkoZSl7cmV0dXJuIHRoaXMubXVsdGlwbHlCeUZsb2F0cyhlLl94LGUuX3ksZS5feil9bXVsdGlwbHlUb1JlZihlLHQpe3JldHVybiB0LmNvcHlGcm9tRmxvYXRzKHRoaXMuX3gqZS5feCx0aGlzLl95KmUuX3ksdGhpcy5feiplLl96KX1tdWx0aXBseUJ5RmxvYXRzKGUsdCxpKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feCplLHRoaXMuX3kqdCx0aGlzLl96KmkpfWRpdmlkZShlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feC9lLl94LHRoaXMuX3kvZS5feSx0aGlzLl96L2UuX3opfWRpdmlkZVRvUmVmKGUsdCl7cmV0dXJuIHQuY29weUZyb21GbG9hdHModGhpcy5feC9lLl94LHRoaXMuX3kvZS5feSx0aGlzLl96L2UuX3opfWRpdmlkZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMuZGl2aWRlVG9SZWYoZSx0aGlzKX1taW5pbWl6ZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMubWluaW1pemVJblBsYWNlRnJvbUZsb2F0cyhlLl94LGUuX3ksZS5feil9bWF4aW1pemVJblBsYWNlKGUpe3JldHVybiB0aGlzLm1heGltaXplSW5QbGFjZUZyb21GbG9hdHMoZS5feCxlLl95LGUuX3opfW1pbmltaXplSW5QbGFjZUZyb21GbG9hdHMoZSx0LGkpe3JldHVybiBlPHRoaXMuX3gmJih0aGlzLng9ZSksdDx0aGlzLl95JiYodGhpcy55PXQpLGk8dGhpcy5feiYmKHRoaXMuej1pKSx0aGlzfW1heGltaXplSW5QbGFjZUZyb21GbG9hdHMoZSx0LGkpe3JldHVybiBlPnRoaXMuX3gmJih0aGlzLng9ZSksdD50aGlzLl95JiYodGhpcy55PXQpLGk+dGhpcy5feiYmKHRoaXMuej1pKSx0aGlzfWlzTm9uVW5pZm9ybVdpdGhpbkVwc2lsb24oZSl7Y29uc3QgdD1NYXRoLmFicyh0aGlzLl94KSxpPU1hdGguYWJzKHRoaXMuX3kpO2lmKCFYLldpdGhpbkVwc2lsb24odCxpLGUpKXJldHVybiEwO2NvbnN0IHM9TWF0aC5hYnModGhpcy5feik7cmV0dXJuIVguV2l0aGluRXBzaWxvbih0LHMsZSl8fCFYLldpdGhpbkVwc2lsb24oaSxzLGUpfWdldCBpc05vblVuaWZvcm0oKXtjb25zdCBlPU1hdGguYWJzKHRoaXMuX3gpLHQ9TWF0aC5hYnModGhpcy5feSk7aWYoZSE9PXQpcmV0dXJuITA7Y29uc3QgaT1NYXRoLmFicyh0aGlzLl96KTtyZXR1cm4gZSE9PWl9Zmxvb3IoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoTWF0aC5mbG9vcih0aGlzLl94KSxNYXRoLmZsb29yKHRoaXMuX3kpLE1hdGguZmxvb3IodGhpcy5feikpfWZyYWN0KCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuX3gtTWF0aC5mbG9vcih0aGlzLl94KSx0aGlzLl95LU1hdGguZmxvb3IodGhpcy5feSksdGhpcy5fei1NYXRoLmZsb29yKHRoaXMuX3opKX1sZW5ndGgoKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMuX3gqdGhpcy5feCt0aGlzLl95KnRoaXMuX3krdGhpcy5feip0aGlzLl96KX1sZW5ndGhTcXVhcmVkKCl7cmV0dXJuIHRoaXMuX3gqdGhpcy5feCt0aGlzLl95KnRoaXMuX3krdGhpcy5feip0aGlzLl96fWdldCBoYXNBWmVyb0NvbXBvbmVudCgpe3JldHVybiB0aGlzLl94KnRoaXMuX3kqdGhpcy5fej09PTB9bm9ybWFsaXplKCl7cmV0dXJuIHRoaXMubm9ybWFsaXplRnJvbUxlbmd0aCh0aGlzLmxlbmd0aCgpKX1yZW9yZGVySW5QbGFjZShlKXtyZXR1cm4gZT1lLnRvTG93ZXJDYXNlKCksZT09PSJ4eXoiP3RoaXM6KEsuVmVjdG9yM1swXS5jb3B5RnJvbSh0aGlzKSxbIngiLCJ5IiwieiJdLmZvckVhY2goKHQsaSk9Pnt0aGlzW3RdPUsuVmVjdG9yM1swXVtlW2ldXX0pLHRoaXMpfXJvdGF0ZUJ5UXVhdGVybmlvblRvUmVmKGUsdCl7cmV0dXJuIGUudG9Sb3RhdGlvbk1hdHJpeChLLk1hdHJpeFswXSkscC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKHRoaXMsSy5NYXRyaXhbMF0sdCksdH1yb3RhdGVCeVF1YXRlcm5pb25Bcm91bmRQb2ludFRvUmVmKGUsdCxpKXtyZXR1cm4gdGhpcy5zdWJ0cmFjdFRvUmVmKHQsSy5WZWN0b3IzWzBdKSxLLlZlY3RvcjNbMF0ucm90YXRlQnlRdWF0ZXJuaW9uVG9SZWYoZSxLLlZlY3RvcjNbMF0pLHQuYWRkVG9SZWYoSy5WZWN0b3IzWzBdLGkpLGl9Y3Jvc3MoZSl7Y29uc3QgdD1uZXcgdGhpcy5jb25zdHJ1Y3RvcjtyZXR1cm4gcC5Dcm9zc1RvUmVmKHRoaXMsZSx0KX1ub3JtYWxpemVGcm9tTGVuZ3RoKGUpe3JldHVybiBlPT09MHx8ZT09PTE/dGhpczp0aGlzLnNjYWxlSW5QbGFjZSgxL2UpfW5vcm1hbGl6ZVRvTmV3KCl7Y29uc3QgZT1uZXcgdGhpcy5jb25zdHJ1Y3RvcigwLDAsMCk7cmV0dXJuIHRoaXMubm9ybWFsaXplVG9SZWYoZSksZX1ub3JtYWxpemVUb1JlZihlKXtjb25zdCB0PXRoaXMubGVuZ3RoKCk7cmV0dXJuIHQ9PT0wfHx0PT09MT9lLmNvcHlGcm9tRmxvYXRzKHRoaXMuX3gsdGhpcy5feSx0aGlzLl96KTp0aGlzLnNjYWxlVG9SZWYoMS90LGUpfWNsb25lKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuX3gsdGhpcy5feSx0aGlzLl96KX1jb3B5RnJvbShlKXtyZXR1cm4gdGhpcy5jb3B5RnJvbUZsb2F0cyhlLl94LGUuX3ksZS5feil9Y29weUZyb21GbG9hdHMoZSx0LGkpe3JldHVybiB0aGlzLng9ZSx0aGlzLnk9dCx0aGlzLno9aSx0aGlzfXNldChlLHQsaSl7cmV0dXJuIHRoaXMuY29weUZyb21GbG9hdHMoZSx0LGkpfXNldEFsbChlKXtyZXR1cm4gdGhpcy54PXRoaXMueT10aGlzLno9ZSx0aGlzfXN0YXRpYyBHZXRDbGlwRmFjdG9yKGUsdCxpLHMpe2NvbnN0IHI9cC5Eb3QoZSxpKS1zLG49cC5Eb3QodCxpKS1zO3JldHVybiByLyhyLW4pfXN0YXRpYyBHZXRBbmdsZUJldHdlZW5WZWN0b3JzKGUsdCxpKXtjb25zdCBzPWUubm9ybWFsaXplVG9SZWYoSy5WZWN0b3IzWzFdKSxyPXQubm9ybWFsaXplVG9SZWYoSy5WZWN0b3IzWzJdKTtsZXQgbj1wLkRvdChzLHIpO249WC5DbGFtcChuLC0xLDEpO2NvbnN0IGE9TWF0aC5hY29zKG4pLG89Sy5WZWN0b3IzWzNdO3JldHVybiBwLkNyb3NzVG9SZWYocyxyLG8pLHAuRG90KG8saSk+MD9pc05hTihhKT8wOmE6aXNOYU4oYSk/LU1hdGguUEk6LU1hdGguYWNvcyhuKX1zdGF0aWMgR2V0QW5nbGVCZXR3ZWVuVmVjdG9yc09uUGxhbmUoZSx0LGkpe0suVmVjdG9yM1swXS5jb3B5RnJvbShlKTtjb25zdCBzPUsuVmVjdG9yM1swXTtLLlZlY3RvcjNbMV0uY29weUZyb20odCk7Y29uc3Qgcj1LLlZlY3RvcjNbMV07Sy5WZWN0b3IzWzJdLmNvcHlGcm9tKGkpO2NvbnN0IG49Sy5WZWN0b3IzWzJdLGE9Sy5WZWN0b3IzWzNdLG89Sy5WZWN0b3IzWzRdO3Mubm9ybWFsaXplKCksci5ub3JtYWxpemUoKSxuLm5vcm1hbGl6ZSgpLHAuQ3Jvc3NUb1JlZihuLHMsYSkscC5Dcm9zc1RvUmVmKGEsbixvKTtjb25zdCBoPU1hdGguYXRhbjIocC5Eb3QocixhKSxwLkRvdChyLG8pKTtyZXR1cm4gWC5Ob3JtYWxpemVSYWRpYW5zKGgpfXN0YXRpYyBQaXRjaFlhd1JvbGxUb01vdmVCZXR3ZWVuUG9pbnRzVG9SZWYoZSx0LGkpe2NvbnN0IHM9RC5WZWN0b3IzWzBdO3JldHVybiB0LnN1YnRyYWN0VG9SZWYoZSxzKSxpLnk9TWF0aC5hdGFuMihzLngscy56KXx8MCxpLng9TWF0aC5hdGFuMihNYXRoLnNxcnQocy54KioyK3MueioqMikscy55KXx8MCxpLno9MCxpfXN0YXRpYyBQaXRjaFlhd1JvbGxUb01vdmVCZXR3ZWVuUG9pbnRzKGUsdCl7Y29uc3QgaT1wLlplcm8oKTtyZXR1cm4gcC5QaXRjaFlhd1JvbGxUb01vdmVCZXR3ZWVuUG9pbnRzVG9SZWYoZSx0LGkpfXN0YXRpYyBTbGVycFRvUmVmKGUsdCxpLHMpe2k9WC5DbGFtcChpLDAsMSk7Y29uc3Qgcj1LLlZlY3RvcjNbMF0sbj1LLlZlY3RvcjNbMV07ci5jb3B5RnJvbShlKTtjb25zdCBhPXIubGVuZ3RoKCk7ci5ub3JtYWxpemVGcm9tTGVuZ3RoKGEpLG4uY29weUZyb20odCk7Y29uc3Qgbz1uLmxlbmd0aCgpO24ubm9ybWFsaXplRnJvbUxlbmd0aChvKTtjb25zdCBoPXAuRG90KHIsbik7bGV0IGwsdTtpZihoPDEteGUpe2NvbnN0IGQ9TWF0aC5hY29zKGgpLGY9MS9NYXRoLnNpbihkKTtsPU1hdGguc2luKCgxLWkpKmQpKmYsdT1NYXRoLnNpbihpKmQpKmZ9ZWxzZSBsPTEtaSx1PWk7cmV0dXJuIHIuc2NhbGVJblBsYWNlKGwpLG4uc2NhbGVJblBsYWNlKHUpLHMuY29weUZyb20ocikuYWRkSW5QbGFjZShuKSxzLnNjYWxlSW5QbGFjZShYLkxlcnAoYSxvLGkpKSxzfXN0YXRpYyBTbW9vdGhUb1JlZihlLHQsaSxzLHIpe3JldHVybiBwLlNsZXJwVG9SZWYoZSx0LHM9PT0wPzE6aS9zLHIpLHJ9c3RhdGljIEZyb21BcnJheShlLHQ9MCl7cmV0dXJuIG5ldyBwKGVbdF0sZVt0KzFdLGVbdCsyXSl9c3RhdGljIEZyb21GbG9hdEFycmF5KGUsdCl7cmV0dXJuIHAuRnJvbUFycmF5KGUsdCl9c3RhdGljIEZyb21BcnJheVRvUmVmKGUsdCxpKXtyZXR1cm4gaS54PWVbdF0saS55PWVbdCsxXSxpLno9ZVt0KzJdLGl9c3RhdGljIEZyb21GbG9hdEFycmF5VG9SZWYoZSx0LGkpe3JldHVybiBwLkZyb21BcnJheVRvUmVmKGUsdCxpKX1zdGF0aWMgRnJvbUZsb2F0c1RvUmVmKGUsdCxpLHMpe3JldHVybiBzLmNvcHlGcm9tRmxvYXRzKGUsdCxpKSxzfXN0YXRpYyBaZXJvKCl7cmV0dXJuIG5ldyBwKDAsMCwwKX1zdGF0aWMgT25lKCl7cmV0dXJuIG5ldyBwKDEsMSwxKX1zdGF0aWMgVXAoKXtyZXR1cm4gbmV3IHAoMCwxLDApfXN0YXRpYyBnZXQgVXBSZWFkT25seSgpe3JldHVybiBwLl9VcFJlYWRPbmx5fXN0YXRpYyBnZXQgRG93blJlYWRPbmx5KCl7cmV0dXJuIHAuX0Rvd25SZWFkT25seX1zdGF0aWMgZ2V0IFJpZ2h0UmVhZE9ubHkoKXtyZXR1cm4gcC5fUmlnaHRSZWFkT25seX1zdGF0aWMgZ2V0IExlZnRSZWFkT25seSgpe3JldHVybiBwLl9MZWZ0UmVhZE9ubHl9c3RhdGljIGdldCBMZWZ0SGFuZGVkRm9yd2FyZFJlYWRPbmx5KCl7cmV0dXJuIHAuX0xlZnRIYW5kZWRGb3J3YXJkUmVhZE9ubHl9c3RhdGljIGdldCBSaWdodEhhbmRlZEZvcndhcmRSZWFkT25seSgpe3JldHVybiBwLl9SaWdodEhhbmRlZEZvcndhcmRSZWFkT25seX1zdGF0aWMgZ2V0IFplcm9SZWFkT25seSgpe3JldHVybiBwLl9aZXJvUmVhZE9ubHl9c3RhdGljIERvd24oKXtyZXR1cm4gbmV3IHAoMCwtMSwwKX1zdGF0aWMgRm9yd2FyZChlPSExKXtyZXR1cm4gbmV3IHAoMCwwLGU/LTE6MSl9c3RhdGljIEJhY2t3YXJkKGU9ITEpe3JldHVybiBuZXcgcCgwLDAsZT8xOi0xKX1zdGF0aWMgUmlnaHQoKXtyZXR1cm4gbmV3IHAoMSwwLDApfXN0YXRpYyBMZWZ0KCl7cmV0dXJuIG5ldyBwKC0xLDAsMCl9c3RhdGljIFRyYW5zZm9ybUNvb3JkaW5hdGVzKGUsdCl7Y29uc3QgaT1wLlplcm8oKTtyZXR1cm4gcC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGUsdCxpKSxpfXN0YXRpYyBUcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGUsdCxpKXtyZXR1cm4gcC5UcmFuc2Zvcm1Db29yZGluYXRlc0Zyb21GbG9hdHNUb1JlZihlLl94LGUuX3ksZS5feix0LGkpLGl9c3RhdGljIFRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGUsdCxpLHMscil7Y29uc3Qgbj1zLm0sYT1lKm5bMF0rdCpuWzRdK2kqbls4XStuWzEyXSxvPWUqblsxXSt0Km5bNV0raSpuWzldK25bMTNdLGg9ZSpuWzJdK3Qqbls2XStpKm5bMTBdK25bMTRdLGw9MS8oZSpuWzNdK3Qqbls3XStpKm5bMTFdK25bMTVdKTtyZXR1cm4gci54PWEqbCxyLnk9bypsLHIuej1oKmwscn1zdGF0aWMgVHJhbnNmb3JtTm9ybWFsKGUsdCl7Y29uc3QgaT1wLlplcm8oKTtyZXR1cm4gcC5UcmFuc2Zvcm1Ob3JtYWxUb1JlZihlLHQsaSksaX1zdGF0aWMgVHJhbnNmb3JtTm9ybWFsVG9SZWYoZSx0LGkpe3JldHVybiB0aGlzLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZihlLl94LGUuX3ksZS5feix0LGkpLGl9c3RhdGljIFRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZihlLHQsaSxzLHIpe2NvbnN0IG49cy5tO3JldHVybiByLng9ZSpuWzBdK3Qqbls0XStpKm5bOF0sci55PWUqblsxXSt0Km5bNV0raSpuWzldLHIuej1lKm5bMl0rdCpuWzZdK2kqblsxMF0scn1zdGF0aWMgQ2F0bXVsbFJvbShlLHQsaSxzLHIpe2NvbnN0IG49cipyLGE9cipuLG89LjUqKDIqdC5feCsoLWUuX3graS5feCkqcisoMiplLl94LTUqdC5feCs0KmkuX3gtcy5feCkqbisoLWUuX3grMyp0Ll94LTMqaS5feCtzLl94KSphKSxoPS41KigyKnQuX3krKC1lLl95K2kuX3kpKnIrKDIqZS5feS01KnQuX3krNCppLl95LXMuX3kpKm4rKC1lLl95KzMqdC5feS0zKmkuX3krcy5feSkqYSksbD0uNSooMip0Ll96KygtZS5feitpLl96KSpyKygyKmUuX3otNSp0Ll96KzQqaS5fei1zLl96KSpuKygtZS5feiszKnQuX3otMyppLl96K3MuX3opKmEpO3JldHVybiBuZXcgZS5jb25zdHJ1Y3RvcihvLGgsbCl9c3RhdGljIENsYW1wKGUsdCxpKXtjb25zdCBzPW5ldyBlLmNvbnN0cnVjdG9yO3JldHVybiBwLkNsYW1wVG9SZWYoZSx0LGkscyksc31zdGF0aWMgQ2xhbXBUb1JlZihlLHQsaSxzKXtsZXQgcj1lLl94O3I9cj5pLl94P2kuX3g6cixyPXI8dC5feD90Ll94OnI7bGV0IG49ZS5feTtuPW4+aS5feT9pLl95Om4sbj1uPHQuX3k/dC5feTpuO2xldCBhPWUuX3o7cmV0dXJuIGE9YT5pLl96P2kuX3o6YSxhPWE8dC5fej90Ll96OmEscy5jb3B5RnJvbUZsb2F0cyhyLG4sYSksc31zdGF0aWMgQ2hlY2tFeHRlbmRzKGUsdCxpKXt0Lm1pbmltaXplSW5QbGFjZShlKSxpLm1heGltaXplSW5QbGFjZShlKX1zdGF0aWMgSGVybWl0ZShlLHQsaSxzLHIpe2NvbnN0IG49cipyLGE9cipuLG89MiphLTMqbisxLGg9LTIqYSszKm4sbD1hLTIqbityLHU9YS1uLGQ9ZS5feCpvK2kuX3gqaCt0Ll94Kmwrcy5feCp1LGY9ZS5feSpvK2kuX3kqaCt0Ll95Kmwrcy5feSp1LF89ZS5feipvK2kuX3oqaCt0Ll96Kmwrcy5feip1O3JldHVybiBuZXcgZS5jb25zdHJ1Y3RvcihkLGYsXyl9c3RhdGljIEhlcm1pdGUxc3REZXJpdmF0aXZlKGUsdCxpLHMscil7Y29uc3Qgbj1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gdGhpcy5IZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKSxufXN0YXRpYyBIZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKXtjb25zdCBhPXIqcjtyZXR1cm4gbi54PShhLXIpKjYqZS54KygzKmEtNCpyKzEpKnQueCsoLWErcikqNippLngrKDMqYS0yKnIpKnMueCxuLnk9KGEtcikqNiplLnkrKDMqYS00KnIrMSkqdC55KygtYStyKSo2KmkueSsoMyphLTIqcikqcy55LG4uej0oYS1yKSo2KmUueisoMyphLTQqcisxKSp0LnorKC1hK3IpKjYqaS56KygzKmEtMipyKSpzLnosbn1zdGF0aWMgTGVycChlLHQsaSl7Y29uc3Qgcz1uZXcgZS5jb25zdHJ1Y3RvcigwLDAsMCk7cmV0dXJuIHAuTGVycFRvUmVmKGUsdCxpLHMpLHN9c3RhdGljIExlcnBUb1JlZihlLHQsaSxzKXtyZXR1cm4gcy54PWUuX3grKHQuX3gtZS5feCkqaSxzLnk9ZS5feSsodC5feS1lLl95KSppLHMuej1lLl96Kyh0Ll96LWUuX3opKmksc31zdGF0aWMgRG90KGUsdCl7cmV0dXJuIGUuX3gqdC5feCtlLl95KnQuX3krZS5feip0Ll96fXN0YXRpYyBDcm9zcyhlLHQpe2NvbnN0IGk9bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIHAuQ3Jvc3NUb1JlZihlLHQsaSksaX1zdGF0aWMgQ3Jvc3NUb1JlZihlLHQsaSl7Y29uc3Qgcz1lLl95KnQuX3otZS5feip0Ll95LHI9ZS5feip0Ll94LWUuX3gqdC5feixuPWUuX3gqdC5feS1lLl95KnQuX3g7cmV0dXJuIGkuY29weUZyb21GbG9hdHMocyxyLG4pLGl9c3RhdGljIE5vcm1hbGl6ZShlKXtjb25zdCB0PXAuWmVybygpO3JldHVybiBwLk5vcm1hbGl6ZVRvUmVmKGUsdCksdH1zdGF0aWMgTm9ybWFsaXplVG9SZWYoZSx0KXtyZXR1cm4gZS5ub3JtYWxpemVUb1JlZih0KSx0fXN0YXRpYyBQcm9qZWN0KGUsdCxpLHMpe2NvbnN0IHI9bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIHAuUHJvamVjdFRvUmVmKGUsdCxpLHMscikscn1zdGF0aWMgUHJvamVjdFRvUmVmKGUsdCxpLHMscil7Y29uc3Qgbj1zLndpZHRoLGE9cy5oZWlnaHQsbz1zLngsaD1zLnksbD1LLk1hdHJpeFsxXTt4LkZyb21WYWx1ZXNUb1JlZihuLzIsMCwwLDAsMCwtYS8yLDAsMCwwLDAsLjUsMCxvK24vMixhLzIraCwuNSwxLGwpO2NvbnN0IHU9Sy5NYXRyaXhbMF07cmV0dXJuIHQubXVsdGlwbHlUb1JlZihpLHUpLHUubXVsdGlwbHlUb1JlZihsLHUpLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZihlLHUscikscn1zdGF0aWMgUmVmbGVjdChlLHQpe3JldHVybiB0aGlzLlJlZmxlY3RUb1JlZihlLHQsbmV3IHApfXN0YXRpYyBSZWZsZWN0VG9SZWYoZSx0LGkpe2NvbnN0IHM9RC5WZWN0b3IzWzBdO3JldHVybiBzLmNvcHlGcm9tKHQpLnNjYWxlSW5QbGFjZSgyKnAuRG90KGUsdCkpLGkuY29weUZyb20oZSkuc3VidHJhY3RJblBsYWNlKHMpfXN0YXRpYyBfVW5wcm9qZWN0RnJvbUludmVydGVkTWF0cml4VG9SZWYoZSx0LGkpe3AuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZihlLHQsaSk7Y29uc3Qgcz10Lm0scj1lLl94KnNbM10rZS5feSpzWzddK2UuX3oqc1sxMV0rc1sxNV07cmV0dXJuIFguV2l0aGluRXBzaWxvbihyLDEpJiZpLnNjYWxlSW5QbGFjZSgxL3IpLGl9c3RhdGljIFVucHJvamVjdEZyb21UcmFuc2Zvcm0oZSx0LGkscyxyKXtyZXR1cm4gdGhpcy5VbnByb2plY3QoZSx0LGkscyxyLHguSWRlbnRpdHlSZWFkT25seSl9c3RhdGljIFVucHJvamVjdChlLHQsaSxzLHIsbil7Y29uc3QgYT1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gcC5VbnByb2plY3RUb1JlZihlLHQsaSxzLHIsbixhKSxhfXN0YXRpYyBVbnByb2plY3RUb1JlZihlLHQsaSxzLHIsbixhKXtyZXR1cm4gcC5VbnByb2plY3RGbG9hdHNUb1JlZihlLl94LGUuX3ksZS5feix0LGkscyxyLG4sYSksYX1zdGF0aWMgVW5wcm9qZWN0RmxvYXRzVG9SZWYoZSx0LGkscyxyLG4sYSxvLGgpe3ZhciBsO2NvbnN0IHU9Sy5NYXRyaXhbMF07bi5tdWx0aXBseVRvUmVmKGEsdSksdS5tdWx0aXBseVRvUmVmKG8sdSksdS5pbnZlcnQoKTtjb25zdCBkPUsuVmVjdG9yM1swXTtyZXR1cm4gZC54PWUvcyoyLTEsZC55PS0odC9yKjItMSksISgobD1mZS5MYXN0Q3JlYXRlZEVuZ2luZSk9PT1udWxsfHxsPT09dm9pZCAwKSYmbC5pc05EQ0hhbGZaUmFuZ2U/ZC56PWk6ZC56PTIqaS0xLHAuX1VucHJvamVjdEZyb21JbnZlcnRlZE1hdHJpeFRvUmVmKGQsdSxoKSxofXN0YXRpYyBNaW5pbWl6ZShlLHQpe2NvbnN0IGk9bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIGkuY29weUZyb20oZSksaS5taW5pbWl6ZUluUGxhY2UodCksaX1zdGF0aWMgTWF4aW1pemUoZSx0KXtjb25zdCBpPW5ldyBlLmNvbnN0cnVjdG9yO3JldHVybiBpLmNvcHlGcm9tKGUpLGkubWF4aW1pemVJblBsYWNlKHQpLGl9c3RhdGljIERpc3RhbmNlKGUsdCl7cmV0dXJuIE1hdGguc3FydChwLkRpc3RhbmNlU3F1YXJlZChlLHQpKX1zdGF0aWMgRGlzdGFuY2VTcXVhcmVkKGUsdCl7Y29uc3QgaT1lLl94LXQuX3gscz1lLl95LXQuX3kscj1lLl96LXQuX3o7cmV0dXJuIGkqaStzKnMrcipyfXN0YXRpYyBQcm9qZWN0T25UcmlhbmdsZVRvUmVmKGUsdCxpLHMscil7Y29uc3Qgbj1LLlZlY3RvcjNbMF0sYT1LLlZlY3RvcjNbMV0sbz1LLlZlY3RvcjNbMl0saD1LLlZlY3RvcjNbM10sbD1LLlZlY3RvcjNbNF07aS5zdWJ0cmFjdFRvUmVmKHQsbikscy5zdWJ0cmFjdFRvUmVmKHQsYSkscy5zdWJ0cmFjdFRvUmVmKGksbyk7Y29uc3QgdT1uLmxlbmd0aCgpLGQ9YS5sZW5ndGgoKSxmPW8ubGVuZ3RoKCk7aWYodTx4ZXx8ZDx4ZXx8Zjx4ZSlyZXR1cm4gci5jb3B5RnJvbSh0KSxwLkRpc3RhbmNlKGUsdCk7ZS5zdWJ0cmFjdFRvUmVmKHQsbCkscC5Dcm9zc1RvUmVmKG4sYSxoKTtjb25zdCBfPWgubGVuZ3RoKCk7aWYoXzx4ZSlyZXR1cm4gci5jb3B5RnJvbSh0KSxwLkRpc3RhbmNlKGUsdCk7aC5ub3JtYWxpemVGcm9tTGVuZ3RoKF8pO2xldCBFPWwubGVuZ3RoKCk7aWYoRTx4ZSlyZXR1cm4gci5jb3B5RnJvbSh0KSwwO2wubm9ybWFsaXplRnJvbUxlbmd0aChFKTtjb25zdCBtPXAuRG90KGgsbCksdj1LLlZlY3RvcjNbNV0sUz1LLlZlY3RvcjNbNl07di5jb3B5RnJvbShoKS5zY2FsZUluUGxhY2UoLUUqbSksUy5jb3B5RnJvbShlKS5hZGRJblBsYWNlKHYpO2NvbnN0IHk9Sy5WZWN0b3IzWzRdLEE9Sy5WZWN0b3IzWzVdLEM9Sy5WZWN0b3IzWzddLGI9Sy5WZWN0b3IzWzhdO3kuY29weUZyb20obikuc2NhbGVJblBsYWNlKDEvdSksYi5jb3B5RnJvbShhKS5zY2FsZUluUGxhY2UoMS9kKSx5LmFkZEluUGxhY2UoYikuc2NhbGVJblBsYWNlKC0xKSxBLmNvcHlGcm9tKG4pLnNjYWxlSW5QbGFjZSgtMS91KSxiLmNvcHlGcm9tKG8pLnNjYWxlSW5QbGFjZSgxL2YpLEEuYWRkSW5QbGFjZShiKS5zY2FsZUluUGxhY2UoLTEpLEMuY29weUZyb20obykuc2NhbGVJblBsYWNlKC0xL2YpLGIuY29weUZyb20oYSkuc2NhbGVJblBsYWNlKC0xL2QpLEMuYWRkSW5QbGFjZShiKS5zY2FsZUluUGxhY2UoLTEpO2NvbnN0IE09Sy5WZWN0b3IzWzldO2xldCBMO00uY29weUZyb20oUykuc3VidHJhY3RJblBsYWNlKHQpLHAuQ3Jvc3NUb1JlZih5LE0sYiksTD1wLkRvdChiLGgpO2NvbnN0IGs9TDtNLmNvcHlGcm9tKFMpLnN1YnRyYWN0SW5QbGFjZShpKSxwLkNyb3NzVG9SZWYoQSxNLGIpLEw9cC5Eb3QoYixoKTtjb25zdCB3PUw7TS5jb3B5RnJvbShTKS5zdWJ0cmFjdEluUGxhY2UocykscC5Dcm9zc1RvUmVmKEMsTSxiKSxMPXAuRG90KGIsaCk7Y29uc3QgZGU9TCxjZT1LLlZlY3RvcjNbMTBdO2xldCBzZSx0ZTtrPjAmJnc8MD8oY2UuY29weUZyb20obiksc2U9dCx0ZT1pKTp3PjAmJmRlPDA/KGNlLmNvcHlGcm9tKG8pLHNlPWksdGU9cyk6KGNlLmNvcHlGcm9tKGEpLnNjYWxlSW5QbGFjZSgtMSksc2U9cyx0ZT10KTtjb25zdCBGZT1LLlZlY3RvcjNbOV0sd2U9Sy5WZWN0b3IzWzRdO2lmKHNlLnN1YnRyYWN0VG9SZWYoUyxiKSx0ZS5zdWJ0cmFjdFRvUmVmKFMsRmUpLHAuQ3Jvc3NUb1JlZihiLEZlLHdlKSwhKHAuRG90KHdlLGgpPDApKXJldHVybiByLmNvcHlGcm9tKFMpLE1hdGguYWJzKEUqbSk7Y29uc3QgS2U9Sy5WZWN0b3IzWzVdO3AuQ3Jvc3NUb1JlZihjZSx3ZSxLZSksS2Uubm9ybWFsaXplKCk7Y29uc3QgWWU9Sy5WZWN0b3IzWzldO1llLmNvcHlGcm9tKHNlKS5zdWJ0cmFjdEluUGxhY2UoUyk7Y29uc3QgcHQ9WWUubGVuZ3RoKCk7aWYocHQ8eGUpcmV0dXJuIHIuY29weUZyb20oc2UpLHAuRGlzdGFuY2UoZSxzZSk7WWUubm9ybWFsaXplRnJvbUxlbmd0aChwdCk7Y29uc3QgaHQ9cC5Eb3QoS2UsWWUpLHd0PUsuVmVjdG9yM1s3XTt3dC5jb3B5RnJvbShTKS5hZGRJblBsYWNlKEtlLnNjYWxlSW5QbGFjZShwdCpodCkpLGIuY29weUZyb20od3QpLnN1YnRyYWN0SW5QbGFjZShzZSksRT1jZS5sZW5ndGgoKSxjZS5ub3JtYWxpemVGcm9tTGVuZ3RoKEUpO2xldCBzaT1wLkRvdChiLGNlKS9NYXRoLm1heChFLHhlKTtyZXR1cm4gc2k9WC5DbGFtcChzaSwwLDEpLHd0LmNvcHlGcm9tKHNlKS5hZGRJblBsYWNlKGNlLnNjYWxlSW5QbGFjZShzaSpFKSksci5jb3B5RnJvbSh3dCkscC5EaXN0YW5jZShlLHd0KX1zdGF0aWMgQ2VudGVyKGUsdCl7cmV0dXJuIHAuQ2VudGVyVG9SZWYoZSx0LHAuWmVybygpKX1zdGF0aWMgQ2VudGVyVG9SZWYoZSx0LGkpe3JldHVybiBpLmNvcHlGcm9tRmxvYXRzKChlLl94K3QuX3gpLzIsKGUuX3krdC5feSkvMiwoZS5feit0Ll96KS8yKX1zdGF0aWMgUm90YXRpb25Gcm9tQXhpcyhlLHQsaSl7Y29uc3Qgcz1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gcC5Sb3RhdGlvbkZyb21BeGlzVG9SZWYoZSx0LGkscyksc31zdGF0aWMgUm90YXRpb25Gcm9tQXhpc1RvUmVmKGUsdCxpLHMpe2NvbnN0IHI9Sy5RdWF0ZXJuaW9uWzBdO3JldHVybiBaLlJvdGF0aW9uUXVhdGVybmlvbkZyb21BeGlzVG9SZWYoZSx0LGksciksci50b0V1bGVyQW5nbGVzVG9SZWYocyksc319cC5fVXBSZWFkT25seT1wLlVwKCkscC5fRG93blJlYWRPbmx5PXAuRG93bigpLHAuX0xlZnRIYW5kZWRGb3J3YXJkUmVhZE9ubHk9cC5Gb3J3YXJkKCExKSxwLl9SaWdodEhhbmRlZEZvcndhcmRSZWFkT25seT1wLkZvcndhcmQoITApLHAuX1JpZ2h0UmVhZE9ubHk9cC5SaWdodCgpLHAuX0xlZnRSZWFkT25seT1wLkxlZnQoKSxwLl9aZXJvUmVhZE9ubHk9cC5aZXJvKCk7Y2xhc3MgQ2V7Y29uc3RydWN0b3IoZT0wLHQ9MCxpPTAscz0wKXt0aGlzLng9ZSx0aGlzLnk9dCx0aGlzLno9aSx0aGlzLnc9c310b1N0cmluZygpe3JldHVybmB7WDogJHt0aGlzLnh9IFk6ICR7dGhpcy55fSBaOiAke3RoaXMuen0gVzogJHt0aGlzLnd9fWB9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIlZlY3RvcjQifWdldEhhc2hDb2RlKCl7Y29uc3QgZT1zdCh0aGlzLngpLHQ9c3QodGhpcy55KSxpPXN0KHRoaXMueikscz1zdCh0aGlzLncpO2xldCByPWU7cmV0dXJuIHI9ciozOTdedCxyPXIqMzk3Xmkscj1yKjM5N15zLHJ9YXNBcnJheSgpe2NvbnN0IGU9bmV3IEFycmF5O3JldHVybiB0aGlzLnRvQXJyYXkoZSwwKSxlfXRvQXJyYXkoZSx0KXtyZXR1cm4gdD09PXZvaWQgMCYmKHQ9MCksZVt0XT10aGlzLngsZVt0KzFdPXRoaXMueSxlW3QrMl09dGhpcy56LGVbdCszXT10aGlzLncsdGhpc31mcm9tQXJyYXkoZSx0PTApe3JldHVybiBDZS5Gcm9tQXJyYXlUb1JlZihlLHQsdGhpcyksdGhpc31hZGRJblBsYWNlKGUpe3JldHVybiB0aGlzLngrPWUueCx0aGlzLnkrPWUueSx0aGlzLnorPWUueix0aGlzLncrPWUudyx0aGlzfWFkZChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54K2UueCx0aGlzLnkrZS55LHRoaXMueitlLnosdGhpcy53K2Uudyl9YWRkVG9SZWYoZSx0KXtyZXR1cm4gdC54PXRoaXMueCtlLngsdC55PXRoaXMueStlLnksdC56PXRoaXMueitlLnosdC53PXRoaXMudytlLncsdH1zdWJ0cmFjdEluUGxhY2UoZSl7cmV0dXJuIHRoaXMueC09ZS54LHRoaXMueS09ZS55LHRoaXMuei09ZS56LHRoaXMudy09ZS53LHRoaXN9c3VidHJhY3QoZSl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueC1lLngsdGhpcy55LWUueSx0aGlzLnotZS56LHRoaXMudy1lLncpfXN1YnRyYWN0VG9SZWYoZSx0KXtyZXR1cm4gdC54PXRoaXMueC1lLngsdC55PXRoaXMueS1lLnksdC56PXRoaXMuei1lLnosdC53PXRoaXMudy1lLncsdH1zdWJ0cmFjdEZyb21GbG9hdHMoZSx0LGkscyl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueC1lLHRoaXMueS10LHRoaXMuei1pLHRoaXMudy1zKX1zdWJ0cmFjdEZyb21GbG9hdHNUb1JlZihlLHQsaSxzLHIpe3JldHVybiByLng9dGhpcy54LWUsci55PXRoaXMueS10LHIuej10aGlzLnotaSxyLnc9dGhpcy53LXMscn1uZWdhdGUoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoLXRoaXMueCwtdGhpcy55LC10aGlzLnosLXRoaXMudyl9bmVnYXRlSW5QbGFjZSgpe3JldHVybiB0aGlzLngqPS0xLHRoaXMueSo9LTEsdGhpcy56Kj0tMSx0aGlzLncqPS0xLHRoaXN9bmVnYXRlVG9SZWYoZSl7cmV0dXJuIGUuY29weUZyb21GbG9hdHModGhpcy54Ki0xLHRoaXMueSotMSx0aGlzLnoqLTEsdGhpcy53Ki0xKX1zY2FsZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCo9ZSx0aGlzLnkqPWUsdGhpcy56Kj1lLHRoaXMudyo9ZSx0aGlzfXNjYWxlKGUpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngqZSx0aGlzLnkqZSx0aGlzLnoqZSx0aGlzLncqZSl9c2NhbGVUb1JlZihlLHQpe3JldHVybiB0Lng9dGhpcy54KmUsdC55PXRoaXMueSplLHQuej10aGlzLnoqZSx0Lnc9dGhpcy53KmUsdH1zY2FsZUFuZEFkZFRvUmVmKGUsdCl7cmV0dXJuIHQueCs9dGhpcy54KmUsdC55Kz10aGlzLnkqZSx0LnorPXRoaXMueiplLHQudys9dGhpcy53KmUsdH1lcXVhbHMoZSl7cmV0dXJuIGUmJnRoaXMueD09PWUueCYmdGhpcy55PT09ZS55JiZ0aGlzLno9PT1lLnomJnRoaXMudz09PWUud31lcXVhbHNXaXRoRXBzaWxvbihlLHQ9eGUpe3JldHVybiBlJiZYLldpdGhpbkVwc2lsb24odGhpcy54LGUueCx0KSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMueSxlLnksdCkmJlguV2l0aGluRXBzaWxvbih0aGlzLnosZS56LHQpJiZYLldpdGhpbkVwc2lsb24odGhpcy53LGUudyx0KX1lcXVhbHNUb0Zsb2F0cyhlLHQsaSxzKXtyZXR1cm4gdGhpcy54PT09ZSYmdGhpcy55PT09dCYmdGhpcy56PT09aSYmdGhpcy53PT09c31tdWx0aXBseUluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCo9ZS54LHRoaXMueSo9ZS55LHRoaXMueio9ZS56LHRoaXMudyo9ZS53LHRoaXN9bXVsdGlwbHkoZSl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueCplLngsdGhpcy55KmUueSx0aGlzLnoqZS56LHRoaXMudyplLncpfW11bHRpcGx5VG9SZWYoZSx0KXtyZXR1cm4gdC54PXRoaXMueCplLngsdC55PXRoaXMueSplLnksdC56PXRoaXMueiplLnosdC53PXRoaXMudyplLncsdH1tdWx0aXBseUJ5RmxvYXRzKGUsdCxpLHMpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngqZSx0aGlzLnkqdCx0aGlzLnoqaSx0aGlzLncqcyl9ZGl2aWRlKGUpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngvZS54LHRoaXMueS9lLnksdGhpcy56L2Uueix0aGlzLncvZS53KX1kaXZpZGVUb1JlZihlLHQpe3JldHVybiB0Lng9dGhpcy54L2UueCx0Lnk9dGhpcy55L2UueSx0Lno9dGhpcy56L2Uueix0Lnc9dGhpcy53L2Uudyx0fWRpdmlkZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMuZGl2aWRlVG9SZWYoZSx0aGlzKX1taW5pbWl6ZUluUGxhY2UoZSl7cmV0dXJuIGUueDx0aGlzLngmJih0aGlzLng9ZS54KSxlLnk8dGhpcy55JiYodGhpcy55PWUueSksZS56PHRoaXMueiYmKHRoaXMuej1lLnopLGUudzx0aGlzLncmJih0aGlzLnc9ZS53KSx0aGlzfW1heGltaXplSW5QbGFjZShlKXtyZXR1cm4gZS54PnRoaXMueCYmKHRoaXMueD1lLngpLGUueT50aGlzLnkmJih0aGlzLnk9ZS55KSxlLno+dGhpcy56JiYodGhpcy56PWUueiksZS53PnRoaXMudyYmKHRoaXMudz1lLncpLHRoaXN9Zmxvb3IoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoTWF0aC5mbG9vcih0aGlzLngpLE1hdGguZmxvb3IodGhpcy55KSxNYXRoLmZsb29yKHRoaXMueiksTWF0aC5mbG9vcih0aGlzLncpKX1mcmFjdCgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngtTWF0aC5mbG9vcih0aGlzLngpLHRoaXMueS1NYXRoLmZsb29yKHRoaXMueSksdGhpcy56LU1hdGguZmxvb3IodGhpcy56KSx0aGlzLnctTWF0aC5mbG9vcih0aGlzLncpKX1sZW5ndGgoKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueSt0aGlzLnoqdGhpcy56K3RoaXMudyp0aGlzLncpfWxlbmd0aFNxdWFyZWQoKXtyZXR1cm4gdGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55K3RoaXMueip0aGlzLnordGhpcy53KnRoaXMud31ub3JtYWxpemUoKXtjb25zdCBlPXRoaXMubGVuZ3RoKCk7cmV0dXJuIGU9PT0wP3RoaXM6dGhpcy5zY2FsZUluUGxhY2UoMS9lKX10b1ZlY3RvcjMoKXtyZXR1cm4gbmV3IHAodGhpcy54LHRoaXMueSx0aGlzLnopfWNsb25lKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueCx0aGlzLnksdGhpcy56LHRoaXMudyl9Y29weUZyb20oZSl7cmV0dXJuIHRoaXMueD1lLngsdGhpcy55PWUueSx0aGlzLno9ZS56LHRoaXMudz1lLncsdGhpc31jb3B5RnJvbUZsb2F0cyhlLHQsaSxzKXtyZXR1cm4gdGhpcy54PWUsdGhpcy55PXQsdGhpcy56PWksdGhpcy53PXMsdGhpc31zZXQoZSx0LGkscyl7cmV0dXJuIHRoaXMuY29weUZyb21GbG9hdHMoZSx0LGkscyl9c2V0QWxsKGUpe3JldHVybiB0aGlzLng9dGhpcy55PXRoaXMuej10aGlzLnc9ZSx0aGlzfXN0YXRpYyBGcm9tQXJyYXkoZSx0KXtyZXR1cm4gdHx8KHQ9MCksbmV3IENlKGVbdF0sZVt0KzFdLGVbdCsyXSxlW3QrM10pfXN0YXRpYyBGcm9tQXJyYXlUb1JlZihlLHQsaSl7cmV0dXJuIGkueD1lW3RdLGkueT1lW3QrMV0saS56PWVbdCsyXSxpLnc9ZVt0KzNdLGl9c3RhdGljIEZyb21GbG9hdEFycmF5VG9SZWYoZSx0LGkpe3JldHVybiBDZS5Gcm9tQXJyYXlUb1JlZihlLHQsaSksaX1zdGF0aWMgRnJvbUZsb2F0c1RvUmVmKGUsdCxpLHMscil7cmV0dXJuIHIueD1lLHIueT10LHIuej1pLHIudz1zLHJ9c3RhdGljIFplcm8oKXtyZXR1cm4gbmV3IENlKDAsMCwwLDApfXN0YXRpYyBPbmUoKXtyZXR1cm4gbmV3IENlKDEsMSwxLDEpfXN0YXRpYyBnZXQgWmVyb1JlYWRPbmx5KCl7cmV0dXJuIENlLl9aZXJvUmVhZE9ubHl9c3RhdGljIE5vcm1hbGl6ZShlKXtjb25zdCB0PUNlLlplcm8oKTtyZXR1cm4gQ2UuTm9ybWFsaXplVG9SZWYoZSx0KSx0fXN0YXRpYyBOb3JtYWxpemVUb1JlZihlLHQpe3JldHVybiB0LmNvcHlGcm9tKGUpLHQubm9ybWFsaXplKCksdH1zdGF0aWMgTWluaW1pemUoZSx0KXtjb25zdCBpPW5ldyBlLmNvbnN0cnVjdG9yO3JldHVybiBpLmNvcHlGcm9tKGUpLGkubWluaW1pemVJblBsYWNlKHQpLGl9c3RhdGljIE1heGltaXplKGUsdCl7Y29uc3QgaT1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gaS5jb3B5RnJvbShlKSxpLm1heGltaXplSW5QbGFjZSh0KSxpfXN0YXRpYyBEaXN0YW5jZShlLHQpe3JldHVybiBNYXRoLnNxcnQoQ2UuRGlzdGFuY2VTcXVhcmVkKGUsdCkpfXN0YXRpYyBEaXN0YW5jZVNxdWFyZWQoZSx0KXtjb25zdCBpPWUueC10Lngscz1lLnktdC55LHI9ZS56LXQueixuPWUudy10Lnc7cmV0dXJuIGkqaStzKnMrcipyK24qbn1zdGF0aWMgQ2VudGVyKGUsdCl7cmV0dXJuIENlLkNlbnRlclRvUmVmKGUsdCxDZS5aZXJvKCkpfXN0YXRpYyBDZW50ZXJUb1JlZihlLHQsaSl7cmV0dXJuIGkuY29weUZyb21GbG9hdHMoKGUueCt0LngpLzIsKGUueSt0LnkpLzIsKGUueit0LnopLzIsKGUudyt0LncpLzIpfXN0YXRpYyBUcmFuc2Zvcm1Db29yZGluYXRlcyhlLHQpe2NvbnN0IGk9Q2UuWmVybygpO3JldHVybiBDZS5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGUsdCxpKSxpfXN0YXRpYyBUcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGUsdCxpKXtyZXR1cm4gQ2UuVHJhbnNmb3JtQ29vcmRpbmF0ZXNGcm9tRmxvYXRzVG9SZWYoZS5feCxlLl95LGUuX3osdCxpKSxpfXN0YXRpYyBUcmFuc2Zvcm1Db29yZGluYXRlc0Zyb21GbG9hdHNUb1JlZihlLHQsaSxzLHIpe2NvbnN0IG49cy5tLGE9ZSpuWzBdK3Qqbls0XStpKm5bOF0rblsxMl0sbz1lKm5bMV0rdCpuWzVdK2kqbls5XStuWzEzXSxoPWUqblsyXSt0Km5bNl0raSpuWzEwXStuWzE0XSxsPWUqblszXSt0Km5bN10raSpuWzExXStuWzE1XTtyZXR1cm4gci54PWEsci55PW8sci56PWgsci53PWwscn1zdGF0aWMgVHJhbnNmb3JtTm9ybWFsKGUsdCl7Y29uc3QgaT1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gQ2UuVHJhbnNmb3JtTm9ybWFsVG9SZWYoZSx0LGkpLGl9c3RhdGljIFRyYW5zZm9ybU5vcm1hbFRvUmVmKGUsdCxpKXtjb25zdCBzPXQubSxyPWUueCpzWzBdK2UueSpzWzRdK2UueipzWzhdLG49ZS54KnNbMV0rZS55KnNbNV0rZS56KnNbOV0sYT1lLngqc1syXStlLnkqc1s2XStlLnoqc1sxMF07cmV0dXJuIGkueD1yLGkueT1uLGkuej1hLGkudz1lLncsaX1zdGF0aWMgVHJhbnNmb3JtTm9ybWFsRnJvbUZsb2F0c1RvUmVmKGUsdCxpLHMscixuKXtjb25zdCBhPXIubTtyZXR1cm4gbi54PWUqYVswXSt0KmFbNF0raSphWzhdLG4ueT1lKmFbMV0rdCphWzVdK2kqYVs5XSxuLno9ZSphWzJdK3QqYVs2XStpKmFbMTBdLG4udz1zLG59c3RhdGljIEZyb21WZWN0b3IzKGUsdD0wKXtyZXR1cm4gbmV3IENlKGUuX3gsZS5feSxlLl96LHQpfX1DZS5fWmVyb1JlYWRPbmx5PUNlLlplcm8oKTtjbGFzcyBae2NvbnN0cnVjdG9yKGU9MCx0PTAsaT0wLHM9MSl7dGhpcy5faXNEaXJ0eT0hMCx0aGlzLl94PWUsdGhpcy5feT10LHRoaXMuX3o9aSx0aGlzLl93PXN9Z2V0IHgoKXtyZXR1cm4gdGhpcy5feH1zZXQgeChlKXt0aGlzLl94PWUsdGhpcy5faXNEaXJ0eT0hMH1nZXQgeSgpe3JldHVybiB0aGlzLl95fXNldCB5KGUpe3RoaXMuX3k9ZSx0aGlzLl9pc0RpcnR5PSEwfWdldCB6KCl7cmV0dXJuIHRoaXMuX3p9c2V0IHooZSl7dGhpcy5fej1lLHRoaXMuX2lzRGlydHk9ITB9Z2V0IHcoKXtyZXR1cm4gdGhpcy5fd31zZXQgdyhlKXt0aGlzLl93PWUsdGhpcy5faXNEaXJ0eT0hMH10b1N0cmluZygpe3JldHVybmB7WDogJHt0aGlzLl94fSBZOiAke3RoaXMuX3l9IFo6ICR7dGhpcy5fen0gVzogJHt0aGlzLl93fX1gfWdldENsYXNzTmFtZSgpe3JldHVybiJRdWF0ZXJuaW9uIn1nZXRIYXNoQ29kZSgpe2NvbnN0IGU9c3QodGhpcy5feCksdD1zdCh0aGlzLl95KSxpPXN0KHRoaXMuX3opLHM9c3QodGhpcy5fdyk7bGV0IHI9ZTtyZXR1cm4gcj1yKjM5N150LHI9ciozOTdeaSxyPXIqMzk3XnMscn1hc0FycmF5KCl7cmV0dXJuW3RoaXMuX3gsdGhpcy5feSx0aGlzLl96LHRoaXMuX3ddfXRvQXJyYXkoZSx0PTApe3JldHVybiBlW3RdPXRoaXMueCxlW3QrMV09dGhpcy55LGVbdCsyXT10aGlzLnosZVt0KzNdPXRoaXMudyx0aGlzfWVxdWFscyhlKXtyZXR1cm4gZSYmdGhpcy5feD09PWUuX3gmJnRoaXMuX3k9PT1lLl95JiZ0aGlzLl96PT09ZS5feiYmdGhpcy5fdz09PWUuX3d9ZXF1YWxzV2l0aEVwc2lsb24oZSx0PXhlKXtyZXR1cm4gZSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMuX3gsZS5feCx0KSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMuX3ksZS5feSx0KSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMuX3osZS5feix0KSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMuX3csZS5fdyx0KX1jbG9uZSgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLl94LHRoaXMuX3ksdGhpcy5feix0aGlzLl93KX1jb3B5RnJvbShlKXtyZXR1cm4gdGhpcy54PWUuX3gsdGhpcy55PWUuX3ksdGhpcy56PWUuX3osdGhpcy53PWUuX3csdGhpc31jb3B5RnJvbUZsb2F0cyhlLHQsaSxzKXtyZXR1cm4gdGhpcy54PWUsdGhpcy55PXQsdGhpcy56PWksdGhpcy53PXMsdGhpc31zZXQoZSx0LGkscyl7cmV0dXJuIHRoaXMuY29weUZyb21GbG9hdHMoZSx0LGkscyl9YWRkKGUpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLl94K2UuX3gsdGhpcy5feStlLl95LHRoaXMuX3orZS5feix0aGlzLl93K2UuX3cpfWFkZEluUGxhY2UoZSl7cmV0dXJuIHRoaXMuX3grPWUuX3gsdGhpcy5feSs9ZS5feSx0aGlzLl96Kz1lLl96LHRoaXMuX3crPWUuX3csdGhpc31zdWJ0cmFjdChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feC1lLl94LHRoaXMuX3ktZS5feSx0aGlzLl96LWUuX3osdGhpcy5fdy1lLl93KX1zdWJ0cmFjdEluUGxhY2UoZSl7cmV0dXJuIHRoaXMuX3gtPWUuX3gsdGhpcy5feS09ZS5feSx0aGlzLl96LT1lLl96LHRoaXMuX3ctPWUuX3csdGhpc31zY2FsZShlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feCplLHRoaXMuX3kqZSx0aGlzLl96KmUsdGhpcy5fdyplKX1zY2FsZVRvUmVmKGUsdCl7cmV0dXJuIHQueD10aGlzLl94KmUsdC55PXRoaXMuX3kqZSx0Lno9dGhpcy5feiplLHQudz10aGlzLl93KmUsdH1zY2FsZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCo9ZSx0aGlzLnkqPWUsdGhpcy56Kj1lLHRoaXMudyo9ZSx0aGlzfXNjYWxlQW5kQWRkVG9SZWYoZSx0KXtyZXR1cm4gdC54Kz10aGlzLl94KmUsdC55Kz10aGlzLl95KmUsdC56Kz10aGlzLl96KmUsdC53Kz10aGlzLl93KmUsdH1tdWx0aXBseShlKXtjb25zdCB0PW5ldyB0aGlzLmNvbnN0cnVjdG9yKDAsMCwwLDEpO3JldHVybiB0aGlzLm11bHRpcGx5VG9SZWYoZSx0KSx0fW11bHRpcGx5VG9SZWYoZSx0KXtjb25zdCBpPXRoaXMuX3gqZS5fdyt0aGlzLl95KmUuX3otdGhpcy5feiplLl95K3RoaXMuX3cqZS5feCxzPS10aGlzLl94KmUuX3ordGhpcy5feSplLl93K3RoaXMuX3oqZS5feCt0aGlzLl93KmUuX3kscj10aGlzLl94KmUuX3ktdGhpcy5feSplLl94K3RoaXMuX3oqZS5fdyt0aGlzLl93KmUuX3osbj0tdGhpcy5feCplLl94LXRoaXMuX3kqZS5feS10aGlzLl96KmUuX3ordGhpcy5fdyplLl93O3JldHVybiB0LmNvcHlGcm9tRmxvYXRzKGkscyxyLG4pLHR9bXVsdGlwbHlJblBsYWNlKGUpe3JldHVybiB0aGlzLm11bHRpcGx5VG9SZWYoZSx0aGlzKSx0aGlzfWNvbmp1Z2F0ZVRvUmVmKGUpe3JldHVybiBlLmNvcHlGcm9tRmxvYXRzKC10aGlzLl94LC10aGlzLl95LC10aGlzLl96LHRoaXMuX3cpLGV9Y29uanVnYXRlSW5QbGFjZSgpe3JldHVybiB0aGlzLngqPS0xLHRoaXMueSo9LTEsdGhpcy56Kj0tMSx0aGlzfWNvbmp1Z2F0ZSgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigtdGhpcy5feCwtdGhpcy5feSwtdGhpcy5feix0aGlzLl93KX1pbnZlcnQoKXtjb25zdCBlPXRoaXMuY29uanVnYXRlKCksdD10aGlzLmxlbmd0aFNxdWFyZWQoKTtyZXR1cm4gdD09MHx8dD09MXx8ZS5zY2FsZUluUGxhY2UoMS90KSxlfWludmVydEluUGxhY2UoKXt0aGlzLmNvbmp1Z2F0ZUluUGxhY2UoKTtjb25zdCBlPXRoaXMubGVuZ3RoU3F1YXJlZCgpO3JldHVybiBlPT0wfHxlPT0xP3RoaXM6KHRoaXMuc2NhbGVJblBsYWNlKDEvZSksdGhpcyl9bGVuZ3RoU3F1YXJlZCgpe3JldHVybiB0aGlzLl94KnRoaXMuX3grdGhpcy5feSp0aGlzLl95K3RoaXMuX3oqdGhpcy5feit0aGlzLl93KnRoaXMuX3d9bGVuZ3RoKCl7cmV0dXJuIE1hdGguc3FydCh0aGlzLmxlbmd0aFNxdWFyZWQoKSl9bm9ybWFsaXplKCl7Y29uc3QgZT10aGlzLmxlbmd0aCgpO2lmKGU9PT0wKXJldHVybiB0aGlzO2NvbnN0IHQ9MS9lO3JldHVybiB0aGlzLnNjYWxlSW5QbGFjZSh0KSx0aGlzfW5vcm1hbGl6ZVRvTmV3KCl7Y29uc3QgZT10aGlzLmxlbmd0aCgpO2lmKGU9PT0wKXJldHVybiB0aGlzLmNsb25lKCk7Y29uc3QgdD0xL2U7cmV0dXJuIHRoaXMuc2NhbGUodCl9dG9FdWxlckFuZ2xlcygpe2NvbnN0IGU9cC5aZXJvKCk7cmV0dXJuIHRoaXMudG9FdWxlckFuZ2xlc1RvUmVmKGUpLGV9dG9FdWxlckFuZ2xlc1RvUmVmKGUpe2NvbnN0IHQ9dGhpcy5feixpPXRoaXMuX3gscz10aGlzLl95LHI9dGhpcy5fdyxuPXMqdC1pKnIsYT0uNDk5OTk5OTtpZihuPC1hKWUueT0yKk1hdGguYXRhbjIocyxyKSxlLng9TWF0aC5QSS8yLGUuej0wO2Vsc2UgaWYobj5hKWUueT0yKk1hdGguYXRhbjIocyxyKSxlLng9LU1hdGguUEkvMixlLno9MDtlbHNle2NvbnN0IG89cipyLGg9dCp0LGw9aSppLHU9cypzO2Uuej1NYXRoLmF0YW4yKDIqKGkqcyt0KnIpLC1oLWwrdStvKSxlLng9TWF0aC5hc2luKC0yKm4pLGUueT1NYXRoLmF0YW4yKDIqKHQqaStzKnIpLGgtbC11K28pfXJldHVybiBlfXRvUm90YXRpb25NYXRyaXgoZSl7cmV0dXJuIHguRnJvbVF1YXRlcm5pb25Ub1JlZih0aGlzLGUpLGV9ZnJvbVJvdGF0aW9uTWF0cml4KGUpe3JldHVybiBaLkZyb21Sb3RhdGlvbk1hdHJpeFRvUmVmKGUsdGhpcyksdGhpc31zdGF0aWMgRnJvbVJvdGF0aW9uTWF0cml4KGUpe2NvbnN0IHQ9bmV3IFo7cmV0dXJuIFouRnJvbVJvdGF0aW9uTWF0cml4VG9SZWYoZSx0KSx0fXN0YXRpYyBGcm9tUm90YXRpb25NYXRyaXhUb1JlZihlLHQpe2NvbnN0IGk9ZS5tLHM9aVswXSxyPWlbNF0sbj1pWzhdLGE9aVsxXSxvPWlbNV0saD1pWzldLGw9aVsyXSx1PWlbNl0sZD1pWzEwXSxmPXMrbytkO2xldCBfO3JldHVybiBmPjA/KF89LjUvTWF0aC5zcXJ0KGYrMSksdC53PS4yNS9fLHQueD0odS1oKSpfLHQueT0obi1sKSpfLHQuej0oYS1yKSpfKTpzPm8mJnM+ZD8oXz0yKk1hdGguc3FydCgxK3Mtby1kKSx0Lnc9KHUtaCkvXyx0Lng9LjI1Kl8sdC55PShyK2EpL18sdC56PShuK2wpL18pOm8+ZD8oXz0yKk1hdGguc3FydCgxK28tcy1kKSx0Lnc9KG4tbCkvXyx0Lng9KHIrYSkvXyx0Lnk9LjI1Kl8sdC56PShoK3UpL18pOihfPTIqTWF0aC5zcXJ0KDErZC1zLW8pLHQudz0oYS1yKS9fLHQueD0obitsKS9fLHQueT0oaCt1KS9fLHQuej0uMjUqXyksdH1zdGF0aWMgRG90KGUsdCl7cmV0dXJuIGUuX3gqdC5feCtlLl95KnQuX3krZS5feip0Ll96K2UuX3cqdC5fd31zdGF0aWMgQXJlQ2xvc2UoZSx0LGk9LjEpe2NvbnN0IHM9Wi5Eb3QoZSx0KTtyZXR1cm4gMS1zKnM8PWl9c3RhdGljIFNtb290aFRvUmVmKGUsdCxpLHMscil7bGV0IG49cz09PTA/MTppL3M7cmV0dXJuIG49WC5DbGFtcChuLDAsMSksWi5TbGVycFRvUmVmKGUsdCxuLHIpLHJ9c3RhdGljIFplcm8oKXtyZXR1cm4gbmV3IFooMCwwLDAsMCl9c3RhdGljIEludmVyc2UoZSl7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKC1lLl94LC1lLl95LC1lLl96LGUuX3cpfXN0YXRpYyBJbnZlcnNlVG9SZWYoZSx0KXtyZXR1cm4gdC5zZXQoLWUuX3gsLWUuX3ksLWUuX3osZS5fdyksdH1zdGF0aWMgSWRlbnRpdHkoKXtyZXR1cm4gbmV3IFooMCwwLDAsMSl9c3RhdGljIElzSWRlbnRpdHkoZSl7cmV0dXJuIGUmJmUuX3g9PT0wJiZlLl95PT09MCYmZS5fej09PTAmJmUuX3c9PT0xfXN0YXRpYyBSb3RhdGlvbkF4aXMoZSx0KXtyZXR1cm4gWi5Sb3RhdGlvbkF4aXNUb1JlZihlLHQsbmV3IFopfXN0YXRpYyBSb3RhdGlvbkF4aXNUb1JlZihlLHQsaSl7Y29uc3Qgcz1NYXRoLnNpbih0LzIpO3JldHVybiBlLm5vcm1hbGl6ZSgpLGkudz1NYXRoLmNvcyh0LzIpLGkueD1lLl94KnMsaS55PWUuX3kqcyxpLno9ZS5feipzLGl9c3RhdGljIEZyb21BcnJheShlLHQpe3JldHVybiB0fHwodD0wKSxuZXcgWihlW3RdLGVbdCsxXSxlW3QrMl0sZVt0KzNdKX1zdGF0aWMgRnJvbUFycmF5VG9SZWYoZSx0LGkpe3JldHVybiBpLng9ZVt0XSxpLnk9ZVt0KzFdLGkuej1lW3QrMl0saS53PWVbdCszXSxpfXN0YXRpYyBGcm9tRXVsZXJBbmdsZXMoZSx0LGkpe2NvbnN0IHM9bmV3IFo7cmV0dXJuIFouUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZih0LGUsaSxzKSxzfXN0YXRpYyBGcm9tRXVsZXJBbmdsZXNUb1JlZihlLHQsaSxzKXtyZXR1cm4gWi5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKHQsZSxpLHMpLHN9c3RhdGljIEZyb21FdWxlclZlY3RvcihlKXtjb25zdCB0PW5ldyBaO3JldHVybiBaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYoZS5feSxlLl94LGUuX3osdCksdH1zdGF0aWMgRnJvbUV1bGVyVmVjdG9yVG9SZWYoZSx0KXtyZXR1cm4gWi5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKGUuX3ksZS5feCxlLl96LHQpLHR9c3RhdGljIEZyb21Vbml0VmVjdG9yc1RvUmVmKGUsdCxpKXtjb25zdCBzPXAuRG90KGUsdCkrMTtyZXR1cm4gczx4ZT9NYXRoLmFicyhlLngpPk1hdGguYWJzKGUueik/aS5zZXQoLWUueSxlLngsMCwwKTppLnNldCgwLC1lLnosZS55LDApOihwLkNyb3NzVG9SZWYoZSx0LEQuVmVjdG9yM1swXSksaS5zZXQoRC5WZWN0b3IzWzBdLngsRC5WZWN0b3IzWzBdLnksRC5WZWN0b3IzWzBdLnoscykpLGkubm9ybWFsaXplKCl9c3RhdGljIFJvdGF0aW9uWWF3UGl0Y2hSb2xsKGUsdCxpKXtjb25zdCBzPW5ldyBaO3JldHVybiBaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYoZSx0LGkscyksc31zdGF0aWMgUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZihlLHQsaSxzKXtjb25zdCByPWkqLjUsbj10Ki41LGE9ZSouNSxvPU1hdGguc2luKHIpLGg9TWF0aC5jb3MociksbD1NYXRoLnNpbihuKSx1PU1hdGguY29zKG4pLGQ9TWF0aC5zaW4oYSksZj1NYXRoLmNvcyhhKTtyZXR1cm4gcy54PWYqbCpoK2QqdSpvLHMueT1kKnUqaC1mKmwqbyxzLno9Zip1Km8tZCpsKmgscy53PWYqdSpoK2QqbCpvLHN9c3RhdGljIFJvdGF0aW9uQWxwaGFCZXRhR2FtbWEoZSx0LGkpe2NvbnN0IHM9bmV3IFo7cmV0dXJuIFouUm90YXRpb25BbHBoYUJldGFHYW1tYVRvUmVmKGUsdCxpLHMpLHN9c3RhdGljIFJvdGF0aW9uQWxwaGFCZXRhR2FtbWFUb1JlZihlLHQsaSxzKXtjb25zdCByPShpK2UpKi41LG49KGktZSkqLjUsYT10Ki41O3JldHVybiBzLng9TWF0aC5jb3MobikqTWF0aC5zaW4oYSkscy55PU1hdGguc2luKG4pKk1hdGguc2luKGEpLHMuej1NYXRoLnNpbihyKSpNYXRoLmNvcyhhKSxzLnc9TWF0aC5jb3MocikqTWF0aC5jb3MoYSksc31zdGF0aWMgUm90YXRpb25RdWF0ZXJuaW9uRnJvbUF4aXMoZSx0LGkpe2NvbnN0IHM9bmV3IFooMCwwLDAsMCk7cmV0dXJuIFouUm90YXRpb25RdWF0ZXJuaW9uRnJvbUF4aXNUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBSb3RhdGlvblF1YXRlcm5pb25Gcm9tQXhpc1RvUmVmKGUsdCxpLHMpe2NvbnN0IHI9Sy5NYXRyaXhbMF07cmV0dXJuIHguRnJvbVhZWkF4ZXNUb1JlZihlLm5vcm1hbGl6ZSgpLHQubm9ybWFsaXplKCksaS5ub3JtYWxpemUoKSxyKSxaLkZyb21Sb3RhdGlvbk1hdHJpeFRvUmVmKHIscyksc31zdGF0aWMgRnJvbUxvb2tEaXJlY3Rpb25MSChlLHQpe2NvbnN0IGk9bmV3IFo7cmV0dXJuIFouRnJvbUxvb2tEaXJlY3Rpb25MSFRvUmVmKGUsdCxpKSxpfXN0YXRpYyBGcm9tTG9va0RpcmVjdGlvbkxIVG9SZWYoZSx0LGkpe2NvbnN0IHM9Sy5NYXRyaXhbMF07cmV0dXJuIHguTG9va0RpcmVjdGlvbkxIVG9SZWYoZSx0LHMpLFouRnJvbVJvdGF0aW9uTWF0cml4VG9SZWYocyxpKSxpfXN0YXRpYyBGcm9tTG9va0RpcmVjdGlvblJIKGUsdCl7Y29uc3QgaT1uZXcgWjtyZXR1cm4gWi5Gcm9tTG9va0RpcmVjdGlvblJIVG9SZWYoZSx0LGkpLGl9c3RhdGljIEZyb21Mb29rRGlyZWN0aW9uUkhUb1JlZihlLHQsaSl7Y29uc3Qgcz1LLk1hdHJpeFswXTtyZXR1cm4geC5Mb29rRGlyZWN0aW9uUkhUb1JlZihlLHQscyksWi5Gcm9tUm90YXRpb25NYXRyaXhUb1JlZihzLGkpfXN0YXRpYyBTbGVycChlLHQsaSl7Y29uc3Qgcz1aLklkZW50aXR5KCk7cmV0dXJuIFouU2xlcnBUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBTbGVycFRvUmVmKGUsdCxpLHMpe2xldCByLG4sYT1lLl94KnQuX3grZS5feSp0Ll95K2UuX3oqdC5feitlLl93KnQuX3csbz0hMTtpZihhPDAmJihvPSEwLGE9LWEpLGE+Ljk5OTk5OSluPTEtaSxyPW8/LWk6aTtlbHNle2NvbnN0IGg9TWF0aC5hY29zKGEpLGw9MS9NYXRoLnNpbihoKTtuPU1hdGguc2luKCgxLWkpKmgpKmwscj1vPy1NYXRoLnNpbihpKmgpKmw6TWF0aC5zaW4oaSpoKSpsfXJldHVybiBzLng9biplLl94K3IqdC5feCxzLnk9biplLl95K3IqdC5feSxzLno9biplLl96K3IqdC5feixzLnc9biplLl93K3IqdC5fdyxzfXN0YXRpYyBIZXJtaXRlKGUsdCxpLHMscil7Y29uc3Qgbj1yKnIsYT1yKm4sbz0yKmEtMypuKzEsaD0tMiphKzMqbixsPWEtMipuK3IsdT1hLW4sZD1lLl94Km8raS5feCpoK3QuX3gqbCtzLl94KnUsZj1lLl95Km8raS5feSpoK3QuX3kqbCtzLl95KnUsXz1lLl96Km8raS5feipoK3QuX3oqbCtzLl96KnUsRT1lLl93Km8raS5fdypoK3QuX3cqbCtzLl93KnU7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKGQsZixfLEUpfXN0YXRpYyBIZXJtaXRlMXN0RGVyaXZhdGl2ZShlLHQsaSxzLHIpe2NvbnN0IG49bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIHRoaXMuSGVybWl0ZTFzdERlcml2YXRpdmVUb1JlZihlLHQsaSxzLHIsbiksbn1zdGF0aWMgSGVybWl0ZTFzdERlcml2YXRpdmVUb1JlZihlLHQsaSxzLHIsbil7Y29uc3QgYT1yKnI7cmV0dXJuIG4ueD0oYS1yKSo2KmUueCsoMyphLTQqcisxKSp0LngrKC1hK3IpKjYqaS54KygzKmEtMipyKSpzLngsbi55PShhLXIpKjYqZS55KygzKmEtNCpyKzEpKnQueSsoLWErcikqNippLnkrKDMqYS0yKnIpKnMueSxuLno9KGEtcikqNiplLnorKDMqYS00KnIrMSkqdC56KygtYStyKSo2KmkueisoMyphLTIqcikqcy56LG4udz0oYS1yKSo2KmUudysoMyphLTQqcisxKSp0LncrKC1hK3IpKjYqaS53KygzKmEtMipyKSpzLncsbn19Y2xhc3MgeHtjb25zdHJ1Y3Rvcigpe3RoaXMuX2lzSWRlbnRpdHk9ITEsdGhpcy5faXNJZGVudGl0eURpcnR5PSEwLHRoaXMuX2lzSWRlbnRpdHkzeDI9ITAsdGhpcy5faXNJZGVudGl0eTN4MkRpcnR5PSEwLHRoaXMudXBkYXRlRmxhZz0tMSxVZS5NYXRyaXhUcmFja1ByZWNpc2lvbkNoYW5nZSYmVWUuTWF0cml4VHJhY2tlZE1hdHJpY2VzLnB1c2godGhpcyksdGhpcy5fbT1uZXcgVWUuTWF0cml4Q3VycmVudFR5cGUoMTYpLHRoaXMubWFya0FzVXBkYXRlZCgpfXN0YXRpYyBnZXQgVXNlNjRCaXRzKCl7cmV0dXJuIFVlLk1hdHJpeFVzZTY0Qml0c31nZXQgbSgpe3JldHVybiB0aGlzLl9tfW1hcmtBc1VwZGF0ZWQoKXt0aGlzLnVwZGF0ZUZsYWc9eC5fVXBkYXRlRmxhZ1NlZWQrKyx0aGlzLl9pc0lkZW50aXR5PSExLHRoaXMuX2lzSWRlbnRpdHkzeDI9ITEsdGhpcy5faXNJZGVudGl0eURpcnR5PSEwLHRoaXMuX2lzSWRlbnRpdHkzeDJEaXJ0eT0hMH1fdXBkYXRlSWRlbnRpdHlTdGF0dXMoZSx0PSExLGk9ITEscz0hMCl7dGhpcy5faXNJZGVudGl0eT1lLHRoaXMuX2lzSWRlbnRpdHkzeDI9ZXx8aSx0aGlzLl9pc0lkZW50aXR5RGlydHk9dGhpcy5faXNJZGVudGl0eT8hMTp0LHRoaXMuX2lzSWRlbnRpdHkzeDJEaXJ0eT10aGlzLl9pc0lkZW50aXR5M3gyPyExOnN9aXNJZGVudGl0eSgpe2lmKHRoaXMuX2lzSWRlbnRpdHlEaXJ0eSl7dGhpcy5faXNJZGVudGl0eURpcnR5PSExO2NvbnN0IGU9dGhpcy5fbTt0aGlzLl9pc0lkZW50aXR5PWVbMF09PT0xJiZlWzFdPT09MCYmZVsyXT09PTAmJmVbM109PT0wJiZlWzRdPT09MCYmZVs1XT09PTEmJmVbNl09PT0wJiZlWzddPT09MCYmZVs4XT09PTAmJmVbOV09PT0wJiZlWzEwXT09PTEmJmVbMTFdPT09MCYmZVsxMl09PT0wJiZlWzEzXT09PTAmJmVbMTRdPT09MCYmZVsxNV09PT0xfXJldHVybiB0aGlzLl9pc0lkZW50aXR5fWlzSWRlbnRpdHlBczN4Migpe3JldHVybiB0aGlzLl9pc0lkZW50aXR5M3gyRGlydHkmJih0aGlzLl9pc0lkZW50aXR5M3gyRGlydHk9ITEsdGhpcy5fbVswXSE9PTF8fHRoaXMuX21bNV0hPT0xfHx0aGlzLl9tWzE1XSE9PTE/dGhpcy5faXNJZGVudGl0eTN4Mj0hMTp0aGlzLl9tWzFdIT09MHx8dGhpcy5fbVsyXSE9PTB8fHRoaXMuX21bM10hPT0wfHx0aGlzLl9tWzRdIT09MHx8dGhpcy5fbVs2XSE9PTB8fHRoaXMuX21bN10hPT0wfHx0aGlzLl9tWzhdIT09MHx8dGhpcy5fbVs5XSE9PTB8fHRoaXMuX21bMTBdIT09MHx8dGhpcy5fbVsxMV0hPT0wfHx0aGlzLl9tWzEyXSE9PTB8fHRoaXMuX21bMTNdIT09MHx8dGhpcy5fbVsxNF0hPT0wP3RoaXMuX2lzSWRlbnRpdHkzeDI9ITE6dGhpcy5faXNJZGVudGl0eTN4Mj0hMCksdGhpcy5faXNJZGVudGl0eTN4Mn1kZXRlcm1pbmFudCgpe2lmKHRoaXMuX2lzSWRlbnRpdHk9PT0hMClyZXR1cm4gMTtjb25zdCBlPXRoaXMuX20sdD1lWzBdLGk9ZVsxXSxzPWVbMl0scj1lWzNdLG49ZVs0XSxhPWVbNV0sbz1lWzZdLGg9ZVs3XSxsPWVbOF0sdT1lWzldLGQ9ZVsxMF0sZj1lWzExXSxfPWVbMTJdLEU9ZVsxM10sbT1lWzE0XSx2PWVbMTVdLFM9ZCp2LW0qZix5PXUqdi1FKmYsQT11Km0tRSpkLEM9bCp2LV8qZixiPWwqbS1kKl8sTT1sKkUtXyp1LEw9KyhhKlMtbyp5K2gqQSksaz0tKG4qUy1vKkMraCpiKSx3PSsobip5LWEqQytoKk0pLGRlPS0obipBLWEqYitvKk0pO3JldHVybiB0KkwraSprK3MqdytyKmRlfXRvQXJyYXkoKXtyZXR1cm4gdGhpcy5fbX1hc0FycmF5KCl7cmV0dXJuIHRoaXMuX219aW52ZXJ0KCl7cmV0dXJuIHRoaXMuaW52ZXJ0VG9SZWYodGhpcyksdGhpc31yZXNldCgpe3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZigwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLHRoaXMpLHRoaXMuX3VwZGF0ZUlkZW50aXR5U3RhdHVzKCExKSx0aGlzfWFkZChlKXtjb25zdCB0PW5ldyB0aGlzLmNvbnN0cnVjdG9yO3JldHVybiB0aGlzLmFkZFRvUmVmKGUsdCksdH1hZGRUb1JlZihlLHQpe2NvbnN0IGk9dGhpcy5fbSxzPXQuX20scj1lLm07Zm9yKGxldCBuPTA7bjwxNjtuKyspc1tuXT1pW25dK3Jbbl07cmV0dXJuIHQubWFya0FzVXBkYXRlZCgpLHR9YWRkVG9TZWxmKGUpe2NvbnN0IHQ9dGhpcy5fbSxpPWUubTtmb3IobGV0IHM9MDtzPDE2O3MrKyl0W3NdKz1pW3NdO3JldHVybiB0aGlzLm1hcmtBc1VwZGF0ZWQoKSx0aGlzfWludmVydFRvUmVmKGUpe2lmKHRoaXMuX2lzSWRlbnRpdHk9PT0hMClyZXR1cm4geC5JZGVudGl0eVRvUmVmKGUpLGU7Y29uc3QgdD10aGlzLl9tLGk9dFswXSxzPXRbMV0scj10WzJdLG49dFszXSxhPXRbNF0sbz10WzVdLGg9dFs2XSxsPXRbN10sdT10WzhdLGQ9dFs5XSxmPXRbMTBdLF89dFsxMV0sRT10WzEyXSxtPXRbMTNdLHY9dFsxNF0sUz10WzE1XSx5PWYqUy12Kl8sQT1kKlMtbSpfLEM9ZCp2LW0qZixiPXUqUy1FKl8sTT11KnYtZipFLEw9dSptLUUqZCxrPSsobyp5LWgqQStsKkMpLHc9LShhKnktaCpiK2wqTSksZGU9KyhhKkEtbypiK2wqTCksY2U9LShhKkMtbypNK2gqTCksc2U9aSprK3MqdytyKmRlK24qY2U7aWYoc2U9PT0wKXJldHVybiBlLmNvcHlGcm9tKHRoaXMpLGU7Y29uc3QgdGU9MS9zZSxGZT1oKlMtdipsLHdlPW8qUy1tKmwsSGU9byp2LW0qaCxLZT1hKlMtRSpsLFllPWEqdi1FKmgscHQ9YSptLUUqbyxodD1oKl8tZipsLHd0PW8qXy1kKmwsc2k9bypmLWQqaCxkcz1hKl8tdSpsLGZzPWEqZi11KmgsX3M9YSpkLXUqbyxYcz0tKHMqeS1yKkErbipDKSxIcz0rKGkqeS1yKmIrbipNKSxLcz0tKGkqQS1zKmIrbipMKSxZcz0rKGkqQy1zKk0rcipMKSxacz0rKHMqRmUtcip3ZStuKkhlKSxxcz0tKGkqRmUtcipLZStuKlllKSxIdD0rKGkqd2UtcypLZStuKnB0KSxLdD0tKGkqSGUtcypZZStyKnB0KSxZdD0tKHMqaHQtcip3dCtuKnNpKSxadD0rKGkqaHQtcipkcytuKmZzKSx3bD0tKGkqd3QtcypkcytuKl9zKSxPbD0rKGkqc2ktcypmcytyKl9zKTtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoayp0ZSxYcyp0ZSxacyp0ZSxZdCp0ZSx3KnRlLEhzKnRlLHFzKnRlLFp0KnRlLGRlKnRlLEtzKnRlLEh0KnRlLHdsKnRlLGNlKnRlLFlzKnRlLEt0KnRlLE9sKnRlLGUpLGV9YWRkQXRJbmRleChlLHQpe3JldHVybiB0aGlzLl9tW2VdKz10LHRoaXMubWFya0FzVXBkYXRlZCgpLHRoaXN9bXVsdGlwbHlBdEluZGV4KGUsdCl7cmV0dXJuIHRoaXMuX21bZV0qPXQsdGhpcy5tYXJrQXNVcGRhdGVkKCksdGhpc31zZXRUcmFuc2xhdGlvbkZyb21GbG9hdHMoZSx0LGkpe3JldHVybiB0aGlzLl9tWzEyXT1lLHRoaXMuX21bMTNdPXQsdGhpcy5fbVsxNF09aSx0aGlzLm1hcmtBc1VwZGF0ZWQoKSx0aGlzfWFkZFRyYW5zbGF0aW9uRnJvbUZsb2F0cyhlLHQsaSl7cmV0dXJuIHRoaXMuX21bMTJdKz1lLHRoaXMuX21bMTNdKz10LHRoaXMuX21bMTRdKz1pLHRoaXMubWFya0FzVXBkYXRlZCgpLHRoaXN9c2V0VHJhbnNsYXRpb24oZSl7cmV0dXJuIHRoaXMuc2V0VHJhbnNsYXRpb25Gcm9tRmxvYXRzKGUuX3gsZS5feSxlLl96KX1nZXRUcmFuc2xhdGlvbigpe3JldHVybiBuZXcgcCh0aGlzLl9tWzEyXSx0aGlzLl9tWzEzXSx0aGlzLl9tWzE0XSl9Z2V0VHJhbnNsYXRpb25Ub1JlZihlKXtyZXR1cm4gZS54PXRoaXMuX21bMTJdLGUueT10aGlzLl9tWzEzXSxlLno9dGhpcy5fbVsxNF0sZX1yZW1vdmVSb3RhdGlvbkFuZFNjYWxpbmcoKXtjb25zdCBlPXRoaXMubTtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoMSwwLDAsMCwwLDEsMCwwLDAsMCwxLDAsZVsxMl0sZVsxM10sZVsxNF0sZVsxNV0sdGhpcyksdGhpcy5fdXBkYXRlSWRlbnRpdHlTdGF0dXMoZVsxMl09PT0wJiZlWzEzXT09PTAmJmVbMTRdPT09MCYmZVsxNV09PT0xKSx0aGlzfW11bHRpcGx5KGUpe2NvbnN0IHQ9bmV3IHRoaXMuY29uc3RydWN0b3I7cmV0dXJuIHRoaXMubXVsdGlwbHlUb1JlZihlLHQpLHR9Y29weUZyb20oZSl7ZS5jb3B5VG9BcnJheSh0aGlzLl9tKTtjb25zdCB0PWU7cmV0dXJuIHRoaXMudXBkYXRlRmxhZz10LnVwZGF0ZUZsYWcsdGhpcy5fdXBkYXRlSWRlbnRpdHlTdGF0dXModC5faXNJZGVudGl0eSx0Ll9pc0lkZW50aXR5RGlydHksdC5faXNJZGVudGl0eTN4Mix0Ll9pc0lkZW50aXR5M3gyRGlydHkpLHRoaXN9Y29weVRvQXJyYXkoZSx0PTApe2NvbnN0IGk9dGhpcy5fbTtyZXR1cm4gZVt0XT1pWzBdLGVbdCsxXT1pWzFdLGVbdCsyXT1pWzJdLGVbdCszXT1pWzNdLGVbdCs0XT1pWzRdLGVbdCs1XT1pWzVdLGVbdCs2XT1pWzZdLGVbdCs3XT1pWzddLGVbdCs4XT1pWzhdLGVbdCs5XT1pWzldLGVbdCsxMF09aVsxMF0sZVt0KzExXT1pWzExXSxlW3QrMTJdPWlbMTJdLGVbdCsxM109aVsxM10sZVt0KzE0XT1pWzE0XSxlW3QrMTVdPWlbMTVdLHRoaXN9bXVsdGlwbHlUb1JlZihlLHQpe3JldHVybiB0aGlzLl9pc0lkZW50aXR5Pyh0LmNvcHlGcm9tKGUpLHQpOmUuX2lzSWRlbnRpdHk/KHQuY29weUZyb20odGhpcyksdCk6KHRoaXMubXVsdGlwbHlUb0FycmF5KGUsdC5fbSwwKSx0Lm1hcmtBc1VwZGF0ZWQoKSx0KX1tdWx0aXBseVRvQXJyYXkoZSx0LGkpe2NvbnN0IHM9dGhpcy5fbSxyPWUubSxuPXNbMF0sYT1zWzFdLG89c1syXSxoPXNbM10sbD1zWzRdLHU9c1s1XSxkPXNbNl0sZj1zWzddLF89c1s4XSxFPXNbOV0sbT1zWzEwXSx2PXNbMTFdLFM9c1sxMl0seT1zWzEzXSxBPXNbMTRdLEM9c1sxNV0sYj1yWzBdLE09clsxXSxMPXJbMl0saz1yWzNdLHc9cls0XSxkZT1yWzVdLGNlPXJbNl0sc2U9cls3XSx0ZT1yWzhdLEZlPXJbOV0sd2U9clsxMF0sSGU9clsxMV0sS2U9clsxMl0sWWU9clsxM10scHQ9clsxNF0saHQ9clsxNV07cmV0dXJuIHRbaV09bipiK2EqdytvKnRlK2gqS2UsdFtpKzFdPW4qTSthKmRlK28qRmUraCpZZSx0W2krMl09bipMK2EqY2Urbyp3ZStoKnB0LHRbaSszXT1uKmsrYSpzZStvKkhlK2gqaHQsdFtpKzRdPWwqYit1KncrZCp0ZStmKktlLHRbaSs1XT1sKk0rdSpkZStkKkZlK2YqWWUsdFtpKzZdPWwqTCt1KmNlK2Qqd2UrZipwdCx0W2krN109bCprK3Uqc2UrZCpIZStmKmh0LHRbaSs4XT1fKmIrRSp3K20qdGUrdipLZSx0W2krOV09XypNK0UqZGUrbSpGZSt2KlllLHRbaSsxMF09XypMK0UqY2UrbSp3ZSt2KnB0LHRbaSsxMV09XyprK0Uqc2UrbSpIZSt2Kmh0LHRbaSsxMl09UypiK3kqdytBKnRlK0MqS2UsdFtpKzEzXT1TKk0reSpkZStBKkZlK0MqWWUsdFtpKzE0XT1TKkwreSpjZStBKndlK0MqcHQsdFtpKzE1XT1TKmsreSpzZStBKkhlK0MqaHQsdGhpc31lcXVhbHMoZSl7Y29uc3QgdD1lO2lmKCF0KXJldHVybiExO2lmKCh0aGlzLl9pc0lkZW50aXR5fHx0Ll9pc0lkZW50aXR5KSYmIXRoaXMuX2lzSWRlbnRpdHlEaXJ0eSYmIXQuX2lzSWRlbnRpdHlEaXJ0eSlyZXR1cm4gdGhpcy5faXNJZGVudGl0eSYmdC5faXNJZGVudGl0eTtjb25zdCBpPXRoaXMubSxzPXQubTtyZXR1cm4gaVswXT09PXNbMF0mJmlbMV09PT1zWzFdJiZpWzJdPT09c1syXSYmaVszXT09PXNbM10mJmlbNF09PT1zWzRdJiZpWzVdPT09c1s1XSYmaVs2XT09PXNbNl0mJmlbN109PT1zWzddJiZpWzhdPT09c1s4XSYmaVs5XT09PXNbOV0mJmlbMTBdPT09c1sxMF0mJmlbMTFdPT09c1sxMV0mJmlbMTJdPT09c1sxMl0mJmlbMTNdPT09c1sxM10mJmlbMTRdPT09c1sxNF0mJmlbMTVdPT09c1sxNV19Y2xvbmUoKXtjb25zdCBlPW5ldyB0aGlzLmNvbnN0cnVjdG9yO3JldHVybiBlLmNvcHlGcm9tKHRoaXMpLGV9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIk1hdHJpeCJ9Z2V0SGFzaENvZGUoKXtsZXQgZT1zdCh0aGlzLl9tWzBdKTtmb3IobGV0IHQ9MTt0PDE2O3QrKyllPWUqMzk3XnN0KHRoaXMuX21bdF0pO3JldHVybiBlfWRlY29tcG9zZVRvVHJhbnNmb3JtTm9kZShlKXtyZXR1cm4gZS5yb3RhdGlvblF1YXRlcm5pb249ZS5yb3RhdGlvblF1YXRlcm5pb258fG5ldyBaLHRoaXMuZGVjb21wb3NlKGUuc2NhbGluZyxlLnJvdGF0aW9uUXVhdGVybmlvbixlLnBvc2l0aW9uKX1kZWNvbXBvc2UoZSx0LGkscyl7aWYodGhpcy5faXNJZGVudGl0eSlyZXR1cm4gaSYmaS5zZXRBbGwoMCksZSYmZS5zZXRBbGwoMSksdCYmdC5jb3B5RnJvbUZsb2F0cygwLDAsMCwxKSwhMDtjb25zdCByPXRoaXMuX207aWYoaSYmaS5jb3B5RnJvbUZsb2F0cyhyWzEyXSxyWzEzXSxyWzE0XSksZT1lfHxLLlZlY3RvcjNbMF0sZS54PU1hdGguc3FydChyWzBdKnJbMF0rclsxXSpyWzFdK3JbMl0qclsyXSksZS55PU1hdGguc3FydChyWzRdKnJbNF0rcls1XSpyWzVdK3JbNl0qcls2XSksZS56PU1hdGguc3FydChyWzhdKnJbOF0rcls5XSpyWzldK3JbMTBdKnJbMTBdKSxzKXtjb25zdCBuPXMuc2NhbGluZy54PDA/LTE6MSxhPXMuc2NhbGluZy55PDA/LTE6MSxvPXMuc2NhbGluZy56PDA/LTE6MTtlLngqPW4sZS55Kj1hLGUueio9b31lbHNlIHRoaXMuZGV0ZXJtaW5hbnQoKTw9MCYmKGUueSo9LTEpO2lmKGUuX3g9PT0wfHxlLl95PT09MHx8ZS5fej09PTApcmV0dXJuIHQmJnQuY29weUZyb21GbG9hdHMoMCwwLDAsMSksITE7aWYodCl7Y29uc3Qgbj0xL2UuX3gsYT0xL2UuX3ksbz0xL2UuX3o7eC5Gcm9tVmFsdWVzVG9SZWYoclswXSpuLHJbMV0qbixyWzJdKm4sMCxyWzRdKmEscls1XSphLHJbNl0qYSwwLHJbOF0qbyxyWzldKm8sclsxMF0qbywwLDAsMCwwLDEsSy5NYXRyaXhbMF0pLFouRnJvbVJvdGF0aW9uTWF0cml4VG9SZWYoSy5NYXRyaXhbMF0sdCl9cmV0dXJuITB9Z2V0Um93KGUpe2lmKGU8MHx8ZT4zKXJldHVybiBudWxsO2NvbnN0IHQ9ZSo0O3JldHVybiBuZXcgQ2UodGhpcy5fbVt0KzBdLHRoaXMuX21bdCsxXSx0aGlzLl9tW3QrMl0sdGhpcy5fbVt0KzNdKX1nZXRSb3dUb1JlZihlLHQpe2lmKGU+PTAmJmU8Myl7Y29uc3QgaT1lKjQ7dC54PXRoaXMuX21baSswXSx0Lnk9dGhpcy5fbVtpKzFdLHQuej10aGlzLl9tW2krMl0sdC53PXRoaXMuX21baSszXX1yZXR1cm4gdH1zZXRSb3coZSx0KXtyZXR1cm4gdGhpcy5zZXRSb3dGcm9tRmxvYXRzKGUsdC54LHQueSx0LnosdC53KX10cmFuc3Bvc2UoKXtjb25zdCBlPW5ldyB0aGlzLmNvbnN0cnVjdG9yO3JldHVybiB4LlRyYW5zcG9zZVRvUmVmKHRoaXMsZSksZX10cmFuc3Bvc2VUb1JlZihlKXtyZXR1cm4geC5UcmFuc3Bvc2VUb1JlZih0aGlzLGUpLGV9c2V0Um93RnJvbUZsb2F0cyhlLHQsaSxzLHIpe2lmKGU8MHx8ZT4zKXJldHVybiB0aGlzO2NvbnN0IG49ZSo0O3JldHVybiB0aGlzLl9tW24rMF09dCx0aGlzLl9tW24rMV09aSx0aGlzLl9tW24rMl09cyx0aGlzLl9tW24rM109cix0aGlzLm1hcmtBc1VwZGF0ZWQoKSx0aGlzfXNjYWxlKGUpe2NvbnN0IHQ9bmV3IHRoaXMuY29uc3RydWN0b3I7cmV0dXJuIHRoaXMuc2NhbGVUb1JlZihlLHQpLHR9c2NhbGVUb1JlZihlLHQpe2ZvcihsZXQgaT0wO2k8MTY7aSsrKXQuX21baV09dGhpcy5fbVtpXSplO3JldHVybiB0Lm1hcmtBc1VwZGF0ZWQoKSx0fXNjYWxlQW5kQWRkVG9SZWYoZSx0KXtmb3IobGV0IGk9MDtpPDE2O2krKyl0Ll9tW2ldKz10aGlzLl9tW2ldKmU7cmV0dXJuIHQubWFya0FzVXBkYXRlZCgpLHR9dG9Ob3JtYWxNYXRyaXgoZSl7Y29uc3QgdD1LLk1hdHJpeFswXTt0aGlzLmludmVydFRvUmVmKHQpLHQudHJhbnNwb3NlVG9SZWYoZSk7Y29uc3QgaT1lLl9tO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZihpWzBdLGlbMV0saVsyXSwwLGlbNF0saVs1XSxpWzZdLDAsaVs4XSxpWzldLGlbMTBdLDAsMCwwLDAsMSxlKSxlfWdldFJvdGF0aW9uTWF0cml4KCl7Y29uc3QgZT1uZXcgdGhpcy5jb25zdHJ1Y3RvcjtyZXR1cm4gdGhpcy5nZXRSb3RhdGlvbk1hdHJpeFRvUmVmKGUpLGV9Z2V0Um90YXRpb25NYXRyaXhUb1JlZihlKXtjb25zdCB0PUsuVmVjdG9yM1swXTtpZighdGhpcy5kZWNvbXBvc2UodCkpcmV0dXJuIHguSWRlbnRpdHlUb1JlZihlKSxlO2NvbnN0IGk9dGhpcy5fbSxzPTEvdC5feCxyPTEvdC5feSxuPTEvdC5fejtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoaVswXSpzLGlbMV0qcyxpWzJdKnMsMCxpWzRdKnIsaVs1XSpyLGlbNl0qciwwLGlbOF0qbixpWzldKm4saVsxMF0qbiwwLDAsMCwwLDEsZSksZX10b2dnbGVNb2RlbE1hdHJpeEhhbmRJblBsYWNlKCl7Y29uc3QgZT10aGlzLl9tO3JldHVybiBlWzJdKj0tMSxlWzZdKj0tMSxlWzhdKj0tMSxlWzldKj0tMSxlWzE0XSo9LTEsdGhpcy5tYXJrQXNVcGRhdGVkKCksdGhpc310b2dnbGVQcm9qZWN0aW9uTWF0cml4SGFuZEluUGxhY2UoKXtjb25zdCBlPXRoaXMuX207cmV0dXJuIGVbOF0qPS0xLGVbOV0qPS0xLGVbMTBdKj0tMSxlWzExXSo9LTEsdGhpcy5tYXJrQXNVcGRhdGVkKCksdGhpc31zdGF0aWMgRnJvbUFycmF5KGUsdD0wKXtjb25zdCBpPW5ldyB4O3JldHVybiB4LkZyb21BcnJheVRvUmVmKGUsdCxpKSxpfXN0YXRpYyBGcm9tQXJyYXlUb1JlZihlLHQsaSl7Zm9yKGxldCBzPTA7czwxNjtzKyspaS5fbVtzXT1lW3MrdF07cmV0dXJuIGkubWFya0FzVXBkYXRlZCgpLGl9c3RhdGljIEZyb21GbG9hdDMyQXJyYXlUb1JlZlNjYWxlZChlLHQsaSxzKXtmb3IobGV0IHI9MDtyPDE2O3IrKylzLl9tW3JdPWVbcit0XSppO3JldHVybiBzLm1hcmtBc1VwZGF0ZWQoKSxzfXN0YXRpYyBnZXQgSWRlbnRpdHlSZWFkT25seSgpe3JldHVybiB4Ll9JZGVudGl0eVJlYWRPbmx5fXN0YXRpYyBGcm9tVmFsdWVzVG9SZWYoZSx0LGkscyxyLG4sYSxvLGgsbCx1LGQsZixfLEUsbSx2KXtjb25zdCBTPXYuX207U1swXT1lLFNbMV09dCxTWzJdPWksU1szXT1zLFNbNF09cixTWzVdPW4sU1s2XT1hLFNbN109byxTWzhdPWgsU1s5XT1sLFNbMTBdPXUsU1sxMV09ZCxTWzEyXT1mLFNbMTNdPV8sU1sxNF09RSxTWzE1XT1tLHYubWFya0FzVXBkYXRlZCgpfXN0YXRpYyBGcm9tVmFsdWVzKGUsdCxpLHMscixuLGEsbyxoLGwsdSxkLGYsXyxFLG0pe2NvbnN0IHY9bmV3IHgsUz12Ll9tO3JldHVybiBTWzBdPWUsU1sxXT10LFNbMl09aSxTWzNdPXMsU1s0XT1yLFNbNV09bixTWzZdPWEsU1s3XT1vLFNbOF09aCxTWzldPWwsU1sxMF09dSxTWzExXT1kLFNbMTJdPWYsU1sxM109XyxTWzE0XT1FLFNbMTVdPW0sdi5tYXJrQXNVcGRhdGVkKCksdn1zdGF0aWMgQ29tcG9zZShlLHQsaSl7Y29uc3Qgcz1uZXcgeDtyZXR1cm4geC5Db21wb3NlVG9SZWYoZSx0LGkscyksc31zdGF0aWMgQ29tcG9zZVRvUmVmKGUsdCxpLHMpe2NvbnN0IHI9cy5fbSxuPXQuX3gsYT10Ll95LG89dC5feixoPXQuX3csbD1uK24sdT1hK2EsZD1vK28sZj1uKmwsXz1uKnUsRT1uKmQsbT1hKnUsdj1hKmQsUz1vKmQseT1oKmwsQT1oKnUsQz1oKmQsYj1lLl94LE09ZS5feSxMPWUuX3o7cmV0dXJuIHJbMF09KDEtKG0rUykpKmIsclsxXT0oXytDKSpiLHJbMl09KEUtQSkqYixyWzNdPTAscls0XT0oXy1DKSpNLHJbNV09KDEtKGYrUykpKk0scls2XT0odit5KSpNLHJbN109MCxyWzhdPShFK0EpKkwscls5XT0odi15KSpMLHJbMTBdPSgxLShmK20pKSpMLHJbMTFdPTAsclsxMl09aS5feCxyWzEzXT1pLl95LHJbMTRdPWkuX3osclsxNV09MSxzLm1hcmtBc1VwZGF0ZWQoKSxzfXN0YXRpYyBJZGVudGl0eSgpe2NvbnN0IGU9eC5Gcm9tVmFsdWVzKDEsMCwwLDAsMCwxLDAsMCwwLDAsMSwwLDAsMCwwLDEpO3JldHVybiBlLl91cGRhdGVJZGVudGl0eVN0YXR1cyghMCksZX1zdGF0aWMgSWRlbnRpdHlUb1JlZihlKXtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoMSwwLDAsMCwwLDEsMCwwLDAsMCwxLDAsMCwwLDAsMSxlKSxlLl91cGRhdGVJZGVudGl0eVN0YXR1cyghMCksZX1zdGF0aWMgWmVybygpe2NvbnN0IGU9eC5Gcm9tVmFsdWVzKDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDApO3JldHVybiBlLl91cGRhdGVJZGVudGl0eVN0YXR1cyghMSksZX1zdGF0aWMgUm90YXRpb25YKGUpe2NvbnN0IHQ9bmV3IHg7cmV0dXJuIHguUm90YXRpb25YVG9SZWYoZSx0KSx0fXN0YXRpYyBJbnZlcnQoZSl7Y29uc3QgdD1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gZS5pbnZlcnRUb1JlZih0KSx0fXN0YXRpYyBSb3RhdGlvblhUb1JlZihlLHQpe2NvbnN0IGk9TWF0aC5zaW4oZSkscz1NYXRoLmNvcyhlKTtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoMSwwLDAsMCwwLHMsaSwwLDAsLWkscywwLDAsMCwwLDEsdCksdC5fdXBkYXRlSWRlbnRpdHlTdGF0dXMocz09PTEmJmk9PT0wKSx0fXN0YXRpYyBSb3RhdGlvblkoZSl7Y29uc3QgdD1uZXcgeDtyZXR1cm4geC5Sb3RhdGlvbllUb1JlZihlLHQpLHR9c3RhdGljIFJvdGF0aW9uWVRvUmVmKGUsdCl7Y29uc3QgaT1NYXRoLnNpbihlKSxzPU1hdGguY29zKGUpO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZihzLDAsLWksMCwwLDEsMCwwLGksMCxzLDAsMCwwLDAsMSx0KSx0Ll91cGRhdGVJZGVudGl0eVN0YXR1cyhzPT09MSYmaT09PTApLHR9c3RhdGljIFJvdGF0aW9uWihlKXtjb25zdCB0PW5ldyB4O3JldHVybiB4LlJvdGF0aW9uWlRvUmVmKGUsdCksdH1zdGF0aWMgUm90YXRpb25aVG9SZWYoZSx0KXtjb25zdCBpPU1hdGguc2luKGUpLHM9TWF0aC5jb3MoZSk7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKHMsaSwwLDAsLWkscywwLDAsMCwwLDEsMCwwLDAsMCwxLHQpLHQuX3VwZGF0ZUlkZW50aXR5U3RhdHVzKHM9PT0xJiZpPT09MCksdH1zdGF0aWMgUm90YXRpb25BeGlzKGUsdCl7Y29uc3QgaT1uZXcgeDtyZXR1cm4geC5Sb3RhdGlvbkF4aXNUb1JlZihlLHQsaSksaX1zdGF0aWMgUm90YXRpb25BeGlzVG9SZWYoZSx0LGkpe2NvbnN0IHM9TWF0aC5zaW4oLXQpLHI9TWF0aC5jb3MoLXQpLG49MS1yO2Uubm9ybWFsaXplKCk7Y29uc3QgYT1pLl9tO3JldHVybiBhWzBdPWUuX3gqZS5feCpuK3IsYVsxXT1lLl94KmUuX3kqbi1lLl96KnMsYVsyXT1lLl94KmUuX3oqbitlLl95KnMsYVszXT0wLGFbNF09ZS5feSplLl94Km4rZS5feipzLGFbNV09ZS5feSplLl95Km4rcixhWzZdPWUuX3kqZS5feipuLWUuX3gqcyxhWzddPTAsYVs4XT1lLl96KmUuX3gqbi1lLl95KnMsYVs5XT1lLl96KmUuX3kqbitlLl94KnMsYVsxMF09ZS5feiplLl96Km4rcixhWzExXT0wLGFbMTJdPTAsYVsxM109MCxhWzE0XT0wLGFbMTVdPTEsaS5tYXJrQXNVcGRhdGVkKCksaX1zdGF0aWMgUm90YXRpb25BbGlnblRvUmVmKGUsdCxpKXtjb25zdCBzPXAuRG90KHQsZSkscj1pLl9tO2lmKHM8LTEreGUpclswXT0tMSxyWzFdPTAsclsyXT0wLHJbM109MCxyWzRdPTAscls1XT0tMSxyWzZdPTAscls3XT0wLHJbOF09MCxyWzldPTAsclsxMF09MSxyWzExXT0wO2Vsc2V7Y29uc3Qgbj1wLkNyb3NzKHQsZSksYT0xLygxK3MpO3JbMF09bi5feCpuLl94KmErcyxyWzFdPW4uX3kqbi5feCphLW4uX3osclsyXT1uLl96Km4uX3gqYStuLl95LHJbM109MCxyWzRdPW4uX3gqbi5feSphK24uX3oscls1XT1uLl95Km4uX3kqYStzLHJbNl09bi5feipuLl95KmEtbi5feCxyWzddPTAscls4XT1uLl94Km4uX3oqYS1uLl95LHJbOV09bi5feSpuLl96KmErbi5feCxyWzEwXT1uLl96Km4uX3oqYStzLHJbMTFdPTB9cmV0dXJuIHJbMTJdPTAsclsxM109MCxyWzE0XT0wLHJbMTVdPTEsaS5tYXJrQXNVcGRhdGVkKCksaX1zdGF0aWMgUm90YXRpb25ZYXdQaXRjaFJvbGwoZSx0LGkpe2NvbnN0IHM9bmV3IHg7cmV0dXJuIHguUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBSb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKGUsdCxpLHMpe3JldHVybiBaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYoZSx0LGksSy5RdWF0ZXJuaW9uWzBdKSxLLlF1YXRlcm5pb25bMF0udG9Sb3RhdGlvbk1hdHJpeChzKSxzfXN0YXRpYyBTY2FsaW5nKGUsdCxpKXtjb25zdCBzPW5ldyB4O3JldHVybiB4LlNjYWxpbmdUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBTY2FsaW5nVG9SZWYoZSx0LGkscyl7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKGUsMCwwLDAsMCx0LDAsMCwwLDAsaSwwLDAsMCwwLDEscykscy5fdXBkYXRlSWRlbnRpdHlTdGF0dXMoZT09PTEmJnQ9PT0xJiZpPT09MSksc31zdGF0aWMgVHJhbnNsYXRpb24oZSx0LGkpe2NvbnN0IHM9bmV3IHg7cmV0dXJuIHguVHJhbnNsYXRpb25Ub1JlZihlLHQsaSxzKSxzfXN0YXRpYyBUcmFuc2xhdGlvblRvUmVmKGUsdCxpLHMpe3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZigxLDAsMCwwLDAsMSwwLDAsMCwwLDEsMCxlLHQsaSwxLHMpLHMuX3VwZGF0ZUlkZW50aXR5U3RhdHVzKGU9PT0wJiZ0PT09MCYmaT09PTApLHN9c3RhdGljIExlcnAoZSx0LGkpe2NvbnN0IHM9bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIHguTGVycFRvUmVmKGUsdCxpLHMpLHN9c3RhdGljIExlcnBUb1JlZihlLHQsaSxzKXtjb25zdCByPXMuX20sbj1lLm0sYT10Lm07Zm9yKGxldCBvPTA7bzwxNjtvKyspcltvXT1uW29dKigxLWkpK2Fbb10qaTtyZXR1cm4gcy5tYXJrQXNVcGRhdGVkKCksc31zdGF0aWMgRGVjb21wb3NlTGVycChlLHQsaSl7Y29uc3Qgcz1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4geC5EZWNvbXBvc2VMZXJwVG9SZWYoZSx0LGkscyksc31zdGF0aWMgRGVjb21wb3NlTGVycFRvUmVmKGUsdCxpLHMpe2NvbnN0IHI9Sy5WZWN0b3IzWzBdLG49Sy5RdWF0ZXJuaW9uWzBdLGE9Sy5WZWN0b3IzWzFdO2UuZGVjb21wb3NlKHIsbixhKTtjb25zdCBvPUsuVmVjdG9yM1syXSxoPUsuUXVhdGVybmlvblsxXSxsPUsuVmVjdG9yM1szXTt0LmRlY29tcG9zZShvLGgsbCk7Y29uc3QgdT1LLlZlY3RvcjNbNF07cC5MZXJwVG9SZWYocixvLGksdSk7Y29uc3QgZD1LLlF1YXRlcm5pb25bMl07Wi5TbGVycFRvUmVmKG4saCxpLGQpO2NvbnN0IGY9Sy5WZWN0b3IzWzVdO3JldHVybiBwLkxlcnBUb1JlZihhLGwsaSxmKSx4LkNvbXBvc2VUb1JlZih1LGQsZixzKSxzfXN0YXRpYyBMb29rQXRMSChlLHQsaSl7Y29uc3Qgcz1uZXcgeDtyZXR1cm4geC5Mb29rQXRMSFRvUmVmKGUsdCxpLHMpLHN9c3RhdGljIExvb2tBdExIVG9SZWYoZSx0LGkscyl7Y29uc3Qgcj1LLlZlY3RvcjNbMF0sbj1LLlZlY3RvcjNbMV0sYT1LLlZlY3RvcjNbMl07dC5zdWJ0cmFjdFRvUmVmKGUsYSksYS5ub3JtYWxpemUoKSxwLkNyb3NzVG9SZWYoaSxhLHIpO2NvbnN0IG89ci5sZW5ndGhTcXVhcmVkKCk7bz09PTA/ci54PTE6ci5ub3JtYWxpemVGcm9tTGVuZ3RoKE1hdGguc3FydChvKSkscC5Dcm9zc1RvUmVmKGEscixuKSxuLm5vcm1hbGl6ZSgpO2NvbnN0IGg9LXAuRG90KHIsZSksbD0tcC5Eb3QobixlKSx1PS1wLkRvdChhLGUpO3guRnJvbVZhbHVlc1RvUmVmKHIuX3gsbi5feCxhLl94LDAsci5feSxuLl95LGEuX3ksMCxyLl96LG4uX3osYS5feiwwLGgsbCx1LDEscyl9c3RhdGljIExvb2tBdFJIKGUsdCxpKXtjb25zdCBzPW5ldyB4O3JldHVybiB4Lkxvb2tBdFJIVG9SZWYoZSx0LGkscyksc31zdGF0aWMgTG9va0F0UkhUb1JlZihlLHQsaSxzKXtjb25zdCByPUsuVmVjdG9yM1swXSxuPUsuVmVjdG9yM1sxXSxhPUsuVmVjdG9yM1syXTtlLnN1YnRyYWN0VG9SZWYodCxhKSxhLm5vcm1hbGl6ZSgpLHAuQ3Jvc3NUb1JlZihpLGEscik7Y29uc3Qgbz1yLmxlbmd0aFNxdWFyZWQoKTtvPT09MD9yLng9MTpyLm5vcm1hbGl6ZUZyb21MZW5ndGgoTWF0aC5zcXJ0KG8pKSxwLkNyb3NzVG9SZWYoYSxyLG4pLG4ubm9ybWFsaXplKCk7Y29uc3QgaD0tcC5Eb3QocixlKSxsPS1wLkRvdChuLGUpLHU9LXAuRG90KGEsZSk7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKHIuX3gsbi5feCxhLl94LDAsci5feSxuLl95LGEuX3ksMCxyLl96LG4uX3osYS5feiwwLGgsbCx1LDEscyksc31zdGF0aWMgTG9va0RpcmVjdGlvbkxIKGUsdCl7Y29uc3QgaT1uZXcgeDtyZXR1cm4geC5Mb29rRGlyZWN0aW9uTEhUb1JlZihlLHQsaSksaX1zdGF0aWMgTG9va0RpcmVjdGlvbkxIVG9SZWYoZSx0LGkpe2NvbnN0IHM9Sy5WZWN0b3IzWzBdO3MuY29weUZyb20oZSkscy5zY2FsZUluUGxhY2UoLTEpO2NvbnN0IHI9Sy5WZWN0b3IzWzFdO3JldHVybiBwLkNyb3NzVG9SZWYodCxzLHIpLHguRnJvbVZhbHVlc1RvUmVmKHIuX3gsci5feSxyLl96LDAsdC5feCx0Ll95LHQuX3osMCxzLl94LHMuX3kscy5feiwwLDAsMCwwLDEsaSksaX1zdGF0aWMgTG9va0RpcmVjdGlvblJIKGUsdCl7Y29uc3QgaT1uZXcgeDtyZXR1cm4geC5Mb29rRGlyZWN0aW9uUkhUb1JlZihlLHQsaSksaX1zdGF0aWMgTG9va0RpcmVjdGlvblJIVG9SZWYoZSx0LGkpe2NvbnN0IHM9Sy5WZWN0b3IzWzJdO3JldHVybiBwLkNyb3NzVG9SZWYodCxlLHMpLHguRnJvbVZhbHVlc1RvUmVmKHMuX3gscy5feSxzLl96LDAsdC5feCx0Ll95LHQuX3osMCxlLl94LGUuX3ksZS5feiwwLDAsMCwwLDEsaSksaX1zdGF0aWMgT3J0aG9MSChlLHQsaSxzLHIpe2NvbnN0IG49bmV3IHg7cmV0dXJuIHguT3J0aG9MSFRvUmVmKGUsdCxpLHMsbixyKSxufXN0YXRpYyBPcnRob0xIVG9SZWYoZSx0LGkscyxyLG4pe2NvbnN0IGE9aSxvPXMsaD0yL2UsbD0yL3QsdT0yLyhvLWEpLGQ9LShvK2EpLyhvLWEpO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZihoLDAsMCwwLDAsbCwwLDAsMCwwLHUsMCwwLDAsZCwxLHIpLG4mJnIubXVsdGlwbHlUb1JlZihxdCxyKSxyLl91cGRhdGVJZGVudGl0eVN0YXR1cyhoPT09MSYmbD09PTEmJnU9PT0xJiZkPT09MCkscn1zdGF0aWMgT3J0aG9PZmZDZW50ZXJMSChlLHQsaSxzLHIsbixhKXtjb25zdCBvPW5ldyB4O3JldHVybiB4Lk9ydGhvT2ZmQ2VudGVyTEhUb1JlZihlLHQsaSxzLHIsbixvLGEpLG99c3RhdGljIE9ydGhvT2ZmQ2VudGVyTEhUb1JlZihlLHQsaSxzLHIsbixhLG8pe2NvbnN0IGg9cixsPW4sdT0yLyh0LWUpLGQ9Mi8ocy1pKSxmPTIvKGwtaCksXz0tKGwraCkvKGwtaCksRT0oZSt0KS8oZS10KSxtPShzK2kpLyhpLXMpO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZih1LDAsMCwwLDAsZCwwLDAsMCwwLGYsMCxFLG0sXywxLGEpLG8mJmEubXVsdGlwbHlUb1JlZihxdCxhKSxhLm1hcmtBc1VwZGF0ZWQoKSxhfXN0YXRpYyBPcnRob09mZkNlbnRlclJIKGUsdCxpLHMscixuLGEpe2NvbnN0IG89bmV3IHg7cmV0dXJuIHguT3J0aG9PZmZDZW50ZXJSSFRvUmVmKGUsdCxpLHMscixuLG8sYSksb31zdGF0aWMgT3J0aG9PZmZDZW50ZXJSSFRvUmVmKGUsdCxpLHMscixuLGEsbyl7cmV0dXJuIHguT3J0aG9PZmZDZW50ZXJMSFRvUmVmKGUsdCxpLHMscixuLGEsbyksYS5fbVsxMF0qPS0xLGF9c3RhdGljIFBlcnNwZWN0aXZlTEgoZSx0LGkscyxyLG49MCl7Y29uc3QgYT1uZXcgeCxvPWksaD1zLGw9MipvL2UsdT0yKm8vdCxkPShoK28pLyhoLW8pLGY9LTIqaCpvLyhoLW8pLF89TWF0aC50YW4obik7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKGwsMCwwLDAsMCx1LDAsXywwLDAsZCwxLDAsMCxmLDAsYSksciYmYS5tdWx0aXBseVRvUmVmKHF0LGEpLGEuX3VwZGF0ZUlkZW50aXR5U3RhdHVzKCExKSxhfXN0YXRpYyBQZXJzcGVjdGl2ZUZvdkxIKGUsdCxpLHMscixuPTAsYT0hMSl7Y29uc3Qgbz1uZXcgeDtyZXR1cm4geC5QZXJzcGVjdGl2ZUZvdkxIVG9SZWYoZSx0LGkscyxvLCEwLHIsbixhKSxvfXN0YXRpYyBQZXJzcGVjdGl2ZUZvdkxIVG9SZWYoZSx0LGkscyxyLG49ITAsYSxvPTAsaD0hMSl7Y29uc3QgbD1pLHU9cyxkPTEvTWF0aC50YW4oZSouNSksZj1uP2QvdDpkLF89bj9kOmQqdCxFPWgmJmw9PT0wPy0xOnUhPT0wPyh1K2wpLyh1LWwpOjEsbT1oJiZsPT09MD8yKnU6dSE9PTA/LTIqdSpsLyh1LWwpOi0yKmwsdj1NYXRoLnRhbihvKTtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoZiwwLDAsMCwwLF8sMCx2LDAsMCxFLDEsMCwwLG0sMCxyKSxhJiZyLm11bHRpcGx5VG9SZWYocXQsciksci5fdXBkYXRlSWRlbnRpdHlTdGF0dXMoITEpLHJ9c3RhdGljIFBlcnNwZWN0aXZlRm92UmV2ZXJzZUxIVG9SZWYoZSx0LGkscyxyLG49ITAsYSxvPTApe2NvbnN0IGg9MS9NYXRoLnRhbihlKi41KSxsPW4/aC90OmgsdT1uP2g6aCp0LGQ9TWF0aC50YW4obyk7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKGwsMCwwLDAsMCx1LDAsZCwwLDAsLWksMSwwLDAsMSwwLHIpLGEmJnIubXVsdGlwbHlUb1JlZihxdCxyKSxyLl91cGRhdGVJZGVudGl0eVN0YXR1cyghMSkscn1zdGF0aWMgUGVyc3BlY3RpdmVGb3ZSSChlLHQsaSxzLHIsbj0wLGE9ITEpe2NvbnN0IG89bmV3IHg7cmV0dXJuIHguUGVyc3BlY3RpdmVGb3ZSSFRvUmVmKGUsdCxpLHMsbywhMCxyLG4sYSksb31zdGF0aWMgUGVyc3BlY3RpdmVGb3ZSSFRvUmVmKGUsdCxpLHMscixuPSEwLGEsbz0wLGg9ITEpe2NvbnN0IGw9aSx1PXMsZD0xL01hdGgudGFuKGUqLjUpLGY9bj9kL3Q6ZCxfPW4/ZDpkKnQsRT1oJiZsPT09MD8xOnUhPT0wPy0odStsKS8odS1sKTotMSxtPWgmJmw9PT0wPzIqdTp1IT09MD8tMip1KmwvKHUtbCk6LTIqbCx2PU1hdGgudGFuKG8pO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZihmLDAsMCwwLDAsXywwLHYsMCwwLEUsLTEsMCwwLG0sMCxyKSxhJiZyLm11bHRpcGx5VG9SZWYocXQsciksci5fdXBkYXRlSWRlbnRpdHlTdGF0dXMoITEpLHJ9c3RhdGljIFBlcnNwZWN0aXZlRm92UmV2ZXJzZVJIVG9SZWYoZSx0LGkscyxyLG49ITAsYSxvPTApe2NvbnN0IGg9MS9NYXRoLnRhbihlKi41KSxsPW4/aC90OmgsdT1uP2g6aCp0LGQ9TWF0aC50YW4obyk7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKGwsMCwwLDAsMCx1LDAsZCwwLDAsLWksLTEsMCwwLC0xLDAsciksYSYmci5tdWx0aXBseVRvUmVmKHF0LHIpLHIuX3VwZGF0ZUlkZW50aXR5U3RhdHVzKCExKSxyfXN0YXRpYyBQZXJzcGVjdGl2ZUZvdldlYlZSVG9SZWYoZSx0LGkscyxyPSExLG4sYT0wKXtjb25zdCBvPXI/LTE6MSxoPU1hdGgudGFuKGUudXBEZWdyZWVzKk1hdGguUEkvMTgwKSxsPU1hdGgudGFuKGUuZG93bkRlZ3JlZXMqTWF0aC5QSS8xODApLHU9TWF0aC50YW4oZS5sZWZ0RGVncmVlcypNYXRoLlBJLzE4MCksZD1NYXRoLnRhbihlLnJpZ2h0RGVncmVlcypNYXRoLlBJLzE4MCksZj0yLyh1K2QpLF89Mi8oaCtsKSxFPU1hdGgudGFuKGEpLG09cy5fbTtyZXR1cm4gbVswXT1mLG1bMV09bVsyXT1tWzNdPW1bNF09MCxtWzVdPV8sbVs2XT0wLG1bN109RSxtWzhdPSh1LWQpKmYqLjUsbVs5XT0tKChoLWwpKl8qLjUpLG1bMTBdPS1pLyh0LWkpLG1bMTFdPTEqbyxtWzEyXT1tWzEzXT1tWzE1XT0wLG1bMTRdPS0oMippKnQpLyhpLXQpLG4mJnMubXVsdGlwbHlUb1JlZihxdCxzKSxzLm1hcmtBc1VwZGF0ZWQoKSxzfXN0YXRpYyBHZXRGaW5hbE1hdHJpeChlLHQsaSxzLHIsbil7Y29uc3QgYT1lLndpZHRoLG89ZS5oZWlnaHQsaD1lLngsbD1lLnksdT14LkZyb21WYWx1ZXMoYS8yLDAsMCwwLDAsLW8vMiwwLDAsMCwwLG4tciwwLGgrYS8yLG8vMitsLHIsMSksZD1uZXcgdC5jb25zdHJ1Y3RvcjtyZXR1cm4gdC5tdWx0aXBseVRvUmVmKGksZCksZC5tdWx0aXBseVRvUmVmKHMsZCksZC5tdWx0aXBseVRvUmVmKHUsZCl9c3RhdGljIEdldEFzTWF0cml4MngyKGUpe2NvbnN0IHQ9ZS5tLGk9W3RbMF0sdFsxXSx0WzRdLHRbNV1dO3JldHVybiBVZS5NYXRyaXhVc2U2NEJpdHM/aTpuZXcgRmxvYXQzMkFycmF5KGkpfXN0YXRpYyBHZXRBc01hdHJpeDN4MyhlKXtjb25zdCB0PWUubSxpPVt0WzBdLHRbMV0sdFsyXSx0WzRdLHRbNV0sdFs2XSx0WzhdLHRbOV0sdFsxMF1dO3JldHVybiBVZS5NYXRyaXhVc2U2NEJpdHM/aTpuZXcgRmxvYXQzMkFycmF5KGkpfXN0YXRpYyBUcmFuc3Bvc2UoZSl7Y29uc3QgdD1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4geC5UcmFuc3Bvc2VUb1JlZihlLHQpLHR9c3RhdGljIFRyYW5zcG9zZVRvUmVmKGUsdCl7Y29uc3QgaT10Ll9tLHM9ZS5tO3JldHVybiBpWzBdPXNbMF0saVsxXT1zWzRdLGlbMl09c1s4XSxpWzNdPXNbMTJdLGlbNF09c1sxXSxpWzVdPXNbNV0saVs2XT1zWzldLGlbN109c1sxM10saVs4XT1zWzJdLGlbOV09c1s2XSxpWzEwXT1zWzEwXSxpWzExXT1zWzE0XSxpWzEyXT1zWzNdLGlbMTNdPXNbN10saVsxNF09c1sxMV0saVsxNV09c1sxNV0sdC5tYXJrQXNVcGRhdGVkKCksdC5fdXBkYXRlSWRlbnRpdHlTdGF0dXMoZS5faXNJZGVudGl0eSxlLl9pc0lkZW50aXR5RGlydHkpLHR9c3RhdGljIFJlZmxlY3Rpb24oZSl7Y29uc3QgdD1uZXcgeDtyZXR1cm4geC5SZWZsZWN0aW9uVG9SZWYoZSx0KSx0fXN0YXRpYyBSZWZsZWN0aW9uVG9SZWYoZSx0KXtlLm5vcm1hbGl6ZSgpO2NvbnN0IGk9ZS5ub3JtYWwueCxzPWUubm9ybWFsLnkscj1lLm5vcm1hbC56LG49LTIqaSxhPS0yKnMsbz0tMipyO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZihuKmkrMSxhKmksbyppLDAsbipzLGEqcysxLG8qcywwLG4qcixhKnIsbypyKzEsMCxuKmUuZCxhKmUuZCxvKmUuZCwxLHQpLHR9c3RhdGljIEZyb21YWVpBeGVzVG9SZWYoZSx0LGkscyl7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKGUuX3gsZS5feSxlLl96LDAsdC5feCx0Ll95LHQuX3osMCxpLl94LGkuX3ksaS5feiwwLDAsMCwwLDEscyksc31zdGF0aWMgRnJvbVF1YXRlcm5pb25Ub1JlZihlLHQpe2NvbnN0IGk9ZS5feCplLl94LHM9ZS5feSplLl95LHI9ZS5feiplLl96LG49ZS5feCplLl95LGE9ZS5feiplLl93LG89ZS5feiplLl94LGg9ZS5feSplLl93LGw9ZS5feSplLl96LHU9ZS5feCplLl93O3JldHVybiB0Ll9tWzBdPTEtMioocytyKSx0Ll9tWzFdPTIqKG4rYSksdC5fbVsyXT0yKihvLWgpLHQuX21bM109MCx0Ll9tWzRdPTIqKG4tYSksdC5fbVs1XT0xLTIqKHIraSksdC5fbVs2XT0yKihsK3UpLHQuX21bN109MCx0Ll9tWzhdPTIqKG8raCksdC5fbVs5XT0yKihsLXUpLHQuX21bMTBdPTEtMioocytpKSx0Ll9tWzExXT0wLHQuX21bMTJdPTAsdC5fbVsxM109MCx0Ll9tWzE0XT0wLHQuX21bMTVdPTEsdC5tYXJrQXNVcGRhdGVkKCksdH19eC5fVXBkYXRlRmxhZ1NlZWQ9MCx4Ll9JZGVudGl0eVJlYWRPbmx5PXguSWRlbnRpdHkoKTtjbGFzcyBLe31LLlZlY3RvcjM9QmUuQnVpbGRUdXBsZSgxMSxwLlplcm8pLEsuTWF0cml4PUJlLkJ1aWxkVHVwbGUoMix4LklkZW50aXR5KSxLLlF1YXRlcm5pb249QmUuQnVpbGRUdXBsZSgzLFouWmVybyk7Y2xhc3MgRHt9RC5WZWN0b3IyPUJlLkJ1aWxkVHVwbGUoMyx2ZS5aZXJvKSxELlZlY3RvcjM9QmUuQnVpbGRUdXBsZSgxMyxwLlplcm8pLEQuVmVjdG9yND1CZS5CdWlsZFR1cGxlKDMsQ2UuWmVybyksRC5RdWF0ZXJuaW9uPUJlLkJ1aWxkVHVwbGUoMixaLlplcm8pLEQuTWF0cml4PUJlLkJ1aWxkVHVwbGUoOCx4LklkZW50aXR5KSxpdCgiQkFCWUxPTi5WZWN0b3IyIix2ZSksaXQoIkJBQllMT04uVmVjdG9yMyIscCksaXQoIkJBQllMT04uVmVjdG9yNCIsQ2UpLGl0KCJCQUJZTE9OLk1hdHJpeCIseCk7Y29uc3QgcXQ9eC5Gcm9tVmFsdWVzKDEsMCwwLDAsMCwxLDAsMCwwLDAsLjUsMCwwLDAsLjUsMSk7Y2xhc3MgS3J7Y29uc3RydWN0b3IoZSx0PSExLGkscyl7dGhpcy5pbml0aWFsaXplKGUsdCxpLHMpfWluaXRpYWxpemUoZSx0PSExLGkscyl7cmV0dXJuIHRoaXMubWFzaz1lLHRoaXMuc2tpcE5leHRPYnNlcnZlcnM9dCx0aGlzLnRhcmdldD1pLHRoaXMuY3VycmVudFRhcmdldD1zLHRoaXN9fWNsYXNzIFlye2NvbnN0cnVjdG9yKGUsdCxpPW51bGwpe3RoaXMuY2FsbGJhY2s9ZSx0aGlzLm1hc2s9dCx0aGlzLnNjb3BlPWksdGhpcy5fd2lsbEJlVW5yZWdpc3RlcmVkPSExLHRoaXMudW5yZWdpc3Rlck9uTmV4dENhbGw9ITF9fWNsYXNzIEZ7Y29uc3RydWN0b3IoZSl7dGhpcy5fb2JzZXJ2ZXJzPW5ldyBBcnJheSx0aGlzLl9udW1PYnNlcnZlcnNNYXJrZWRBc0RlbGV0ZWQ9MCx0aGlzLl9ldmVudFN0YXRlPW5ldyBLcigwKSxlJiYodGhpcy5fb25PYnNlcnZlckFkZGVkPWUpfXN0YXRpYyBGcm9tUHJvbWlzZShlLHQpe2NvbnN0IGk9bmV3IEY7cmV0dXJuIGUudGhlbihzPT57aS5ub3RpZnlPYnNlcnZlcnMocyl9KS5jYXRjaChzPT57aWYodCl0Lm5vdGlmeU9ic2VydmVycyhzKTtlbHNlIHRocm93IHN9KSxpfWdldCBvYnNlcnZlcnMoKXtyZXR1cm4gdGhpcy5fb2JzZXJ2ZXJzfWFkZChlLHQ9LTEsaT0hMSxzPW51bGwscj0hMSl7aWYoIWUpcmV0dXJuIG51bGw7Y29uc3Qgbj1uZXcgWXIoZSx0LHMpO3JldHVybiBuLnVucmVnaXN0ZXJPbk5leHRDYWxsPXIsaT90aGlzLl9vYnNlcnZlcnMudW5zaGlmdChuKTp0aGlzLl9vYnNlcnZlcnMucHVzaChuKSx0aGlzLl9vbk9ic2VydmVyQWRkZWQmJnRoaXMuX29uT2JzZXJ2ZXJBZGRlZChuKSxufWFkZE9uY2UoZSl7cmV0dXJuIHRoaXMuYWRkKGUsdm9pZCAwLHZvaWQgMCx2b2lkIDAsITApfXJlbW92ZShlKXtyZXR1cm4gZSYmdGhpcy5fb2JzZXJ2ZXJzLmluZGV4T2YoZSkhPT0tMT8odGhpcy5fZGVmZXJVbnJlZ2lzdGVyKGUpLCEwKTohMX1yZW1vdmVDYWxsYmFjayhlLHQpe2ZvcihsZXQgaT0wO2k8dGhpcy5fb2JzZXJ2ZXJzLmxlbmd0aDtpKyspe2NvbnN0IHM9dGhpcy5fb2JzZXJ2ZXJzW2ldO2lmKCFzLl93aWxsQmVVbnJlZ2lzdGVyZWQmJnMuY2FsbGJhY2s9PT1lJiYoIXR8fHQ9PT1zLnNjb3BlKSlyZXR1cm4gdGhpcy5fZGVmZXJVbnJlZ2lzdGVyKHMpLCEwfXJldHVybiExfV9kZWZlclVucmVnaXN0ZXIoZSl7dGhpcy5fbnVtT2JzZXJ2ZXJzTWFya2VkQXNEZWxldGVkKyssZS51bnJlZ2lzdGVyT25OZXh0Q2FsbD0hMSxlLl93aWxsQmVVbnJlZ2lzdGVyZWQ9ITAsc2V0VGltZW91dCgoKT0+e3RoaXMuX3JlbW92ZShlKX0sMCl9X3JlbW92ZShlKXtpZighZSlyZXR1cm4hMTtjb25zdCB0PXRoaXMuX29ic2VydmVycy5pbmRleE9mKGUpO3JldHVybiB0IT09LTE/KHRoaXMuX251bU9ic2VydmVyc01hcmtlZEFzRGVsZXRlZC0tLHRoaXMuX29ic2VydmVycy5zcGxpY2UodCwxKSwhMCk6ITF9bWFrZU9ic2VydmVyVG9wUHJpb3JpdHkoZSl7dGhpcy5fcmVtb3ZlKGUpLHRoaXMuX29ic2VydmVycy51bnNoaWZ0KGUpfW1ha2VPYnNlcnZlckJvdHRvbVByaW9yaXR5KGUpe3RoaXMuX3JlbW92ZShlKSx0aGlzLl9vYnNlcnZlcnMucHVzaChlKX1ub3RpZnlPYnNlcnZlcnMoZSx0PS0xLGkscyxyKXtpZighdGhpcy5fb2JzZXJ2ZXJzLmxlbmd0aClyZXR1cm4hMDtjb25zdCBuPXRoaXMuX2V2ZW50U3RhdGU7bi5tYXNrPXQsbi50YXJnZXQ9aSxuLmN1cnJlbnRUYXJnZXQ9cyxuLnNraXBOZXh0T2JzZXJ2ZXJzPSExLG4ubGFzdFJldHVyblZhbHVlPWUsbi51c2VySW5mbz1yO2Zvcihjb25zdCBhIG9mIHRoaXMuX29ic2VydmVycylpZighYS5fd2lsbEJlVW5yZWdpc3RlcmVkJiYoYS5tYXNrJnQmJihhLnVucmVnaXN0ZXJPbk5leHRDYWxsJiZ0aGlzLl9kZWZlclVucmVnaXN0ZXIoYSksYS5zY29wZT9uLmxhc3RSZXR1cm5WYWx1ZT1hLmNhbGxiYWNrLmFwcGx5KGEuc2NvcGUsW2Usbl0pOm4ubGFzdFJldHVyblZhbHVlPWEuY2FsbGJhY2soZSxuKSksbi5za2lwTmV4dE9ic2VydmVycykpcmV0dXJuITE7cmV0dXJuITB9bm90aWZ5T2JzZXJ2ZXIoZSx0LGk9LTEpe2lmKGUuX3dpbGxCZVVucmVnaXN0ZXJlZClyZXR1cm47Y29uc3Qgcz10aGlzLl9ldmVudFN0YXRlO3MubWFzaz1pLHMuc2tpcE5leHRPYnNlcnZlcnM9ITEsZS51bnJlZ2lzdGVyT25OZXh0Q2FsbCYmdGhpcy5fZGVmZXJVbnJlZ2lzdGVyKGUpLGUuY2FsbGJhY2sodCxzKX1oYXNPYnNlcnZlcnMoKXtyZXR1cm4gdGhpcy5fb2JzZXJ2ZXJzLmxlbmd0aC10aGlzLl9udW1PYnNlcnZlcnNNYXJrZWRBc0RlbGV0ZWQ+MH1jbGVhcigpe3RoaXMuX29ic2VydmVycz1uZXcgQXJyYXksdGhpcy5fb25PYnNlcnZlckFkZGVkPW51bGx9Y2xvbmUoKXtjb25zdCBlPW5ldyBGO3JldHVybiBlLl9vYnNlcnZlcnM9dGhpcy5fb2JzZXJ2ZXJzLnNsaWNlKDApLGV9aGFzU3BlY2lmaWNNYXNrKGU9LTEpe2Zvcihjb25zdCB0IG9mIHRoaXMuX29ic2VydmVycylpZih0Lm1hc2smZXx8dC5tYXNrPT09ZSlyZXR1cm4hMDtyZXR1cm4hMX19Y2xhc3MgWnJ7Y29uc3RydWN0b3IoKXt0aGlzLnNhbXBsaW5nTW9kZT0tMSx0aGlzLl91c2VNaXBNYXBzPSEwLHRoaXMuX2NhY2hlZFdyYXBVPW51bGwsdGhpcy5fY2FjaGVkV3JhcFY9bnVsbCx0aGlzLl9jYWNoZWRXcmFwUj1udWxsLHRoaXMuX2NhY2hlZEFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWw9bnVsbCx0aGlzLl9jb21wYXJpc29uRnVuY3Rpb249MH1nZXQgd3JhcFUoKXtyZXR1cm4gdGhpcy5fY2FjaGVkV3JhcFV9c2V0IHdyYXBVKGUpe3RoaXMuX2NhY2hlZFdyYXBVPWV9Z2V0IHdyYXBWKCl7cmV0dXJuIHRoaXMuX2NhY2hlZFdyYXBWfXNldCB3cmFwVihlKXt0aGlzLl9jYWNoZWRXcmFwVj1lfWdldCB3cmFwUigpe3JldHVybiB0aGlzLl9jYWNoZWRXcmFwUn1zZXQgd3JhcFIoZSl7dGhpcy5fY2FjaGVkV3JhcFI9ZX1nZXQgYW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbCgpe3JldHVybiB0aGlzLl9jYWNoZWRBbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsfXNldCBhbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsKGUpe3RoaXMuX2NhY2hlZEFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWw9ZX1nZXQgY29tcGFyaXNvbkZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbXBhcmlzb25GdW5jdGlvbn1zZXQgY29tcGFyaXNvbkZ1bmN0aW9uKGUpe3RoaXMuX2NvbXBhcmlzb25GdW5jdGlvbj1lfWdldCB1c2VNaXBNYXBzKCl7cmV0dXJuIHRoaXMuX3VzZU1pcE1hcHN9c2V0IHVzZU1pcE1hcHMoZSl7dGhpcy5fdXNlTWlwTWFwcz1lfXNldFBhcmFtZXRlcnMoZT0xLHQ9MSxpPTEscz0xLHI9MixuPTApe3JldHVybiB0aGlzLl9jYWNoZWRXcmFwVT1lLHRoaXMuX2NhY2hlZFdyYXBWPXQsdGhpcy5fY2FjaGVkV3JhcFI9aSx0aGlzLl9jYWNoZWRBbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsPXMsdGhpcy5zYW1wbGluZ01vZGU9cix0aGlzLl9jb21wYXJpc29uRnVuY3Rpb249bix0aGlzfWNvbXBhcmVTYW1wbGVyKGUpe3JldHVybiB0aGlzLl9jYWNoZWRXcmFwVT09PWUuX2NhY2hlZFdyYXBVJiZ0aGlzLl9jYWNoZWRXcmFwVj09PWUuX2NhY2hlZFdyYXBWJiZ0aGlzLl9jYWNoZWRXcmFwUj09PWUuX2NhY2hlZFdyYXBSJiZ0aGlzLl9jYWNoZWRBbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsPT09ZS5fY2FjaGVkQW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbCYmdGhpcy5zYW1wbGluZ01vZGU9PT1lLnNhbXBsaW5nTW9kZSYmdGhpcy5fY29tcGFyaXNvbkZ1bmN0aW9uPT09ZS5fY29tcGFyaXNvbkZ1bmN0aW9uJiZ0aGlzLl91c2VNaXBNYXBzPT09ZS5fdXNlTWlwTWFwc319dmFyIE5lOyhmdW5jdGlvbihjKXtjW2MuVW5rbm93bj0wXT0iVW5rbm93biIsY1tjLlVybD0xXT0iVXJsIixjW2MuVGVtcD0yXT0iVGVtcCIsY1tjLlJhdz0zXT0iUmF3IixjW2MuRHluYW1pYz00XT0iRHluYW1pYyIsY1tjLlJlbmRlclRhcmdldD01XT0iUmVuZGVyVGFyZ2V0IixjW2MuTXVsdGlSZW5kZXJUYXJnZXQ9Nl09Ik11bHRpUmVuZGVyVGFyZ2V0IixjW2MuQ3ViZT03XT0iQ3ViZSIsY1tjLkN1YmVSYXc9OF09IkN1YmVSYXciLGNbYy5DdWJlUHJlZmlsdGVyZWQ9OV09IkN1YmVQcmVmaWx0ZXJlZCIsY1tjLlJhdzNEPTEwXT0iUmF3M0QiLGNbYy5SYXcyREFycmF5PTExXT0iUmF3MkRBcnJheSIsY1tjLkRlcHRoU3RlbmNpbD0xMl09IkRlcHRoU3RlbmNpbCIsY1tjLkN1YmVSYXdSR0JEPTEzXT0iQ3ViZVJhd1JHQkQiLGNbYy5EZXB0aD0xNF09IkRlcHRoIn0pKE5lfHwoTmU9e30pKTtjbGFzcyBPdCBleHRlbmRzIFpye2NvbnN0cnVjdG9yKGUsdCxpPSExKXtzdXBlcigpLHRoaXMuaXNSZWFkeT0hMSx0aGlzLmlzQ3ViZT0hMSx0aGlzLmlzM0Q9ITEsdGhpcy5pczJEQXJyYXk9ITEsdGhpcy5pc011bHRpdmlldz0hMSx0aGlzLnVybD0iIix0aGlzLmdlbmVyYXRlTWlwTWFwcz0hMSx0aGlzLnNhbXBsZXM9MCx0aGlzLnR5cGU9LTEsdGhpcy5mb3JtYXQ9LTEsdGhpcy5vbkxvYWRlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkVycm9yT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uUmVidWlsZENhbGxiYWNrPW51bGwsdGhpcy53aWR0aD0wLHRoaXMuaGVpZ2h0PTAsdGhpcy5kZXB0aD0wLHRoaXMuYmFzZVdpZHRoPTAsdGhpcy5iYXNlSGVpZ2h0PTAsdGhpcy5iYXNlRGVwdGg9MCx0aGlzLmludmVydFk9ITEsdGhpcy5faW52ZXJ0VlNjYWxlPSExLHRoaXMuX2Fzc29jaWF0ZWRDaGFubmVsPS0xLHRoaXMuX3NvdXJjZT1OZS5Vbmtub3duLHRoaXMuX2J1ZmZlcj1udWxsLHRoaXMuX2J1ZmZlclZpZXc9bnVsbCx0aGlzLl9idWZmZXJWaWV3QXJyYXk9bnVsbCx0aGlzLl9idWZmZXJWaWV3QXJyYXlBcnJheT1udWxsLHRoaXMuX3NpemU9MCx0aGlzLl9leHRlbnNpb249IiIsdGhpcy5fZmlsZXM9bnVsbCx0aGlzLl93b3JraW5nQ2FudmFzPW51bGwsdGhpcy5fd29ya2luZ0NvbnRleHQ9bnVsbCx0aGlzLl9jYWNoZWRDb29yZGluYXRlc01vZGU9bnVsbCx0aGlzLl9pc0Rpc2FibGVkPSExLHRoaXMuX2NvbXByZXNzaW9uPW51bGwsdGhpcy5fc3BoZXJpY2FsUG9seW5vbWlhbD1udWxsLHRoaXMuX3NwaGVyaWNhbFBvbHlub21pYWxQcm9taXNlPW51bGwsdGhpcy5fc3BoZXJpY2FsUG9seW5vbWlhbENvbXB1dGVkPSExLHRoaXMuX2xvZEdlbmVyYXRpb25TY2FsZT0wLHRoaXMuX2xvZEdlbmVyYXRpb25PZmZzZXQ9MCx0aGlzLl91c2VTUkdCQnVmZmVyPSExLHRoaXMuX2xvZFRleHR1cmVIaWdoPW51bGwsdGhpcy5fbG9kVGV4dHVyZU1pZD1udWxsLHRoaXMuX2xvZFRleHR1cmVMb3c9bnVsbCx0aGlzLl9pc1JHQkQ9ITEsdGhpcy5fbGluZWFyU3BlY3VsYXJMT0Q9ITEsdGhpcy5faXJyYWRpYW5jZVRleHR1cmU9bnVsbCx0aGlzLl9oYXJkd2FyZVRleHR1cmU9bnVsbCx0aGlzLl9tYXhMb2RMZXZlbD1udWxsLHRoaXMuX3JlZmVyZW5jZXM9MSx0aGlzLl9nYW1tYVNwYWNlPW51bGwsdGhpcy5fZW5naW5lPWUsdGhpcy5fc291cmNlPXQsdGhpcy5fdW5pcXVlSWQ9T3QuX0NvdW50ZXIrKyxpfHwodGhpcy5faGFyZHdhcmVUZXh0dXJlPWUuX2NyZWF0ZUhhcmR3YXJlVGV4dHVyZSgpKX1nZXQgdXNlTWlwTWFwcygpe3JldHVybiB0aGlzLmdlbmVyYXRlTWlwTWFwc31zZXQgdXNlTWlwTWFwcyhlKXt0aGlzLmdlbmVyYXRlTWlwTWFwcz1lfWdldCB1bmlxdWVJZCgpe3JldHVybiB0aGlzLl91bmlxdWVJZH1fc2V0VW5pcXVlSWQoZSl7dGhpcy5fdW5pcXVlSWQ9ZX1nZXRFbmdpbmUoKXtyZXR1cm4gdGhpcy5fZW5naW5lfWdldCBzb3VyY2UoKXtyZXR1cm4gdGhpcy5fc291cmNlfWluY3JlbWVudFJlZmVyZW5jZXMoKXt0aGlzLl9yZWZlcmVuY2VzKyt9dXBkYXRlU2l6ZShlLHQsaT0xKXt0aGlzLl9lbmdpbmUudXBkYXRlVGV4dHVyZURpbWVuc2lvbnModGhpcyxlLHQsaSksdGhpcy53aWR0aD1lLHRoaXMuaGVpZ2h0PXQsdGhpcy5kZXB0aD1pLHRoaXMuYmFzZVdpZHRoPWUsdGhpcy5iYXNlSGVpZ2h0PXQsdGhpcy5iYXNlRGVwdGg9aSx0aGlzLl9zaXplPWUqdCppfV9yZWJ1aWxkKCl7dmFyIGU7aWYodGhpcy5pc1JlYWR5PSExLHRoaXMuX2NhY2hlZENvb3JkaW5hdGVzTW9kZT1udWxsLHRoaXMuX2NhY2hlZFdyYXBVPW51bGwsdGhpcy5fY2FjaGVkV3JhcFY9bnVsbCx0aGlzLl9jYWNoZWRXcmFwUj1udWxsLHRoaXMuX2NhY2hlZEFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWw9bnVsbCx0aGlzLm9uUmVidWlsZENhbGxiYWNrKXtjb25zdCBpPXRoaXMub25SZWJ1aWxkQ2FsbGJhY2sodGhpcykscz1yPT57ci5fc3dhcEFuZERpZSh0aGlzLCExKSx0aGlzLmlzUmVhZHk9aS5pc1JlYWR5fTtpLmlzQXN5bmM/aS5wcm94eS50aGVuKHMpOnMoaS5wcm94eSk7cmV0dXJufWxldCB0O3N3aXRjaCh0aGlzLnNvdXJjZSl7Y2FzZSBOZS5UZW1wOmJyZWFrO2Nhc2UgTmUuVXJsOnQ9dGhpcy5fZW5naW5lLmNyZWF0ZVRleHR1cmUoKGU9dGhpcy5fb3JpZ2luYWxVcmwpIT09bnVsbCYmZSE9PXZvaWQgMD9lOnRoaXMudXJsLCF0aGlzLmdlbmVyYXRlTWlwTWFwcyx0aGlzLmludmVydFksbnVsbCx0aGlzLnNhbXBsaW5nTW9kZSxpPT57aS5fc3dhcEFuZERpZSh0aGlzLCExKSx0aGlzLmlzUmVhZHk9ITB9LG51bGwsdGhpcy5fYnVmZmVyLHZvaWQgMCx0aGlzLmZvcm1hdCx0aGlzLl9leHRlbnNpb24sdm9pZCAwLHZvaWQgMCx2b2lkIDAsdGhpcy5fdXNlU1JHQkJ1ZmZlcik7cmV0dXJuO2Nhc2UgTmUuUmF3OnQ9dGhpcy5fZW5naW5lLmNyZWF0ZVJhd1RleHR1cmUodGhpcy5fYnVmZmVyVmlldyx0aGlzLmJhc2VXaWR0aCx0aGlzLmJhc2VIZWlnaHQsdGhpcy5mb3JtYXQsdGhpcy5nZW5lcmF0ZU1pcE1hcHMsdGhpcy5pbnZlcnRZLHRoaXMuc2FtcGxpbmdNb2RlLHRoaXMuX2NvbXByZXNzaW9uLHRoaXMudHlwZSx2b2lkIDAsdGhpcy5fdXNlU1JHQkJ1ZmZlciksdC5fc3dhcEFuZERpZSh0aGlzLCExKSx0aGlzLmlzUmVhZHk9ITA7YnJlYWs7Y2FzZSBOZS5SYXczRDp0PXRoaXMuX2VuZ2luZS5jcmVhdGVSYXdUZXh0dXJlM0QodGhpcy5fYnVmZmVyVmlldyx0aGlzLmJhc2VXaWR0aCx0aGlzLmJhc2VIZWlnaHQsdGhpcy5iYXNlRGVwdGgsdGhpcy5mb3JtYXQsdGhpcy5nZW5lcmF0ZU1pcE1hcHMsdGhpcy5pbnZlcnRZLHRoaXMuc2FtcGxpbmdNb2RlLHRoaXMuX2NvbXByZXNzaW9uLHRoaXMudHlwZSksdC5fc3dhcEFuZERpZSh0aGlzLCExKSx0aGlzLmlzUmVhZHk9ITA7YnJlYWs7Y2FzZSBOZS5SYXcyREFycmF5OnQ9dGhpcy5fZW5naW5lLmNyZWF0ZVJhd1RleHR1cmUyREFycmF5KHRoaXMuX2J1ZmZlclZpZXcsdGhpcy5iYXNlV2lkdGgsdGhpcy5iYXNlSGVpZ2h0LHRoaXMuYmFzZURlcHRoLHRoaXMuZm9ybWF0LHRoaXMuZ2VuZXJhdGVNaXBNYXBzLHRoaXMuaW52ZXJ0WSx0aGlzLnNhbXBsaW5nTW9kZSx0aGlzLl9jb21wcmVzc2lvbix0aGlzLnR5cGUpLHQuX3N3YXBBbmREaWUodGhpcywhMSksdGhpcy5pc1JlYWR5PSEwO2JyZWFrO2Nhc2UgTmUuRHluYW1pYzp0PXRoaXMuX2VuZ2luZS5jcmVhdGVEeW5hbWljVGV4dHVyZSh0aGlzLmJhc2VXaWR0aCx0aGlzLmJhc2VIZWlnaHQsdGhpcy5nZW5lcmF0ZU1pcE1hcHMsdGhpcy5zYW1wbGluZ01vZGUpLHQuX3N3YXBBbmREaWUodGhpcywhMSksdGhpcy5fZW5naW5lLnVwZGF0ZUR5bmFtaWNUZXh0dXJlKHRoaXMsdGhpcy5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpLHRoaXMuaW52ZXJ0WSx2b2lkIDAsdm9pZCAwLCEwKTticmVhaztjYXNlIE5lLkN1YmU6dD10aGlzLl9lbmdpbmUuY3JlYXRlQ3ViZVRleHR1cmUodGhpcy51cmwsbnVsbCx0aGlzLl9maWxlcywhdGhpcy5nZW5lcmF0ZU1pcE1hcHMsKCk9Pnt0Ll9zd2FwQW5kRGllKHRoaXMsITEpLHRoaXMuaXNSZWFkeT0hMH0sbnVsbCx0aGlzLmZvcm1hdCx0aGlzLl9leHRlbnNpb24sITEsMCwwLG51bGwsdm9pZCAwLHRoaXMuX3VzZVNSR0JCdWZmZXIpO3JldHVybjtjYXNlIE5lLkN1YmVSYXc6dD10aGlzLl9lbmdpbmUuY3JlYXRlUmF3Q3ViZVRleHR1cmUodGhpcy5fYnVmZmVyVmlld0FycmF5LHRoaXMud2lkdGgsdGhpcy5mb3JtYXQsdGhpcy50eXBlLHRoaXMuZ2VuZXJhdGVNaXBNYXBzLHRoaXMuaW52ZXJ0WSx0aGlzLnNhbXBsaW5nTW9kZSx0aGlzLl9jb21wcmVzc2lvbiksdC5fc3dhcEFuZERpZSh0aGlzLCExKSx0aGlzLmlzUmVhZHk9ITA7YnJlYWs7Y2FzZSBOZS5DdWJlUmF3UkdCRDpyZXR1cm47Y2FzZSBOZS5DdWJlUHJlZmlsdGVyZWQ6dD10aGlzLl9lbmdpbmUuY3JlYXRlUHJlZmlsdGVyZWRDdWJlVGV4dHVyZSh0aGlzLnVybCxudWxsLHRoaXMuX2xvZEdlbmVyYXRpb25TY2FsZSx0aGlzLl9sb2RHZW5lcmF0aW9uT2Zmc2V0LGk9PntpJiZpLl9zd2FwQW5kRGllKHRoaXMsITEpLHRoaXMuaXNSZWFkeT0hMH0sbnVsbCx0aGlzLmZvcm1hdCx0aGlzLl9leHRlbnNpb24pLHQuX3NwaGVyaWNhbFBvbHlub21pYWw9dGhpcy5fc3BoZXJpY2FsUG9seW5vbWlhbDtyZXR1cm59fV9zd2FwQW5kRGllKGUsdD0hMCl7dmFyIGk7KGk9dGhpcy5faGFyZHdhcmVUZXh0dXJlKT09PW51bGx8fGk9PT12b2lkIDB8fGkuc2V0VXNhZ2UoZS5fc291cmNlLHRoaXMuZ2VuZXJhdGVNaXBNYXBzLHRoaXMuaXNDdWJlLHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpLGUuX2hhcmR3YXJlVGV4dHVyZT10aGlzLl9oYXJkd2FyZVRleHR1cmUsdCYmKGUuX2lzUkdCRD10aGlzLl9pc1JHQkQpLHRoaXMuX2xvZFRleHR1cmVIaWdoJiYoZS5fbG9kVGV4dHVyZUhpZ2gmJmUuX2xvZFRleHR1cmVIaWdoLmRpc3Bvc2UoKSxlLl9sb2RUZXh0dXJlSGlnaD10aGlzLl9sb2RUZXh0dXJlSGlnaCksdGhpcy5fbG9kVGV4dHVyZU1pZCYmKGUuX2xvZFRleHR1cmVNaWQmJmUuX2xvZFRleHR1cmVNaWQuZGlzcG9zZSgpLGUuX2xvZFRleHR1cmVNaWQ9dGhpcy5fbG9kVGV4dHVyZU1pZCksdGhpcy5fbG9kVGV4dHVyZUxvdyYmKGUuX2xvZFRleHR1cmVMb3cmJmUuX2xvZFRleHR1cmVMb3cuZGlzcG9zZSgpLGUuX2xvZFRleHR1cmVMb3c9dGhpcy5fbG9kVGV4dHVyZUxvdyksdGhpcy5faXJyYWRpYW5jZVRleHR1cmUmJihlLl9pcnJhZGlhbmNlVGV4dHVyZSYmZS5faXJyYWRpYW5jZVRleHR1cmUuZGlzcG9zZSgpLGUuX2lycmFkaWFuY2VUZXh0dXJlPXRoaXMuX2lycmFkaWFuY2VUZXh0dXJlKTtjb25zdCBzPXRoaXMuX2VuZ2luZS5nZXRMb2FkZWRUZXh0dXJlc0NhY2hlKCk7bGV0IHI9cy5pbmRleE9mKHRoaXMpO3IhPT0tMSYmcy5zcGxpY2UociwxKSxyPXMuaW5kZXhPZihlKSxyPT09LTEmJnMucHVzaChlKX1kaXNwb3NlKCl7dGhpcy5fcmVmZXJlbmNlcy0tLHRoaXMub25Mb2FkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkVycm9yT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX3JlZmVyZW5jZXM9PT0wJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlVGV4dHVyZSh0aGlzKSx0aGlzLl9oYXJkd2FyZVRleHR1cmU9bnVsbCl9fU90Ll9Db3VudGVyPTA7ZnVuY3Rpb24gamUoKXtyZXR1cm4gdHlwZW9mIHdpbmRvdzwidSJ9ZnVuY3Rpb24gSnMoKXtyZXR1cm4gdHlwZW9mIG5hdmlnYXRvcjwidSJ9ZnVuY3Rpb24gQ2koKXtyZXR1cm4gdHlwZW9mIGRvY3VtZW50PCJ1In1mdW5jdGlvbiBncyhjKXtsZXQgZT0iIix0PWMuZmlyc3RDaGlsZDtmb3IoO3Q7KXQubm9kZVR5cGU9PT0zJiYoZSs9dC50ZXh0Q29udGVudCksdD10Lm5leHRTaWJsaW5nO3JldHVybiBlfWNvbnN0IHBzPXtJc1dpbmRvd09iamVjdEV4aXN0OmplLElzTmF2aWdhdG9yQXZhaWxhYmxlOkpzLElzRG9jdW1lbnRBdmFpbGFibGU6Q2ksR2V0RE9NVGV4dENvbnRlbnQ6Z3N9O2Z1bmN0aW9uICQoYyl7cmV0dXJuYCR7Y30gbmVlZHMgdG8gYmUgaW1wb3J0ZWQgYmVmb3JlIGFzIGl0IGNvbnRhaW5zIGEgc2lkZS1lZmZlY3QgcmVxdWlyZWQgYnkgeW91ciBjb2RlLmB9Y2xhc3MgT3tzdGF0aWMgX0NoZWNrTGltaXQoZSx0KXtsZXQgaT1PLl9Mb2dMaW1pdE91dHB1dHNbZV07cmV0dXJuIGk/aS5jdXJyZW50Kys6KGk9e2xpbWl0OnQsY3VycmVudDoxfSxPLl9Mb2dMaW1pdE91dHB1dHNbZV09aSksaS5jdXJyZW50PD1pLmxpbWl0fXN0YXRpYyBfR2VuZXJhdGVMaW1pdE1lc3NhZ2UoZSx0PTEpe3ZhciBpO2NvbnN0IHM9Ty5fTG9nTGltaXRPdXRwdXRzW2VdO2lmKCFzfHwhTy5NZXNzYWdlTGltaXRSZWFjaGVkKXJldHVybjtjb25zdCByPXRoaXMuX0xldmVsc1t0XTtzLmN1cnJlbnQ9PT1zLmxpbWl0JiZPW3IubmFtZV0oTy5NZXNzYWdlTGltaXRSZWFjaGVkLnJlcGxhY2UoLyVMSU1JVCUvZywiIitzLmxpbWl0KS5yZXBsYWNlKC8lVFlQRSUvZywoaT1yLm5hbWUpIT09bnVsbCYmaSE9PXZvaWQgMD9pOiIiKSl9c3RhdGljIF9BZGRMb2dFbnRyeShlKXtPLl9Mb2dDYWNoZT1lK08uX0xvZ0NhY2hlLE8uT25OZXdDYWNoZUVudHJ5JiZPLk9uTmV3Q2FjaGVFbnRyeShlKX1zdGF0aWMgX0Zvcm1hdE1lc3NhZ2UoZSl7Y29uc3QgdD1zPT5zPDEwPyIwIitzOiIiK3MsaT1uZXcgRGF0ZTtyZXR1cm4iWyIrdChpLmdldEhvdXJzKCkpKyI6Iit0KGkuZ2V0TWludXRlcygpKSsiOiIrdChpLmdldFNlY29uZHMoKSkrIl06ICIrZX1zdGF0aWMgX0xvZ0Rpc2FibGVkKGUsdCl7fXN0YXRpYyBfTG9nRW5hYmxlZChlPTEsdCxpKXtpZihpIT09dm9pZCAwJiYhTy5fQ2hlY2tMaW1pdCh0LGkpKXJldHVybjtjb25zdCBzPU8uX0Zvcm1hdE1lc3NhZ2UodCkscj10aGlzLl9MZXZlbHNbZV07ci5sb2dGdW5jJiZyLmxvZ0Z1bmMoIkJKUyAtICIrcyk7Y29uc3Qgbj1gPGRpdiBzdHlsZT0nY29sb3I6JHtyLmNvbG9yfSc+JHtzfTwvZGl2Pjxicj5gO08uX0FkZExvZ0VudHJ5KG4pLE8uX0dlbmVyYXRlTGltaXRNZXNzYWdlKHQsZSl9c3RhdGljIGdldCBMb2dDYWNoZSgpe3JldHVybiBPLl9Mb2dDYWNoZX1zdGF0aWMgQ2xlYXJMb2dDYWNoZSgpe08uX0xvZ0NhY2hlPSIiLE8uX0xvZ0xpbWl0T3V0cHV0cz17fSxPLmVycm9yc0NvdW50PTB9c3RhdGljIHNldCBMb2dMZXZlbHMoZSl7Ty5Mb2c9Ty5fTG9nRGlzYWJsZWQsTy5XYXJuPU8uX0xvZ0Rpc2FibGVkLE8uRXJyb3I9Ty5fTG9nRGlzYWJsZWQsW08uTWVzc2FnZUxvZ0xldmVsLE8uV2FybmluZ0xvZ0xldmVsLE8uRXJyb3JMb2dMZXZlbF0uZm9yRWFjaCh0PT57aWYoKGUmdCk9PT10KXtjb25zdCBpPXRoaXMuX0xldmVsc1t0XTtPW2kubmFtZV09Ty5fTG9nRW5hYmxlZC5iaW5kKE8sdCl9fSl9fU8uTm9uZUxvZ0xldmVsPTAsTy5NZXNzYWdlTG9nTGV2ZWw9MSxPLldhcm5pbmdMb2dMZXZlbD0yLE8uRXJyb3JMb2dMZXZlbD00LE8uQWxsTG9nTGV2ZWw9NyxPLk1lc3NhZ2VMaW1pdFJlYWNoZWQ9IlRvbyBtYW55ICVUWVBFJXMgKCVMSU1JVCUpLCBubyBtb3JlICVUWVBFJXMgd2lsbCBiZSByZXBvcnRlZCBmb3IgdGhpcyBtZXNzYWdlLiIsTy5fTG9nQ2FjaGU9IiIsTy5fTG9nTGltaXRPdXRwdXRzPXt9LE8uX0xldmVscz1be30se2NvbG9yOiJ3aGl0ZSIsbG9nRnVuYzpjb25zb2xlLmxvZyxuYW1lOiJMb2cifSx7Y29sb3I6Im9yYW5nZSIsbG9nRnVuYzpjb25zb2xlLndhcm4sbmFtZToiV2FybiJ9LHt9LHtjb2xvcjoicmVkIixsb2dGdW5jOmNvbnNvbGUuZXJyb3IsbmFtZToiRXJyb3IifV0sTy5lcnJvcnNDb3VudD0wLE8uTG9nPU8uX0xvZ0VuYWJsZWQuYmluZChPLE8uTWVzc2FnZUxvZ0xldmVsKSxPLldhcm49Ty5fTG9nRW5hYmxlZC5iaW5kKE8sTy5XYXJuaW5nTG9nTGV2ZWwpLE8uRXJyb3I9Ty5fTG9nRW5hYmxlZC5iaW5kKE8sTy5FcnJvckxvZ0xldmVsKTtjb25zdCBxcj0iYXR0cmlidXRlIixqcj0idmFyeWluZyI7Y2xhc3MgSWl7Y29uc3RydWN0b3IoKXt0aGlzLmNoaWxkcmVuPVtdfWlzVmFsaWQoZSl7cmV0dXJuITB9cHJvY2VzcyhlLHQpe3ZhciBpLHMscixuLGEsbztsZXQgaD0iIjtpZih0aGlzLmxpbmUpe2xldCBsPXRoaXMubGluZTtjb25zdCB1PXQucHJvY2Vzc29yO2lmKHUpe3UubGluZVByb2Nlc3NvciYmKGw9dS5saW5lUHJvY2Vzc29yKGwsdC5pc0ZyYWdtZW50LHQucHJvY2Vzc2luZ0NvbnRleHQpKTtjb25zdCBkPShzPShpPXQucHJvY2Vzc29yKT09PW51bGx8fGk9PT12b2lkIDA/dm9pZCAwOmkuYXR0cmlidXRlS2V5d29yZE5hbWUpIT09bnVsbCYmcyE9PXZvaWQgMD9zOnFyLGY9dC5pc0ZyYWdtZW50JiYoISgocj10LnByb2Nlc3Nvcik9PT1udWxsfHxyPT09dm9pZCAwKSYmci52YXJ5aW5nRnJhZ21lbnRLZXl3b3JkTmFtZSk/KG49dC5wcm9jZXNzb3IpPT09bnVsbHx8bj09PXZvaWQgMD92b2lkIDA6bi52YXJ5aW5nRnJhZ21lbnRLZXl3b3JkTmFtZTohdC5pc0ZyYWdtZW50JiYoISgoYT10LnByb2Nlc3Nvcik9PT1udWxsfHxhPT09dm9pZCAwKSYmYS52YXJ5aW5nVmVydGV4S2V5d29yZE5hbWUpPyhvPXQucHJvY2Vzc29yKT09PW51bGx8fG89PT12b2lkIDA/dm9pZCAwOm8udmFyeWluZ1ZlcnRleEtleXdvcmROYW1lOmpyOyF0LmlzRnJhZ21lbnQmJnUuYXR0cmlidXRlUHJvY2Vzc29yJiZ0aGlzLmxpbmUuc3RhcnRzV2l0aChkKT9sPXUuYXR0cmlidXRlUHJvY2Vzc29yKHRoaXMubGluZSxlLHQucHJvY2Vzc2luZ0NvbnRleHQpOnUudmFyeWluZ1Byb2Nlc3NvciYmdGhpcy5saW5lLnN0YXJ0c1dpdGgoZik/bD11LnZhcnlpbmdQcm9jZXNzb3IodGhpcy5saW5lLHQuaXNGcmFnbWVudCxlLHQucHJvY2Vzc2luZ0NvbnRleHQpOnUudW5pZm9ybVByb2Nlc3NvciYmdS51bmlmb3JtUmVnZXhwJiZ1LnVuaWZvcm1SZWdleHAudGVzdCh0aGlzLmxpbmUpP3QubG9va0ZvckNsb3NpbmdCcmFja2V0Rm9yVW5pZm9ybUJ1ZmZlcnx8KGw9dS51bmlmb3JtUHJvY2Vzc29yKHRoaXMubGluZSx0LmlzRnJhZ21lbnQsZSx0LnByb2Nlc3NpbmdDb250ZXh0KSk6dS51bmlmb3JtQnVmZmVyUHJvY2Vzc29yJiZ1LnVuaWZvcm1CdWZmZXJSZWdleHAmJnUudW5pZm9ybUJ1ZmZlclJlZ2V4cC50ZXN0KHRoaXMubGluZSk/dC5sb29rRm9yQ2xvc2luZ0JyYWNrZXRGb3JVbmlmb3JtQnVmZmVyfHwobD11LnVuaWZvcm1CdWZmZXJQcm9jZXNzb3IodGhpcy5saW5lLHQuaXNGcmFnbWVudCx0LnByb2Nlc3NpbmdDb250ZXh0KSx0Lmxvb2tGb3JDbG9zaW5nQnJhY2tldEZvclVuaWZvcm1CdWZmZXI9ITApOnUudGV4dHVyZVByb2Nlc3NvciYmdS50ZXh0dXJlUmVnZXhwJiZ1LnRleHR1cmVSZWdleHAudGVzdCh0aGlzLmxpbmUpP2w9dS50ZXh0dXJlUHJvY2Vzc29yKHRoaXMubGluZSx0LmlzRnJhZ21lbnQsZSx0LnByb2Nlc3NpbmdDb250ZXh0KToodS51bmlmb3JtUHJvY2Vzc29yfHx1LnVuaWZvcm1CdWZmZXJQcm9jZXNzb3IpJiZ0aGlzLmxpbmUuc3RhcnRzV2l0aCgidW5pZm9ybSIpJiYhdC5sb29rRm9yQ2xvc2luZ0JyYWNrZXRGb3JVbmlmb3JtQnVmZmVyJiYoL3VuaWZvcm1ccysoPzooPzpoaWdocCk/fCg/Omxvd3ApPylccyooXFMrKVxzKyhcUyspXHMqOy8udGVzdCh0aGlzLmxpbmUpP3UudW5pZm9ybVByb2Nlc3NvciYmKGw9dS51bmlmb3JtUHJvY2Vzc29yKHRoaXMubGluZSx0LmlzRnJhZ21lbnQsZSx0LnByb2Nlc3NpbmdDb250ZXh0KSk6dS51bmlmb3JtQnVmZmVyUHJvY2Vzc29yJiYobD11LnVuaWZvcm1CdWZmZXJQcm9jZXNzb3IodGhpcy5saW5lLHQuaXNGcmFnbWVudCx0LnByb2Nlc3NpbmdDb250ZXh0KSx0Lmxvb2tGb3JDbG9zaW5nQnJhY2tldEZvclVuaWZvcm1CdWZmZXI9ITApKSx0Lmxvb2tGb3JDbG9zaW5nQnJhY2tldEZvclVuaWZvcm1CdWZmZXImJnRoaXMubGluZS5pbmRleE9mKCJ9IikhPT0tMSYmKHQubG9va0ZvckNsb3NpbmdCcmFja2V0Rm9yVW5pZm9ybUJ1ZmZlcj0hMSx1LmVuZE9mVW5pZm9ybUJ1ZmZlclByb2Nlc3NvciYmKGw9dS5lbmRPZlVuaWZvcm1CdWZmZXJQcm9jZXNzb3IodGhpcy5saW5lLHQuaXNGcmFnbWVudCx0LnByb2Nlc3NpbmdDb250ZXh0KSkpfWgrPWwrYFxyCmB9cmV0dXJuIHRoaXMuY2hpbGRyZW4uZm9yRWFjaChsPT57aCs9bC5wcm9jZXNzKGUsdCl9KSx0aGlzLmFkZGl0aW9uYWxEZWZpbmVLZXkmJihlW3RoaXMuYWRkaXRpb25hbERlZmluZUtleV09dGhpcy5hZGRpdGlvbmFsRGVmaW5lVmFsdWV8fCJ0cnVlIiksaH19Y2xhc3MgJHJ7Y29uc3RydWN0b3IoKXt0aGlzLl9saW5lcz1bXX1nZXQgY3VycmVudExpbmUoKXtyZXR1cm4gdGhpcy5fbGluZXNbdGhpcy5saW5lSW5kZXhdfWdldCBjYW5SZWFkKCl7cmV0dXJuIHRoaXMubGluZUluZGV4PHRoaXMuX2xpbmVzLmxlbmd0aC0xfXNldCBsaW5lcyhlKXt0aGlzLl9saW5lcy5sZW5ndGg9MDtmb3IoY29uc3QgdCBvZiBlKXtpZih0WzBdPT09IiMiKXt0aGlzLl9saW5lcy5wdXNoKHQpO2NvbnRpbnVlfWlmKHQudHJpbSgpLnN0YXJ0c1dpdGgoIi8vIikpe3RoaXMuX2xpbmVzLnB1c2godCk7Y29udGludWV9Y29uc3QgaT10LnNwbGl0KCI7Iik7Zm9yKGxldCBzPTA7czxpLmxlbmd0aDtzKyspe2xldCByPWlbc107cj1yLnRyaW0oKSxyJiZ0aGlzLl9saW5lcy5wdXNoKHIrKHMhPT1pLmxlbmd0aC0xPyI7IjoiIikpfX19fWNsYXNzIG1zIGV4dGVuZHMgSWl7cHJvY2VzcyhlLHQpe2ZvcihsZXQgaT0wO2k8dGhpcy5jaGlsZHJlbi5sZW5ndGg7aSsrKXtjb25zdCBzPXRoaXMuY2hpbGRyZW5baV07aWYocy5pc1ZhbGlkKGUpKXJldHVybiBzLnByb2Nlc3MoZSx0KX1yZXR1cm4iIn19Y2xhc3MgUXIgZXh0ZW5kcyBJaXtpc1ZhbGlkKGUpe3JldHVybiB0aGlzLnRlc3RFeHByZXNzaW9uLmlzVHJ1ZShlKX19Y2xhc3MgZXR7aXNUcnVlKGUpe3JldHVybiEwfXN0YXRpYyBwb3N0Zml4VG9JbmZpeChlKXtjb25zdCB0PVtdO2Zvcihjb25zdCBpIG9mIGUpaWYoZXQuX09wZXJhdG9yUHJpb3JpdHlbaV09PT12b2lkIDApdC5wdXNoKGkpO2Vsc2V7Y29uc3Qgcz10W3QubGVuZ3RoLTFdLHI9dFt0Lmxlbmd0aC0yXTt0Lmxlbmd0aC09Mix0LnB1c2goYCgke3J9JHtpfSR7c30pYCl9cmV0dXJuIHRbdC5sZW5ndGgtMV19c3RhdGljIGluZml4VG9Qb3N0Zml4KGUpe2NvbnN0IHQ9W107bGV0IGk9LTE7Y29uc3Qgcz0oKT0+e2g9aC50cmltKCksaCE9PSIiJiYodC5wdXNoKGgpLGg9IiIpfSxyPWw9PntpPGV0Ll9TdGFjay5sZW5ndGgtMSYmKGV0Ll9TdGFja1srK2ldPWwpfSxuPSgpPT5ldC5fU3RhY2tbaV0sYT0oKT0+aT09PS0xPyIhIUlOVkFMSUQgRVhQUkVTU0lPTiEhIjpldC5fU3RhY2tbaS0tXTtsZXQgbz0wLGg9IiI7Zm9yKDtvPGUubGVuZ3RoOyl7Y29uc3QgbD1lLmNoYXJBdChvKSx1PW88ZS5sZW5ndGgtMT9lLnN1YnN0cihvLDIpOiIiO2lmKGw9PT0iKCIpaD0iIixyKGwpO2Vsc2UgaWYobD09PSIpIil7Zm9yKHMoKTtpIT09LTEmJm4oKSE9PSIoIjspdC5wdXNoKGEoKSk7YSgpfWVsc2UgaWYoZXQuX09wZXJhdG9yUHJpb3JpdHlbdV0+MSl7Zm9yKHMoKTtpIT09LTEmJmV0Ll9PcGVyYXRvclByaW9yaXR5W24oKV0+PWV0Ll9PcGVyYXRvclByaW9yaXR5W3VdOyl0LnB1c2goYSgpKTtyKHUpLG8rK31lbHNlIGgrPWw7bysrfWZvcihzKCk7aSE9PS0xOyluKCk9PT0iKCI/YSgpOnQucHVzaChhKCkpO3JldHVybiB0fX1ldC5fT3BlcmF0b3JQcmlvcml0eT17IikiOjAsIigiOjEsInx8IjoyLCImJiI6M30sZXQuX1N0YWNrPVsiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIl07Y2xhc3MgR2kgZXh0ZW5kcyBldHtjb25zdHJ1Y3RvcihlLHQ9ITEpe3N1cGVyKCksdGhpcy5kZWZpbmU9ZSx0aGlzLm5vdD10fWlzVHJ1ZShlKXtsZXQgdD1lW3RoaXMuZGVmaW5lXSE9PXZvaWQgMDtyZXR1cm4gdGhpcy5ub3QmJih0PSF0KSx0fX1jbGFzcyBKciBleHRlbmRzIGV0e2lzVHJ1ZShlKXtyZXR1cm4gdGhpcy5sZWZ0T3BlcmFuZC5pc1RydWUoZSl8fHRoaXMucmlnaHRPcGVyYW5kLmlzVHJ1ZShlKX19Y2xhc3MgZW4gZXh0ZW5kcyBldHtpc1RydWUoZSl7cmV0dXJuIHRoaXMubGVmdE9wZXJhbmQuaXNUcnVlKGUpJiZ0aGlzLnJpZ2h0T3BlcmFuZC5pc1RydWUoZSl9fWNsYXNzIHRuIGV4dGVuZHMgZXR7Y29uc3RydWN0b3IoZSx0LGkpe3N1cGVyKCksdGhpcy5kZWZpbmU9ZSx0aGlzLm9wZXJhbmQ9dCx0aGlzLnRlc3RWYWx1ZT1pfWlzVHJ1ZShlKXtsZXQgdD1lW3RoaXMuZGVmaW5lXTt0PT09dm9pZCAwJiYodD10aGlzLmRlZmluZSk7bGV0IGk9ITE7Y29uc3Qgcz1wYXJzZUludCh0KSxyPXBhcnNlSW50KHRoaXMudGVzdFZhbHVlKTtzd2l0Y2godGhpcy5vcGVyYW5kKXtjYXNlIj4iOmk9cz5yO2JyZWFrO2Nhc2UiPCI6aT1zPHI7YnJlYWs7Y2FzZSI8PSI6aT1zPD1yO2JyZWFrO2Nhc2UiPj0iOmk9cz49cjticmVhaztjYXNlIj09IjppPXM9PT1yO2JyZWFrfXJldHVybiBpfX12YXIgWmU7KGZ1bmN0aW9uKGMpe2NbYy5HTFNMPTBdPSJHTFNMIixjW2MuV0dTTD0xXT0iV0dTTCJ9KShaZXx8KFplPXt9KSk7Y29uc3Qgc249L2RlZmluZWRccyo/XCgoLis/KVwpL2csRXM9L2RlZmluZWRccyo/XFsoLis/KVxdL2csZXI9LyNpbmNsdWRlXHM/PCguKyk+KFwoKC4qKVwpKSooXFsoLiopXF0pKi9nO2NsYXNzIG5pe3N0YXRpYyBJbml0aWFsaXplKGUpe2UucHJvY2Vzc29yJiZlLnByb2Nlc3Nvci5pbml0aWFsaXplU2hhZGVycyYmZS5wcm9jZXNzb3IuaW5pdGlhbGl6ZVNoYWRlcnMoZS5wcm9jZXNzaW5nQ29udGV4dCl9c3RhdGljIFByb2Nlc3MoZSx0LGkscyl7dmFyIHI7ISgocj10LnByb2Nlc3Nvcik9PT1udWxsfHxyPT09dm9pZCAwKSYmci5wcmVQcm9jZXNzU2hhZGVyQ29kZSYmKGU9dC5wcm9jZXNzb3IucHJlUHJvY2Vzc1NoYWRlckNvZGUoZSx0LmlzRnJhZ21lbnQpKSx0aGlzLl9Qcm9jZXNzSW5jbHVkZXMoZSx0LG49Pnt0LnByb2Nlc3NDb2RlQWZ0ZXJJbmNsdWRlcyYmKG49dC5wcm9jZXNzQ29kZUFmdGVySW5jbHVkZXModC5pc0ZyYWdtZW50PyJmcmFnbWVudCI6InZlcnRleCIsbikpO2NvbnN0IGE9dGhpcy5fUHJvY2Vzc1NoYWRlckNvbnZlcnNpb24obix0LHMpO2koYSxuKX0pfXN0YXRpYyBQcmVQcm9jZXNzKGUsdCxpLHMpe3ZhciByOyEoKHI9dC5wcm9jZXNzb3IpPT09bnVsbHx8cj09PXZvaWQgMCkmJnIucHJlUHJvY2Vzc1NoYWRlckNvZGUmJihlPXQucHJvY2Vzc29yLnByZVByb2Nlc3NTaGFkZXJDb2RlKGUsdC5pc0ZyYWdtZW50KSksdGhpcy5fUHJvY2Vzc0luY2x1ZGVzKGUsdCxuPT57dC5wcm9jZXNzQ29kZUFmdGVySW5jbHVkZXMmJihuPXQucHJvY2Vzc0NvZGVBZnRlckluY2x1ZGVzKHQuaXNGcmFnbWVudD8iZnJhZ21lbnQiOiJ2ZXJ0ZXgiLG4pKTtjb25zdCBhPXRoaXMuX0FwcGx5UHJlUHJvY2Vzc2luZyhuLHQscyk7aShhLG4pfSl9c3RhdGljIEZpbmFsaXplKGUsdCxpKXtyZXR1cm4haS5wcm9jZXNzb3J8fCFpLnByb2Nlc3Nvci5maW5hbGl6ZVNoYWRlcnM/e3ZlcnRleENvZGU6ZSxmcmFnbWVudENvZGU6dH06aS5wcm9jZXNzb3IuZmluYWxpemVTaGFkZXJzKGUsdCxpLnByb2Nlc3NpbmdDb250ZXh0KX1zdGF0aWMgX1Byb2Nlc3NQcmVjaXNpb24oZSx0KXt2YXIgaTtpZighKChpPXQucHJvY2Vzc29yKT09PW51bGx8fGk9PT12b2lkIDApJiZpLm5vUHJlY2lzaW9uKXJldHVybiBlO2NvbnN0IHM9dC5zaG91bGRVc2VIaWdoUHJlY2lzaW9uU2hhZGVyO3JldHVybiBlLmluZGV4T2YoInByZWNpc2lvbiBoaWdocCBmbG9hdCIpPT09LTE/cz9lPWBwcmVjaXNpb24gaGlnaHAgZmxvYXQ7CmArZTplPWBwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKYCtlOnN8fChlPWUucmVwbGFjZSgicHJlY2lzaW9uIGhpZ2hwIGZsb2F0IiwicHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQiKSksZX1zdGF0aWMgX0V4dHJhY3RPcGVyYXRpb24oZSl7Y29uc3QgaT0vZGVmaW5lZFwoKC4rKVwpLy5leGVjKGUpO2lmKGkmJmkubGVuZ3RoKXJldHVybiBuZXcgR2koaVsxXS50cmltKCksZVswXT09PSIhIik7Y29uc3Qgcz1bIj09IiwiPj0iLCI8PSIsIjwiLCI+Il07bGV0IHI9IiIsbj0wO2ZvcihyIG9mIHMpaWYobj1lLmluZGV4T2Yociksbj4tMSlicmVhaztpZihuPT09LTEpcmV0dXJuIG5ldyBHaShlKTtjb25zdCBhPWUuc3Vic3RyaW5nKDAsbikudHJpbSgpLG89ZS5zdWJzdHJpbmcobityLmxlbmd0aCkudHJpbSgpO3JldHVybiBuZXcgdG4oYSxyLG8pfXN0YXRpYyBfQnVpbGRTdWJFeHByZXNzaW9uKGUpe2U9ZS5yZXBsYWNlKHNuLCJkZWZpbmVkWyQxXSIpO2NvbnN0IHQ9ZXQuaW5maXhUb1Bvc3RmaXgoZSksaT1bXTtmb3IoY29uc3QgciBvZiB0KWlmKHIhPT0ifHwiJiZyIT09IiYmIilpLnB1c2gocik7ZWxzZSBpZihpLmxlbmd0aD49Mil7bGV0IG49aVtpLmxlbmd0aC0xXSxhPWlbaS5sZW5ndGgtMl07aS5sZW5ndGgtPTI7Y29uc3Qgbz1yPT0iJiYiP25ldyBlbjpuZXcgSnI7dHlwZW9mIG49PSJzdHJpbmciJiYobj1uLnJlcGxhY2UoRXMsImRlZmluZWQoJDEpIikpLHR5cGVvZiBhPT0ic3RyaW5nIiYmKGE9YS5yZXBsYWNlKEVzLCJkZWZpbmVkKCQxKSIpKSxvLmxlZnRPcGVyYW5kPXR5cGVvZiBhPT0ic3RyaW5nIj90aGlzLl9FeHRyYWN0T3BlcmF0aW9uKGEpOmEsby5yaWdodE9wZXJhbmQ9dHlwZW9mIG49PSJzdHJpbmciP3RoaXMuX0V4dHJhY3RPcGVyYXRpb24obik6bixpLnB1c2gobyl9bGV0IHM9aVtpLmxlbmd0aC0xXTtyZXR1cm4gdHlwZW9mIHM9PSJzdHJpbmciJiYocz1zLnJlcGxhY2UoRXMsImRlZmluZWQoJDEpIikpLHR5cGVvZiBzPT0ic3RyaW5nIj90aGlzLl9FeHRyYWN0T3BlcmF0aW9uKHMpOnN9c3RhdGljIF9CdWlsZEV4cHJlc3Npb24oZSx0KXtjb25zdCBpPW5ldyBRcixzPWUuc3Vic3RyaW5nKDAsdCk7bGV0IHI9ZS5zdWJzdHJpbmcodCk7cmV0dXJuIHI9ci5zdWJzdHJpbmcoMCwoci5pbmRleE9mKCIvLyIpKzF8fHIubGVuZ3RoKzEpLTEpLnRyaW0oKSxzPT09IiNpZmRlZiI/aS50ZXN0RXhwcmVzc2lvbj1uZXcgR2kocik6cz09PSIjaWZuZGVmIj9pLnRlc3RFeHByZXNzaW9uPW5ldyBHaShyLCEwKTppLnRlc3RFeHByZXNzaW9uPXRoaXMuX0J1aWxkU3ViRXhwcmVzc2lvbihyKSxpfXN0YXRpYyBfTW92ZUN1cnNvcldpdGhpbklmKGUsdCxpKXtsZXQgcz1lLmN1cnJlbnRMaW5lO2Zvcig7dGhpcy5fTW92ZUN1cnNvcihlLGkpOyl7cz1lLmN1cnJlbnRMaW5lO2NvbnN0IHI9cy5zdWJzdHJpbmcoMCw1KS50b0xvd2VyQ2FzZSgpO2lmKHI9PT0iI2Vsc2UiKXtjb25zdCBuPW5ldyBJaTt0LmNoaWxkcmVuLnB1c2gobiksdGhpcy5fTW92ZUN1cnNvcihlLG4pO3JldHVybn1lbHNlIGlmKHI9PT0iI2VsaWYiKXtjb25zdCBuPXRoaXMuX0J1aWxkRXhwcmVzc2lvbihzLDUpO3QuY2hpbGRyZW4ucHVzaChuKSxpPW59fX1zdGF0aWMgX01vdmVDdXJzb3IoZSx0KXtmb3IoO2UuY2FuUmVhZDspe2UubGluZUluZGV4Kys7Y29uc3QgaT1lLmN1cnJlbnRMaW5lLHI9LygjaWZkZWYpfCgjZWxzZSl8KCNlbGlmKXwoI2VuZGlmKXwoI2lmbmRlZil8KCNpZikvLmV4ZWMoaSk7aWYociYmci5sZW5ndGgpc3dpdGNoKHJbMF0pe2Nhc2UiI2lmZGVmIjp7Y29uc3QgYT1uZXcgbXM7dC5jaGlsZHJlbi5wdXNoKGEpO2NvbnN0IG89dGhpcy5fQnVpbGRFeHByZXNzaW9uKGksNik7YS5jaGlsZHJlbi5wdXNoKG8pLHRoaXMuX01vdmVDdXJzb3JXaXRoaW5JZihlLGEsbyk7YnJlYWt9Y2FzZSIjZWxzZSI6Y2FzZSIjZWxpZiI6cmV0dXJuITA7Y2FzZSIjZW5kaWYiOnJldHVybiExO2Nhc2UiI2lmbmRlZiI6e2NvbnN0IGE9bmV3IG1zO3QuY2hpbGRyZW4ucHVzaChhKTtjb25zdCBvPXRoaXMuX0J1aWxkRXhwcmVzc2lvbihpLDcpO2EuY2hpbGRyZW4ucHVzaChvKSx0aGlzLl9Nb3ZlQ3Vyc29yV2l0aGluSWYoZSxhLG8pO2JyZWFrfWNhc2UiI2lmIjp7Y29uc3QgYT1uZXcgbXMsbz10aGlzLl9CdWlsZEV4cHJlc3Npb24oaSwzKTt0LmNoaWxkcmVuLnB1c2goYSksYS5jaGlsZHJlbi5wdXNoKG8pLHRoaXMuX01vdmVDdXJzb3JXaXRoaW5JZihlLGEsbyk7YnJlYWt9fWVsc2V7Y29uc3Qgbj1uZXcgSWk7aWYobi5saW5lPWksdC5jaGlsZHJlbi5wdXNoKG4pLGlbMF09PT0iIyImJmlbMV09PT0iZCIpe2NvbnN0IGE9aS5yZXBsYWNlKCI7IiwiIikuc3BsaXQoIiAiKTtuLmFkZGl0aW9uYWxEZWZpbmVLZXk9YVsxXSxhLmxlbmd0aD09PTMmJihuLmFkZGl0aW9uYWxEZWZpbmVWYWx1ZT1hWzJdKX19fXJldHVybiExfXN0YXRpYyBfRXZhbHVhdGVQcmVQcm9jZXNzb3JzKGUsdCxpKXtjb25zdCBzPW5ldyBJaSxyPW5ldyAkcjtyZXR1cm4gci5saW5lSW5kZXg9LTEsci5saW5lcz1lLnNwbGl0KGAKYCksdGhpcy5fTW92ZUN1cnNvcihyLHMpLHMucHJvY2Vzcyh0LGkpfXN0YXRpYyBfUHJlcGFyZVByZVByb2Nlc3NvcnMoZSx0KXt2YXIgaTtjb25zdCBzPWUuZGVmaW5lcyxyPXt9O2Zvcihjb25zdCBuIG9mIHMpe2NvbnN0IG89bi5yZXBsYWNlKCIjZGVmaW5lIiwiIikucmVwbGFjZSgiOyIsIiIpLnRyaW0oKS5zcGxpdCgiICIpO3Jbb1swXV09by5sZW5ndGg+MT9vWzFdOiIifXJldHVybigoaT1lLnByb2Nlc3Nvcik9PT1udWxsfHxpPT09dm9pZCAwP3ZvaWQgMDppLnNoYWRlckxhbmd1YWdlKT09PVplLkdMU0wmJihyLkdMX0VTPSJ0cnVlIiksci5fX1ZFUlNJT05fXz1lLnZlcnNpb24scltlLnBsYXRmb3JtTmFtZV09InRydWUiLHQuX2dldEdsb2JhbERlZmluZXMocikscn1zdGF0aWMgX1Byb2Nlc3NTaGFkZXJDb252ZXJzaW9uKGUsdCxpKXtsZXQgcz10aGlzLl9Qcm9jZXNzUHJlY2lzaW9uKGUsdCk7aWYoIXQucHJvY2Vzc29yfHx0LnByb2Nlc3Nvci5zaGFkZXJMYW5ndWFnZT09PVplLkdMU0wmJnMuaW5kZXhPZigiI3ZlcnNpb24gMyIpIT09LTEmJihzPXMucmVwbGFjZSgiI3ZlcnNpb24gMzAwIGVzIiwiIiksIXQucHJvY2Vzc29yLnBhcnNlR0xFUzMpKXJldHVybiBzO2NvbnN0IHI9dC5kZWZpbmVzLG49dGhpcy5fUHJlcGFyZVByZVByb2Nlc3NvcnModCxpKTtyZXR1cm4gdC5wcm9jZXNzb3IucHJlUHJvY2Vzc29yJiYocz10LnByb2Nlc3Nvci5wcmVQcm9jZXNzb3IocyxyLHQuaXNGcmFnbWVudCx0LnByb2Nlc3NpbmdDb250ZXh0KSkscz10aGlzLl9FdmFsdWF0ZVByZVByb2Nlc3NvcnMocyxuLHQpLHQucHJvY2Vzc29yLnBvc3RQcm9jZXNzb3ImJihzPXQucHJvY2Vzc29yLnBvc3RQcm9jZXNzb3IocyxyLHQuaXNGcmFnbWVudCx0LnByb2Nlc3NpbmdDb250ZXh0LGkpKSxpLl9mZWF0dXJlcy5uZWVkU2hhZGVyQ29kZUlubGluaW5nJiYocz1pLmlubGluZVNoYWRlckNvZGUocykpLHN9c3RhdGljIF9BcHBseVByZVByb2Nlc3NpbmcoZSx0LGkpe3ZhciBzLHI7bGV0IG49ZTtjb25zdCBhPXQuZGVmaW5lcyxvPXRoaXMuX1ByZXBhcmVQcmVQcm9jZXNzb3JzKHQsaSk7cmV0dXJuISgocz10LnByb2Nlc3Nvcik9PT1udWxsfHxzPT09dm9pZCAwKSYmcy5wcmVQcm9jZXNzb3ImJihuPXQucHJvY2Vzc29yLnByZVByb2Nlc3NvcihuLGEsdC5pc0ZyYWdtZW50LHQucHJvY2Vzc2luZ0NvbnRleHQpKSxuPXRoaXMuX0V2YWx1YXRlUHJlUHJvY2Vzc29ycyhuLG8sdCksISgocj10LnByb2Nlc3Nvcik9PT1udWxsfHxyPT09dm9pZCAwKSYmci5wb3N0UHJvY2Vzc29yJiYobj10LnByb2Nlc3Nvci5wb3N0UHJvY2Vzc29yKG4sYSx0LmlzRnJhZ21lbnQsdC5wcm9jZXNzaW5nQ29udGV4dCxpKSksaS5fZmVhdHVyZXMubmVlZFNoYWRlckNvZGVJbmxpbmluZyYmKG49aS5pbmxpbmVTaGFkZXJDb2RlKG4pKSxufXN0YXRpYyBfUHJvY2Vzc0luY2x1ZGVzKGUsdCxpKXtsZXQgcz1lci5leGVjKGUpLHI9bmV3IFN0cmluZyhlKSxuPSExO2Zvcig7cyE9bnVsbDspe2xldCBhPXNbMV07aWYoYS5pbmRleE9mKCJfX2RlY2xfXyIpIT09LTEmJihhPWEucmVwbGFjZSgvX19kZWNsX18vLCIiKSx0LnN1cHBvcnRzVW5pZm9ybUJ1ZmZlcnMmJihhPWEucmVwbGFjZSgvVmVydGV4LywiVWJvIiksYT1hLnJlcGxhY2UoL0ZyYWdtZW50LywiVWJvIikpLGE9YSsiRGVjbGFyYXRpb24iKSx0LmluY2x1ZGVzU2hhZGVyc1N0b3JlW2FdKXtsZXQgbz10LmluY2x1ZGVzU2hhZGVyc1N0b3JlW2FdO2lmKHNbMl0pe2NvbnN0IGg9c1szXS5zcGxpdCgiLCIpO2ZvcihsZXQgbD0wO2w8aC5sZW5ndGg7bCs9Mil7Y29uc3QgdT1uZXcgUmVnRXhwKGhbbF0sImciKSxkPWhbbCsxXTtvPW8ucmVwbGFjZSh1LGQpfX1pZihzWzRdKXtjb25zdCBoPXNbNV07aWYoaC5pbmRleE9mKCIuLiIpIT09LTEpe2NvbnN0IGw9aC5zcGxpdCgiLi4iKSx1PXBhcnNlSW50KGxbMF0pO2xldCBkPXBhcnNlSW50KGxbMV0pLGY9by5zbGljZSgwKTtvPSIiLGlzTmFOKGQpJiYoZD10LmluZGV4UGFyYW1ldGVyc1tsWzFdXSk7Zm9yKGxldCBfPXU7XzxkO18rKyl0LnN1cHBvcnRzVW5pZm9ybUJ1ZmZlcnN8fChmPWYucmVwbGFjZSgvbGlnaHRce1hcfS4oXHcqKS9nLChFLG0pPT5tKyJ7WH0iKSksbys9Zi5yZXBsYWNlKC9ce1hcfS9nLF8udG9TdHJpbmcoKSkrYApgfWVsc2UgdC5zdXBwb3J0c1VuaWZvcm1CdWZmZXJzfHwobz1vLnJlcGxhY2UoL2xpZ2h0XHtYXH0uKFx3KikvZywobCx1KT0+dSsie1h9IikpLG89by5yZXBsYWNlKC9ce1hcfS9nLGgpfXI9ci5yZXBsYWNlKHNbMF0sbyksbj1ufHxvLmluZGV4T2YoIiNpbmNsdWRlPCIpPj0wfHxvLmluZGV4T2YoIiNpbmNsdWRlIDwiKT49MH1lbHNle2NvbnN0IG89dC5zaGFkZXJzUmVwb3NpdG9yeSsiU2hhZGVyc0luY2x1ZGUvIithKyIuZngiO25pLl9GaWxlVG9vbHNMb2FkRmlsZShvLGg9Pnt0LmluY2x1ZGVzU2hhZGVyc1N0b3JlW2FdPWgsdGhpcy5fUHJvY2Vzc0luY2x1ZGVzKHIsdCxpKX0pO3JldHVybn1zPWVyLmV4ZWMoZSl9bj90aGlzLl9Qcm9jZXNzSW5jbHVkZXMoci50b1N0cmluZygpLHQsaSk6aShyKX1zdGF0aWMgX0ZpbGVUb29sc0xvYWRGaWxlKGUsdCxpLHMscixuKXt0aHJvdyAkKCJGaWxlVG9vbHMiKX19Y2xhc3MgVXtzdGF0aWMgR2V0U2hhZGVyc1JlcG9zaXRvcnkoZT1aZS5HTFNMKXtyZXR1cm4gZT09PVplLkdMU0w/VS5TaGFkZXJzUmVwb3NpdG9yeTpVLlNoYWRlcnNSZXBvc2l0b3J5V0dTTH1zdGF0aWMgR2V0U2hhZGVyc1N0b3JlKGU9WmUuR0xTTCl7cmV0dXJuIGU9PT1aZS5HTFNMP1UuU2hhZGVyc1N0b3JlOlUuU2hhZGVyc1N0b3JlV0dTTH1zdGF0aWMgR2V0SW5jbHVkZXNTaGFkZXJzU3RvcmUoZT1aZS5HTFNMKXtyZXR1cm4gZT09PVplLkdMU0w/VS5JbmNsdWRlc1NoYWRlcnNTdG9yZTpVLkluY2x1ZGVzU2hhZGVyc1N0b3JlV0dTTH19VS5TaGFkZXJzUmVwb3NpdG9yeT0ic3JjL1NoYWRlcnMvIixVLlNoYWRlcnNTdG9yZT17fSxVLkluY2x1ZGVzU2hhZGVyc1N0b3JlPXt9LFUuU2hhZGVyc1JlcG9zaXRvcnlXR1NMPSJzcmMvU2hhZGVyc1dHU0wvIixVLlNoYWRlcnNTdG9yZVdHU0w9e30sVS5JbmNsdWRlc1NoYWRlcnNTdG9yZVdHU0w9e307Y2xhc3MgUGV7Y29uc3RydWN0b3IoZSx0LGkscz1udWxsLHIsbj1udWxsLGE9bnVsbCxvPW51bGwsaD1udWxsLGwsdT0iIixkPVplLkdMU0wpe3ZhciBmLF8sRTt0aGlzLm5hbWU9bnVsbCx0aGlzLmRlZmluZXM9IiIsdGhpcy5vbkNvbXBpbGVkPW51bGwsdGhpcy5vbkVycm9yPW51bGwsdGhpcy5vbkJpbmQ9bnVsbCx0aGlzLnVuaXF1ZUlkPTAsdGhpcy5vbkNvbXBpbGVPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25FcnJvck9ic2VydmFibGU9bmV3IEYsdGhpcy5fb25CaW5kT2JzZXJ2YWJsZT1udWxsLHRoaXMuX3dhc1ByZXZpb3VzbHlSZWFkeT0hMSx0aGlzLl9mb3JjZVJlYmluZE9uTmV4dENhbGw9ITEsdGhpcy5fd2FzUHJldmlvdXNseVVzaW5nSW5zdGFuY2VzPW51bGwsdGhpcy5faXNEaXNwb3NlZD0hMSx0aGlzLl9ib25lc0NvbXB1dGF0aW9uRm9yY2VkVG9DUFU9ITEsdGhpcy5fdW5pZm9ybUJ1ZmZlcnNOYW1lcz17fSx0aGlzLl9tdWx0aVRhcmdldD0hMSx0aGlzLl9zYW1wbGVycz17fSx0aGlzLl9pc1JlYWR5PSExLHRoaXMuX2NvbXBpbGF0aW9uRXJyb3I9IiIsdGhpcy5fYWxsRmFsbGJhY2tzUHJvY2Vzc2VkPSExLHRoaXMuX3VuaWZvcm1zPXt9LHRoaXMuX2tleT0iIix0aGlzLl9mYWxsYmFja3M9bnVsbCx0aGlzLl92ZXJ0ZXhTb3VyY2VDb2RlT3ZlcnJpZGU9IiIsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlT3ZlcnJpZGU9IiIsdGhpcy5fdHJhbnNmb3JtRmVlZGJhY2tWYXJ5aW5ncz1udWxsLHRoaXMuX3BpcGVsaW5lQ29udGV4dD1udWxsLHRoaXMuX3ZlcnRleFNvdXJjZUNvZGU9IiIsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlPSIiLHRoaXMuX3ZlcnRleFNvdXJjZUNvZGVCZWZvcmVNaWdyYXRpb249IiIsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlQmVmb3JlTWlncmF0aW9uPSIiLHRoaXMuX3Jhd1ZlcnRleFNvdXJjZUNvZGU9IiIsdGhpcy5fcmF3RnJhZ21lbnRTb3VyY2VDb2RlPSIiLHRoaXMubmFtZT1lLHRoaXMuX2tleT11O2xldCBtLHY9bnVsbDtpZih0LmF0dHJpYnV0ZXMpe2NvbnN0IGs9dDtpZih0aGlzLl9lbmdpbmU9aSx0aGlzLl9hdHRyaWJ1dGVzTmFtZXM9ay5hdHRyaWJ1dGVzLHRoaXMuX3VuaWZvcm1zTmFtZXM9ay51bmlmb3Jtc05hbWVzLmNvbmNhdChrLnNhbXBsZXJzKSx0aGlzLl9zYW1wbGVyTGlzdD1rLnNhbXBsZXJzLnNsaWNlKCksdGhpcy5kZWZpbmVzPWsuZGVmaW5lcyx0aGlzLm9uRXJyb3I9ay5vbkVycm9yLHRoaXMub25Db21waWxlZD1rLm9uQ29tcGlsZWQsdGhpcy5fZmFsbGJhY2tzPWsuZmFsbGJhY2tzLHRoaXMuX2luZGV4UGFyYW1ldGVycz1rLmluZGV4UGFyYW1ldGVycyx0aGlzLl90cmFuc2Zvcm1GZWVkYmFja1ZhcnlpbmdzPWsudHJhbnNmb3JtRmVlZGJhY2tWYXJ5aW5nc3x8bnVsbCx0aGlzLl9tdWx0aVRhcmdldD0hIWsubXVsdGlUYXJnZXQsdGhpcy5fc2hhZGVyTGFuZ3VhZ2U9KGY9ay5zaGFkZXJMYW5ndWFnZSkhPT1udWxsJiZmIT09dm9pZCAwP2Y6WmUuR0xTTCxrLnVuaWZvcm1CdWZmZXJzTmFtZXMpe3RoaXMuX3VuaWZvcm1CdWZmZXJzTmFtZXNMaXN0PWsudW5pZm9ybUJ1ZmZlcnNOYW1lcy5zbGljZSgpO2ZvcihsZXQgdz0wO3c8ay51bmlmb3JtQnVmZmVyc05hbWVzLmxlbmd0aDt3KyspdGhpcy5fdW5pZm9ybUJ1ZmZlcnNOYW1lc1trLnVuaWZvcm1CdWZmZXJzTmFtZXNbd11dPXd9dj0oXz1rLnByb2Nlc3NGaW5hbENvZGUpIT09bnVsbCYmXyE9PXZvaWQgMD9fOm51bGwsbT0oRT1rLnByb2Nlc3NDb2RlQWZ0ZXJJbmNsdWRlcykhPT1udWxsJiZFIT09dm9pZCAwP0U6dm9pZCAwfWVsc2UgdGhpcy5fZW5naW5lPXIsdGhpcy5kZWZpbmVzPW4/PyIiLHRoaXMuX3VuaWZvcm1zTmFtZXM9aS5jb25jYXQocyksdGhpcy5fc2FtcGxlckxpc3Q9cz9zLnNsaWNlKCk6W10sdGhpcy5fYXR0cmlidXRlc05hbWVzPXQsdGhpcy5fdW5pZm9ybUJ1ZmZlcnNOYW1lc0xpc3Q9W10sdGhpcy5fc2hhZGVyTGFuZ3VhZ2U9ZCx0aGlzLm9uRXJyb3I9aCx0aGlzLm9uQ29tcGlsZWQ9byx0aGlzLl9pbmRleFBhcmFtZXRlcnM9bCx0aGlzLl9mYWxsYmFja3M9YTt0aGlzLl9hdHRyaWJ1dGVMb2NhdGlvbkJ5TmFtZT17fSx0aGlzLnVuaXF1ZUlkPVBlLl9VbmlxdWVJZFNlZWQrKztsZXQgUyx5O2NvbnN0IEE9amUoKT90aGlzLl9lbmdpbmUuZ2V0SG9zdERvY3VtZW50KCk6bnVsbDtlLnZlcnRleFNvdXJjZT9TPSJzb3VyY2U6IitlLnZlcnRleFNvdXJjZTplLnZlcnRleEVsZW1lbnQ/KFM9QT9BLmdldEVsZW1lbnRCeUlkKGUudmVydGV4RWxlbWVudCk6bnVsbCxTfHwoUz1lLnZlcnRleEVsZW1lbnQpKTpTPWUudmVydGV4fHxlLGUuZnJhZ21lbnRTb3VyY2U/eT0ic291cmNlOiIrZS5mcmFnbWVudFNvdXJjZTplLmZyYWdtZW50RWxlbWVudD8oeT1BP0EuZ2V0RWxlbWVudEJ5SWQoZS5mcmFnbWVudEVsZW1lbnQpOm51bGwseXx8KHk9ZS5mcmFnbWVudEVsZW1lbnQpKTp5PWUuZnJhZ21lbnR8fGUsdGhpcy5fcHJvY2Vzc2luZ0NvbnRleHQ9dGhpcy5fZW5naW5lLl9nZXRTaGFkZXJQcm9jZXNzaW5nQ29udGV4dCh0aGlzLl9zaGFkZXJMYW5ndWFnZSk7bGV0IEM9e2RlZmluZXM6dGhpcy5kZWZpbmVzLnNwbGl0KGAKYCksaW5kZXhQYXJhbWV0ZXJzOnRoaXMuX2luZGV4UGFyYW1ldGVycyxpc0ZyYWdtZW50OiExLHNob3VsZFVzZUhpZ2hQcmVjaXNpb25TaGFkZXI6dGhpcy5fZW5naW5lLl9zaG91bGRVc2VIaWdoUHJlY2lzaW9uU2hhZGVyLHByb2Nlc3Nvcjp0aGlzLl9lbmdpbmUuX2dldFNoYWRlclByb2Nlc3Nvcih0aGlzLl9zaGFkZXJMYW5ndWFnZSksc3VwcG9ydHNVbmlmb3JtQnVmZmVyczp0aGlzLl9lbmdpbmUuc3VwcG9ydHNVbmlmb3JtQnVmZmVycyxzaGFkZXJzUmVwb3NpdG9yeTpVLkdldFNoYWRlcnNSZXBvc2l0b3J5KHRoaXMuX3NoYWRlckxhbmd1YWdlKSxpbmNsdWRlc1NoYWRlcnNTdG9yZTpVLkdldEluY2x1ZGVzU2hhZGVyc1N0b3JlKHRoaXMuX3NoYWRlckxhbmd1YWdlKSx2ZXJzaW9uOih0aGlzLl9lbmdpbmUudmVyc2lvbioxMDApLnRvU3RyaW5nKCkscGxhdGZvcm1OYW1lOnRoaXMuX2VuZ2luZS5zaGFkZXJQbGF0Zm9ybU5hbWUscHJvY2Vzc2luZ0NvbnRleHQ6dGhpcy5fcHJvY2Vzc2luZ0NvbnRleHQsaXNORENIYWxmWlJhbmdlOnRoaXMuX2VuZ2luZS5pc05EQ0hhbGZaUmFuZ2UsdXNlUmV2ZXJzZURlcHRoQnVmZmVyOnRoaXMuX2VuZ2luZS51c2VSZXZlcnNlRGVwdGhCdWZmZXIscHJvY2Vzc0NvZGVBZnRlckluY2x1ZGVzOm19O2NvbnN0IGI9W3ZvaWQgMCx2b2lkIDBdLE09KCk9PntpZihiWzBdJiZiWzFdKXtDLmlzRnJhZ21lbnQ9ITA7Y29uc3Rbayx3XT1iO25pLlByb2Nlc3ModyxDLChkZSxjZSk9Pnt0aGlzLl9mcmFnbWVudFNvdXJjZUNvZGVCZWZvcmVNaWdyYXRpb249Y2UsdiYmKGRlPXYoImZyYWdtZW50IixkZSkpO2NvbnN0IHNlPW5pLkZpbmFsaXplKGssZGUsQyk7dGhpcy5fdXNlRmluYWxDb2RlKHNlLnZlcnRleENvZGUsc2UuZnJhZ21lbnRDb2RlLGUpfSx0aGlzLl9lbmdpbmUpfX07dGhpcy5fbG9hZFNoYWRlcihTLCJWZXJ0ZXgiLCIiLGs9PntuaS5Jbml0aWFsaXplKEMpLG5pLlByb2Nlc3MoayxDLCh3LGRlKT0+e3RoaXMuX3Jhd1ZlcnRleFNvdXJjZUNvZGU9ayx0aGlzLl92ZXJ0ZXhTb3VyY2VDb2RlQmVmb3JlTWlncmF0aW9uPWRlLHYmJih3PXYoInZlcnRleCIsdykpLGJbMF09dyxNKCl9LHRoaXMuX2VuZ2luZSl9KSx0aGlzLl9sb2FkU2hhZGVyKHksIkZyYWdtZW50IiwiUGl4ZWwiLGs9Pnt0aGlzLl9yYXdGcmFnbWVudFNvdXJjZUNvZGU9ayxiWzFdPWssTSgpfSksQz1udWxsO2NvbnN0IEw9ZnVuY3Rpb24oayl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BpcGVsaW5lQ29udGV4dCYmdGhpcy5fcGlwZWxpbmVDb250ZXh0W2tdLmFwcGx5KHRoaXMuX3BpcGVsaW5lQ29udGV4dCxhcmd1bWVudHMpLHRoaXN9fTtbIkludD8iLCJVSW50PyIsIkludEFycmF5PyIsIlVJbnRBcnJheT8iLCJBcnJheT8iLCJDb2xvcj8iLCJWZWN0b3I/IiwiRmxvYXQ/IiwiTWF0cmljZXMiLCJNYXRyaXgiLCJNYXRyaXgzeDMiLCJNYXRyaXgyeDIiLCJRdWF0ZXJuaW9uIiwiRGlyZWN0Q29sb3I0Il0uZm9yRWFjaChrPT57Y29uc3Qgdz1gc2V0JHtrfWA7dy5lbmRzV2l0aCgiPyIpP1siIiwyLDMsNF0uZm9yRWFjaChkZT0+e3RoaXNbdy5zbGljZSgwLC0xKStkZV09dGhpc1t3LnNsaWNlKDAsLTEpK2RlXXx8TCh3LnNsaWNlKDAsLTEpK2RlKS5iaW5kKHRoaXMpfSk6dGhpc1t3XT10aGlzW3ddfHxMKHcpLmJpbmQodGhpcyl9KX1zdGF0aWMgZ2V0IFNoYWRlcnNSZXBvc2l0b3J5KCl7cmV0dXJuIFUuU2hhZGVyc1JlcG9zaXRvcnl9c3RhdGljIHNldCBTaGFkZXJzUmVwb3NpdG9yeShlKXtVLlNoYWRlcnNSZXBvc2l0b3J5PWV9Z2V0IG9uQmluZE9ic2VydmFibGUoKXtyZXR1cm4gdGhpcy5fb25CaW5kT2JzZXJ2YWJsZXx8KHRoaXMuX29uQmluZE9ic2VydmFibGU9bmV3IEYpLHRoaXMuX29uQmluZE9ic2VydmFibGV9X3VzZUZpbmFsQ29kZShlLHQsaSl7aWYoaSl7Y29uc3Qgcz1pLnZlcnRleEVsZW1lbnR8fGkudmVydGV4fHxpLnNwZWN0b3JOYW1lfHxpLHI9aS5mcmFnbWVudEVsZW1lbnR8fGkuZnJhZ21lbnR8fGkuc3BlY3Rvck5hbWV8fGk7dGhpcy5fdmVydGV4U291cmNlQ29kZT0odGhpcy5fc2hhZGVyTGFuZ3VhZ2U9PT1aZS5XR1NMPyIvLyI6IiIpKyIjZGVmaW5lIFNIQURFUl9OQU1FIHZlcnRleDoiK3MrYApgK2UsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlPSh0aGlzLl9zaGFkZXJMYW5ndWFnZT09PVplLldHU0w/Ii8vIjoiIikrIiNkZWZpbmUgU0hBREVSX05BTUUgZnJhZ21lbnQ6IityK2AKYCt0fWVsc2UgdGhpcy5fdmVydGV4U291cmNlQ29kZT1lLHRoaXMuX2ZyYWdtZW50U291cmNlQ29kZT10O3RoaXMuX3ByZXBhcmVFZmZlY3QoKX1nZXQga2V5KCl7cmV0dXJuIHRoaXMuX2tleX1pc1JlYWR5KCl7dHJ5e3JldHVybiB0aGlzLl9pc1JlYWR5SW50ZXJuYWwoKX1jYXRjaHtyZXR1cm4hMX19X2lzUmVhZHlJbnRlcm5hbCgpe3JldHVybiB0aGlzLl9pc1JlYWR5PyEwOnRoaXMuX3BpcGVsaW5lQ29udGV4dD90aGlzLl9waXBlbGluZUNvbnRleHQuaXNSZWFkeTohMX1nZXRFbmdpbmUoKXtyZXR1cm4gdGhpcy5fZW5naW5lfWdldFBpcGVsaW5lQ29udGV4dCgpe3JldHVybiB0aGlzLl9waXBlbGluZUNvbnRleHR9Z2V0QXR0cmlidXRlc05hbWVzKCl7cmV0dXJuIHRoaXMuX2F0dHJpYnV0ZXNOYW1lc31nZXRBdHRyaWJ1dGVMb2NhdGlvbihlKXtyZXR1cm4gdGhpcy5fYXR0cmlidXRlc1tlXX1nZXRBdHRyaWJ1dGVMb2NhdGlvbkJ5TmFtZShlKXtyZXR1cm4gdGhpcy5fYXR0cmlidXRlTG9jYXRpb25CeU5hbWVbZV19Z2V0QXR0cmlidXRlc0NvdW50KCl7cmV0dXJuIHRoaXMuX2F0dHJpYnV0ZXMubGVuZ3RofWdldFVuaWZvcm1JbmRleChlKXtyZXR1cm4gdGhpcy5fdW5pZm9ybXNOYW1lcy5pbmRleE9mKGUpfWdldFVuaWZvcm0oZSl7cmV0dXJuIHRoaXMuX3VuaWZvcm1zW2VdfWdldFNhbXBsZXJzKCl7cmV0dXJuIHRoaXMuX3NhbXBsZXJMaXN0fWdldFVuaWZvcm1OYW1lcygpe3JldHVybiB0aGlzLl91bmlmb3Jtc05hbWVzfWdldFVuaWZvcm1CdWZmZXJzTmFtZXMoKXtyZXR1cm4gdGhpcy5fdW5pZm9ybUJ1ZmZlcnNOYW1lc0xpc3R9Z2V0SW5kZXhQYXJhbWV0ZXJzKCl7cmV0dXJuIHRoaXMuX2luZGV4UGFyYW1ldGVyc31nZXRDb21waWxhdGlvbkVycm9yKCl7cmV0dXJuIHRoaXMuX2NvbXBpbGF0aW9uRXJyb3J9YWxsRmFsbGJhY2tzUHJvY2Vzc2VkKCl7cmV0dXJuIHRoaXMuX2FsbEZhbGxiYWNrc1Byb2Nlc3NlZH1leGVjdXRlV2hlbkNvbXBpbGVkKGUpe2lmKHRoaXMuaXNSZWFkeSgpKXtlKHRoaXMpO3JldHVybn10aGlzLm9uQ29tcGlsZU9ic2VydmFibGUuYWRkKHQ9PntlKHQpfSksKCF0aGlzLl9waXBlbGluZUNvbnRleHR8fHRoaXMuX3BpcGVsaW5lQ29udGV4dC5pc0FzeW5jKSYmc2V0VGltZW91dCgoKT0+e3RoaXMuX2NoZWNrSXNSZWFkeShudWxsKX0sMTYpfV9jaGVja0lzUmVhZHkoZSl7dHJ5e2lmKHRoaXMuX2lzUmVhZHlJbnRlcm5hbCgpKXJldHVybn1jYXRjaCh0KXt0aGlzLl9wcm9jZXNzQ29tcGlsYXRpb25FcnJvcnModCxlKTtyZXR1cm59dGhpcy5faXNEaXNwb3NlZHx8c2V0VGltZW91dCgoKT0+e3RoaXMuX2NoZWNrSXNSZWFkeShlKX0sMTYpfV9sb2FkU2hhZGVyKGUsdCxpLHMpe2lmKHR5cGVvZiBIVE1MRWxlbWVudDwidSImJmUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCl7Y29uc3QgYT1ncyhlKTtzKGEpO3JldHVybn1pZihlLnN1YnN0cigwLDcpPT09InNvdXJjZToiKXtzKGUuc3Vic3RyKDcpKTtyZXR1cm59aWYoZS5zdWJzdHIoMCw3KT09PSJiYXNlNjQ6Iil7Y29uc3QgYT13aW5kb3cuYXRvYihlLnN1YnN0cig3KSk7cyhhKTtyZXR1cm59Y29uc3Qgcj1VLkdldFNoYWRlcnNTdG9yZSh0aGlzLl9zaGFkZXJMYW5ndWFnZSk7aWYocltlK3QrIlNoYWRlciJdKXtzKHJbZSt0KyJTaGFkZXIiXSk7cmV0dXJufWlmKGkmJnJbZStpKyJTaGFkZXIiXSl7cyhyW2UraSsiU2hhZGVyIl0pO3JldHVybn1sZXQgbjtlWzBdPT09Ii4ifHxlWzBdPT09Ii8ifHxlLmluZGV4T2YoImh0dHAiKT4tMT9uPWU6bj1VLkdldFNoYWRlcnNSZXBvc2l0b3J5KHRoaXMuX3NoYWRlckxhbmd1YWdlKStlLHRoaXMuX2VuZ2luZS5fbG9hZEZpbGUobisiLiIrdC50b0xvd2VyQ2FzZSgpKyIuZngiLHMpfWdldCB2ZXJ0ZXhTb3VyY2VDb2RlKCl7dmFyIGUsdDtyZXR1cm4gdGhpcy5fdmVydGV4U291cmNlQ29kZU92ZXJyaWRlJiZ0aGlzLl9mcmFnbWVudFNvdXJjZUNvZGVPdmVycmlkZT90aGlzLl92ZXJ0ZXhTb3VyY2VDb2RlT3ZlcnJpZGU6KHQ9KGU9dGhpcy5fcGlwZWxpbmVDb250ZXh0KT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUuX2dldFZlcnRleFNoYWRlckNvZGUoKSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6dGhpcy5fdmVydGV4U291cmNlQ29kZX1nZXQgZnJhZ21lbnRTb3VyY2VDb2RlKCl7dmFyIGUsdDtyZXR1cm4gdGhpcy5fdmVydGV4U291cmNlQ29kZU92ZXJyaWRlJiZ0aGlzLl9mcmFnbWVudFNvdXJjZUNvZGVPdmVycmlkZT90aGlzLl9mcmFnbWVudFNvdXJjZUNvZGVPdmVycmlkZToodD0oZT10aGlzLl9waXBlbGluZUNvbnRleHQpPT09bnVsbHx8ZT09PXZvaWQgMD92b2lkIDA6ZS5fZ2V0RnJhZ21lbnRTaGFkZXJDb2RlKCkpIT09bnVsbCYmdCE9PXZvaWQgMD90OnRoaXMuX2ZyYWdtZW50U291cmNlQ29kZX1nZXQgdmVydGV4U291cmNlQ29kZUJlZm9yZU1pZ3JhdGlvbigpe3JldHVybiB0aGlzLl92ZXJ0ZXhTb3VyY2VDb2RlQmVmb3JlTWlncmF0aW9ufWdldCBmcmFnbWVudFNvdXJjZUNvZGVCZWZvcmVNaWdyYXRpb24oKXtyZXR1cm4gdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlQmVmb3JlTWlncmF0aW9ufWdldCByYXdWZXJ0ZXhTb3VyY2VDb2RlKCl7cmV0dXJuIHRoaXMuX3Jhd1ZlcnRleFNvdXJjZUNvZGV9Z2V0IHJhd0ZyYWdtZW50U291cmNlQ29kZSgpe3JldHVybiB0aGlzLl9yYXdGcmFnbWVudFNvdXJjZUNvZGV9X3JlYnVpbGRQcm9ncmFtKGUsdCxpLHMpe3RoaXMuX2lzUmVhZHk9ITEsdGhpcy5fdmVydGV4U291cmNlQ29kZU92ZXJyaWRlPWUsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlT3ZlcnJpZGU9dCx0aGlzLm9uRXJyb3I9KHIsbik9PntzJiZzKG4pfSx0aGlzLm9uQ29tcGlsZWQ9KCk9Pntjb25zdCByPXRoaXMuZ2V0RW5naW5lKCkuc2NlbmVzO2lmKHIpZm9yKGxldCBuPTA7bjxyLmxlbmd0aDtuKyspcltuXS5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSg2Myk7dGhpcy5fcGlwZWxpbmVDb250ZXh0Ll9oYW5kbGVzU3BlY3RvclJlYnVpbGRDYWxsYmFjayhpKX0sdGhpcy5fZmFsbGJhY2tzPW51bGwsdGhpcy5fcHJlcGFyZUVmZmVjdCgpfV9wcmVwYXJlRWZmZWN0KCl7Y29uc3QgZT10aGlzLl9hdHRyaWJ1dGVzTmFtZXMsdD10aGlzLmRlZmluZXMsaT10aGlzLl9waXBlbGluZUNvbnRleHQ7dGhpcy5faXNSZWFkeT0hMTt0cnl7Y29uc3Qgcz10aGlzLl9lbmdpbmU7dGhpcy5fcGlwZWxpbmVDb250ZXh0PXMuY3JlYXRlUGlwZWxpbmVDb250ZXh0KHRoaXMuX3Byb2Nlc3NpbmdDb250ZXh0KSx0aGlzLl9waXBlbGluZUNvbnRleHQuX25hbWU9dGhpcy5fa2V5O2NvbnN0IHI9dGhpcy5fcmVidWlsZFByb2dyYW0uYmluZCh0aGlzKTt0aGlzLl92ZXJ0ZXhTb3VyY2VDb2RlT3ZlcnJpZGUmJnRoaXMuX2ZyYWdtZW50U291cmNlQ29kZU92ZXJyaWRlP3MuX3ByZXBhcmVQaXBlbGluZUNvbnRleHQodGhpcy5fcGlwZWxpbmVDb250ZXh0LHRoaXMuX3ZlcnRleFNvdXJjZUNvZGVPdmVycmlkZSx0aGlzLl9mcmFnbWVudFNvdXJjZUNvZGVPdmVycmlkZSwhMCx0aGlzLl9yYXdWZXJ0ZXhTb3VyY2VDb2RlLHRoaXMuX3Jhd0ZyYWdtZW50U291cmNlQ29kZSxyLG51bGwsdGhpcy5fdHJhbnNmb3JtRmVlZGJhY2tWYXJ5aW5ncyx0aGlzLl9rZXkpOnMuX3ByZXBhcmVQaXBlbGluZUNvbnRleHQodGhpcy5fcGlwZWxpbmVDb250ZXh0LHRoaXMuX3ZlcnRleFNvdXJjZUNvZGUsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlLCExLHRoaXMuX3Jhd1ZlcnRleFNvdXJjZUNvZGUsdGhpcy5fcmF3RnJhZ21lbnRTb3VyY2VDb2RlLHIsdCx0aGlzLl90cmFuc2Zvcm1GZWVkYmFja1ZhcnlpbmdzLHRoaXMuX2tleSkscy5fZXhlY3V0ZVdoZW5SZW5kZXJpbmdTdGF0ZUlzQ29tcGlsZWQodGhpcy5fcGlwZWxpbmVDb250ZXh0LCgpPT57aWYodGhpcy5fYXR0cmlidXRlcz1bXSx0aGlzLl9waXBlbGluZUNvbnRleHQuX2ZpbGxFZmZlY3RJbmZvcm1hdGlvbih0aGlzLHRoaXMuX3VuaWZvcm1CdWZmZXJzTmFtZXMsdGhpcy5fdW5pZm9ybXNOYW1lcyx0aGlzLl91bmlmb3Jtcyx0aGlzLl9zYW1wbGVyTGlzdCx0aGlzLl9zYW1wbGVycyxlLHRoaXMuX2F0dHJpYnV0ZXMpLGUpZm9yKGxldCBuPTA7bjxlLmxlbmd0aDtuKyspe2NvbnN0IGE9ZVtuXTt0aGlzLl9hdHRyaWJ1dGVMb2NhdGlvbkJ5TmFtZVthXT10aGlzLl9hdHRyaWJ1dGVzW25dfXMuYmluZFNhbXBsZXJzKHRoaXMpLHRoaXMuX2NvbXBpbGF0aW9uRXJyb3I9IiIsdGhpcy5faXNSZWFkeT0hMCx0aGlzLm9uQ29tcGlsZWQmJnRoaXMub25Db21waWxlZCh0aGlzKSx0aGlzLm9uQ29tcGlsZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25Db21waWxlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX2ZhbGxiYWNrcyYmdGhpcy5fZmFsbGJhY2tzLnVuQmluZE1lc2goKSxpJiZ0aGlzLmdldEVuZ2luZSgpLl9kZWxldGVQaXBlbGluZUNvbnRleHQoaSl9KSx0aGlzLl9waXBlbGluZUNvbnRleHQuaXNBc3luYyYmdGhpcy5fY2hlY2tJc1JlYWR5KGkpfWNhdGNoKHMpe3RoaXMuX3Byb2Nlc3NDb21waWxhdGlvbkVycm9ycyhzLGkpfX1fZ2V0U2hhZGVyQ29kZUFuZEVycm9yTGluZShlLHQsaSl7Y29uc3Qgcz1pPy9GUkFHTUVOVCBTSEFERVIgRVJST1I6IDA6KFxkKz8pOi86L1ZFUlRFWCBTSEFERVIgRVJST1I6IDA6KFxkKz8pOi87bGV0IHI9bnVsbDtpZih0JiZlKXtjb25zdCBuPXQubWF0Y2gocyk7aWYobiYmbi5sZW5ndGg9PT0yKXtjb25zdCBhPXBhcnNlSW50KG5bMV0pLG89ZS5zcGxpdChgCmAsLTEpO28ubGVuZ3RoPj1hJiYocj1gT2ZmZW5kaW5nIGxpbmUgWyR7YX1dIGluICR7aT8iZnJhZ21lbnQiOiJ2ZXJ0ZXgifSBjb2RlOiAke29bYS0xXX1gKX19cmV0dXJuW2Uscl19X3Byb2Nlc3NDb21waWxhdGlvbkVycm9ycyhlLHQ9bnVsbCl7dmFyIGkscyxyO3RoaXMuX2NvbXBpbGF0aW9uRXJyb3I9ZS5tZXNzYWdlO2NvbnN0IG49dGhpcy5fYXR0cmlidXRlc05hbWVzLGE9dGhpcy5fZmFsbGJhY2tzO2lmKE8uRXJyb3IoIlVuYWJsZSB0byBjb21waWxlIGVmZmVjdDoiKSxPLkVycm9yKCJVbmlmb3JtczogIit0aGlzLl91bmlmb3Jtc05hbWVzLm1hcChmdW5jdGlvbihoKXtyZXR1cm4iICIraH0pKSxPLkVycm9yKCJBdHRyaWJ1dGVzOiAiK24ubWFwKGZ1bmN0aW9uKGgpe3JldHVybiIgIitofSkpLE8uRXJyb3IoYERlZmluZXM6XHIKYCt0aGlzLmRlZmluZXMpLFBlLkxvZ1NoYWRlckNvZGVPbkNvbXBpbGF0aW9uRXJyb3Ipe2xldCBoPW51bGwsbD1udWxsLHU9bnVsbDshKChpPXRoaXMuX3BpcGVsaW5lQ29udGV4dCk9PT1udWxsfHxpPT09dm9pZCAwKSYmaS5fZ2V0VmVydGV4U2hhZGVyQ29kZSgpJiYoW3UsaF09dGhpcy5fZ2V0U2hhZGVyQ29kZUFuZEVycm9yTGluZSh0aGlzLl9waXBlbGluZUNvbnRleHQuX2dldFZlcnRleFNoYWRlckNvZGUoKSx0aGlzLl9jb21waWxhdGlvbkVycm9yLCExKSx1JiYoTy5FcnJvcigiVmVydGV4IGNvZGU6IiksTy5FcnJvcih1KSkpLCEoKHM9dGhpcy5fcGlwZWxpbmVDb250ZXh0KT09PW51bGx8fHM9PT12b2lkIDApJiZzLl9nZXRGcmFnbWVudFNoYWRlckNvZGUoKSYmKFt1LGxdPXRoaXMuX2dldFNoYWRlckNvZGVBbmRFcnJvckxpbmUoKHI9dGhpcy5fcGlwZWxpbmVDb250ZXh0KT09PW51bGx8fHI9PT12b2lkIDA/dm9pZCAwOnIuX2dldEZyYWdtZW50U2hhZGVyQ29kZSgpLHRoaXMuX2NvbXBpbGF0aW9uRXJyb3IsITApLHUmJihPLkVycm9yKCJGcmFnbWVudCBjb2RlOiIpLE8uRXJyb3IodSkpKSxoJiZPLkVycm9yKGgpLGwmJk8uRXJyb3IobCl9Ty5FcnJvcigiRXJyb3I6ICIrdGhpcy5fY29tcGlsYXRpb25FcnJvcik7Y29uc3Qgbz0oKT0+e3RoaXMub25FcnJvciYmdGhpcy5vbkVycm9yKHRoaXMsdGhpcy5fY29tcGlsYXRpb25FcnJvciksdGhpcy5vbkVycm9yT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyl9O3QmJih0aGlzLl9waXBlbGluZUNvbnRleHQ9dCx0aGlzLl9pc1JlYWR5PSEwLG8oKSksYT8odGhpcy5fcGlwZWxpbmVDb250ZXh0PW51bGwsYS5oYXNNb3JlRmFsbGJhY2tzPyh0aGlzLl9hbGxGYWxsYmFja3NQcm9jZXNzZWQ9ITEsTy5FcnJvcigiVHJ5aW5nIG5leHQgZmFsbGJhY2suIiksdGhpcy5kZWZpbmVzPWEucmVkdWNlKHRoaXMuZGVmaW5lcyx0aGlzKSx0aGlzLl9wcmVwYXJlRWZmZWN0KCkpOih0aGlzLl9hbGxGYWxsYmFja3NQcm9jZXNzZWQ9ITAsbygpLHRoaXMub25FcnJvck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9mYWxsYmFja3MmJnRoaXMuX2ZhbGxiYWNrcy51bkJpbmRNZXNoKCkpKToodGhpcy5fYWxsRmFsbGJhY2tzUHJvY2Vzc2VkPSEwLHR8fG8oKSl9Z2V0IGlzU3VwcG9ydGVkKCl7cmV0dXJuIHRoaXMuX2NvbXBpbGF0aW9uRXJyb3I9PT0iIn1fYmluZFRleHR1cmUoZSx0KXt0aGlzLl9lbmdpbmUuX2JpbmRUZXh0dXJlKHRoaXMuX3NhbXBsZXJzW2VdLHQsZSl9c2V0VGV4dHVyZShlLHQpe3RoaXMuX2VuZ2luZS5zZXRUZXh0dXJlKHRoaXMuX3NhbXBsZXJzW2VdLHRoaXMuX3VuaWZvcm1zW2VdLHQsZSl9c2V0RGVwdGhTdGVuY2lsVGV4dHVyZShlLHQpe3RoaXMuX2VuZ2luZS5zZXREZXB0aFN0ZW5jaWxUZXh0dXJlKHRoaXMuX3NhbXBsZXJzW2VdLHRoaXMuX3VuaWZvcm1zW2VdLHQsZSl9c2V0VGV4dHVyZUFycmF5KGUsdCl7Y29uc3QgaT1lKyJFeCI7aWYodGhpcy5fc2FtcGxlckxpc3QuaW5kZXhPZihpKyIwIik9PT0tMSl7Y29uc3Qgcz10aGlzLl9zYW1wbGVyTGlzdC5pbmRleE9mKGUpO2ZvcihsZXQgbj0xO248dC5sZW5ndGg7bisrKXtjb25zdCBhPWkrKG4tMSkudG9TdHJpbmcoKTt0aGlzLl9zYW1wbGVyTGlzdC5zcGxpY2UocytuLDAsYSl9bGV0IHI9MDtmb3IoY29uc3QgbiBvZiB0aGlzLl9zYW1wbGVyTGlzdCl0aGlzLl9zYW1wbGVyc1tuXT1yLHIrPTF9dGhpcy5fZW5naW5lLnNldFRleHR1cmVBcnJheSh0aGlzLl9zYW1wbGVyc1tlXSx0aGlzLl91bmlmb3Jtc1tlXSx0LGUpfXNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3MoZSx0KXt0aGlzLl9lbmdpbmUuc2V0VGV4dHVyZUZyb21Qb3N0UHJvY2Vzcyh0aGlzLl9zYW1wbGVyc1tlXSx0LGUpfXNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3NPdXRwdXQoZSx0KXt0aGlzLl9lbmdpbmUuc2V0VGV4dHVyZUZyb21Qb3N0UHJvY2Vzc091dHB1dCh0aGlzLl9zYW1wbGVyc1tlXSx0LGUpfWJpbmRVbmlmb3JtQnVmZmVyKGUsdCl7Y29uc3QgaT10aGlzLl91bmlmb3JtQnVmZmVyc05hbWVzW3RdO2k9PT12b2lkIDB8fFBlLl9CYXNlQ2FjaGVbaV09PT1lJiZ0aGlzLl9lbmdpbmUuX2ZlYXR1cmVzLnVzZVVCT0JpbmRpbmdDYWNoZXx8KFBlLl9CYXNlQ2FjaGVbaV09ZSx0aGlzLl9lbmdpbmUuYmluZFVuaWZvcm1CdWZmZXJCYXNlKGUsaSx0KSl9YmluZFVuaWZvcm1CbG9jayhlLHQpe3RoaXMuX2VuZ2luZS5iaW5kVW5pZm9ybUJsb2NrKHRoaXMuX3BpcGVsaW5lQ29udGV4dCxlLHQpfXNldEZsb2F0QXJyYXkoZSx0KXtyZXR1cm4gdGhpcy5fcGlwZWxpbmVDb250ZXh0LnNldEFycmF5KGUsdCksdGhpc31zZXRGbG9hdEFycmF5MihlLHQpe3JldHVybiB0aGlzLl9waXBlbGluZUNvbnRleHQuc2V0QXJyYXkyKGUsdCksdGhpc31zZXRGbG9hdEFycmF5MyhlLHQpe3JldHVybiB0aGlzLl9waXBlbGluZUNvbnRleHQuc2V0QXJyYXkzKGUsdCksdGhpc31zZXRGbG9hdEFycmF5NChlLHQpe3JldHVybiB0aGlzLl9waXBlbGluZUNvbnRleHQuc2V0QXJyYXk0KGUsdCksdGhpc31zZXRCb29sKGUsdCl7cmV0dXJuIHRoaXMuX3BpcGVsaW5lQ29udGV4dC5zZXRJbnQoZSx0PzE6MCksdGhpc31kaXNwb3NlKCl7dmFyIGU7KGU9dGhpcy5fcGlwZWxpbmVDb250ZXh0KT09PW51bGx8fGU9PT12b2lkIDB8fGUuZGlzcG9zZSgpLHRoaXMuX2VuZ2luZS5fcmVsZWFzZUVmZmVjdCh0aGlzKSx0aGlzLl9pc0Rpc3Bvc2VkPSEwfXN0YXRpYyBSZWdpc3RlclNoYWRlcihlLHQsaSxzPVplLkdMU0wpe3QmJihVLkdldFNoYWRlcnNTdG9yZShzKVtgJHtlfVBpeGVsU2hhZGVyYF09dCksaSYmKFUuR2V0U2hhZGVyc1N0b3JlKHMpW2Ake2V9VmVydGV4U2hhZGVyYF09aSl9c3RhdGljIFJlc2V0Q2FjaGUoKXtQZS5fQmFzZUNhY2hlPXt9fX1QZS5Mb2dTaGFkZXJDb2RlT25Db21waWxhdGlvbkVycm9yPSEwLFBlLl9VbmlxdWVJZFNlZWQ9MCxQZS5fQmFzZUNhY2hlPXt9LFBlLlNoYWRlcnNTdG9yZT1VLlNoYWRlcnNTdG9yZSxQZS5JbmNsdWRlc1NoYWRlcnNTdG9yZT1VLkluY2x1ZGVzU2hhZGVyc1N0b3JlO2NsYXNzIHJue2NvbnN0cnVjdG9yKGU9ITApe3RoaXMuX2lzRGVwdGhUZXN0RGlydHk9ITEsdGhpcy5faXNEZXB0aE1hc2tEaXJ0eT0hMSx0aGlzLl9pc0RlcHRoRnVuY0RpcnR5PSExLHRoaXMuX2lzQ3VsbEZhY2VEaXJ0eT0hMSx0aGlzLl9pc0N1bGxEaXJ0eT0hMSx0aGlzLl9pc1pPZmZzZXREaXJ0eT0hMSx0aGlzLl9pc0Zyb250RmFjZURpcnR5PSExLGUmJnRoaXMucmVzZXQoKX1nZXQgaXNEaXJ0eSgpe3JldHVybiB0aGlzLl9pc0RlcHRoRnVuY0RpcnR5fHx0aGlzLl9pc0RlcHRoVGVzdERpcnR5fHx0aGlzLl9pc0RlcHRoTWFza0RpcnR5fHx0aGlzLl9pc0N1bGxGYWNlRGlydHl8fHRoaXMuX2lzQ3VsbERpcnR5fHx0aGlzLl9pc1pPZmZzZXREaXJ0eXx8dGhpcy5faXNGcm9udEZhY2VEaXJ0eX1nZXQgek9mZnNldCgpe3JldHVybiB0aGlzLl96T2Zmc2V0fXNldCB6T2Zmc2V0KGUpe3RoaXMuX3pPZmZzZXQhPT1lJiYodGhpcy5fek9mZnNldD1lLHRoaXMuX2lzWk9mZnNldERpcnR5PSEwKX1nZXQgek9mZnNldFVuaXRzKCl7cmV0dXJuIHRoaXMuX3pPZmZzZXRVbml0c31zZXQgek9mZnNldFVuaXRzKGUpe3RoaXMuX3pPZmZzZXRVbml0cyE9PWUmJih0aGlzLl96T2Zmc2V0VW5pdHM9ZSx0aGlzLl9pc1pPZmZzZXREaXJ0eT0hMCl9Z2V0IGN1bGxGYWNlKCl7cmV0dXJuIHRoaXMuX2N1bGxGYWNlfXNldCBjdWxsRmFjZShlKXt0aGlzLl9jdWxsRmFjZSE9PWUmJih0aGlzLl9jdWxsRmFjZT1lLHRoaXMuX2lzQ3VsbEZhY2VEaXJ0eT0hMCl9Z2V0IGN1bGwoKXtyZXR1cm4gdGhpcy5fY3VsbH1zZXQgY3VsbChlKXt0aGlzLl9jdWxsIT09ZSYmKHRoaXMuX2N1bGw9ZSx0aGlzLl9pc0N1bGxEaXJ0eT0hMCl9Z2V0IGRlcHRoRnVuYygpe3JldHVybiB0aGlzLl9kZXB0aEZ1bmN9c2V0IGRlcHRoRnVuYyhlKXt0aGlzLl9kZXB0aEZ1bmMhPT1lJiYodGhpcy5fZGVwdGhGdW5jPWUsdGhpcy5faXNEZXB0aEZ1bmNEaXJ0eT0hMCl9Z2V0IGRlcHRoTWFzaygpe3JldHVybiB0aGlzLl9kZXB0aE1hc2t9c2V0IGRlcHRoTWFzayhlKXt0aGlzLl9kZXB0aE1hc2shPT1lJiYodGhpcy5fZGVwdGhNYXNrPWUsdGhpcy5faXNEZXB0aE1hc2tEaXJ0eT0hMCl9Z2V0IGRlcHRoVGVzdCgpe3JldHVybiB0aGlzLl9kZXB0aFRlc3R9c2V0IGRlcHRoVGVzdChlKXt0aGlzLl9kZXB0aFRlc3QhPT1lJiYodGhpcy5fZGVwdGhUZXN0PWUsdGhpcy5faXNEZXB0aFRlc3REaXJ0eT0hMCl9Z2V0IGZyb250RmFjZSgpe3JldHVybiB0aGlzLl9mcm9udEZhY2V9c2V0IGZyb250RmFjZShlKXt0aGlzLl9mcm9udEZhY2UhPT1lJiYodGhpcy5fZnJvbnRGYWNlPWUsdGhpcy5faXNGcm9udEZhY2VEaXJ0eT0hMCl9cmVzZXQoKXt0aGlzLl9kZXB0aE1hc2s9ITAsdGhpcy5fZGVwdGhUZXN0PSEwLHRoaXMuX2RlcHRoRnVuYz1udWxsLHRoaXMuX2N1bGxGYWNlPW51bGwsdGhpcy5fY3VsbD1udWxsLHRoaXMuX3pPZmZzZXQ9MCx0aGlzLl96T2Zmc2V0VW5pdHM9MCx0aGlzLl9mcm9udEZhY2U9bnVsbCx0aGlzLl9pc0RlcHRoVGVzdERpcnR5PSEwLHRoaXMuX2lzRGVwdGhNYXNrRGlydHk9ITAsdGhpcy5faXNEZXB0aEZ1bmNEaXJ0eT0hMSx0aGlzLl9pc0N1bGxGYWNlRGlydHk9ITEsdGhpcy5faXNDdWxsRGlydHk9ITEsdGhpcy5faXNaT2Zmc2V0RGlydHk9ITAsdGhpcy5faXNGcm9udEZhY2VEaXJ0eT0hMX1hcHBseShlKXt0aGlzLmlzRGlydHkmJih0aGlzLl9pc0N1bGxEaXJ0eSYmKHRoaXMuY3VsbD9lLmVuYWJsZShlLkNVTExfRkFDRSk6ZS5kaXNhYmxlKGUuQ1VMTF9GQUNFKSx0aGlzLl9pc0N1bGxEaXJ0eT0hMSksdGhpcy5faXNDdWxsRmFjZURpcnR5JiYoZS5jdWxsRmFjZSh0aGlzLmN1bGxGYWNlKSx0aGlzLl9pc0N1bGxGYWNlRGlydHk9ITEpLHRoaXMuX2lzRGVwdGhNYXNrRGlydHkmJihlLmRlcHRoTWFzayh0aGlzLmRlcHRoTWFzayksdGhpcy5faXNEZXB0aE1hc2tEaXJ0eT0hMSksdGhpcy5faXNEZXB0aFRlc3REaXJ0eSYmKHRoaXMuZGVwdGhUZXN0P2UuZW5hYmxlKGUuREVQVEhfVEVTVCk6ZS5kaXNhYmxlKGUuREVQVEhfVEVTVCksdGhpcy5faXNEZXB0aFRlc3REaXJ0eT0hMSksdGhpcy5faXNEZXB0aEZ1bmNEaXJ0eSYmKGUuZGVwdGhGdW5jKHRoaXMuZGVwdGhGdW5jKSx0aGlzLl9pc0RlcHRoRnVuY0RpcnR5PSExKSx0aGlzLl9pc1pPZmZzZXREaXJ0eSYmKHRoaXMuek9mZnNldHx8dGhpcy56T2Zmc2V0VW5pdHM/KGUuZW5hYmxlKGUuUE9MWUdPTl9PRkZTRVRfRklMTCksZS5wb2x5Z29uT2Zmc2V0KHRoaXMuek9mZnNldCx0aGlzLnpPZmZzZXRVbml0cykpOmUuZGlzYWJsZShlLlBPTFlHT05fT0ZGU0VUX0ZJTEwpLHRoaXMuX2lzWk9mZnNldERpcnR5PSExKSx0aGlzLl9pc0Zyb250RmFjZURpcnR5JiYoZS5mcm9udEZhY2UodGhpcy5mcm9udEZhY2UpLHRoaXMuX2lzRnJvbnRGYWNlRGlydHk9ITEpKX19Y2xhc3MgTHR7Y29uc3RydWN0b3IoKXt0aGlzLnJlc2V0KCl9cmVzZXQoKXt0aGlzLmVuYWJsZWQ9ITEsdGhpcy5tYXNrPTI1NSx0aGlzLmZ1bmM9THQuQUxXQVlTLHRoaXMuZnVuY1JlZj0xLHRoaXMuZnVuY01hc2s9MjU1LHRoaXMub3BTdGVuY2lsRmFpbD1MdC5LRUVQLHRoaXMub3BEZXB0aEZhaWw9THQuS0VFUCx0aGlzLm9wU3RlbmNpbERlcHRoUGFzcz1MdC5SRVBMQUNFfWdldCBzdGVuY2lsRnVuYygpe3JldHVybiB0aGlzLmZ1bmN9c2V0IHN0ZW5jaWxGdW5jKGUpe3RoaXMuZnVuYz1lfWdldCBzdGVuY2lsRnVuY1JlZigpe3JldHVybiB0aGlzLmZ1bmNSZWZ9c2V0IHN0ZW5jaWxGdW5jUmVmKGUpe3RoaXMuZnVuY1JlZj1lfWdldCBzdGVuY2lsRnVuY01hc2soKXtyZXR1cm4gdGhpcy5mdW5jTWFza31zZXQgc3RlbmNpbEZ1bmNNYXNrKGUpe3RoaXMuZnVuY01hc2s9ZX1nZXQgc3RlbmNpbE9wU3RlbmNpbEZhaWwoKXtyZXR1cm4gdGhpcy5vcFN0ZW5jaWxGYWlsfXNldCBzdGVuY2lsT3BTdGVuY2lsRmFpbChlKXt0aGlzLm9wU3RlbmNpbEZhaWw9ZX1nZXQgc3RlbmNpbE9wRGVwdGhGYWlsKCl7cmV0dXJuIHRoaXMub3BEZXB0aEZhaWx9c2V0IHN0ZW5jaWxPcERlcHRoRmFpbChlKXt0aGlzLm9wRGVwdGhGYWlsPWV9Z2V0IHN0ZW5jaWxPcFN0ZW5jaWxEZXB0aFBhc3MoKXtyZXR1cm4gdGhpcy5vcFN0ZW5jaWxEZXB0aFBhc3N9c2V0IHN0ZW5jaWxPcFN0ZW5jaWxEZXB0aFBhc3MoZSl7dGhpcy5vcFN0ZW5jaWxEZXB0aFBhc3M9ZX1nZXQgc3RlbmNpbE1hc2soKXtyZXR1cm4gdGhpcy5tYXNrfXNldCBzdGVuY2lsTWFzayhlKXt0aGlzLm1hc2s9ZX1nZXQgc3RlbmNpbFRlc3QoKXtyZXR1cm4gdGhpcy5lbmFibGVkfXNldCBzdGVuY2lsVGVzdChlKXt0aGlzLmVuYWJsZWQ9ZX19THQuQUxXQVlTPTUxOSxMdC5LRUVQPTc2ODAsTHQuUkVQTEFDRT03NjgxO2NsYXNzIG5ue2NvbnN0cnVjdG9yKCl7dGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnM9bmV3IEFycmF5KDQpLHRoaXMuX2JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzPW5ldyBBcnJheSgyKSx0aGlzLl9ibGVuZENvbnN0YW50cz1uZXcgQXJyYXkoNCksdGhpcy5faXNCbGVuZENvbnN0YW50c0RpcnR5PSExLHRoaXMuX2FscGhhQmxlbmQ9ITEsdGhpcy5faXNBbHBoYUJsZW5kRGlydHk9ITEsdGhpcy5faXNCbGVuZEZ1bmN0aW9uUGFyYW1ldGVyc0RpcnR5PSExLHRoaXMuX2lzQmxlbmRFcXVhdGlvblBhcmFtZXRlcnNEaXJ0eT0hMSx0aGlzLnJlc2V0KCl9Z2V0IGlzRGlydHkoKXtyZXR1cm4gdGhpcy5faXNBbHBoYUJsZW5kRGlydHl8fHRoaXMuX2lzQmxlbmRGdW5jdGlvblBhcmFtZXRlcnNEaXJ0eXx8dGhpcy5faXNCbGVuZEVxdWF0aW9uUGFyYW1ldGVyc0RpcnR5fWdldCBhbHBoYUJsZW5kKCl7cmV0dXJuIHRoaXMuX2FscGhhQmxlbmR9c2V0IGFscGhhQmxlbmQoZSl7dGhpcy5fYWxwaGFCbGVuZCE9PWUmJih0aGlzLl9hbHBoYUJsZW5kPWUsdGhpcy5faXNBbHBoYUJsZW5kRGlydHk9ITApfXNldEFscGhhQmxlbmRDb25zdGFudHMoZSx0LGkscyl7dGhpcy5fYmxlbmRDb25zdGFudHNbMF09PT1lJiZ0aGlzLl9ibGVuZENvbnN0YW50c1sxXT09PXQmJnRoaXMuX2JsZW5kQ29uc3RhbnRzWzJdPT09aSYmdGhpcy5fYmxlbmRDb25zdGFudHNbM109PT1zfHwodGhpcy5fYmxlbmRDb25zdGFudHNbMF09ZSx0aGlzLl9ibGVuZENvbnN0YW50c1sxXT10LHRoaXMuX2JsZW5kQ29uc3RhbnRzWzJdPWksdGhpcy5fYmxlbmRDb25zdGFudHNbM109cyx0aGlzLl9pc0JsZW5kQ29uc3RhbnRzRGlydHk9ITApfXNldEFscGhhQmxlbmRGdW5jdGlvblBhcmFtZXRlcnMoZSx0LGkscyl7dGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbMF09PT1lJiZ0aGlzLl9ibGVuZEZ1bmN0aW9uUGFyYW1ldGVyc1sxXT09PXQmJnRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzJdPT09aSYmdGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbM109PT1zfHwodGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbMF09ZSx0aGlzLl9ibGVuZEZ1bmN0aW9uUGFyYW1ldGVyc1sxXT10LHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzJdPWksdGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbM109cyx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHk9ITApfXNldEFscGhhRXF1YXRpb25QYXJhbWV0ZXJzKGUsdCl7dGhpcy5fYmxlbmRFcXVhdGlvblBhcmFtZXRlcnNbMF09PT1lJiZ0aGlzLl9ibGVuZEVxdWF0aW9uUGFyYW1ldGVyc1sxXT09PXR8fCh0aGlzLl9ibGVuZEVxdWF0aW9uUGFyYW1ldGVyc1swXT1lLHRoaXMuX2JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzWzFdPXQsdGhpcy5faXNCbGVuZEVxdWF0aW9uUGFyYW1ldGVyc0RpcnR5PSEwKX1yZXNldCgpe3RoaXMuX2FscGhhQmxlbmQ9ITEsdGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbMF09bnVsbCx0aGlzLl9ibGVuZEZ1bmN0aW9uUGFyYW1ldGVyc1sxXT1udWxsLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzJdPW51bGwsdGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbM109bnVsbCx0aGlzLl9ibGVuZEVxdWF0aW9uUGFyYW1ldGVyc1swXT1udWxsLHRoaXMuX2JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzWzFdPW51bGwsdGhpcy5fYmxlbmRDb25zdGFudHNbMF09bnVsbCx0aGlzLl9ibGVuZENvbnN0YW50c1sxXT1udWxsLHRoaXMuX2JsZW5kQ29uc3RhbnRzWzJdPW51bGwsdGhpcy5fYmxlbmRDb25zdGFudHNbM109bnVsbCx0aGlzLl9pc0FscGhhQmxlbmREaXJ0eT0hMCx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHk9ITEsdGhpcy5faXNCbGVuZEVxdWF0aW9uUGFyYW1ldGVyc0RpcnR5PSExLHRoaXMuX2lzQmxlbmRDb25zdGFudHNEaXJ0eT0hMX1hcHBseShlKXt0aGlzLmlzRGlydHkmJih0aGlzLl9pc0FscGhhQmxlbmREaXJ0eSYmKHRoaXMuX2FscGhhQmxlbmQ/ZS5lbmFibGUoZS5CTEVORCk6ZS5kaXNhYmxlKGUuQkxFTkQpLHRoaXMuX2lzQWxwaGFCbGVuZERpcnR5PSExKSx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHkmJihlLmJsZW5kRnVuY1NlcGFyYXRlKHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzBdLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzFdLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzJdLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzNdKSx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHk9ITEpLHRoaXMuX2lzQmxlbmRFcXVhdGlvblBhcmFtZXRlcnNEaXJ0eSYmKGUuYmxlbmRFcXVhdGlvblNlcGFyYXRlKHRoaXMuX2JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzWzBdLHRoaXMuX2JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzWzFdKSx0aGlzLl9pc0JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzRGlydHk9ITEpLHRoaXMuX2lzQmxlbmRDb25zdGFudHNEaXJ0eSYmKGUuYmxlbmRDb2xvcih0aGlzLl9ibGVuZENvbnN0YW50c1swXSx0aGlzLl9ibGVuZENvbnN0YW50c1sxXSx0aGlzLl9ibGVuZENvbnN0YW50c1syXSx0aGlzLl9ibGVuZENvbnN0YW50c1szXSksdGhpcy5faXNCbGVuZENvbnN0YW50c0RpcnR5PSExKSl9fWNsYXNzIGFue2NvbnN0cnVjdG9yKCl7dGhpcy5zaGFkZXJMYW5ndWFnZT1aZS5HTFNMfXBvc3RQcm9jZXNzb3IoZSx0LGkscyxyKXtpZighci5nZXRDYXBzKCkuZHJhd0J1ZmZlcnNFeHRlbnNpb24pe2NvbnN0IG49LyNleHRlbnNpb24uK0dMX0VYVF9kcmF3X2J1ZmZlcnMuKyhlbmFibGV8cmVxdWlyZSkvZztlPWUucmVwbGFjZShuLCIiKX1yZXR1cm4gZX19Y2xhc3Mgb257Y29uc3RydWN0b3IoKXt0aGlzLnNoYWRlckxhbmd1YWdlPVplLkdMU0x9YXR0cmlidXRlUHJvY2Vzc29yKGUpe3JldHVybiBlLnJlcGxhY2UoImF0dHJpYnV0ZSIsImluIil9dmFyeWluZ1Byb2Nlc3NvcihlLHQpe3JldHVybiBlLnJlcGxhY2UoInZhcnlpbmciLHQ/ImluIjoib3V0Iil9cG9zdFByb2Nlc3NvcihlLHQsaSl7Y29uc3Qgcz1lLnNlYXJjaCgvI2V4dGVuc2lvbi4rR0xfRVhUX2RyYXdfYnVmZmVycy4rcmVxdWlyZS8pIT09LTEscj0vI2V4dGVuc2lvbi4rKEdMX09WUl9tdWx0aXZpZXcyfEdMX09FU19zdGFuZGFyZF9kZXJpdmF0aXZlc3xHTF9FWFRfc2hhZGVyX3RleHR1cmVfbG9kfEdMX0VYVF9mcmFnX2RlcHRofEdMX0VYVF9kcmF3X2J1ZmZlcnMpLisoZW5hYmxlfHJlcXVpcmUpL2c7aWYoZT1lLnJlcGxhY2UociwiIiksZT1lLnJlcGxhY2UoL3RleHR1cmUyRFxzKlwoL2csInRleHR1cmUoIiksaSllPWUucmVwbGFjZSgvdGV4dHVyZTJETG9kRVhUXHMqXCgvZywidGV4dHVyZUxvZCgiKSxlPWUucmVwbGFjZSgvdGV4dHVyZUN1YmVMb2RFWFRccypcKC9nLCJ0ZXh0dXJlTG9kKCIpLGU9ZS5yZXBsYWNlKC90ZXh0dXJlQ3ViZVxzKlwoL2csInRleHR1cmUoIiksZT1lLnJlcGxhY2UoL2dsX0ZyYWdEZXB0aEVYVC9nLCJnbF9GcmFnRGVwdGgiKSxlPWUucmVwbGFjZSgvZ2xfRnJhZ0NvbG9yL2csImdsRnJhZ0NvbG9yIiksZT1lLnJlcGxhY2UoL2dsX0ZyYWdEYXRhL2csImdsRnJhZ0RhdGEiKSxlPWUucmVwbGFjZSgvdm9pZFxzKz9tYWluXHMqXCgvZywocz8iIjpgbGF5b3V0KGxvY2F0aW9uID0gMCkgb3V0IHZlYzQgZ2xGcmFnQ29sb3I7CmApKyJ2b2lkIG1haW4oIik7ZWxzZSBpZih0LmluZGV4T2YoIiNkZWZpbmUgTVVMVElWSUVXIikhPT0tMSlyZXR1cm5gI2V4dGVuc2lvbiBHTF9PVlJfbXVsdGl2aWV3MiA6IHJlcXVpcmUKbGF5b3V0IChudW1fdmlld3MgPSAyKSBpbjsKYCtlO3JldHVybiBlfX1jbGFzcyBQaXtjb25zdHJ1Y3Rvcigpe3RoaXMucmVmZXJlbmNlcz0wLHRoaXMuY2FwYWNpdHk9MCx0aGlzLmlzMzJCaXRzPSExLHRoaXMudW5pcXVlSWQ9UGkuX0NvdW50ZXIrK31nZXQgdW5kZXJseWluZ1Jlc291cmNlKCl7cmV0dXJuIG51bGx9fVBpLl9Db3VudGVyPTA7Y2xhc3MgRGkgZXh0ZW5kcyBQaXtjb25zdHJ1Y3RvcihlKXtzdXBlcigpLHRoaXMuX2J1ZmZlcj1lfWdldCB1bmRlcmx5aW5nUmVzb3VyY2UoKXtyZXR1cm4gdGhpcy5fYnVmZmVyfX1jb25zdCBobj1bIkludCIsIkludDIiLCJJbnQzIiwiSW50NCIsIlVJbnQiLCJVSW50MiIsIlVJbnQzIiwiVUludDQiLCJWZWN0b3IyIiwiVmVjdG9yMyIsIlZlY3RvcjQiLCJGbG9hdDIiLCJGbG9hdCIsIkZsb2F0MyIsIkZsb2F0NCIsIlF1YXRlcm5pb24iLCJDb2xvcjMiLCJDb2xvcjQiLCJEaXJlY3RDb2xvcjQiXTtjbGFzcyBsbntjb25zdHJ1Y3Rvcigpe3RoaXMuX3ZhbHVlQ2FjaGU9e30sdGhpcy52ZXJ0ZXhDb21waWxhdGlvbkVycm9yPW51bGwsdGhpcy5mcmFnbWVudENvbXBpbGF0aW9uRXJyb3I9bnVsbCx0aGlzLnByb2dyYW1MaW5rRXJyb3I9bnVsbCx0aGlzLnByb2dyYW1WYWxpZGF0aW9uRXJyb3I9bnVsbDtjb25zdCBlPVtdLHQ9ZnVuY3Rpb24oKXtlLmxlbmd0aD0wLEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGUsYXJndW1lbnRzKSxlWzBdPXRoaXMuX3VuaWZvcm1zW2VbMF1dfSxpPXM9Pntjb25zdCByPWhuLmluY2x1ZGVzKHMuc3Vic3RyaW5nKDMpKSYmIkZsb2F0TiI7aWYocil7Y29uc3Qgbj10aGlzW2BfY2FjaGUke3J9YF07cmV0dXJuIGZ1bmN0aW9uKCl7Y29uc3QgYT10aGlzLmVuZ2luZVtzXTt0LmFwcGx5KHRoaXMsYXJndW1lbnRzKSxuLmFwcGx5KHRoaXMsYXJndW1lbnRzKSYmKGEuYXBwbHkodGhpcy5lbmdpbmUsZSl8fCh0aGlzLl92YWx1ZUNhY2hlW2FyZ3VtZW50c1swXV09bnVsbCkpfX1lbHNlIHJldHVybiBmdW5jdGlvbigpe2NvbnN0IG49dGhpcy5lbmdpbmVbc107dC5hcHBseSh0aGlzLGFyZ3VtZW50cyksYXJndW1lbnRzWzFdIT09dm9pZCAwJiYodGhpcy5fdmFsdWVDYWNoZVthcmd1bWVudHNbMF1dPW51bGwsbi5hcHBseSh0aGlzLmVuZ2luZSxlKSl9fTtbIkludD8iLCJVSW50PyIsIkludEFycmF5PyIsIlVJbnRBcnJheT8iLCJBcnJheT8iLCJGbG9hdD8iLCJNYXRyaWNlcyIsIk1hdHJpeDN4MyIsIk1hdHJpeDJ4MiJdLmZvckVhY2gocz0+e2NvbnN0IHI9YHNldCR7c31gO3RoaXNbcl18fChyLmVuZHNXaXRoKCI/Iik/WyIiLDIsMyw0XS5mb3JFYWNoKG49Pnt0aGlzW3Iuc2xpY2UoMCwtMSkrbl09dGhpc1tyLnNsaWNlKDAsLTEpK25dfHxpKHIuc2xpY2UoMCwtMSkrbikuYmluZCh0aGlzKX0pOnRoaXNbcl09dGhpc1tyXXx8aShyKS5iaW5kKHRoaXMpKX0pfWdldCBpc0FzeW5jKCl7cmV0dXJuIHRoaXMuaXNQYXJhbGxlbENvbXBpbGVkfWdldCBpc1JlYWR5KCl7cmV0dXJuIHRoaXMucHJvZ3JhbT90aGlzLmlzUGFyYWxsZWxDb21waWxlZD90aGlzLmVuZ2luZS5faXNSZW5kZXJpbmdTdGF0ZUNvbXBpbGVkKHRoaXMpOiEwOiExfV9oYW5kbGVzU3BlY3RvclJlYnVpbGRDYWxsYmFjayhlKXtlJiZ0aGlzLnByb2dyYW0mJmUodGhpcy5wcm9ncmFtKX1fZmlsbEVmZmVjdEluZm9ybWF0aW9uKGUsdCxpLHMscixuLGEsbyl7Y29uc3QgaD10aGlzLmVuZ2luZTtpZihoLnN1cHBvcnRzVW5pZm9ybUJ1ZmZlcnMpZm9yKGNvbnN0IGQgaW4gdCllLmJpbmRVbmlmb3JtQmxvY2soZCx0W2RdKTt0aGlzLmVuZ2luZS5nZXRVbmlmb3Jtcyh0aGlzLGkpLmZvckVhY2goKGQsZik9PntzW2lbZl1dPWR9KSx0aGlzLl91bmlmb3Jtcz1zO2xldCB1O2Zvcih1PTA7dTxyLmxlbmd0aDt1KyspZS5nZXRVbmlmb3JtKHJbdV0pPT1udWxsJiYoci5zcGxpY2UodSwxKSx1LS0pO3IuZm9yRWFjaCgoZCxmKT0+e25bZF09Zn0pO2Zvcihjb25zdCBkIG9mIGguZ2V0QXR0cmlidXRlcyh0aGlzLGEpKW8ucHVzaChkKX1kaXNwb3NlKCl7dGhpcy5fdW5pZm9ybXM9e319X2NhY2hlTWF0cml4KGUsdCl7Y29uc3QgaT10aGlzLl92YWx1ZUNhY2hlW2VdLHM9dC51cGRhdGVGbGFnO3JldHVybiBpIT09dm9pZCAwJiZpPT09cz8hMToodGhpcy5fdmFsdWVDYWNoZVtlXT1zLCEwKX1fY2FjaGVGbG9hdE4oZSx0LGkscyxyKXtsZXQgbj10aGlzLl92YWx1ZUNhY2hlW2FyZ3VtZW50c1swXV07aWYoIW58fG4ubGVuZ3RoIT09YXJndW1lbnRzLmxlbmd0aC0xKXJldHVybiBuPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSx0aGlzLl92YWx1ZUNhY2hlW2FyZ3VtZW50c1swXV09biwhMDtsZXQgYT0hMTtmb3IobGV0IG89MDtvPG4ubGVuZ3RoOysrbyluW29dIT09YXJndW1lbnRzW28rMV0mJihuW29dPWFyZ3VtZW50c1tvKzFdLGE9ITApO3JldHVybiBhfV9jYWNoZUZsb2F0MihlLHQsaSl7cmV0dXJuIHRoaXMuX2NhY2hlRmxvYXROKGUsdCxpKX1fY2FjaGVGbG9hdDMoZSx0LGkscyl7cmV0dXJuIHRoaXMuX2NhY2hlRmxvYXROKGUsdCxpLHMpfV9jYWNoZUZsb2F0NChlLHQsaSxzLHIpe3JldHVybiB0aGlzLl9jYWNoZUZsb2F0TihlLHQsaSxzLHIpfXNldE1hdHJpeChlLHQpe3RoaXMuX2NhY2hlTWF0cml4KGUsdCkmJih0aGlzLmVuZ2luZS5zZXRNYXRyaWNlcyh0aGlzLl91bmlmb3Jtc1tlXSx0LnRvQXJyYXkoKSl8fCh0aGlzLl92YWx1ZUNhY2hlW2VdPW51bGwpKX1zZXRWZWN0b3IyKGUsdCl7dGhpcy5zZXRGbG9hdDIoZSx0LngsdC55KX1zZXRWZWN0b3IzKGUsdCl7dGhpcy5zZXRGbG9hdDMoZSx0LngsdC55LHQueil9c2V0VmVjdG9yNChlLHQpe3RoaXMuc2V0RmxvYXQ0KGUsdC54LHQueSx0LnosdC53KX1zZXRRdWF0ZXJuaW9uKGUsdCl7dGhpcy5zZXRGbG9hdDQoZSx0LngsdC55LHQueix0LncpfXNldENvbG9yMyhlLHQpe3RoaXMuc2V0RmxvYXQzKGUsdC5yLHQuZyx0LmIpfXNldENvbG9yNChlLHQsaSl7dGhpcy5zZXRGbG9hdDQoZSx0LnIsdC5nLHQuYixpKX1zZXREaXJlY3RDb2xvcjQoZSx0KXt0aGlzLnNldEZsb2F0NChlLHQucix0LmcsdC5iLHQuYSl9X2dldFZlcnRleFNoYWRlckNvZGUoKXtyZXR1cm4gdGhpcy52ZXJ0ZXhTaGFkZXI/dGhpcy5lbmdpbmUuX2dldFNoYWRlclNvdXJjZSh0aGlzLnZlcnRleFNoYWRlcik6bnVsbH1fZ2V0RnJhZ21lbnRTaGFkZXJDb2RlKCl7cmV0dXJuIHRoaXMuZnJhZ21lbnRTaGFkZXI/dGhpcy5lbmdpbmUuX2dldFNoYWRlclNvdXJjZSh0aGlzLmZyYWdtZW50U2hhZGVyKTpudWxsfX1jbGFzcyB0cntjb25zdHJ1Y3RvcihlPW51bGwsdCl7aWYodGhpcy5fTVNBQVJlbmRlckJ1ZmZlcj1udWxsLHRoaXMuX2NvbnRleHQ9dCwhZSYmKGU9dC5jcmVhdGVUZXh0dXJlKCksIWUpKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSB3ZWJHTCB0ZXh0dXJlIik7dGhpcy5zZXQoZSl9Z2V0IHVuZGVybHlpbmdSZXNvdXJjZSgpe3JldHVybiB0aGlzLl93ZWJHTFRleHR1cmV9c2V0VXNhZ2UoKXt9c2V0KGUpe3RoaXMuX3dlYkdMVGV4dHVyZT1lfXJlc2V0KCl7dGhpcy5fd2ViR0xUZXh0dXJlPW51bGwsdGhpcy5fTVNBQVJlbmRlckJ1ZmZlcj1udWxsfXJlbGVhc2UoKXt0aGlzLl9NU0FBUmVuZGVyQnVmZmVyJiYodGhpcy5fY29udGV4dC5kZWxldGVSZW5kZXJidWZmZXIodGhpcy5fTVNBQVJlbmRlckJ1ZmZlciksdGhpcy5fTVNBQVJlbmRlckJ1ZmZlcj1udWxsKSx0aGlzLl93ZWJHTFRleHR1cmUmJnRoaXMuX2NvbnRleHQuZGVsZXRlVGV4dHVyZSh0aGlzLl93ZWJHTFRleHR1cmUpLHRoaXMucmVzZXQoKX19Y2xhc3MgbWl7Y29uc3RydWN0b3IoZSx0PSEwKXt0aGlzLmVmZmVjdD1udWxsLHRoaXMuZGVmaW5lcz1udWxsLHRoaXMuZHJhd0NvbnRleHQ9ZS5jcmVhdGVEcmF3Q29udGV4dCgpLHQmJih0aGlzLm1hdGVyaWFsQ29udGV4dD1lLmNyZWF0ZU1hdGVyaWFsQ29udGV4dCgpKX1zdGF0aWMgSXNXcmFwcGVyKGUpe3JldHVybiBlLmdldFBpcGVsaW5lQ29udGV4dD09PXZvaWQgMH1zdGF0aWMgR2V0RWZmZWN0KGUpe3JldHVybiBlLmdldFBpcGVsaW5lQ29udGV4dD09PXZvaWQgMD9lLmVmZmVjdDplfXNldEVmZmVjdChlLHQsaT0hMCl7dmFyIHM7dGhpcy5lZmZlY3Q9ZSx0IT09dm9pZCAwJiYodGhpcy5kZWZpbmVzPXQpLGkmJigocz10aGlzLmRyYXdDb250ZXh0KT09PW51bGx8fHM9PT12b2lkIDB8fHMucmVzZXQoKSl9ZGlzcG9zZSgpe3ZhciBlOyhlPXRoaXMuZHJhd0NvbnRleHQpPT09bnVsbHx8ZT09PXZvaWQgMHx8ZS5kaXNwb3NlKCl9fWNsYXNzIGNue2NvbnN0cnVjdG9yKGU9ITApe3RoaXMuX2lzU3RlbmNpbFRlc3REaXJ0eT0hMSx0aGlzLl9pc1N0ZW5jaWxNYXNrRGlydHk9ITEsdGhpcy5faXNTdGVuY2lsRnVuY0RpcnR5PSExLHRoaXMuX2lzU3RlbmNpbE9wRGlydHk9ITEsdGhpcy51c2VTdGVuY2lsR2xvYmFsT25seT0hMSxlJiZ0aGlzLnJlc2V0KCl9Z2V0IGlzRGlydHkoKXtyZXR1cm4gdGhpcy5faXNTdGVuY2lsVGVzdERpcnR5fHx0aGlzLl9pc1N0ZW5jaWxNYXNrRGlydHl8fHRoaXMuX2lzU3RlbmNpbEZ1bmNEaXJ0eXx8dGhpcy5faXNTdGVuY2lsT3BEaXJ0eX1nZXQgZnVuYygpe3JldHVybiB0aGlzLl9mdW5jfXNldCBmdW5jKGUpe3RoaXMuX2Z1bmMhPT1lJiYodGhpcy5fZnVuYz1lLHRoaXMuX2lzU3RlbmNpbEZ1bmNEaXJ0eT0hMCl9Z2V0IGZ1bmNSZWYoKXtyZXR1cm4gdGhpcy5fZnVuY1JlZn1zZXQgZnVuY1JlZihlKXt0aGlzLl9mdW5jUmVmIT09ZSYmKHRoaXMuX2Z1bmNSZWY9ZSx0aGlzLl9pc1N0ZW5jaWxGdW5jRGlydHk9ITApfWdldCBmdW5jTWFzaygpe3JldHVybiB0aGlzLl9mdW5jTWFza31zZXQgZnVuY01hc2soZSl7dGhpcy5fZnVuY01hc2shPT1lJiYodGhpcy5fZnVuY01hc2s9ZSx0aGlzLl9pc1N0ZW5jaWxGdW5jRGlydHk9ITApfWdldCBvcFN0ZW5jaWxGYWlsKCl7cmV0dXJuIHRoaXMuX29wU3RlbmNpbEZhaWx9c2V0IG9wU3RlbmNpbEZhaWwoZSl7dGhpcy5fb3BTdGVuY2lsRmFpbCE9PWUmJih0aGlzLl9vcFN0ZW5jaWxGYWlsPWUsdGhpcy5faXNTdGVuY2lsT3BEaXJ0eT0hMCl9Z2V0IG9wRGVwdGhGYWlsKCl7cmV0dXJuIHRoaXMuX29wRGVwdGhGYWlsfXNldCBvcERlcHRoRmFpbChlKXt0aGlzLl9vcERlcHRoRmFpbCE9PWUmJih0aGlzLl9vcERlcHRoRmFpbD1lLHRoaXMuX2lzU3RlbmNpbE9wRGlydHk9ITApfWdldCBvcFN0ZW5jaWxEZXB0aFBhc3MoKXtyZXR1cm4gdGhpcy5fb3BTdGVuY2lsRGVwdGhQYXNzfXNldCBvcFN0ZW5jaWxEZXB0aFBhc3MoZSl7dGhpcy5fb3BTdGVuY2lsRGVwdGhQYXNzIT09ZSYmKHRoaXMuX29wU3RlbmNpbERlcHRoUGFzcz1lLHRoaXMuX2lzU3RlbmNpbE9wRGlydHk9ITApfWdldCBtYXNrKCl7cmV0dXJuIHRoaXMuX21hc2t9c2V0IG1hc2soZSl7dGhpcy5fbWFzayE9PWUmJih0aGlzLl9tYXNrPWUsdGhpcy5faXNTdGVuY2lsTWFza0RpcnR5PSEwKX1nZXQgZW5hYmxlZCgpe3JldHVybiB0aGlzLl9lbmFibGVkfXNldCBlbmFibGVkKGUpe3RoaXMuX2VuYWJsZWQhPT1lJiYodGhpcy5fZW5hYmxlZD1lLHRoaXMuX2lzU3RlbmNpbFRlc3REaXJ0eT0hMCl9cmVzZXQoKXt2YXIgZTt0aGlzLnN0ZW5jaWxNYXRlcmlhbD12b2lkIDAsKGU9dGhpcy5zdGVuY2lsR2xvYmFsKT09PW51bGx8fGU9PT12b2lkIDB8fGUucmVzZXQoKSx0aGlzLl9pc1N0ZW5jaWxUZXN0RGlydHk9ITAsdGhpcy5faXNTdGVuY2lsTWFza0RpcnR5PSEwLHRoaXMuX2lzU3RlbmNpbEZ1bmNEaXJ0eT0hMCx0aGlzLl9pc1N0ZW5jaWxPcERpcnR5PSEwfWFwcGx5KGUpe3ZhciB0O2lmKCFlKXJldHVybjtjb25zdCBpPSF0aGlzLnVzZVN0ZW5jaWxHbG9iYWxPbmx5JiYhISghKCh0PXRoaXMuc3RlbmNpbE1hdGVyaWFsKT09PW51bGx8fHQ9PT12b2lkIDApJiZ0LmVuYWJsZWQpO3RoaXMuZW5hYmxlZD1pP3RoaXMuc3RlbmNpbE1hdGVyaWFsLmVuYWJsZWQ6dGhpcy5zdGVuY2lsR2xvYmFsLmVuYWJsZWQsdGhpcy5mdW5jPWk/dGhpcy5zdGVuY2lsTWF0ZXJpYWwuZnVuYzp0aGlzLnN0ZW5jaWxHbG9iYWwuZnVuYyx0aGlzLmZ1bmNSZWY9aT90aGlzLnN0ZW5jaWxNYXRlcmlhbC5mdW5jUmVmOnRoaXMuc3RlbmNpbEdsb2JhbC5mdW5jUmVmLHRoaXMuZnVuY01hc2s9aT90aGlzLnN0ZW5jaWxNYXRlcmlhbC5mdW5jTWFzazp0aGlzLnN0ZW5jaWxHbG9iYWwuZnVuY01hc2ssdGhpcy5vcFN0ZW5jaWxGYWlsPWk/dGhpcy5zdGVuY2lsTWF0ZXJpYWwub3BTdGVuY2lsRmFpbDp0aGlzLnN0ZW5jaWxHbG9iYWwub3BTdGVuY2lsRmFpbCx0aGlzLm9wRGVwdGhGYWlsPWk/dGhpcy5zdGVuY2lsTWF0ZXJpYWwub3BEZXB0aEZhaWw6dGhpcy5zdGVuY2lsR2xvYmFsLm9wRGVwdGhGYWlsLHRoaXMub3BTdGVuY2lsRGVwdGhQYXNzPWk/dGhpcy5zdGVuY2lsTWF0ZXJpYWwub3BTdGVuY2lsRGVwdGhQYXNzOnRoaXMuc3RlbmNpbEdsb2JhbC5vcFN0ZW5jaWxEZXB0aFBhc3MsdGhpcy5tYXNrPWk/dGhpcy5zdGVuY2lsTWF0ZXJpYWwubWFzazp0aGlzLnN0ZW5jaWxHbG9iYWwubWFzayx0aGlzLmlzRGlydHkmJih0aGlzLl9pc1N0ZW5jaWxUZXN0RGlydHkmJih0aGlzLmVuYWJsZWQ/ZS5lbmFibGUoZS5TVEVOQ0lMX1RFU1QpOmUuZGlzYWJsZShlLlNURU5DSUxfVEVTVCksdGhpcy5faXNTdGVuY2lsVGVzdERpcnR5PSExKSx0aGlzLl9pc1N0ZW5jaWxNYXNrRGlydHkmJihlLnN0ZW5jaWxNYXNrKHRoaXMubWFzayksdGhpcy5faXNTdGVuY2lsTWFza0RpcnR5PSExKSx0aGlzLl9pc1N0ZW5jaWxGdW5jRGlydHkmJihlLnN0ZW5jaWxGdW5jKHRoaXMuZnVuYyx0aGlzLmZ1bmNSZWYsdGhpcy5mdW5jTWFzayksdGhpcy5faXNTdGVuY2lsRnVuY0RpcnR5PSExKSx0aGlzLl9pc1N0ZW5jaWxPcERpcnR5JiYoZS5zdGVuY2lsT3AodGhpcy5vcFN0ZW5jaWxGYWlsLHRoaXMub3BEZXB0aEZhaWwsdGhpcy5vcFN0ZW5jaWxEZXB0aFBhc3MpLHRoaXMuX2lzU3RlbmNpbE9wRGlydHk9ITEpKX19Y2xhc3MgYWl7c3RhdGljIGdldCBOb3coKXtyZXR1cm4gcHMuSXNXaW5kb3dPYmplY3RFeGlzdCgpJiZ3aW5kb3cucGVyZm9ybWFuY2UmJndpbmRvdy5wZXJmb3JtYW5jZS5ub3c/d2luZG93LnBlcmZvcm1hbmNlLm5vdygpOkRhdGUubm93KCl9fWNsYXNzIHVue31jbGFzcyBvZXtjb25zdHJ1Y3RvcihlLHQsaSxzKXt0aGlzLl9uYW1lPSJXZWJHTCIsdGhpcy5mb3JjZVBPVFRleHR1cmVzPSExLHRoaXMuaXNGdWxsc2NyZWVuPSExLHRoaXMuY3VsbEJhY2tGYWNlcz1udWxsLHRoaXMucmVuZGVyRXZlbkluQmFja2dyb3VuZD0hMCx0aGlzLnByZXZlbnRDYWNoZVdpcGVCZXR3ZWVuRnJhbWVzPSExLHRoaXMudmFsaWRhdGVTaGFkZXJQcm9ncmFtcz0hMSx0aGlzLl91c2VSZXZlcnNlRGVwdGhCdWZmZXI9ITEsdGhpcy5pc05EQ0hhbGZaUmFuZ2U9ITEsdGhpcy5oYXNPcmlnaW5Cb3R0b21MZWZ0PSEwLHRoaXMuZGlzYWJsZVVuaWZvcm1CdWZmZXJzPSExLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9mcmFtZUlkPTAsdGhpcy5fdW5pZm9ybUJ1ZmZlcnM9bmV3IEFycmF5LHRoaXMuX3N0b3JhZ2VCdWZmZXJzPW5ldyBBcnJheSx0aGlzLl93ZWJHTFZlcnNpb249MSx0aGlzLl93aW5kb3dJc0JhY2tncm91bmQ9ITEsdGhpcy5faGlnaFByZWNpc2lvblNoYWRlcnNBbGxvd2VkPSEwLHRoaXMuX2JhZE9TPSExLHRoaXMuX2JhZERlc2t0b3BPUz0hMSx0aGlzLl9yZW5kZXJpbmdRdWV1ZUxhdW5jaGVkPSExLHRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzPW5ldyBBcnJheSx0aGlzLm9uQ29udGV4dExvc3RPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25Db250ZXh0UmVzdG9yZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX2NvbnRleHRXYXNMb3N0PSExLHRoaXMuX2RvTm90SGFuZGxlQ29udGV4dExvc3Q9ITEsdGhpcy5kaXNhYmxlVmVydGV4QXJyYXlPYmplY3RzPSExLHRoaXMuX2NvbG9yV3JpdGU9ITAsdGhpcy5fY29sb3JXcml0ZUNoYW5nZWQ9ITAsdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGU9bmV3IHJuLHRoaXMuX3N0ZW5jaWxTdGF0ZUNvbXBvc2VyPW5ldyBjbix0aGlzLl9zdGVuY2lsU3RhdGU9bmV3IEx0LHRoaXMuX2FscGhhU3RhdGU9bmV3IG5uLHRoaXMuX2FscGhhTW9kZT0xLHRoaXMuX2FscGhhRXF1YXRpb249MCx0aGlzLl9pbnRlcm5hbFRleHR1cmVzQ2FjaGU9bmV3IEFycmF5LHRoaXMuX3JlbmRlclRhcmdldFdyYXBwZXJDYWNoZT1uZXcgQXJyYXksdGhpcy5fYWN0aXZlQ2hhbm5lbD0wLHRoaXMuX2N1cnJlbnRUZXh0dXJlQ2hhbm5lbD0tMSx0aGlzLl9ib3VuZFRleHR1cmVzQ2FjaGU9e30sdGhpcy5fY29tcGlsZWRFZmZlY3RzPXt9LHRoaXMuX3ZlcnRleEF0dHJpYkFycmF5c0VuYWJsZWQ9W10sdGhpcy5fdWludEluZGljZXNDdXJyZW50bHlTZXQ9ITEsdGhpcy5fY3VycmVudEJvdW5kQnVmZmVyPW5ldyBBcnJheSx0aGlzLl9jdXJyZW50RnJhbWVidWZmZXI9bnVsbCx0aGlzLl9kdW1teUZyYW1lYnVmZmVyPW51bGwsdGhpcy5fY3VycmVudEJ1ZmZlclBvaW50ZXJzPW5ldyBBcnJheSx0aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnM9bmV3IEFycmF5LHRoaXMuX2N1cnJlbnRJbnN0YW5jZUJ1ZmZlcnM9bmV3IEFycmF5LHRoaXMuX3Zhb1JlY29yZEluUHJvZ3Jlc3M9ITEsdGhpcy5fbXVzdFdpcGVWZXJ0ZXhBdHRyaWJ1dGVzPSExLHRoaXMuX25leHRGcmVlVGV4dHVyZVNsb3RzPW5ldyBBcnJheSx0aGlzLl9tYXhTaW11bHRhbmVvdXNUZXh0dXJlcz0wLHRoaXMuX21heE1TQUFTYW1wbGVzT3ZlcnJpZGU9bnVsbCx0aGlzLl9hY3RpdmVSZXF1ZXN0cz1uZXcgQXJyYXksdGhpcy5hZGFwdFRvRGV2aWNlUmF0aW89ITEsdGhpcy5fbGFzdERldmljZVBpeGVsUmF0aW89MSx0aGlzLl90cmFuc2Zvcm1UZXh0dXJlVXJsPW51bGwsdGhpcy5ob3N0SW5mb3JtYXRpb249e2lzTW9iaWxlOiExfSx0aGlzLnByZW11bHRpcGxpZWRBbHBoYT0hMCx0aGlzLm9uQmVmb3JlVGV4dHVyZUluaXRPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX2lzV2ViR1BVPSExLHRoaXMuX3NuYXBzaG90UmVuZGVyaW5nTW9kZT0wLHRoaXMuX3VzZUV4YWN0U3JnYkNvbnZlcnNpb25zPSExLHRoaXMuX3ZpZXdwb3J0Q2FjaGVkPXt4OjAseTowLHo6MCx3OjB9LHRoaXMuX3VucGFja0ZsaXBZQ2FjaGVkPW51bGwsdGhpcy5lbmFibGVVbnBhY2tGbGlwWUNhY2hlZD0hMCx0aGlzLl9ib3VuZFVuaWZvcm1zPXt9LHRoaXMuc3RhcnRUaW1lPWFpLk5vdztsZXQgcj1udWxsO2lmKGk9aXx8e30sdGhpcy5fY3JlYXRpb25PcHRpb25zPWksdGhpcy5hZGFwdFRvRGV2aWNlUmF0aW89cz8/ITEsdGhpcy5fc3RlbmNpbFN0YXRlQ29tcG9zZXIuc3RlbmNpbEdsb2JhbD10aGlzLl9zdGVuY2lsU3RhdGUsVWUuU2V0TWF0cml4UHJlY2lzaW9uKCEhaS51c2VIaWdoUHJlY2lzaW9uTWF0cml4KSwhZSlyZXR1cm47aWYocz1zfHxpLmFkYXB0VG9EZXZpY2VSYXRpb3x8ITEsZS5nZXRDb250ZXh0KXtpZihyPWUsdGhpcy5fcmVuZGVyaW5nQ2FudmFzPXIsdCE9PXZvaWQgMCYmKGkuYW50aWFsaWFzPXQpLGkuZGV0ZXJtaW5pc3RpY0xvY2tzdGVwPT09dm9pZCAwJiYoaS5kZXRlcm1pbmlzdGljTG9ja3N0ZXA9ITEpLGkubG9ja3N0ZXBNYXhTdGVwcz09PXZvaWQgMCYmKGkubG9ja3N0ZXBNYXhTdGVwcz00KSxpLnRpbWVTdGVwPT09dm9pZCAwJiYoaS50aW1lU3RlcD0xLzYwKSxpLnByZXNlcnZlRHJhd2luZ0J1ZmZlcj09PXZvaWQgMCYmKGkucHJlc2VydmVEcmF3aW5nQnVmZmVyPSExKSxpLmF1ZGlvRW5naW5lPT09dm9pZCAwJiYoaS5hdWRpb0VuZ2luZT0hMCksaS5hdWRpb0VuZ2luZU9wdGlvbnMhPT12b2lkIDAmJmkuYXVkaW9FbmdpbmVPcHRpb25zLmF1ZGlvQ29udGV4dCE9PXZvaWQgMCYmKHRoaXMuX2F1ZGlvQ29udGV4dD1pLmF1ZGlvRW5naW5lT3B0aW9ucy5hdWRpb0NvbnRleHQpLGkuYXVkaW9FbmdpbmVPcHRpb25zIT09dm9pZCAwJiZpLmF1ZGlvRW5naW5lT3B0aW9ucy5hdWRpb0Rlc3RpbmF0aW9uIT09dm9pZCAwJiYodGhpcy5fYXVkaW9EZXN0aW5hdGlvbj1pLmF1ZGlvRW5naW5lT3B0aW9ucy5hdWRpb0Rlc3RpbmF0aW9uKSxpLnN0ZW5jaWw9PT12b2lkIDAmJihpLnN0ZW5jaWw9ITApLGkucHJlbXVsdGlwbGllZEFscGhhPT09ITEmJih0aGlzLnByZW11bHRpcGxpZWRBbHBoYT0hMSksaS54ckNvbXBhdGlibGU9PT12b2lkIDAmJihpLnhyQ29tcGF0aWJsZT0hMCksaS51c2VFeGFjdFNyZ2JDb252ZXJzaW9ucyE9PXZvaWQgMCYmKHRoaXMuX3VzZUV4YWN0U3JnYkNvbnZlcnNpb25zPWkudXNlRXhhY3RTcmdiQ29udmVyc2lvbnMpLHRoaXMuX2RvTm90SGFuZGxlQ29udGV4dExvc3Q9ISFpLmRvTm90SGFuZGxlQ29udGV4dExvc3QsbmF2aWdhdG9yJiZuYXZpZ2F0b3IudXNlckFnZW50KXt0aGlzLl9jaGVja0Zvck1vYmlsZT0oKT0+e2NvbnN0IGw9bmF2aWdhdG9yLnVzZXJBZ2VudDt0aGlzLmhvc3RJbmZvcm1hdGlvbi5pc01vYmlsZT1sLmluZGV4T2YoIk1vYmlsZSIpIT09LTF8fGwuaW5kZXhPZigiTWFjIikhPT0tMSYmQ2koKSYmIm9udG91Y2hlbmQiaW4gZG9jdW1lbnR9LHRoaXMuX2NoZWNrRm9yTW9iaWxlKCksamUoKSYmd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsdGhpcy5fY2hlY2tGb3JNb2JpbGUpO2NvbnN0IGg9bmF2aWdhdG9yLnVzZXJBZ2VudDtmb3IoY29uc3QgbCBvZiBvZS5FeGNlcHRpb25MaXN0KXtjb25zdCB1PWwua2V5LGQ9bC50YXJnZXRzO2lmKG5ldyBSZWdFeHAodSkudGVzdChoKSl7aWYobC5jYXB0dXJlJiZsLmNhcHR1cmVDb25zdHJhaW50KXtjb25zdCBfPWwuY2FwdHVyZSxFPWwuY2FwdHVyZUNvbnN0cmFpbnQsdj1uZXcgUmVnRXhwKF8pLmV4ZWMoaCk7aWYodiYmdi5sZW5ndGg+MCYmcGFyc2VJbnQodlt2Lmxlbmd0aC0xXSk+PUUpY29udGludWV9Zm9yKGNvbnN0IF8gb2YgZClzd2l0Y2goXyl7Y2FzZSJ1bmlmb3JtQnVmZmVyIjp0aGlzLmRpc2FibGVVbmlmb3JtQnVmZmVycz0hMDticmVhaztjYXNlInZhbyI6dGhpcy5kaXNhYmxlVmVydGV4QXJyYXlPYmplY3RzPSEwO2JyZWFrO2Nhc2UiYW50aWFsaWFzIjppLmFudGlhbGlhcz0hMTticmVhaztjYXNlIm1heE1TQUFTYW1wbGVzIjp0aGlzLl9tYXhNU0FBU2FtcGxlc092ZXJyaWRlPTE7YnJlYWt9fX19aWYodGhpcy5fZG9Ob3RIYW5kbGVDb250ZXh0TG9zdHx8KHRoaXMuX29uQ29udGV4dExvc3Q9aD0+e2gucHJldmVudERlZmF1bHQoKSx0aGlzLl9jb250ZXh0V2FzTG9zdD0hMCxPLldhcm4oIldlYkdMIGNvbnRleHQgbG9zdC4iKSx0aGlzLm9uQ29udGV4dExvc3RPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX0sdGhpcy5fb25Db250ZXh0UmVzdG9yZWQ9KCk9Pnt0aGlzLl9yZXN0b3JlRW5naW5lQWZ0ZXJDb250ZXh0TG9zdCh0aGlzLl9pbml0R0xDb250ZXh0LmJpbmQodGhpcykpfSxyLmFkZEV2ZW50TGlzdGVuZXIoIndlYmdsY29udGV4dGxvc3QiLHRoaXMuX29uQ29udGV4dExvc3QsITEpLHIuYWRkRXZlbnRMaXN0ZW5lcigid2ViZ2xjb250ZXh0cmVzdG9yZWQiLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkLCExKSxpLnBvd2VyUHJlZmVyZW5jZT0iaGlnaC1wZXJmb3JtYW5jZSIpLHRoaXMuX2JhZERlc2t0b3BPUz0vXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLHRoaXMuX2JhZERlc2t0b3BPUyYmKGkueHJDb21wYXRpYmxlPSExKSwhaS5kaXNhYmxlV2ViR0wyU3VwcG9ydCl0cnl7dGhpcy5fZ2w9ci5nZXRDb250ZXh0KCJ3ZWJnbDIiLGkpfHxyLmdldENvbnRleHQoImV4cGVyaW1lbnRhbC13ZWJnbDIiLGkpLHRoaXMuX2dsJiYodGhpcy5fd2ViR0xWZXJzaW9uPTIsdGhpcy5fc2hhZGVyUGxhdGZvcm1OYW1lPSJXRUJHTDIiLHRoaXMuX2dsLmRlbGV0ZVF1ZXJ5fHwodGhpcy5fd2ViR0xWZXJzaW9uPTEsdGhpcy5fc2hhZGVyUGxhdGZvcm1OYW1lPSJXRUJHTDEiKSl9Y2F0Y2h7fWlmKCF0aGlzLl9nbCl7aWYoIXIpdGhyb3cgbmV3IEVycm9yKCJUaGUgcHJvdmlkZWQgY2FudmFzIGlzIG51bGwgb3IgdW5kZWZpbmVkLiIpO3RyeXt0aGlzLl9nbD1yLmdldENvbnRleHQoIndlYmdsIixpKXx8ci5nZXRDb250ZXh0KCJleHBlcmltZW50YWwtd2ViZ2wiLGkpfWNhdGNoe3Rocm93IG5ldyBFcnJvcigiV2ViR0wgbm90IHN1cHBvcnRlZCIpfX1pZighdGhpcy5fZ2wpdGhyb3cgbmV3IEVycm9yKCJXZWJHTCBub3Qgc3VwcG9ydGVkIil9ZWxzZXt0aGlzLl9nbD1lLHRoaXMuX3JlbmRlcmluZ0NhbnZhcz10aGlzLl9nbC5jYW52YXMsdGhpcy5fZ2wucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlPyh0aGlzLl93ZWJHTFZlcnNpb249Mix0aGlzLl9zaGFkZXJQbGF0Zm9ybU5hbWU9IldFQkdMMiIpOnRoaXMuX3NoYWRlclBsYXRmb3JtTmFtZT0iV0VCR0wxIjtjb25zdCBoPXRoaXMuX2dsLmdldENvbnRleHRBdHRyaWJ1dGVzKCk7aCYmKGkuc3RlbmNpbD1oLnN0ZW5jaWwpfXRoaXMuX2dsLnBpeGVsU3RvcmVpKHRoaXMuX2dsLlVOUEFDS19DT0xPUlNQQUNFX0NPTlZFUlNJT05fV0VCR0wsdGhpcy5fZ2wuTk9ORSksaS51c2VIaWdoUHJlY2lzaW9uRmxvYXRzIT09dm9pZCAwJiYodGhpcy5faGlnaFByZWNpc2lvblNoYWRlcnNBbGxvd2VkPWkudXNlSGlnaFByZWNpc2lvbkZsb2F0cyk7Y29uc3Qgbj1qZSgpJiZ3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpb3x8MSxhPWkubGltaXREZXZpY2VSYXRpb3x8bjt0aGlzLl9oYXJkd2FyZVNjYWxpbmdMZXZlbD1zPzEvTWF0aC5taW4oYSxuKToxLHRoaXMuX2xhc3REZXZpY2VQaXhlbFJhdGlvPW4sdGhpcy5yZXNpemUoKSx0aGlzLl9pc1N0ZW5jaWxFbmFibGU9ISFpLnN0ZW5jaWwsdGhpcy5faW5pdEdMQ29udGV4dCgpLHRoaXMuX2luaXRGZWF0dXJlcygpO2ZvcihsZXQgaD0wO2g8dGhpcy5fY2Fwcy5tYXhWZXJ0ZXhBdHRyaWJzO2grKyl0aGlzLl9jdXJyZW50QnVmZmVyUG9pbnRlcnNbaF09bmV3IHVuO3RoaXMuX3NoYWRlclByb2Nlc3Nvcj10aGlzLndlYkdMVmVyc2lvbj4xP25ldyBvbjpuZXcgYW4sdGhpcy5fYmFkT1M9L2lQYWQvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpfHwvaVBob25lL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtjb25zdCBvPWBCYWJ5bG9uLmpzIHYke29lLlZlcnNpb259YDtjb25zb2xlLmxvZyhvK2AgLSAke3RoaXMuZGVzY3JpcHRpb259YCksdGhpcy5fcmVuZGVyaW5nQ2FudmFzJiZ0aGlzLl9yZW5kZXJpbmdDYW52YXMuc2V0QXR0cmlidXRlJiZ0aGlzLl9yZW5kZXJpbmdDYW52YXMuc2V0QXR0cmlidXRlKCJkYXRhLWVuZ2luZSIsbyl9c3RhdGljIGdldCBOcG1QYWNrYWdlKCl7cmV0dXJuImJhYnlsb25qc0A1LjQzLjAifXN0YXRpYyBnZXQgVmVyc2lvbigpe3JldHVybiI1LjQzLjAifWdldCBkZXNjcmlwdGlvbigpe2xldCBlPXRoaXMubmFtZSt0aGlzLndlYkdMVmVyc2lvbjtyZXR1cm4gdGhpcy5fY2Fwcy5wYXJhbGxlbFNoYWRlckNvbXBpbGUmJihlKz0iIC0gUGFyYWxsZWwgc2hhZGVyIGNvbXBpbGF0aW9uIiksZX1nZXQgbmFtZSgpe3JldHVybiB0aGlzLl9uYW1lfXNldCBuYW1lKGUpe3RoaXMuX25hbWU9ZX1nZXQgdmVyc2lvbigpe3JldHVybiB0aGlzLl93ZWJHTFZlcnNpb259c3RhdGljIGdldCBTaGFkZXJzUmVwb3NpdG9yeSgpe3JldHVybiBQZS5TaGFkZXJzUmVwb3NpdG9yeX1zdGF0aWMgc2V0IFNoYWRlcnNSZXBvc2l0b3J5KGUpe1BlLlNoYWRlcnNSZXBvc2l0b3J5PWV9X2dldFNoYWRlclByb2Nlc3NvcihlKXtyZXR1cm4gdGhpcy5fc2hhZGVyUHJvY2Vzc29yfWdldCB1c2VSZXZlcnNlRGVwdGhCdWZmZXIoKXtyZXR1cm4gdGhpcy5fdXNlUmV2ZXJzZURlcHRoQnVmZmVyfXNldCB1c2VSZXZlcnNlRGVwdGhCdWZmZXIoZSl7ZSE9PXRoaXMuX3VzZVJldmVyc2VEZXB0aEJ1ZmZlciYmKHRoaXMuX3VzZVJldmVyc2VEZXB0aEJ1ZmZlcj1lLGU/dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhGdW5jPTUxODp0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aEZ1bmM9NTE1KX1nZXQgZnJhbWVJZCgpe3JldHVybiB0aGlzLl9mcmFtZUlkfWdldCBzdXBwb3J0c1VuaWZvcm1CdWZmZXJzKCl7cmV0dXJuIHRoaXMud2ViR0xWZXJzaW9uPjEmJiF0aGlzLmRpc2FibGVVbmlmb3JtQnVmZmVyc31nZXRDcmVhdGlvbk9wdGlvbnMoKXtyZXR1cm4gdGhpcy5fY3JlYXRpb25PcHRpb25zfWdldCBfc2hvdWxkVXNlSGlnaFByZWNpc2lvblNoYWRlcigpe3JldHVybiEhKHRoaXMuX2NhcHMuaGlnaFByZWNpc2lvblNoYWRlclN1cHBvcnRlZCYmdGhpcy5faGlnaFByZWNpc2lvblNoYWRlcnNBbGxvd2VkKX1nZXQgbmVlZFBPVFRleHR1cmVzKCl7cmV0dXJuIHRoaXMuX3dlYkdMVmVyc2lvbjwyfHx0aGlzLmZvcmNlUE9UVGV4dHVyZXN9Z2V0IGFjdGl2ZVJlbmRlckxvb3BzKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzfWdldCBkb05vdEhhbmRsZUNvbnRleHRMb3N0KCl7cmV0dXJuIHRoaXMuX2RvTm90SGFuZGxlQ29udGV4dExvc3R9c2V0IGRvTm90SGFuZGxlQ29udGV4dExvc3QoZSl7dGhpcy5fZG9Ob3RIYW5kbGVDb250ZXh0TG9zdD1lfWdldCBfc3VwcG9ydHNIYXJkd2FyZVRleHR1cmVSZXNjYWxpbmcoKXtyZXR1cm4hMX1zZXQgZnJhbWVidWZmZXJEaW1lbnNpb25zT2JqZWN0KGUpe3RoaXMuX2ZyYW1lYnVmZmVyRGltZW5zaW9uc09iamVjdD1lfWdldCBjdXJyZW50Vmlld3BvcnQoKXtyZXR1cm4gdGhpcy5fY2FjaGVkVmlld3BvcnR9Z2V0IGVtcHR5VGV4dHVyZSgpe3JldHVybiB0aGlzLl9lbXB0eVRleHR1cmV8fCh0aGlzLl9lbXB0eVRleHR1cmU9dGhpcy5jcmVhdGVSYXdUZXh0dXJlKG5ldyBVaW50OEFycmF5KDQpLDEsMSw1LCExLCExLDEpKSx0aGlzLl9lbXB0eVRleHR1cmV9Z2V0IGVtcHR5VGV4dHVyZTNEKCl7cmV0dXJuIHRoaXMuX2VtcHR5VGV4dHVyZTNEfHwodGhpcy5fZW1wdHlUZXh0dXJlM0Q9dGhpcy5jcmVhdGVSYXdUZXh0dXJlM0QobmV3IFVpbnQ4QXJyYXkoNCksMSwxLDEsNSwhMSwhMSwxKSksdGhpcy5fZW1wdHlUZXh0dXJlM0R9Z2V0IGVtcHR5VGV4dHVyZTJEQXJyYXkoKXtyZXR1cm4gdGhpcy5fZW1wdHlUZXh0dXJlMkRBcnJheXx8KHRoaXMuX2VtcHR5VGV4dHVyZTJEQXJyYXk9dGhpcy5jcmVhdGVSYXdUZXh0dXJlMkRBcnJheShuZXcgVWludDhBcnJheSg0KSwxLDEsMSw1LCExLCExLDEpKSx0aGlzLl9lbXB0eVRleHR1cmUyREFycmF5fWdldCBlbXB0eUN1YmVUZXh0dXJlKCl7aWYoIXRoaXMuX2VtcHR5Q3ViZVRleHR1cmUpe2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkoNCksdD1bZSxlLGUsZSxlLGVdO3RoaXMuX2VtcHR5Q3ViZVRleHR1cmU9dGhpcy5jcmVhdGVSYXdDdWJlVGV4dHVyZSh0LDEsNSwwLCExLCExLDEpfXJldHVybiB0aGlzLl9lbXB0eUN1YmVUZXh0dXJlfWdldCBpc1dlYkdQVSgpe3JldHVybiB0aGlzLl9pc1dlYkdQVX1nZXQgc2hhZGVyUGxhdGZvcm1OYW1lKCl7cmV0dXJuIHRoaXMuX3NoYWRlclBsYXRmb3JtTmFtZX1nZXQgc25hcHNob3RSZW5kZXJpbmcoKXtyZXR1cm4hMX1zZXQgc25hcHNob3RSZW5kZXJpbmcoZSl7fWdldCBzbmFwc2hvdFJlbmRlcmluZ01vZGUoKXtyZXR1cm4gdGhpcy5fc25hcHNob3RSZW5kZXJpbmdNb2RlfXNldCBzbmFwc2hvdFJlbmRlcmluZ01vZGUoZSl7dGhpcy5fc25hcHNob3RSZW5kZXJpbmdNb2RlPWV9Z2V0IHVzZUV4YWN0U3JnYkNvbnZlcnNpb25zKCl7cmV0dXJuIHRoaXMuX3VzZUV4YWN0U3JnYkNvbnZlcnNpb25zfXNuYXBzaG90UmVuZGVyaW5nUmVzZXQoKXt0aGlzLnNuYXBzaG90UmVuZGVyaW5nPSExfXN0YXRpYyBfQ3JlYXRlQ2FudmFzKGUsdCl7aWYodHlwZW9mIGRvY3VtZW50PiJ1IilyZXR1cm4gbmV3IE9mZnNjcmVlbkNhbnZhcyhlLHQpO2NvbnN0IGk9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7cmV0dXJuIGkud2lkdGg9ZSxpLmhlaWdodD10LGl9Y3JlYXRlQ2FudmFzKGUsdCl7cmV0dXJuIG9lLl9DcmVhdGVDYW52YXMoZSx0KX1jcmVhdGVDYW52YXNJbWFnZSgpe3JldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbWciKX1fcmVzdG9yZUVuZ2luZUFmdGVyQ29udGV4dExvc3QoZSl7c2V0VGltZW91dChhc3luYygpPT57dmFyIHQ7dGhpcy5fZHVtbXlGcmFtZWJ1ZmZlcj1udWxsO2NvbnN0IGk9dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhUZXN0LHM9dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhGdW5jLHI9dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhNYXNrLG49dGhpcy5fc3RlbmNpbFN0YXRlLnN0ZW5jaWxUZXN0O2F3YWl0IGUoKSx0aGlzLndpcGVDYWNoZXMoITApLHRoaXMuX3JlYnVpbGRFZmZlY3RzKCksKHQ9dGhpcy5fcmVidWlsZENvbXB1dGVFZmZlY3RzKT09PW51bGx8fHQ9PT12b2lkIDB8fHQuY2FsbCh0aGlzKSx0aGlzLl9yZWJ1aWxkQnVmZmVycygpLHRoaXMuX3JlYnVpbGRJbnRlcm5hbFRleHR1cmVzKCksdGhpcy5fcmVidWlsZFJlbmRlclRhcmdldFdyYXBwZXJzKCksdGhpcy53aXBlQ2FjaGVzKCEwKSx0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aFRlc3Q9aSx0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aEZ1bmM9cyx0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aE1hc2s9cix0aGlzLl9zdGVuY2lsU3RhdGUuc3RlbmNpbFRlc3Q9bixPLldhcm4odGhpcy5uYW1lKyIgY29udGV4dCBzdWNjZXNzZnVsbHkgcmVzdG9yZWQuIiksdGhpcy5vbkNvbnRleHRSZXN0b3JlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX2NvbnRleHRXYXNMb3N0PSExfSwwKX1fc2hhcmVkSW5pdChlLHQsaSl7dGhpcy5fcmVuZGVyaW5nQ2FudmFzPWV9X2dldFNoYWRlclByb2Nlc3NpbmdDb250ZXh0KGUpe3JldHVybiBudWxsfV9yZWJ1aWxkSW50ZXJuYWxUZXh0dXJlcygpe2NvbnN0IGU9dGhpcy5faW50ZXJuYWxUZXh0dXJlc0NhY2hlLnNsaWNlKCk7Zm9yKGNvbnN0IHQgb2YgZSl0Ll9yZWJ1aWxkKCl9X3JlYnVpbGRSZW5kZXJUYXJnZXRXcmFwcGVycygpe2NvbnN0IGU9dGhpcy5fcmVuZGVyVGFyZ2V0V3JhcHBlckNhY2hlLnNsaWNlKCk7Zm9yKGNvbnN0IHQgb2YgZSl0Ll9yZWJ1aWxkKCl9X3JlYnVpbGRFZmZlY3RzKCl7Zm9yKGNvbnN0IGUgaW4gdGhpcy5fY29tcGlsZWRFZmZlY3RzKXtjb25zdCB0PXRoaXMuX2NvbXBpbGVkRWZmZWN0c1tlXTt0Ll9waXBlbGluZUNvbnRleHQ9bnVsbCx0Ll93YXNQcmV2aW91c2x5UmVhZHk9ITEsdC5fcHJlcGFyZUVmZmVjdCgpfVBlLlJlc2V0Q2FjaGUoKX1hcmVBbGxFZmZlY3RzUmVhZHkoKXtmb3IoY29uc3QgZSBpbiB0aGlzLl9jb21waWxlZEVmZmVjdHMpaWYoIXRoaXMuX2NvbXBpbGVkRWZmZWN0c1tlXS5pc1JlYWR5KCkpcmV0dXJuITE7cmV0dXJuITB9X3JlYnVpbGRCdWZmZXJzKCl7Zm9yKGNvbnN0IGUgb2YgdGhpcy5fdW5pZm9ybUJ1ZmZlcnMpZS5fcmVidWlsZCgpO2Zvcihjb25zdCBlIG9mIHRoaXMuX3N0b3JhZ2VCdWZmZXJzKWUuX3JlYnVpbGQoKX1faW5pdEdMQ29udGV4dCgpe3ZhciBlO3RoaXMuX2NhcHM9e21heFRleHR1cmVzSW1hZ2VVbml0czp0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX1RFWFRVUkVfSU1BR0VfVU5JVFMpLG1heENvbWJpbmVkVGV4dHVyZXNJbWFnZVVuaXRzOnRoaXMuX2dsLmdldFBhcmFtZXRlcih0aGlzLl9nbC5NQVhfQ09NQklORURfVEVYVFVSRV9JTUFHRV9VTklUUyksbWF4VmVydGV4VGV4dHVyZUltYWdlVW5pdHM6dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9WRVJURVhfVEVYVFVSRV9JTUFHRV9VTklUUyksbWF4VGV4dHVyZVNpemU6dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9URVhUVVJFX1NJWkUpLG1heFNhbXBsZXM6dGhpcy5fd2ViR0xWZXJzaW9uPjE/dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9TQU1QTEVTKToxLG1heEN1YmVtYXBUZXh0dXJlU2l6ZTp0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX0NVQkVfTUFQX1RFWFRVUkVfU0laRSksbWF4UmVuZGVyVGV4dHVyZVNpemU6dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9SRU5ERVJCVUZGRVJfU0laRSksbWF4VmVydGV4QXR0cmliczp0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX1ZFUlRFWF9BVFRSSUJTKSxtYXhWYXJ5aW5nVmVjdG9yczp0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX1ZBUllJTkdfVkVDVE9SUyksbWF4RnJhZ21lbnRVbmlmb3JtVmVjdG9yczp0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX0ZSQUdNRU5UX1VOSUZPUk1fVkVDVE9SUyksbWF4VmVydGV4VW5pZm9ybVZlY3RvcnM6dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9WRVJURVhfVU5JRk9STV9WRUNUT1JTKSxwYXJhbGxlbFNoYWRlckNvbXBpbGU6dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJLSFJfcGFyYWxsZWxfc2hhZGVyX2NvbXBpbGUiKXx8dm9pZCAwLHN0YW5kYXJkRGVyaXZhdGl2ZXM6dGhpcy5fd2ViR0xWZXJzaW9uPjF8fHRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzIikhPT1udWxsLG1heEFuaXNvdHJvcHk6MSxhc3RjOnRoaXMuX2dsLmdldEV4dGVuc2lvbigiV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX2FzdGMiKXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJLSVRfV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX2FzdGMiKSxicHRjOnRoaXMuX2dsLmdldEV4dGVuc2lvbigiRVhUX3RleHR1cmVfY29tcHJlc3Npb25fYnB0YyIpfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQktJVF9FWFRfdGV4dHVyZV9jb21wcmVzc2lvbl9icHRjIiksczN0Yzp0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9zM3RjIil8fHRoaXMuX2dsLmdldEV4dGVuc2lvbigiV0VCS0lUX1dFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9zM3RjIiksczN0Y19zcmdiOnRoaXMuX2dsLmdldEV4dGVuc2lvbigiV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3MzdGNfc3JnYiIpfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQktJVF9XRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfczN0Y19zcmdiIikscHZydGM6dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfcHZydGMiKXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJLSVRfV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3B2cnRjIiksZXRjMTp0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9ldGMxIil8fHRoaXMuX2dsLmdldEV4dGVuc2lvbigiV0VCS0lUX1dFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9ldGMxIiksZXRjMjp0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9ldGMiKXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJLSVRfV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX2V0YyIpfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9lczNfMCIpLHRleHR1cmVBbmlzb3Ryb3BpY0ZpbHRlckV4dGVuc2lvbjp0aGlzLl9nbC5nZXRFeHRlbnNpb24oIkVYVF90ZXh0dXJlX2ZpbHRlcl9hbmlzb3Ryb3BpYyIpfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQktJVF9FWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWMiKXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJNT1pfRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljIiksdWludEluZGljZXM6dGhpcy5fd2ViR0xWZXJzaW9uPjF8fHRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX2VsZW1lbnRfaW5kZXhfdWludCIpIT09bnVsbCxmcmFnbWVudERlcHRoU3VwcG9ydGVkOnRoaXMuX3dlYkdMVmVyc2lvbj4xfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIkVYVF9mcmFnX2RlcHRoIikhPT1udWxsLGhpZ2hQcmVjaXNpb25TaGFkZXJTdXBwb3J0ZWQ6ITEsdGltZXJRdWVyeTp0aGlzLl9nbC5nZXRFeHRlbnNpb24oIkVYVF9kaXNqb2ludF90aW1lcl9xdWVyeV93ZWJnbDIiKXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJFWFRfZGlzam9pbnRfdGltZXJfcXVlcnkiKSxzdXBwb3J0T2NjbHVzaW9uUXVlcnk6dGhpcy5fd2ViR0xWZXJzaW9uPjEsY2FuVXNlVGltZXN0YW1wRm9yVGltZXJRdWVyeTohMSxkcmF3QnVmZmVyc0V4dGVuc2lvbjohMSxtYXhNU0FBU2FtcGxlczoxLGNvbG9yQnVmZmVyRmxvYXQ6ISEodGhpcy5fd2ViR0xWZXJzaW9uPjEmJnRoaXMuX2dsLmdldEV4dGVuc2lvbigiRVhUX2NvbG9yX2J1ZmZlcl9mbG9hdCIpKSx0ZXh0dXJlRmxvYXQ6ISEodGhpcy5fd2ViR0xWZXJzaW9uPjF8fHRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX3RleHR1cmVfZmxvYXQiKSksdGV4dHVyZUhhbGZGbG9hdDohISh0aGlzLl93ZWJHTFZlcnNpb24+MXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJPRVNfdGV4dHVyZV9oYWxmX2Zsb2F0IikpLHRleHR1cmVIYWxmRmxvYXRSZW5kZXI6ITEsdGV4dHVyZUZsb2F0TGluZWFyRmlsdGVyaW5nOiExLHRleHR1cmVGbG9hdFJlbmRlcjohMSx0ZXh0dXJlSGFsZkZsb2F0TGluZWFyRmlsdGVyaW5nOiExLHZlcnRleEFycmF5T2JqZWN0OiExLGluc3RhbmNlZEFycmF5czohMSx0ZXh0dXJlTE9EOiEhKHRoaXMuX3dlYkdMVmVyc2lvbj4xfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIkVYVF9zaGFkZXJfdGV4dHVyZV9sb2QiKSksYmxlbmRNaW5NYXg6ITEsbXVsdGl2aWV3OnRoaXMuX2dsLmdldEV4dGVuc2lvbigiT1ZSX211bHRpdmlldzIiKSxvY3VsdXNNdWx0aXZpZXc6dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJPQ1VMVVNfbXVsdGl2aWV3IiksZGVwdGhUZXh0dXJlRXh0ZW5zaW9uOiExLGNhblVzZUdMSW5zdGFuY2VJRDp0aGlzLl93ZWJHTFZlcnNpb24+MSxjYW5Vc2VHTFZlcnRleElEOnRoaXMuX3dlYkdMVmVyc2lvbj4xLHN1cHBvcnRDb21wdXRlU2hhZGVyczohMSxzdXBwb3J0U1JHQkJ1ZmZlcnM6ITEsc3VwcG9ydFRyYW5zZm9ybUZlZWRiYWNrczp0aGlzLl93ZWJHTFZlcnNpb24+MSx0ZXh0dXJlTWF4TGV2ZWw6dGhpcy5fd2ViR0xWZXJzaW9uPjEsdGV4dHVyZTJEQXJyYXlNYXhMYXllckNvdW50OnRoaXMuX3dlYkdMVmVyc2lvbj4xPzI1NjoxMjh9LHRoaXMuX2dsVmVyc2lvbj10aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuVkVSU0lPTik7Y29uc3QgdD10aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQkdMX2RlYnVnX3JlbmRlcmVyX2luZm8iKTtpZih0IT1udWxsJiYodGhpcy5fZ2xSZW5kZXJlcj10aGlzLl9nbC5nZXRQYXJhbWV0ZXIodC5VTk1BU0tFRF9SRU5ERVJFUl9XRUJHTCksdGhpcy5fZ2xWZW5kb3I9dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHQuVU5NQVNLRURfVkVORE9SX1dFQkdMKSksdGhpcy5fZ2xWZW5kb3J8fCh0aGlzLl9nbFZlbmRvcj10aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuVkVORE9SKXx8IlVua25vd24gdmVuZG9yIiksdGhpcy5fZ2xSZW5kZXJlcnx8KHRoaXMuX2dsUmVuZGVyZXI9dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLlJFTkRFUkVSKXx8IlVua25vd24gcmVuZGVyZXIiKSx0aGlzLl9nbC5IQUxGX0ZMT0FUX09FUyE9PTM2MTkzJiYodGhpcy5fZ2wuSEFMRl9GTE9BVF9PRVM9MzYxOTMpLHRoaXMuX2dsLlJHQkExNkYhPT0zNDg0MiYmKHRoaXMuX2dsLlJHQkExNkY9MzQ4NDIpLHRoaXMuX2dsLlJHQkEzMkYhPT0zNDgzNiYmKHRoaXMuX2dsLlJHQkEzMkY9MzQ4MzYpLHRoaXMuX2dsLkRFUFRIMjRfU1RFTkNJTDghPT0zNTA1NiYmKHRoaXMuX2dsLkRFUFRIMjRfU1RFTkNJTDg9MzUwNTYpLHRoaXMuX2NhcHMudGltZXJRdWVyeSYmKHRoaXMuX3dlYkdMVmVyc2lvbj09PTEmJih0aGlzLl9nbC5nZXRRdWVyeT10aGlzLl9jYXBzLnRpbWVyUXVlcnkuZ2V0UXVlcnlFWFQuYmluZCh0aGlzLl9jYXBzLnRpbWVyUXVlcnkpKSx0aGlzLl9jYXBzLmNhblVzZVRpbWVzdGFtcEZvclRpbWVyUXVlcnk9KChlPXRoaXMuX2dsLmdldFF1ZXJ5KHRoaXMuX2NhcHMudGltZXJRdWVyeS5USU1FU1RBTVBfRVhULHRoaXMuX2NhcHMudGltZXJRdWVyeS5RVUVSWV9DT1VOVEVSX0JJVFNfRVhUKSkhPT1udWxsJiZlIT09dm9pZCAwP2U6MCk+MCksdGhpcy5fY2Fwcy5tYXhBbmlzb3Ryb3B5PXRoaXMuX2NhcHMudGV4dHVyZUFuaXNvdHJvcGljRmlsdGVyRXh0ZW5zaW9uP3RoaXMuX2dsLmdldFBhcmFtZXRlcih0aGlzLl9jYXBzLnRleHR1cmVBbmlzb3Ryb3BpY0ZpbHRlckV4dGVuc2lvbi5NQVhfVEVYVFVSRV9NQVhfQU5JU09UUk9QWV9FWFQpOjAsdGhpcy5fY2Fwcy50ZXh0dXJlRmxvYXRMaW5lYXJGaWx0ZXJpbmc9ISEodGhpcy5fY2Fwcy50ZXh0dXJlRmxvYXQmJnRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX3RleHR1cmVfZmxvYXRfbGluZWFyIikpLHRoaXMuX2NhcHMudGV4dHVyZUZsb2F0UmVuZGVyPSEhKHRoaXMuX2NhcHMudGV4dHVyZUZsb2F0JiZ0aGlzLl9jYW5SZW5kZXJUb0Zsb2F0RnJhbWVidWZmZXIoKSksdGhpcy5fY2Fwcy50ZXh0dXJlSGFsZkZsb2F0TGluZWFyRmlsdGVyaW5nPSEhKHRoaXMuX3dlYkdMVmVyc2lvbj4xfHx0aGlzLl9jYXBzLnRleHR1cmVIYWxmRmxvYXQmJnRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX3RleHR1cmVfaGFsZl9mbG9hdF9saW5lYXIiKSksdGhpcy5fY2Fwcy5hc3RjJiYodGhpcy5fZ2wuQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfQVNUQ180eDRfS0hSPXRoaXMuX2NhcHMuYXN0Yy5DT01QUkVTU0VEX1NSR0I4X0FMUEhBOF9BU1RDXzR4NF9LSFIpLHRoaXMuX2NhcHMuYnB0YyYmKHRoaXMuX2dsLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9CUFRDX1VOT1JNX0VYVD10aGlzLl9jYXBzLmJwdGMuQ09NUFJFU1NFRF9TUkdCX0FMUEhBX0JQVENfVU5PUk1fRVhUKSx0aGlzLl9jYXBzLnMzdGNfc3JnYiYmKHRoaXMuX2dsLkNPTVBSRVNTRURfU1JHQl9TM1RDX0RYVDFfRVhUPXRoaXMuX2NhcHMuczN0Y19zcmdiLkNPTVBSRVNTRURfU1JHQl9TM1RDX0RYVDFfRVhULHRoaXMuX2dsLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9TM1RDX0RYVDFfRVhUPXRoaXMuX2NhcHMuczN0Y19zcmdiLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9TM1RDX0RYVDFfRVhULHRoaXMuX2dsLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9TM1RDX0RYVDVfRVhUPXRoaXMuX2NhcHMuczN0Y19zcmdiLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9TM1RDX0RYVDVfRVhUKSx0aGlzLl9jYXBzLmV0YzImJih0aGlzLl9nbC5DT01QUkVTU0VEX1NSR0I4X0VUQzI9dGhpcy5fY2Fwcy5ldGMyLkNPTVBSRVNTRURfU1JHQjhfRVRDMix0aGlzLl9nbC5DT01QUkVTU0VEX1NSR0I4X0FMUEhBOF9FVEMyX0VBQz10aGlzLl9jYXBzLmV0YzIuQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfRVRDMl9FQUMpLHRoaXMuX3dlYkdMVmVyc2lvbj4xJiZ0aGlzLl9nbC5IQUxGX0ZMT0FUX09FUyE9PTUxMzEmJih0aGlzLl9nbC5IQUxGX0ZMT0FUX09FUz01MTMxKSx0aGlzLl9jYXBzLnRleHR1cmVIYWxmRmxvYXRSZW5kZXI9dGhpcy5fY2Fwcy50ZXh0dXJlSGFsZkZsb2F0JiZ0aGlzLl9jYW5SZW5kZXJUb0hhbGZGbG9hdEZyYW1lYnVmZmVyKCksdGhpcy5fd2ViR0xWZXJzaW9uPjEpdGhpcy5fY2Fwcy5kcmF3QnVmZmVyc0V4dGVuc2lvbj0hMCx0aGlzLl9jYXBzLm1heE1TQUFTYW1wbGVzPXRoaXMuX21heE1TQUFTYW1wbGVzT3ZlcnJpZGUhPT1udWxsP3RoaXMuX21heE1TQUFTYW1wbGVzT3ZlcnJpZGU6dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9TQU1QTEVTKTtlbHNle2NvbnN0IGk9dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJHTF9kcmF3X2J1ZmZlcnMiKTtpZihpIT09bnVsbCl7dGhpcy5fY2Fwcy5kcmF3QnVmZmVyc0V4dGVuc2lvbj0hMCx0aGlzLl9nbC5kcmF3QnVmZmVycz1pLmRyYXdCdWZmZXJzV0VCR0wuYmluZChpKSx0aGlzLl9nbC5EUkFXX0ZSQU1FQlVGRkVSPXRoaXMuX2dsLkZSQU1FQlVGRkVSO2ZvcihsZXQgcz0wO3M8MTY7cysrKXRoaXMuX2dsWyJDT0xPUl9BVFRBQ0hNRU5UIitzKyJfV0VCR0wiXT1pWyJDT0xPUl9BVFRBQ0hNRU5UIitzKyJfV0VCR0wiXX19aWYodGhpcy5fd2ViR0xWZXJzaW9uPjEpdGhpcy5fY2Fwcy5kZXB0aFRleHR1cmVFeHRlbnNpb249ITA7ZWxzZXtjb25zdCBpPXRoaXMuX2dsLmdldEV4dGVuc2lvbigiV0VCR0xfZGVwdGhfdGV4dHVyZSIpO2khPW51bGwmJih0aGlzLl9jYXBzLmRlcHRoVGV4dHVyZUV4dGVuc2lvbj0hMCx0aGlzLl9nbC5VTlNJR05FRF9JTlRfMjRfOD1pLlVOU0lHTkVEX0lOVF8yNF84X1dFQkdMKX1pZih0aGlzLmRpc2FibGVWZXJ0ZXhBcnJheU9iamVjdHMpdGhpcy5fY2Fwcy52ZXJ0ZXhBcnJheU9iamVjdD0hMTtlbHNlIGlmKHRoaXMuX3dlYkdMVmVyc2lvbj4xKXRoaXMuX2NhcHMudmVydGV4QXJyYXlPYmplY3Q9ITA7ZWxzZXtjb25zdCBpPXRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX3ZlcnRleF9hcnJheV9vYmplY3QiKTtpIT1udWxsJiYodGhpcy5fY2Fwcy52ZXJ0ZXhBcnJheU9iamVjdD0hMCx0aGlzLl9nbC5jcmVhdGVWZXJ0ZXhBcnJheT1pLmNyZWF0ZVZlcnRleEFycmF5T0VTLmJpbmQoaSksdGhpcy5fZ2wuYmluZFZlcnRleEFycmF5PWkuYmluZFZlcnRleEFycmF5T0VTLmJpbmQoaSksdGhpcy5fZ2wuZGVsZXRlVmVydGV4QXJyYXk9aS5kZWxldGVWZXJ0ZXhBcnJheU9FUy5iaW5kKGkpKX1pZih0aGlzLl93ZWJHTFZlcnNpb24+MSl0aGlzLl9jYXBzLmluc3RhbmNlZEFycmF5cz0hMDtlbHNle2NvbnN0IGk9dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJBTkdMRV9pbnN0YW5jZWRfYXJyYXlzIik7aSE9bnVsbD8odGhpcy5fY2Fwcy5pbnN0YW5jZWRBcnJheXM9ITAsdGhpcy5fZ2wuZHJhd0FycmF5c0luc3RhbmNlZD1pLmRyYXdBcnJheXNJbnN0YW5jZWRBTkdMRS5iaW5kKGkpLHRoaXMuX2dsLmRyYXdFbGVtZW50c0luc3RhbmNlZD1pLmRyYXdFbGVtZW50c0luc3RhbmNlZEFOR0xFLmJpbmQoaSksdGhpcy5fZ2wudmVydGV4QXR0cmliRGl2aXNvcj1pLnZlcnRleEF0dHJpYkRpdmlzb3JBTkdMRS5iaW5kKGkpKTp0aGlzLl9jYXBzLmluc3RhbmNlZEFycmF5cz0hMX1pZih0aGlzLl9nbC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQpe2NvbnN0IGk9dGhpcy5fZ2wuZ2V0U2hhZGVyUHJlY2lzaW9uRm9ybWF0KHRoaXMuX2dsLlZFUlRFWF9TSEFERVIsdGhpcy5fZ2wuSElHSF9GTE9BVCkscz10aGlzLl9nbC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQodGhpcy5fZ2wuRlJBR01FTlRfU0hBREVSLHRoaXMuX2dsLkhJR0hfRkxPQVQpO2kmJnMmJih0aGlzLl9jYXBzLmhpZ2hQcmVjaXNpb25TaGFkZXJTdXBwb3J0ZWQ9aS5wcmVjaXNpb24hPT0wJiZzLnByZWNpc2lvbiE9PTApfWlmKHRoaXMuX3dlYkdMVmVyc2lvbj4xKXRoaXMuX2NhcHMuYmxlbmRNaW5NYXg9ITA7ZWxzZXtjb25zdCBpPXRoaXMuX2dsLmdldEV4dGVuc2lvbigiRVhUX2JsZW5kX21pbm1heCIpO2khPW51bGwmJih0aGlzLl9jYXBzLmJsZW5kTWluTWF4PSEwLHRoaXMuX2dsLk1BWD1pLk1BWF9FWFQsdGhpcy5fZ2wuTUlOPWkuTUlOX0VYVCl9aWYoIXRoaXMuX2NhcHMuc3VwcG9ydFNSR0JCdWZmZXJzKXtpZih0aGlzLl93ZWJHTFZlcnNpb24+MSl0aGlzLl9jYXBzLnN1cHBvcnRTUkdCQnVmZmVycz0hMDtlbHNle2NvbnN0IGk9dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJFWFRfc1JHQiIpO2khPW51bGwmJih0aGlzLl9jYXBzLnN1cHBvcnRTUkdCQnVmZmVycz0hMCx0aGlzLl9nbC5TUkdCPWkuU1JHQl9FWFQsdGhpcy5fZ2wuU1JHQjg9aS5TUkdCX0FMUEhBX0VYVCx0aGlzLl9nbC5TUkdCOF9BTFBIQTg9aS5TUkdCX0FMUEhBX0VYVCl9dGhpcy5fY2Fwcy5zdXBwb3J0U1JHQkJ1ZmZlcnM9dGhpcy5fY2Fwcy5zdXBwb3J0U1JHQkJ1ZmZlcnMmJiEhKHRoaXMuX2NyZWF0aW9uT3B0aW9ucyYmdGhpcy5fY3JlYXRpb25PcHRpb25zLmZvcmNlU1JHQkJ1ZmZlclN1cHBvcnRTdGF0ZSl9dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhUZXN0PSEwLHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoRnVuYz10aGlzLl9nbC5MRVFVQUwsdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhNYXNrPSEwLHRoaXMuX21heFNpbXVsdGFuZW91c1RleHR1cmVzPXRoaXMuX2NhcHMubWF4Q29tYmluZWRUZXh0dXJlc0ltYWdlVW5pdHM7Zm9yKGxldCBpPTA7aTx0aGlzLl9tYXhTaW11bHRhbmVvdXNUZXh0dXJlcztpKyspdGhpcy5fbmV4dEZyZWVUZXh0dXJlU2xvdHMucHVzaChpKX1faW5pdEZlYXR1cmVzKCl7dGhpcy5fZmVhdHVyZXM9e2ZvcmNlQml0bWFwT3ZlckhUTUxJbWFnZUVsZW1lbnQ6ITEsc3VwcG9ydFJlbmRlckFuZENvcHlUb0xvZEZvckZsb2F0VGV4dHVyZXM6dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxzdXBwb3J0RGVwdGhTdGVuY2lsVGV4dHVyZTp0aGlzLl93ZWJHTFZlcnNpb24hPT0xLHN1cHBvcnRTaGFkb3dTYW1wbGVyczp0aGlzLl93ZWJHTFZlcnNpb24hPT0xLHVuaWZvcm1CdWZmZXJIYXJkQ2hlY2tNYXRyaXg6ITEsYWxsb3dUZXh0dXJlUHJlZmlsdGVyaW5nOnRoaXMuX3dlYkdMVmVyc2lvbiE9PTEsdHJhY2tVYm9zSW5GcmFtZTohMSxjaGVja1Vib3NDb250ZW50QmVmb3JlVXBsb2FkOiExLHN1cHBvcnRDU006dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxiYXNpc05lZWRzUE9UOnRoaXMuX3dlYkdMVmVyc2lvbj09PTEsc3VwcG9ydDNEVGV4dHVyZXM6dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxuZWVkVHlwZVN1ZmZpeEluU2hhZGVyQ29uc3RhbnRzOnRoaXMuX3dlYkdMVmVyc2lvbiE9PTEsc3VwcG9ydE1TQUE6dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxzdXBwb3J0U1NBTzI6dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxzdXBwb3J0RXh0ZW5kZWRUZXh0dXJlRm9ybWF0czp0aGlzLl93ZWJHTFZlcnNpb24hPT0xLHN1cHBvcnRTd2l0Y2hDYXNlSW5TaGFkZXI6dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxzdXBwb3J0U3luY1RleHR1cmVSZWFkOiEwLG5lZWRzSW52ZXJ0aW5nQml0bWFwOiEwLHVzZVVCT0JpbmRpbmdDYWNoZTohMCxuZWVkU2hhZGVyQ29kZUlubGluaW5nOiExLG5lZWRUb0Fsd2F5c0JpbmRVbmlmb3JtQnVmZmVyczohMSxzdXBwb3J0UmVuZGVyUGFzc2VzOiExLHN1cHBvcnRTcHJpdGVJbnN0YW5jaW5nOiEwLF9jb2xsZWN0VWJvc1VwZGF0ZWRJbkZyYW1lOiExfX1nZXQgd2ViR0xWZXJzaW9uKCl7cmV0dXJuIHRoaXMuX3dlYkdMVmVyc2lvbn1nZXRDbGFzc05hbWUoKXtyZXR1cm4iVGhpbkVuZ2luZSJ9Z2V0IGlzU3RlbmNpbEVuYWJsZSgpe3JldHVybiB0aGlzLl9pc1N0ZW5jaWxFbmFibGV9X3ByZXBhcmVXb3JraW5nQ2FudmFzKCl7aWYodGhpcy5fd29ya2luZ0NhbnZhcylyZXR1cm47dGhpcy5fd29ya2luZ0NhbnZhcz10aGlzLmNyZWF0ZUNhbnZhcygxLDEpO2NvbnN0IGU9dGhpcy5fd29ya2luZ0NhbnZhcy5nZXRDb250ZXh0KCIyZCIpO2UmJih0aGlzLl93b3JraW5nQ29udGV4dD1lKX1yZXNldFRleHR1cmVDYWNoZSgpe2Zvcihjb25zdCBlIGluIHRoaXMuX2JvdW5kVGV4dHVyZXNDYWNoZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5fYm91bmRUZXh0dXJlc0NhY2hlLGUpJiYodGhpcy5fYm91bmRUZXh0dXJlc0NhY2hlW2VdPW51bGwpO3RoaXMuX2N1cnJlbnRUZXh0dXJlQ2hhbm5lbD0tMX1nZXRJbmZvKCl7cmV0dXJuIHRoaXMuZ2V0R2xJbmZvKCl9Z2V0R2xJbmZvKCl7cmV0dXJue3ZlbmRvcjp0aGlzLl9nbFZlbmRvcixyZW5kZXJlcjp0aGlzLl9nbFJlbmRlcmVyLHZlcnNpb246dGhpcy5fZ2xWZXJzaW9ufX1zZXRIYXJkd2FyZVNjYWxpbmdMZXZlbChlKXt0aGlzLl9oYXJkd2FyZVNjYWxpbmdMZXZlbD1lLHRoaXMucmVzaXplKCl9Z2V0SGFyZHdhcmVTY2FsaW5nTGV2ZWwoKXtyZXR1cm4gdGhpcy5faGFyZHdhcmVTY2FsaW5nTGV2ZWx9Z2V0TG9hZGVkVGV4dHVyZXNDYWNoZSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbFRleHR1cmVzQ2FjaGV9Z2V0Q2Fwcygpe3JldHVybiB0aGlzLl9jYXBzfXN0b3BSZW5kZXJMb29wKGUpe2lmKCFlKXt0aGlzLl9hY3RpdmVSZW5kZXJMb29wcz1bXTtyZXR1cm59Y29uc3QgdD10aGlzLl9hY3RpdmVSZW5kZXJMb29wcy5pbmRleE9mKGUpO3Q+PTAmJnRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzLnNwbGljZSh0LDEpfV9yZW5kZXJMb29wKCl7aWYoIXRoaXMuX2NvbnRleHRXYXNMb3N0KXtsZXQgZT0hMDtpZighdGhpcy5yZW5kZXJFdmVuSW5CYWNrZ3JvdW5kJiZ0aGlzLl93aW5kb3dJc0JhY2tncm91bmQmJihlPSExKSxlKXt0aGlzLmJlZ2luRnJhbWUoKTtmb3IobGV0IHQ9MDt0PHRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzLmxlbmd0aDt0Kyspe2NvbnN0IGk9dGhpcy5fYWN0aXZlUmVuZGVyTG9vcHNbdF07aSgpfXRoaXMuZW5kRnJhbWUoKX19dGhpcy5fYWN0aXZlUmVuZGVyTG9vcHMubGVuZ3RoPjA/dGhpcy5fZnJhbWVIYW5kbGVyPXRoaXMuX3F1ZXVlTmV3RnJhbWUodGhpcy5fYm91bmRSZW5kZXJGdW5jdGlvbix0aGlzLmdldEhvc3RXaW5kb3coKSk6dGhpcy5fcmVuZGVyaW5nUXVldWVMYXVuY2hlZD0hMX1nZXRSZW5kZXJpbmdDYW52YXMoKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nQ2FudmFzfWdldEF1ZGlvQ29udGV4dCgpe3JldHVybiB0aGlzLl9hdWRpb0NvbnRleHR9Z2V0QXVkaW9EZXN0aW5hdGlvbigpe3JldHVybiB0aGlzLl9hdWRpb0Rlc3RpbmF0aW9ufWdldEhvc3RXaW5kb3coKXtyZXR1cm4gamUoKT90aGlzLl9yZW5kZXJpbmdDYW52YXMmJnRoaXMuX3JlbmRlcmluZ0NhbnZhcy5vd25lckRvY3VtZW50JiZ0aGlzLl9yZW5kZXJpbmdDYW52YXMub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldz90aGlzLl9yZW5kZXJpbmdDYW52YXMub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldzp3aW5kb3c6bnVsbH1nZXRSZW5kZXJXaWR0aChlPSExKXtyZXR1cm4hZSYmdGhpcy5fY3VycmVudFJlbmRlclRhcmdldD90aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0LndpZHRoOnRoaXMuX2ZyYW1lYnVmZmVyRGltZW5zaW9uc09iamVjdD90aGlzLl9mcmFtZWJ1ZmZlckRpbWVuc2lvbnNPYmplY3QuZnJhbWVidWZmZXJXaWR0aDp0aGlzLl9nbC5kcmF3aW5nQnVmZmVyV2lkdGh9Z2V0UmVuZGVySGVpZ2h0KGU9ITEpe3JldHVybiFlJiZ0aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0P3RoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQuaGVpZ2h0OnRoaXMuX2ZyYW1lYnVmZmVyRGltZW5zaW9uc09iamVjdD90aGlzLl9mcmFtZWJ1ZmZlckRpbWVuc2lvbnNPYmplY3QuZnJhbWVidWZmZXJIZWlnaHQ6dGhpcy5fZ2wuZHJhd2luZ0J1ZmZlckhlaWdodH1fcXVldWVOZXdGcmFtZShlLHQpe3JldHVybiBvZS5RdWV1ZU5ld0ZyYW1lKGUsdCl9cnVuUmVuZGVyTG9vcChlKXt0aGlzLl9hY3RpdmVSZW5kZXJMb29wcy5pbmRleE9mKGUpPT09LTEmJih0aGlzLl9hY3RpdmVSZW5kZXJMb29wcy5wdXNoKGUpLHRoaXMuX3JlbmRlcmluZ1F1ZXVlTGF1bmNoZWR8fCh0aGlzLl9yZW5kZXJpbmdRdWV1ZUxhdW5jaGVkPSEwLHRoaXMuX2JvdW5kUmVuZGVyRnVuY3Rpb249dGhpcy5fcmVuZGVyTG9vcC5iaW5kKHRoaXMpLHRoaXMuX2ZyYW1lSGFuZGxlcj10aGlzLl9xdWV1ZU5ld0ZyYW1lKHRoaXMuX2JvdW5kUmVuZGVyRnVuY3Rpb24sdGhpcy5nZXRIb3N0V2luZG93KCkpKSl9Y2xlYXIoZSx0LGkscz0hMSl7Y29uc3Qgcj10aGlzLnN0ZW5jaWxTdGF0ZUNvbXBvc2VyLnVzZVN0ZW5jaWxHbG9iYWxPbmx5O3RoaXMuc3RlbmNpbFN0YXRlQ29tcG9zZXIudXNlU3RlbmNpbEdsb2JhbE9ubHk9ITAsdGhpcy5hcHBseVN0YXRlcygpLHRoaXMuc3RlbmNpbFN0YXRlQ29tcG9zZXIudXNlU3RlbmNpbEdsb2JhbE9ubHk9cjtsZXQgbj0wO3QmJmUmJih0aGlzLl9nbC5jbGVhckNvbG9yKGUucixlLmcsZS5iLGUuYSE9PXZvaWQgMD9lLmE6MSksbnw9dGhpcy5fZ2wuQ09MT1JfQlVGRkVSX0JJVCksaSYmKHRoaXMudXNlUmV2ZXJzZURlcHRoQnVmZmVyPyh0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aEZ1bmM9dGhpcy5fZ2wuR0VRVUFMLHRoaXMuX2dsLmNsZWFyRGVwdGgoMCkpOnRoaXMuX2dsLmNsZWFyRGVwdGgoMSksbnw9dGhpcy5fZ2wuREVQVEhfQlVGRkVSX0JJVCkscyYmKHRoaXMuX2dsLmNsZWFyU3RlbmNpbCgwKSxufD10aGlzLl9nbC5TVEVOQ0lMX0JVRkZFUl9CSVQpLHRoaXMuX2dsLmNsZWFyKG4pfV92aWV3cG9ydChlLHQsaSxzKXsoZSE9PXRoaXMuX3ZpZXdwb3J0Q2FjaGVkLnh8fHQhPT10aGlzLl92aWV3cG9ydENhY2hlZC55fHxpIT09dGhpcy5fdmlld3BvcnRDYWNoZWQuenx8cyE9PXRoaXMuX3ZpZXdwb3J0Q2FjaGVkLncpJiYodGhpcy5fdmlld3BvcnRDYWNoZWQueD1lLHRoaXMuX3ZpZXdwb3J0Q2FjaGVkLnk9dCx0aGlzLl92aWV3cG9ydENhY2hlZC56PWksdGhpcy5fdmlld3BvcnRDYWNoZWQudz1zLHRoaXMuX2dsLnZpZXdwb3J0KGUsdCxpLHMpKX1zZXRWaWV3cG9ydChlLHQsaSl7Y29uc3Qgcz10fHx0aGlzLmdldFJlbmRlcldpZHRoKCkscj1pfHx0aGlzLmdldFJlbmRlckhlaWdodCgpLG49ZS54fHwwLGE9ZS55fHwwO3RoaXMuX2NhY2hlZFZpZXdwb3J0PWUsdGhpcy5fdmlld3BvcnQobipzLGEqcixzKmUud2lkdGgsciplLmhlaWdodCl9YmVnaW5GcmFtZSgpe31lbmRGcmFtZSgpe3RoaXMuX2JhZE9TJiZ0aGlzLmZsdXNoRnJhbWVidWZmZXIoKSx0aGlzLl9mcmFtZUlkKyt9cmVzaXplKGU9ITEpe2xldCB0LGk7aWYodGhpcy5hZGFwdFRvRGV2aWNlUmF0aW8pe2NvbnN0IHM9amUoKSYmd2luZG93LmRldmljZVBpeGVsUmF0aW98fDEscj10aGlzLl9sYXN0RGV2aWNlUGl4ZWxSYXRpby9zO3RoaXMuX2xhc3REZXZpY2VQaXhlbFJhdGlvPXMsdGhpcy5faGFyZHdhcmVTY2FsaW5nTGV2ZWwqPXJ9amUoKT8odD10aGlzLl9yZW5kZXJpbmdDYW52YXM/dGhpcy5fcmVuZGVyaW5nQ2FudmFzLmNsaWVudFdpZHRofHx0aGlzLl9yZW5kZXJpbmdDYW52YXMud2lkdGg6d2luZG93LmlubmVyV2lkdGgsaT10aGlzLl9yZW5kZXJpbmdDYW52YXM/dGhpcy5fcmVuZGVyaW5nQ2FudmFzLmNsaWVudEhlaWdodHx8dGhpcy5fcmVuZGVyaW5nQ2FudmFzLmhlaWdodDp3aW5kb3cuaW5uZXJIZWlnaHQpOih0PXRoaXMuX3JlbmRlcmluZ0NhbnZhcz90aGlzLl9yZW5kZXJpbmdDYW52YXMud2lkdGg6MTAwLGk9dGhpcy5fcmVuZGVyaW5nQ2FudmFzP3RoaXMuX3JlbmRlcmluZ0NhbnZhcy5oZWlnaHQ6MTAwKSx0aGlzLnNldFNpemUodC90aGlzLl9oYXJkd2FyZVNjYWxpbmdMZXZlbCxpL3RoaXMuX2hhcmR3YXJlU2NhbGluZ0xldmVsLGUpfXNldFNpemUoZSx0LGk9ITEpe3JldHVybiF0aGlzLl9yZW5kZXJpbmdDYW52YXN8fChlPWV8MCx0PXR8MCwhaSYmdGhpcy5fcmVuZGVyaW5nQ2FudmFzLndpZHRoPT09ZSYmdGhpcy5fcmVuZGVyaW5nQ2FudmFzLmhlaWdodD09PXQpPyExOih0aGlzLl9yZW5kZXJpbmdDYW52YXMud2lkdGg9ZSx0aGlzLl9yZW5kZXJpbmdDYW52YXMuaGVpZ2h0PXQsITApfWJpbmRGcmFtZWJ1ZmZlcihlLHQ9MCxpLHMscixuPTAsYT0wKXt2YXIgbyxoLGwsdSxkO2NvbnN0IGY9ZTt0aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0JiZ0aGlzLnVuQmluZEZyYW1lYnVmZmVyKHRoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQpLHRoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQ9ZSx0aGlzLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKGYuX01TQUFGcmFtZWJ1ZmZlcj9mLl9NU0FBRnJhbWVidWZmZXI6Zi5fZnJhbWVidWZmZXIpO2NvbnN0IF89dGhpcy5fZ2w7ZS5pczJEQXJyYXk/Xy5mcmFtZWJ1ZmZlclRleHR1cmVMYXllcihfLkZSQU1FQlVGRkVSLF8uQ09MT1JfQVRUQUNITUVOVDAsKG89ZS50ZXh0dXJlLl9oYXJkd2FyZVRleHR1cmUpPT09bnVsbHx8bz09PXZvaWQgMD92b2lkIDA6by51bmRlcmx5aW5nUmVzb3VyY2UsbixhKTplLmlzQ3ViZSYmXy5mcmFtZWJ1ZmZlclRleHR1cmUyRChfLkZSQU1FQlVGRkVSLF8uQ09MT1JfQVRUQUNITUVOVDAsXy5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1grdCwoaD1lLnRleHR1cmUuX2hhcmR3YXJlVGV4dHVyZSk9PT1udWxsfHxoPT09dm9pZCAwP3ZvaWQgMDpoLnVuZGVybHlpbmdSZXNvdXJjZSxuKTtjb25zdCBFPWUuX2RlcHRoU3RlbmNpbFRleHR1cmU7aWYoRSl7Y29uc3QgbT1lLl9kZXB0aFN0ZW5jaWxUZXh0dXJlV2l0aFN0ZW5jaWw/Xy5ERVBUSF9TVEVOQ0lMX0FUVEFDSE1FTlQ6Xy5ERVBUSF9BVFRBQ0hNRU5UO2UuaXMyREFycmF5P18uZnJhbWVidWZmZXJUZXh0dXJlTGF5ZXIoXy5GUkFNRUJVRkZFUixtLChsPUUuX2hhcmR3YXJlVGV4dHVyZSk9PT1udWxsfHxsPT09dm9pZCAwP3ZvaWQgMDpsLnVuZGVybHlpbmdSZXNvdXJjZSxuLGEpOmUuaXNDdWJlP18uZnJhbWVidWZmZXJUZXh0dXJlMkQoXy5GUkFNRUJVRkZFUixtLF8uVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YK3QsKHU9RS5faGFyZHdhcmVUZXh0dXJlKT09PW51bGx8fHU9PT12b2lkIDA/dm9pZCAwOnUudW5kZXJseWluZ1Jlc291cmNlLG4pOl8uZnJhbWVidWZmZXJUZXh0dXJlMkQoXy5GUkFNRUJVRkZFUixtLF8uVEVYVFVSRV8yRCwoZD1FLl9oYXJkd2FyZVRleHR1cmUpPT09bnVsbHx8ZD09PXZvaWQgMD92b2lkIDA6ZC51bmRlcmx5aW5nUmVzb3VyY2Usbil9dGhpcy5fY2FjaGVkVmlld3BvcnQmJiFyP3RoaXMuc2V0Vmlld3BvcnQodGhpcy5fY2FjaGVkVmlld3BvcnQsaSxzKTooaXx8KGk9ZS53aWR0aCxuJiYoaT1pL01hdGgucG93KDIsbikpKSxzfHwocz1lLmhlaWdodCxuJiYocz1zL01hdGgucG93KDIsbikpKSx0aGlzLl92aWV3cG9ydCgwLDAsaSxzKSksdGhpcy53aXBlQ2FjaGVzKCl9c2V0U3RhdGUoZSx0PTAsaSxzPSExLHIsbixhPTApe3ZhciBvLGg7KHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmN1bGwhPT1lfHxpKSYmKHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmN1bGw9ZSk7Y29uc3QgbD0hKChoPShvPXRoaXMuY3VsbEJhY2tGYWNlcykhPT1udWxsJiZvIT09dm9pZCAwP286cikhPT1udWxsJiZoIT09dm9pZCAwKXx8aD90aGlzLl9nbC5CQUNLOnRoaXMuX2dsLkZST05UOyh0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5jdWxsRmFjZSE9PWx8fGkpJiYodGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuY3VsbEZhY2U9bCksdGhpcy5zZXRaT2Zmc2V0KHQpLHRoaXMuc2V0Wk9mZnNldFVuaXRzKGEpO2NvbnN0IHU9cz90aGlzLl9nbC5DVzp0aGlzLl9nbC5DQ1c7KHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmZyb250RmFjZSE9PXV8fGkpJiYodGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZnJvbnRGYWNlPXUpLHRoaXMuX3N0ZW5jaWxTdGF0ZUNvbXBvc2VyLnN0ZW5jaWxNYXRlcmlhbD1ufWdldERlcHRoQnVmZmVyKCl7cmV0dXJuIHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoVGVzdH1zZXREZXB0aEJ1ZmZlcihlKXt0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aFRlc3Q9ZX1zZXRaT2Zmc2V0KGUpe3RoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLnpPZmZzZXQ9dGhpcy51c2VSZXZlcnNlRGVwdGhCdWZmZXI/LWU6ZX1nZXRaT2Zmc2V0KCl7Y29uc3QgZT10aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS56T2Zmc2V0O3JldHVybiB0aGlzLnVzZVJldmVyc2VEZXB0aEJ1ZmZlcj8tZTplfXNldFpPZmZzZXRVbml0cyhlKXt0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS56T2Zmc2V0VW5pdHM9dGhpcy51c2VSZXZlcnNlRGVwdGhCdWZmZXI/LWU6ZX1nZXRaT2Zmc2V0VW5pdHMoKXtjb25zdCBlPXRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLnpPZmZzZXRVbml0cztyZXR1cm4gdGhpcy51c2VSZXZlcnNlRGVwdGhCdWZmZXI/LWU6ZX1fYmluZFVuYm91bmRGcmFtZWJ1ZmZlcihlKXt0aGlzLl9jdXJyZW50RnJhbWVidWZmZXIhPT1lJiYodGhpcy5fZ2wuYmluZEZyYW1lYnVmZmVyKHRoaXMuX2dsLkZSQU1FQlVGRkVSLGUpLHRoaXMuX2N1cnJlbnRGcmFtZWJ1ZmZlcj1lKX1fY3VycmVudEZyYW1lQnVmZmVySXNEZWZhdWx0RnJhbWVCdWZmZXIoKXtyZXR1cm4gdGhpcy5fY3VycmVudEZyYW1lYnVmZmVyPT09bnVsbH1nZW5lcmF0ZU1pcG1hcHMoZSl7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseSh0aGlzLl9nbC5URVhUVVJFXzJELGUsITApLHRoaXMuX2dsLmdlbmVyYXRlTWlwbWFwKHRoaXMuX2dsLlRFWFRVUkVfMkQpLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkodGhpcy5fZ2wuVEVYVFVSRV8yRCxudWxsKX11bkJpbmRGcmFtZWJ1ZmZlcihlLHQ9ITEsaSl7dmFyIHM7Y29uc3Qgcj1lO3RoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQ9bnVsbDtjb25zdCBuPXRoaXMuX2dsO2lmKHIuX01TQUFGcmFtZWJ1ZmZlcil7aWYoZS5pc011bHRpKXt0aGlzLnVuQmluZE11bHRpQ29sb3JBdHRhY2htZW50RnJhbWVidWZmZXIoZSx0LGkpO3JldHVybn1uLmJpbmRGcmFtZWJ1ZmZlcihuLlJFQURfRlJBTUVCVUZGRVIsci5fTVNBQUZyYW1lYnVmZmVyKSxuLmJpbmRGcmFtZWJ1ZmZlcihuLkRSQVdfRlJBTUVCVUZGRVIsci5fZnJhbWVidWZmZXIpLG4uYmxpdEZyYW1lYnVmZmVyKDAsMCxlLndpZHRoLGUuaGVpZ2h0LDAsMCxlLndpZHRoLGUuaGVpZ2h0LG4uQ09MT1JfQlVGRkVSX0JJVCxuLk5FQVJFU1QpfSEoKHM9ZS50ZXh0dXJlKT09PW51bGx8fHM9PT12b2lkIDApJiZzLmdlbmVyYXRlTWlwTWFwcyYmIXQmJiFlLmlzQ3ViZSYmdGhpcy5nZW5lcmF0ZU1pcG1hcHMoZS50ZXh0dXJlKSxpJiYoci5fTVNBQUZyYW1lYnVmZmVyJiZ0aGlzLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKHIuX2ZyYW1lYnVmZmVyKSxpKCkpLHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIobnVsbCl9Zmx1c2hGcmFtZWJ1ZmZlcigpe3RoaXMuX2dsLmZsdXNoKCl9cmVzdG9yZURlZmF1bHRGcmFtZWJ1ZmZlcigpe3RoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQ/dGhpcy51bkJpbmRGcmFtZWJ1ZmZlcih0aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0KTp0aGlzLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKG51bGwpLHRoaXMuX2NhY2hlZFZpZXdwb3J0JiZ0aGlzLnNldFZpZXdwb3J0KHRoaXMuX2NhY2hlZFZpZXdwb3J0KSx0aGlzLndpcGVDYWNoZXMoKX1fcmVzZXRWZXJ0ZXhCdWZmZXJCaW5kaW5nKCl7dGhpcy5iaW5kQXJyYXlCdWZmZXIobnVsbCksdGhpcy5fY2FjaGVkVmVydGV4QnVmZmVycz1udWxsfWNyZWF0ZVZlcnRleEJ1ZmZlcihlKXtyZXR1cm4gdGhpcy5fY3JlYXRlVmVydGV4QnVmZmVyKGUsdGhpcy5fZ2wuU1RBVElDX0RSQVcpfV9jcmVhdGVWZXJ0ZXhCdWZmZXIoZSx0KXtjb25zdCBpPXRoaXMuX2dsLmNyZWF0ZUJ1ZmZlcigpO2lmKCFpKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSB2ZXJ0ZXggYnVmZmVyIik7Y29uc3Qgcz1uZXcgRGkoaSk7cmV0dXJuIHRoaXMuYmluZEFycmF5QnVmZmVyKHMpLGUgaW5zdGFuY2VvZiBBcnJheT90aGlzLl9nbC5idWZmZXJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUixuZXcgRmxvYXQzMkFycmF5KGUpLHQpOnRoaXMuX2dsLmJ1ZmZlckRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLGUsdCksdGhpcy5fcmVzZXRWZXJ0ZXhCdWZmZXJCaW5kaW5nKCkscy5yZWZlcmVuY2VzPTEsc31jcmVhdGVEeW5hbWljVmVydGV4QnVmZmVyKGUpe3JldHVybiB0aGlzLl9jcmVhdGVWZXJ0ZXhCdWZmZXIoZSx0aGlzLl9nbC5EWU5BTUlDX0RSQVcpfV9yZXNldEluZGV4QnVmZmVyQmluZGluZygpe3RoaXMuYmluZEluZGV4QnVmZmVyKG51bGwpLHRoaXMuX2NhY2hlZEluZGV4QnVmZmVyPW51bGx9Y3JlYXRlSW5kZXhCdWZmZXIoZSx0KXtjb25zdCBpPXRoaXMuX2dsLmNyZWF0ZUJ1ZmZlcigpLHM9bmV3IERpKGkpO2lmKCFpKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSBpbmRleCBidWZmZXIiKTt0aGlzLmJpbmRJbmRleEJ1ZmZlcihzKTtjb25zdCByPXRoaXMuX25vcm1hbGl6ZUluZGV4RGF0YShlKTtyZXR1cm4gdGhpcy5fZ2wuYnVmZmVyRGF0YSh0aGlzLl9nbC5FTEVNRU5UX0FSUkFZX0JVRkZFUixyLHQ/dGhpcy5fZ2wuRFlOQU1JQ19EUkFXOnRoaXMuX2dsLlNUQVRJQ19EUkFXKSx0aGlzLl9yZXNldEluZGV4QnVmZmVyQmluZGluZygpLHMucmVmZXJlbmNlcz0xLHMuaXMzMkJpdHM9ci5CWVRFU19QRVJfRUxFTUVOVD09PTQsc31fbm9ybWFsaXplSW5kZXhEYXRhKGUpe2lmKGUuQllURVNfUEVSX0VMRU1FTlQ9PT0yKXJldHVybiBlO2lmKHRoaXMuX2NhcHMudWludEluZGljZXMpe2lmKGUgaW5zdGFuY2VvZiBVaW50MzJBcnJheSlyZXR1cm4gZTtmb3IobGV0IGk9MDtpPGUubGVuZ3RoO2krKylpZihlW2ldPj02NTUzNSlyZXR1cm4gbmV3IFVpbnQzMkFycmF5KGUpO3JldHVybiBuZXcgVWludDE2QXJyYXkoZSl9cmV0dXJuIG5ldyBVaW50MTZBcnJheShlKX1iaW5kQXJyYXlCdWZmZXIoZSl7dGhpcy5fdmFvUmVjb3JkSW5Qcm9ncmVzc3x8dGhpcy5fdW5iaW5kVmVydGV4QXJyYXlPYmplY3QoKSx0aGlzLl9iaW5kQnVmZmVyKGUsdGhpcy5fZ2wuQVJSQVlfQlVGRkVSKX1iaW5kVW5pZm9ybUJsb2NrKGUsdCxpKXtjb25zdCBzPWUucHJvZ3JhbSxyPXRoaXMuX2dsLmdldFVuaWZvcm1CbG9ja0luZGV4KHMsdCk7dGhpcy5fZ2wudW5pZm9ybUJsb2NrQmluZGluZyhzLHIsaSl9YmluZEluZGV4QnVmZmVyKGUpe3RoaXMuX3Zhb1JlY29yZEluUHJvZ3Jlc3N8fHRoaXMuX3VuYmluZFZlcnRleEFycmF5T2JqZWN0KCksdGhpcy5fYmluZEJ1ZmZlcihlLHRoaXMuX2dsLkVMRU1FTlRfQVJSQVlfQlVGRkVSKX1fYmluZEJ1ZmZlcihlLHQpeyh0aGlzLl92YW9SZWNvcmRJblByb2dyZXNzfHx0aGlzLl9jdXJyZW50Qm91bmRCdWZmZXJbdF0hPT1lKSYmKHRoaXMuX2dsLmJpbmRCdWZmZXIodCxlP2UudW5kZXJseWluZ1Jlc291cmNlOm51bGwpLHRoaXMuX2N1cnJlbnRCb3VuZEJ1ZmZlclt0XT1lKX11cGRhdGVBcnJheUJ1ZmZlcihlKXt0aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUiwwLGUpfV92ZXJ0ZXhBdHRyaWJQb2ludGVyKGUsdCxpLHMscixuLGEpe2NvbnN0IG89dGhpcy5fY3VycmVudEJ1ZmZlclBvaW50ZXJzW3RdO2lmKCFvKXJldHVybjtsZXQgaD0hMTtvLmFjdGl2ZT8oby5idWZmZXIhPT1lJiYoby5idWZmZXI9ZSxoPSEwKSxvLnNpemUhPT1pJiYoby5zaXplPWksaD0hMCksby50eXBlIT09cyYmKG8udHlwZT1zLGg9ITApLG8ubm9ybWFsaXplZCE9PXImJihvLm5vcm1hbGl6ZWQ9cixoPSEwKSxvLnN0cmlkZSE9PW4mJihvLnN0cmlkZT1uLGg9ITApLG8ub2Zmc2V0IT09YSYmKG8ub2Zmc2V0PWEsaD0hMCkpOihoPSEwLG8uYWN0aXZlPSEwLG8uaW5kZXg9dCxvLnNpemU9aSxvLnR5cGU9cyxvLm5vcm1hbGl6ZWQ9cixvLnN0cmlkZT1uLG8ub2Zmc2V0PWEsby5idWZmZXI9ZSksKGh8fHRoaXMuX3Zhb1JlY29yZEluUHJvZ3Jlc3MpJiYodGhpcy5iaW5kQXJyYXlCdWZmZXIoZSkscz09PXRoaXMuX2dsLlVOU0lHTkVEX0lOVHx8cz09PXRoaXMuX2dsLklOVD90aGlzLl9nbC52ZXJ0ZXhBdHRyaWJJUG9pbnRlcih0LGkscyxuLGEpOnRoaXMuX2dsLnZlcnRleEF0dHJpYlBvaW50ZXIodCxpLHMscixuLGEpKX1fYmluZEluZGV4QnVmZmVyV2l0aENhY2hlKGUpe2UhPW51bGwmJnRoaXMuX2NhY2hlZEluZGV4QnVmZmVyIT09ZSYmKHRoaXMuX2NhY2hlZEluZGV4QnVmZmVyPWUsdGhpcy5iaW5kSW5kZXhCdWZmZXIoZSksdGhpcy5fdWludEluZGljZXNDdXJyZW50bHlTZXQ9ZS5pczMyQml0cyl9X2JpbmRWZXJ0ZXhCdWZmZXJzQXR0cmlidXRlcyhlLHQsaSl7Y29uc3Qgcz10LmdldEF0dHJpYnV0ZXNOYW1lcygpO3RoaXMuX3Zhb1JlY29yZEluUHJvZ3Jlc3N8fHRoaXMuX3VuYmluZFZlcnRleEFycmF5T2JqZWN0KCksdGhpcy51bmJpbmRBbGxBdHRyaWJ1dGVzKCk7Zm9yKGxldCByPTA7cjxzLmxlbmd0aDtyKyspe2NvbnN0IG49dC5nZXRBdHRyaWJ1dGVMb2NhdGlvbihyKTtpZihuPj0wKXtjb25zdCBhPXNbcl07bGV0IG89bnVsbDtpZihpJiYobz1pW2FdKSxvfHwobz1lW2FdKSwhbyljb250aW51ZTt0aGlzLl9nbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShuKSx0aGlzLl92YW9SZWNvcmRJblByb2dyZXNzfHwodGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZFtuXT0hMCk7Y29uc3QgaD1vLmdldEJ1ZmZlcigpO2gmJih0aGlzLl92ZXJ0ZXhBdHRyaWJQb2ludGVyKGgsbixvLmdldFNpemUoKSxvLnR5cGUsby5ub3JtYWxpemVkLG8uYnl0ZVN0cmlkZSxvLmJ5dGVPZmZzZXQpLG8uZ2V0SXNJbnN0YW5jZWQoKSYmKHRoaXMuX2dsLnZlcnRleEF0dHJpYkRpdmlzb3IobixvLmdldEluc3RhbmNlRGl2aXNvcigpKSx0aGlzLl92YW9SZWNvcmRJblByb2dyZXNzfHwodGhpcy5fY3VycmVudEluc3RhbmNlTG9jYXRpb25zLnB1c2gobiksdGhpcy5fY3VycmVudEluc3RhbmNlQnVmZmVycy5wdXNoKGgpKSkpfX19cmVjb3JkVmVydGV4QXJyYXlPYmplY3QoZSx0LGkscyl7Y29uc3Qgcj10aGlzLl9nbC5jcmVhdGVWZXJ0ZXhBcnJheSgpO2lmKCFyKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSBWQU8iKTtyZXR1cm4gdGhpcy5fdmFvUmVjb3JkSW5Qcm9ncmVzcz0hMCx0aGlzLl9nbC5iaW5kVmVydGV4QXJyYXkociksdGhpcy5fbXVzdFdpcGVWZXJ0ZXhBdHRyaWJ1dGVzPSEwLHRoaXMuX2JpbmRWZXJ0ZXhCdWZmZXJzQXR0cmlidXRlcyhlLGkscyksdGhpcy5iaW5kSW5kZXhCdWZmZXIodCksdGhpcy5fdmFvUmVjb3JkSW5Qcm9ncmVzcz0hMSx0aGlzLl9nbC5iaW5kVmVydGV4QXJyYXkobnVsbCkscn1iaW5kVmVydGV4QXJyYXlPYmplY3QoZSx0KXt0aGlzLl9jYWNoZWRWZXJ0ZXhBcnJheU9iamVjdCE9PWUmJih0aGlzLl9jYWNoZWRWZXJ0ZXhBcnJheU9iamVjdD1lLHRoaXMuX2dsLmJpbmRWZXJ0ZXhBcnJheShlKSx0aGlzLl9jYWNoZWRWZXJ0ZXhCdWZmZXJzPW51bGwsdGhpcy5fY2FjaGVkSW5kZXhCdWZmZXI9bnVsbCx0aGlzLl91aW50SW5kaWNlc0N1cnJlbnRseVNldD10IT1udWxsJiZ0LmlzMzJCaXRzLHRoaXMuX211c3RXaXBlVmVydGV4QXR0cmlidXRlcz0hMCl9YmluZEJ1ZmZlcnNEaXJlY3RseShlLHQsaSxzLHIpe2lmKHRoaXMuX2NhY2hlZFZlcnRleEJ1ZmZlcnMhPT1lfHx0aGlzLl9jYWNoZWRFZmZlY3RGb3JWZXJ0ZXhCdWZmZXJzIT09cil7dGhpcy5fY2FjaGVkVmVydGV4QnVmZmVycz1lLHRoaXMuX2NhY2hlZEVmZmVjdEZvclZlcnRleEJ1ZmZlcnM9cjtjb25zdCBuPXIuZ2V0QXR0cmlidXRlc0NvdW50KCk7dGhpcy5fdW5iaW5kVmVydGV4QXJyYXlPYmplY3QoKSx0aGlzLnVuYmluZEFsbEF0dHJpYnV0ZXMoKTtsZXQgYT0wO2ZvcihsZXQgbz0wO288bjtvKyspaWYobzxpLmxlbmd0aCl7Y29uc3QgaD1yLmdldEF0dHJpYnV0ZUxvY2F0aW9uKG8pO2g+PTAmJih0aGlzLl9nbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShoKSx0aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNFbmFibGVkW2hdPSEwLHRoaXMuX3ZlcnRleEF0dHJpYlBvaW50ZXIoZSxoLGlbb10sdGhpcy5fZ2wuRkxPQVQsITEscyxhKSksYSs9aVtvXSo0fX10aGlzLl9iaW5kSW5kZXhCdWZmZXJXaXRoQ2FjaGUodCl9X3VuYmluZFZlcnRleEFycmF5T2JqZWN0KCl7dGhpcy5fY2FjaGVkVmVydGV4QXJyYXlPYmplY3QmJih0aGlzLl9jYWNoZWRWZXJ0ZXhBcnJheU9iamVjdD1udWxsLHRoaXMuX2dsLmJpbmRWZXJ0ZXhBcnJheShudWxsKSl9YmluZEJ1ZmZlcnMoZSx0LGkscyl7KHRoaXMuX2NhY2hlZFZlcnRleEJ1ZmZlcnMhPT1lfHx0aGlzLl9jYWNoZWRFZmZlY3RGb3JWZXJ0ZXhCdWZmZXJzIT09aSkmJih0aGlzLl9jYWNoZWRWZXJ0ZXhCdWZmZXJzPWUsdGhpcy5fY2FjaGVkRWZmZWN0Rm9yVmVydGV4QnVmZmVycz1pLHRoaXMuX2JpbmRWZXJ0ZXhCdWZmZXJzQXR0cmlidXRlcyhlLGkscykpLHRoaXMuX2JpbmRJbmRleEJ1ZmZlcldpdGhDYWNoZSh0KX11bmJpbmRJbnN0YW5jZUF0dHJpYnV0ZXMoKXtsZXQgZTtmb3IobGV0IHQ9MCxpPXRoaXMuX2N1cnJlbnRJbnN0YW5jZUxvY2F0aW9ucy5sZW5ndGg7dDxpO3QrKyl7Y29uc3Qgcz10aGlzLl9jdXJyZW50SW5zdGFuY2VCdWZmZXJzW3RdO2UhPXMmJnMucmVmZXJlbmNlcyYmKGU9cyx0aGlzLmJpbmRBcnJheUJ1ZmZlcihzKSk7Y29uc3Qgcj10aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnNbdF07dGhpcy5fZ2wudmVydGV4QXR0cmliRGl2aXNvcihyLDApfXRoaXMuX2N1cnJlbnRJbnN0YW5jZUJ1ZmZlcnMubGVuZ3RoPTAsdGhpcy5fY3VycmVudEluc3RhbmNlTG9jYXRpb25zLmxlbmd0aD0wfXJlbGVhc2VWZXJ0ZXhBcnJheU9iamVjdChlKXt0aGlzLl9nbC5kZWxldGVWZXJ0ZXhBcnJheShlKX1fcmVsZWFzZUJ1ZmZlcihlKXtyZXR1cm4gZS5yZWZlcmVuY2VzLS0sZS5yZWZlcmVuY2VzPT09MD8odGhpcy5fZGVsZXRlQnVmZmVyKGUpLCEwKTohMX1fZGVsZXRlQnVmZmVyKGUpe3RoaXMuX2dsLmRlbGV0ZUJ1ZmZlcihlLnVuZGVybHlpbmdSZXNvdXJjZSl9dXBkYXRlQW5kQmluZEluc3RhbmNlc0J1ZmZlcihlLHQsaSl7aWYodGhpcy5iaW5kQXJyYXlCdWZmZXIoZSksdCYmdGhpcy5fZ2wuYnVmZmVyU3ViRGF0YSh0aGlzLl9nbC5BUlJBWV9CVUZGRVIsMCx0KSxpWzBdLmluZGV4IT09dm9pZCAwKXRoaXMuYmluZEluc3RhbmNlc0J1ZmZlcihlLGksITApO2Vsc2UgZm9yKGxldCBzPTA7czw0O3MrKyl7Y29uc3Qgcj1pW3NdO3RoaXMuX3ZlcnRleEF0dHJpYkFycmF5c0VuYWJsZWRbcl18fCh0aGlzLl9nbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShyKSx0aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNFbmFibGVkW3JdPSEwKSx0aGlzLl92ZXJ0ZXhBdHRyaWJQb2ludGVyKGUsciw0LHRoaXMuX2dsLkZMT0FULCExLDY0LHMqMTYpLHRoaXMuX2dsLnZlcnRleEF0dHJpYkRpdmlzb3IociwxKSx0aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnMucHVzaChyKSx0aGlzLl9jdXJyZW50SW5zdGFuY2VCdWZmZXJzLnB1c2goZSl9fWJpbmRJbnN0YW5jZXNCdWZmZXIoZSx0LGk9ITApe3RoaXMuYmluZEFycmF5QnVmZmVyKGUpO2xldCBzPTA7aWYoaSlmb3IobGV0IHI9MDtyPHQubGVuZ3RoO3IrKyl7Y29uc3Qgbj10W3JdO3MrPW4uYXR0cmlidXRlU2l6ZSo0fWZvcihsZXQgcj0wO3I8dC5sZW5ndGg7cisrKXtjb25zdCBuPXRbcl07bi5pbmRleD09PXZvaWQgMCYmKG4uaW5kZXg9dGhpcy5fY3VycmVudEVmZmVjdC5nZXRBdHRyaWJ1dGVMb2NhdGlvbkJ5TmFtZShuLmF0dHJpYnV0ZU5hbWUpKSwhKG4uaW5kZXg8MCkmJih0aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNFbmFibGVkW24uaW5kZXhdfHwodGhpcy5fZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkobi5pbmRleCksdGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZFtuLmluZGV4XT0hMCksdGhpcy5fdmVydGV4QXR0cmliUG9pbnRlcihlLG4uaW5kZXgsbi5hdHRyaWJ1dGVTaXplLG4uYXR0cmlidXRlVHlwZXx8dGhpcy5fZ2wuRkxPQVQsbi5ub3JtYWxpemVkfHwhMSxzLG4ub2Zmc2V0KSx0aGlzLl9nbC52ZXJ0ZXhBdHRyaWJEaXZpc29yKG4uaW5kZXgsbi5kaXZpc29yPT09dm9pZCAwPzE6bi5kaXZpc29yKSx0aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnMucHVzaChuLmluZGV4KSx0aGlzLl9jdXJyZW50SW5zdGFuY2VCdWZmZXJzLnB1c2goZSkpfX1kaXNhYmxlSW5zdGFuY2VBdHRyaWJ1dGVCeU5hbWUoZSl7aWYoIXRoaXMuX2N1cnJlbnRFZmZlY3QpcmV0dXJuO2NvbnN0IHQ9dGhpcy5fY3VycmVudEVmZmVjdC5nZXRBdHRyaWJ1dGVMb2NhdGlvbkJ5TmFtZShlKTt0aGlzLmRpc2FibGVJbnN0YW5jZUF0dHJpYnV0ZSh0KX1kaXNhYmxlSW5zdGFuY2VBdHRyaWJ1dGUoZSl7bGV0IHQ9ITEsaTtmb3IoOyhpPXRoaXMuX2N1cnJlbnRJbnN0YW5jZUxvY2F0aW9ucy5pbmRleE9mKGUpKSE9PS0xOyl0aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnMuc3BsaWNlKGksMSksdGhpcy5fY3VycmVudEluc3RhbmNlQnVmZmVycy5zcGxpY2UoaSwxKSx0PSEwLGk9dGhpcy5fY3VycmVudEluc3RhbmNlTG9jYXRpb25zLmluZGV4T2YoZSk7dCYmKHRoaXMuX2dsLnZlcnRleEF0dHJpYkRpdmlzb3IoZSwwKSx0aGlzLmRpc2FibGVBdHRyaWJ1dGVCeUluZGV4KGUpKX1kaXNhYmxlQXR0cmlidXRlQnlJbmRleChlKXt0aGlzLl9nbC5kaXNhYmxlVmVydGV4QXR0cmliQXJyYXkoZSksdGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZFtlXT0hMSx0aGlzLl9jdXJyZW50QnVmZmVyUG9pbnRlcnNbZV0uYWN0aXZlPSExfWRyYXcoZSx0LGkscyl7dGhpcy5kcmF3RWxlbWVudHNUeXBlKGU/MDoxLHQsaSxzKX1kcmF3UG9pbnRDbG91ZHMoZSx0LGkpe3RoaXMuZHJhd0FycmF5c1R5cGUoMixlLHQsaSl9ZHJhd1VuSW5kZXhlZChlLHQsaSxzKXt0aGlzLmRyYXdBcnJheXNUeXBlKGU/MDoxLHQsaSxzKX1kcmF3RWxlbWVudHNUeXBlKGUsdCxpLHMpe3RoaXMuYXBwbHlTdGF0ZXMoKSx0aGlzLl9yZXBvcnREcmF3Q2FsbCgpO2NvbnN0IHI9dGhpcy5fZHJhd01vZGUoZSksbj10aGlzLl91aW50SW5kaWNlc0N1cnJlbnRseVNldD90aGlzLl9nbC5VTlNJR05FRF9JTlQ6dGhpcy5fZ2wuVU5TSUdORURfU0hPUlQsYT10aGlzLl91aW50SW5kaWNlc0N1cnJlbnRseVNldD80OjI7cz90aGlzLl9nbC5kcmF3RWxlbWVudHNJbnN0YW5jZWQocixpLG4sdCphLHMpOnRoaXMuX2dsLmRyYXdFbGVtZW50cyhyLGksbix0KmEpfWRyYXdBcnJheXNUeXBlKGUsdCxpLHMpe3RoaXMuYXBwbHlTdGF0ZXMoKSx0aGlzLl9yZXBvcnREcmF3Q2FsbCgpO2NvbnN0IHI9dGhpcy5fZHJhd01vZGUoZSk7cz90aGlzLl9nbC5kcmF3QXJyYXlzSW5zdGFuY2VkKHIsdCxpLHMpOnRoaXMuX2dsLmRyYXdBcnJheXMocix0LGkpfV9kcmF3TW9kZShlKXtzd2l0Y2goZSl7Y2FzZSAwOnJldHVybiB0aGlzLl9nbC5UUklBTkdMRVM7Y2FzZSAyOnJldHVybiB0aGlzLl9nbC5QT0lOVFM7Y2FzZSAxOnJldHVybiB0aGlzLl9nbC5MSU5FUztjYXNlIDM6cmV0dXJuIHRoaXMuX2dsLlBPSU5UUztjYXNlIDQ6cmV0dXJuIHRoaXMuX2dsLkxJTkVTO2Nhc2UgNTpyZXR1cm4gdGhpcy5fZ2wuTElORV9MT09QO2Nhc2UgNjpyZXR1cm4gdGhpcy5fZ2wuTElORV9TVFJJUDtjYXNlIDc6cmV0dXJuIHRoaXMuX2dsLlRSSUFOR0xFX1NUUklQO2Nhc2UgODpyZXR1cm4gdGhpcy5fZ2wuVFJJQU5HTEVfRkFOO2RlZmF1bHQ6cmV0dXJuIHRoaXMuX2dsLlRSSUFOR0xFU319X3JlcG9ydERyYXdDYWxsKCl7fV9yZWxlYXNlRWZmZWN0KGUpe3RoaXMuX2NvbXBpbGVkRWZmZWN0c1tlLl9rZXldJiZkZWxldGUgdGhpcy5fY29tcGlsZWRFZmZlY3RzW2UuX2tleV07Y29uc3QgdD1lLmdldFBpcGVsaW5lQ29udGV4dCgpO3QmJnRoaXMuX2RlbGV0ZVBpcGVsaW5lQ29udGV4dCh0KX1fZGVsZXRlUGlwZWxpbmVDb250ZXh0KGUpe2NvbnN0IHQ9ZTt0JiZ0LnByb2dyYW0mJih0LnByb2dyYW0uX19TUEVDVE9SX3JlYnVpbGRQcm9ncmFtPW51bGwsdGhpcy5fZ2wuZGVsZXRlUHJvZ3JhbSh0LnByb2dyYW0pKX1fZ2V0R2xvYmFsRGVmaW5lcyhlKXtpZihlKXt0aGlzLmlzTkRDSGFsZlpSYW5nZT9lLklTX05EQ19IQUxGX1pSQU5HRT0iIjpkZWxldGUgZS5JU19ORENfSEFMRl9aUkFOR0UsdGhpcy51c2VSZXZlcnNlRGVwdGhCdWZmZXI/ZS5VU0VfUkVWRVJTRV9ERVBUSEJVRkZFUj0iIjpkZWxldGUgZS5VU0VfUkVWRVJTRV9ERVBUSEJVRkZFUix0aGlzLnVzZUV4YWN0U3JnYkNvbnZlcnNpb25zP2UuVVNFX0VYQUNUX1NSR0JfQ09OVkVSU0lPTlM9IiI6ZGVsZXRlIGUuVVNFX0VYQUNUX1NSR0JfQ09OVkVSU0lPTlM7cmV0dXJufWVsc2V7bGV0IHQ9IiI7cmV0dXJuIHRoaXMuaXNORENIYWxmWlJhbmdlJiYodCs9IiNkZWZpbmUgSVNfTkRDX0hBTEZfWlJBTkdFIiksdGhpcy51c2VSZXZlcnNlRGVwdGhCdWZmZXImJih0JiYodCs9YApgKSx0Kz0iI2RlZmluZSBVU0VfUkVWRVJTRV9ERVBUSEJVRkZFUiIpLHRoaXMudXNlRXhhY3RTcmdiQ29udmVyc2lvbnMmJih0JiYodCs9YApgKSx0Kz0iI2RlZmluZSBVU0VfRVhBQ1RfU1JHQl9DT05WRVJTSU9OUyIpLHR9fWNyZWF0ZUVmZmVjdChlLHQsaSxzLHIsbixhLG8saCxsPVplLkdMU0wpe3ZhciB1O2NvbnN0IGQ9ZS52ZXJ0ZXhFbGVtZW50fHxlLnZlcnRleHx8ZS52ZXJ0ZXhUb2tlbnx8ZS52ZXJ0ZXhTb3VyY2V8fGUsZj1lLmZyYWdtZW50RWxlbWVudHx8ZS5mcmFnbWVudHx8ZS5mcmFnbWVudFRva2VufHxlLmZyYWdtZW50U291cmNlfHxlLF89dGhpcy5fZ2V0R2xvYmFsRGVmaW5lcygpO2xldCBFPSh1PXI/P3QuZGVmaW5lcykhPT1udWxsJiZ1IT09dm9pZCAwP3U6IiI7XyYmKEUrPV8pO2NvbnN0IG09ZCsiKyIrZisiQCIrRTtpZih0aGlzLl9jb21waWxlZEVmZmVjdHNbbV0pe2NvbnN0IFM9dGhpcy5fY29tcGlsZWRFZmZlY3RzW21dO3JldHVybiBhJiZTLmlzUmVhZHkoKSYmYShTKSxTfWNvbnN0IHY9bmV3IFBlKGUsdCxpLHMsdGhpcyxyLG4sYSxvLGgsbSxsKTtyZXR1cm4gdGhpcy5fY29tcGlsZWRFZmZlY3RzW21dPXYsdn1zdGF0aWMgX0NvbmNhdGVuYXRlU2hhZGVyKGUsdCxpPSIiKXtyZXR1cm4gaSsodD90K2AKYDoiIikrZX1fY29tcGlsZVNoYWRlcihlLHQsaSxzKXtyZXR1cm4gdGhpcy5fY29tcGlsZVJhd1NoYWRlcihvZS5fQ29uY2F0ZW5hdGVTaGFkZXIoZSxpLHMpLHQpfV9jb21waWxlUmF3U2hhZGVyKGUsdCl7Y29uc3QgaT10aGlzLl9nbCxzPWkuY3JlYXRlU2hhZGVyKHQ9PT0idmVydGV4Ij9pLlZFUlRFWF9TSEFERVI6aS5GUkFHTUVOVF9TSEFERVIpO2lmKCFzKXtsZXQgcj1pLk5PX0VSUk9SLG49aS5OT19FUlJPUjtmb3IoOyhuPWkuZ2V0RXJyb3IoKSkhPT1pLk5PX0VSUk9SOylyPW47dGhyb3cgbmV3IEVycm9yKGBTb21ldGhpbmcgd2VudCB3cm9uZyB3aGlsZSBjcmVhdGluZyBhIGdsICR7dH0gc2hhZGVyIG9iamVjdC4gZ2wgZXJyb3I9JHtyfSwgZ2wgaXNDb250ZXh0TG9zdD0ke2kuaXNDb250ZXh0TG9zdCgpfSwgX2NvbnRleHRXYXNMb3N0PSR7dGhpcy5fY29udGV4dFdhc0xvc3R9YCl9cmV0dXJuIGkuc2hhZGVyU291cmNlKHMsZSksaS5jb21waWxlU2hhZGVyKHMpLHN9X2dldFNoYWRlclNvdXJjZShlKXtyZXR1cm4gdGhpcy5fZ2wuZ2V0U2hhZGVyU291cmNlKGUpfWNyZWF0ZVJhd1NoYWRlclByb2dyYW0oZSx0LGkscyxyPW51bGwpe3M9c3x8dGhpcy5fZ2w7Y29uc3Qgbj10aGlzLl9jb21waWxlUmF3U2hhZGVyKHQsInZlcnRleCIpLGE9dGhpcy5fY29tcGlsZVJhd1NoYWRlcihpLCJmcmFnbWVudCIpO3JldHVybiB0aGlzLl9jcmVhdGVTaGFkZXJQcm9ncmFtKGUsbixhLHMscil9Y3JlYXRlU2hhZGVyUHJvZ3JhbShlLHQsaSxzLHIsbj1udWxsKXtyPXJ8fHRoaXMuX2dsO2NvbnN0IGE9dGhpcy5fd2ViR0xWZXJzaW9uPjE/YCN2ZXJzaW9uIDMwMCBlcwojZGVmaW5lIFdFQkdMMiAKYDoiIixvPXRoaXMuX2NvbXBpbGVTaGFkZXIodCwidmVydGV4IixzLGEpLGg9dGhpcy5fY29tcGlsZVNoYWRlcihpLCJmcmFnbWVudCIscyxhKTtyZXR1cm4gdGhpcy5fY3JlYXRlU2hhZGVyUHJvZ3JhbShlLG8saCxyLG4pfWlubGluZVNoYWRlckNvZGUoZSl7cmV0dXJuIGV9Y3JlYXRlUGlwZWxpbmVDb250ZXh0KGUpe2NvbnN0IHQ9bmV3IGxuO3JldHVybiB0LmVuZ2luZT10aGlzLHRoaXMuX2NhcHMucGFyYWxsZWxTaGFkZXJDb21waWxlJiYodC5pc1BhcmFsbGVsQ29tcGlsZWQ9ITApLHR9Y3JlYXRlTWF0ZXJpYWxDb250ZXh0KCl7fWNyZWF0ZURyYXdDb250ZXh0KCl7fV9jcmVhdGVTaGFkZXJQcm9ncmFtKGUsdCxpLHMscj1udWxsKXtjb25zdCBuPXMuY3JlYXRlUHJvZ3JhbSgpO2lmKGUucHJvZ3JhbT1uLCFuKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSBwcm9ncmFtIik7cmV0dXJuIHMuYXR0YWNoU2hhZGVyKG4sdCkscy5hdHRhY2hTaGFkZXIobixpKSxzLmxpbmtQcm9ncmFtKG4pLGUuY29udGV4dD1zLGUudmVydGV4U2hhZGVyPXQsZS5mcmFnbWVudFNoYWRlcj1pLGUuaXNQYXJhbGxlbENvbXBpbGVkfHx0aGlzLl9maW5hbGl6ZVBpcGVsaW5lQ29udGV4dChlKSxufV9maW5hbGl6ZVBpcGVsaW5lQ29udGV4dChlKXtjb25zdCB0PWUuY29udGV4dCxpPWUudmVydGV4U2hhZGVyLHM9ZS5mcmFnbWVudFNoYWRlcixyPWUucHJvZ3JhbTtpZighdC5nZXRQcm9ncmFtUGFyYW1ldGVyKHIsdC5MSU5LX1NUQVRVUykpe2lmKCF0aGlzLl9nbC5nZXRTaGFkZXJQYXJhbWV0ZXIoaSx0aGlzLl9nbC5DT01QSUxFX1NUQVRVUykpe2NvbnN0IG89dGhpcy5fZ2wuZ2V0U2hhZGVySW5mb0xvZyhpKTtpZihvKXRocm93IGUudmVydGV4Q29tcGlsYXRpb25FcnJvcj1vLG5ldyBFcnJvcigiVkVSVEVYIFNIQURFUiAiK28pfWlmKCF0aGlzLl9nbC5nZXRTaGFkZXJQYXJhbWV0ZXIocyx0aGlzLl9nbC5DT01QSUxFX1NUQVRVUykpe2NvbnN0IG89dGhpcy5fZ2wuZ2V0U2hhZGVySW5mb0xvZyhzKTtpZihvKXRocm93IGUuZnJhZ21lbnRDb21waWxhdGlvbkVycm9yPW8sbmV3IEVycm9yKCJGUkFHTUVOVCBTSEFERVIgIitvKX1jb25zdCBhPXQuZ2V0UHJvZ3JhbUluZm9Mb2cocik7aWYoYSl0aHJvdyBlLnByb2dyYW1MaW5rRXJyb3I9YSxuZXcgRXJyb3IoYSl9aWYodGhpcy52YWxpZGF0ZVNoYWRlclByb2dyYW1zJiYodC52YWxpZGF0ZVByb2dyYW0ociksIXQuZ2V0UHJvZ3JhbVBhcmFtZXRlcihyLHQuVkFMSURBVEVfU1RBVFVTKSkpe2NvbnN0IG89dC5nZXRQcm9ncmFtSW5mb0xvZyhyKTtpZihvKXRocm93IGUucHJvZ3JhbVZhbGlkYXRpb25FcnJvcj1vLG5ldyBFcnJvcihvKX10LmRlbGV0ZVNoYWRlcihpKSx0LmRlbGV0ZVNoYWRlcihzKSxlLnZlcnRleFNoYWRlcj12b2lkIDAsZS5mcmFnbWVudFNoYWRlcj12b2lkIDAsZS5vbkNvbXBpbGVkJiYoZS5vbkNvbXBpbGVkKCksZS5vbkNvbXBpbGVkPXZvaWQgMCl9X3ByZXBhcmVQaXBlbGluZUNvbnRleHQoZSx0LGkscyxyLG4sYSxvLGgsbCl7Y29uc3QgdT1lO3M/dS5wcm9ncmFtPXRoaXMuY3JlYXRlUmF3U2hhZGVyUHJvZ3JhbSh1LHQsaSx2b2lkIDAsaCk6dS5wcm9ncmFtPXRoaXMuY3JlYXRlU2hhZGVyUHJvZ3JhbSh1LHQsaSxvLHZvaWQgMCxoKSx1LnByb2dyYW0uX19TUEVDVE9SX3JlYnVpbGRQcm9ncmFtPWF9X2lzUmVuZGVyaW5nU3RhdGVDb21waWxlZChlKXtjb25zdCB0PWU7cmV0dXJuIHRoaXMuX2dsLmdldFByb2dyYW1QYXJhbWV0ZXIodC5wcm9ncmFtLHRoaXMuX2NhcHMucGFyYWxsZWxTaGFkZXJDb21waWxlLkNPTVBMRVRJT05fU1RBVFVTX0tIUik/KHRoaXMuX2ZpbmFsaXplUGlwZWxpbmVDb250ZXh0KHQpLCEwKTohMX1fZXhlY3V0ZVdoZW5SZW5kZXJpbmdTdGF0ZUlzQ29tcGlsZWQoZSx0KXtjb25zdCBpPWU7aWYoIWkuaXNQYXJhbGxlbENvbXBpbGVkKXt0KCk7cmV0dXJufWNvbnN0IHM9aS5vbkNvbXBpbGVkO3M/aS5vbkNvbXBpbGVkPSgpPT57cygpLHQoKX06aS5vbkNvbXBpbGVkPXR9Z2V0VW5pZm9ybXMoZSx0KXtjb25zdCBpPW5ldyBBcnJheSxzPWU7Zm9yKGxldCByPTA7cjx0Lmxlbmd0aDtyKyspaS5wdXNoKHRoaXMuX2dsLmdldFVuaWZvcm1Mb2NhdGlvbihzLnByb2dyYW0sdFtyXSkpO3JldHVybiBpfWdldEF0dHJpYnV0ZXMoZSx0KXtjb25zdCBpPVtdLHM9ZTtmb3IobGV0IHI9MDtyPHQubGVuZ3RoO3IrKyl0cnl7aS5wdXNoKHRoaXMuX2dsLmdldEF0dHJpYkxvY2F0aW9uKHMucHJvZ3JhbSx0W3JdKSl9Y2F0Y2h7aS5wdXNoKC0xKX1yZXR1cm4gaX1lbmFibGVFZmZlY3QoZSl7ZT1lIT09bnVsbCYmbWkuSXNXcmFwcGVyKGUpP2UuZWZmZWN0OmUsISghZXx8ZT09PXRoaXMuX2N1cnJlbnRFZmZlY3QpJiYodGhpcy5fc3RlbmNpbFN0YXRlQ29tcG9zZXIuc3RlbmNpbE1hdGVyaWFsPXZvaWQgMCxlPWUsdGhpcy5iaW5kU2FtcGxlcnMoZSksdGhpcy5fY3VycmVudEVmZmVjdD1lLGUub25CaW5kJiZlLm9uQmluZChlKSxlLl9vbkJpbmRPYnNlcnZhYmxlJiZlLl9vbkJpbmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSl9c2V0SW50KGUsdCl7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm0xaShlLHQpLCEwKTohMX1zZXRJbnQyKGUsdCxpKXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTJpKGUsdCxpKSwhMCk6ITF9c2V0SW50MyhlLHQsaSxzKXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTNpKGUsdCxpLHMpLCEwKTohMX1zZXRJbnQ0KGUsdCxpLHMscil7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm00aShlLHQsaSxzLHIpLCEwKTohMX1zZXRJbnRBcnJheShlLHQpe3JldHVybiBlPyh0aGlzLl9nbC51bmlmb3JtMWl2KGUsdCksITApOiExfXNldEludEFycmF5MihlLHQpe3JldHVybiFlfHx0Lmxlbmd0aCUyIT09MD8hMToodGhpcy5fZ2wudW5pZm9ybTJpdihlLHQpLCEwKX1zZXRJbnRBcnJheTMoZSx0KXtyZXR1cm4hZXx8dC5sZW5ndGglMyE9PTA/ITE6KHRoaXMuX2dsLnVuaWZvcm0zaXYoZSx0KSwhMCl9c2V0SW50QXJyYXk0KGUsdCl7cmV0dXJuIWV8fHQubGVuZ3RoJTQhPT0wPyExOih0aGlzLl9nbC51bmlmb3JtNGl2KGUsdCksITApfXNldFVJbnQoZSx0KXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTF1aShlLHQpLCEwKTohMX1zZXRVSW50MihlLHQsaSl7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm0ydWkoZSx0LGkpLCEwKTohMX1zZXRVSW50MyhlLHQsaSxzKXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTN1aShlLHQsaSxzKSwhMCk6ITF9c2V0VUludDQoZSx0LGkscyxyKXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTR1aShlLHQsaSxzLHIpLCEwKTohMX1zZXRVSW50QXJyYXkoZSx0KXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTF1aXYoZSx0KSwhMCk6ITF9c2V0VUludEFycmF5MihlLHQpe3JldHVybiFlfHx0Lmxlbmd0aCUyIT09MD8hMToodGhpcy5fZ2wudW5pZm9ybTJ1aXYoZSx0KSwhMCl9c2V0VUludEFycmF5MyhlLHQpe3JldHVybiFlfHx0Lmxlbmd0aCUzIT09MD8hMToodGhpcy5fZ2wudW5pZm9ybTN1aXYoZSx0KSwhMCl9c2V0VUludEFycmF5NChlLHQpe3JldHVybiFlfHx0Lmxlbmd0aCU0IT09MD8hMToodGhpcy5fZ2wudW5pZm9ybTR1aXYoZSx0KSwhMCl9c2V0QXJyYXkoZSx0KXtyZXR1cm4hZXx8dC5sZW5ndGg8MT8hMToodGhpcy5fZ2wudW5pZm9ybTFmdihlLHQpLCEwKX1zZXRBcnJheTIoZSx0KXtyZXR1cm4hZXx8dC5sZW5ndGglMiE9PTA/ITE6KHRoaXMuX2dsLnVuaWZvcm0yZnYoZSx0KSwhMCl9c2V0QXJyYXkzKGUsdCl7cmV0dXJuIWV8fHQubGVuZ3RoJTMhPT0wPyExOih0aGlzLl9nbC51bmlmb3JtM2Z2KGUsdCksITApfXNldEFycmF5NChlLHQpe3JldHVybiFlfHx0Lmxlbmd0aCU0IT09MD8hMToodGhpcy5fZ2wudW5pZm9ybTRmdihlLHQpLCEwKX1zZXRNYXRyaWNlcyhlLHQpe3JldHVybiBlPyh0aGlzLl9nbC51bmlmb3JtTWF0cml4NGZ2KGUsITEsdCksITApOiExfXNldE1hdHJpeDN4MyhlLHQpe3JldHVybiBlPyh0aGlzLl9nbC51bmlmb3JtTWF0cml4M2Z2KGUsITEsdCksITApOiExfXNldE1hdHJpeDJ4MihlLHQpe3JldHVybiBlPyh0aGlzLl9nbC51bmlmb3JtTWF0cml4MmZ2KGUsITEsdCksITApOiExfXNldEZsb2F0KGUsdCl7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm0xZihlLHQpLCEwKTohMX1zZXRGbG9hdDIoZSx0LGkpe3JldHVybiBlPyh0aGlzLl9nbC51bmlmb3JtMmYoZSx0LGkpLCEwKTohMX1zZXRGbG9hdDMoZSx0LGkscyl7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm0zZihlLHQsaSxzKSwhMCk6ITF9c2V0RmxvYXQ0KGUsdCxpLHMscil7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm00ZihlLHQsaSxzLHIpLCEwKTohMX1hcHBseVN0YXRlcygpe2lmKHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmFwcGx5KHRoaXMuX2dsKSx0aGlzLl9zdGVuY2lsU3RhdGVDb21wb3Nlci5hcHBseSh0aGlzLl9nbCksdGhpcy5fYWxwaGFTdGF0ZS5hcHBseSh0aGlzLl9nbCksdGhpcy5fY29sb3JXcml0ZUNoYW5nZWQpe3RoaXMuX2NvbG9yV3JpdGVDaGFuZ2VkPSExO2NvbnN0IGU9dGhpcy5fY29sb3JXcml0ZTt0aGlzLl9nbC5jb2xvck1hc2soZSxlLGUsZSl9fXNldENvbG9yV3JpdGUoZSl7ZSE9PXRoaXMuX2NvbG9yV3JpdGUmJih0aGlzLl9jb2xvcldyaXRlQ2hhbmdlZD0hMCx0aGlzLl9jb2xvcldyaXRlPWUpfWdldENvbG9yV3JpdGUoKXtyZXR1cm4gdGhpcy5fY29sb3JXcml0ZX1nZXQgZGVwdGhDdWxsaW5nU3RhdGUoKXtyZXR1cm4gdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGV9Z2V0IGFscGhhU3RhdGUoKXtyZXR1cm4gdGhpcy5fYWxwaGFTdGF0ZX1nZXQgc3RlbmNpbFN0YXRlKCl7cmV0dXJuIHRoaXMuX3N0ZW5jaWxTdGF0ZX1nZXQgc3RlbmNpbFN0YXRlQ29tcG9zZXIoKXtyZXR1cm4gdGhpcy5fc3RlbmNpbFN0YXRlQ29tcG9zZXJ9Y2xlYXJJbnRlcm5hbFRleHR1cmVzQ2FjaGUoKXt0aGlzLl9pbnRlcm5hbFRleHR1cmVzQ2FjaGUubGVuZ3RoPTB9d2lwZUNhY2hlcyhlKXt0aGlzLnByZXZlbnRDYWNoZVdpcGVCZXR3ZWVuRnJhbWVzJiYhZXx8KHRoaXMuX2N1cnJlbnRFZmZlY3Q9bnVsbCx0aGlzLl92aWV3cG9ydENhY2hlZC54PTAsdGhpcy5fdmlld3BvcnRDYWNoZWQueT0wLHRoaXMuX3ZpZXdwb3J0Q2FjaGVkLno9MCx0aGlzLl92aWV3cG9ydENhY2hlZC53PTAsdGhpcy5fdW5iaW5kVmVydGV4QXJyYXlPYmplY3QoKSxlJiYodGhpcy5fY3VycmVudFByb2dyYW09bnVsbCx0aGlzLnJlc2V0VGV4dHVyZUNhY2hlKCksdGhpcy5fc3RlbmNpbFN0YXRlQ29tcG9zZXIucmVzZXQoKSx0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5yZXNldCgpLHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoRnVuYz10aGlzLl9nbC5MRVFVQUwsdGhpcy5fYWxwaGFTdGF0ZS5yZXNldCgpLHRoaXMuX2FscGhhTW9kZT0xLHRoaXMuX2FscGhhRXF1YXRpb249MCx0aGlzLl9jb2xvcldyaXRlPSEwLHRoaXMuX2NvbG9yV3JpdGVDaGFuZ2VkPSEwLHRoaXMuX3VucGFja0ZsaXBZQ2FjaGVkPW51bGwsdGhpcy5fZ2wucGl4ZWxTdG9yZWkodGhpcy5fZ2wuVU5QQUNLX0NPTE9SU1BBQ0VfQ09OVkVSU0lPTl9XRUJHTCx0aGlzLl9nbC5OT05FKSx0aGlzLl9nbC5waXhlbFN0b3JlaSh0aGlzLl9nbC5VTlBBQ0tfUFJFTVVMVElQTFlfQUxQSEFfV0VCR0wsMCksdGhpcy5fbXVzdFdpcGVWZXJ0ZXhBdHRyaWJ1dGVzPSEwLHRoaXMudW5iaW5kQWxsQXR0cmlidXRlcygpKSx0aGlzLl9yZXNldFZlcnRleEJ1ZmZlckJpbmRpbmcoKSx0aGlzLl9jYWNoZWRJbmRleEJ1ZmZlcj1udWxsLHRoaXMuX2NhY2hlZEVmZmVjdEZvclZlcnRleEJ1ZmZlcnM9bnVsbCx0aGlzLmJpbmRJbmRleEJ1ZmZlcihudWxsKSl9X2dldFNhbXBsaW5nUGFyYW1ldGVycyhlLHQpe2NvbnN0IGk9dGhpcy5fZ2w7bGV0IHM9aS5ORUFSRVNULHI9aS5ORUFSRVNUO3N3aXRjaChlKXtjYXNlIDExOnM9aS5MSU5FQVIsdD9yPWkuTElORUFSX01JUE1BUF9ORUFSRVNUOnI9aS5MSU5FQVI7YnJlYWs7Y2FzZSAzOnM9aS5MSU5FQVIsdD9yPWkuTElORUFSX01JUE1BUF9MSU5FQVI6cj1pLkxJTkVBUjticmVhaztjYXNlIDg6cz1pLk5FQVJFU1QsdD9yPWkuTkVBUkVTVF9NSVBNQVBfTElORUFSOnI9aS5ORUFSRVNUO2JyZWFrO2Nhc2UgNDpzPWkuTkVBUkVTVCx0P3I9aS5ORUFSRVNUX01JUE1BUF9ORUFSRVNUOnI9aS5ORUFSRVNUO2JyZWFrO2Nhc2UgNTpzPWkuTkVBUkVTVCx0P3I9aS5MSU5FQVJfTUlQTUFQX05FQVJFU1Q6cj1pLkxJTkVBUjticmVhaztjYXNlIDY6cz1pLk5FQVJFU1QsdD9yPWkuTElORUFSX01JUE1BUF9MSU5FQVI6cj1pLkxJTkVBUjticmVhaztjYXNlIDc6cz1pLk5FQVJFU1Qscj1pLkxJTkVBUjticmVhaztjYXNlIDE6cz1pLk5FQVJFU1Qscj1pLk5FQVJFU1Q7YnJlYWs7Y2FzZSA5OnM9aS5MSU5FQVIsdD9yPWkuTkVBUkVTVF9NSVBNQVBfTkVBUkVTVDpyPWkuTkVBUkVTVDticmVhaztjYXNlIDEwOnM9aS5MSU5FQVIsdD9yPWkuTkVBUkVTVF9NSVBNQVBfTElORUFSOnI9aS5ORUFSRVNUO2JyZWFrO2Nhc2UgMjpzPWkuTElORUFSLHI9aS5MSU5FQVI7YnJlYWs7Y2FzZSAxMjpzPWkuTElORUFSLHI9aS5ORUFSRVNUO2JyZWFrfXJldHVybnttaW46cixtYWc6c319X2NyZWF0ZVRleHR1cmUoKXtjb25zdCBlPXRoaXMuX2dsLmNyZWF0ZVRleHR1cmUoKTtpZighZSl0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBjcmVhdGUgdGV4dHVyZSIpO3JldHVybiBlfV9jcmVhdGVIYXJkd2FyZVRleHR1cmUoKXtyZXR1cm4gbmV3IHRyKHRoaXMuX2NyZWF0ZVRleHR1cmUoKSx0aGlzLl9nbCl9X2NyZWF0ZUludGVybmFsVGV4dHVyZShlLHQsaT0hMCxzPU5lLlVua25vd24pe3ZhciByO2xldCBuPSExLGE9MCxvPTMsaD01LGw9ITEsdT0xO3QhPT12b2lkIDAmJnR5cGVvZiB0PT0ib2JqZWN0Ij8obj0hIXQuZ2VuZXJhdGVNaXBNYXBzLGE9dC50eXBlPT09dm9pZCAwPzA6dC50eXBlLG89dC5zYW1wbGluZ01vZGU9PT12b2lkIDA/Mzp0LnNhbXBsaW5nTW9kZSxoPXQuZm9ybWF0PT09dm9pZCAwPzU6dC5mb3JtYXQsbD10LnVzZVNSR0JCdWZmZXI9PT12b2lkIDA/ITE6dC51c2VTUkdCQnVmZmVyLHU9KHI9dC5zYW1wbGVzKSE9PW51bGwmJnIhPT12b2lkIDA/cjoxKTpuPSEhdCxsJiYobD10aGlzLl9jYXBzLnN1cHBvcnRTUkdCQnVmZmVycyYmKHRoaXMud2ViR0xWZXJzaW9uPjF8fHRoaXMuaXNXZWJHUFUpKSwoYT09PTEmJiF0aGlzLl9jYXBzLnRleHR1cmVGbG9hdExpbmVhckZpbHRlcmluZ3x8YT09PTImJiF0aGlzLl9jYXBzLnRleHR1cmVIYWxmRmxvYXRMaW5lYXJGaWx0ZXJpbmcpJiYobz0xKSxhPT09MSYmIXRoaXMuX2NhcHMudGV4dHVyZUZsb2F0JiYoYT0wLE8uV2FybigiRmxvYXQgdGV4dHVyZXMgYXJlIG5vdCBzdXBwb3J0ZWQuIFR5cGUgZm9yY2VkIHRvIFRFWFRVUkVUWVBFX1VOU0lHTkVEX0JZVEUiKSk7Y29uc3QgZD10aGlzLl9nbCxmPW5ldyBPdCh0aGlzLHMpLF89ZS53aWR0aHx8ZSxFPWUuaGVpZ2h0fHxlLG09ZS5sYXllcnN8fDAsdj10aGlzLl9nZXRTYW1wbGluZ1BhcmFtZXRlcnMobyxuKSxTPW0hPT0wP2QuVEVYVFVSRV8yRF9BUlJBWTpkLlRFWFRVUkVfMkQseT10aGlzLl9nZXRSR0JBQnVmZmVySW50ZXJuYWxTaXplZEZvcm1hdChhLGgsbCksQT10aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChoKSxDPXRoaXMuX2dldFdlYkdMVGV4dHVyZVR5cGUoYSk7cmV0dXJuIHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkoUyxmKSxtIT09MD8oZi5pczJEQXJyYXk9ITAsZC50ZXhJbWFnZTNEKFMsMCx5LF8sRSxtLDAsQSxDLG51bGwpKTpkLnRleEltYWdlMkQoUywwLHksXyxFLDAsQSxDLG51bGwpLGQudGV4UGFyYW1ldGVyaShTLGQuVEVYVFVSRV9NQUdfRklMVEVSLHYubWFnKSxkLnRleFBhcmFtZXRlcmkoUyxkLlRFWFRVUkVfTUlOX0ZJTFRFUix2Lm1pbiksZC50ZXhQYXJhbWV0ZXJpKFMsZC5URVhUVVJFX1dSQVBfUyxkLkNMQU1QX1RPX0VER0UpLGQudGV4UGFyYW1ldGVyaShTLGQuVEVYVFVSRV9XUkFQX1QsZC5DTEFNUF9UT19FREdFKSxuJiZ0aGlzLl9nbC5nZW5lcmF0ZU1pcG1hcChTKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KFMsbnVsbCksZi5fdXNlU1JHQkJ1ZmZlcj1sLGYuYmFzZVdpZHRoPV8sZi5iYXNlSGVpZ2h0PUUsZi53aWR0aD1fLGYuaGVpZ2h0PUUsZi5kZXB0aD1tLGYuaXNSZWFkeT0hMCxmLnNhbXBsZXM9dSxmLmdlbmVyYXRlTWlwTWFwcz1uLGYuc2FtcGxpbmdNb2RlPW8sZi50eXBlPWEsZi5mb3JtYXQ9aCx0aGlzLl9pbnRlcm5hbFRleHR1cmVzQ2FjaGUucHVzaChmKSxmfV9nZXRVc2VTUkdCQnVmZmVyKGUsdCl7cmV0dXJuIGUmJnRoaXMuX2NhcHMuc3VwcG9ydFNSR0JCdWZmZXJzJiYodGhpcy53ZWJHTFZlcnNpb24+MXx8dGhpcy5pc1dlYkdQVXx8dCl9X2NyZWF0ZVRleHR1cmVCYXNlKGUsdCxpLHMscj0zLG49bnVsbCxhPW51bGwsbyxoLGw9bnVsbCx1PW51bGwsZD1udWxsLGY9bnVsbCxfLEUsbSl7ZT1lfHwiIjtjb25zdCB2PWUuc3Vic3RyKDAsNSk9PT0iZGF0YToiLFM9ZS5zdWJzdHIoMCw1KT09PSJibG9iOiIseT12JiZlLmluZGV4T2YoIjtiYXNlNjQsIikhPT0tMSxBPXV8fG5ldyBPdCh0aGlzLE5lLlVybCksQz1lO3RoaXMuX3RyYW5zZm9ybVRleHR1cmVVcmwmJiF5JiYhdSYmIWwmJihlPXRoaXMuX3RyYW5zZm9ybVRleHR1cmVVcmwoZSkpLEMhPT1lJiYoQS5fb3JpZ2luYWxVcmw9Qyk7Y29uc3QgYj1lLmxhc3RJbmRleE9mKCIuIik7bGV0IE09Znx8KGI+LTE/ZS5zdWJzdHJpbmcoYikudG9Mb3dlckNhc2UoKToiIiksTD1udWxsO00uaW5kZXhPZigiPyIpPi0xJiYoTT1NLnNwbGl0KCI/IilbMF0pO2Zvcihjb25zdCBjZSBvZiBvZS5fVGV4dHVyZUxvYWRlcnMpaWYoY2UuY2FuTG9hZChNLF8pKXtMPWNlO2JyZWFrfXMmJnMuYWRkUGVuZGluZ0RhdGEoQSksQS51cmw9ZSxBLmdlbmVyYXRlTWlwTWFwcz0hdCxBLnNhbXBsaW5nTW9kZT1yLEEuaW52ZXJ0WT1pLEEuX3VzZVNSR0JCdWZmZXI9dGhpcy5fZ2V0VXNlU1JHQkJ1ZmZlcighIW0sdCksdGhpcy5fZG9Ob3RIYW5kbGVDb250ZXh0TG9zdHx8KEEuX2J1ZmZlcj1sKTtsZXQgdz1udWxsO24mJiF1JiYodz1BLm9uTG9hZGVkT2JzZXJ2YWJsZS5hZGQobikpLHV8fHRoaXMuX2ludGVybmFsVGV4dHVyZXNDYWNoZS5wdXNoKEEpO2NvbnN0IGRlPShjZSxzZSk9PntzJiZzLnJlbW92ZVBlbmRpbmdEYXRhKEEpLGU9PT1DPyh3JiZBLm9uTG9hZGVkT2JzZXJ2YWJsZS5yZW1vdmUodyksZmUuVXNlRmFsbGJhY2tUZXh0dXJlJiZ0aGlzLl9jcmVhdGVUZXh0dXJlQmFzZShmZS5GYWxsYmFja1RleHR1cmUsdCxBLmludmVydFkscyxyLG51bGwsYSxvLGgsbCxBKSxjZT0oY2V8fCJVbmtub3duIGVycm9yIikrKGZlLlVzZUZhbGxiYWNrVGV4dHVyZT8iIC0gRmFsbGJhY2sgdGV4dHVyZSB3YXMgdXNlZCI6IiIpLEEub25FcnJvck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHttZXNzYWdlOmNlLGV4Y2VwdGlvbjpzZX0pLGEmJmEoY2Usc2UpKTooTy5XYXJuKGBGYWlsZWQgdG8gbG9hZCAke2V9LCBmYWxsaW5nIGJhY2sgdG8gJHtDfWApLHRoaXMuX2NyZWF0ZVRleHR1cmVCYXNlKEMsdCxBLmludmVydFkscyxyLG4sYSxvLGgsbCxBLGQsZixfLEUsbSkpfTtpZihMKXtjb25zdCBjZT1zZT0+e0wubG9hZERhdGEoc2UsQSwodGUsRmUsd2UsSGUsS2UsWWUpPT57WWU/ZGUoIlRleHR1cmVMb2FkZXIgZmFpbGVkIHRvIGxvYWQgZGF0YSIpOm8oQSxNLHMse3dpZHRoOnRlLGhlaWdodDpGZX0sQS5pbnZlcnRZLCF3ZSxIZSwoKT0+KEtlKCksITEpLHIpfSxFKX07bD9sIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI/Y2UobmV3IFVpbnQ4QXJyYXkobCkpOkFycmF5QnVmZmVyLmlzVmlldyhsKT9jZShsKTphJiZhKCJVbmFibGUgdG8gbG9hZDogb25seSBBcnJheUJ1ZmZlciBvciBBcnJheUJ1ZmZlclZpZXcgaXMgc3VwcG9ydGVkIixudWxsKTp0aGlzLl9sb2FkRmlsZShlLHNlPT5jZShuZXcgVWludDhBcnJheShzZSkpLHZvaWQgMCxzP3Mub2ZmbGluZVByb3ZpZGVyOnZvaWQgMCwhMCwoc2UsdGUpPT57ZGUoIlVuYWJsZSB0byBsb2FkICIrKHNlJiZzZS5yZXNwb25zZVVSTCx0ZSkpfSl9ZWxzZXtjb25zdCBjZT1zZT0+e1MmJiF0aGlzLl9kb05vdEhhbmRsZUNvbnRleHRMb3N0JiYoQS5fYnVmZmVyPXNlKSxvKEEsTSxzLHNlLEEuaW52ZXJ0WSx0LCExLGgscil9OyF2fHx5P2wmJih0eXBlb2YgbC5kZWNvZGluZz09InN0cmluZyJ8fGwuY2xvc2UpP2NlKGwpOm9lLl9GaWxlVG9vbHNMb2FkSW1hZ2UoZSxjZSxkZSxzP3Mub2ZmbGluZVByb3ZpZGVyOm51bGwsXyxBLmludmVydFkmJnRoaXMuX2ZlYXR1cmVzLm5lZWRzSW52ZXJ0aW5nQml0bWFwP3tpbWFnZU9yaWVudGF0aW9uOiJmbGlwWSJ9OnZvaWQgMCk6dHlwZW9mIGw9PSJzdHJpbmcifHxsIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ8fEFycmF5QnVmZmVyLmlzVmlldyhsKXx8bCBpbnN0YW5jZW9mIEJsb2I/b2UuX0ZpbGVUb29sc0xvYWRJbWFnZShsLGNlLGRlLHM/cy5vZmZsaW5lUHJvdmlkZXI6bnVsbCxfLEEuaW52ZXJ0WSYmdGhpcy5fZmVhdHVyZXMubmVlZHNJbnZlcnRpbmdCaXRtYXA/e2ltYWdlT3JpZW50YXRpb246ImZsaXBZIn06dm9pZCAwKTpsJiZjZShsKX1yZXR1cm4gQX1jcmVhdGVUZXh0dXJlKGUsdCxpLHMscj0zLG49bnVsbCxhPW51bGwsbz1udWxsLGg9bnVsbCxsPW51bGwsdT1udWxsLGQsZixfLEUpe3JldHVybiB0aGlzLl9jcmVhdGVUZXh0dXJlQmFzZShlLHQsaSxzLHIsbixhLHRoaXMuX3ByZXBhcmVXZWJHTFRleHR1cmUuYmluZCh0aGlzKSwobSx2LFMseSxBLEMpPT57Y29uc3QgYj10aGlzLl9nbCxNPVMud2lkdGg9PT1tJiZTLmhlaWdodD09PXYsTD1sP3RoaXMuX2dldEludGVybmFsRm9ybWF0KGwsQS5fdXNlU1JHQkJ1ZmZlcik6eT09PSIuanBnIiYmIUEuX3VzZVNSR0JCdWZmZXI/Yi5SR0I6QS5fdXNlU1JHQkJ1ZmZlcj9iLlNSR0I4X0FMUEhBODpiLlJHQkE7bGV0IGs9bD90aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChsKTp5PT09Ii5qcGciJiYhQS5fdXNlU1JHQkJ1ZmZlcj9iLlJHQjpiLlJHQkE7aWYoQS5fdXNlU1JHQkJ1ZmZlciYmdGhpcy53ZWJHTFZlcnNpb249PT0xJiYoaz1MKSxNKXJldHVybiBiLnRleEltYWdlMkQoYi5URVhUVVJFXzJELDAsTCxrLGIuVU5TSUdORURfQllURSxTKSwhMTtjb25zdCB3PXRoaXMuX2NhcHMubWF4VGV4dHVyZVNpemU7aWYoUy53aWR0aD53fHxTLmhlaWdodD53fHwhdGhpcy5fc3VwcG9ydHNIYXJkd2FyZVRleHR1cmVSZXNjYWxpbmcpcmV0dXJuIHRoaXMuX3ByZXBhcmVXb3JraW5nQ2FudmFzKCksIXRoaXMuX3dvcmtpbmdDYW52YXN8fCF0aGlzLl93b3JraW5nQ29udGV4dHx8KHRoaXMuX3dvcmtpbmdDYW52YXMud2lkdGg9bSx0aGlzLl93b3JraW5nQ2FudmFzLmhlaWdodD12LHRoaXMuX3dvcmtpbmdDb250ZXh0LmRyYXdJbWFnZShTLDAsMCxTLndpZHRoLFMuaGVpZ2h0LDAsMCxtLHYpLGIudGV4SW1hZ2UyRChiLlRFWFRVUkVfMkQsMCxMLGssYi5VTlNJR05FRF9CWVRFLHRoaXMuX3dvcmtpbmdDYW52YXMpLEEud2lkdGg9bSxBLmhlaWdodD12KSwhMTt7Y29uc3QgZGU9bmV3IE90KHRoaXMsTmUuVGVtcCk7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShiLlRFWFRVUkVfMkQsZGUsITApLGIudGV4SW1hZ2UyRChiLlRFWFRVUkVfMkQsMCxMLGssYi5VTlNJR05FRF9CWVRFLFMpLHRoaXMuX3Jlc2NhbGVUZXh0dXJlKGRlLEEscyxMLCgpPT57dGhpcy5fcmVsZWFzZVRleHR1cmUoZGUpLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkoYi5URVhUVVJFXzJELEEsITApLEMoKX0pfXJldHVybiEwfSxvLGgsbCx1LGQsZixFKX1zdGF0aWMgX0ZpbGVUb29sc0xvYWRJbWFnZShlLHQsaSxzLHIsbil7dGhyb3cgJCgiRmlsZVRvb2xzIil9X3Jlc2NhbGVUZXh0dXJlKGUsdCxpLHMscil7fWNyZWF0ZVJhd1RleHR1cmUoZSx0LGkscyxyLG4sYSxvPW51bGwsaD0wLGw9MCx1PSExKXt0aHJvdyAkKCJFbmdpbmUuUmF3VGV4dHVyZSIpfWNyZWF0ZVJhd0N1YmVUZXh0dXJlKGUsdCxpLHMscixuLGEsbz1udWxsKXt0aHJvdyAkKCJFbmdpbmUuUmF3VGV4dHVyZSIpfWNyZWF0ZVJhd1RleHR1cmUzRChlLHQsaSxzLHIsbixhLG8saD1udWxsLGw9MCl7dGhyb3cgJCgiRW5naW5lLlJhd1RleHR1cmUiKX1jcmVhdGVSYXdUZXh0dXJlMkRBcnJheShlLHQsaSxzLHIsbixhLG8saD1udWxsLGw9MCl7dGhyb3cgJCgiRW5naW5lLlJhd1RleHR1cmUiKX1fdW5wYWNrRmxpcFkoZSl7dGhpcy5fdW5wYWNrRmxpcFlDYWNoZWQhPT1lJiYodGhpcy5fZ2wucGl4ZWxTdG9yZWkodGhpcy5fZ2wuVU5QQUNLX0ZMSVBfWV9XRUJHTCxlPzE6MCksdGhpcy5lbmFibGVVbnBhY2tGbGlwWUNhY2hlZCYmKHRoaXMuX3VucGFja0ZsaXBZQ2FjaGVkPWUpKX1fZ2V0VW5wYWNrQWxpZ25lbWVudCgpe3JldHVybiB0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuVU5QQUNLX0FMSUdOTUVOVCl9X2dldFRleHR1cmVUYXJnZXQoZSl7cmV0dXJuIGUuaXNDdWJlP3RoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVA6ZS5pczNEP3RoaXMuX2dsLlRFWFRVUkVfM0Q6ZS5pczJEQXJyYXl8fGUuaXNNdWx0aXZpZXc/dGhpcy5fZ2wuVEVYVFVSRV8yRF9BUlJBWTp0aGlzLl9nbC5URVhUVVJFXzJEfXVwZGF0ZVRleHR1cmVTYW1wbGluZ01vZGUoZSx0LGk9ITEpe2NvbnN0IHM9dGhpcy5fZ2V0VGV4dHVyZVRhcmdldCh0KSxyPXRoaXMuX2dldFNhbXBsaW5nUGFyYW1ldGVycyhlLHQuZ2VuZXJhdGVNaXBNYXBzfHxpKTt0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihzLHRoaXMuX2dsLlRFWFRVUkVfTUFHX0ZJTFRFUixyLm1hZyx0KSx0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihzLHRoaXMuX2dsLlRFWFRVUkVfTUlOX0ZJTFRFUixyLm1pbiksaSYmKHQuZ2VuZXJhdGVNaXBNYXBzPSEwLHRoaXMuX2dsLmdlbmVyYXRlTWlwbWFwKHMpKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHMsbnVsbCksdC5zYW1wbGluZ01vZGU9ZX11cGRhdGVUZXh0dXJlRGltZW5zaW9ucyhlLHQsaSxzPTEpe311cGRhdGVUZXh0dXJlV3JhcHBpbmdNb2RlKGUsdCxpPW51bGwscz1udWxsKXtjb25zdCByPXRoaXMuX2dldFRleHR1cmVUYXJnZXQoZSk7dCE9PW51bGwmJih0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihyLHRoaXMuX2dsLlRFWFRVUkVfV1JBUF9TLHRoaXMuX2dldFRleHR1cmVXcmFwTW9kZSh0KSxlKSxlLl9jYWNoZWRXcmFwVT10KSxpIT09bnVsbCYmKHRoaXMuX3NldFRleHR1cmVQYXJhbWV0ZXJJbnRlZ2VyKHIsdGhpcy5fZ2wuVEVYVFVSRV9XUkFQX1QsdGhpcy5fZ2V0VGV4dHVyZVdyYXBNb2RlKGkpLGUpLGUuX2NhY2hlZFdyYXBWPWkpLChlLmlzMkRBcnJheXx8ZS5pczNEKSYmcyE9PW51bGwmJih0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihyLHRoaXMuX2dsLlRFWFRVUkVfV1JBUF9SLHRoaXMuX2dldFRleHR1cmVXcmFwTW9kZShzKSxlKSxlLl9jYWNoZWRXcmFwUj1zKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHIsbnVsbCl9X3NldHVwRGVwdGhTdGVuY2lsVGV4dHVyZShlLHQsaSxzLHIsbj0xKXtjb25zdCBhPXQud2lkdGh8fHQsbz10LmhlaWdodHx8dCxoPXQubGF5ZXJzfHwwO2UuYmFzZVdpZHRoPWEsZS5iYXNlSGVpZ2h0PW8sZS53aWR0aD1hLGUuaGVpZ2h0PW8sZS5pczJEQXJyYXk9aD4wLGUuZGVwdGg9aCxlLmlzUmVhZHk9ITAsZS5zYW1wbGVzPW4sZS5nZW5lcmF0ZU1pcE1hcHM9ITEsZS5zYW1wbGluZ01vZGU9cz8yOjEsZS50eXBlPTAsZS5fY29tcGFyaXNvbkZ1bmN0aW9uPXI7Y29uc3QgbD10aGlzLl9nbCx1PXRoaXMuX2dldFRleHR1cmVUYXJnZXQoZSksZD10aGlzLl9nZXRTYW1wbGluZ1BhcmFtZXRlcnMoZS5zYW1wbGluZ01vZGUsITEpO2wudGV4UGFyYW1ldGVyaSh1LGwuVEVYVFVSRV9NQUdfRklMVEVSLGQubWFnKSxsLnRleFBhcmFtZXRlcmkodSxsLlRFWFRVUkVfTUlOX0ZJTFRFUixkLm1pbiksbC50ZXhQYXJhbWV0ZXJpKHUsbC5URVhUVVJFX1dSQVBfUyxsLkNMQU1QX1RPX0VER0UpLGwudGV4UGFyYW1ldGVyaSh1LGwuVEVYVFVSRV9XUkFQX1QsbC5DTEFNUF9UT19FREdFKSx0aGlzLndlYkdMVmVyc2lvbj4xJiYocj09PTA/KGwudGV4UGFyYW1ldGVyaSh1LGwuVEVYVFVSRV9DT01QQVJFX0ZVTkMsNTE1KSxsLnRleFBhcmFtZXRlcmkodSxsLlRFWFRVUkVfQ09NUEFSRV9NT0RFLGwuTk9ORSkpOihsLnRleFBhcmFtZXRlcmkodSxsLlRFWFRVUkVfQ09NUEFSRV9GVU5DLHIpLGwudGV4UGFyYW1ldGVyaSh1LGwuVEVYVFVSRV9DT01QQVJFX01PREUsbC5DT01QQVJFX1JFRl9UT19URVhUVVJFKSkpfV91cGxvYWRDb21wcmVzc2VkRGF0YVRvVGV4dHVyZURpcmVjdGx5KGUsdCxpLHMscixuPTAsYT0wKXtjb25zdCBvPXRoaXMuX2dsO2xldCBoPW8uVEVYVFVSRV8yRDtpZihlLmlzQ3ViZSYmKGg9by5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1grbiksZS5fdXNlU1JHQkJ1ZmZlcilzd2l0Y2godCl7Y2FzZSAzNzQ5MjpjYXNlIDM2MTk2OnRoaXMuX2NhcHMuZXRjMj90PW8uQ09NUFJFU1NFRF9TUkdCOF9FVEMyOmUuX3VzZVNSR0JCdWZmZXI9ITE7YnJlYWs7Y2FzZSAzNzQ5Njp0aGlzLl9jYXBzLmV0YzI/dD1vLkNPTVBSRVNTRURfU1JHQjhfQUxQSEE4X0VUQzJfRUFDOmUuX3VzZVNSR0JCdWZmZXI9ITE7YnJlYWs7Y2FzZSAzNjQ5Mjp0PW8uQ09NUFJFU1NFRF9TUkdCX0FMUEhBX0JQVENfVU5PUk1fRVhUO2JyZWFrO2Nhc2UgMzc4MDg6dD1vLkNPTVBSRVNTRURfU1JHQjhfQUxQSEE4X0FTVENfNHg0X0tIUjticmVhaztjYXNlIDMzNzc2OnRoaXMuX2NhcHMuczN0Y19zcmdiP3Q9by5DT01QUkVTU0VEX1NSR0JfUzNUQ19EWFQxX0VYVDplLl91c2VTUkdCQnVmZmVyPSExO2JyZWFrO2Nhc2UgMzM3Nzc6dGhpcy5fY2Fwcy5zM3RjX3NyZ2I/dD1vLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9TM1RDX0RYVDFfRVhUOmUuX3VzZVNSR0JCdWZmZXI9ITE7YnJlYWs7Y2FzZSAzMzc3OTp0aGlzLl9jYXBzLnMzdGNfc3JnYj90PW8uQ09NUFJFU1NFRF9TUkdCX0FMUEhBX1MzVENfRFhUNV9FWFQ6ZS5fdXNlU1JHQkJ1ZmZlcj0hMTticmVhaztkZWZhdWx0OmUuX3VzZVNSR0JCdWZmZXI9ITE7YnJlYWt9dGhpcy5fZ2wuY29tcHJlc3NlZFRleEltYWdlMkQoaCxhLHQsaSxzLDAscil9X3VwbG9hZERhdGFUb1RleHR1cmVEaXJlY3RseShlLHQsaT0wLHM9MCxyLG49ITEpe2NvbnN0IGE9dGhpcy5fZ2wsbz10aGlzLl9nZXRXZWJHTFRleHR1cmVUeXBlKGUudHlwZSksaD10aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChlLmZvcm1hdCksbD1yPT09dm9pZCAwP3RoaXMuX2dldFJHQkFCdWZmZXJJbnRlcm5hbFNpemVkRm9ybWF0KGUudHlwZSxlLmZvcm1hdCxlLl91c2VTUkdCQnVmZmVyKTp0aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChyLGUuX3VzZVNSR0JCdWZmZXIpO3RoaXMuX3VucGFja0ZsaXBZKGUuaW52ZXJ0WSk7bGV0IHU9YS5URVhUVVJFXzJEO2UuaXNDdWJlJiYodT1hLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWCtpKTtjb25zdCBkPU1hdGgucm91bmQoTWF0aC5sb2coZS53aWR0aCkqTWF0aC5MT0cyRSksZj1NYXRoLnJvdW5kKE1hdGgubG9nKGUuaGVpZ2h0KSpNYXRoLkxPRzJFKSxfPW4/ZS53aWR0aDpNYXRoLnBvdygyLE1hdGgubWF4KGQtcywwKSksRT1uP2UuaGVpZ2h0Ok1hdGgucG93KDIsTWF0aC5tYXgoZi1zLDApKTthLnRleEltYWdlMkQodSxzLGwsXyxFLDAsaCxvLHQpfXVwZGF0ZVRleHR1cmVEYXRhKGUsdCxpLHMscixuLGE9MCxvPTAsaD0hMSl7Y29uc3QgbD10aGlzLl9nbCx1PXRoaXMuX2dldFdlYkdMVGV4dHVyZVR5cGUoZS50eXBlKSxkPXRoaXMuX2dldEludGVybmFsRm9ybWF0KGUuZm9ybWF0KTt0aGlzLl91bnBhY2tGbGlwWShlLmludmVydFkpO2xldCBmPWwuVEVYVFVSRV8yRCxfPWwuVEVYVFVSRV8yRDtlLmlzQ3ViZSYmKF89bC5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1grYSxmPWwuVEVYVFVSRV9DVUJFX01BUCksdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShmLGUsITApLGwudGV4U3ViSW1hZ2UyRChfLG8saSxzLHIsbixkLHUsdCksaCYmdGhpcy5fZ2wuZ2VuZXJhdGVNaXBtYXAoXyksdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShmLG51bGwpfV91cGxvYWRBcnJheUJ1ZmZlclZpZXdUb1RleHR1cmUoZSx0LGk9MCxzPTApe2NvbnN0IHI9dGhpcy5fZ2wsbj1lLmlzQ3ViZT9yLlRFWFRVUkVfQ1VCRV9NQVA6ci5URVhUVVJFXzJEO3RoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkobixlLCEwKSx0aGlzLl91cGxvYWREYXRhVG9UZXh0dXJlRGlyZWN0bHkoZSx0LGkscyksdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShuLG51bGwsITApfV9wcmVwYXJlV2ViR0xUZXh0dXJlQ29udGludWF0aW9uKGUsdCxpLHMscil7Y29uc3Qgbj10aGlzLl9nbDtpZighbilyZXR1cm47Y29uc3QgYT10aGlzLl9nZXRTYW1wbGluZ1BhcmFtZXRlcnMociwhaSk7bi50ZXhQYXJhbWV0ZXJpKG4uVEVYVFVSRV8yRCxuLlRFWFRVUkVfTUFHX0ZJTFRFUixhLm1hZyksbi50ZXhQYXJhbWV0ZXJpKG4uVEVYVFVSRV8yRCxuLlRFWFRVUkVfTUlOX0ZJTFRFUixhLm1pbiksIWkmJiFzJiZuLmdlbmVyYXRlTWlwbWFwKG4uVEVYVFVSRV8yRCksdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShuLlRFWFRVUkVfMkQsbnVsbCksdCYmdC5yZW1vdmVQZW5kaW5nRGF0YShlKSxlLm9uTG9hZGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSksZS5vbkxvYWRlZE9ic2VydmFibGUuY2xlYXIoKX1fcHJlcGFyZVdlYkdMVGV4dHVyZShlLHQsaSxzLHIsbixhLG8saD0zKXtjb25zdCBsPXRoaXMuZ2V0Q2FwcygpLm1heFRleHR1cmVTaXplLHU9TWF0aC5taW4obCx0aGlzLm5lZWRQT1RUZXh0dXJlcz9vZS5HZXRFeHBvbmVudE9mVHdvKHMud2lkdGgsbCk6cy53aWR0aCksZD1NYXRoLm1pbihsLHRoaXMubmVlZFBPVFRleHR1cmVzP29lLkdldEV4cG9uZW50T2ZUd28ocy5oZWlnaHQsbCk6cy5oZWlnaHQpLGY9dGhpcy5fZ2w7aWYoZil7aWYoIWUuX2hhcmR3YXJlVGV4dHVyZSl7aSYmaS5yZW1vdmVQZW5kaW5nRGF0YShlKTtyZXR1cm59dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShmLlRFWFRVUkVfMkQsZSwhMCksdGhpcy5fdW5wYWNrRmxpcFkocj09PXZvaWQgMD8hMDohIXIpLGUuYmFzZVdpZHRoPXMud2lkdGgsZS5iYXNlSGVpZ2h0PXMuaGVpZ2h0LGUud2lkdGg9dSxlLmhlaWdodD1kLGUuaXNSZWFkeT0hMCwhbyh1LGQscyx0LGUsKCk9Pnt0aGlzLl9wcmVwYXJlV2ViR0xUZXh0dXJlQ29udGludWF0aW9uKGUsaSxuLGEsaCl9KSYmdGhpcy5fcHJlcGFyZVdlYkdMVGV4dHVyZUNvbnRpbnVhdGlvbihlLGksbixhLGgpfX1fc2V0dXBGcmFtZWJ1ZmZlckRlcHRoQXR0YWNobWVudHMoZSx0LGkscyxyPTEpe2NvbnN0IG49dGhpcy5fZ2w7aWYoZSYmdClyZXR1cm4gdGhpcy5fY3JlYXRlUmVuZGVyQnVmZmVyKGkscyxyLG4uREVQVEhfU1RFTkNJTCxuLkRFUFRIMjRfU1RFTkNJTDgsbi5ERVBUSF9TVEVOQ0lMX0FUVEFDSE1FTlQpO2lmKHQpe2xldCBhPW4uREVQVEhfQ09NUE9ORU5UMTY7cmV0dXJuIHRoaXMuX3dlYkdMVmVyc2lvbj4xJiYoYT1uLkRFUFRIX0NPTVBPTkVOVDMyRiksdGhpcy5fY3JlYXRlUmVuZGVyQnVmZmVyKGkscyxyLGEsYSxuLkRFUFRIX0FUVEFDSE1FTlQpfXJldHVybiBlP3RoaXMuX2NyZWF0ZVJlbmRlckJ1ZmZlcihpLHMscixuLlNURU5DSUxfSU5ERVg4LG4uU1RFTkNJTF9JTkRFWDgsbi5TVEVOQ0lMX0FUVEFDSE1FTlQpOm51bGx9X2NyZWF0ZVJlbmRlckJ1ZmZlcihlLHQsaSxzLHIsbixhPSEwKXtjb25zdCBoPXRoaXMuX2dsLmNyZWF0ZVJlbmRlcmJ1ZmZlcigpO3JldHVybiB0aGlzLl91cGRhdGVSZW5kZXJCdWZmZXIoaCxlLHQsaSxzLHIsbixhKX1fdXBkYXRlUmVuZGVyQnVmZmVyKGUsdCxpLHMscixuLGEsbz0hMCl7Y29uc3QgaD10aGlzLl9nbDtyZXR1cm4gaC5iaW5kUmVuZGVyYnVmZmVyKGguUkVOREVSQlVGRkVSLGUpLHM+MSYmaC5yZW5kZXJidWZmZXJTdG9yYWdlTXVsdGlzYW1wbGU/aC5yZW5kZXJidWZmZXJTdG9yYWdlTXVsdGlzYW1wbGUoaC5SRU5ERVJCVUZGRVIscyxuLHQsaSk6aC5yZW5kZXJidWZmZXJTdG9yYWdlKGguUkVOREVSQlVGRkVSLHIsdCxpKSxoLmZyYW1lYnVmZmVyUmVuZGVyYnVmZmVyKGguRlJBTUVCVUZGRVIsYSxoLlJFTkRFUkJVRkZFUixlKSxvJiZoLmJpbmRSZW5kZXJidWZmZXIoaC5SRU5ERVJCVUZGRVIsbnVsbCksZX1fcmVsZWFzZVRleHR1cmUoZSl7dmFyIHQ7dGhpcy5fZGVsZXRlVGV4dHVyZSgodD1lLl9oYXJkd2FyZVRleHR1cmUpPT09bnVsbHx8dD09PXZvaWQgMD92b2lkIDA6dC51bmRlcmx5aW5nUmVzb3VyY2UpLHRoaXMudW5iaW5kQWxsVGV4dHVyZXMoKTtjb25zdCBpPXRoaXMuX2ludGVybmFsVGV4dHVyZXNDYWNoZS5pbmRleE9mKGUpO2khPT0tMSYmdGhpcy5faW50ZXJuYWxUZXh0dXJlc0NhY2hlLnNwbGljZShpLDEpLGUuX2xvZFRleHR1cmVIaWdoJiZlLl9sb2RUZXh0dXJlSGlnaC5kaXNwb3NlKCksZS5fbG9kVGV4dHVyZU1pZCYmZS5fbG9kVGV4dHVyZU1pZC5kaXNwb3NlKCksZS5fbG9kVGV4dHVyZUxvdyYmZS5fbG9kVGV4dHVyZUxvdy5kaXNwb3NlKCksZS5faXJyYWRpYW5jZVRleHR1cmUmJmUuX2lycmFkaWFuY2VUZXh0dXJlLmRpc3Bvc2UoKX1fcmVsZWFzZVJlbmRlclRhcmdldFdyYXBwZXIoZSl7Y29uc3QgdD10aGlzLl9yZW5kZXJUYXJnZXRXcmFwcGVyQ2FjaGUuaW5kZXhPZihlKTt0IT09LTEmJnRoaXMuX3JlbmRlclRhcmdldFdyYXBwZXJDYWNoZS5zcGxpY2UodCwxKX1fZGVsZXRlVGV4dHVyZShlKXtlJiZ0aGlzLl9nbC5kZWxldGVUZXh0dXJlKGUpfV9zZXRQcm9ncmFtKGUpe3RoaXMuX2N1cnJlbnRQcm9ncmFtIT09ZSYmKHRoaXMuX2dsLnVzZVByb2dyYW0oZSksdGhpcy5fY3VycmVudFByb2dyYW09ZSl9YmluZFNhbXBsZXJzKGUpe2NvbnN0IHQ9ZS5nZXRQaXBlbGluZUNvbnRleHQoKTt0aGlzLl9zZXRQcm9ncmFtKHQucHJvZ3JhbSk7Y29uc3QgaT1lLmdldFNhbXBsZXJzKCk7Zm9yKGxldCBzPTA7czxpLmxlbmd0aDtzKyspe2NvbnN0IHI9ZS5nZXRVbmlmb3JtKGlbc10pO3ImJih0aGlzLl9ib3VuZFVuaWZvcm1zW3NdPXIpfXRoaXMuX2N1cnJlbnRFZmZlY3Q9bnVsbH1fYWN0aXZhdGVDdXJyZW50VGV4dHVyZSgpe3RoaXMuX2N1cnJlbnRUZXh0dXJlQ2hhbm5lbCE9PXRoaXMuX2FjdGl2ZUNoYW5uZWwmJih0aGlzLl9nbC5hY3RpdmVUZXh0dXJlKHRoaXMuX2dsLlRFWFRVUkUwK3RoaXMuX2FjdGl2ZUNoYW5uZWwpLHRoaXMuX2N1cnJlbnRUZXh0dXJlQ2hhbm5lbD10aGlzLl9hY3RpdmVDaGFubmVsKX1fYmluZFRleHR1cmVEaXJlY3RseShlLHQsaT0hMSxzPSExKXt2YXIgcixuO2xldCBhPSExO2NvbnN0IG89dCYmdC5fYXNzb2NpYXRlZENoYW5uZWw+LTE7aWYoaSYmbyYmKHRoaXMuX2FjdGl2ZUNoYW5uZWw9dC5fYXNzb2NpYXRlZENoYW5uZWwpLHRoaXMuX2JvdW5kVGV4dHVyZXNDYWNoZVt0aGlzLl9hY3RpdmVDaGFubmVsXSE9PXR8fHMpe2lmKHRoaXMuX2FjdGl2YXRlQ3VycmVudFRleHR1cmUoKSx0JiZ0LmlzTXVsdGl2aWV3KXRocm93IGNvbnNvbGUuZXJyb3IoZSx0KSwiX2JpbmRUZXh0dXJlRGlyZWN0bHkgY2FsbGVkIHdpdGggYSBtdWx0aXZpZXcgdGV4dHVyZSEiO3RoaXMuX2dsLmJpbmRUZXh0dXJlKGUsKG49KHI9dD09bnVsbD92b2lkIDA6dC5faGFyZHdhcmVUZXh0dXJlKT09PW51bGx8fHI9PT12b2lkIDA/dm9pZCAwOnIudW5kZXJseWluZ1Jlc291cmNlKSE9PW51bGwmJm4hPT12b2lkIDA/bjpudWxsKSx0aGlzLl9ib3VuZFRleHR1cmVzQ2FjaGVbdGhpcy5fYWN0aXZlQ2hhbm5lbF09dCx0JiYodC5fYXNzb2NpYXRlZENoYW5uZWw9dGhpcy5fYWN0aXZlQ2hhbm5lbCl9ZWxzZSBpJiYoYT0hMCx0aGlzLl9hY3RpdmF0ZUN1cnJlbnRUZXh0dXJlKCkpO3JldHVybiBvJiYhaSYmdGhpcy5fYmluZFNhbXBsZXJVbmlmb3JtVG9DaGFubmVsKHQuX2Fzc29jaWF0ZWRDaGFubmVsLHRoaXMuX2FjdGl2ZUNoYW5uZWwpLGF9X2JpbmRUZXh0dXJlKGUsdCxpKXtpZihlPT09dm9pZCAwKXJldHVybjt0JiYodC5fYXNzb2NpYXRlZENoYW5uZWw9ZSksdGhpcy5fYWN0aXZlQ2hhbm5lbD1lO2NvbnN0IHM9dD90aGlzLl9nZXRUZXh0dXJlVGFyZ2V0KHQpOnRoaXMuX2dsLlRFWFRVUkVfMkQ7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShzLHQpfXVuYmluZEFsbFRleHR1cmVzKCl7Zm9yKGxldCBlPTA7ZTx0aGlzLl9tYXhTaW11bHRhbmVvdXNUZXh0dXJlcztlKyspdGhpcy5fYWN0aXZlQ2hhbm5lbD1lLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkodGhpcy5fZ2wuVEVYVFVSRV8yRCxudWxsKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVAsbnVsbCksdGhpcy53ZWJHTFZlcnNpb24+MSYmKHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkodGhpcy5fZ2wuVEVYVFVSRV8zRCxudWxsKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfMkRfQVJSQVksbnVsbCkpfXNldFRleHR1cmUoZSx0LGkscyl7ZSE9PXZvaWQgMCYmKHQmJih0aGlzLl9ib3VuZFVuaWZvcm1zW2VdPXQpLHRoaXMuX3NldFRleHR1cmUoZSxpKSl9X2JpbmRTYW1wbGVyVW5pZm9ybVRvQ2hhbm5lbChlLHQpe2NvbnN0IGk9dGhpcy5fYm91bmRVbmlmb3Jtc1tlXTshaXx8aS5fY3VycmVudFN0YXRlPT09dHx8KHRoaXMuX2dsLnVuaWZvcm0xaShpLHQpLGkuX2N1cnJlbnRTdGF0ZT10KX1fZ2V0VGV4dHVyZVdyYXBNb2RlKGUpe3N3aXRjaChlKXtjYXNlIDE6cmV0dXJuIHRoaXMuX2dsLlJFUEVBVDtjYXNlIDA6cmV0dXJuIHRoaXMuX2dsLkNMQU1QX1RPX0VER0U7Y2FzZSAyOnJldHVybiB0aGlzLl9nbC5NSVJST1JFRF9SRVBFQVR9cmV0dXJuIHRoaXMuX2dsLlJFUEVBVH1fc2V0VGV4dHVyZShlLHQsaT0hMSxzPSExLHI9IiIpe2lmKCF0KXJldHVybiB0aGlzLl9ib3VuZFRleHR1cmVzQ2FjaGVbZV0hPW51bGwmJih0aGlzLl9hY3RpdmVDaGFubmVsPWUsdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseSh0aGlzLl9nbC5URVhUVVJFXzJELG51bGwpLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkodGhpcy5fZ2wuVEVYVFVSRV9DVUJFX01BUCxudWxsKSx0aGlzLndlYkdMVmVyc2lvbj4xJiYodGhpcy5fYmluZFRleHR1cmVEaXJlY3RseSh0aGlzLl9nbC5URVhUVVJFXzNELG51bGwpLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkodGhpcy5fZ2wuVEVYVFVSRV8yRF9BUlJBWSxudWxsKSkpLCExO2lmKHQudmlkZW8pdGhpcy5fYWN0aXZlQ2hhbm5lbD1lLHQudXBkYXRlKCk7ZWxzZSBpZih0LmRlbGF5TG9hZFN0YXRlPT09NClyZXR1cm4gdC5kZWxheUxvYWQoKSwhMTtsZXQgbjtzP249dC5kZXB0aFN0ZW5jaWxUZXh0dXJlOnQuaXNSZWFkeSgpP249dC5nZXRJbnRlcm5hbFRleHR1cmUoKTp0LmlzQ3ViZT9uPXRoaXMuZW1wdHlDdWJlVGV4dHVyZTp0LmlzM0Q/bj10aGlzLmVtcHR5VGV4dHVyZTNEOnQuaXMyREFycmF5P249dGhpcy5lbXB0eVRleHR1cmUyREFycmF5Om49dGhpcy5lbXB0eVRleHR1cmUsIWkmJm4mJihuLl9hc3NvY2lhdGVkQ2hhbm5lbD1lKTtsZXQgYT0hMDt0aGlzLl9ib3VuZFRleHR1cmVzQ2FjaGVbZV09PT1uJiYoaXx8dGhpcy5fYmluZFNhbXBsZXJVbmlmb3JtVG9DaGFubmVsKG4uX2Fzc29jaWF0ZWRDaGFubmVsLGUpLGE9ITEpLHRoaXMuX2FjdGl2ZUNoYW5uZWw9ZTtjb25zdCBvPXRoaXMuX2dldFRleHR1cmVUYXJnZXQobik7aWYoYSYmdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShvLG4saSksbiYmIW4uaXNNdWx0aXZpZXcpe2lmKG4uaXNDdWJlJiZuLl9jYWNoZWRDb29yZGluYXRlc01vZGUhPT10LmNvb3JkaW5hdGVzTW9kZSl7bi5fY2FjaGVkQ29vcmRpbmF0ZXNNb2RlPXQuY29vcmRpbmF0ZXNNb2RlO2NvbnN0IGg9dC5jb29yZGluYXRlc01vZGUhPT0zJiZ0LmNvb3JkaW5hdGVzTW9kZSE9PTU/MTowO3Qud3JhcFU9aCx0LndyYXBWPWh9bi5fY2FjaGVkV3JhcFUhPT10LndyYXBVJiYobi5fY2FjaGVkV3JhcFU9dC53cmFwVSx0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihvLHRoaXMuX2dsLlRFWFRVUkVfV1JBUF9TLHRoaXMuX2dldFRleHR1cmVXcmFwTW9kZSh0LndyYXBVKSxuKSksbi5fY2FjaGVkV3JhcFYhPT10LndyYXBWJiYobi5fY2FjaGVkV3JhcFY9dC53cmFwVix0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihvLHRoaXMuX2dsLlRFWFRVUkVfV1JBUF9ULHRoaXMuX2dldFRleHR1cmVXcmFwTW9kZSh0LndyYXBWKSxuKSksbi5pczNEJiZuLl9jYWNoZWRXcmFwUiE9PXQud3JhcFImJihuLl9jYWNoZWRXcmFwUj10LndyYXBSLHRoaXMuX3NldFRleHR1cmVQYXJhbWV0ZXJJbnRlZ2VyKG8sdGhpcy5fZ2wuVEVYVFVSRV9XUkFQX1IsdGhpcy5fZ2V0VGV4dHVyZVdyYXBNb2RlKHQud3JhcFIpLG4pKSx0aGlzLl9zZXRBbmlzb3Ryb3BpY0xldmVsKG8sbix0LmFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWwpfXJldHVybiEwfXNldFRleHR1cmVBcnJheShlLHQsaSxzKXtpZighKGU9PT12b2lkIDB8fCF0KSl7KCF0aGlzLl90ZXh0dXJlVW5pdHN8fHRoaXMuX3RleHR1cmVVbml0cy5sZW5ndGghPT1pLmxlbmd0aCkmJih0aGlzLl90ZXh0dXJlVW5pdHM9bmV3IEludDMyQXJyYXkoaS5sZW5ndGgpKTtmb3IobGV0IHI9MDtyPGkubGVuZ3RoO3IrKyl7Y29uc3Qgbj1pW3JdLmdldEludGVybmFsVGV4dHVyZSgpO24/KHRoaXMuX3RleHR1cmVVbml0c1tyXT1lK3Isbi5fYXNzb2NpYXRlZENoYW5uZWw9ZStyKTp0aGlzLl90ZXh0dXJlVW5pdHNbcl09LTF9dGhpcy5fZ2wudW5pZm9ybTFpdih0LHRoaXMuX3RleHR1cmVVbml0cyk7Zm9yKGxldCByPTA7cjxpLmxlbmd0aDtyKyspdGhpcy5fc2V0VGV4dHVyZSh0aGlzLl90ZXh0dXJlVW5pdHNbcl0saVtyXSwhMCl9fV9zZXRBbmlzb3Ryb3BpY0xldmVsKGUsdCxpKXtjb25zdCBzPXRoaXMuX2NhcHMudGV4dHVyZUFuaXNvdHJvcGljRmlsdGVyRXh0ZW5zaW9uO3Quc2FtcGxpbmdNb2RlIT09MTEmJnQuc2FtcGxpbmdNb2RlIT09MyYmdC5zYW1wbGluZ01vZGUhPT0yJiYoaT0xKSxzJiZ0Ll9jYWNoZWRBbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsIT09aSYmKHRoaXMuX3NldFRleHR1cmVQYXJhbWV0ZXJGbG9hdChlLHMuVEVYVFVSRV9NQVhfQU5JU09UUk9QWV9FWFQsTWF0aC5taW4oaSx0aGlzLl9jYXBzLm1heEFuaXNvdHJvcHkpLHQpLHQuX2NhY2hlZEFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWw9aSl9X3NldFRleHR1cmVQYXJhbWV0ZXJGbG9hdChlLHQsaSxzKXt0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KGUscywhMCwhMCksdGhpcy5fZ2wudGV4UGFyYW1ldGVyZihlLHQsaSl9X3NldFRleHR1cmVQYXJhbWV0ZXJJbnRlZ2VyKGUsdCxpLHMpe3MmJnRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkoZSxzLCEwLCEwKSx0aGlzLl9nbC50ZXhQYXJhbWV0ZXJpKGUsdCxpKX11bmJpbmRBbGxBdHRyaWJ1dGVzKCl7aWYodGhpcy5fbXVzdFdpcGVWZXJ0ZXhBdHRyaWJ1dGVzKXt0aGlzLl9tdXN0V2lwZVZlcnRleEF0dHJpYnV0ZXM9ITE7Zm9yKGxldCBlPTA7ZTx0aGlzLl9jYXBzLm1heFZlcnRleEF0dHJpYnM7ZSsrKXRoaXMuZGlzYWJsZUF0dHJpYnV0ZUJ5SW5kZXgoZSk7cmV0dXJufWZvcihsZXQgZT0wLHQ9dGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZC5sZW5ndGg7ZTx0O2UrKyllPj10aGlzLl9jYXBzLm1heFZlcnRleEF0dHJpYnN8fCF0aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNFbmFibGVkW2VdfHx0aGlzLmRpc2FibGVBdHRyaWJ1dGVCeUluZGV4KGUpfXJlbGVhc2VFZmZlY3RzKCl7Zm9yKGNvbnN0IGUgaW4gdGhpcy5fY29tcGlsZWRFZmZlY3RzKXtjb25zdCB0PXRoaXMuX2NvbXBpbGVkRWZmZWN0c1tlXS5nZXRQaXBlbGluZUNvbnRleHQoKTt0aGlzLl9kZWxldGVQaXBlbGluZUNvbnRleHQodCl9dGhpcy5fY29tcGlsZWRFZmZlY3RzPXt9fWRpc3Bvc2UoKXt2YXIgZTt0aGlzLnN0b3BSZW5kZXJMb29wKCksdGhpcy5vbkJlZm9yZVRleHR1cmVJbml0T2JzZXJ2YWJsZSYmdGhpcy5vbkJlZm9yZVRleHR1cmVJbml0T2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX2VtcHR5VGV4dHVyZSYmKHRoaXMuX3JlbGVhc2VUZXh0dXJlKHRoaXMuX2VtcHR5VGV4dHVyZSksdGhpcy5fZW1wdHlUZXh0dXJlPW51bGwpLHRoaXMuX2VtcHR5Q3ViZVRleHR1cmUmJih0aGlzLl9yZWxlYXNlVGV4dHVyZSh0aGlzLl9lbXB0eUN1YmVUZXh0dXJlKSx0aGlzLl9lbXB0eUN1YmVUZXh0dXJlPW51bGwpLHRoaXMuX2R1bW15RnJhbWVidWZmZXImJnRoaXMuX2dsLmRlbGV0ZUZyYW1lYnVmZmVyKHRoaXMuX2R1bW15RnJhbWVidWZmZXIpLHRoaXMucmVsZWFzZUVmZmVjdHMoKSwoZT10aGlzLnJlbGVhc2VDb21wdXRlRWZmZWN0cyk9PT1udWxsfHxlPT09dm9pZCAwfHxlLmNhbGwodGhpcyksdGhpcy51bmJpbmRBbGxBdHRyaWJ1dGVzKCksdGhpcy5fYm91bmRVbmlmb3Jtcz17fSxqZSgpJiZ0aGlzLl9yZW5kZXJpbmdDYW52YXMmJih0aGlzLl9kb05vdEhhbmRsZUNvbnRleHRMb3N0fHwodGhpcy5fcmVuZGVyaW5nQ2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoIndlYmdsY29udGV4dGxvc3QiLHRoaXMuX29uQ29udGV4dExvc3QpLHRoaXMuX3JlbmRlcmluZ0NhbnZhcy5yZW1vdmVFdmVudExpc3RlbmVyKCJ3ZWJnbGNvbnRleHRyZXN0b3JlZCIsdGhpcy5fb25Db250ZXh0UmVzdG9yZWQpKSx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicmVzaXplIix0aGlzLl9jaGVja0Zvck1vYmlsZSkpLHRoaXMuX3dvcmtpbmdDYW52YXM9bnVsbCx0aGlzLl93b3JraW5nQ29udGV4dD1udWxsLHRoaXMuX2N1cnJlbnRCdWZmZXJQb2ludGVycy5sZW5ndGg9MCx0aGlzLl9yZW5kZXJpbmdDYW52YXM9bnVsbCx0aGlzLl9jdXJyZW50UHJvZ3JhbT1udWxsLHRoaXMuX2JvdW5kUmVuZGVyRnVuY3Rpb249bnVsbCxQZS5SZXNldENhY2hlKCk7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fYWN0aXZlUmVxdWVzdHMpdC5hYm9ydCgpO3RoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLmNsZWFyKCl9YXR0YWNoQ29udGV4dExvc3RFdmVudChlKXt0aGlzLl9yZW5kZXJpbmdDYW52YXMmJnRoaXMuX3JlbmRlcmluZ0NhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJ3ZWJnbGNvbnRleHRsb3N0IixlLCExKX1hdHRhY2hDb250ZXh0UmVzdG9yZWRFdmVudChlKXt0aGlzLl9yZW5kZXJpbmdDYW52YXMmJnRoaXMuX3JlbmRlcmluZ0NhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJ3ZWJnbGNvbnRleHRyZXN0b3JlZCIsZSwhMSl9Z2V0RXJyb3IoKXtyZXR1cm4gdGhpcy5fZ2wuZ2V0RXJyb3IoKX1fY2FuUmVuZGVyVG9GbG9hdEZyYW1lYnVmZmVyKCl7cmV0dXJuIHRoaXMuX3dlYkdMVmVyc2lvbj4xP3RoaXMuX2NhcHMuY29sb3JCdWZmZXJGbG9hdDp0aGlzLl9jYW5SZW5kZXJUb0ZyYW1lYnVmZmVyKDEpfV9jYW5SZW5kZXJUb0hhbGZGbG9hdEZyYW1lYnVmZmVyKCl7cmV0dXJuIHRoaXMuX3dlYkdMVmVyc2lvbj4xP3RoaXMuX2NhcHMuY29sb3JCdWZmZXJGbG9hdDp0aGlzLl9jYW5SZW5kZXJUb0ZyYW1lYnVmZmVyKDIpfV9jYW5SZW5kZXJUb0ZyYW1lYnVmZmVyKGUpe2NvbnN0IHQ9dGhpcy5fZ2w7Zm9yKDt0LmdldEVycm9yKCkhPT10Lk5PX0VSUk9SOyk7bGV0IGk9ITA7Y29uc3Qgcz10LmNyZWF0ZVRleHR1cmUoKTt0LmJpbmRUZXh0dXJlKHQuVEVYVFVSRV8yRCxzKSx0LnRleEltYWdlMkQodC5URVhUVVJFXzJELDAsdGhpcy5fZ2V0UkdCQUJ1ZmZlckludGVybmFsU2l6ZWRGb3JtYXQoZSksMSwxLDAsdC5SR0JBLHRoaXMuX2dldFdlYkdMVGV4dHVyZVR5cGUoZSksbnVsbCksdC50ZXhQYXJhbWV0ZXJpKHQuVEVYVFVSRV8yRCx0LlRFWFRVUkVfTUlOX0ZJTFRFUix0Lk5FQVJFU1QpLHQudGV4UGFyYW1ldGVyaSh0LlRFWFRVUkVfMkQsdC5URVhUVVJFX01BR19GSUxURVIsdC5ORUFSRVNUKTtjb25zdCByPXQuY3JlYXRlRnJhbWVidWZmZXIoKTt0LmJpbmRGcmFtZWJ1ZmZlcih0LkZSQU1FQlVGRkVSLHIpLHQuZnJhbWVidWZmZXJUZXh0dXJlMkQodC5GUkFNRUJVRkZFUix0LkNPTE9SX0FUVEFDSE1FTlQwLHQuVEVYVFVSRV8yRCxzLDApO2NvbnN0IG49dC5jaGVja0ZyYW1lYnVmZmVyU3RhdHVzKHQuRlJBTUVCVUZGRVIpO2lmKGk9aSYmbj09PXQuRlJBTUVCVUZGRVJfQ09NUExFVEUsaT1pJiZ0LmdldEVycm9yKCk9PT10Lk5PX0VSUk9SLGkmJih0LmNsZWFyKHQuQ09MT1JfQlVGRkVSX0JJVCksaT1pJiZ0LmdldEVycm9yKCk9PT10Lk5PX0VSUk9SKSxpKXt0LmJpbmRGcmFtZWJ1ZmZlcih0LkZSQU1FQlVGRkVSLG51bGwpO2NvbnN0IGE9dC5SR0JBLG89dC5VTlNJR05FRF9CWVRFLGg9bmV3IFVpbnQ4QXJyYXkoNCk7dC5yZWFkUGl4ZWxzKDAsMCwxLDEsYSxvLGgpLGk9aSYmdC5nZXRFcnJvcigpPT09dC5OT19FUlJPUn1mb3IodC5kZWxldGVUZXh0dXJlKHMpLHQuZGVsZXRlRnJhbWVidWZmZXIociksdC5iaW5kRnJhbWVidWZmZXIodC5GUkFNRUJVRkZFUixudWxsKTshaSYmdC5nZXRFcnJvcigpIT09dC5OT19FUlJPUjspO3JldHVybiBpfV9nZXRXZWJHTFRleHR1cmVUeXBlKGUpe2lmKHRoaXMuX3dlYkdMVmVyc2lvbj09PTEpe3N3aXRjaChlKXtjYXNlIDE6cmV0dXJuIHRoaXMuX2dsLkZMT0FUO2Nhc2UgMjpyZXR1cm4gdGhpcy5fZ2wuSEFMRl9GTE9BVF9PRVM7Y2FzZSAwOnJldHVybiB0aGlzLl9nbC5VTlNJR05FRF9CWVRFO2Nhc2UgODpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfU0hPUlRfNF80XzRfNDtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX1NIT1JUXzVfNV81XzE7Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfU0hPUlRfNV82XzV9cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX0JZVEV9c3dpdGNoKGUpe2Nhc2UgMzpyZXR1cm4gdGhpcy5fZ2wuQllURTtjYXNlIDA6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX0JZVEU7Y2FzZSA0OnJldHVybiB0aGlzLl9nbC5TSE9SVDtjYXNlIDU6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX1NIT1JUO2Nhc2UgNjpyZXR1cm4gdGhpcy5fZ2wuSU5UO2Nhc2UgNzpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfSU5UO2Nhc2UgMTpyZXR1cm4gdGhpcy5fZ2wuRkxPQVQ7Y2FzZSAyOnJldHVybiB0aGlzLl9nbC5IQUxGX0ZMT0FUO2Nhc2UgODpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfU0hPUlRfNF80XzRfNDtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX1NIT1JUXzVfNV81XzE7Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfU0hPUlRfNV82XzU7Y2FzZSAxMTpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfSU5UXzJfMTBfMTBfMTBfUkVWO2Nhc2UgMTI6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX0lOVF8yNF84O2Nhc2UgMTM6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX0lOVF8xMEZfMTFGXzExRl9SRVY7Y2FzZSAxNDpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfSU5UXzVfOV85XzlfUkVWO2Nhc2UgMTU6cmV0dXJuIHRoaXMuX2dsLkZMT0FUXzMyX1VOU0lHTkVEX0lOVF8yNF84X1JFVn1yZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfQllURX1fZ2V0SW50ZXJuYWxGb3JtYXQoZSx0PSExKXtsZXQgaT10P3RoaXMuX2dsLlNSR0I4X0FMUEhBODp0aGlzLl9nbC5SR0JBO3N3aXRjaChlKXtjYXNlIDA6aT10aGlzLl9nbC5BTFBIQTticmVhaztjYXNlIDE6aT10aGlzLl9nbC5MVU1JTkFOQ0U7YnJlYWs7Y2FzZSAyOmk9dGhpcy5fZ2wuTFVNSU5BTkNFX0FMUEhBO2JyZWFrO2Nhc2UgNjppPXRoaXMuX2dsLlJFRDticmVhaztjYXNlIDc6aT10aGlzLl9nbC5SRzticmVhaztjYXNlIDQ6aT10P3RoaXMuX2dsLlNSR0I6dGhpcy5fZ2wuUkdCO2JyZWFrO2Nhc2UgNTppPXQ/dGhpcy5fZ2wuU1JHQjhfQUxQSEE4OnRoaXMuX2dsLlJHQkE7YnJlYWt9aWYodGhpcy5fd2ViR0xWZXJzaW9uPjEpc3dpdGNoKGUpe2Nhc2UgODppPXRoaXMuX2dsLlJFRF9JTlRFR0VSO2JyZWFrO2Nhc2UgOTppPXRoaXMuX2dsLlJHX0lOVEVHRVI7YnJlYWs7Y2FzZSAxMDppPXRoaXMuX2dsLlJHQl9JTlRFR0VSO2JyZWFrO2Nhc2UgMTE6aT10aGlzLl9nbC5SR0JBX0lOVEVHRVI7YnJlYWt9cmV0dXJuIGl9X2dldFJHQkFCdWZmZXJJbnRlcm5hbFNpemVkRm9ybWF0KGUsdCxpPSExKXtpZih0aGlzLl93ZWJHTFZlcnNpb249PT0xKXtpZih0IT09dm9pZCAwKXN3aXRjaCh0KXtjYXNlIDA6cmV0dXJuIHRoaXMuX2dsLkFMUEhBO2Nhc2UgMTpyZXR1cm4gdGhpcy5fZ2wuTFVNSU5BTkNFO2Nhc2UgMjpyZXR1cm4gdGhpcy5fZ2wuTFVNSU5BTkNFX0FMUEhBO2Nhc2UgNDpyZXR1cm4gaT90aGlzLl9nbC5TUkdCOnRoaXMuX2dsLlJHQn1yZXR1cm4gdGhpcy5fZ2wuUkdCQX1zd2l0Y2goZSl7Y2FzZSAzOnN3aXRjaCh0KXtjYXNlIDY6cmV0dXJuIHRoaXMuX2dsLlI4X1NOT1JNO2Nhc2UgNzpyZXR1cm4gdGhpcy5fZ2wuUkc4X1NOT1JNO2Nhc2UgNDpyZXR1cm4gdGhpcy5fZ2wuUkdCOF9TTk9STTtjYXNlIDg6cmV0dXJuIHRoaXMuX2dsLlI4STtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlJHOEk7Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuUkdCOEk7Y2FzZSAxMTpyZXR1cm4gdGhpcy5fZ2wuUkdCQThJO2RlZmF1bHQ6cmV0dXJuIHRoaXMuX2dsLlJHQkE4X1NOT1JNfWNhc2UgMDpzd2l0Y2godCl7Y2FzZSA2OnJldHVybiB0aGlzLl9nbC5SODtjYXNlIDc6cmV0dXJuIHRoaXMuX2dsLlJHODtjYXNlIDQ6cmV0dXJuIGk/dGhpcy5fZ2wuU1JHQjg6dGhpcy5fZ2wuUkdCODtjYXNlIDU6cmV0dXJuIGk/dGhpcy5fZ2wuU1JHQjhfQUxQSEE4OnRoaXMuX2dsLlJHQkE4O2Nhc2UgODpyZXR1cm4gdGhpcy5fZ2wuUjhVSTtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlJHOFVJO2Nhc2UgMTA6cmV0dXJuIHRoaXMuX2dsLlJHQjhVSTtjYXNlIDExOnJldHVybiB0aGlzLl9nbC5SR0JBOFVJO2Nhc2UgMDpyZXR1cm4gdGhpcy5fZ2wuQUxQSEE7Y2FzZSAxOnJldHVybiB0aGlzLl9nbC5MVU1JTkFOQ0U7Y2FzZSAyOnJldHVybiB0aGlzLl9nbC5MVU1JTkFOQ0VfQUxQSEE7ZGVmYXVsdDpyZXR1cm4gdGhpcy5fZ2wuUkdCQTh9Y2FzZSA0OnN3aXRjaCh0KXtjYXNlIDg6cmV0dXJuIHRoaXMuX2dsLlIxNkk7Y2FzZSA5OnJldHVybiB0aGlzLl9nbC5SRzE2STtjYXNlIDEwOnJldHVybiB0aGlzLl9nbC5SR0IxNkk7Y2FzZSAxMTpyZXR1cm4gdGhpcy5fZ2wuUkdCQTE2STtkZWZhdWx0OnJldHVybiB0aGlzLl9nbC5SR0JBMTZJfWNhc2UgNTpzd2l0Y2godCl7Y2FzZSA4OnJldHVybiB0aGlzLl9nbC5SMTZVSTtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlJHMTZVSTtjYXNlIDEwOnJldHVybiB0aGlzLl9nbC5SR0IxNlVJO2Nhc2UgMTE6cmV0dXJuIHRoaXMuX2dsLlJHQkExNlVJO2RlZmF1bHQ6cmV0dXJuIHRoaXMuX2dsLlJHQkExNlVJfWNhc2UgNjpzd2l0Y2godCl7Y2FzZSA4OnJldHVybiB0aGlzLl9nbC5SMzJJO2Nhc2UgOTpyZXR1cm4gdGhpcy5fZ2wuUkczMkk7Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuUkdCMzJJO2Nhc2UgMTE6cmV0dXJuIHRoaXMuX2dsLlJHQkEzMkk7ZGVmYXVsdDpyZXR1cm4gdGhpcy5fZ2wuUkdCQTMySX1jYXNlIDc6c3dpdGNoKHQpe2Nhc2UgODpyZXR1cm4gdGhpcy5fZ2wuUjMyVUk7Y2FzZSA5OnJldHVybiB0aGlzLl9nbC5SRzMyVUk7Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuUkdCMzJVSTtjYXNlIDExOnJldHVybiB0aGlzLl9nbC5SR0JBMzJVSTtkZWZhdWx0OnJldHVybiB0aGlzLl9nbC5SR0JBMzJVSX1jYXNlIDE6c3dpdGNoKHQpe2Nhc2UgNjpyZXR1cm4gdGhpcy5fZ2wuUjMyRjtjYXNlIDc6cmV0dXJuIHRoaXMuX2dsLlJHMzJGO2Nhc2UgNDpyZXR1cm4gdGhpcy5fZ2wuUkdCMzJGO2Nhc2UgNTpyZXR1cm4gdGhpcy5fZ2wuUkdCQTMyRjtkZWZhdWx0OnJldHVybiB0aGlzLl9nbC5SR0JBMzJGfWNhc2UgMjpzd2l0Y2godCl7Y2FzZSA2OnJldHVybiB0aGlzLl9nbC5SMTZGO2Nhc2UgNzpyZXR1cm4gdGhpcy5fZ2wuUkcxNkY7Y2FzZSA0OnJldHVybiB0aGlzLl9nbC5SR0IxNkY7Y2FzZSA1OnJldHVybiB0aGlzLl9nbC5SR0JBMTZGO2RlZmF1bHQ6cmV0dXJuIHRoaXMuX2dsLlJHQkExNkZ9Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuUkdCNTY1O2Nhc2UgMTM6cmV0dXJuIHRoaXMuX2dsLlIxMUZfRzExRl9CMTBGO2Nhc2UgMTQ6cmV0dXJuIHRoaXMuX2dsLlJHQjlfRTU7Y2FzZSA4OnJldHVybiB0aGlzLl9nbC5SR0JBNDtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlJHQjVfQTE7Y2FzZSAxMTpzd2l0Y2godCl7Y2FzZSA1OnJldHVybiB0aGlzLl9nbC5SR0IxMF9BMjtjYXNlIDExOnJldHVybiB0aGlzLl9nbC5SR0IxMF9BMlVJO2RlZmF1bHQ6cmV0dXJuIHRoaXMuX2dsLlJHQjEwX0EyfX1yZXR1cm4gaT90aGlzLl9nbC5TUkdCOF9BTFBIQTg6dGhpcy5fZ2wuUkdCQTh9X2dldFJHQkFNdWx0aVNhbXBsZUJ1ZmZlckZvcm1hdChlKXtyZXR1cm4gZT09PTE/dGhpcy5fZ2wuUkdCQTMyRjplPT09Mj90aGlzLl9nbC5SR0JBMTZGOnRoaXMuX2dsLlJHQkE4fV9sb2FkRmlsZShlLHQsaSxzLHIsbil7Y29uc3QgYT1vZS5fRmlsZVRvb2xzTG9hZEZpbGUoZSx0LGkscyxyLG4pO3JldHVybiB0aGlzLl9hY3RpdmVSZXF1ZXN0cy5wdXNoKGEpLGEub25Db21wbGV0ZU9ic2VydmFibGUuYWRkKG89Pnt0aGlzLl9hY3RpdmVSZXF1ZXN0cy5zcGxpY2UodGhpcy5fYWN0aXZlUmVxdWVzdHMuaW5kZXhPZihvKSwxKX0pLGF9c3RhdGljIF9GaWxlVG9vbHNMb2FkRmlsZShlLHQsaSxzLHIsbil7dGhyb3cgJCgiRmlsZVRvb2xzIil9cmVhZFBpeGVscyhlLHQsaSxzLHI9ITAsbj0hMCl7Y29uc3QgYT1yPzQ6MyxvPXI/dGhpcy5fZ2wuUkdCQTp0aGlzLl9nbC5SR0IsaD1uZXcgVWludDhBcnJheShzKmkqYSk7cmV0dXJuIG4mJnRoaXMuZmx1c2hGcmFtZWJ1ZmZlcigpLHRoaXMuX2dsLnJlYWRQaXhlbHMoZSx0LGkscyxvLHRoaXMuX2dsLlVOU0lHTkVEX0JZVEUsaCksUHJvbWlzZS5yZXNvbHZlKGgpfXN0YXRpYyBnZXQgSXNTdXBwb3J0ZWRBc3luYygpe3JldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5pc1N1cHBvcnRlZCgpKX1zdGF0aWMgZ2V0IElzU3VwcG9ydGVkKCl7cmV0dXJuIHRoaXMuaXNTdXBwb3J0ZWQoKX1zdGF0aWMgaXNTdXBwb3J0ZWQoKXtpZih0aGlzLl9IYXNNYWpvclBlcmZvcm1hbmNlQ2F2ZWF0IT09bnVsbClyZXR1cm4hdGhpcy5fSGFzTWFqb3JQZXJmb3JtYW5jZUNhdmVhdDtpZih0aGlzLl9Jc1N1cHBvcnRlZD09PW51bGwpdHJ5e2NvbnN0IGU9dGhpcy5fQ3JlYXRlQ2FudmFzKDEsMSksdD1lLmdldENvbnRleHQoIndlYmdsIil8fGUuZ2V0Q29udGV4dCgiZXhwZXJpbWVudGFsLXdlYmdsIik7dGhpcy5fSXNTdXBwb3J0ZWQ9dCE9bnVsbCYmISF3aW5kb3cuV2ViR0xSZW5kZXJpbmdDb250ZXh0fWNhdGNoe3RoaXMuX0lzU3VwcG9ydGVkPSExfXJldHVybiB0aGlzLl9Jc1N1cHBvcnRlZH1zdGF0aWMgZ2V0IEhhc01ham9yUGVyZm9ybWFuY2VDYXZlYXQoKXtpZih0aGlzLl9IYXNNYWpvclBlcmZvcm1hbmNlQ2F2ZWF0PT09bnVsbCl0cnl7Y29uc3QgZT10aGlzLl9DcmVhdGVDYW52YXMoMSwxKSx0PWUuZ2V0Q29udGV4dCgid2ViZ2wiLHtmYWlsSWZNYWpvclBlcmZvcm1hbmNlQ2F2ZWF0OiEwfSl8fGUuZ2V0Q29udGV4dCgiZXhwZXJpbWVudGFsLXdlYmdsIix7ZmFpbElmTWFqb3JQZXJmb3JtYW5jZUNhdmVhdDohMH0pO3RoaXMuX0hhc01ham9yUGVyZm9ybWFuY2VDYXZlYXQ9IXR9Y2F0Y2h7dGhpcy5fSGFzTWFqb3JQZXJmb3JtYW5jZUNhdmVhdD0hMX1yZXR1cm4gdGhpcy5fSGFzTWFqb3JQZXJmb3JtYW5jZUNhdmVhdH1zdGF0aWMgQ2VpbGluZ1BPVChlKXtyZXR1cm4gZS0tLGV8PWU+PjEsZXw9ZT4+MixlfD1lPj40LGV8PWU+PjgsZXw9ZT4+MTYsZSsrLGV9c3RhdGljIEZsb29yUE9UKGUpe3JldHVybiBlPWV8ZT4+MSxlPWV8ZT4+MixlPWV8ZT4+NCxlPWV8ZT4+OCxlPWV8ZT4+MTYsZS0oZT4+MSl9c3RhdGljIE5lYXJlc3RQT1QoZSl7Y29uc3QgdD1vZS5DZWlsaW5nUE9UKGUpLGk9b2UuRmxvb3JQT1QoZSk7cmV0dXJuIHQtZT5lLWk/aTp0fXN0YXRpYyBHZXRFeHBvbmVudE9mVHdvKGUsdCxpPTIpe2xldCBzO3N3aXRjaChpKXtjYXNlIDE6cz1vZS5GbG9vclBPVChlKTticmVhaztjYXNlIDI6cz1vZS5OZWFyZXN0UE9UKGUpO2JyZWFrO2Nhc2UgMzpkZWZhdWx0OnM9b2UuQ2VpbGluZ1BPVChlKTticmVha31yZXR1cm4gTWF0aC5taW4ocyx0KX1zdGF0aWMgUXVldWVOZXdGcmFtZShlLHQpe2lmKGplKCkpe2NvbnN0e3JlcXVlc3RQb3N0QW5pbWF0aW9uRnJhbWU6aSxyZXF1ZXN0QW5pbWF0aW9uRnJhbWU6c309dHx8d2luZG93O2lmKHR5cGVvZiBpPT0iZnVuY3Rpb24iKXJldHVybiBpKGUpO2lmKHR5cGVvZiBzPT0iZnVuY3Rpb24iKXJldHVybiBzKGUpfWVsc2UgaWYodHlwZW9mIHJlcXVlc3RBbmltYXRpb25GcmFtZT09ImZ1bmN0aW9uIilyZXR1cm4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGUpO3JldHVybiBzZXRUaW1lb3V0KGUsMTYpfWdldEhvc3REb2N1bWVudCgpe3JldHVybiB0aGlzLl9yZW5kZXJpbmdDYW52YXMmJnRoaXMuX3JlbmRlcmluZ0NhbnZhcy5vd25lckRvY3VtZW50P3RoaXMuX3JlbmRlcmluZ0NhbnZhcy5vd25lckRvY3VtZW50OkNpKCk/ZG9jdW1lbnQ6bnVsbH19b2UuRXhjZXB0aW9uTGlzdD1be2tleToiQ2hyb21lLzYzLjAiLGNhcHR1cmU6IjYzXFwuMFxcLjMyMzlcXC4oXFxkKykiLGNhcHR1cmVDb25zdHJhaW50OjEwOCx0YXJnZXRzOlsidW5pZm9ybUJ1ZmZlciJdfSx7a2V5OiJGaXJlZm94LzU4IixjYXB0dXJlOm51bGwsY2FwdHVyZUNvbnN0cmFpbnQ6bnVsbCx0YXJnZXRzOlsidW5pZm9ybUJ1ZmZlciJdfSx7a2V5OiJGaXJlZm94LzU5IixjYXB0dXJlOm51bGwsY2FwdHVyZUNvbnN0cmFpbnQ6bnVsbCx0YXJnZXRzOlsidW5pZm9ybUJ1ZmZlciJdfSx7a2V5OiJDaHJvbWUvNzIuKz9Nb2JpbGUiLGNhcHR1cmU6bnVsbCxjYXB0dXJlQ29uc3RyYWludDpudWxsLHRhcmdldHM6WyJ2YW8iXX0se2tleToiQ2hyb21lLzczLis/TW9iaWxlIixjYXB0dXJlOm51bGwsY2FwdHVyZUNvbnN0cmFpbnQ6bnVsbCx0YXJnZXRzOlsidmFvIl19LHtrZXk6IkNocm9tZS83NC4rP01vYmlsZSIsY2FwdHVyZTpudWxsLGNhcHR1cmVDb25zdHJhaW50Om51bGwsdGFyZ2V0czpbInZhbyJdfSx7a2V5OiJNYWMgT1MuK0Nocm9tZS83MSIsY2FwdHVyZTpudWxsLGNhcHR1cmVDb25zdHJhaW50Om51bGwsdGFyZ2V0czpbInZhbyJdfSx7a2V5OiJNYWMgT1MuK0Nocm9tZS83MiIsY2FwdHVyZTpudWxsLGNhcHR1cmVDb25zdHJhaW50Om51bGwsdGFyZ2V0czpbInZhbyJdfSx7a2V5OiJNYWMgT1MuK0Nocm9tZSIsY2FwdHVyZTpudWxsLGNhcHR1cmVDb25zdHJhaW50Om51bGwsdGFyZ2V0czpbInVuaWZvcm1CdWZmZXIiXX0se2tleToiLipBcHBsZVdlYktpdC4qKDE1LjQpLipTYWZhcmkiLGNhcHR1cmU6bnVsbCxjYXB0dXJlQ29uc3RyYWludDpudWxsLHRhcmdldHM6WyJhbnRpYWxpYXMiLCJtYXhNU0FBU2FtcGxlcyJdfSx7a2V5OiIuKigxNS40KS4qQXBwbGVXZWJLaXQuKlNhZmFyaSIsY2FwdHVyZTpudWxsLGNhcHR1cmVDb25zdHJhaW50Om51bGwsdGFyZ2V0czpbImFudGlhbGlhcyIsIm1heE1TQUFTYW1wbGVzIl19XSxvZS5fVGV4dHVyZUxvYWRlcnM9W10sb2UuQ29sbGlzaW9uc0Vwc2lsb249LjAwMSxvZS5fSXNTdXBwb3J0ZWQ9bnVsbCxvZS5fSGFzTWFqb3JQZXJmb3JtYW5jZUNhdmVhdD1udWxsO2NsYXNzIGRue2NvbnN0cnVjdG9yKGU9MzApe3RoaXMuX2VuYWJsZWQ9ITAsdGhpcy5fcm9sbGluZ0ZyYW1lVGltZT1uZXcgZm4oZSl9c2FtcGxlRnJhbWUoZT1haS5Ob3cpe2lmKHRoaXMuX2VuYWJsZWQpe2lmKHRoaXMuX2xhc3RGcmFtZVRpbWVNcyE9bnVsbCl7Y29uc3QgdD1lLXRoaXMuX2xhc3RGcmFtZVRpbWVNczt0aGlzLl9yb2xsaW5nRnJhbWVUaW1lLmFkZCh0KX10aGlzLl9sYXN0RnJhbWVUaW1lTXM9ZX19Z2V0IGF2ZXJhZ2VGcmFtZVRpbWUoKXtyZXR1cm4gdGhpcy5fcm9sbGluZ0ZyYW1lVGltZS5hdmVyYWdlfWdldCBhdmVyYWdlRnJhbWVUaW1lVmFyaWFuY2UoKXtyZXR1cm4gdGhpcy5fcm9sbGluZ0ZyYW1lVGltZS52YXJpYW5jZX1nZXQgaW5zdGFudGFuZW91c0ZyYW1lVGltZSgpe3JldHVybiB0aGlzLl9yb2xsaW5nRnJhbWVUaW1lLmhpc3RvcnkoMCl9Z2V0IGF2ZXJhZ2VGUFMoKXtyZXR1cm4gMWUzL3RoaXMuX3JvbGxpbmdGcmFtZVRpbWUuYXZlcmFnZX1nZXQgaW5zdGFudGFuZW91c0ZQUygpe2NvbnN0IGU9dGhpcy5fcm9sbGluZ0ZyYW1lVGltZS5oaXN0b3J5KDApO3JldHVybiBlPT09MD8wOjFlMy9lfWdldCBpc1NhdHVyYXRlZCgpe3JldHVybiB0aGlzLl9yb2xsaW5nRnJhbWVUaW1lLmlzU2F0dXJhdGVkKCl9ZW5hYmxlKCl7dGhpcy5fZW5hYmxlZD0hMH1kaXNhYmxlKCl7dGhpcy5fZW5hYmxlZD0hMSx0aGlzLl9sYXN0RnJhbWVUaW1lTXM9bnVsbH1nZXQgaXNFbmFibGVkKCl7cmV0dXJuIHRoaXMuX2VuYWJsZWR9cmVzZXQoKXt0aGlzLl9sYXN0RnJhbWVUaW1lTXM9bnVsbCx0aGlzLl9yb2xsaW5nRnJhbWVUaW1lLnJlc2V0KCl9fWNsYXNzIGZue2NvbnN0cnVjdG9yKGUpe3RoaXMuX3NhbXBsZXM9bmV3IEFycmF5KGUpLHRoaXMucmVzZXQoKX1hZGQoZSl7bGV0IHQ7aWYodGhpcy5pc1NhdHVyYXRlZCgpKXtjb25zdCBpPXRoaXMuX3NhbXBsZXNbdGhpcy5fcG9zXTt0PWktdGhpcy5hdmVyYWdlLHRoaXMuYXZlcmFnZS09dC8odGhpcy5fc2FtcGxlQ291bnQtMSksdGhpcy5fbTItPXQqKGktdGhpcy5hdmVyYWdlKX1lbHNlIHRoaXMuX3NhbXBsZUNvdW50Kys7dD1lLXRoaXMuYXZlcmFnZSx0aGlzLmF2ZXJhZ2UrPXQvdGhpcy5fc2FtcGxlQ291bnQsdGhpcy5fbTIrPXQqKGUtdGhpcy5hdmVyYWdlKSx0aGlzLnZhcmlhbmNlPXRoaXMuX20yLyh0aGlzLl9zYW1wbGVDb3VudC0xKSx0aGlzLl9zYW1wbGVzW3RoaXMuX3Bvc109ZSx0aGlzLl9wb3MrKyx0aGlzLl9wb3MlPXRoaXMuX3NhbXBsZXMubGVuZ3RofWhpc3RvcnkoZSl7aWYoZT49dGhpcy5fc2FtcGxlQ291bnR8fGU+PXRoaXMuX3NhbXBsZXMubGVuZ3RoKXJldHVybiAwO2NvbnN0IHQ9dGhpcy5fd3JhcFBvc2l0aW9uKHRoaXMuX3Bvcy0xKTtyZXR1cm4gdGhpcy5fc2FtcGxlc1t0aGlzLl93cmFwUG9zaXRpb24odC1lKV19aXNTYXR1cmF0ZWQoKXtyZXR1cm4gdGhpcy5fc2FtcGxlQ291bnQ+PXRoaXMuX3NhbXBsZXMubGVuZ3RofXJlc2V0KCl7dGhpcy5hdmVyYWdlPTAsdGhpcy52YXJpYW5jZT0wLHRoaXMuX3NhbXBsZUNvdW50PTAsdGhpcy5fcG9zPTAsdGhpcy5fbTI9MH1fd3JhcFBvc2l0aW9uKGUpe2NvbnN0IHQ9dGhpcy5fc2FtcGxlcy5sZW5ndGg7cmV0dXJuKGUldCt0KSV0fX1jbGFzcyBSdHtjb25zdHJ1Y3Rvcigpe3RoaXMuX3N0YXJ0TW9uaXRvcmluZ1RpbWU9MCx0aGlzLl9taW49MCx0aGlzLl9tYXg9MCx0aGlzLl9hdmVyYWdlPTAsdGhpcy5fbGFzdFNlY0F2ZXJhZ2U9MCx0aGlzLl9jdXJyZW50PTAsdGhpcy5fdG90YWxWYWx1ZUNvdW50PTAsdGhpcy5fdG90YWxBY2N1bXVsYXRlZD0wLHRoaXMuX2xhc3RTZWNBY2N1bXVsYXRlZD0wLHRoaXMuX2xhc3RTZWNUaW1lPTAsdGhpcy5fbGFzdFNlY1ZhbHVlQ291bnQ9MH1nZXQgbWluKCl7cmV0dXJuIHRoaXMuX21pbn1nZXQgbWF4KCl7cmV0dXJuIHRoaXMuX21heH1nZXQgYXZlcmFnZSgpe3JldHVybiB0aGlzLl9hdmVyYWdlfWdldCBsYXN0U2VjQXZlcmFnZSgpe3JldHVybiB0aGlzLl9sYXN0U2VjQXZlcmFnZX1nZXQgY3VycmVudCgpe3JldHVybiB0aGlzLl9jdXJyZW50fWdldCB0b3RhbCgpe3JldHVybiB0aGlzLl90b3RhbEFjY3VtdWxhdGVkfWdldCBjb3VudCgpe3JldHVybiB0aGlzLl90b3RhbFZhbHVlQ291bnR9ZmV0Y2hOZXdGcmFtZSgpe3RoaXMuX3RvdGFsVmFsdWVDb3VudCsrLHRoaXMuX2N1cnJlbnQ9MCx0aGlzLl9sYXN0U2VjVmFsdWVDb3VudCsrfWFkZENvdW50KGUsdCl7UnQuRW5hYmxlZCYmKHRoaXMuX2N1cnJlbnQrPWUsdCYmdGhpcy5fZmV0Y2hSZXN1bHQoKSl9YmVnaW5Nb25pdG9yaW5nKCl7UnQuRW5hYmxlZCYmKHRoaXMuX3N0YXJ0TW9uaXRvcmluZ1RpbWU9YWkuTm93KX1lbmRNb25pdG9yaW5nKGU9ITApe2lmKCFSdC5FbmFibGVkKXJldHVybjtlJiZ0aGlzLmZldGNoTmV3RnJhbWUoKTtjb25zdCB0PWFpLk5vdzt0aGlzLl9jdXJyZW50PXQtdGhpcy5fc3RhcnRNb25pdG9yaW5nVGltZSxlJiZ0aGlzLl9mZXRjaFJlc3VsdCgpfV9mZXRjaFJlc3VsdCgpe3RoaXMuX3RvdGFsQWNjdW11bGF0ZWQrPXRoaXMuX2N1cnJlbnQsdGhpcy5fbGFzdFNlY0FjY3VtdWxhdGVkKz10aGlzLl9jdXJyZW50LHRoaXMuX21pbj1NYXRoLm1pbih0aGlzLl9taW4sdGhpcy5fY3VycmVudCksdGhpcy5fbWF4PU1hdGgubWF4KHRoaXMuX21heCx0aGlzLl9jdXJyZW50KSx0aGlzLl9hdmVyYWdlPXRoaXMuX3RvdGFsQWNjdW11bGF0ZWQvdGhpcy5fdG90YWxWYWx1ZUNvdW50O2NvbnN0IGU9YWkuTm93O2UtdGhpcy5fbGFzdFNlY1RpbWU+MWUzJiYodGhpcy5fbGFzdFNlY0F2ZXJhZ2U9dGhpcy5fbGFzdFNlY0FjY3VtdWxhdGVkL3RoaXMuX2xhc3RTZWNWYWx1ZUNvdW50LHRoaXMuX2xhc3RTZWNUaW1lPWUsdGhpcy5fbGFzdFNlY0FjY3VtdWxhdGVkPTAsdGhpcy5fbGFzdFNlY1ZhbHVlQ291bnQ9MCl9fVJ0LkVuYWJsZWQ9ITAsb2UucHJvdG90eXBlLnNldEFscGhhQ29uc3RhbnRzPWZ1bmN0aW9uKGMsZSx0LGkpe3RoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZENvbnN0YW50cyhjLGUsdCxpKX0sb2UucHJvdG90eXBlLnNldEFscGhhTW9kZT1mdW5jdGlvbihjLGU9ITEpe2lmKHRoaXMuX2FscGhhTW9kZSE9PWMpe3N3aXRjaChjKXtjYXNlIDA6dGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSExO2JyZWFrO2Nhc2UgNzp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhQmxlbmRGdW5jdGlvblBhcmFtZXRlcnModGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQUxQSEEsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORSksdGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSEwO2JyZWFrO2Nhc2UgODp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhQmxlbmRGdW5jdGlvblBhcmFtZXRlcnModGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQUxQSEEsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQUxQSEEpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDI6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLlNSQ19BTFBIQSx0aGlzLl9nbC5PTkVfTUlOVVNfU1JDX0FMUEhBLHRoaXMuX2dsLk9ORSx0aGlzLl9nbC5PTkUpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDY6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLk9ORSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuWkVSTyx0aGlzLl9nbC5PTkUpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDE6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLlNSQ19BTFBIQSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuWkVSTyx0aGlzLl9nbC5PTkUpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDM6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLlpFUk8sdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19DT0xPUix0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FKSx0aGlzLl9hbHBoYVN0YXRlLmFscGhhQmxlbmQ9ITA7YnJlYWs7Y2FzZSA0OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5EU1RfQ09MT1IsdGhpcy5fZ2wuWkVSTyx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FKSx0aGlzLl9hbHBoYVN0YXRlLmFscGhhQmxlbmQ9ITA7YnJlYWs7Y2FzZSA1OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5TUkNfQUxQSEEsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19DT0xPUix0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FKSx0aGlzLl9hbHBoYVN0YXRlLmFscGhhQmxlbmQ9ITA7YnJlYWs7Y2FzZSA5OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5DT05TVEFOVF9DT0xPUix0aGlzLl9nbC5PTkVfTUlOVVNfQ09OU1RBTlRfQ09MT1IsdGhpcy5fZ2wuQ09OU1RBTlRfQUxQSEEsdGhpcy5fZ2wuT05FX01JTlVTX0NPTlNUQU5UX0FMUEhBKSx0aGlzLl9hbHBoYVN0YXRlLmFscGhhQmxlbmQ9ITA7YnJlYWs7Y2FzZSAxMDp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhQmxlbmRGdW5jdGlvblBhcmFtZXRlcnModGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQ09MT1IsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQUxQSEEpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDExOnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORSx0aGlzLl9nbC5PTkUpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDEyOnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5EU1RfQUxQSEEsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLlpFUk8sdGhpcy5fZ2wuWkVSTyksdGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSEwO2JyZWFrO2Nhc2UgMTM6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLk9ORV9NSU5VU19EU1RfQ09MT1IsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19DT0xPUix0aGlzLl9nbC5PTkVfTUlOVVNfRFNUX0FMUEhBLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQUxQSEEpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDE0OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19BTFBIQSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19BTFBIQSksdGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSEwO2JyZWFrO2Nhc2UgMTU6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLk9ORSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLlpFUk8pLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDE2OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5PTkVfTUlOVVNfRFNUX0NPTE9SLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQ09MT1IsdGhpcy5fZ2wuWkVSTyx0aGlzLl9nbC5PTkUpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDE3OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5TUkNfQUxQSEEsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19BTFBIQSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19BTFBIQSksdGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSEwO2JyZWFrfWV8fCh0aGlzLmRlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoTWFzaz1jPT09MCksdGhpcy5fYWxwaGFNb2RlPWN9fSxvZS5wcm90b3R5cGUuZ2V0QWxwaGFNb2RlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FscGhhTW9kZX0sb2UucHJvdG90eXBlLnNldEFscGhhRXF1YXRpb249ZnVuY3Rpb24oYyl7aWYodGhpcy5fYWxwaGFFcXVhdGlvbiE9PWMpe3N3aXRjaChjKXtjYXNlIDA6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUVxdWF0aW9uUGFyYW1ldGVycygzMjc3NCwzMjc3NCk7YnJlYWs7Y2FzZSAxOnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFFcXVhdGlvblBhcmFtZXRlcnMoMzI3NzgsMzI3NzgpO2JyZWFrO2Nhc2UgMjp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhRXF1YXRpb25QYXJhbWV0ZXJzKDMyNzc5LDMyNzc5KTticmVhaztjYXNlIDM6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUVxdWF0aW9uUGFyYW1ldGVycygzMjc3NiwzMjc3Nik7YnJlYWs7Y2FzZSA0OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFFcXVhdGlvblBhcmFtZXRlcnMoMzI3NzUsMzI3NzUpO2JyZWFrO2Nhc2UgNTp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhRXF1YXRpb25QYXJhbWV0ZXJzKDMyNzc1LDMyNzc0KTticmVha310aGlzLl9hbHBoYUVxdWF0aW9uPWN9fSxvZS5wcm90b3R5cGUuZ2V0QWxwaGFFcXVhdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9hbHBoYUVxdWF0aW9ufTtmdW5jdGlvbiBfbihjLGUsdD0hMSxpKXtzd2l0Y2goYyl7Y2FzZSAzOntjb25zdCByPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgSW50OEFycmF5KGUpOm5ldyBJbnQ4QXJyYXkoZSk7cmV0dXJuIGkmJnIuc2V0KG5ldyBJbnQ4QXJyYXkoaSkpLHJ9Y2FzZSAwOntjb25zdCByPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgVWludDhBcnJheShlKTpuZXcgVWludDhBcnJheShlKTtyZXR1cm4gaSYmci5zZXQobmV3IFVpbnQ4QXJyYXkoaSkpLHJ9Y2FzZSA0Ontjb25zdCByPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgSW50MTZBcnJheShlKTpuZXcgSW50MTZBcnJheSh0P2UvMjplKTtyZXR1cm4gaSYmci5zZXQobmV3IEludDE2QXJyYXkoaSkpLHJ9Y2FzZSA1OmNhc2UgODpjYXNlIDk6Y2FzZSAxMDpjYXNlIDI6e2NvbnN0IHI9ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyP25ldyBVaW50MTZBcnJheShlKTpuZXcgVWludDE2QXJyYXkodD9lLzI6ZSk7cmV0dXJuIGkmJnIuc2V0KG5ldyBVaW50MTZBcnJheShpKSkscn1jYXNlIDY6e2NvbnN0IHI9ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyP25ldyBJbnQzMkFycmF5KGUpOm5ldyBJbnQzMkFycmF5KHQ/ZS80OmUpO3JldHVybiBpJiZyLnNldChuZXcgSW50MzJBcnJheShpKSkscn1jYXNlIDc6Y2FzZSAxMTpjYXNlIDEyOmNhc2UgMTM6Y2FzZSAxNDpjYXNlIDE1Ontjb25zdCByPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgVWludDMyQXJyYXkoZSk6bmV3IFVpbnQzMkFycmF5KHQ/ZS80OmUpO3JldHVybiBpJiZyLnNldChuZXcgVWludDMyQXJyYXkoaSkpLHJ9Y2FzZSAxOntjb25zdCByPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgRmxvYXQzMkFycmF5KGUpOm5ldyBGbG9hdDMyQXJyYXkodD9lLzQ6ZSk7cmV0dXJuIGkmJnIuc2V0KG5ldyBGbG9hdDMyQXJyYXkoaSkpLHJ9fWNvbnN0IHM9ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyP25ldyBVaW50OEFycmF5KGUpOm5ldyBVaW50OEFycmF5KGUpO3JldHVybiBpJiZzLnNldChuZXcgVWludDhBcnJheShpKSksc31vZS5wcm90b3R5cGUuX3JlYWRUZXh0dXJlUGl4ZWxzU3luYz1mdW5jdGlvbihjLGUsdCxpPS0xLHM9MCxyPW51bGwsbj0hMCxhPSExLG89MCxoPTApe3ZhciBsLHU7Y29uc3QgZD10aGlzLl9nbDtpZighZCl0aHJvdyBuZXcgRXJyb3IoIkVuZ2luZSBkb2VzIG5vdCBoYXZlIGdsIHJlbmRlcmluZyBjb250ZXh0LiIpO2lmKCF0aGlzLl9kdW1teUZyYW1lYnVmZmVyKXtjb25zdCBfPWQuY3JlYXRlRnJhbWVidWZmZXIoKTtpZighXyl0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBjcmVhdGUgZHVtbXkgZnJhbWVidWZmZXIiKTt0aGlzLl9kdW1teUZyYW1lYnVmZmVyPV99ZC5iaW5kRnJhbWVidWZmZXIoZC5GUkFNRUJVRkZFUix0aGlzLl9kdW1teUZyYW1lYnVmZmVyKSxpPi0xP2QuZnJhbWVidWZmZXJUZXh0dXJlMkQoZC5GUkFNRUJVRkZFUixkLkNPTE9SX0FUVEFDSE1FTlQwLGQuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YK2ksKGw9Yy5faGFyZHdhcmVUZXh0dXJlKT09PW51bGx8fGw9PT12b2lkIDA/dm9pZCAwOmwudW5kZXJseWluZ1Jlc291cmNlLHMpOmQuZnJhbWVidWZmZXJUZXh0dXJlMkQoZC5GUkFNRUJVRkZFUixkLkNPTE9SX0FUVEFDSE1FTlQwLGQuVEVYVFVSRV8yRCwodT1jLl9oYXJkd2FyZVRleHR1cmUpPT09bnVsbHx8dT09PXZvaWQgMD92b2lkIDA6dS51bmRlcmx5aW5nUmVzb3VyY2Uscyk7bGV0IGY9Yy50eXBlIT09dm9pZCAwP3RoaXMuX2dldFdlYkdMVGV4dHVyZVR5cGUoYy50eXBlKTpkLlVOU0lHTkVEX0JZVEU7aWYoYSlyfHwocj1fbihjLnR5cGUsNCplKnQpKTtlbHNlIHN3aXRjaChmKXtjYXNlIGQuVU5TSUdORURfQllURTpyfHwocj1uZXcgVWludDhBcnJheSg0KmUqdCkpLGY9ZC5VTlNJR05FRF9CWVRFO2JyZWFrO2RlZmF1bHQ6cnx8KHI9bmV3IEZsb2F0MzJBcnJheSg0KmUqdCkpLGY9ZC5GTE9BVDticmVha31yZXR1cm4gbiYmdGhpcy5mbHVzaEZyYW1lYnVmZmVyKCksZC5yZWFkUGl4ZWxzKG8saCxlLHQsZC5SR0JBLGYsciksZC5iaW5kRnJhbWVidWZmZXIoZC5GUkFNRUJVRkZFUix0aGlzLl9jdXJyZW50RnJhbWVidWZmZXIpLHJ9LG9lLnByb3RvdHlwZS5fcmVhZFRleHR1cmVQaXhlbHM9ZnVuY3Rpb24oYyxlLHQsaT0tMSxzPTAscj1udWxsLG49ITAsYT0hMSxvPTAsaD0wKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX3JlYWRUZXh0dXJlUGl4ZWxzU3luYyhjLGUsdCxpLHMscixuLGEsbyxoKSl9LG9lLnByb3RvdHlwZS51cGRhdGVEeW5hbWljSW5kZXhCdWZmZXI9ZnVuY3Rpb24oYyxlLHQ9MCl7dGhpcy5fY3VycmVudEJvdW5kQnVmZmVyW3RoaXMuX2dsLkVMRU1FTlRfQVJSQVlfQlVGRkVSXT1udWxsLHRoaXMuYmluZEluZGV4QnVmZmVyKGMpO2xldCBpO2MuaXMzMkJpdHM/aT1lIGluc3RhbmNlb2YgVWludDMyQXJyYXk/ZTpuZXcgVWludDMyQXJyYXkoZSk6aT1lIGluc3RhbmNlb2YgVWludDE2QXJyYXk/ZTpuZXcgVWludDE2QXJyYXkoZSksdGhpcy5fZ2wuYnVmZmVyRGF0YSh0aGlzLl9nbC5FTEVNRU5UX0FSUkFZX0JVRkZFUixpLHRoaXMuX2dsLkRZTkFNSUNfRFJBVyksdGhpcy5fcmVzZXRJbmRleEJ1ZmZlckJpbmRpbmcoKX0sb2UucHJvdG90eXBlLnVwZGF0ZUR5bmFtaWNWZXJ0ZXhCdWZmZXI9ZnVuY3Rpb24oYyxlLHQsaSl7dGhpcy5iaW5kQXJyYXlCdWZmZXIoYyksdD09PXZvaWQgMCYmKHQ9MCk7Y29uc3Qgcz1lLmJ5dGVMZW5ndGh8fGUubGVuZ3RoO2k9PT12b2lkIDB8fGk+PXMmJnQ9PT0wP2UgaW5zdGFuY2VvZiBBcnJheT90aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUix0LG5ldyBGbG9hdDMyQXJyYXkoZSkpOnRoaXMuX2dsLmJ1ZmZlclN1YkRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLHQsZSk6ZSBpbnN0YW5jZW9mIEFycmF5P3RoaXMuX2dsLmJ1ZmZlclN1YkRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLDAsbmV3IEZsb2F0MzJBcnJheShlKS5zdWJhcnJheSh0LHQraSkpOihlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI/ZT1uZXcgVWludDhBcnJheShlLHQsaSk6ZT1uZXcgVWludDhBcnJheShlLmJ1ZmZlcixlLmJ5dGVPZmZzZXQrdCxpKSx0aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUiwwLGUpKSx0aGlzLl9yZXNldFZlcnRleEJ1ZmZlckJpbmRpbmcoKX07Y2xhc3MgSSBleHRlbmRzIG9le2NvbnN0cnVjdG9yKGUsdCxpLHM9ITEpe2lmKHN1cGVyKGUsdCxpLHMpLHRoaXMuZW5hYmxlT2ZmbGluZVN1cHBvcnQ9ITEsdGhpcy5kaXNhYmxlTWFuaWZlc3RDaGVjaz0hMSx0aGlzLmRpc2FibGVDb250ZXh0TWVudT0hMCx0aGlzLnNjZW5lcz1uZXcgQXJyYXksdGhpcy5fdmlydHVhbFNjZW5lcz1uZXcgQXJyYXksdGhpcy5vbk5ld1NjZW5lQWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMucG9zdFByb2Nlc3Nlcz1uZXcgQXJyYXksdGhpcy5pc1BvaW50ZXJMb2NrPSExLHRoaXMub25SZXNpemVPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25DYW52YXNCbHVyT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQ2FudmFzRm9jdXNPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25DYW52YXNQb2ludGVyT3V0T2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQmVnaW5GcmFtZU9ic2VydmFibGU9bmV3IEYsdGhpcy5jdXN0b21BbmltYXRpb25GcmFtZVJlcXVlc3Rlcj1udWxsLHRoaXMub25FbmRGcmFtZU9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkJlZm9yZVNoYWRlckNvbXBpbGF0aW9uT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQWZ0ZXJTaGFkZXJDb21waWxhdGlvbk9ic2VydmFibGU9bmV3IEYsdGhpcy5fZGV0ZXJtaW5pc3RpY0xvY2tzdGVwPSExLHRoaXMuX2xvY2tzdGVwTWF4U3RlcHM9NCx0aGlzLl90aW1lU3RlcD0xLzYwLHRoaXMuX2Zwcz02MCx0aGlzLl9kZWx0YVRpbWU9MCx0aGlzLl9kcmF3Q2FsbHM9bmV3IFJ0LHRoaXMuY2FudmFzVGFiSW5kZXg9MSx0aGlzLmRpc2FibGVQZXJmb3JtYW5jZU1vbml0b3JJbkJhY2tncm91bmQ9ITEsdGhpcy5fcGVyZm9ybWFuY2VNb25pdG9yPW5ldyBkbix0aGlzLl9jb21wYXRpYmlsaXR5TW9kZT0hMCx0aGlzLmN1cnJlbnRSZW5kZXJQYXNzSWQ9MCx0aGlzLl9yZW5kZXJQYXNzTmFtZXM9WyJtYWluIl0sSS5JbnN0YW5jZXMucHVzaCh0aGlzKSwhIWUpe2lmKHRoaXMuX2ZlYXR1cmVzLnN1cHBvcnRSZW5kZXJQYXNzZXM9ITAsaT10aGlzLl9jcmVhdGlvbk9wdGlvbnMsZS5nZXRDb250ZXh0KXtjb25zdCByPWU7dGhpcy5fc2hhcmVkSW5pdChyLCEhaS5kb05vdEhhbmRsZVRvdWNoQWN0aW9uLGkuYXVkaW9FbmdpbmUpLENpKCkmJih0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2U9KCk9Pnt0aGlzLmlzRnVsbHNjcmVlbj0hIWRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50LHRoaXMuaXNGdWxsc2NyZWVuJiZ0aGlzLl9wb2ludGVyTG9ja1JlcXVlc3RlZCYmciYmSS5fUmVxdWVzdFBvaW50ZXJsb2NrKHIpfSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJmdWxsc2NyZWVuY2hhbmdlIix0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UsITEpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIndlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UiLHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSwhMSksdGhpcy5fb25Qb2ludGVyTG9ja0NoYW5nZT0oKT0+e3RoaXMuaXNQb2ludGVyTG9jaz1kb2N1bWVudC5wb2ludGVyTG9ja0VsZW1lbnQ9PT1yfSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVybG9ja2NoYW5nZSIsdGhpcy5fb25Qb2ludGVyTG9ja0NoYW5nZSwhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigid2Via2l0cG9pbnRlcmxvY2tjaGFuZ2UiLHRoaXMuX29uUG9pbnRlckxvY2tDaGFuZ2UsITEpLCFJLmF1ZGlvRW5naW5lJiZpLmF1ZGlvRW5naW5lJiZJLkF1ZGlvRW5naW5lRmFjdG9yeSYmKEkuYXVkaW9FbmdpbmU9SS5BdWRpb0VuZ2luZUZhY3RvcnkodGhpcy5nZXRSZW5kZXJpbmdDYW52YXMoKSx0aGlzLmdldEF1ZGlvQ29udGV4dCgpLHRoaXMuZ2V0QXVkaW9EZXN0aW5hdGlvbigpKSkpLHRoaXMuX2Nvbm5lY3RWUkV2ZW50cygpLHRoaXMuZW5hYmxlT2ZmbGluZVN1cHBvcnQ9SS5PZmZsaW5lUHJvdmlkZXJGYWN0b3J5IT09dm9pZCAwLHRoaXMuX2RldGVybWluaXN0aWNMb2Nrc3RlcD0hIWkuZGV0ZXJtaW5pc3RpY0xvY2tzdGVwLHRoaXMuX2xvY2tzdGVwTWF4U3RlcHM9aS5sb2Nrc3RlcE1heFN0ZXBzfHwwLHRoaXMuX3RpbWVTdGVwPWkudGltZVN0ZXB8fDEvNjB9dGhpcy5fcHJlcGFyZVZSQ29tcG9uZW50KCksaS5hdXRvRW5hYmxlV2ViVlImJnRoaXMuaW5pdFdlYlZSKCl9fXN0YXRpYyBnZXQgTnBtUGFja2FnZSgpe3JldHVybiBvZS5OcG1QYWNrYWdlfXN0YXRpYyBnZXQgVmVyc2lvbigpe3JldHVybiBvZS5WZXJzaW9ufXN0YXRpYyBnZXQgSW5zdGFuY2VzKCl7cmV0dXJuIGZlLkluc3RhbmNlc31zdGF0aWMgZ2V0IExhc3RDcmVhdGVkRW5naW5lKCl7cmV0dXJuIGZlLkxhc3RDcmVhdGVkRW5naW5lfXN0YXRpYyBnZXQgTGFzdENyZWF0ZWRTY2VuZSgpe3JldHVybiBmZS5MYXN0Q3JlYXRlZFNjZW5lfV9jcmVhdGVJbWFnZUJpdG1hcEZyb21Tb3VyY2UoZSx0KXtyZXR1cm4gbmV3IFByb21pc2UoKHMscik9Pntjb25zdCBuPW5ldyBJbWFnZTtuLm9ubG9hZD0oKT0+e24uZGVjb2RlKCkudGhlbigoKT0+e3RoaXMuY3JlYXRlSW1hZ2VCaXRtYXAobix0KS50aGVuKGE9PntzKGEpfSl9KX0sbi5vbmVycm9yPSgpPT57cihgRXJyb3IgbG9hZGluZyBpbWFnZSAke24uc3JjfWApfSxuLnNyYz1lfSl9Y3JlYXRlSW1hZ2VCaXRtYXAoZSx0KXtyZXR1cm4gY3JlYXRlSW1hZ2VCaXRtYXAoZSx0KX1yZXNpemVJbWFnZUJpdG1hcChlLHQsaSl7Y29uc3Qgcj10aGlzLmNyZWF0ZUNhbnZhcyh0LGkpLmdldENvbnRleHQoIjJkIik7aWYoIXIpdGhyb3cgbmV3IEVycm9yKCJVbmFibGUgdG8gZ2V0IDJkIGNvbnRleHQgZm9yIHJlc2l6ZUltYWdlQml0bWFwIik7cmV0dXJuIHIuZHJhd0ltYWdlKGUsMCwwKSxyLmdldEltYWdlRGF0YSgwLDAsdCxpKS5kYXRhfXN0YXRpYyBNYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eShlLHQpe2ZvcihsZXQgaT0wO2k8SS5JbnN0YW5jZXMubGVuZ3RoO2krKyl7Y29uc3Qgcz1JLkluc3RhbmNlc1tpXTtmb3IobGV0IHI9MDtyPHMuc2NlbmVzLmxlbmd0aDtyKyspcy5zY2VuZXNbcl0ubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoZSx0KX19c3RhdGljIERlZmF1bHRMb2FkaW5nU2NyZWVuRmFjdG9yeShlKXt0aHJvdyAkKCJMb2FkaW5nU2NyZWVuIil9Z2V0IF9zdXBwb3J0c0hhcmR3YXJlVGV4dHVyZVJlc2NhbGluZygpe3JldHVybiEhSS5fUmVzY2FsZVBvc3RQcm9jZXNzRmFjdG9yeX1nZXQgcGVyZm9ybWFuY2VNb25pdG9yKCl7cmV0dXJuIHRoaXMuX3BlcmZvcm1hbmNlTW9uaXRvcn1nZXQgY29tcGF0aWJpbGl0eU1vZGUoKXtyZXR1cm4gdGhpcy5fY29tcGF0aWJpbGl0eU1vZGV9c2V0IGNvbXBhdGliaWxpdHlNb2RlKGUpe3RoaXMuX2NvbXBhdGliaWxpdHlNb2RlPSEwfWdldElucHV0RWxlbWVudCgpe3JldHVybiB0aGlzLl9yZW5kZXJpbmdDYW52YXN9X2luaXRHTENvbnRleHQoKXtzdXBlci5faW5pdEdMQ29udGV4dCgpLHRoaXMuX3Jlc2NhbGVQb3N0UHJvY2Vzcz1udWxsfV9zaGFyZWRJbml0KGUsdCxpKXtzdXBlci5fc2hhcmVkSW5pdChlLHQsaSksdGhpcy5fb25DYW52YXNGb2N1cz0oKT0+e3RoaXMub25DYW52YXNGb2N1c09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpfSx0aGlzLl9vbkNhbnZhc0JsdXI9KCk9Pnt0aGlzLm9uQ2FudmFzQmx1ck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpfSx0aGlzLl9vbkNhbnZhc0NvbnRleHRNZW51PXI9Pnt0aGlzLmRpc2FibGVDb250ZXh0TWVudSYmci5wcmV2ZW50RGVmYXVsdCgpfSxlLmFkZEV2ZW50TGlzdGVuZXIoImZvY3VzIix0aGlzLl9vbkNhbnZhc0ZvY3VzKSxlLmFkZEV2ZW50TGlzdGVuZXIoImJsdXIiLHRoaXMuX29uQ2FudmFzQmx1ciksZS5hZGRFdmVudExpc3RlbmVyKCJjb250ZXh0bWVudSIsdGhpcy5fb25DYW52YXNDb250ZXh0TWVudSksdGhpcy5fb25CbHVyPSgpPT57dGhpcy5kaXNhYmxlUGVyZm9ybWFuY2VNb25pdG9ySW5CYWNrZ3JvdW5kJiZ0aGlzLl9wZXJmb3JtYW5jZU1vbml0b3IuZGlzYWJsZSgpLHRoaXMuX3dpbmRvd0lzQmFja2dyb3VuZD0hMH0sdGhpcy5fb25Gb2N1cz0oKT0+e3RoaXMuZGlzYWJsZVBlcmZvcm1hbmNlTW9uaXRvckluQmFja2dyb3VuZCYmdGhpcy5fcGVyZm9ybWFuY2VNb25pdG9yLmVuYWJsZSgpLHRoaXMuX3dpbmRvd0lzQmFja2dyb3VuZD0hMX0sdGhpcy5fb25DYW52YXNQb2ludGVyT3V0PXI9Pntkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHIuY2xpZW50WCxyLmNsaWVudFkpIT09ZSYmdGhpcy5vbkNhbnZhc1BvaW50ZXJPdXRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhyKX07Y29uc3Qgcz10aGlzLmdldEhvc3RXaW5kb3coKTtzJiZ0eXBlb2Ygcy5hZGRFdmVudExpc3RlbmVyPT0iZnVuY3Rpb24iJiYocy5hZGRFdmVudExpc3RlbmVyKCJibHVyIix0aGlzLl9vbkJsdXIpLHMuYWRkRXZlbnRMaXN0ZW5lcigiZm9jdXMiLHRoaXMuX29uRm9jdXMpKSxlLmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJvdXQiLHRoaXMuX29uQ2FudmFzUG9pbnRlck91dCksdHx8dGhpcy5fZGlzYWJsZVRvdWNoQWN0aW9uKCksIUkuYXVkaW9FbmdpbmUmJmkmJkkuQXVkaW9FbmdpbmVGYWN0b3J5JiYoSS5hdWRpb0VuZ2luZT1JLkF1ZGlvRW5naW5lRmFjdG9yeSh0aGlzLmdldFJlbmRlcmluZ0NhbnZhcygpLHRoaXMuZ2V0QXVkaW9Db250ZXh0KCksdGhpcy5nZXRBdWRpb0Rlc3RpbmF0aW9uKCkpKX1nZXRBc3BlY3RSYXRpbyhlLHQ9ITEpe2NvbnN0IGk9ZS52aWV3cG9ydDtyZXR1cm4gdGhpcy5nZXRSZW5kZXJXaWR0aCh0KSppLndpZHRoLyh0aGlzLmdldFJlbmRlckhlaWdodCh0KSppLmhlaWdodCl9Z2V0U2NyZWVuQXNwZWN0UmF0aW8oKXtyZXR1cm4gdGhpcy5nZXRSZW5kZXJXaWR0aCghMCkvdGhpcy5nZXRSZW5kZXJIZWlnaHQoITApfWdldFJlbmRlcmluZ0NhbnZhc0NsaWVudFJlY3QoKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nQ2FudmFzP3RoaXMuX3JlbmRlcmluZ0NhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTpudWxsfWdldElucHV0RWxlbWVudENsaWVudFJlY3QoKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nQ2FudmFzP3RoaXMuZ2V0SW5wdXRFbGVtZW50KCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk6bnVsbH1pc0RldGVybWluaXN0aWNMb2NrU3RlcCgpe3JldHVybiB0aGlzLl9kZXRlcm1pbmlzdGljTG9ja3N0ZXB9Z2V0TG9ja3N0ZXBNYXhTdGVwcygpe3JldHVybiB0aGlzLl9sb2Nrc3RlcE1heFN0ZXBzfWdldFRpbWVTdGVwKCl7cmV0dXJuIHRoaXMuX3RpbWVTdGVwKjFlM31nZW5lcmF0ZU1pcE1hcHNGb3JDdWJlbWFwKGUsdD0hMCl7aWYoZS5nZW5lcmF0ZU1pcE1hcHMpe2NvbnN0IGk9dGhpcy5fZ2w7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShpLlRFWFRVUkVfQ1VCRV9NQVAsZSwhMCksaS5nZW5lcmF0ZU1pcG1hcChpLlRFWFRVUkVfQ1VCRV9NQVApLHQmJnRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkoaS5URVhUVVJFX0NVQkVfTUFQLG51bGwpfX1nZXREZXB0aFdyaXRlKCl7cmV0dXJuIHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoTWFza31zZXREZXB0aFdyaXRlKGUpe3RoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoTWFzaz1lfWdldFN0ZW5jaWxCdWZmZXIoKXtyZXR1cm4gdGhpcy5fc3RlbmNpbFN0YXRlLnN0ZW5jaWxUZXN0fXNldFN0ZW5jaWxCdWZmZXIoZSl7dGhpcy5fc3RlbmNpbFN0YXRlLnN0ZW5jaWxUZXN0PWV9Z2V0U3RlbmNpbE1hc2soKXtyZXR1cm4gdGhpcy5fc3RlbmNpbFN0YXRlLnN0ZW5jaWxNYXNrfXNldFN0ZW5jaWxNYXNrKGUpe3RoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsTWFzaz1lfWdldFN0ZW5jaWxGdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdGVuY2lsU3RhdGUuc3RlbmNpbEZ1bmN9Z2V0U3RlbmNpbEZ1bmN0aW9uUmVmZXJlbmNlKCl7cmV0dXJuIHRoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsRnVuY1JlZn1nZXRTdGVuY2lsRnVuY3Rpb25NYXNrKCl7cmV0dXJuIHRoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsRnVuY01hc2t9c2V0U3RlbmNpbEZ1bmN0aW9uKGUpe3RoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsRnVuYz1lfXNldFN0ZW5jaWxGdW5jdGlvblJlZmVyZW5jZShlKXt0aGlzLl9zdGVuY2lsU3RhdGUuc3RlbmNpbEZ1bmNSZWY9ZX1zZXRTdGVuY2lsRnVuY3Rpb25NYXNrKGUpe3RoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsRnVuY01hc2s9ZX1nZXRTdGVuY2lsT3BlcmF0aW9uRmFpbCgpe3JldHVybiB0aGlzLl9zdGVuY2lsU3RhdGUuc3RlbmNpbE9wU3RlbmNpbEZhaWx9Z2V0U3RlbmNpbE9wZXJhdGlvbkRlcHRoRmFpbCgpe3JldHVybiB0aGlzLl9zdGVuY2lsU3RhdGUuc3RlbmNpbE9wRGVwdGhGYWlsfWdldFN0ZW5jaWxPcGVyYXRpb25QYXNzKCl7cmV0dXJuIHRoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsT3BTdGVuY2lsRGVwdGhQYXNzfXNldFN0ZW5jaWxPcGVyYXRpb25GYWlsKGUpe3RoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsT3BTdGVuY2lsRmFpbD1lfXNldFN0ZW5jaWxPcGVyYXRpb25EZXB0aEZhaWwoZSl7dGhpcy5fc3RlbmNpbFN0YXRlLnN0ZW5jaWxPcERlcHRoRmFpbD1lfXNldFN0ZW5jaWxPcGVyYXRpb25QYXNzKGUpe3RoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsT3BTdGVuY2lsRGVwdGhQYXNzPWV9c2V0RGl0aGVyaW5nU3RhdGUoZSl7ZT90aGlzLl9nbC5lbmFibGUodGhpcy5fZ2wuRElUSEVSKTp0aGlzLl9nbC5kaXNhYmxlKHRoaXMuX2dsLkRJVEhFUil9c2V0UmFzdGVyaXplclN0YXRlKGUpe2U/dGhpcy5fZ2wuZGlzYWJsZSh0aGlzLl9nbC5SQVNURVJJWkVSX0RJU0NBUkQpOnRoaXMuX2dsLmVuYWJsZSh0aGlzLl9nbC5SQVNURVJJWkVSX0RJU0NBUkQpfWdldERlcHRoRnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhGdW5jfXNldERlcHRoRnVuY3Rpb24oZSl7dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhGdW5jPWV9c2V0RGVwdGhGdW5jdGlvblRvR3JlYXRlcigpe3RoaXMuc2V0RGVwdGhGdW5jdGlvbig1MTYpfXNldERlcHRoRnVuY3Rpb25Ub0dyZWF0ZXJPckVxdWFsKCl7dGhpcy5zZXREZXB0aEZ1bmN0aW9uKDUxOCl9c2V0RGVwdGhGdW5jdGlvblRvTGVzcygpe3RoaXMuc2V0RGVwdGhGdW5jdGlvbig1MTMpfXNldERlcHRoRnVuY3Rpb25Ub0xlc3NPckVxdWFsKCl7dGhpcy5zZXREZXB0aEZ1bmN0aW9uKDUxNSl9Y2FjaGVTdGVuY2lsU3RhdGUoKXt0aGlzLl9jYWNoZWRTdGVuY2lsQnVmZmVyPXRoaXMuZ2V0U3RlbmNpbEJ1ZmZlcigpLHRoaXMuX2NhY2hlZFN0ZW5jaWxGdW5jdGlvbj10aGlzLmdldFN0ZW5jaWxGdW5jdGlvbigpLHRoaXMuX2NhY2hlZFN0ZW5jaWxNYXNrPXRoaXMuZ2V0U3RlbmNpbE1hc2soKSx0aGlzLl9jYWNoZWRTdGVuY2lsT3BlcmF0aW9uUGFzcz10aGlzLmdldFN0ZW5jaWxPcGVyYXRpb25QYXNzKCksdGhpcy5fY2FjaGVkU3RlbmNpbE9wZXJhdGlvbkZhaWw9dGhpcy5nZXRTdGVuY2lsT3BlcmF0aW9uRmFpbCgpLHRoaXMuX2NhY2hlZFN0ZW5jaWxPcGVyYXRpb25EZXB0aEZhaWw9dGhpcy5nZXRTdGVuY2lsT3BlcmF0aW9uRGVwdGhGYWlsKCksdGhpcy5fY2FjaGVkU3RlbmNpbFJlZmVyZW5jZT10aGlzLmdldFN0ZW5jaWxGdW5jdGlvblJlZmVyZW5jZSgpfXJlc3RvcmVTdGVuY2lsU3RhdGUoKXt0aGlzLnNldFN0ZW5jaWxGdW5jdGlvbih0aGlzLl9jYWNoZWRTdGVuY2lsRnVuY3Rpb24pLHRoaXMuc2V0U3RlbmNpbE1hc2sodGhpcy5fY2FjaGVkU3RlbmNpbE1hc2spLHRoaXMuc2V0U3RlbmNpbEJ1ZmZlcih0aGlzLl9jYWNoZWRTdGVuY2lsQnVmZmVyKSx0aGlzLnNldFN0ZW5jaWxPcGVyYXRpb25QYXNzKHRoaXMuX2NhY2hlZFN0ZW5jaWxPcGVyYXRpb25QYXNzKSx0aGlzLnNldFN0ZW5jaWxPcGVyYXRpb25GYWlsKHRoaXMuX2NhY2hlZFN0ZW5jaWxPcGVyYXRpb25GYWlsKSx0aGlzLnNldFN0ZW5jaWxPcGVyYXRpb25EZXB0aEZhaWwodGhpcy5fY2FjaGVkU3RlbmNpbE9wZXJhdGlvbkRlcHRoRmFpbCksdGhpcy5zZXRTdGVuY2lsRnVuY3Rpb25SZWZlcmVuY2UodGhpcy5fY2FjaGVkU3RlbmNpbFJlZmVyZW5jZSl9c2V0RGlyZWN0Vmlld3BvcnQoZSx0LGkscyl7Y29uc3Qgcj10aGlzLl9jYWNoZWRWaWV3cG9ydDtyZXR1cm4gdGhpcy5fY2FjaGVkVmlld3BvcnQ9bnVsbCx0aGlzLl92aWV3cG9ydChlLHQsaSxzKSxyfXNjaXNzb3JDbGVhcihlLHQsaSxzLHIpe3RoaXMuZW5hYmxlU2Npc3NvcihlLHQsaSxzKSx0aGlzLmNsZWFyKHIsITAsITAsITApLHRoaXMuZGlzYWJsZVNjaXNzb3IoKX1lbmFibGVTY2lzc29yKGUsdCxpLHMpe2NvbnN0IHI9dGhpcy5fZ2w7ci5lbmFibGUoci5TQ0lTU09SX1RFU1QpLHIuc2Npc3NvcihlLHQsaSxzKX1kaXNhYmxlU2Npc3Nvcigpe2NvbnN0IGU9dGhpcy5fZ2w7ZS5kaXNhYmxlKGUuU0NJU1NPUl9URVNUKX1fcmVwb3J0RHJhd0NhbGwoZT0xKXt0aGlzLl9kcmF3Q2FsbHMuYWRkQ291bnQoZSwhMSl9aW5pdFdlYlZSKCl7dGhyb3cgJCgiV2ViVlJDYW1lcmEiKX1fcHJlcGFyZVZSQ29tcG9uZW50KCl7fV9jb25uZWN0VlJFdmVudHMoZSx0KXt9X3N1Ym1pdFZSRnJhbWUoKXt9ZGlzYWJsZVZSKCl7fWlzVlJQcmVzZW50aW5nKCl7cmV0dXJuITF9X3JlcXVlc3RWUkZyYW1lKCl7fV9sb2FkRmlsZUFzeW5jKGUsdCxpKXtyZXR1cm4gbmV3IFByb21pc2UoKHMscik9Pnt0aGlzLl9sb2FkRmlsZShlLG49PntzKG4pfSx2b2lkIDAsdCxpLChuLGEpPT57cihhKX0pfSl9Z2V0VmVydGV4U2hhZGVyU291cmNlKGUpe2NvbnN0IHQ9dGhpcy5fZ2wuZ2V0QXR0YWNoZWRTaGFkZXJzKGUpO3JldHVybiB0P3RoaXMuX2dsLmdldFNoYWRlclNvdXJjZSh0WzBdKTpudWxsfWdldEZyYWdtZW50U2hhZGVyU291cmNlKGUpe2NvbnN0IHQ9dGhpcy5fZ2wuZ2V0QXR0YWNoZWRTaGFkZXJzKGUpO3JldHVybiB0P3RoaXMuX2dsLmdldFNoYWRlclNvdXJjZSh0WzFdKTpudWxsfXNldERlcHRoU3RlbmNpbFRleHR1cmUoZSx0LGkscyl7ZSE9PXZvaWQgMCYmKHQmJih0aGlzLl9ib3VuZFVuaWZvcm1zW2VdPXQpLCFpfHwhaS5kZXB0aFN0ZW5jaWxUZXh0dXJlP3RoaXMuX3NldFRleHR1cmUoZSxudWxsLHZvaWQgMCx2b2lkIDAscyk6dGhpcy5fc2V0VGV4dHVyZShlLGksITEsITAscykpfXNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3MoZSx0LGkpe3ZhciBzO2xldCByPW51bGw7dCYmKHQuX3RleHR1cmVzLmRhdGFbdC5fY3VycmVudFJlbmRlclRleHR1cmVJbmRdP3I9dC5fdGV4dHVyZXMuZGF0YVt0Ll9jdXJyZW50UmVuZGVyVGV4dHVyZUluZF06dC5fZm9yY2VkT3V0cHV0VGV4dHVyZSYmKHI9dC5fZm9yY2VkT3V0cHV0VGV4dHVyZSkpLHRoaXMuX2JpbmRUZXh0dXJlKGUsKHM9cj09bnVsbD92b2lkIDA6ci50ZXh0dXJlKSE9PW51bGwmJnMhPT12b2lkIDA/czpudWxsLGkpfXNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3NPdXRwdXQoZSx0LGkpe3ZhciBzLHI7dGhpcy5fYmluZFRleHR1cmUoZSwocj0ocz10PT1udWxsP3ZvaWQgMDp0Ll9vdXRwdXRUZXh0dXJlKT09PW51bGx8fHM9PT12b2lkIDA/dm9pZCAwOnMudGV4dHVyZSkhPT1udWxsJiZyIT09dm9pZCAwP3I6bnVsbCxpKX1fcmVidWlsZEJ1ZmZlcnMoKXtmb3IoY29uc3QgZSBvZiB0aGlzLnNjZW5lcyllLnJlc2V0Q2FjaGVkTWF0ZXJpYWwoKSxlLl9yZWJ1aWxkR2VvbWV0cmllcygpLGUuX3JlYnVpbGRUZXh0dXJlcygpO2Zvcihjb25zdCBlIG9mIHRoaXMuX3ZpcnR1YWxTY2VuZXMpZS5yZXNldENhY2hlZE1hdGVyaWFsKCksZS5fcmVidWlsZEdlb21ldHJpZXMoKSxlLl9yZWJ1aWxkVGV4dHVyZXMoKTtzdXBlci5fcmVidWlsZEJ1ZmZlcnMoKX1fcmVuZGVyRnJhbWUoKXtmb3IobGV0IGU9MDtlPHRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzLmxlbmd0aDtlKyspe2NvbnN0IHQ9dGhpcy5fYWN0aXZlUmVuZGVyTG9vcHNbZV07dCgpfX1fcmVuZGVyTG9vcCgpe2lmKCF0aGlzLl9jb250ZXh0V2FzTG9zdCl7bGV0IGU9ITA7IXRoaXMucmVuZGVyRXZlbkluQmFja2dyb3VuZCYmdGhpcy5fd2luZG93SXNCYWNrZ3JvdW5kJiYoZT0hMSksZSYmKHRoaXMuYmVnaW5GcmFtZSgpLHRoaXMuX3JlbmRlclZpZXdzKCl8fHRoaXMuX3JlbmRlckZyYW1lKCksdGhpcy5lbmRGcmFtZSgpKX10aGlzLl9hY3RpdmVSZW5kZXJMb29wcy5sZW5ndGg+MD90aGlzLmN1c3RvbUFuaW1hdGlvbkZyYW1lUmVxdWVzdGVyPyh0aGlzLmN1c3RvbUFuaW1hdGlvbkZyYW1lUmVxdWVzdGVyLnJlcXVlc3RJRD10aGlzLl9xdWV1ZU5ld0ZyYW1lKHRoaXMuY3VzdG9tQW5pbWF0aW9uRnJhbWVSZXF1ZXN0ZXIucmVuZGVyRnVuY3Rpb258fHRoaXMuX2JvdW5kUmVuZGVyRnVuY3Rpb24sdGhpcy5jdXN0b21BbmltYXRpb25GcmFtZVJlcXVlc3RlciksdGhpcy5fZnJhbWVIYW5kbGVyPXRoaXMuY3VzdG9tQW5pbWF0aW9uRnJhbWVSZXF1ZXN0ZXIucmVxdWVzdElEKTp0aGlzLmlzVlJQcmVzZW50aW5nKCk/dGhpcy5fcmVxdWVzdFZSRnJhbWUoKTp0aGlzLl9mcmFtZUhhbmRsZXI9dGhpcy5fcXVldWVOZXdGcmFtZSh0aGlzLl9ib3VuZFJlbmRlckZ1bmN0aW9uLHRoaXMuZ2V0SG9zdFdpbmRvdygpKTp0aGlzLl9yZW5kZXJpbmdRdWV1ZUxhdW5jaGVkPSExfV9yZW5kZXJWaWV3cygpe3JldHVybiExfXN3aXRjaEZ1bGxzY3JlZW4oZSl7dGhpcy5pc0Z1bGxzY3JlZW4/dGhpcy5leGl0RnVsbHNjcmVlbigpOnRoaXMuZW50ZXJGdWxsc2NyZWVuKGUpfWVudGVyRnVsbHNjcmVlbihlKXt0aGlzLmlzRnVsbHNjcmVlbnx8KHRoaXMuX3BvaW50ZXJMb2NrUmVxdWVzdGVkPWUsdGhpcy5fcmVuZGVyaW5nQ2FudmFzJiZJLl9SZXF1ZXN0RnVsbHNjcmVlbih0aGlzLl9yZW5kZXJpbmdDYW52YXMpKX1leGl0RnVsbHNjcmVlbigpe3RoaXMuaXNGdWxsc2NyZWVuJiZJLl9FeGl0RnVsbHNjcmVlbigpfWVudGVyUG9pbnRlcmxvY2soKXt0aGlzLl9yZW5kZXJpbmdDYW52YXMmJkkuX1JlcXVlc3RQb2ludGVybG9jayh0aGlzLl9yZW5kZXJpbmdDYW52YXMpfWV4aXRQb2ludGVybG9jaygpe0kuX0V4aXRQb2ludGVybG9jaygpfWJlZ2luRnJhbWUoKXt0aGlzLl9tZWFzdXJlRnBzKCksdGhpcy5vbkJlZ2luRnJhbWVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSxzdXBlci5iZWdpbkZyYW1lKCl9ZW5kRnJhbWUoKXtzdXBlci5lbmRGcmFtZSgpLHRoaXMuX3N1Ym1pdFZSRnJhbWUoKSx0aGlzLm9uRW5kRnJhbWVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1yZXNpemUoZT0hMSl7dGhpcy5pc1ZSUHJlc2VudGluZygpfHxzdXBlci5yZXNpemUoZSl9c2V0U2l6ZShlLHQsaT0hMSl7aWYoIXRoaXMuX3JlbmRlcmluZ0NhbnZhc3x8IXN1cGVyLnNldFNpemUoZSx0LGkpKXJldHVybiExO2lmKHRoaXMuc2NlbmVzKXtmb3IobGV0IHM9MDtzPHRoaXMuc2NlbmVzLmxlbmd0aDtzKyspe2NvbnN0IHI9dGhpcy5zY2VuZXNbc107Zm9yKGxldCBuPTA7bjxyLmNhbWVyYXMubGVuZ3RoO24rKyl7Y29uc3QgYT1yLmNhbWVyYXNbbl07YS5fY3VycmVudFJlbmRlcklkPTB9fXRoaXMub25SZXNpemVPYnNlcnZhYmxlLmhhc09ic2VydmVycygpJiZ0aGlzLm9uUmVzaXplT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyl9cmV0dXJuITB9X2RlbGV0ZVBpcGVsaW5lQ29udGV4dChlKXtjb25zdCB0PWU7dCYmdC5wcm9ncmFtJiZ0LnRyYW5zZm9ybUZlZWRiYWNrJiYodGhpcy5kZWxldGVUcmFuc2Zvcm1GZWVkYmFjayh0LnRyYW5zZm9ybUZlZWRiYWNrKSx0LnRyYW5zZm9ybUZlZWRiYWNrPW51bGwpLHN1cGVyLl9kZWxldGVQaXBlbGluZUNvbnRleHQoZSl9Y3JlYXRlU2hhZGVyUHJvZ3JhbShlLHQsaSxzLHIsbj1udWxsKXtyPXJ8fHRoaXMuX2dsLHRoaXMub25CZWZvcmVTaGFkZXJDb21waWxhdGlvbk9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2NvbnN0IGE9c3VwZXIuY3JlYXRlU2hhZGVyUHJvZ3JhbShlLHQsaSxzLHIsbik7cmV0dXJuIHRoaXMub25BZnRlclNoYWRlckNvbXBpbGF0aW9uT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksYX1fY3JlYXRlU2hhZGVyUHJvZ3JhbShlLHQsaSxzLHI9bnVsbCl7Y29uc3Qgbj1zLmNyZWF0ZVByb2dyYW0oKTtpZihlLnByb2dyYW09biwhbil0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBjcmVhdGUgcHJvZ3JhbSIpO2lmKHMuYXR0YWNoU2hhZGVyKG4sdCkscy5hdHRhY2hTaGFkZXIobixpKSx0aGlzLndlYkdMVmVyc2lvbj4xJiZyKXtjb25zdCBhPXRoaXMuY3JlYXRlVHJhbnNmb3JtRmVlZGJhY2soKTt0aGlzLmJpbmRUcmFuc2Zvcm1GZWVkYmFjayhhKSx0aGlzLnNldFRyYW5mb3JtRmVlZGJhY2tWYXJ5aW5ncyhuLHIpLGUudHJhbnNmb3JtRmVlZGJhY2s9YX1yZXR1cm4gcy5saW5rUHJvZ3JhbShuKSx0aGlzLndlYkdMVmVyc2lvbj4xJiZyJiZ0aGlzLmJpbmRUcmFuc2Zvcm1GZWVkYmFjayhudWxsKSxlLmNvbnRleHQ9cyxlLnZlcnRleFNoYWRlcj10LGUuZnJhZ21lbnRTaGFkZXI9aSxlLmlzUGFyYWxsZWxDb21waWxlZHx8dGhpcy5fZmluYWxpemVQaXBlbGluZUNvbnRleHQoZSksbn1fcmVsZWFzZVRleHR1cmUoZSl7c3VwZXIuX3JlbGVhc2VUZXh0dXJlKGUpfV9yZWxlYXNlUmVuZGVyVGFyZ2V0V3JhcHBlcihlKXtzdXBlci5fcmVsZWFzZVJlbmRlclRhcmdldFdyYXBwZXIoZSksdGhpcy5zY2VuZXMuZm9yRWFjaCh0PT57dC5wb3N0UHJvY2Vzc2VzLmZvckVhY2goaT0+e2kuX291dHB1dFRleHR1cmU9PT1lJiYoaS5fb3V0cHV0VGV4dHVyZT1udWxsKX0pLHQuY2FtZXJhcy5mb3JFYWNoKGk9PntpLl9wb3N0UHJvY2Vzc2VzLmZvckVhY2gocz0+e3MmJnMuX291dHB1dFRleHR1cmU9PT1lJiYocy5fb3V0cHV0VGV4dHVyZT1udWxsKX0pfSl9KX1nZXRSZW5kZXJQYXNzTmFtZXMoKXtyZXR1cm4gdGhpcy5fcmVuZGVyUGFzc05hbWVzfWdldEN1cnJlbnRSZW5kZXJQYXNzTmFtZSgpe3JldHVybiB0aGlzLl9yZW5kZXJQYXNzTmFtZXNbdGhpcy5jdXJyZW50UmVuZGVyUGFzc0lkXX1jcmVhdGVSZW5kZXJQYXNzSWQoZSl7Y29uc3QgdD0rK0kuX1JlbmRlclBhc3NJZENvdW50ZXI7cmV0dXJuIHRoaXMuX3JlbmRlclBhc3NOYW1lc1t0XT1lPz8iTk9OQU1FIix0fXJlbGVhc2VSZW5kZXJQYXNzSWQoZSl7dGhpcy5fcmVuZGVyUGFzc05hbWVzW2VdPXZvaWQgMDtmb3IobGV0IHQ9MDt0PHRoaXMuc2NlbmVzLmxlbmd0aDsrK3Qpe2NvbnN0IGk9dGhpcy5zY2VuZXNbdF07Zm9yKGxldCBzPTA7czxpLm1lc2hlcy5sZW5ndGg7KytzKXtjb25zdCByPWkubWVzaGVzW3NdO2lmKHIuc3ViTWVzaGVzKWZvcihsZXQgbj0wO248ci5zdWJNZXNoZXMubGVuZ3RoOysrbilyLnN1Yk1lc2hlc1tuXS5fcmVtb3ZlRHJhd1dyYXBwZXIoZSl9fX1fcmVzY2FsZVRleHR1cmUoZSx0LGkscyxyKXt0aGlzLl9nbC50ZXhQYXJhbWV0ZXJpKHRoaXMuX2dsLlRFWFRVUkVfMkQsdGhpcy5fZ2wuVEVYVFVSRV9NQUdfRklMVEVSLHRoaXMuX2dsLkxJTkVBUiksdGhpcy5fZ2wudGV4UGFyYW1ldGVyaSh0aGlzLl9nbC5URVhUVVJFXzJELHRoaXMuX2dsLlRFWFRVUkVfTUlOX0ZJTFRFUix0aGlzLl9nbC5MSU5FQVIpLHRoaXMuX2dsLnRleFBhcmFtZXRlcmkodGhpcy5fZ2wuVEVYVFVSRV8yRCx0aGlzLl9nbC5URVhUVVJFX1dSQVBfUyx0aGlzLl9nbC5DTEFNUF9UT19FREdFKSx0aGlzLl9nbC50ZXhQYXJhbWV0ZXJpKHRoaXMuX2dsLlRFWFRVUkVfMkQsdGhpcy5fZ2wuVEVYVFVSRV9XUkFQX1QsdGhpcy5fZ2wuQ0xBTVBfVE9fRURHRSk7Y29uc3Qgbj10aGlzLmNyZWF0ZVJlbmRlclRhcmdldFRleHR1cmUoe3dpZHRoOnQud2lkdGgsaGVpZ2h0OnQuaGVpZ2h0fSx7Z2VuZXJhdGVNaXBNYXBzOiExLHR5cGU6MCxzYW1wbGluZ01vZGU6MixnZW5lcmF0ZURlcHRoQnVmZmVyOiExLGdlbmVyYXRlU3RlbmNpbEJ1ZmZlcjohMX0pOyF0aGlzLl9yZXNjYWxlUG9zdFByb2Nlc3MmJkkuX1Jlc2NhbGVQb3N0UHJvY2Vzc0ZhY3RvcnkmJih0aGlzLl9yZXNjYWxlUG9zdFByb2Nlc3M9SS5fUmVzY2FsZVBvc3RQcm9jZXNzRmFjdG9yeSh0aGlzKSksdGhpcy5fcmVzY2FsZVBvc3RQcm9jZXNzJiYodGhpcy5fcmVzY2FsZVBvc3RQcm9jZXNzLmV4dGVybmFsVGV4dHVyZVNhbXBsZXJCaW5kaW5nPSEwLHRoaXMuX3Jlc2NhbGVQb3N0UHJvY2Vzcy5nZXRFZmZlY3QoKS5leGVjdXRlV2hlbkNvbXBpbGVkKCgpPT57dGhpcy5fcmVzY2FsZVBvc3RQcm9jZXNzLm9uQXBwbHk9ZnVuY3Rpb24obyl7by5fYmluZFRleHR1cmUoInRleHR1cmVTYW1wbGVyIixlKX07bGV0IGE9aTthfHwoYT10aGlzLnNjZW5lc1t0aGlzLnNjZW5lcy5sZW5ndGgtMV0pLGEucG9zdFByb2Nlc3NNYW5hZ2VyLmRpcmVjdFJlbmRlcihbdGhpcy5fcmVzY2FsZVBvc3RQcm9jZXNzXSxuLCEwKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfMkQsdCwhMCksdGhpcy5fZ2wuY29weVRleEltYWdlMkQodGhpcy5fZ2wuVEVYVFVSRV8yRCwwLHMsMCwwLHQud2lkdGgsdC5oZWlnaHQsMCksdGhpcy51bkJpbmRGcmFtZWJ1ZmZlcihuKSxuLmRpc3Bvc2UoKSxyJiZyKCl9KSl9Z2V0RnBzKCl7cmV0dXJuIHRoaXMuX2Zwc31nZXREZWx0YVRpbWUoKXtyZXR1cm4gdGhpcy5fZGVsdGFUaW1lfV9tZWFzdXJlRnBzKCl7dGhpcy5fcGVyZm9ybWFuY2VNb25pdG9yLnNhbXBsZUZyYW1lKCksdGhpcy5fZnBzPXRoaXMuX3BlcmZvcm1hbmNlTW9uaXRvci5hdmVyYWdlRlBTLHRoaXMuX2RlbHRhVGltZT10aGlzLl9wZXJmb3JtYW5jZU1vbml0b3IuaW5zdGFudGFuZW91c0ZyYW1lVGltZXx8MH13cmFwV2ViR0xUZXh0dXJlKGUpe2NvbnN0IHQ9bmV3IHRyKGUsdGhpcy5fZ2wpLGk9bmV3IE90KHRoaXMsTmUuVW5rbm93biwhMCk7cmV0dXJuIGkuX2hhcmR3YXJlVGV4dHVyZT10LGkuaXNSZWFkeT0hMCxpfV91cGxvYWRJbWFnZVRvVGV4dHVyZShlLHQsaT0wLHM9MCl7Y29uc3Qgcj10aGlzLl9nbCxuPXRoaXMuX2dldFdlYkdMVGV4dHVyZVR5cGUoZS50eXBlKSxhPXRoaXMuX2dldEludGVybmFsRm9ybWF0KGUuZm9ybWF0KSxvPXRoaXMuX2dldFJHQkFCdWZmZXJJbnRlcm5hbFNpemVkRm9ybWF0KGUudHlwZSxhKSxoPWUuaXNDdWJlP3IuVEVYVFVSRV9DVUJFX01BUDpyLlRFWFRVUkVfMkQ7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShoLGUsITApLHRoaXMuX3VucGFja0ZsaXBZKGUuaW52ZXJ0WSk7bGV0IGw9ci5URVhUVVJFXzJEO2UuaXNDdWJlJiYobD1yLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWCtpKSxyLnRleEltYWdlMkQobCxzLG8sYSxuLHQpLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkoaCxudWxsLCEwKX11cGRhdGVUZXh0dXJlQ29tcGFyaXNvbkZ1bmN0aW9uKGUsdCl7aWYodGhpcy53ZWJHTFZlcnNpb249PT0xKXtPLkVycm9yKCJXZWJHTCAxIGRvZXMgbm90IHN1cHBvcnQgdGV4dHVyZSBjb21wYXJpc29uLiIpO3JldHVybn1jb25zdCBpPXRoaXMuX2dsO2UuaXNDdWJlPyh0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVAsZSwhMCksdD09PTA/KGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfQ1VCRV9NQVAsaS5URVhUVVJFX0NPTVBBUkVfRlVOQyw1MTUpLGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfQ1VCRV9NQVAsaS5URVhUVVJFX0NPTVBBUkVfTU9ERSxpLk5PTkUpKTooaS50ZXhQYXJhbWV0ZXJpKGkuVEVYVFVSRV9DVUJFX01BUCxpLlRFWFRVUkVfQ09NUEFSRV9GVU5DLHQpLGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfQ1VCRV9NQVAsaS5URVhUVVJFX0NPTVBBUkVfTU9ERSxpLkNPTVBBUkVfUkVGX1RPX1RFWFRVUkUpKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVAsbnVsbCkpOih0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfMkQsZSwhMCksdD09PTA/KGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfMkQsaS5URVhUVVJFX0NPTVBBUkVfRlVOQyw1MTUpLGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfMkQsaS5URVhUVVJFX0NPTVBBUkVfTU9ERSxpLk5PTkUpKTooaS50ZXhQYXJhbWV0ZXJpKGkuVEVYVFVSRV8yRCxpLlRFWFRVUkVfQ09NUEFSRV9GVU5DLHQpLGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfMkQsaS5URVhUVVJFX0NPTVBBUkVfTU9ERSxpLkNPTVBBUkVfUkVGX1RPX1RFWFRVUkUpKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfMkQsbnVsbCkpLGUuX2NvbXBhcmlzb25GdW5jdGlvbj10fWNyZWF0ZUluc3RhbmNlc0J1ZmZlcihlKXtjb25zdCB0PXRoaXMuX2dsLmNyZWF0ZUJ1ZmZlcigpO2lmKCF0KXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSBpbnN0YW5jZSBidWZmZXIiKTtjb25zdCBpPW5ldyBEaSh0KTtyZXR1cm4gaS5jYXBhY2l0eT1lLHRoaXMuYmluZEFycmF5QnVmZmVyKGkpLHRoaXMuX2dsLmJ1ZmZlckRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLGUsdGhpcy5fZ2wuRFlOQU1JQ19EUkFXKSxpLnJlZmVyZW5jZXM9MSxpfWRlbGV0ZUluc3RhbmNlc0J1ZmZlcihlKXt0aGlzLl9nbC5kZWxldGVCdWZmZXIoZSl9X2NsaWVudFdhaXRBc3luYyhlLHQ9MCxpPTEwKXtjb25zdCBzPXRoaXMuX2dsO3JldHVybiBuZXcgUHJvbWlzZSgocixuKT0+e2NvbnN0IGE9KCk9Pntjb25zdCBvPXMuY2xpZW50V2FpdFN5bmMoZSx0LDApO2lmKG89PXMuV0FJVF9GQUlMRUQpe24oKTtyZXR1cm59aWYobz09cy5USU1FT1VUX0VYUElSRUQpe3NldFRpbWVvdXQoYSxpKTtyZXR1cm59cigpfTthKCl9KX1fcmVhZFBpeGVsc0FzeW5jKGUsdCxpLHMscixuLGEpe2lmKHRoaXMuX3dlYkdMVmVyc2lvbjwyKXRocm93IG5ldyBFcnJvcigiX3JlYWRQaXhlbHNBc3luYyBvbmx5IHdvcmsgb24gV2ViR0wyKyIpO2NvbnN0IG89dGhpcy5fZ2wsaD1vLmNyZWF0ZUJ1ZmZlcigpO28uYmluZEJ1ZmZlcihvLlBJWEVMX1BBQ0tfQlVGRkVSLGgpLG8uYnVmZmVyRGF0YShvLlBJWEVMX1BBQ0tfQlVGRkVSLGEuYnl0ZUxlbmd0aCxvLlNUUkVBTV9SRUFEKSxvLnJlYWRQaXhlbHMoZSx0LGkscyxyLG4sMCksby5iaW5kQnVmZmVyKG8uUElYRUxfUEFDS19CVUZGRVIsbnVsbCk7Y29uc3QgbD1vLmZlbmNlU3luYyhvLlNZTkNfR1BVX0NPTU1BTkRTX0NPTVBMRVRFLDApO3JldHVybiBsPyhvLmZsdXNoKCksdGhpcy5fY2xpZW50V2FpdEFzeW5jKGwsMCwxMCkudGhlbigoKT0+KG8uZGVsZXRlU3luYyhsKSxvLmJpbmRCdWZmZXIoby5QSVhFTF9QQUNLX0JVRkZFUixoKSxvLmdldEJ1ZmZlclN1YkRhdGEoby5QSVhFTF9QQUNLX0JVRkZFUiwwLGEpLG8uYmluZEJ1ZmZlcihvLlBJWEVMX1BBQ0tfQlVGRkVSLG51bGwpLG8uZGVsZXRlQnVmZmVyKGgpLGEpKSk6bnVsbH1kaXNwb3NlKCl7Zm9yKHRoaXMuaGlkZUxvYWRpbmdVSSgpLHRoaXMub25OZXdTY2VuZUFkZGVkT2JzZXJ2YWJsZS5jbGVhcigpO3RoaXMucG9zdFByb2Nlc3Nlcy5sZW5ndGg7KXRoaXMucG9zdFByb2Nlc3Nlc1swXS5kaXNwb3NlKCk7Zm9yKHRoaXMuX3Jlc2NhbGVQb3N0UHJvY2VzcyYmdGhpcy5fcmVzY2FsZVBvc3RQcm9jZXNzLmRpc3Bvc2UoKTt0aGlzLnNjZW5lcy5sZW5ndGg7KXRoaXMuc2NlbmVzWzBdLmRpc3Bvc2UoKTtmb3IoO3RoaXMuX3ZpcnR1YWxTY2VuZXMubGVuZ3RoOyl0aGlzLl92aXJ0dWFsU2NlbmVzWzBdLmRpc3Bvc2UoKTtJLkluc3RhbmNlcy5sZW5ndGg9PT0xJiZJLmF1ZGlvRW5naW5lJiYoSS5hdWRpb0VuZ2luZS5kaXNwb3NlKCksSS5hdWRpb0VuZ2luZT1udWxsKSx0aGlzLmRpc2FibGVWUigpO2NvbnN0IGU9dGhpcy5nZXRIb3N0V2luZG93KCk7ZSYmdHlwZW9mIGUucmVtb3ZlRXZlbnRMaXN0ZW5lcj09ImZ1bmN0aW9uIiYmKGUucmVtb3ZlRXZlbnRMaXN0ZW5lcigiYmx1ciIsdGhpcy5fb25CbHVyKSxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoImZvY3VzIix0aGlzLl9vbkZvY3VzKSksdGhpcy5fcmVuZGVyaW5nQ2FudmFzJiYodGhpcy5fcmVuZGVyaW5nQ2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoImZvY3VzIix0aGlzLl9vbkNhbnZhc0ZvY3VzKSx0aGlzLl9yZW5kZXJpbmdDYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigiYmx1ciIsdGhpcy5fb25DYW52YXNCbHVyKSx0aGlzLl9yZW5kZXJpbmdDYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcm91dCIsdGhpcy5fb25DYW52YXNQb2ludGVyT3V0KSx0aGlzLl9yZW5kZXJpbmdDYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY29udGV4dG1lbnUiLHRoaXMuX29uQ2FudmFzQ29udGV4dE1lbnUpKSxDaSgpJiYoZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZnVsbHNjcmVlbmNoYW5nZSIsdGhpcy5fb25GdWxsc2NyZWVuQ2hhbmdlKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJtb3pmdWxsc2NyZWVuY2hhbmdlIix0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIndlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UiLHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigibXNmdWxsc2NyZWVuY2hhbmdlIix0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJsb2NrY2hhbmdlIix0aGlzLl9vblBvaW50ZXJMb2NrQ2hhbmdlKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJtc3BvaW50ZXJsb2NrY2hhbmdlIix0aGlzLl9vblBvaW50ZXJMb2NrQ2hhbmdlKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJtb3pwb2ludGVybG9ja2NoYW5nZSIsdGhpcy5fb25Qb2ludGVyTG9ja0NoYW5nZSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigid2Via2l0cG9pbnRlcmxvY2tjaGFuZ2UiLHRoaXMuX29uUG9pbnRlckxvY2tDaGFuZ2UpKSxzdXBlci5kaXNwb3NlKCk7Y29uc3QgdD1JLkluc3RhbmNlcy5pbmRleE9mKHRoaXMpO3Q+PTAmJkkuSW5zdGFuY2VzLnNwbGljZSh0LDEpLHRoaXMub25SZXNpemVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNhbnZhc0JsdXJPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNhbnZhc0ZvY3VzT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25DYW52YXNQb2ludGVyT3V0T2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25CZWdpbkZyYW1lT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25FbmRGcmFtZU9ic2VydmFibGUuY2xlYXIoKX1fZGlzYWJsZVRvdWNoQWN0aW9uKCl7IXRoaXMuX3JlbmRlcmluZ0NhbnZhc3x8IXRoaXMuX3JlbmRlcmluZ0NhbnZhcy5zZXRBdHRyaWJ1dGV8fCh0aGlzLl9yZW5kZXJpbmdDYW52YXMuc2V0QXR0cmlidXRlKCJ0b3VjaC1hY3Rpb24iLCJub25lIiksdGhpcy5fcmVuZGVyaW5nQ2FudmFzLnN0eWxlLnRvdWNoQWN0aW9uPSJub25lIix0aGlzLl9yZW5kZXJpbmdDYW52YXMuc3R5bGUud2Via2l0VGFwSGlnaGxpZ2h0Q29sb3I9InRyYW5zcGFyZW50Iil9ZGlzcGxheUxvYWRpbmdVSSgpe2lmKCFqZSgpKXJldHVybjtjb25zdCBlPXRoaXMubG9hZGluZ1NjcmVlbjtlJiZlLmRpc3BsYXlMb2FkaW5nVUkoKX1oaWRlTG9hZGluZ1VJKCl7aWYoIWplKCkpcmV0dXJuO2NvbnN0IGU9dGhpcy5fbG9hZGluZ1NjcmVlbjtlJiZlLmhpZGVMb2FkaW5nVUkoKX1nZXQgbG9hZGluZ1NjcmVlbigpe3JldHVybiF0aGlzLl9sb2FkaW5nU2NyZWVuJiZ0aGlzLl9yZW5kZXJpbmdDYW52YXMmJih0aGlzLl9sb2FkaW5nU2NyZWVuPUkuRGVmYXVsdExvYWRpbmdTY3JlZW5GYWN0b3J5KHRoaXMuX3JlbmRlcmluZ0NhbnZhcykpLHRoaXMuX2xvYWRpbmdTY3JlZW59c2V0IGxvYWRpbmdTY3JlZW4oZSl7dGhpcy5fbG9hZGluZ1NjcmVlbj1lfXNldCBsb2FkaW5nVUlUZXh0KGUpe3RoaXMubG9hZGluZ1NjcmVlbi5sb2FkaW5nVUlUZXh0PWV9c2V0IGxvYWRpbmdVSUJhY2tncm91bmRDb2xvcihlKXt0aGlzLmxvYWRpbmdTY3JlZW4ubG9hZGluZ1VJQmFja2dyb3VuZENvbG9yPWV9Y3JlYXRlVmlkZW9FbGVtZW50KGUpe3JldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ2aWRlbyIpfXN0YXRpYyBfUmVxdWVzdFBvaW50ZXJsb2NrKGUpe2UucmVxdWVzdFBvaW50ZXJMb2NrJiYoZS5yZXF1ZXN0UG9pbnRlckxvY2soKSxlLmZvY3VzKCkpfXN0YXRpYyBfRXhpdFBvaW50ZXJsb2NrKCl7ZG9jdW1lbnQuZXhpdFBvaW50ZXJMb2NrJiZkb2N1bWVudC5leGl0UG9pbnRlckxvY2soKX1zdGF0aWMgX1JlcXVlc3RGdWxsc2NyZWVuKGUpe2NvbnN0IHQ9ZS5yZXF1ZXN0RnVsbHNjcmVlbnx8ZS53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbjt0JiZ0LmNhbGwoZSl9c3RhdGljIF9FeGl0RnVsbHNjcmVlbigpe2NvbnN0IGU9ZG9jdW1lbnQ7ZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4/ZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4oKTplLndlYmtpdENhbmNlbEZ1bGxTY3JlZW4mJmUud2Via2l0Q2FuY2VsRnVsbFNjcmVlbigpfWdldEZvbnRPZmZzZXQoZSl7Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIik7dC5pbm5lckhUTUw9IkhnIix0LnNldEF0dHJpYnV0ZSgic3R5bGUiLGBmb250OiAke2V9ICFpbXBvcnRhbnRgKTtjb25zdCBpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2kuc3R5bGUuZGlzcGxheT0iaW5saW5lLWJsb2NrIixpLnN0eWxlLndpZHRoPSIxcHgiLGkuc3R5bGUuaGVpZ2h0PSIwcHgiLGkuc3R5bGUudmVydGljYWxBbGlnbj0iYm90dG9tIjtjb25zdCBzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO3Muc3R5bGUud2hpdGVTcGFjZT0ibm93cmFwIixzLmFwcGVuZENoaWxkKHQpLHMuYXBwZW5kQ2hpbGQoaSksZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzKTtsZXQgcj0wLG49MDt0cnl7bj1pLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcC10LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCxpLnN0eWxlLnZlcnRpY2FsQWxpZ249ImJhc2VsaW5lIixyPWkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wLXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wfWZpbmFsbHl7ZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChzKX1yZXR1cm57YXNjZW50OnIsaGVpZ2h0Om4sZGVzY2VudDpuLXJ9fX1JLkFMUEhBX0RJU0FCTEU9MCxJLkFMUEhBX0FERD0xLEkuQUxQSEFfQ09NQklORT0yLEkuQUxQSEFfU1VCVFJBQ1Q9MyxJLkFMUEhBX01VTFRJUExZPTQsSS5BTFBIQV9NQVhJTUlaRUQ9NSxJLkFMUEhBX09ORU9ORT02LEkuQUxQSEFfUFJFTVVMVElQTElFRD03LEkuQUxQSEFfUFJFTVVMVElQTElFRF9QT1JURVJEVUZGPTgsSS5BTFBIQV9JTlRFUlBPTEFURT05LEkuQUxQSEFfU0NSRUVOTU9ERT0xMCxJLkRFTEFZTE9BRFNUQVRFX05PTkU9MCxJLkRFTEFZTE9BRFNUQVRFX0xPQURFRD0xLEkuREVMQVlMT0FEU1RBVEVfTE9BRElORz0yLEkuREVMQVlMT0FEU1RBVEVfTk9UTE9BREVEPTQsSS5ORVZFUj01MTIsSS5BTFdBWVM9NTE5LEkuTEVTUz01MTMsSS5FUVVBTD01MTQsSS5MRVFVQUw9NTE1LEkuR1JFQVRFUj01MTYsSS5HRVFVQUw9NTE4LEkuTk9URVFVQUw9NTE3LEkuS0VFUD03NjgwLEkuUkVQTEFDRT03NjgxLEkuSU5DUj03NjgyLEkuREVDUj03NjgzLEkuSU5WRVJUPTUzODYsSS5JTkNSX1dSQVA9MzQwNTUsSS5ERUNSX1dSQVA9MzQwNTYsSS5URVhUVVJFX0NMQU1QX0FERFJFU1NNT0RFPTAsSS5URVhUVVJFX1dSQVBfQUREUkVTU01PREU9MSxJLlRFWFRVUkVfTUlSUk9SX0FERFJFU1NNT0RFPTIsSS5URVhUVVJFRk9STUFUX0FMUEhBPTAsSS5URVhUVVJFRk9STUFUX0xVTUlOQU5DRT0xLEkuVEVYVFVSRUZPUk1BVF9MVU1JTkFOQ0VfQUxQSEE9MixJLlRFWFRVUkVGT1JNQVRfUkdCPTQsSS5URVhUVVJFRk9STUFUX1JHQkE9NSxJLlRFWFRVUkVGT1JNQVRfUkVEPTYsSS5URVhUVVJFRk9STUFUX1I9NixJLlRFWFRVUkVGT1JNQVRfUkc9NyxJLlRFWFRVUkVGT1JNQVRfUkVEX0lOVEVHRVI9OCxJLlRFWFRVUkVGT1JNQVRfUl9JTlRFR0VSPTgsSS5URVhUVVJFRk9STUFUX1JHX0lOVEVHRVI9OSxJLlRFWFRVUkVGT1JNQVRfUkdCX0lOVEVHRVI9MTAsSS5URVhUVVJFRk9STUFUX1JHQkFfSU5URUdFUj0xMSxJLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0JZVEU9MCxJLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVD0wLEkuVEVYVFVSRVRZUEVfRkxPQVQ9MSxJLlRFWFRVUkVUWVBFX0hBTEZfRkxPQVQ9MixJLlRFWFRVUkVUWVBFX0JZVEU9MyxJLlRFWFRVUkVUWVBFX1NIT1JUPTQsSS5URVhUVVJFVFlQRV9VTlNJR05FRF9TSE9SVD01LEkuVEVYVFVSRVRZUEVfSU5UPTYsSS5URVhUVVJFVFlQRV9VTlNJR05FRF9JTlRFR0VSPTcsSS5URVhUVVJFVFlQRV9VTlNJR05FRF9TSE9SVF80XzRfNF80PTgsSS5URVhUVVJFVFlQRV9VTlNJR05FRF9TSE9SVF81XzVfNV8xPTksSS5URVhUVVJFVFlQRV9VTlNJR05FRF9TSE9SVF81XzZfNT0xMCxJLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVF8yXzEwXzEwXzEwX1JFVj0xMSxJLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVF8yNF84PTEyLEkuVEVYVFVSRVRZUEVfVU5TSUdORURfSU5UXzEwRl8xMUZfMTFGX1JFVj0xMyxJLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVF81XzlfOV85X1JFVj0xNCxJLlRFWFRVUkVUWVBFX0ZMT0FUXzMyX1VOU0lHTkVEX0lOVF8yNF84X1JFVj0xNSxJLlRFWFRVUkVfTkVBUkVTVF9TQU1QTElOR01PREU9MSxJLlRFWFRVUkVfQklMSU5FQVJfU0FNUExJTkdNT0RFPTIsSS5URVhUVVJFX1RSSUxJTkVBUl9TQU1QTElOR01PREU9MyxJLlRFWFRVUkVfTkVBUkVTVF9ORUFSRVNUX01JUExJTkVBUj04LEkuVEVYVFVSRV9MSU5FQVJfTElORUFSX01JUE5FQVJFU1Q9MTEsSS5URVhUVVJFX0xJTkVBUl9MSU5FQVJfTUlQTElORUFSPTMsSS5URVhUVVJFX05FQVJFU1RfTkVBUkVTVF9NSVBORUFSRVNUPTQsSS5URVhUVVJFX05FQVJFU1RfTElORUFSX01JUE5FQVJFU1Q9NSxJLlRFWFRVUkVfTkVBUkVTVF9MSU5FQVJfTUlQTElORUFSPTYsSS5URVhUVVJFX05FQVJFU1RfTElORUFSPTcsSS5URVhUVVJFX05FQVJFU1RfTkVBUkVTVD0xLEkuVEVYVFVSRV9MSU5FQVJfTkVBUkVTVF9NSVBORUFSRVNUPTksSS5URVhUVVJFX0xJTkVBUl9ORUFSRVNUX01JUExJTkVBUj0xMCxJLlRFWFRVUkVfTElORUFSX0xJTkVBUj0yLEkuVEVYVFVSRV9MSU5FQVJfTkVBUkVTVD0xMixJLlRFWFRVUkVfRVhQTElDSVRfTU9ERT0wLEkuVEVYVFVSRV9TUEhFUklDQUxfTU9ERT0xLEkuVEVYVFVSRV9QTEFOQVJfTU9ERT0yLEkuVEVYVFVSRV9DVUJJQ19NT0RFPTMsSS5URVhUVVJFX1BST0pFQ1RJT05fTU9ERT00LEkuVEVYVFVSRV9TS1lCT1hfTU9ERT01LEkuVEVYVFVSRV9JTlZDVUJJQ19NT0RFPTYsSS5URVhUVVJFX0VRVUlSRUNUQU5HVUxBUl9NT0RFPTcsSS5URVhUVVJFX0ZJWEVEX0VRVUlSRUNUQU5HVUxBUl9NT0RFPTgsSS5URVhUVVJFX0ZJWEVEX0VRVUlSRUNUQU5HVUxBUl9NSVJST1JFRF9NT0RFPTksSS5TQ0FMRU1PREVfRkxPT1I9MSxJLlNDQUxFTU9ERV9ORUFSRVNUPTIsSS5TQ0FMRU1PREVfQ0VJTElORz0zLEkuX1Jlc2NhbGVQb3N0UHJvY2Vzc0ZhY3Rvcnk9bnVsbCxJLl9SZW5kZXJQYXNzSWRDb3VudGVyPTAsb2UucHJvdG90eXBlLl9kZWJ1Z1B1c2hHcm91cD1mdW5jdGlvbihjLGUpe30sb2UucHJvdG90eXBlLl9kZWJ1Z1BvcEdyb3VwPWZ1bmN0aW9uKGMpe30sb2UucHJvdG90eXBlLl9kZWJ1Z0luc2VydE1hcmtlcj1mdW5jdGlvbihjLGUpe30sb2UucHJvdG90eXBlLl9kZWJ1Z0ZsdXNoUGVuZGluZ0NvbW1hbmRzPWZ1bmN0aW9uKCl7fTtmdW5jdGlvbiBnbihjKXtyZXR1cm4gbmV3IEkoYywhMCx7cHJlc2VydmVEcmF3aW5nQnVmZmVyOiEwLHN0ZW5jaWw6ITB9KX1jbGFzcyByZXtjb25zdHJ1Y3RvcihlPTAsdD0wLGk9MCl7dGhpcy5yPWUsdGhpcy5nPXQsdGhpcy5iPWl9dG9TdHJpbmcoKXtyZXR1cm4ie1I6ICIrdGhpcy5yKyIgRzoiK3RoaXMuZysiIEI6Iit0aGlzLmIrIn0ifWdldENsYXNzTmFtZSgpe3JldHVybiJDb2xvcjMifWdldEhhc2hDb2RlKCl7bGV0IGU9dGhpcy5yKjI1NXwwO3JldHVybiBlPWUqMzk3Xih0aGlzLmcqMjU1fDApLGU9ZSozOTdeKHRoaXMuYioyNTV8MCksZX10b0FycmF5KGUsdD0wKXtyZXR1cm4gZVt0XT10aGlzLnIsZVt0KzFdPXRoaXMuZyxlW3QrMl09dGhpcy5iLHRoaXN9ZnJvbUFycmF5KGUsdD0wKXtyZXR1cm4gcmUuRnJvbUFycmF5VG9SZWYoZSx0LHRoaXMpLHRoaXN9dG9Db2xvcjQoZT0xKXtyZXR1cm4gbmV3IG1lKHRoaXMucix0aGlzLmcsdGhpcy5iLGUpfWFzQXJyYXkoKXtyZXR1cm5bdGhpcy5yLHRoaXMuZyx0aGlzLmJdfXRvTHVtaW5hbmNlKCl7cmV0dXJuIHRoaXMuciouMyt0aGlzLmcqLjU5K3RoaXMuYiouMTF9bXVsdGlwbHkoZSl7cmV0dXJuIG5ldyByZSh0aGlzLnIqZS5yLHRoaXMuZyplLmcsdGhpcy5iKmUuYil9bXVsdGlwbHlUb1JlZihlLHQpe3JldHVybiB0LnI9dGhpcy5yKmUucix0Lmc9dGhpcy5nKmUuZyx0LmI9dGhpcy5iKmUuYix0aGlzfWVxdWFscyhlKXtyZXR1cm4gZSYmdGhpcy5yPT09ZS5yJiZ0aGlzLmc9PT1lLmcmJnRoaXMuYj09PWUuYn1lcXVhbHNGbG9hdHMoZSx0LGkpe3JldHVybiB0aGlzLnI9PT1lJiZ0aGlzLmc9PT10JiZ0aGlzLmI9PT1pfXNjYWxlKGUpe3JldHVybiBuZXcgcmUodGhpcy5yKmUsdGhpcy5nKmUsdGhpcy5iKmUpfXNjYWxlSW5QbGFjZShlKXtyZXR1cm4gdGhpcy5yKj1lLHRoaXMuZyo9ZSx0aGlzLmIqPWUsdGhpc31zY2FsZVRvUmVmKGUsdCl7cmV0dXJuIHQucj10aGlzLnIqZSx0Lmc9dGhpcy5nKmUsdC5iPXRoaXMuYiplLHRoaXN9c2NhbGVBbmRBZGRUb1JlZihlLHQpe3JldHVybiB0LnIrPXRoaXMuciplLHQuZys9dGhpcy5nKmUsdC5iKz10aGlzLmIqZSx0aGlzfWNsYW1wVG9SZWYoZT0wLHQ9MSxpKXtyZXR1cm4gaS5yPVguQ2xhbXAodGhpcy5yLGUsdCksaS5nPVguQ2xhbXAodGhpcy5nLGUsdCksaS5iPVguQ2xhbXAodGhpcy5iLGUsdCksdGhpc31hZGQoZSl7cmV0dXJuIG5ldyByZSh0aGlzLnIrZS5yLHRoaXMuZytlLmcsdGhpcy5iK2UuYil9YWRkVG9SZWYoZSx0KXtyZXR1cm4gdC5yPXRoaXMucitlLnIsdC5nPXRoaXMuZytlLmcsdC5iPXRoaXMuYitlLmIsdGhpc31zdWJ0cmFjdChlKXtyZXR1cm4gbmV3IHJlKHRoaXMuci1lLnIsdGhpcy5nLWUuZyx0aGlzLmItZS5iKX1zdWJ0cmFjdFRvUmVmKGUsdCl7cmV0dXJuIHQucj10aGlzLnItZS5yLHQuZz10aGlzLmctZS5nLHQuYj10aGlzLmItZS5iLHRoaXN9Y2xvbmUoKXtyZXR1cm4gbmV3IHJlKHRoaXMucix0aGlzLmcsdGhpcy5iKX1jb3B5RnJvbShlKXtyZXR1cm4gdGhpcy5yPWUucix0aGlzLmc9ZS5nLHRoaXMuYj1lLmIsdGhpc31jb3B5RnJvbUZsb2F0cyhlLHQsaSl7cmV0dXJuIHRoaXMucj1lLHRoaXMuZz10LHRoaXMuYj1pLHRoaXN9c2V0KGUsdCxpKXtyZXR1cm4gdGhpcy5jb3B5RnJvbUZsb2F0cyhlLHQsaSl9dG9IZXhTdHJpbmcoKXtjb25zdCBlPU1hdGgucm91bmQodGhpcy5yKjI1NSksdD1NYXRoLnJvdW5kKHRoaXMuZyoyNTUpLGk9TWF0aC5yb3VuZCh0aGlzLmIqMjU1KTtyZXR1cm4iIyIrWC5Ub0hleChlKStYLlRvSGV4KHQpK1guVG9IZXgoaSl9dG9MaW5lYXJTcGFjZSgpe2NvbnN0IGU9bmV3IHJlO3JldHVybiB0aGlzLnRvTGluZWFyU3BhY2VUb1JlZihlKSxlfXRvSFNWKCl7Y29uc3QgZT1uZXcgcmU7cmV0dXJuIHRoaXMudG9IU1ZUb1JlZihlKSxlfXRvSFNWVG9SZWYoZSl7Y29uc3QgdD10aGlzLnIsaT10aGlzLmcscz10aGlzLmIscj1NYXRoLm1heCh0LGkscyksbj1NYXRoLm1pbih0LGkscyk7bGV0IGE9MCxvPTA7Y29uc3QgaD1yLGw9ci1uO3IhPT0wJiYobz1sL3IpLHIhPW4mJihyPT10PyhhPShpLXMpL2wsaTxzJiYoYSs9NikpOnI9PWk/YT0ocy10KS9sKzI6cj09cyYmKGE9KHQtaSkvbCs0KSxhKj02MCksZS5yPWEsZS5nPW8sZS5iPWh9dG9MaW5lYXJTcGFjZVRvUmVmKGUpe3JldHVybiBlLnI9TWF0aC5wb3codGhpcy5yLHllKSxlLmc9TWF0aC5wb3codGhpcy5nLHllKSxlLmI9TWF0aC5wb3codGhpcy5iLHllKSx0aGlzfXRvR2FtbWFTcGFjZSgpe2NvbnN0IGU9bmV3IHJlO3JldHVybiB0aGlzLnRvR2FtbWFTcGFjZVRvUmVmKGUpLGV9dG9HYW1tYVNwYWNlVG9SZWYoZSl7cmV0dXJuIGUucj1NYXRoLnBvdyh0aGlzLnIsU2UpLGUuZz1NYXRoLnBvdyh0aGlzLmcsU2UpLGUuYj1NYXRoLnBvdyh0aGlzLmIsU2UpLHRoaXN9c3RhdGljIEhTVnRvUkdCVG9SZWYoZSx0LGkscyl7Y29uc3Qgcj1pKnQsbj1lLzYwLGE9ciooMS1NYXRoLmFicyhuJTItMSkpO2xldCBvPTAsaD0wLGw9MDtuPj0wJiZuPD0xPyhvPXIsaD1hKTpuPj0xJiZuPD0yPyhvPWEsaD1yKTpuPj0yJiZuPD0zPyhoPXIsbD1hKTpuPj0zJiZuPD00PyhoPWEsbD1yKTpuPj00JiZuPD01PyhvPWEsbD1yKTpuPj01JiZuPD02JiYobz1yLGw9YSk7Y29uc3QgdT1pLXI7cy5zZXQobyt1LGgrdSxsK3UpfXN0YXRpYyBGcm9tSFNWKGUsdCxpKXtjb25zdCBzPW5ldyByZSgwLDAsMCk7cmV0dXJuIHJlLkhTVnRvUkdCVG9SZWYoZSx0LGkscyksc31zdGF0aWMgRnJvbUhleFN0cmluZyhlKXtpZihlLnN1YnN0cmluZygwLDEpIT09IiMifHxlLmxlbmd0aCE9PTcpcmV0dXJuIG5ldyByZSgwLDAsMCk7Y29uc3QgdD1wYXJzZUludChlLnN1YnN0cmluZygxLDMpLDE2KSxpPXBhcnNlSW50KGUuc3Vic3RyaW5nKDMsNSksMTYpLHM9cGFyc2VJbnQoZS5zdWJzdHJpbmcoNSw3KSwxNik7cmV0dXJuIHJlLkZyb21JbnRzKHQsaSxzKX1zdGF0aWMgRnJvbUFycmF5KGUsdD0wKXtyZXR1cm4gbmV3IHJlKGVbdF0sZVt0KzFdLGVbdCsyXSl9c3RhdGljIEZyb21BcnJheVRvUmVmKGUsdD0wLGkpe2kucj1lW3RdLGkuZz1lW3QrMV0saS5iPWVbdCsyXX1zdGF0aWMgRnJvbUludHMoZSx0LGkpe3JldHVybiBuZXcgcmUoZS8yNTUsdC8yNTUsaS8yNTUpfXN0YXRpYyBMZXJwKGUsdCxpKXtjb25zdCBzPW5ldyByZSgwLDAsMCk7cmV0dXJuIHJlLkxlcnBUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBMZXJwVG9SZWYoZSx0LGkscyl7cy5yPWUucisodC5yLWUucikqaSxzLmc9ZS5nKyh0LmctZS5nKSppLHMuYj1lLmIrKHQuYi1lLmIpKml9c3RhdGljIEhlcm1pdGUoZSx0LGkscyxyKXtjb25zdCBuPXIqcixhPXIqbixvPTIqYS0zKm4rMSxoPS0yKmErMypuLGw9YS0yKm4rcix1PWEtbixkPWUucipvK2kucipoK3QucipsK3Mucip1LGY9ZS5nKm8raS5nKmgrdC5nKmwrcy5nKnUsXz1lLmIqbytpLmIqaCt0LmIqbCtzLmIqdTtyZXR1cm4gbmV3IHJlKGQsZixfKX1zdGF0aWMgSGVybWl0ZTFzdERlcml2YXRpdmUoZSx0LGkscyxyKXtjb25zdCBuPXJlLkJsYWNrKCk7cmV0dXJuIHRoaXMuSGVybWl0ZTFzdERlcml2YXRpdmVUb1JlZihlLHQsaSxzLHIsbiksbn1zdGF0aWMgSGVybWl0ZTFzdERlcml2YXRpdmVUb1JlZihlLHQsaSxzLHIsbil7Y29uc3QgYT1yKnI7bi5yPShhLXIpKjYqZS5yKygzKmEtNCpyKzEpKnQucisoLWErcikqNippLnIrKDMqYS0yKnIpKnMucixuLmc9KGEtcikqNiplLmcrKDMqYS00KnIrMSkqdC5nKygtYStyKSo2KmkuZysoMyphLTIqcikqcy5nLG4uYj0oYS1yKSo2KmUuYisoMyphLTQqcisxKSp0LmIrKC1hK3IpKjYqaS5iKygzKmEtMipyKSpzLmJ9c3RhdGljIFJlZCgpe3JldHVybiBuZXcgcmUoMSwwLDApfXN0YXRpYyBHcmVlbigpe3JldHVybiBuZXcgcmUoMCwxLDApfXN0YXRpYyBCbHVlKCl7cmV0dXJuIG5ldyByZSgwLDAsMSl9c3RhdGljIEJsYWNrKCl7cmV0dXJuIG5ldyByZSgwLDAsMCl9c3RhdGljIGdldCBCbGFja1JlYWRPbmx5KCl7cmV0dXJuIHJlLl9CbGFja1JlYWRPbmx5fXN0YXRpYyBXaGl0ZSgpe3JldHVybiBuZXcgcmUoMSwxLDEpfXN0YXRpYyBQdXJwbGUoKXtyZXR1cm4gbmV3IHJlKC41LDAsLjUpfXN0YXRpYyBNYWdlbnRhKCl7cmV0dXJuIG5ldyByZSgxLDAsMSl9c3RhdGljIFllbGxvdygpe3JldHVybiBuZXcgcmUoMSwxLDApfXN0YXRpYyBHcmF5KCl7cmV0dXJuIG5ldyByZSguNSwuNSwuNSl9c3RhdGljIFRlYWwoKXtyZXR1cm4gbmV3IHJlKDAsMSwxKX1zdGF0aWMgUmFuZG9tKCl7cmV0dXJuIG5ldyByZShNYXRoLnJhbmRvbSgpLE1hdGgucmFuZG9tKCksTWF0aC5yYW5kb20oKSl9fXJlLl9CbGFja1JlYWRPbmx5PXJlLkJsYWNrKCk7bGV0IG1lPWNsYXNze2NvbnN0cnVjdG9yKGU9MCx0PTAsaT0wLHM9MSl7dGhpcy5yPWUsdGhpcy5nPXQsdGhpcy5iPWksdGhpcy5hPXN9YWRkSW5QbGFjZShlKXtyZXR1cm4gdGhpcy5yKz1lLnIsdGhpcy5nKz1lLmcsdGhpcy5iKz1lLmIsdGhpcy5hKz1lLmEsdGhpc31hc0FycmF5KCl7cmV0dXJuW3RoaXMucix0aGlzLmcsdGhpcy5iLHRoaXMuYV19dG9BcnJheShlLHQ9MCl7cmV0dXJuIGVbdF09dGhpcy5yLGVbdCsxXT10aGlzLmcsZVt0KzJdPXRoaXMuYixlW3QrM109dGhpcy5hLHRoaXN9ZnJvbUFycmF5KGUsdD0wKXtyZXR1cm4gbWUuRnJvbUFycmF5VG9SZWYoZSx0LHRoaXMpLHRoaXN9ZXF1YWxzKGUpe3JldHVybiBlJiZ0aGlzLnI9PT1lLnImJnRoaXMuZz09PWUuZyYmdGhpcy5iPT09ZS5iJiZ0aGlzLmE9PT1lLmF9YWRkKGUpe3JldHVybiBuZXcgbWUodGhpcy5yK2Uucix0aGlzLmcrZS5nLHRoaXMuYitlLmIsdGhpcy5hK2UuYSl9c3VidHJhY3QoZSl7cmV0dXJuIG5ldyBtZSh0aGlzLnItZS5yLHRoaXMuZy1lLmcsdGhpcy5iLWUuYix0aGlzLmEtZS5hKX1zdWJ0cmFjdFRvUmVmKGUsdCl7cmV0dXJuIHQucj10aGlzLnItZS5yLHQuZz10aGlzLmctZS5nLHQuYj10aGlzLmItZS5iLHQuYT10aGlzLmEtZS5hLHRoaXN9c2NhbGUoZSl7cmV0dXJuIG5ldyBtZSh0aGlzLnIqZSx0aGlzLmcqZSx0aGlzLmIqZSx0aGlzLmEqZSl9c2NhbGVJblBsYWNlKGUpe3JldHVybiB0aGlzLnIqPWUsdGhpcy5nKj1lLHRoaXMuYio9ZSx0aGlzLmEqPWUsdGhpc31zY2FsZVRvUmVmKGUsdCl7cmV0dXJuIHQucj10aGlzLnIqZSx0Lmc9dGhpcy5nKmUsdC5iPXRoaXMuYiplLHQuYT10aGlzLmEqZSx0aGlzfXNjYWxlQW5kQWRkVG9SZWYoZSx0KXtyZXR1cm4gdC5yKz10aGlzLnIqZSx0LmcrPXRoaXMuZyplLHQuYis9dGhpcy5iKmUsdC5hKz10aGlzLmEqZSx0aGlzfWNsYW1wVG9SZWYoZT0wLHQ9MSxpKXtyZXR1cm4gaS5yPVguQ2xhbXAodGhpcy5yLGUsdCksaS5nPVguQ2xhbXAodGhpcy5nLGUsdCksaS5iPVguQ2xhbXAodGhpcy5iLGUsdCksaS5hPVguQ2xhbXAodGhpcy5hLGUsdCksdGhpc31tdWx0aXBseShlKXtyZXR1cm4gbmV3IG1lKHRoaXMuciplLnIsdGhpcy5nKmUuZyx0aGlzLmIqZS5iLHRoaXMuYSplLmEpfW11bHRpcGx5VG9SZWYoZSx0KXtyZXR1cm4gdC5yPXRoaXMuciplLnIsdC5nPXRoaXMuZyplLmcsdC5iPXRoaXMuYiplLmIsdC5hPXRoaXMuYSplLmEsdH10b1N0cmluZygpe3JldHVybiJ7UjogIit0aGlzLnIrIiBHOiIrdGhpcy5nKyIgQjoiK3RoaXMuYisiIEE6Iit0aGlzLmErIn0ifWdldENsYXNzTmFtZSgpe3JldHVybiJDb2xvcjQifWdldEhhc2hDb2RlKCl7bGV0IGU9dGhpcy5yKjI1NXwwO3JldHVybiBlPWUqMzk3Xih0aGlzLmcqMjU1fDApLGU9ZSozOTdeKHRoaXMuYioyNTV8MCksZT1lKjM5N14odGhpcy5hKjI1NXwwKSxlfWNsb25lKCl7cmV0dXJuIG5ldyBtZSh0aGlzLnIsdGhpcy5nLHRoaXMuYix0aGlzLmEpfWNvcHlGcm9tKGUpe3JldHVybiB0aGlzLnI9ZS5yLHRoaXMuZz1lLmcsdGhpcy5iPWUuYix0aGlzLmE9ZS5hLHRoaXN9Y29weUZyb21GbG9hdHMoZSx0LGkscyl7cmV0dXJuIHRoaXMucj1lLHRoaXMuZz10LHRoaXMuYj1pLHRoaXMuYT1zLHRoaXN9c2V0KGUsdCxpLHMpe3JldHVybiB0aGlzLmNvcHlGcm9tRmxvYXRzKGUsdCxpLHMpfXRvSGV4U3RyaW5nKGU9ITEpe2NvbnN0IHQ9TWF0aC5yb3VuZCh0aGlzLnIqMjU1KSxpPU1hdGgucm91bmQodGhpcy5nKjI1NSkscz1NYXRoLnJvdW5kKHRoaXMuYioyNTUpO2lmKGUpcmV0dXJuIiMiK1guVG9IZXgodCkrWC5Ub0hleChpKStYLlRvSGV4KHMpO2NvbnN0IHI9TWF0aC5yb3VuZCh0aGlzLmEqMjU1KTtyZXR1cm4iIyIrWC5Ub0hleCh0KStYLlRvSGV4KGkpK1guVG9IZXgocykrWC5Ub0hleChyKX10b0xpbmVhclNwYWNlKCl7Y29uc3QgZT1uZXcgbWU7cmV0dXJuIHRoaXMudG9MaW5lYXJTcGFjZVRvUmVmKGUpLGV9dG9MaW5lYXJTcGFjZVRvUmVmKGUpe3JldHVybiBlLnI9TWF0aC5wb3codGhpcy5yLHllKSxlLmc9TWF0aC5wb3codGhpcy5nLHllKSxlLmI9TWF0aC5wb3codGhpcy5iLHllKSxlLmE9dGhpcy5hLHRoaXN9dG9HYW1tYVNwYWNlKCl7Y29uc3QgZT1uZXcgbWU7cmV0dXJuIHRoaXMudG9HYW1tYVNwYWNlVG9SZWYoZSksZX10b0dhbW1hU3BhY2VUb1JlZihlKXtyZXR1cm4gZS5yPU1hdGgucG93KHRoaXMucixTZSksZS5nPU1hdGgucG93KHRoaXMuZyxTZSksZS5iPU1hdGgucG93KHRoaXMuYixTZSksZS5hPXRoaXMuYSx0aGlzfXN0YXRpYyBGcm9tSGV4U3RyaW5nKGUpe2lmKGUuc3Vic3RyaW5nKDAsMSkhPT0iIyJ8fGUubGVuZ3RoIT09OSYmZS5sZW5ndGghPT03KXJldHVybiBuZXcgbWUoMCwwLDAsMCk7Y29uc3QgdD1wYXJzZUludChlLnN1YnN0cmluZygxLDMpLDE2KSxpPXBhcnNlSW50KGUuc3Vic3RyaW5nKDMsNSksMTYpLHM9cGFyc2VJbnQoZS5zdWJzdHJpbmcoNSw3KSwxNikscj1lLmxlbmd0aD09PTk/cGFyc2VJbnQoZS5zdWJzdHJpbmcoNyw5KSwxNik6MjU1O3JldHVybiBtZS5Gcm9tSW50cyh0LGkscyxyKX1zdGF0aWMgTGVycChlLHQsaSl7Y29uc3Qgcz1uZXcgbWUoMCwwLDAsMCk7cmV0dXJuIG1lLkxlcnBUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBMZXJwVG9SZWYoZSx0LGkscyl7cy5yPWUucisodC5yLWUucikqaSxzLmc9ZS5nKyh0LmctZS5nKSppLHMuYj1lLmIrKHQuYi1lLmIpKmkscy5hPWUuYSsodC5hLWUuYSkqaX1zdGF0aWMgSGVybWl0ZShlLHQsaSxzLHIpe2NvbnN0IG49cipyLGE9cipuLG89MiphLTMqbisxLGg9LTIqYSszKm4sbD1hLTIqbityLHU9YS1uLGQ9ZS5yKm8raS5yKmgrdC5yKmwrcy5yKnUsZj1lLmcqbytpLmcqaCt0LmcqbCtzLmcqdSxfPWUuYipvK2kuYipoK3QuYipsK3MuYip1LEU9ZS5hKm8raS5hKmgrdC5hKmwrcy5hKnU7cmV0dXJuIG5ldyBtZShkLGYsXyxFKX1zdGF0aWMgSGVybWl0ZTFzdERlcml2YXRpdmUoZSx0LGkscyxyKXtjb25zdCBuPW5ldyBtZTtyZXR1cm4gdGhpcy5IZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKSxufXN0YXRpYyBIZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKXtjb25zdCBhPXIqcjtuLnI9KGEtcikqNiplLnIrKDMqYS00KnIrMSkqdC5yKygtYStyKSo2KmkucisoMyphLTIqcikqcy5yLG4uZz0oYS1yKSo2KmUuZysoMyphLTQqcisxKSp0LmcrKC1hK3IpKjYqaS5nKygzKmEtMipyKSpzLmcsbi5iPShhLXIpKjYqZS5iKygzKmEtNCpyKzEpKnQuYisoLWErcikqNippLmIrKDMqYS0yKnIpKnMuYixuLmE9KGEtcikqNiplLmErKDMqYS00KnIrMSkqdC5hKygtYStyKSo2KmkuYSsoMyphLTIqcikqcy5hfXN0YXRpYyBGcm9tQ29sb3IzKGUsdD0xKXtyZXR1cm4gbmV3IG1lKGUucixlLmcsZS5iLHQpfXN0YXRpYyBGcm9tQXJyYXkoZSx0PTApe3JldHVybiBuZXcgbWUoZVt0XSxlW3QrMV0sZVt0KzJdLGVbdCszXSl9c3RhdGljIEZyb21BcnJheVRvUmVmKGUsdD0wLGkpe2kucj1lW3RdLGkuZz1lW3QrMV0saS5iPWVbdCsyXSxpLmE9ZVt0KzNdfXN0YXRpYyBGcm9tSW50cyhlLHQsaSxzKXtyZXR1cm4gbmV3IG1lKGUvMjU1LHQvMjU1LGkvMjU1LHMvMjU1KX1zdGF0aWMgQ2hlY2tDb2xvcnM0KGUsdCl7aWYoZS5sZW5ndGg9PT10KjMpe2NvbnN0IGk9W107Zm9yKGxldCBzPTA7czxlLmxlbmd0aDtzKz0zKXtjb25zdCByPXMvMyo0O2lbcl09ZVtzXSxpW3IrMV09ZVtzKzFdLGlbcisyXT1lW3MrMl0saVtyKzNdPTF9cmV0dXJuIGl9cmV0dXJuIGV9fTtjbGFzcyBFaXt9RWkuQ29sb3IzPUJlLkJ1aWxkQXJyYXkoMyxyZS5CbGFjayksRWkuQ29sb3I0PUJlLkJ1aWxkQXJyYXkoMywoKT0+bmV3IG1lKDAsMCwwLDApKSxpdCgiQkFCWUxPTi5Db2xvcjMiLHJlKSxpdCgiQkFCWUxPTi5Db2xvcjQiLG1lKTtjb25zdCBpcj0oYyxlKT0+IWN8fGMuZ2V0Q2xhc3NOYW1lJiZjLmdldENsYXNzTmFtZSgpPT09Ik1lc2giP251bGw6Yy5nZXRDbGFzc05hbWUmJmMuZ2V0Q2xhc3NOYW1lKCk9PT0iU3ViTWVzaCI/Yy5jbG9uZShlKTpjLmNsb25lP2MuY2xvbmUoKTpudWxsO2Z1bmN0aW9uIHBuKGMpe2NvbnN0IGU9W107ZG8gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoYykuZm9yRWFjaChmdW5jdGlvbih0KXtlLmluZGV4T2YodCk9PT0tMSYmZS5wdXNoKHQpfSk7d2hpbGUoYz1PYmplY3QuZ2V0UHJvdG90eXBlT2YoYykpO3JldHVybiBlfWNsYXNzIHZze3N0YXRpYyBEZWVwQ29weShlLHQsaSxzKXtjb25zdCByPXBuKGUpO2Zvcihjb25zdCBuIG9mIHIpe2lmKG5bMF09PT0iXyImJighc3x8cy5pbmRleE9mKG4pPT09LTEpfHxuLmVuZHNXaXRoKCJPYnNlcnZhYmxlIil8fGkmJmkuaW5kZXhPZihuKSE9PS0xKWNvbnRpbnVlO2NvbnN0IGE9ZVtuXSxvPXR5cGVvZiBhO2lmKG8hPT0iZnVuY3Rpb24iKXRyeXtpZihvPT09Im9iamVjdCIpaWYoYSBpbnN0YW5jZW9mIEFycmF5KXtpZih0W25dPVtdLGEubGVuZ3RoPjApaWYodHlwZW9mIGFbMF09PSJvYmplY3QiKWZvcihsZXQgaD0wO2g8YS5sZW5ndGg7aCsrKXtjb25zdCBsPWlyKGFbaF0sdCk7dFtuXS5pbmRleE9mKGwpPT09LTEmJnRbbl0ucHVzaChsKX1lbHNlIHRbbl09YS5zbGljZSgwKX1lbHNlIHRbbl09aXIoYSx0KTtlbHNlIHRbbl09YX1jYXRjaChoKXtPLldhcm4oaC5tZXNzYWdlKX19fX1mdW5jdGlvbiBtbigpe3JldHVybiB0eXBlb2YgX25hdGl2ZTwidSImJl9uYXRpdmUuWE1MSHR0cFJlcXVlc3Q/bmV3IF9uYXRpdmUuWE1MSHR0cFJlcXVlc3Q6bmV3IFhNTEh0dHBSZXF1ZXN0fWNsYXNzIGN0e2NvbnN0cnVjdG9yKCl7dGhpcy5feGhyPW1uKCksdGhpcy5fcmVxdWVzdFVSTD0iIn1faW5qZWN0Q3VzdG9tUmVxdWVzdEhlYWRlcnMoKXtpZighdGhpcy5fc2hvdWxkU2tpcFJlcXVlc3RNb2RpZmljYXRpb25zKHRoaXMuX3JlcXVlc3RVUkwpKWZvcihjb25zdCBlIGluIGN0LkN1c3RvbVJlcXVlc3RIZWFkZXJzKXtjb25zdCB0PWN0LkN1c3RvbVJlcXVlc3RIZWFkZXJzW2VdO3QmJnRoaXMuX3hoci5zZXRSZXF1ZXN0SGVhZGVyKGUsdCl9fV9zaG91bGRTa2lwUmVxdWVzdE1vZGlmaWNhdGlvbnMoZSl7cmV0dXJuIGN0LlNraXBSZXF1ZXN0TW9kaWZpY2F0aW9uRm9yQmFieWxvbkNETiYmKGUuaW5jbHVkZXMoInByZXZpZXcuYmFieWxvbmpzLmNvbSIpfHxlLmluY2x1ZGVzKCJjZG4uYmFieWxvbmpzLmNvbSIpKX1nZXQgb25wcm9ncmVzcygpe3JldHVybiB0aGlzLl94aHIub25wcm9ncmVzc31zZXQgb25wcm9ncmVzcyhlKXt0aGlzLl94aHIub25wcm9ncmVzcz1lfWdldCByZWFkeVN0YXRlKCl7cmV0dXJuIHRoaXMuX3hoci5yZWFkeVN0YXRlfWdldCBzdGF0dXMoKXtyZXR1cm4gdGhpcy5feGhyLnN0YXR1c31nZXQgc3RhdHVzVGV4dCgpe3JldHVybiB0aGlzLl94aHIuc3RhdHVzVGV4dH1nZXQgcmVzcG9uc2UoKXtyZXR1cm4gdGhpcy5feGhyLnJlc3BvbnNlfWdldCByZXNwb25zZVVSTCgpe3JldHVybiB0aGlzLl94aHIucmVzcG9uc2VVUkx9Z2V0IHJlc3BvbnNlVGV4dCgpe3JldHVybiB0aGlzLl94aHIucmVzcG9uc2VUZXh0fWdldCByZXNwb25zZVR5cGUoKXtyZXR1cm4gdGhpcy5feGhyLnJlc3BvbnNlVHlwZX1zZXQgcmVzcG9uc2VUeXBlKGUpe3RoaXMuX3hoci5yZXNwb25zZVR5cGU9ZX1nZXQgdGltZW91dCgpe3JldHVybiB0aGlzLl94aHIudGltZW91dH1zZXQgdGltZW91dChlKXt0aGlzLl94aHIudGltZW91dD1lfWFkZEV2ZW50TGlzdGVuZXIoZSx0LGkpe3RoaXMuX3hoci5hZGRFdmVudExpc3RlbmVyKGUsdCxpKX1yZW1vdmVFdmVudExpc3RlbmVyKGUsdCxpKXt0aGlzLl94aHIucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLHQsaSl9YWJvcnQoKXt0aGlzLl94aHIuYWJvcnQoKX1zZW5kKGUpe2N0LkN1c3RvbVJlcXVlc3RIZWFkZXJzJiZ0aGlzLl9pbmplY3RDdXN0b21SZXF1ZXN0SGVhZGVycygpLHRoaXMuX3hoci5zZW5kKGUpfW9wZW4oZSx0KXtmb3IoY29uc3QgaSBvZiBjdC5DdXN0b21SZXF1ZXN0TW9kaWZpZXJzKXtpZih0aGlzLl9zaG91bGRTa2lwUmVxdWVzdE1vZGlmaWNhdGlvbnModCkpcmV0dXJuO2kodGhpcy5feGhyLHQpfXJldHVybiB0PXQucmVwbGFjZSgiZmlsZTpodHRwOiIsImh0dHA6IiksdD10LnJlcGxhY2UoImZpbGU6aHR0cHM6IiwiaHR0cHM6IiksdGhpcy5fcmVxdWVzdFVSTD10LHRoaXMuX3hoci5vcGVuKGUsdCwhMCl9c2V0UmVxdWVzdEhlYWRlcihlLHQpe3RoaXMuX3hoci5zZXRSZXF1ZXN0SGVhZGVyKGUsdCl9Z2V0UmVzcG9uc2VIZWFkZXIoZSl7cmV0dXJuIHRoaXMuX3hoci5nZXRSZXNwb25zZUhlYWRlcihlKX19Y3QuQ3VzdG9tUmVxdWVzdEhlYWRlcnM9e30sY3QuQ3VzdG9tUmVxdWVzdE1vZGlmaWVycz1uZXcgQXJyYXksY3QuU2tpcFJlcXVlc3RNb2RpZmljYXRpb25Gb3JCYWJ5bG9uQ0ROPSEwO2NsYXNzIEZpe31GaS5GaWxlc1RvTG9hZD17fTtjbGFzcyBFbntzdGF0aWMgRXhwb25lbnRpYWxCYWNrb2ZmKGU9Myx0PTUwMCl7cmV0dXJuKGkscyxyKT0+cy5zdGF0dXMhPT0wfHxyPj1lfHxpLmluZGV4T2YoImZpbGU6IikhPT0tMT8tMTpNYXRoLnBvdygyLHIpKnR9fWNsYXNzIHZpIGV4dGVuZHMgRXJyb3J7fXZpLl9zZXRQcm90b3R5cGVPZj1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fCgoYyxlKT0+KGMuX19wcm90b19fPWUsYykpO2NvbnN0IG9pPXtNZXNoSW52YWxpZFBvc2l0aW9uc0Vycm9yOjAsVW5zdXBwb3J0ZWRUZXh0dXJlRXJyb3I6MWUzLEdMVEZMb2FkZXJVbmV4cGVjdGVkTWFnaWNFcnJvcjoyZTMsU2NlbmVMb2FkZXJFcnJvcjozZTMsTG9hZEZpbGVFcnJvcjo0ZTMsUmVxdWVzdEZpbGVFcnJvcjo0MDAxLFJlYWRGaWxlRXJyb3I6NDAwMn07Y2xhc3MgTnQgZXh0ZW5kcyB2aXtjb25zdHJ1Y3RvcihlLHQsaSl7c3VwZXIoZSksdGhpcy5lcnJvckNvZGU9dCx0aGlzLmlubmVyRXJyb3I9aSx0aGlzLm5hbWU9IlJ1bnRpbWVFcnJvciIsdmkuX3NldFByb3RvdHlwZU9mKHRoaXMsTnQucHJvdG90eXBlKX19Y29uc3Qgc3I9Yz0+e2NvbnN0IGU9IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89IjtsZXQgdD0iIixpLHMscixuLGEsbyxoLGw9MDtjb25zdCB1PUFycmF5QnVmZmVyLmlzVmlldyhjKT9uZXcgVWludDhBcnJheShjLmJ1ZmZlcixjLmJ5dGVPZmZzZXQsYy5ieXRlTGVuZ3RoKTpuZXcgVWludDhBcnJheShjKTtmb3IoO2w8dS5sZW5ndGg7KWk9dVtsKytdLHM9bDx1Lmxlbmd0aD91W2wrK106TnVtYmVyLk5hTixyPWw8dS5sZW5ndGg/dVtsKytdOk51bWJlci5OYU4sbj1pPj4yLGE9KGkmMyk8PDR8cz4+NCxvPShzJjE1KTw8MnxyPj42LGg9ciY2Myxpc05hTihzKT9vPWg9NjQ6aXNOYU4ocikmJihoPTY0KSx0Kz1lLmNoYXJBdChuKStlLmNoYXJBdChhKStlLmNoYXJBdChvKStlLmNoYXJBdChoKTtyZXR1cm4gdH0scnI9Yz0+YXRvYihjKSx2bj1jPT57Y29uc3QgZT1ycihjKSx0PWUubGVuZ3RoLGk9bmV3IFVpbnQ4QXJyYXkobmV3IEFycmF5QnVmZmVyKHQpKTtmb3IobGV0IHM9MDtzPHQ7cysrKWlbc109ZS5jaGFyQ29kZUF0KHMpO3JldHVybiBpLmJ1ZmZlcn07Y2xhc3MgWGl7c3RhdGljIFNldEltbWVkaWF0ZShlKXtqZSgpJiZ3aW5kb3cuc2V0SW1tZWRpYXRlP3dpbmRvdy5zZXRJbW1lZGlhdGUoZSk6c2V0VGltZW91dChlLDEpfX1jb25zdCBucj1uZXcgUmVnRXhwKC9eZGF0YTooW14sXStcL1teLF0rKT87YmFzZTY0LC9pKTtjbGFzcyBIaSBleHRlbmRzIE50e2NvbnN0cnVjdG9yKGUsdCl7c3VwZXIoZSxvaS5Mb2FkRmlsZUVycm9yKSx0aGlzLm5hbWU9IkxvYWRGaWxlRXJyb3IiLHZpLl9zZXRQcm90b3R5cGVPZih0aGlzLEhpLnByb3RvdHlwZSksdCBpbnN0YW5jZW9mIGN0P3RoaXMucmVxdWVzdD10OnRoaXMuZmlsZT10fX1jbGFzcyBLaSBleHRlbmRzIE50e2NvbnN0cnVjdG9yKGUsdCl7c3VwZXIoZSxvaS5SZXF1ZXN0RmlsZUVycm9yKSx0aGlzLnJlcXVlc3Q9dCx0aGlzLm5hbWU9IlJlcXVlc3RGaWxlRXJyb3IiLHZpLl9zZXRQcm90b3R5cGVPZih0aGlzLEtpLnByb3RvdHlwZSl9fWNsYXNzIFRzIGV4dGVuZHMgTnR7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLG9pLlJlYWRGaWxlRXJyb3IpLHRoaXMuZmlsZT10LHRoaXMubmFtZT0iUmVhZEZpbGVFcnJvciIsdmkuX3NldFByb3RvdHlwZU9mKHRoaXMsVHMucHJvdG90eXBlKX19Y29uc3QgcWU9e0RlZmF1bHRSZXRyeVN0cmF0ZWd5OkVuLkV4cG9uZW50aWFsQmFja29mZigpLEJhc2VVcmw6IiIsQ29yc0JlaGF2aW9yOiJhbm9ueW1vdXMiLFByZXByb2Nlc3NVcmw6Yz0+Y30sYXI9Yz0+KGM9Yy5yZXBsYWNlKC8jL2dtLCIlMjMiKSxjKSxicz0oYyxlKT0+e2lmKCEoYyYmYy5pbmRleE9mKCJkYXRhOiIpPT09MCkmJnFlLkNvcnNCZWhhdmlvcilpZih0eXBlb2YgcWUuQ29yc0JlaGF2aW9yPT0ic3RyaW5nInx8cWUuQ29yc0JlaGF2aW9yIGluc3RhbmNlb2YgU3RyaW5nKWUuY3Jvc3NPcmlnaW49cWUuQ29yc0JlaGF2aW9yO2Vsc2V7Y29uc3QgdD1xZS5Db3JzQmVoYXZpb3IoYyk7dCYmKGUuY3Jvc3NPcmlnaW49dCl9fSxTcz0oYyxlLHQsaSxzPSIiLHIpPT57dmFyIG47bGV0IGEsbz0hMTtjIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ8fEFycmF5QnVmZmVyLmlzVmlldyhjKT90eXBlb2YgQmxvYjwidSImJnR5cGVvZiBVUkw8InUiPyhhPVVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW2NdLHt0eXBlOnN9KSksbz0hMCk6YT1gZGF0YToke3N9O2Jhc2U2NCxgK3NyKGMpOmMgaW5zdGFuY2VvZiBCbG9iPyhhPVVSTC5jcmVhdGVPYmplY3RVUkwoYyksbz0hMCk6KGE9YXIoYyksYT1xZS5QcmVwcm9jZXNzVXJsKGMpKTtjb25zdCBoPWZlLkxhc3RDcmVhdGVkRW5naW5lLGw9Yj0+e2lmKHQpe2NvbnN0IE09YXx8Yy50b1N0cmluZygpO3QoYEVycm9yIHdoaWxlIHRyeWluZyB0byBsb2FkIGltYWdlOiAke00uaW5kZXhPZigiaHR0cCIpPT09MHx8TS5sZW5ndGg8PTEyOD9NOk0uc2xpY2UoMCwxMjgpKyIuLi4ifWAsYil9fTtpZih0eXBlb2YgSW1hZ2U+InUifHwobj1oPT1udWxsP3ZvaWQgMDpoLl9mZWF0dXJlcy5mb3JjZUJpdG1hcE92ZXJIVE1MSW1hZ2VFbGVtZW50KSE9PW51bGwmJm4hPT12b2lkIDAmJm4pcmV0dXJuIGp0KGEsYj0+e2guY3JlYXRlSW1hZ2VCaXRtYXAobmV3IEJsb2IoW2JdLHt0eXBlOnN9KSx7cHJlbXVsdGlwbHlBbHBoYToibm9uZSIsLi4ucn0pLnRoZW4oTT0+e2UoTSksbyYmVVJMLnJldm9rZU9iamVjdFVSTChhKX0pLmNhdGNoKE09Pnt0JiZ0KCJFcnJvciB3aGlsZSB0cnlpbmcgdG8gbG9hZCBpbWFnZTogIitjLE0pfSl9LHZvaWQgMCxpfHx2b2lkIDAsITAsKGIsTSk9PntsKE0pfSksbnVsbDtjb25zdCB1PW5ldyBJbWFnZTticyhhLHUpO2NvbnN0IGQ9W10sZj0oKT0+e2QuZm9yRWFjaChiPT57Yi50YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihiLm5hbWUsYi5oYW5kbGVyKX0pfSxfPSgpPT57ZC5mb3JFYWNoKGI9PntiLnRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKGIubmFtZSxiLmhhbmRsZXIpfSksZC5sZW5ndGg9MH0sRT0oKT0+e18oKSxlKHUpLG8mJnUuc3JjJiZVUkwucmV2b2tlT2JqZWN0VVJMKHUuc3JjKX0sbT1iPT57XygpLGwoYiksbyYmdS5zcmMmJlVSTC5yZXZva2VPYmplY3RVUkwodS5zcmMpfSx2PWI9PntfKCk7Y29uc3QgTT1uZXcgRXJyb3IoYENTUCB2aW9sYXRpb24gb2YgcG9saWN5ICR7Yi5lZmZlY3RpdmVEaXJlY3RpdmV9ICR7Yi5ibG9ja2VkVVJJfS4gQ3VycmVudCBwb2xpY3kgaXMgJHtiLm9yaWdpbmFsUG9saWN5fWApO2ZlLlVzZUZhbGxiYWNrVGV4dHVyZT0hMSxsKE0pLG8mJnUuc3JjJiZVUkwucmV2b2tlT2JqZWN0VVJMKHUuc3JjKSx1LnNyYz0iIn07ZC5wdXNoKHt0YXJnZXQ6dSxuYW1lOiJsb2FkIixoYW5kbGVyOkV9KSxkLnB1c2goe3RhcmdldDp1LG5hbWU6ImVycm9yIixoYW5kbGVyOm19KSxkLnB1c2goe3RhcmdldDpkb2N1bWVudCxuYW1lOiJzZWN1cml0eXBvbGljeXZpb2xhdGlvbiIsaGFuZGxlcjp2fSksZigpO2NvbnN0IFM9YS5zdWJzdHJpbmcoMCw1KT09PSJibG9iOiIseT1hLnN1YnN0cmluZygwLDUpPT09ImRhdGE6IixBPSgpPT57U3x8eT91LnNyYz1hOmp0KGEsKGIsTSxMKT0+e2NvbnN0IGs9IXMmJkw/TDpzLHc9bmV3IEJsb2IoW2JdLHt0eXBlOmt9KSxkZT1VUkwuY3JlYXRlT2JqZWN0VVJMKHcpO289ITAsdS5zcmM9ZGV9LHZvaWQgMCxpfHx2b2lkIDAsITAsKGIsTSk9PntsKE0pfSl9LEM9KCk9PntpJiZpLmxvYWRJbWFnZShhLHUpfTtpZighUyYmIXkmJmkmJmkuZW5hYmxlVGV4dHVyZXNPZmZsaW5lKWkub3BlbihDLEEpO2Vsc2V7aWYoYS5pbmRleE9mKCJmaWxlOiIpIT09LTEpe2NvbnN0IGI9ZGVjb2RlVVJJQ29tcG9uZW50KGEuc3Vic3RyaW5nKDUpLnRvTG93ZXJDYXNlKCkpO2lmKEZpLkZpbGVzVG9Mb2FkW2JdJiZ0eXBlb2YgVVJMPCJ1Iil7dHJ5e2xldCBNO3RyeXtNPVVSTC5jcmVhdGVPYmplY3RVUkwoRmkuRmlsZXNUb0xvYWRbYl0pfWNhdGNoe009VVJMLmNyZWF0ZU9iamVjdFVSTChGaS5GaWxlc1RvTG9hZFtiXSl9dS5zcmM9TSxvPSEwfWNhdGNoe3Uuc3JjPSIifXJldHVybiB1fX1BKCl9cmV0dXJuIHV9LHdpPShjLGUsdCxpLHMpPT57Y29uc3Qgcj1uZXcgRmlsZVJlYWRlcixuPXtvbkNvbXBsZXRlT2JzZXJ2YWJsZTpuZXcgRixhYm9ydDooKT0+ci5hYm9ydCgpfTtyZXR1cm4gci5vbmxvYWRlbmQ9KCk9Pm4ub25Db21wbGV0ZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKG4pLHMmJihyLm9uZXJyb3I9KCk9PntzKG5ldyBUcyhgVW5hYmxlIHRvIHJlYWQgJHtjLm5hbWV9YCxjKSl9KSxyLm9ubG9hZD1hPT57ZShhLnRhcmdldC5yZXN1bHQpfSx0JiYoci5vbnByb2dyZXNzPXQpLGk/ci5yZWFkQXNBcnJheUJ1ZmZlcihjKTpyLnJlYWRBc1RleHQoYyksbn0sanQ9KGMsZSx0LGkscyxyLG4pPT57aWYoYy5uYW1lKXJldHVybiB3aShjLGUsdCxzLHI/bD0+e3Iodm9pZCAwLGwpfTp2b2lkIDApO2NvbnN0IGE9YztpZihhLmluZGV4T2YoImZpbGU6IikhPT0tMSl7bGV0IGw9ZGVjb2RlVVJJQ29tcG9uZW50KGEuc3Vic3RyaW5nKDUpLnRvTG93ZXJDYXNlKCkpO2wuaW5kZXhPZigiLi8iKT09PTAmJihsPWwuc3Vic3RyaW5nKDIpKTtjb25zdCB1PUZpLkZpbGVzVG9Mb2FkW2xdO2lmKHUpcmV0dXJuIHdpKHUsZSx0LHMscj9kPT5yKHZvaWQgMCxuZXcgSGkoZC5tZXNzYWdlLGQuZmlsZSkpOnZvaWQgMCl9Y29uc3R7bWF0Y2g6byx0eXBlOmh9PVRuKGEpO2lmKG8pe2NvbnN0IGw9e29uQ29tcGxldGVPYnNlcnZhYmxlOm5ldyBGLGFib3J0OigpPT4oKT0+e319O3RyeXtjb25zdCB1PXM/QXMoYSk6aHIoYSk7ZSh1LHZvaWQgMCxoKX1jYXRjaCh1KXtyP3Iodm9pZCAwLHUpOk8uRXJyb3IodS5tZXNzYWdlfHwiRmFpbGVkIHRvIHBhcnNlIHRoZSBEYXRhIFVSTCIpfXJldHVybiBYaS5TZXRJbW1lZGlhdGUoKCk9PntsLm9uQ29tcGxldGVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhsKX0pLGx9cmV0dXJuIHhzKGEsKGwsdSk9PntlKGwsdT09bnVsbD92b2lkIDA6dS5yZXNwb25zZVVSTCx1PT1udWxsP3ZvaWQgMDp1LmdldFJlc3BvbnNlSGVhZGVyKCJjb250ZW50LXR5cGUiKSl9LHQsaSxzLHI/bD0+e3IobC5yZXF1ZXN0LG5ldyBIaShsLm1lc3NhZ2UsbC5yZXF1ZXN0KSl9OnZvaWQgMCxuKX0seHM9KGMsZSx0LGkscyxyLG4pPT57Yz1hcihjKSxjPXFlLlByZXByb2Nlc3NVcmwoYyk7Y29uc3QgYT1xZS5CYXNlVXJsK2M7bGV0IG89ITE7Y29uc3QgaD17b25Db21wbGV0ZU9ic2VydmFibGU6bmV3IEYsYWJvcnQ6KCk9Pm89ITB9LGw9KCk9PntsZXQgdT1uZXcgY3QsZD1udWxsLGY7Y29uc3QgXz0oKT0+e3UmJih0JiZ1LnJlbW92ZUV2ZW50TGlzdGVuZXIoInByb2dyZXNzIix0KSxmJiZ1LnJlbW92ZUV2ZW50TGlzdGVuZXIoInJlYWR5c3RhdGVjaGFuZ2UiLGYpLHUucmVtb3ZlRXZlbnRMaXN0ZW5lcigibG9hZGVuZCIsRSkpfTtsZXQgRT0oKT0+e18oKSxoLm9uQ29tcGxldGVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhoKSxoLm9uQ29tcGxldGVPYnNlcnZhYmxlLmNsZWFyKCksdD12b2lkIDAsZj1udWxsLEU9bnVsbCxyPXZvaWQgMCxuPXZvaWQgMCxlPXZvaWQgMH07aC5hYm9ydD0oKT0+e289ITAsRSYmRSgpLHUmJnUucmVhZHlTdGF0ZSE9PShYTUxIdHRwUmVxdWVzdC5ET05FfHw0KSYmdS5hYm9ydCgpLGQhPT1udWxsJiYoY2xlYXJUaW1lb3V0KGQpLGQ9bnVsbCksdT1udWxsfTtjb25zdCBtPVM9Pntjb25zdCB5PVMubWVzc2FnZXx8IlVua25vd24gZXJyb3IiO3ImJnU/cihuZXcgS2koeSx1KSk6Ty5FcnJvcih5KX0sdj1TPT57aWYodSl7aWYodS5vcGVuKCJHRVQiLGEpLG4pdHJ5e24odSl9Y2F0Y2goeSl7bSh5KTtyZXR1cm59cyYmKHUucmVzcG9uc2VUeXBlPSJhcnJheWJ1ZmZlciIpLHQmJnUuYWRkRXZlbnRMaXN0ZW5lcigicHJvZ3Jlc3MiLHQpLEUmJnUuYWRkRXZlbnRMaXN0ZW5lcigibG9hZGVuZCIsRSksZj0oKT0+e2lmKCEob3x8IXUpJiZ1LnJlYWR5U3RhdGU9PT0oWE1MSHR0cFJlcXVlc3QuRE9ORXx8NCkpe2lmKGYmJnUucmVtb3ZlRXZlbnRMaXN0ZW5lcigicmVhZHlzdGF0ZWNoYW5nZSIsZiksdS5zdGF0dXM+PTIwMCYmdS5zdGF0dXM8MzAwfHx1LnN0YXR1cz09PTAmJighamUoKXx8b3IoKSkpe3RyeXtlJiZlKHM/dS5yZXNwb25zZTp1LnJlc3BvbnNlVGV4dCx1KX1jYXRjaChDKXttKEMpfXJldHVybn1jb25zdCB5PXFlLkRlZmF1bHRSZXRyeVN0cmF0ZWd5O2lmKHkpe2NvbnN0IEM9eShhLHUsUyk7aWYoQyE9PS0xKXtfKCksdT1uZXcgY3QsZD1zZXRUaW1lb3V0KCgpPT52KFMrMSksQyk7cmV0dXJufX1jb25zdCBBPW5ldyBLaSgiRXJyb3Igc3RhdHVzOiAiK3Uuc3RhdHVzKyIgIit1LnN0YXR1c1RleHQrIiAtIFVuYWJsZSB0byBsb2FkICIrYSx1KTtyJiZyKEEpfX0sdS5hZGRFdmVudExpc3RlbmVyKCJyZWFkeXN0YXRlY2hhbmdlIixmKSx1LnNlbmQoKX19O3YoMCl9O2lmKGkmJmkuZW5hYmxlU2NlbmVPZmZsaW5lKXtjb25zdCB1PWY9PntmJiZmLnN0YXR1cz40MDA/ciYmcihmKTpsKCl9LGQ9KCk9PntpJiZpLmxvYWRGaWxlKHFlLkJhc2VVcmwrYyxmPT57IW8mJmUmJmUoZiksaC5vbkNvbXBsZXRlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoaCl9LHQ/Zj0+eyFvJiZ0JiZ0KGYpfTp2b2lkIDAsdSxzKX07aS5vcGVuKGQsdSl9ZWxzZSBsKCk7cmV0dXJuIGh9LG9yPSgpPT50eXBlb2YgbG9jYXRpb248InUiJiZsb2NhdGlvbi5wcm90b2NvbD09PSJmaWxlOiIsTXM9Yz0+bnIudGVzdChjKSxUbj1jPT57Y29uc3QgZT1uci5leGVjKGMpO3JldHVybiBlPT09bnVsbHx8ZS5sZW5ndGg9PT0wP3ttYXRjaDohMSx0eXBlOiIifTp7bWF0Y2g6ITAsdHlwZTplWzBdLnJlcGxhY2UoImRhdGE6IiwiIikucmVwbGFjZSgiYmFzZTY0LCIsIiIpfX07ZnVuY3Rpb24gQXMoYyl7cmV0dXJuIHZuKGMuc3BsaXQoIiwiKVsxXSl9Y29uc3QgaHI9Yz0+cnIoYy5zcGxpdCgiLCIpWzFdKTsoKCk9PntvZS5fRmlsZVRvb2xzTG9hZEltYWdlPVNzLG9lLl9GaWxlVG9vbHNMb2FkRmlsZT1qdCxuaS5fRmlsZVRvb2xzTG9hZEZpbGU9anR9KSgpO2xldCBPaTsoKGMsZSx0LGkscyxyLG4sYSxvLGgpPT57T2k9e0RlY29kZUJhc2U2NFVybFRvQmluYXJ5OmMsRGVjb2RlQmFzZTY0VXJsVG9TdHJpbmc6ZSxEZWZhdWx0UmV0cnlTdHJhdGVneTp0LkRlZmF1bHRSZXRyeVN0cmF0ZWd5LEJhc2VVcmw6dC5CYXNlVXJsLENvcnNCZWhhdmlvcjp0LkNvcnNCZWhhdmlvcixQcmVwcm9jZXNzVXJsOnQuUHJlcHJvY2Vzc1VybCxJc0Jhc2U2NERhdGFVcmw6aSxJc0ZpbGVVUkw6cyxMb2FkRmlsZTpyLExvYWRJbWFnZTpuLFJlYWRGaWxlOmEsUmVxdWVzdEZpbGU6byxTZXRDb3JzQmVoYXZpb3I6aH0sT2JqZWN0LmRlZmluZVByb3BlcnR5KE9pLCJEZWZhdWx0UmV0cnlTdHJhdGVneSIse2dldDpmdW5jdGlvbigpe3JldHVybiB0LkRlZmF1bHRSZXRyeVN0cmF0ZWd5fSxzZXQ6ZnVuY3Rpb24obCl7dC5EZWZhdWx0UmV0cnlTdHJhdGVneT1sfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPaSwiQmFzZVVybCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0LkJhc2VVcmx9LHNldDpmdW5jdGlvbihsKXt0LkJhc2VVcmw9bH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoT2ksIlByZXByb2Nlc3NVcmwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5QcmVwcm9jZXNzVXJsfSxzZXQ6ZnVuY3Rpb24obCl7dC5QcmVwcm9jZXNzVXJsPWx9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KE9pLCJDb3JzQmVoYXZpb3IiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5Db3JzQmVoYXZpb3J9LHNldDpmdW5jdGlvbihsKXt0LkNvcnNCZWhhdmlvcj1sfX0pfSkoQXMsaHIscWUsTXMsb3IsanQsU3Msd2kseHMsYnMpO2NsYXNzIExpe3N0YXRpYyBJbnN0YW50aWF0ZShlKXtpZih0aGlzLlJlZ2lzdGVyZWRFeHRlcm5hbENsYXNzZXMmJnRoaXMuUmVnaXN0ZXJlZEV4dGVybmFsQ2xhc3Nlc1tlXSlyZXR1cm4gdGhpcy5SZWdpc3RlcmVkRXh0ZXJuYWxDbGFzc2VzW2VdO2NvbnN0IHQ9cmkoZSk7aWYodClyZXR1cm4gdDtPLldhcm4oZSsiIG5vdCBmb3VuZCwgeW91IG1heSBoYXZlIG1pc3NlZCBhbiBpbXBvcnQuIik7Y29uc3QgaT1lLnNwbGl0KCIuIik7bGV0IHM9d2luZG93fHx0aGlzO2ZvcihsZXQgcj0wLG49aS5sZW5ndGg7cjxuO3IrKylzPXNbaVtyXV07cmV0dXJuIHR5cGVvZiBzIT0iZnVuY3Rpb24iP251bGw6c319TGkuUmVnaXN0ZXJlZEV4dGVybmFsQ2xhc3Nlcz17fTtmdW5jdGlvbiBscigpe3JldHVybiJ4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgiLnJlcGxhY2UoL1t4eV0vZyxjPT57Y29uc3QgZT1NYXRoLnJhbmRvbSgpKjE2fDA7cmV0dXJuKGM9PT0ieCI/ZTplJjN8OCkudG9TdHJpbmcoMTYpfSl9Y2xhc3MgSHtzdGF0aWMgZ2V0IEJhc2VVcmwoKXtyZXR1cm4gcWUuQmFzZVVybH1zdGF0aWMgc2V0IEJhc2VVcmwoZSl7cWUuQmFzZVVybD1lfXN0YXRpYyBnZXQgRGVmYXVsdFJldHJ5U3RyYXRlZ3koKXtyZXR1cm4gcWUuRGVmYXVsdFJldHJ5U3RyYXRlZ3l9c3RhdGljIHNldCBEZWZhdWx0UmV0cnlTdHJhdGVneShlKXtxZS5EZWZhdWx0UmV0cnlTdHJhdGVneT1lfXN0YXRpYyBnZXQgQ29yc0JlaGF2aW9yKCl7cmV0dXJuIHFlLkNvcnNCZWhhdmlvcn1zdGF0aWMgc2V0IENvcnNCZWhhdmlvcihlKXtxZS5Db3JzQmVoYXZpb3I9ZX1zdGF0aWMgZ2V0IFVzZUZhbGxiYWNrVGV4dHVyZSgpe3JldHVybiBmZS5Vc2VGYWxsYmFja1RleHR1cmV9c3RhdGljIHNldCBVc2VGYWxsYmFja1RleHR1cmUoZSl7ZmUuVXNlRmFsbGJhY2tUZXh0dXJlPWV9c3RhdGljIGdldCBSZWdpc3RlcmVkRXh0ZXJuYWxDbGFzc2VzKCl7cmV0dXJuIExpLlJlZ2lzdGVyZWRFeHRlcm5hbENsYXNzZXN9c3RhdGljIHNldCBSZWdpc3RlcmVkRXh0ZXJuYWxDbGFzc2VzKGUpe0xpLlJlZ2lzdGVyZWRFeHRlcm5hbENsYXNzZXM9ZX1zdGF0aWMgZ2V0IGZhbGxiYWNrVGV4dHVyZSgpe3JldHVybiBmZS5GYWxsYmFja1RleHR1cmV9c3RhdGljIHNldCBmYWxsYmFja1RleHR1cmUoZSl7ZmUuRmFsbGJhY2tUZXh0dXJlPWV9c3RhdGljIEZldGNoVG9SZWYoZSx0LGkscyxyLG4pe2NvbnN0IGE9TWF0aC5hYnMoZSkqaSVpfDAsbz1NYXRoLmFicyh0KSpzJXN8MCxoPShhK28qaSkqNDtuLnI9cltoXS8yNTUsbi5nPXJbaCsxXS8yNTUsbi5iPXJbaCsyXS8yNTUsbi5hPXJbaCszXS8yNTV9c3RhdGljIE1peChlLHQsaSl7cmV0dXJuIGUqKDEtaSkrdCppfXN0YXRpYyBJbnN0YW50aWF0ZShlKXtyZXR1cm4gTGkuSW5zdGFudGlhdGUoZSl9c3RhdGljIFNldEltbWVkaWF0ZShlKXtYaS5TZXRJbW1lZGlhdGUoZSl9c3RhdGljIElzRXhwb25lbnRPZlR3byhlKXtsZXQgdD0xO2RvIHQqPTI7d2hpbGUodDxlKTtyZXR1cm4gdD09PWV9c3RhdGljIEZsb2F0Um91bmQoZSl7cmV0dXJuIE1hdGguZnJvdW5kP01hdGguZnJvdW5kKGUpOihILl9UbXBGbG9hdEFycmF5WzBdPWUsSC5fVG1wRmxvYXRBcnJheVswXSl9c3RhdGljIEdldEZpbGVuYW1lKGUpe2NvbnN0IHQ9ZS5sYXN0SW5kZXhPZigiLyIpO3JldHVybiB0PDA/ZTplLnN1YnN0cmluZyh0KzEpfXN0YXRpYyBHZXRGb2xkZXJQYXRoKGUsdD0hMSl7Y29uc3QgaT1lLmxhc3RJbmRleE9mKCIvIik7cmV0dXJuIGk8MD90P2U6IiI6ZS5zdWJzdHJpbmcoMCxpKzEpfXN0YXRpYyBUb0RlZ3JlZXMoZSl7cmV0dXJuIGUqMTgwL01hdGguUEl9c3RhdGljIFRvUmFkaWFucyhlKXtyZXR1cm4gZSpNYXRoLlBJLzE4MH1zdGF0aWMgU21vb3RoQW5nbGVDaGFuZ2UoZSx0LGk9Ljkpe2NvbnN0IHM9dGhpcy5Ub1JhZGlhbnMoZSkscj10aGlzLlRvUmFkaWFucyh0KTtyZXR1cm4gdGhpcy5Ub0RlZ3JlZXMoTWF0aC5hdGFuMigoMS1pKSpNYXRoLnNpbihyKStpKk1hdGguc2luKHMpLCgxLWkpKk1hdGguY29zKHIpK2kqTWF0aC5jb3MocykpKX1zdGF0aWMgTWFrZUFycmF5KGUsdCl7cmV0dXJuIHQhPT0hMCYmKGU9PT12b2lkIDB8fGU9PW51bGwpP251bGw6QXJyYXkuaXNBcnJheShlKT9lOltlXX1zdGF0aWMgR2V0UG9pbnRlclByZWZpeChlKXtsZXQgdD0icG9pbnRlciI7cmV0dXJuIGplKCkmJiF3aW5kb3cuUG9pbnRlckV2ZW50JiYodD0ibW91c2UiKSxlLl9iYWREZXNrdG9wT1MmJiFlLl9iYWRPUyYmIShkb2N1bWVudCYmIm9udG91Y2hlbmQiaW4gZG9jdW1lbnQpJiYodD0ibW91c2UiKSx0fXN0YXRpYyBTZXRDb3JzQmVoYXZpb3IoZSx0KXticyhlLHQpfXN0YXRpYyBTZXRSZWZlcnJlclBvbGljeUJlaGF2aW9yKGUsdCl7dC5yZWZlcnJlclBvbGljeT1lfXN0YXRpYyBDbGVhblVybChlKXtyZXR1cm4gZT1lLnJlcGxhY2UoLyMvZ20sIiUyMyIpLGV9c3RhdGljIGdldCBQcmVwcm9jZXNzVXJsKCl7cmV0dXJuIHFlLlByZXByb2Nlc3NVcmx9c3RhdGljIHNldCBQcmVwcm9jZXNzVXJsKGUpe3FlLlByZXByb2Nlc3NVcmw9ZX1zdGF0aWMgTG9hZEltYWdlKGUsdCxpLHMscixuKXtyZXR1cm4gU3MoZSx0LGkscyxyLG4pfXN0YXRpYyBMb2FkRmlsZShlLHQsaSxzLHIsbil7cmV0dXJuIGp0KGUsdCxpLHMscixuKX1zdGF0aWMgTG9hZEZpbGVBc3luYyhlLHQ9ITApe3JldHVybiBuZXcgUHJvbWlzZSgoaSxzKT0+e2p0KGUscj0+e2kocil9LHZvaWQgMCx2b2lkIDAsdCwocixuKT0+e3Mobil9KX0pfXN0YXRpYyBMb2FkU2NyaXB0KGUsdCxpLHMpe2lmKHR5cGVvZiBpbXBvcnRTY3JpcHRzPT0iZnVuY3Rpb24iKXt0cnl7aW1wb3J0U2NyaXB0cyhlKSx0KCl9Y2F0Y2goYSl7aT09bnVsbHx8aShgVW5hYmxlIHRvIGxvYWQgc2NyaXB0ICcke2V9JyBpbiB3b3JrZXJgLGEpfXJldHVybn1lbHNlIGlmKCFqZSgpKXtpPT1udWxsfHxpKGBDYW5ub3QgbG9hZCBzY3JpcHQgJyR7ZX0nIG91dHNpZGUgb2YgYSB3aW5kb3cgb3IgYSB3b3JrZXJgKTtyZXR1cm59Y29uc3Qgcj1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdLG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7bi5zZXRBdHRyaWJ1dGUoInR5cGUiLCJ0ZXh0L2phdmFzY3JpcHQiKSxuLnNldEF0dHJpYnV0ZSgic3JjIixlKSxzJiYobi5pZD1zKSxuLm9ubG9hZD0oKT0+e3QmJnQoKX0sbi5vbmVycm9yPWE9PntpJiZpKGBVbmFibGUgdG8gbG9hZCBzY3JpcHQgJyR7ZX0nYCxhKX0sci5hcHBlbmRDaGlsZChuKX1zdGF0aWMgTG9hZFNjcmlwdEFzeW5jKGUpe3JldHVybiBuZXcgUHJvbWlzZSgodCxpKT0+e3RoaXMuTG9hZFNjcmlwdChlLCgpPT57dCgpfSwocyxyKT0+e2kocnx8bmV3IEVycm9yKHMpKX0pfSl9c3RhdGljIFJlYWRGaWxlQXNEYXRhVVJMKGUsdCxpKXtjb25zdCBzPW5ldyBGaWxlUmVhZGVyLHI9e29uQ29tcGxldGVPYnNlcnZhYmxlOm5ldyBGLGFib3J0OigpPT5zLmFib3J0KCl9O3JldHVybiBzLm9ubG9hZGVuZD0oKT0+e3Iub25Db21wbGV0ZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHIpfSxzLm9ubG9hZD1uPT57dChuLnRhcmdldC5yZXN1bHQpfSxzLm9ucHJvZ3Jlc3M9aSxzLnJlYWRBc0RhdGFVUkwoZSkscn1zdGF0aWMgUmVhZEZpbGUoZSx0LGkscyxyKXtyZXR1cm4gd2koZSx0LGkscyxyKX1zdGF0aWMgRmlsZUFzVVJMKGUpe2NvbnN0IHQ9bmV3IEJsb2IoW2VdKTtyZXR1cm4gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwodCl9c3RhdGljIEZvcm1hdChlLHQ9Mil7cmV0dXJuIGUudG9GaXhlZCh0KX1zdGF0aWMgRGVlcENvcHkoZSx0LGkscyl7dnMuRGVlcENvcHkoZSx0LGkscyl9c3RhdGljIElzRW1wdHkoZSl7Zm9yKGNvbnN0IHQgaW4gZSlpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KSlyZXR1cm4hMTtyZXR1cm4hMH1zdGF0aWMgUmVnaXN0ZXJUb3BSb290RXZlbnRzKGUsdCl7Zm9yKGxldCBpPTA7aTx0Lmxlbmd0aDtpKyspe2NvbnN0IHM9dFtpXTtlLmFkZEV2ZW50TGlzdGVuZXIocy5uYW1lLHMuaGFuZGxlciwhMSk7dHJ5e3dpbmRvdy5wYXJlbnQmJndpbmRvdy5wYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcihzLm5hbWUscy5oYW5kbGVyLCExKX1jYXRjaHt9fX1zdGF0aWMgVW5yZWdpc3RlclRvcFJvb3RFdmVudHMoZSx0KXtmb3IobGV0IGk9MDtpPHQubGVuZ3RoO2krKyl7Y29uc3Qgcz10W2ldO2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihzLm5hbWUscy5oYW5kbGVyKTt0cnl7ZS5wYXJlbnQmJmUucGFyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIocy5uYW1lLHMuaGFuZGxlcil9Y2F0Y2h7fX19c3RhdGljIGFzeW5jIER1bXBGcmFtZWJ1ZmZlcihlLHQsaSxzLHI9ImltYWdlL3BuZyIsbil7dGhyb3cgJCgiRHVtcFRvb2xzIil9c3RhdGljIER1bXBEYXRhKGUsdCxpLHMscj0iaW1hZ2UvcG5nIixuLGE9ITEsbz0hMSxoKXt0aHJvdyAkKCJEdW1wVG9vbHMiKX1zdGF0aWMgRHVtcERhdGFBc3luYyhlLHQsaSxzPSJpbWFnZS9wbmciLHIsbj0hMSxhPSExLG8pe3Rocm93ICQoIkR1bXBUb29scyIpfXN0YXRpYyBUb0Jsb2IoZSx0LGk9ImltYWdlL3BuZyIscyl7ZS50b0Jsb2J8fChlLnRvQmxvYj1mdW5jdGlvbihyLG4sYSl7c2V0VGltZW91dCgoKT0+e2NvbnN0IG89YXRvYih0aGlzLnRvRGF0YVVSTChuLGEpLnNwbGl0KCIsIilbMV0pLGg9by5sZW5ndGgsbD1uZXcgVWludDhBcnJheShoKTtmb3IobGV0IHU9MDt1PGg7dSsrKWxbdV09by5jaGFyQ29kZUF0KHUpO3IobmV3IEJsb2IoW2xdKSl9KX0pLGUudG9CbG9iKGZ1bmN0aW9uKHIpe3Qocil9LGkscyl9c3RhdGljIERvd25sb2FkQmxvYihlLHQpe2lmKCJkb3dubG9hZCJpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIikpe2lmKCF0KXtjb25zdCBpPW5ldyBEYXRlO3Q9InNjcmVlbnNob3RfIisoKGkuZ2V0RnVsbFllYXIoKSsiLSIrKGkuZ2V0TW9udGgoKSsxKSkuc2xpY2UoMikrIi0iK2kuZ2V0RGF0ZSgpKyJfIitpLmdldEhvdXJzKCkrIi0iKygiMCIraS5nZXRNaW51dGVzKCkpLnNsaWNlKC0yKSkrIi5wbmcifUguRG93bmxvYWQoZSx0KX1lbHNlIGlmKGUmJnR5cGVvZiBVUkw8InUiKXtjb25zdCBpPVVSTC5jcmVhdGVPYmplY3RVUkwoZSkscz13aW5kb3cub3BlbigiIik7aWYoIXMpcmV0dXJuO2NvbnN0IHI9cy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbWciKTtyLm9ubG9hZD1mdW5jdGlvbigpe1VSTC5yZXZva2VPYmplY3RVUkwoaSl9LHIuc3JjPWkscy5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHIpfX1zdGF0aWMgRW5jb2RlU2NyZWVuc2hvdENhbnZhc0RhdGEoZSx0LGk9ImltYWdlL3BuZyIscyxyKXtpZih0KXtjb25zdCBuPWUudG9EYXRhVVJMKGkscik7dChuKX1lbHNlIHRoaXMuVG9CbG9iKGUsZnVuY3Rpb24obil7biYmSC5Eb3dubG9hZEJsb2IobixzKX0saSxyKX1zdGF0aWMgRG93bmxvYWQoZSx0KXtpZih0eXBlb2YgVVJMPiJ1IilyZXR1cm47Y29uc3QgaT13aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChlKSxzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTtkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHMpLHMuc3R5bGUuZGlzcGxheT0ibm9uZSIscy5ocmVmPWkscy5kb3dubG9hZD10LHMuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCgpPT57cy5wYXJlbnRFbGVtZW50JiZzLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQocyl9KSxzLmNsaWNrKCksd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwoaSl9c3RhdGljIEJhY2tDb21wYXRDYW1lcmFOb1ByZXZlbnREZWZhdWx0KGUpe3JldHVybiB0eXBlb2YgZVswXT09ImJvb2xlYW4iP2VbMF06dHlwZW9mIGVbMV09PSJib29sZWFuIj9lWzFdOiExfXN0YXRpYyBDcmVhdGVTY3JlZW5zaG90KGUsdCxpLHMscj0iaW1hZ2UvcG5nIil7dGhyb3cgJCgiU2NyZWVuc2hvdFRvb2xzIil9c3RhdGljIENyZWF0ZVNjcmVlbnNob3RBc3luYyhlLHQsaSxzPSJpbWFnZS9wbmciKXt0aHJvdyAkKCJTY3JlZW5zaG90VG9vbHMiKX1zdGF0aWMgQ3JlYXRlU2NyZWVuc2hvdFVzaW5nUmVuZGVyVGFyZ2V0KGUsdCxpLHMscj0iaW1hZ2UvcG5nIixuPTEsYT0hMSxvKXt0aHJvdyAkKCJTY3JlZW5zaG90VG9vbHMiKX1zdGF0aWMgQ3JlYXRlU2NyZWVuc2hvdFVzaW5nUmVuZGVyVGFyZ2V0QXN5bmMoZSx0LGkscz0iaW1hZ2UvcG5nIixyPTEsbj0hMSxhKXt0aHJvdyAkKCJTY3JlZW5zaG90VG9vbHMiKX1zdGF0aWMgUmFuZG9tSWQoKXtyZXR1cm4gbHIoKX1zdGF0aWMgSXNCYXNlNjQoZSl7cmV0dXJuIE1zKGUpfXN0YXRpYyBEZWNvZGVCYXNlNjQoZSl7cmV0dXJuIEFzKGUpfXN0YXRpYyBnZXQgZXJyb3JzQ291bnQoKXtyZXR1cm4gTy5lcnJvcnNDb3VudH1zdGF0aWMgTG9nKGUpe08uTG9nKGUpfXN0YXRpYyBXYXJuKGUpe08uV2FybihlKX1zdGF0aWMgRXJyb3IoZSl7Ty5FcnJvcihlKX1zdGF0aWMgZ2V0IExvZ0NhY2hlKCl7cmV0dXJuIE8uTG9nQ2FjaGV9c3RhdGljIENsZWFyTG9nQ2FjaGUoKXtPLkNsZWFyTG9nQ2FjaGUoKX1zdGF0aWMgc2V0IExvZ0xldmVscyhlKXtPLkxvZ0xldmVscz1lfXN0YXRpYyBzZXQgUGVyZm9ybWFuY2VMb2dMZXZlbChlKXtpZigoZSZILlBlcmZvcm1hbmNlVXNlck1hcmtMb2dMZXZlbCk9PT1ILlBlcmZvcm1hbmNlVXNlck1hcmtMb2dMZXZlbCl7SC5TdGFydFBlcmZvcm1hbmNlQ291bnRlcj1ILl9TdGFydFVzZXJNYXJrLEguRW5kUGVyZm9ybWFuY2VDb3VudGVyPUguX0VuZFVzZXJNYXJrO3JldHVybn1pZigoZSZILlBlcmZvcm1hbmNlQ29uc29sZUxvZ0xldmVsKT09PUguUGVyZm9ybWFuY2VDb25zb2xlTG9nTGV2ZWwpe0guU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXI9SC5fU3RhcnRQZXJmb3JtYW5jZUNvbnNvbGUsSC5FbmRQZXJmb3JtYW5jZUNvdW50ZXI9SC5fRW5kUGVyZm9ybWFuY2VDb25zb2xlO3JldHVybn1ILlN0YXJ0UGVyZm9ybWFuY2VDb3VudGVyPUguX1N0YXJ0UGVyZm9ybWFuY2VDb3VudGVyRGlzYWJsZWQsSC5FbmRQZXJmb3JtYW5jZUNvdW50ZXI9SC5fRW5kUGVyZm9ybWFuY2VDb3VudGVyRGlzYWJsZWR9c3RhdGljIF9TdGFydFBlcmZvcm1hbmNlQ291bnRlckRpc2FibGVkKGUsdCl7fXN0YXRpYyBfRW5kUGVyZm9ybWFuY2VDb3VudGVyRGlzYWJsZWQoZSx0KXt9c3RhdGljIF9TdGFydFVzZXJNYXJrKGUsdD0hMCl7aWYoIUguX1BlcmZvcm1hbmNlKXtpZighamUoKSlyZXR1cm47SC5fUGVyZm9ybWFuY2U9d2luZG93LnBlcmZvcm1hbmNlfSF0fHwhSC5fUGVyZm9ybWFuY2UubWFya3x8SC5fUGVyZm9ybWFuY2UubWFyayhlKyItQmVnaW4iKX1zdGF0aWMgX0VuZFVzZXJNYXJrKGUsdD0hMCl7IXR8fCFILl9QZXJmb3JtYW5jZS5tYXJrfHwoSC5fUGVyZm9ybWFuY2UubWFyayhlKyItRW5kIiksSC5fUGVyZm9ybWFuY2UubWVhc3VyZShlLGUrIi1CZWdpbiIsZSsiLUVuZCIpKX1zdGF0aWMgX1N0YXJ0UGVyZm9ybWFuY2VDb25zb2xlKGUsdD0hMCl7dCYmKEguX1N0YXJ0VXNlck1hcmsoZSx0KSxjb25zb2xlLnRpbWUmJmNvbnNvbGUudGltZShlKSl9c3RhdGljIF9FbmRQZXJmb3JtYW5jZUNvbnNvbGUoZSx0PSEwKXt0JiYoSC5fRW5kVXNlck1hcmsoZSx0KSxjb25zb2xlLnRpbWVFbmQoZSkpfXN0YXRpYyBnZXQgTm93KCl7cmV0dXJuIGFpLk5vd31zdGF0aWMgR2V0Q2xhc3NOYW1lKGUsdD0hMSl7bGV0IGk9bnVsbDtyZXR1cm4hdCYmZS5nZXRDbGFzc05hbWU/aT1lLmdldENsYXNzTmFtZSgpOihlIGluc3RhbmNlb2YgT2JqZWN0JiYoaT0odD9lOk9iamVjdC5nZXRQcm90b3R5cGVPZihlKSkuY29uc3RydWN0b3IuX19ianNjbGFzc05hbWVfXyksaXx8KGk9dHlwZW9mIGUpKSxpfXN0YXRpYyBGaXJzdChlLHQpe2Zvcihjb25zdCBpIG9mIGUpaWYodChpKSlyZXR1cm4gaTtyZXR1cm4gbnVsbH1zdGF0aWMgZ2V0RnVsbENsYXNzTmFtZShlLHQ9ITEpe2xldCBpPW51bGwscz1udWxsO2lmKCF0JiZlLmdldENsYXNzTmFtZSlpPWUuZ2V0Q2xhc3NOYW1lKCk7ZWxzZXtpZihlIGluc3RhbmNlb2YgT2JqZWN0KXtjb25zdCByPXQ/ZTpPYmplY3QuZ2V0UHJvdG90eXBlT2YoZSk7aT1yLmNvbnN0cnVjdG9yLl9fYmpzY2xhc3NOYW1lX18scz1yLmNvbnN0cnVjdG9yLl9fYmpzbW9kdWxlTmFtZV9ffWl8fChpPXR5cGVvZiBlKX1yZXR1cm4gaT8ocyE9bnVsbD9zKyIuIjoiIikraTpudWxsfXN0YXRpYyBEZWxheUFzeW5jKGUpe3JldHVybiBuZXcgUHJvbWlzZSh0PT57c2V0VGltZW91dCgoKT0+e3QoKX0sZSl9KX1zdGF0aWMgSXNTYWZhcmkoKXtyZXR1cm4gSnMoKT8vXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpOiExfX1ILlVzZUN1c3RvbVJlcXVlc3RIZWFkZXJzPSExLEguQ3VzdG9tUmVxdWVzdEhlYWRlcnM9Y3QuQ3VzdG9tUmVxdWVzdEhlYWRlcnMsSC5fVG1wRmxvYXRBcnJheT1uZXcgRmxvYXQzMkFycmF5KDEpLEguR2V0RE9NVGV4dENvbnRlbnQ9Z3MsSC5HZXRBYnNvbHV0ZVVybD10eXBlb2YgZG9jdW1lbnQ9PSJvYmplY3QiP2M9Pntjb25zdCBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTtyZXR1cm4gZS5ocmVmPWMsZS5ocmVmfTp0eXBlb2YgVVJMPT0iZnVuY3Rpb24iJiZ0eXBlb2YgbG9jYXRpb249PSJvYmplY3QiP2M9Pm5ldyBVUkwoYyxsb2NhdGlvbi5vcmlnaW4pLmhyZWY6KCk9Pnt0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBnZXQgYWJzb2x1dGUgVVJMLiBPdmVycmlkZSBCQUJZTE9OLlRvb2xzLkdldEFic29sdXRlVXJsIHRvIGEgY3VzdG9tIGltcGxlbWVudGF0aW9uIGZvciB0aGUgY3VycmVudCBjb250ZXh0LiIpfSxILk5vbmVMb2dMZXZlbD1PLk5vbmVMb2dMZXZlbCxILk1lc3NhZ2VMb2dMZXZlbD1PLk1lc3NhZ2VMb2dMZXZlbCxILldhcm5pbmdMb2dMZXZlbD1PLldhcm5pbmdMb2dMZXZlbCxILkVycm9yTG9nTGV2ZWw9Ty5FcnJvckxvZ0xldmVsLEguQWxsTG9nTGV2ZWw9Ty5BbGxMb2dMZXZlbCxILklzV2luZG93T2JqZWN0RXhpc3Q9amUsSC5QZXJmb3JtYW5jZU5vbmVMb2dMZXZlbD0wLEguUGVyZm9ybWFuY2VVc2VyTWFya0xvZ0xldmVsPTEsSC5QZXJmb3JtYW5jZUNvbnNvbGVMb2dMZXZlbD0yLEguU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXI9SC5fU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXJEaXNhYmxlZCxILkVuZFBlcmZvcm1hbmNlQ291bnRlcj1ILl9FbmRQZXJmb3JtYW5jZUNvdW50ZXJEaXNhYmxlZDtjbGFzcyBZaXtjb25zdHJ1Y3RvcihlLHQsaSxzPTApe3RoaXMuaXRlcmF0aW9ucz1lLHRoaXMuaW5kZXg9cy0xLHRoaXMuX2RvbmU9ITEsdGhpcy5fZm49dCx0aGlzLl9zdWNjZXNzQ2FsbGJhY2s9aX1leGVjdXRlTmV4dCgpe3RoaXMuX2RvbmV8fCh0aGlzLmluZGV4KzE8dGhpcy5pdGVyYXRpb25zPygrK3RoaXMuaW5kZXgsdGhpcy5fZm4odGhpcykpOnRoaXMuYnJlYWtMb29wKCkpfWJyZWFrTG9vcCgpe3RoaXMuX2RvbmU9ITAsdGhpcy5fc3VjY2Vzc0NhbGxiYWNrKCl9c3RhdGljIFJ1bihlLHQsaSxzPTApe2NvbnN0IHI9bmV3IFlpKGUsdCxpLHMpO3JldHVybiByLmV4ZWN1dGVOZXh0KCkscn1zdGF0aWMgU3luY0FzeW5jRm9yTG9vcChlLHQsaSxzLHIsbj0wKXtyZXR1cm4gWWkuUnVuKE1hdGguY2VpbChlL3QpLGE9PntyJiZyKCk/YS5icmVha0xvb3AoKTpzZXRUaW1lb3V0KCgpPT57Zm9yKGxldCBvPTA7bzx0Oysrbyl7Y29uc3QgaD1hLmluZGV4KnQrbztpZihoPj1lKWJyZWFrO2lmKGkoaCksciYmcigpKXthLmJyZWFrTG9vcCgpO2JyZWFrfX1hLmV4ZWN1dGVOZXh0KCl9LG4pfSxzKX19ZmUuRmFsbGJhY2tUZXh0dXJlPSJkYXRhOmltYWdlL2pwZztiYXNlNjQsLzlqLzRBQVFTa1pKUmdBQkFRRUFZQUJnQUFELzRRQm1SWGhwWmdBQVRVMEFLZ0FBQUFnQUJBRWFBQVVBQUFBQkFBQUFQZ0ViQUFVQUFBQUJBQUFBUmdFb0FBTUFBQUFCQUFJQUFBRXhBQUlBQUFBUUFBQUFUZ0FBQUFBQUFBQmdBQUFBQVFBQUFHQUFBQUFCY0dGcGJuUXVibVYwSURRdU1DNDFBUC9iQUVNQUJBSURBd01DQkFNREF3UUVCQVFGQ1FZRkJRVUZDd2dJQmdrTkN3ME5EUXNNREE0UUZCRU9EeE1QREF3U0dCSVRGUllYRnhjT0VSa2JHUllhRkJZWEZ2L2JBRU1CQkFRRUJRVUZDZ1lHQ2hZUERBOFdGaFlXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRnYvQUFCRUlBUUFCQUFNQklnQUNFUUVERVFIL3hBQWZBQUFCQlFFQkFRRUJBUUFBQUFBQUFBQUFBUUlEQkFVR0J3Z0pDZ3YveEFDMUVBQUNBUU1EQWdRREJRVUVCQUFBQVgwQkFnTUFCQkVGRWlFeFFRWVRVV0VISW5FVU1vR1JvUWdqUXJIQkZWTFI4Q1F6WW5LQ0NRb1dGeGdaR2lVbUp5Z3BLalExTmpjNE9UcERSRVZHUjBoSlNsTlVWVlpYV0ZsYVkyUmxabWRvYVdwemRIVjJkM2g1ZW9PRWhZYUhpSW1La3BPVWxaYVhtSm1hb3FPa3BhYW5xS21xc3JPMHRiYTN1TG02d3NQRXhjYkh5TW5LMHRQVTFkYlgyTm5hNGVMajVPWG01K2pwNnZIeTgvVDE5dmY0K2ZyL3hBQWZBUUFEQVFFQkFRRUJBUUVCQUFBQUFBQUFBUUlEQkFVR0J3Z0pDZ3YveEFDMUVRQUNBUUlFQkFNRUJ3VUVCQUFCQW5jQUFRSURFUVFGSVRFR0VrRlJCMkZ4RXlJeWdRZ1VRcEdoc2NFSkl6TlM4QlZpY3RFS0ZpUTA0U1h4RnhnWkdpWW5LQ2txTlRZM09EazZRMFJGUmtkSVNVcFRWRlZXVjFoWldtTmtaV1puYUdscWMzUjFkbmQ0ZVhxQ2c0U0Zob2VJaVlxU2s1U1ZscGVZbVpxaW82U2xwcWVvcWFxeXM3UzF0cmU0dWJyQ3c4VEZ4c2ZJeWNyUzA5VFYxdGZZMmRyaTQrVGw1dWZvNmVyeTgvVDE5dmY0K2ZyLzJnQU1Bd0VBQWhFREVRQS9BUEg2S0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RkNpaWlnRDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytnb29vb0ErWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVUtLS0tBUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZDaWlpZ0Q1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCUW9vb29BK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm9LS0tLQVBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGQ2lpaWdENmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2dvb29vQStYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVS0tLS0FQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NkNpaWlnRDVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JRb29vb0Erb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92b0tLS0tBUGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZDaWlpZ0Q2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrZ29vb29BK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1VLS0tLQVBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UC8vWiI7Y2xhc3MgJGV7Y29uc3RydWN0b3IoZSl7dGhpcy5sZW5ndGg9MCx0aGlzLmRhdGE9bmV3IEFycmF5KGUpLHRoaXMuX2lkPSRlLl9HbG9iYWxJZCsrfXB1c2goZSl7dGhpcy5kYXRhW3RoaXMubGVuZ3RoKytdPWUsdGhpcy5sZW5ndGg+dGhpcy5kYXRhLmxlbmd0aCYmKHRoaXMuZGF0YS5sZW5ndGgqPTIpfWZvckVhY2goZSl7Zm9yKGxldCB0PTA7dDx0aGlzLmxlbmd0aDt0KyspZSh0aGlzLmRhdGFbdF0pfXNvcnQoZSl7dGhpcy5kYXRhLnNvcnQoZSl9cmVzZXQoKXt0aGlzLmxlbmd0aD0wfWRpc3Bvc2UoKXt0aGlzLnJlc2V0KCksdGhpcy5kYXRhJiYodGhpcy5kYXRhLmxlbmd0aD0wKX1jb25jYXQoZSl7aWYoZS5sZW5ndGghPT0wKXt0aGlzLmxlbmd0aCtlLmxlbmd0aD50aGlzLmRhdGEubGVuZ3RoJiYodGhpcy5kYXRhLmxlbmd0aD0odGhpcy5sZW5ndGgrZS5sZW5ndGgpKjIpO2ZvcihsZXQgdD0wO3Q8ZS5sZW5ndGg7dCsrKXRoaXMuZGF0YVt0aGlzLmxlbmd0aCsrXT0oZS5kYXRhfHxlKVt0XX19aW5kZXhPZihlKXtjb25zdCB0PXRoaXMuZGF0YS5pbmRleE9mKGUpO3JldHVybiB0Pj10aGlzLmxlbmd0aD8tMTp0fWNvbnRhaW5zKGUpe3JldHVybiB0aGlzLmluZGV4T2YoZSkhPT0tMX19JGUuX0dsb2JhbElkPTA7Y2xhc3MgaGkgZXh0ZW5kcyAkZXtjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5fZHVwbGljYXRlSWQ9MH1wdXNoKGUpe3N1cGVyLnB1c2goZSksZS5fX3NtYXJ0QXJyYXlGbGFnc3x8KGUuX19zbWFydEFycmF5RmxhZ3M9e30pLGUuX19zbWFydEFycmF5RmxhZ3NbdGhpcy5faWRdPXRoaXMuX2R1cGxpY2F0ZUlkfXB1c2hOb0R1cGxpY2F0ZShlKXtyZXR1cm4gZS5fX3NtYXJ0QXJyYXlGbGFncyYmZS5fX3NtYXJ0QXJyYXlGbGFnc1t0aGlzLl9pZF09PT10aGlzLl9kdXBsaWNhdGVJZD8hMToodGhpcy5wdXNoKGUpLCEwKX1yZXNldCgpe3N1cGVyLnJlc2V0KCksdGhpcy5fZHVwbGljYXRlSWQrK31jb25jYXRXaXRoTm9EdXBsaWNhdGUoZSl7aWYoZS5sZW5ndGghPT0wKXt0aGlzLmxlbmd0aCtlLmxlbmd0aD50aGlzLmRhdGEubGVuZ3RoJiYodGhpcy5kYXRhLmxlbmd0aD0odGhpcy5sZW5ndGgrZS5sZW5ndGgpKjIpO2ZvcihsZXQgdD0wO3Q8ZS5sZW5ndGg7dCsrKXtjb25zdCBpPShlLmRhdGF8fGUpW3RdO3RoaXMucHVzaE5vRHVwbGljYXRlKGkpfX19fWNsYXNzIGNye2NvbnN0cnVjdG9yKCl7dGhpcy5fY291bnQ9MCx0aGlzLl9kYXRhPXt9fWNvcHlGcm9tKGUpe3RoaXMuY2xlYXIoKSxlLmZvckVhY2goKHQsaSk9PnRoaXMuYWRkKHQsaSkpfWdldChlKXtjb25zdCB0PXRoaXMuX2RhdGFbZV07aWYodCE9PXZvaWQgMClyZXR1cm4gdH1nZXRPckFkZFdpdGhGYWN0b3J5KGUsdCl7bGV0IGk9dGhpcy5nZXQoZSk7cmV0dXJuIGkhPT12b2lkIDB8fChpPXQoZSksaSYmdGhpcy5hZGQoZSxpKSksaX1nZXRPckFkZChlLHQpe2NvbnN0IGk9dGhpcy5nZXQoZSk7cmV0dXJuIGkhPT12b2lkIDA/aToodGhpcy5hZGQoZSx0KSx0KX1jb250YWlucyhlKXtyZXR1cm4gdGhpcy5fZGF0YVtlXSE9PXZvaWQgMH1hZGQoZSx0KXtyZXR1cm4gdGhpcy5fZGF0YVtlXSE9PXZvaWQgMD8hMToodGhpcy5fZGF0YVtlXT10LCsrdGhpcy5fY291bnQsITApfXNldChlLHQpe3JldHVybiB0aGlzLl9kYXRhW2VdPT09dm9pZCAwPyExOih0aGlzLl9kYXRhW2VdPXQsITApfWdldEFuZFJlbW92ZShlKXtjb25zdCB0PXRoaXMuZ2V0KGUpO3JldHVybiB0IT09dm9pZCAwPyhkZWxldGUgdGhpcy5fZGF0YVtlXSwtLXRoaXMuX2NvdW50LHQpOm51bGx9cmVtb3ZlKGUpe3JldHVybiB0aGlzLmNvbnRhaW5zKGUpPyhkZWxldGUgdGhpcy5fZGF0YVtlXSwtLXRoaXMuX2NvdW50LCEwKTohMX1jbGVhcigpe3RoaXMuX2RhdGE9e30sdGhpcy5fY291bnQ9MH1nZXQgY291bnQoKXtyZXR1cm4gdGhpcy5fY291bnR9Zm9yRWFjaChlKXtmb3IoY29uc3QgdCBpbiB0aGlzLl9kYXRhKXtjb25zdCBpPXRoaXMuX2RhdGFbdF07ZSh0LGkpfX1maXJzdChlKXtmb3IoY29uc3QgdCBpbiB0aGlzLl9kYXRhKXtjb25zdCBpPXRoaXMuX2RhdGFbdF0scz1lKHQsaSk7aWYocylyZXR1cm4gc31yZXR1cm4gbnVsbH19Y2xhc3MgbGl7c3RhdGljIEV2YWwoZSx0KXtyZXR1cm4gZS5tYXRjaCgvXChbXigpXSpcKS9nKT9lPWUucmVwbGFjZSgvXChbXigpXSpcKS9nLGk9PihpPWkuc2xpY2UoMSxpLmxlbmd0aC0xKSxsaS5fSGFuZGxlUGFyZW50aGVzaXNDb250ZW50KGksdCkpKTplPWxpLl9IYW5kbGVQYXJlbnRoZXNpc0NvbnRlbnQoZSx0KSxlPT09InRydWUiPyEwOmU9PT0iZmFsc2UiPyExOmxpLkV2YWwoZSx0KX1zdGF0aWMgX0hhbmRsZVBhcmVudGhlc2lzQ29udGVudChlLHQpe3Q9dHx8KHI9PnI9PT0idHJ1ZSIpO2xldCBpO2NvbnN0IHM9ZS5zcGxpdCgifHwiKTtmb3IoY29uc3QgciBpbiBzKWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLHIpKXtsZXQgbj1saS5fU2ltcGxpZnlOZWdhdGlvbihzW3JdLnRyaW0oKSk7Y29uc3QgYT1uLnNwbGl0KCImJiIpO2lmKGEubGVuZ3RoPjEpZm9yKGxldCBvPTA7bzxhLmxlbmd0aDsrK28pe2NvbnN0IGg9bGkuX1NpbXBsaWZ5TmVnYXRpb24oYVtvXS50cmltKCkpO2lmKGghPT0idHJ1ZSImJmghPT0iZmFsc2UiP2hbMF09PT0iISI/aT0hdChoLnN1YnN0cmluZygxKSk6aT10KGgpOmk9aD09PSJ0cnVlIiwhaSl7bj0iZmFsc2UiO2JyZWFrfX1pZihpfHxuPT09InRydWUiKXtpPSEwO2JyZWFrfW4hPT0idHJ1ZSImJm4hPT0iZmFsc2UiP25bMF09PT0iISI/aT0hdChuLnN1YnN0cmluZygxKSk6aT10KG4pOmk9bj09PSJ0cnVlIn1yZXR1cm4gaT8idHJ1ZSI6ImZhbHNlIn1zdGF0aWMgX1NpbXBsaWZ5TmVnYXRpb24oZSl7cmV0dXJuIGU9ZS5yZXBsYWNlKC9eW1xzIV0rLyx0PT4odD10LnJlcGxhY2UoL1tcc10vZywoKT0+IiIpLHQubGVuZ3RoJTI/IiEiOiIiKSksZT1lLnRyaW0oKSxlPT09IiF0cnVlIj9lPSJmYWxzZSI6ZT09PSIhZmFsc2UiJiYoZT0idHJ1ZSIpLGV9fWNsYXNzIGdle3N0YXRpYyBFbmFibGVGb3IoZSl7ZS5fdGFncz1lLl90YWdzfHx7fSxlLmhhc1RhZ3M9KCk9PmdlLkhhc1RhZ3MoZSksZS5hZGRUYWdzPXQ9PmdlLkFkZFRhZ3NUbyhlLHQpLGUucmVtb3ZlVGFncz10PT5nZS5SZW1vdmVUYWdzRnJvbShlLHQpLGUubWF0Y2hlc1RhZ3NRdWVyeT10PT5nZS5NYXRjaGVzUXVlcnkoZSx0KX1zdGF0aWMgRGlzYWJsZUZvcihlKXtkZWxldGUgZS5fdGFncyxkZWxldGUgZS5oYXNUYWdzLGRlbGV0ZSBlLmFkZFRhZ3MsZGVsZXRlIGUucmVtb3ZlVGFncyxkZWxldGUgZS5tYXRjaGVzVGFnc1F1ZXJ5fXN0YXRpYyBIYXNUYWdzKGUpe2lmKCFlLl90YWdzKXJldHVybiExO2NvbnN0IHQ9ZS5fdGFncztmb3IoY29uc3QgaSBpbiB0KWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LGkpKXJldHVybiEwO3JldHVybiExfXN0YXRpYyBHZXRUYWdzKGUsdD0hMCl7aWYoIWUuX3RhZ3MpcmV0dXJuIG51bGw7aWYodCl7Y29uc3QgaT1bXTtmb3IoY29uc3QgcyBpbiBlLl90YWdzKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLl90YWdzLHMpJiZlLl90YWdzW3NdPT09ITAmJmkucHVzaChzKTtyZXR1cm4gaS5qb2luKCIgIil9ZWxzZSByZXR1cm4gZS5fdGFnc31zdGF0aWMgQWRkVGFnc1RvKGUsdCl7aWYoIXR8fHR5cGVvZiB0IT0ic3RyaW5nIilyZXR1cm47dC5zcGxpdCgiICIpLmZvckVhY2goZnVuY3Rpb24ocyl7Z2UuX0FkZFRhZ1RvKGUscyl9KX1zdGF0aWMgX0FkZFRhZ1RvKGUsdCl7dD10LnRyaW0oKSwhKHQ9PT0iInx8dD09PSJ0cnVlInx8dD09PSJmYWxzZSIpJiYodC5tYXRjaCgvW1xzXS8pfHx0Lm1hdGNoKC9eKFshXXwoW3xdfFsmXSl7Mn0pLyl8fChnZS5FbmFibGVGb3IoZSksZS5fdGFnc1t0XT0hMCkpfXN0YXRpYyBSZW1vdmVUYWdzRnJvbShlLHQpe2lmKCFnZS5IYXNUYWdzKGUpKXJldHVybjtjb25zdCBpPXQuc3BsaXQoIiAiKTtmb3IoY29uc3QgcyBpbiBpKWdlLl9SZW1vdmVUYWdGcm9tKGUsaVtzXSl9c3RhdGljIF9SZW1vdmVUYWdGcm9tKGUsdCl7ZGVsZXRlIGUuX3RhZ3NbdF19c3RhdGljIE1hdGNoZXNRdWVyeShlLHQpe3JldHVybiB0PT09dm9pZCAwPyEwOnQ9PT0iIj9nZS5IYXNUYWdzKGUpOmxpLkV2YWwodCxpPT5nZS5IYXNUYWdzKGUpJiZlLl90YWdzW2ldKX19Y2xhc3MgWml7Y29uc3RydWN0b3IoKXt0aGlzLnJvb3ROb2Rlcz1uZXcgQXJyYXksdGhpcy5jYW1lcmFzPW5ldyBBcnJheSx0aGlzLmxpZ2h0cz1uZXcgQXJyYXksdGhpcy5tZXNoZXM9bmV3IEFycmF5LHRoaXMuc2tlbGV0b25zPW5ldyBBcnJheSx0aGlzLnBhcnRpY2xlU3lzdGVtcz1uZXcgQXJyYXksdGhpcy5hbmltYXRpb25zPVtdLHRoaXMuYW5pbWF0aW9uR3JvdXBzPW5ldyBBcnJheSx0aGlzLm11bHRpTWF0ZXJpYWxzPW5ldyBBcnJheSx0aGlzLm1hdGVyaWFscz1uZXcgQXJyYXksdGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzPW5ldyBBcnJheSx0aGlzLmdlb21ldHJpZXM9bmV3IEFycmF5LHRoaXMudHJhbnNmb3JtTm9kZXM9bmV3IEFycmF5LHRoaXMuYWN0aW9uTWFuYWdlcnM9bmV3IEFycmF5LHRoaXMudGV4dHVyZXM9bmV3IEFycmF5LHRoaXMuX2Vudmlyb25tZW50VGV4dHVyZT1udWxsLHRoaXMucG9zdFByb2Nlc3Nlcz1uZXcgQXJyYXl9c3RhdGljIEFkZFBhcnNlcihlLHQpe3RoaXMuX0JhYnlsb25GaWxlUGFyc2Vyc1tlXT10fXN0YXRpYyBHZXRQYXJzZXIoZSl7cmV0dXJuIHRoaXMuX0JhYnlsb25GaWxlUGFyc2Vyc1tlXT90aGlzLl9CYWJ5bG9uRmlsZVBhcnNlcnNbZV06bnVsbH1zdGF0aWMgQWRkSW5kaXZpZHVhbFBhcnNlcihlLHQpe3RoaXMuX0luZGl2aWR1YWxCYWJ5bG9uRmlsZVBhcnNlcnNbZV09dH1zdGF0aWMgR2V0SW5kaXZpZHVhbFBhcnNlcihlKXtyZXR1cm4gdGhpcy5fSW5kaXZpZHVhbEJhYnlsb25GaWxlUGFyc2Vyc1tlXT90aGlzLl9JbmRpdmlkdWFsQmFieWxvbkZpbGVQYXJzZXJzW2VdOm51bGx9c3RhdGljIFBhcnNlKGUsdCxpLHMpe2Zvcihjb25zdCByIGluIHRoaXMuX0JhYnlsb25GaWxlUGFyc2VycylPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5fQmFieWxvbkZpbGVQYXJzZXJzLHIpJiZ0aGlzLl9CYWJ5bG9uRmlsZVBhcnNlcnNbcl0oZSx0LGkscyl9Z2V0IGVudmlyb25tZW50VGV4dHVyZSgpe3JldHVybiB0aGlzLl9lbnZpcm9ubWVudFRleHR1cmV9c2V0IGVudmlyb25tZW50VGV4dHVyZShlKXt0aGlzLl9lbnZpcm9ubWVudFRleHR1cmU9ZX1nZXROb2Rlcygpe2xldCBlPW5ldyBBcnJheTtyZXR1cm4gZT1lLmNvbmNhdCh0aGlzLm1lc2hlcyksZT1lLmNvbmNhdCh0aGlzLmxpZ2h0cyksZT1lLmNvbmNhdCh0aGlzLmNhbWVyYXMpLGU9ZS5jb25jYXQodGhpcy50cmFuc2Zvcm1Ob2RlcyksdGhpcy5za2VsZXRvbnMuZm9yRWFjaCh0PT5lPWUuY29uY2F0KHQuYm9uZXMpKSxlfX1aaS5fQmFieWxvbkZpbGVQYXJzZXJzPXt9LFppLl9JbmRpdmlkdWFsQmFieWxvbkZpbGVQYXJzZXJzPXt9O2Z1bmN0aW9uIFQoYyxlLHQsaSl7dmFyIHM9YXJndW1lbnRzLmxlbmd0aCxyPXM8Mz9lOmk9PT1udWxsP2k9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpOmksbjtpZih0eXBlb2YgUmVmbGVjdD09Im9iamVjdCImJnR5cGVvZiBSZWZsZWN0LmRlY29yYXRlPT0iZnVuY3Rpb24iKXI9UmVmbGVjdC5kZWNvcmF0ZShjLGUsdCxpKTtlbHNlIGZvcih2YXIgYT1jLmxlbmd0aC0xO2E+PTA7YS0tKShuPWNbYV0pJiYocj0oczwzP24ocik6cz4zP24oZSx0LHIpOm4oZSx0KSl8fHIpO3JldHVybiBzPjMmJnImJk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQscikscn1jb25zdCBxaT17fSxqaT17fSx1cj1mdW5jdGlvbihjLGUsdCl7Y29uc3QgaT1jKCk7Z2UmJmdlLkFkZFRhZ3NUbyhpLGUudGFncyk7Y29uc3Qgcz1ScyhpKTtmb3IoY29uc3QgciBpbiBzKXtjb25zdCBuPXNbcl0sYT1lW3JdLG89bi50eXBlO2lmKGEhPW51bGwmJihyIT09InVuaXF1ZUlkInx8YWUuQWxsb3dMb2FkaW5nVW5pcXVlSWQpKXN3aXRjaChvKXtjYXNlIDA6Y2FzZSA2OmNhc2UgMTE6aVtyXT1hO2JyZWFrO2Nhc2UgMTppW3JdPXR8fGEuaXNSZW5kZXJUYXJnZXQ/YTphLmNsb25lKCk7YnJlYWs7Y2FzZSAyOmNhc2UgMzpjYXNlIDQ6Y2FzZSA1OmNhc2UgNzpjYXNlIDEwOmNhc2UgMTI6aVtyXT10P2E6YS5jbG9uZSgpO2JyZWFrfX1yZXR1cm4gaX07ZnVuY3Rpb24gYm4oYyl7Y29uc3QgZT1jLmdldENsYXNzTmFtZSgpO3JldHVybiBxaVtlXXx8KHFpW2VdPXt9KSxxaVtlXX1mdW5jdGlvbiBScyhjKXtjb25zdCBlPWMuZ2V0Q2xhc3NOYW1lKCk7aWYoamlbZV0pcmV0dXJuIGppW2VdO2ppW2VdPXt9O2NvbnN0IHQ9amlbZV07bGV0IGk9YyxzPWU7Zm9yKDtzOyl7Y29uc3Qgcj1xaVtzXTtmb3IoY29uc3QgbyBpbiByKXRbb109cltvXTtsZXQgbixhPSExO2Rve2lmKG49T2JqZWN0LmdldFByb3RvdHlwZU9mKGkpLCFuLmdldENsYXNzTmFtZSl7YT0hMDticmVha31pZihuLmdldENsYXNzTmFtZSgpIT09cylicmVhaztpPW59d2hpbGUobik7aWYoYSlicmVhaztzPW4uZ2V0Q2xhc3NOYW1lKCksaT1ufXJldHVybiB0fWZ1bmN0aW9uIHl0KGMsZSl7cmV0dXJuKHQsaSk9Pntjb25zdCBzPWJuKHQpO3NbaV18fChzW2ldPXt0eXBlOmMsc291cmNlTmFtZTplfSl9fWZ1bmN0aW9uIFNuKGMsZT1udWxsKXtyZXR1cm4odCxpKT0+e2NvbnN0IHM9ZXx8Il8iK2k7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsaSx7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbc119LHNldDpmdW5jdGlvbihyKXt0eXBlb2YgdGhpcy5lcXVhbHM9PSJmdW5jdGlvbiImJnRoaXMuZXF1YWxzKHIpfHx0aGlzW3NdIT09ciYmKHRoaXNbc109cix0W2NdLmFwcGx5KHRoaXMpKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KX19ZnVuY3Rpb24gYmUoYyxlPW51bGwpe3JldHVybiBTbihjLGUpfWZ1bmN0aW9uIFIoYyl7cmV0dXJuIHl0KDAsYyl9ZnVuY3Rpb24gbXQoYyl7cmV0dXJuIHl0KDEsYyl9ZnVuY3Rpb24gY2koYyl7cmV0dXJuIHl0KDIsYyl9ZnVuY3Rpb24gTmkoYyl7cmV0dXJuIHl0KDMsYyl9ZnVuY3Rpb24geG4oYyl7cmV0dXJuIHl0KDQsYyl9ZnVuY3Rpb24gQnQoYyl7cmV0dXJuIHl0KDUsYyl9ZnVuY3Rpb24gTW4oYyl7cmV0dXJuIHl0KDYsYyl9ZnVuY3Rpb24gQW4oYyl7cmV0dXJuIHl0KDcsYyl9ZnVuY3Rpb24gZHIoYyl7cmV0dXJuIHl0KDgsYyl9ZnVuY3Rpb24gUm4oYyl7cmV0dXJuIHl0KDEwLGMpfWNsYXNzIGFle3N0YXRpYyBBcHBlbmRTZXJpYWxpemVkQW5pbWF0aW9ucyhlLHQpe2lmKGUuYW5pbWF0aW9ucyl7dC5hbmltYXRpb25zPVtdO2ZvcihsZXQgaT0wO2k8ZS5hbmltYXRpb25zLmxlbmd0aDtpKyspe2NvbnN0IHM9ZS5hbmltYXRpb25zW2ldO3QuYW5pbWF0aW9ucy5wdXNoKHMuc2VyaWFsaXplKCkpfX19c3RhdGljIFNlcmlhbGl6ZShlLHQpe3R8fCh0PXt9KSxnZSYmKHQudGFncz1nZS5HZXRUYWdzKGUpKTtjb25zdCBpPVJzKGUpO2Zvcihjb25zdCBzIGluIGkpe2NvbnN0IHI9aVtzXSxuPXIuc291cmNlTmFtZXx8cyxhPXIudHlwZSxvPWVbc107aWYobyE9bnVsbCYmKHMhPT0idW5pcXVlSWQifHxhZS5BbGxvd0xvYWRpbmdVbmlxdWVJZCkpc3dpdGNoKGEpe2Nhc2UgMDp0W25dPW87YnJlYWs7Y2FzZSAxOnRbbl09by5zZXJpYWxpemUoKTticmVhaztjYXNlIDI6dFtuXT1vLmFzQXJyYXkoKTticmVhaztjYXNlIDM6dFtuXT1vLnNlcmlhbGl6ZSgpO2JyZWFrO2Nhc2UgNDp0W25dPW8uYXNBcnJheSgpO2JyZWFrO2Nhc2UgNTp0W25dPW8uYXNBcnJheSgpO2JyZWFrO2Nhc2UgNjp0W25dPW8uaWQ7YnJlYWs7Y2FzZSA3OnRbbl09by5zZXJpYWxpemUoKTticmVhaztjYXNlIDg6dFtuXT1vLmFzQXJyYXkoKTticmVhaztjYXNlIDk6dFtuXT1vLnNlcmlhbGl6ZSgpO2JyZWFrO2Nhc2UgMTA6dFtuXT1vLmFzQXJyYXkoKTticmVhaztjYXNlIDExOnRbbl09by5pZDticmVhaztjYXNlIDEyOnRbbl09by5hc0FycmF5KCk7YnJlYWt9fXJldHVybiB0fXN0YXRpYyBQYXJzZShlLHQsaSxzPW51bGwpe2NvbnN0IHI9ZSgpO3N8fChzPSIiKSxnZSYmZ2UuQWRkVGFnc1RvKHIsdC50YWdzKTtjb25zdCBuPVJzKHIpO2Zvcihjb25zdCBhIGluIG4pe2NvbnN0IG89blthXSxoPXRbby5zb3VyY2VOYW1lfHxhXSxsPW8udHlwZTtpZihoIT1udWxsJiYoYSE9PSJ1bmlxdWVJZCJ8fGFlLkFsbG93TG9hZGluZ1VuaXF1ZUlkKSl7Y29uc3QgdT1yO3N3aXRjaChsKXtjYXNlIDA6dVthXT1oO2JyZWFrO2Nhc2UgMTppJiYodVthXT1hZS5fVGV4dHVyZVBhcnNlcihoLGkscykpO2JyZWFrO2Nhc2UgMjp1W2FdPXJlLkZyb21BcnJheShoKTticmVhaztjYXNlIDM6dVthXT1hZS5fRnJlc25lbFBhcmFtZXRlcnNQYXJzZXIoaCk7YnJlYWs7Y2FzZSA0OnVbYV09dmUuRnJvbUFycmF5KGgpO2JyZWFrO2Nhc2UgNTp1W2FdPXAuRnJvbUFycmF5KGgpO2JyZWFrO2Nhc2UgNjppJiYodVthXT1pLmdldExhc3RNZXNoQnlJZChoKSk7YnJlYWs7Y2FzZSA3OnVbYV09YWUuX0NvbG9yQ3VydmVzUGFyc2VyKGgpO2JyZWFrO2Nhc2UgODp1W2FdPW1lLkZyb21BcnJheShoKTticmVhaztjYXNlIDk6dVthXT1hZS5fSW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvblBhcnNlcihoKTticmVhaztjYXNlIDEwOnVbYV09Wi5Gcm9tQXJyYXkoaCk7YnJlYWs7Y2FzZSAxMTppJiYodVthXT1pLmdldENhbWVyYUJ5SWQoaCkpO2JyZWFrO2Nhc2UgMTI6dVthXT14LkZyb21BcnJheShoKTticmVha319fXJldHVybiByfXN0YXRpYyBDbG9uZShlLHQpe3JldHVybiB1cihlLHQsITEpfXN0YXRpYyBJbnN0YW5jaWF0ZShlLHQpe3JldHVybiB1cihlLHQsITApfX1hZS5BbGxvd0xvYWRpbmdVbmlxdWVJZD0hMSxhZS5fSW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvblBhcnNlcj1jPT57dGhyb3cgJCgiSW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbiIpfSxhZS5fRnJlc25lbFBhcmFtZXRlcnNQYXJzZXI9Yz0+e3Rocm93ICQoIkZyZXNuZWxQYXJhbWV0ZXJzIil9LGFlLl9Db2xvckN1cnZlc1BhcnNlcj1jPT57dGhyb3cgJCgiQ29sb3JDdXJ2ZXMiKX0sYWUuX1RleHR1cmVQYXJzZXI9KGMsZSx0KT0+e3Rocm93ICQoIlRleHR1cmUiKX07ZnVuY3Rpb24gJHQoYyxlLHQsaSl7Y29uc3Qgcz10LnZhbHVlO3QudmFsdWU9KC4uLnIpPT57bGV0IG49cztpZih0eXBlb2YgX25hdGl2ZTwidSImJl9uYXRpdmVbZV0pe2NvbnN0IGE9X25hdGl2ZVtlXTtpP249KC4uLm8pPT5pKC4uLm8pP2EoLi4ubyk6cyguLi5vKTpuPWF9cmV0dXJuIGNbZV09bixuKC4uLnIpfX0kdC5maWx0ZXI9ZnVuY3Rpb24oYyl7cmV0dXJuKGUsdCxpKT0+JHQoZSx0LGksYyl9O2NsYXNzIHlze2NvbnN0cnVjdG9yKGUpe2lmKHRoaXMuX2tleXM9W10sdGhpcy5faXNEaXJ0eT0hMCx0aGlzLl9hcmVMaWdodHNEaXJ0eT0hMCx0aGlzLl9hcmVMaWdodHNEaXNwb3NlZD0hMSx0aGlzLl9hcmVBdHRyaWJ1dGVzRGlydHk9ITAsdGhpcy5fYXJlVGV4dHVyZXNEaXJ0eT0hMCx0aGlzLl9hcmVGcmVzbmVsRGlydHk9ITAsdGhpcy5fYXJlTWlzY0RpcnR5PSEwLHRoaXMuX2FyZVByZVBhc3NEaXJ0eT0hMCx0aGlzLl9hcmVJbWFnZVByb2Nlc3NpbmdEaXJ0eT0hMCx0aGlzLl9ub3JtYWxzPSExLHRoaXMuX3V2cz0hMSx0aGlzLl9uZWVkTm9ybWFscz0hMSx0aGlzLl9uZWVkVVZzPSExLHRoaXMuX2V4dGVybmFsUHJvcGVydGllcz1lLGUpZm9yKGNvbnN0IHQgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KSYmdGhpcy5fc2V0RGVmYXVsdFZhbHVlKHQpfWdldCBpc0RpcnR5KCl7cmV0dXJuIHRoaXMuX2lzRGlydHl9bWFya0FzUHJvY2Vzc2VkKCl7dGhpcy5faXNEaXJ0eT0hMSx0aGlzLl9hcmVBdHRyaWJ1dGVzRGlydHk9ITEsdGhpcy5fYXJlVGV4dHVyZXNEaXJ0eT0hMSx0aGlzLl9hcmVGcmVzbmVsRGlydHk9ITEsdGhpcy5fYXJlTGlnaHRzRGlydHk9ITEsdGhpcy5fYXJlTGlnaHRzRGlzcG9zZWQ9ITEsdGhpcy5fYXJlTWlzY0RpcnR5PSExLHRoaXMuX2FyZVByZVBhc3NEaXJ0eT0hMSx0aGlzLl9hcmVJbWFnZVByb2Nlc3NpbmdEaXJ0eT0hMX1tYXJrQXNVbnByb2Nlc3NlZCgpe3RoaXMuX2lzRGlydHk9ITB9bWFya0FsbEFzRGlydHkoKXt0aGlzLl9hcmVUZXh0dXJlc0RpcnR5PSEwLHRoaXMuX2FyZUF0dHJpYnV0ZXNEaXJ0eT0hMCx0aGlzLl9hcmVMaWdodHNEaXJ0eT0hMCx0aGlzLl9hcmVGcmVzbmVsRGlydHk9ITAsdGhpcy5fYXJlTWlzY0RpcnR5PSEwLHRoaXMuX2FyZUltYWdlUHJvY2Vzc2luZ0RpcnR5PSEwLHRoaXMuX2lzRGlydHk9ITB9bWFya0FzSW1hZ2VQcm9jZXNzaW5nRGlydHkoKXt0aGlzLl9hcmVJbWFnZVByb2Nlc3NpbmdEaXJ0eT0hMCx0aGlzLl9pc0RpcnR5PSEwfW1hcmtBc0xpZ2h0RGlydHkoZT0hMSl7dGhpcy5fYXJlTGlnaHRzRGlydHk9ITAsdGhpcy5fYXJlTGlnaHRzRGlzcG9zZWQ9dGhpcy5fYXJlTGlnaHRzRGlzcG9zZWR8fGUsdGhpcy5faXNEaXJ0eT0hMH1tYXJrQXNBdHRyaWJ1dGVzRGlydHkoKXt0aGlzLl9hcmVBdHRyaWJ1dGVzRGlydHk9ITAsdGhpcy5faXNEaXJ0eT0hMH1tYXJrQXNUZXh0dXJlc0RpcnR5KCl7dGhpcy5fYXJlVGV4dHVyZXNEaXJ0eT0hMCx0aGlzLl9pc0RpcnR5PSEwfW1hcmtBc0ZyZXNuZWxEaXJ0eSgpe3RoaXMuX2FyZUZyZXNuZWxEaXJ0eT0hMCx0aGlzLl9pc0RpcnR5PSEwfW1hcmtBc01pc2NEaXJ0eSgpe3RoaXMuX2FyZU1pc2NEaXJ0eT0hMCx0aGlzLl9pc0RpcnR5PSEwfW1hcmtBc1ByZVBhc3NEaXJ0eSgpe3RoaXMuX2FyZVByZVBhc3NEaXJ0eT0hMCx0aGlzLl9pc0RpcnR5PSEwfXJlYnVpbGQoKXt0aGlzLl9rZXlzLmxlbmd0aD0wO2Zvcihjb25zdCBlIG9mIE9iamVjdC5rZXlzKHRoaXMpKWVbMF0hPT0iXyImJnRoaXMuX2tleXMucHVzaChlKTtpZih0aGlzLl9leHRlcm5hbFByb3BlcnRpZXMpZm9yKGNvbnN0IGUgaW4gdGhpcy5fZXh0ZXJuYWxQcm9wZXJ0aWVzKXRoaXMuX2tleXMuaW5kZXhPZihlKT09PS0xJiZ0aGlzLl9rZXlzLnB1c2goZSl9aXNFcXVhbChlKXtpZih0aGlzLl9rZXlzLmxlbmd0aCE9PWUuX2tleXMubGVuZ3RoKXJldHVybiExO2ZvcihsZXQgdD0wO3Q8dGhpcy5fa2V5cy5sZW5ndGg7dCsrKXtjb25zdCBpPXRoaXMuX2tleXNbdF07aWYodGhpc1tpXSE9PWVbaV0pcmV0dXJuITF9cmV0dXJuITB9Y2xvbmVUbyhlKXt0aGlzLl9rZXlzLmxlbmd0aCE9PWUuX2tleXMubGVuZ3RoJiYoZS5fa2V5cz10aGlzLl9rZXlzLnNsaWNlKDApKTtmb3IobGV0IHQ9MDt0PHRoaXMuX2tleXMubGVuZ3RoO3QrKyl7Y29uc3QgaT10aGlzLl9rZXlzW3RdO2VbaV09dGhpc1tpXX19cmVzZXQoKXt0aGlzLl9rZXlzLmZvckVhY2goZT0+dGhpcy5fc2V0RGVmYXVsdFZhbHVlKGUpKX1fc2V0RGVmYXVsdFZhbHVlKGUpe3ZhciB0LGkscyxyLG47Y29uc3QgYT0ocz0oaT0odD10aGlzLl9leHRlcm5hbFByb3BlcnRpZXMpPT09bnVsbHx8dD09PXZvaWQgMD92b2lkIDA6dFtlXSk9PT1udWxsfHxpPT09dm9pZCAwP3ZvaWQgMDppLnR5cGUpIT09bnVsbCYmcyE9PXZvaWQgMD9zOnR5cGVvZiB0aGlzW2VdLG89KG49KHI9dGhpcy5fZXh0ZXJuYWxQcm9wZXJ0aWVzKT09PW51bGx8fHI9PT12b2lkIDA/dm9pZCAwOnJbZV0pPT09bnVsbHx8bj09PXZvaWQgMD92b2lkIDA6bi5kZWZhdWx0O3N3aXRjaChhKXtjYXNlIm51bWJlciI6dGhpc1tlXT1vPz8wO2JyZWFrO2Nhc2Uic3RyaW5nIjp0aGlzW2VdPW8/PyIiO2JyZWFrO2RlZmF1bHQ6dGhpc1tlXT1vPz8hMTticmVha319dG9TdHJpbmcoKXtsZXQgZT0iIjtmb3IobGV0IHQ9MDt0PHRoaXMuX2tleXMubGVuZ3RoO3QrKyl7Y29uc3QgaT10aGlzLl9rZXlzW3RdLHM9dGhpc1tpXTtzd2l0Y2godHlwZW9mIHMpe2Nhc2UibnVtYmVyIjpjYXNlInN0cmluZyI6ZSs9IiNkZWZpbmUgIitpKyIgIitzK2AKYDticmVhaztkZWZhdWx0OnMmJihlKz0iI2RlZmluZSAiK2krYApgKTticmVha319cmV0dXJuIGV9fWNsYXNzIEFle2NvbnN0cnVjdG9yKCl7dGhpcy5fZGlydHk9ITAsdGhpcy5fdGVtcENvbG9yPW5ldyBtZSgwLDAsMCwwKSx0aGlzLl9nbG9iYWxDdXJ2ZT1uZXcgbWUoMCwwLDAsMCksdGhpcy5faGlnaGxpZ2h0c0N1cnZlPW5ldyBtZSgwLDAsMCwwKSx0aGlzLl9taWR0b25lc0N1cnZlPW5ldyBtZSgwLDAsMCwwKSx0aGlzLl9zaGFkb3dzQ3VydmU9bmV3IG1lKDAsMCwwLDApLHRoaXMuX3Bvc2l0aXZlQ3VydmU9bmV3IG1lKDAsMCwwLDApLHRoaXMuX25lZ2F0aXZlQ3VydmU9bmV3IG1lKDAsMCwwLDApLHRoaXMuX2dsb2JhbEh1ZT0zMCx0aGlzLl9nbG9iYWxEZW5zaXR5PTAsdGhpcy5fZ2xvYmFsU2F0dXJhdGlvbj0wLHRoaXMuX2dsb2JhbEV4cG9zdXJlPTAsdGhpcy5faGlnaGxpZ2h0c0h1ZT0zMCx0aGlzLl9oaWdobGlnaHRzRGVuc2l0eT0wLHRoaXMuX2hpZ2hsaWdodHNTYXR1cmF0aW9uPTAsdGhpcy5faGlnaGxpZ2h0c0V4cG9zdXJlPTAsdGhpcy5fbWlkdG9uZXNIdWU9MzAsdGhpcy5fbWlkdG9uZXNEZW5zaXR5PTAsdGhpcy5fbWlkdG9uZXNTYXR1cmF0aW9uPTAsdGhpcy5fbWlkdG9uZXNFeHBvc3VyZT0wLHRoaXMuX3NoYWRvd3NIdWU9MzAsdGhpcy5fc2hhZG93c0RlbnNpdHk9MCx0aGlzLl9zaGFkb3dzU2F0dXJhdGlvbj0wLHRoaXMuX3NoYWRvd3NFeHBvc3VyZT0wfWdldCBnbG9iYWxIdWUoKXtyZXR1cm4gdGhpcy5fZ2xvYmFsSHVlfXNldCBnbG9iYWxIdWUoZSl7dGhpcy5fZ2xvYmFsSHVlPWUsdGhpcy5fZGlydHk9ITB9Z2V0IGdsb2JhbERlbnNpdHkoKXtyZXR1cm4gdGhpcy5fZ2xvYmFsRGVuc2l0eX1zZXQgZ2xvYmFsRGVuc2l0eShlKXt0aGlzLl9nbG9iYWxEZW5zaXR5PWUsdGhpcy5fZGlydHk9ITB9Z2V0IGdsb2JhbFNhdHVyYXRpb24oKXtyZXR1cm4gdGhpcy5fZ2xvYmFsU2F0dXJhdGlvbn1zZXQgZ2xvYmFsU2F0dXJhdGlvbihlKXt0aGlzLl9nbG9iYWxTYXR1cmF0aW9uPWUsdGhpcy5fZGlydHk9ITB9Z2V0IGdsb2JhbEV4cG9zdXJlKCl7cmV0dXJuIHRoaXMuX2dsb2JhbEV4cG9zdXJlfXNldCBnbG9iYWxFeHBvc3VyZShlKXt0aGlzLl9nbG9iYWxFeHBvc3VyZT1lLHRoaXMuX2RpcnR5PSEwfWdldCBoaWdobGlnaHRzSHVlKCl7cmV0dXJuIHRoaXMuX2hpZ2hsaWdodHNIdWV9c2V0IGhpZ2hsaWdodHNIdWUoZSl7dGhpcy5faGlnaGxpZ2h0c0h1ZT1lLHRoaXMuX2RpcnR5PSEwfWdldCBoaWdobGlnaHRzRGVuc2l0eSgpe3JldHVybiB0aGlzLl9oaWdobGlnaHRzRGVuc2l0eX1zZXQgaGlnaGxpZ2h0c0RlbnNpdHkoZSl7dGhpcy5faGlnaGxpZ2h0c0RlbnNpdHk9ZSx0aGlzLl9kaXJ0eT0hMH1nZXQgaGlnaGxpZ2h0c1NhdHVyYXRpb24oKXtyZXR1cm4gdGhpcy5faGlnaGxpZ2h0c1NhdHVyYXRpb259c2V0IGhpZ2hsaWdodHNTYXR1cmF0aW9uKGUpe3RoaXMuX2hpZ2hsaWdodHNTYXR1cmF0aW9uPWUsdGhpcy5fZGlydHk9ITB9Z2V0IGhpZ2hsaWdodHNFeHBvc3VyZSgpe3JldHVybiB0aGlzLl9oaWdobGlnaHRzRXhwb3N1cmV9c2V0IGhpZ2hsaWdodHNFeHBvc3VyZShlKXt0aGlzLl9oaWdobGlnaHRzRXhwb3N1cmU9ZSx0aGlzLl9kaXJ0eT0hMH1nZXQgbWlkdG9uZXNIdWUoKXtyZXR1cm4gdGhpcy5fbWlkdG9uZXNIdWV9c2V0IG1pZHRvbmVzSHVlKGUpe3RoaXMuX21pZHRvbmVzSHVlPWUsdGhpcy5fZGlydHk9ITB9Z2V0IG1pZHRvbmVzRGVuc2l0eSgpe3JldHVybiB0aGlzLl9taWR0b25lc0RlbnNpdHl9c2V0IG1pZHRvbmVzRGVuc2l0eShlKXt0aGlzLl9taWR0b25lc0RlbnNpdHk9ZSx0aGlzLl9kaXJ0eT0hMH1nZXQgbWlkdG9uZXNTYXR1cmF0aW9uKCl7cmV0dXJuIHRoaXMuX21pZHRvbmVzU2F0dXJhdGlvbn1zZXQgbWlkdG9uZXNTYXR1cmF0aW9uKGUpe3RoaXMuX21pZHRvbmVzU2F0dXJhdGlvbj1lLHRoaXMuX2RpcnR5PSEwfWdldCBtaWR0b25lc0V4cG9zdXJlKCl7cmV0dXJuIHRoaXMuX21pZHRvbmVzRXhwb3N1cmV9c2V0IG1pZHRvbmVzRXhwb3N1cmUoZSl7dGhpcy5fbWlkdG9uZXNFeHBvc3VyZT1lLHRoaXMuX2RpcnR5PSEwfWdldCBzaGFkb3dzSHVlKCl7cmV0dXJuIHRoaXMuX3NoYWRvd3NIdWV9c2V0IHNoYWRvd3NIdWUoZSl7dGhpcy5fc2hhZG93c0h1ZT1lLHRoaXMuX2RpcnR5PSEwfWdldCBzaGFkb3dzRGVuc2l0eSgpe3JldHVybiB0aGlzLl9zaGFkb3dzRGVuc2l0eX1zZXQgc2hhZG93c0RlbnNpdHkoZSl7dGhpcy5fc2hhZG93c0RlbnNpdHk9ZSx0aGlzLl9kaXJ0eT0hMH1nZXQgc2hhZG93c1NhdHVyYXRpb24oKXtyZXR1cm4gdGhpcy5fc2hhZG93c1NhdHVyYXRpb259c2V0IHNoYWRvd3NTYXR1cmF0aW9uKGUpe3RoaXMuX3NoYWRvd3NTYXR1cmF0aW9uPWUsdGhpcy5fZGlydHk9ITB9Z2V0IHNoYWRvd3NFeHBvc3VyZSgpe3JldHVybiB0aGlzLl9zaGFkb3dzRXhwb3N1cmV9c2V0IHNoYWRvd3NFeHBvc3VyZShlKXt0aGlzLl9zaGFkb3dzRXhwb3N1cmU9ZSx0aGlzLl9kaXJ0eT0hMH1nZXRDbGFzc05hbWUoKXtyZXR1cm4iQ29sb3JDdXJ2ZXMifXN0YXRpYyBCaW5kKGUsdCxpPSJ2Q2FtZXJhQ29sb3JDdXJ2ZVBvc2l0aXZlIixzPSJ2Q2FtZXJhQ29sb3JDdXJ2ZU5ldXRyYWwiLHI9InZDYW1lcmFDb2xvckN1cnZlTmVnYXRpdmUiKXtlLl9kaXJ0eSYmKGUuX2RpcnR5PSExLGUuX2dldENvbG9yR3JhZGluZ0RhdGFUb1JlZihlLl9nbG9iYWxIdWUsZS5fZ2xvYmFsRGVuc2l0eSxlLl9nbG9iYWxTYXR1cmF0aW9uLGUuX2dsb2JhbEV4cG9zdXJlLGUuX2dsb2JhbEN1cnZlKSxlLl9nZXRDb2xvckdyYWRpbmdEYXRhVG9SZWYoZS5faGlnaGxpZ2h0c0h1ZSxlLl9oaWdobGlnaHRzRGVuc2l0eSxlLl9oaWdobGlnaHRzU2F0dXJhdGlvbixlLl9oaWdobGlnaHRzRXhwb3N1cmUsZS5fdGVtcENvbG9yKSxlLl90ZW1wQ29sb3IubXVsdGlwbHlUb1JlZihlLl9nbG9iYWxDdXJ2ZSxlLl9oaWdobGlnaHRzQ3VydmUpLGUuX2dldENvbG9yR3JhZGluZ0RhdGFUb1JlZihlLl9taWR0b25lc0h1ZSxlLl9taWR0b25lc0RlbnNpdHksZS5fbWlkdG9uZXNTYXR1cmF0aW9uLGUuX21pZHRvbmVzRXhwb3N1cmUsZS5fdGVtcENvbG9yKSxlLl90ZW1wQ29sb3IubXVsdGlwbHlUb1JlZihlLl9nbG9iYWxDdXJ2ZSxlLl9taWR0b25lc0N1cnZlKSxlLl9nZXRDb2xvckdyYWRpbmdEYXRhVG9SZWYoZS5fc2hhZG93c0h1ZSxlLl9zaGFkb3dzRGVuc2l0eSxlLl9zaGFkb3dzU2F0dXJhdGlvbixlLl9zaGFkb3dzRXhwb3N1cmUsZS5fdGVtcENvbG9yKSxlLl90ZW1wQ29sb3IubXVsdGlwbHlUb1JlZihlLl9nbG9iYWxDdXJ2ZSxlLl9zaGFkb3dzQ3VydmUpLGUuX2hpZ2hsaWdodHNDdXJ2ZS5zdWJ0cmFjdFRvUmVmKGUuX21pZHRvbmVzQ3VydmUsZS5fcG9zaXRpdmVDdXJ2ZSksZS5fbWlkdG9uZXNDdXJ2ZS5zdWJ0cmFjdFRvUmVmKGUuX3NoYWRvd3NDdXJ2ZSxlLl9uZWdhdGl2ZUN1cnZlKSksdCYmKHQuc2V0RmxvYXQ0KGksZS5fcG9zaXRpdmVDdXJ2ZS5yLGUuX3Bvc2l0aXZlQ3VydmUuZyxlLl9wb3NpdGl2ZUN1cnZlLmIsZS5fcG9zaXRpdmVDdXJ2ZS5hKSx0LnNldEZsb2F0NChzLGUuX21pZHRvbmVzQ3VydmUucixlLl9taWR0b25lc0N1cnZlLmcsZS5fbWlkdG9uZXNDdXJ2ZS5iLGUuX21pZHRvbmVzQ3VydmUuYSksdC5zZXRGbG9hdDQocixlLl9uZWdhdGl2ZUN1cnZlLnIsZS5fbmVnYXRpdmVDdXJ2ZS5nLGUuX25lZ2F0aXZlQ3VydmUuYixlLl9uZWdhdGl2ZUN1cnZlLmEpKX1zdGF0aWMgUHJlcGFyZVVuaWZvcm1zKGUpe2UucHVzaCgidkNhbWVyYUNvbG9yQ3VydmVOZXV0cmFsIiwidkNhbWVyYUNvbG9yQ3VydmVQb3NpdGl2ZSIsInZDYW1lcmFDb2xvckN1cnZlTmVnYXRpdmUiKX1fZ2V0Q29sb3JHcmFkaW5nRGF0YVRvUmVmKGUsdCxpLHMscil7ZSE9bnVsbCYmKGU9QWUuX0NsYW1wKGUsMCwzNjApLHQ9QWUuX0NsYW1wKHQsLTEwMCwxMDApLGk9QWUuX0NsYW1wKGksLTEwMCwxMDApLHM9QWUuX0NsYW1wKHMsLTEwMCwxMDApLHQ9QWUuX0FwcGx5Q29sb3JHcmFkaW5nU2xpZGVyTm9ubGluZWFyKHQpLHQqPS41LHM9QWUuX0FwcGx5Q29sb3JHcmFkaW5nU2xpZGVyTm9ubGluZWFyKHMpLHQ8MCYmKHQqPS0xLGU9KGUrMTgwKSUzNjApLEFlLl9Gcm9tSFNCVG9SZWYoZSx0LDUwKy4yNSpzLHIpLHIuc2NhbGVUb1JlZigyLHIpLHIuYT0xKy4wMSppKX1zdGF0aWMgX0FwcGx5Q29sb3JHcmFkaW5nU2xpZGVyTm9ubGluZWFyKGUpe2UvPTEwMDtsZXQgdD1NYXRoLmFicyhlKTtyZXR1cm4gdD1NYXRoLnBvdyh0LDIpLGU8MCYmKHQqPS0xKSx0Kj0xMDAsdH1zdGF0aWMgX0Zyb21IU0JUb1JlZihlLHQsaSxzKXtsZXQgcj1BZS5fQ2xhbXAoZSwwLDM2MCk7Y29uc3Qgbj1BZS5fQ2xhbXAodC8xMDAsMCwxKSxhPUFlLl9DbGFtcChpLzEwMCwwLDEpO2lmKG49PT0wKXMucj1hLHMuZz1hLHMuYj1hO2Vsc2V7ci89NjA7Y29uc3Qgbz1NYXRoLmZsb29yKHIpLGg9ci1vLGw9YSooMS1uKSx1PWEqKDEtbipoKSxkPWEqKDEtbiooMS1oKSk7c3dpdGNoKG8pe2Nhc2UgMDpzLnI9YSxzLmc9ZCxzLmI9bDticmVhaztjYXNlIDE6cy5yPXUscy5nPWEscy5iPWw7YnJlYWs7Y2FzZSAyOnMucj1sLHMuZz1hLHMuYj1kO2JyZWFrO2Nhc2UgMzpzLnI9bCxzLmc9dSxzLmI9YTticmVhaztjYXNlIDQ6cy5yPWQscy5nPWwscy5iPWE7YnJlYWs7ZGVmYXVsdDpzLnI9YSxzLmc9bCxzLmI9dTticmVha319cy5hPTF9c3RhdGljIF9DbGFtcChlLHQsaSl7cmV0dXJuIE1hdGgubWluKE1hdGgubWF4KGUsdCksaSl9Y2xvbmUoKXtyZXR1cm4gYWUuQ2xvbmUoKCk9Pm5ldyBBZSx0aGlzKX1zZXJpYWxpemUoKXtyZXR1cm4gYWUuU2VyaWFsaXplKHRoaXMpfXN0YXRpYyBQYXJzZShlKXtyZXR1cm4gYWUuUGFyc2UoKCk9Pm5ldyBBZSxlLG51bGwsbnVsbCl9fVQoW1IoKV0sQWUucHJvdG90eXBlLCJfZ2xvYmFsSHVlIix2b2lkIDApLFQoW1IoKV0sQWUucHJvdG90eXBlLCJfZ2xvYmFsRGVuc2l0eSIsdm9pZCAwKSxUKFtSKCldLEFlLnByb3RvdHlwZSwiX2dsb2JhbFNhdHVyYXRpb24iLHZvaWQgMCksVChbUigpXSxBZS5wcm90b3R5cGUsIl9nbG9iYWxFeHBvc3VyZSIsdm9pZCAwKSxUKFtSKCldLEFlLnByb3RvdHlwZSwiX2hpZ2hsaWdodHNIdWUiLHZvaWQgMCksVChbUigpXSxBZS5wcm90b3R5cGUsIl9oaWdobGlnaHRzRGVuc2l0eSIsdm9pZCAwKSxUKFtSKCldLEFlLnByb3RvdHlwZSwiX2hpZ2hsaWdodHNTYXR1cmF0aW9uIix2b2lkIDApLFQoW1IoKV0sQWUucHJvdG90eXBlLCJfaGlnaGxpZ2h0c0V4cG9zdXJlIix2b2lkIDApLFQoW1IoKV0sQWUucHJvdG90eXBlLCJfbWlkdG9uZXNIdWUiLHZvaWQgMCksVChbUigpXSxBZS5wcm90b3R5cGUsIl9taWR0b25lc0RlbnNpdHkiLHZvaWQgMCksVChbUigpXSxBZS5wcm90b3R5cGUsIl9taWR0b25lc1NhdHVyYXRpb24iLHZvaWQgMCksVChbUigpXSxBZS5wcm90b3R5cGUsIl9taWR0b25lc0V4cG9zdXJlIix2b2lkIDApLGFlLl9Db2xvckN1cnZlc1BhcnNlcj1BZS5QYXJzZTtjbGFzcyBwZXtjb25zdHJ1Y3Rvcigpe3RoaXMuY29sb3JDdXJ2ZXM9bmV3IEFlLHRoaXMuX2NvbG9yQ3VydmVzRW5hYmxlZD0hMSx0aGlzLl9jb2xvckdyYWRpbmdFbmFibGVkPSExLHRoaXMuX2NvbG9yR3JhZGluZ1dpdGhHcmVlbkRlcHRoPSEwLHRoaXMuX2NvbG9yR3JhZGluZ0JHUj0hMCx0aGlzLl9leHBvc3VyZT0xLHRoaXMuX3RvbmVNYXBwaW5nRW5hYmxlZD0hMSx0aGlzLl90b25lTWFwcGluZ1R5cGU9cGUuVE9ORU1BUFBJTkdfU1RBTkRBUkQsdGhpcy5fY29udHJhc3Q9MSx0aGlzLnZpZ25ldHRlU3RyZXRjaD0wLHRoaXMudmlnbmV0dGVDZW50ZXJYPTAsdGhpcy52aWduZXR0ZUNlbnRlclk9MCx0aGlzLnZpZ25ldHRlV2VpZ2h0PTEuNSx0aGlzLnZpZ25ldHRlQ29sb3I9bmV3IG1lKDAsMCwwLDApLHRoaXMudmlnbmV0dGVDYW1lcmFGb3Y9LjUsdGhpcy5fdmlnbmV0dGVCbGVuZE1vZGU9cGUuVklHTkVUVEVNT0RFX01VTFRJUExZLHRoaXMuX3ZpZ25ldHRlRW5hYmxlZD0hMSx0aGlzLl9kaXRoZXJpbmdFbmFibGVkPSExLHRoaXMuX2RpdGhlcmluZ0ludGVuc2l0eT0xLzI1NSx0aGlzLl9za2lwRmluYWxDb2xvckNsYW1wPSExLHRoaXMuX2FwcGx5QnlQb3N0UHJvY2Vzcz0hMSx0aGlzLl9pc0VuYWJsZWQ9ITAsdGhpcy5vblVwZGF0ZVBhcmFtZXRlcnM9bmV3IEZ9Z2V0IGNvbG9yQ3VydmVzRW5hYmxlZCgpe3JldHVybiB0aGlzLl9jb2xvckN1cnZlc0VuYWJsZWR9c2V0IGNvbG9yQ3VydmVzRW5hYmxlZChlKXt0aGlzLl9jb2xvckN1cnZlc0VuYWJsZWQhPT1lJiYodGhpcy5fY29sb3JDdXJ2ZXNFbmFibGVkPWUsdGhpcy5fdXBkYXRlUGFyYW1ldGVycygpKX1nZXQgY29sb3JHcmFkaW5nVGV4dHVyZSgpe3JldHVybiB0aGlzLl9jb2xvckdyYWRpbmdUZXh0dXJlfXNldCBjb2xvckdyYWRpbmdUZXh0dXJlKGUpe3RoaXMuX2NvbG9yR3JhZGluZ1RleHR1cmUhPT1lJiYodGhpcy5fY29sb3JHcmFkaW5nVGV4dHVyZT1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IGNvbG9yR3JhZGluZ0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5fY29sb3JHcmFkaW5nRW5hYmxlZH1zZXQgY29sb3JHcmFkaW5nRW5hYmxlZChlKXt0aGlzLl9jb2xvckdyYWRpbmdFbmFibGVkIT09ZSYmKHRoaXMuX2NvbG9yR3JhZGluZ0VuYWJsZWQ9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBjb2xvckdyYWRpbmdXaXRoR3JlZW5EZXB0aCgpe3JldHVybiB0aGlzLl9jb2xvckdyYWRpbmdXaXRoR3JlZW5EZXB0aH1zZXQgY29sb3JHcmFkaW5nV2l0aEdyZWVuRGVwdGgoZSl7dGhpcy5fY29sb3JHcmFkaW5nV2l0aEdyZWVuRGVwdGghPT1lJiYodGhpcy5fY29sb3JHcmFkaW5nV2l0aEdyZWVuRGVwdGg9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBjb2xvckdyYWRpbmdCR1IoKXtyZXR1cm4gdGhpcy5fY29sb3JHcmFkaW5nQkdSfXNldCBjb2xvckdyYWRpbmdCR1IoZSl7dGhpcy5fY29sb3JHcmFkaW5nQkdSIT09ZSYmKHRoaXMuX2NvbG9yR3JhZGluZ0JHUj1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IGV4cG9zdXJlKCl7cmV0dXJuIHRoaXMuX2V4cG9zdXJlfXNldCBleHBvc3VyZShlKXt0aGlzLl9leHBvc3VyZSE9PWUmJih0aGlzLl9leHBvc3VyZT1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IHRvbmVNYXBwaW5nRW5hYmxlZCgpe3JldHVybiB0aGlzLl90b25lTWFwcGluZ0VuYWJsZWR9c2V0IHRvbmVNYXBwaW5nRW5hYmxlZChlKXt0aGlzLl90b25lTWFwcGluZ0VuYWJsZWQhPT1lJiYodGhpcy5fdG9uZU1hcHBpbmdFbmFibGVkPWUsdGhpcy5fdXBkYXRlUGFyYW1ldGVycygpKX1nZXQgdG9uZU1hcHBpbmdUeXBlKCl7cmV0dXJuIHRoaXMuX3RvbmVNYXBwaW5nVHlwZX1zZXQgdG9uZU1hcHBpbmdUeXBlKGUpe3RoaXMuX3RvbmVNYXBwaW5nVHlwZSE9PWUmJih0aGlzLl90b25lTWFwcGluZ1R5cGU9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBjb250cmFzdCgpe3JldHVybiB0aGlzLl9jb250cmFzdH1zZXQgY29udHJhc3QoZSl7dGhpcy5fY29udHJhc3QhPT1lJiYodGhpcy5fY29udHJhc3Q9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCB2aWduZXR0ZUNlbnRyZVkoKXtyZXR1cm4gdGhpcy52aWduZXR0ZUNlbnRlcll9c2V0IHZpZ25ldHRlQ2VudHJlWShlKXt0aGlzLnZpZ25ldHRlQ2VudGVyWT1lfWdldCB2aWduZXR0ZUNlbnRyZVgoKXtyZXR1cm4gdGhpcy52aWduZXR0ZUNlbnRlclh9c2V0IHZpZ25ldHRlQ2VudHJlWChlKXt0aGlzLnZpZ25ldHRlQ2VudGVyWD1lfWdldCB2aWduZXR0ZUJsZW5kTW9kZSgpe3JldHVybiB0aGlzLl92aWduZXR0ZUJsZW5kTW9kZX1zZXQgdmlnbmV0dGVCbGVuZE1vZGUoZSl7dGhpcy5fdmlnbmV0dGVCbGVuZE1vZGUhPT1lJiYodGhpcy5fdmlnbmV0dGVCbGVuZE1vZGU9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCB2aWduZXR0ZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fdmlnbmV0dGVFbmFibGVkfXNldCB2aWduZXR0ZUVuYWJsZWQoZSl7dGhpcy5fdmlnbmV0dGVFbmFibGVkIT09ZSYmKHRoaXMuX3ZpZ25ldHRlRW5hYmxlZD1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IGRpdGhlcmluZ0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5fZGl0aGVyaW5nRW5hYmxlZH1zZXQgZGl0aGVyaW5nRW5hYmxlZChlKXt0aGlzLl9kaXRoZXJpbmdFbmFibGVkIT09ZSYmKHRoaXMuX2RpdGhlcmluZ0VuYWJsZWQ9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBkaXRoZXJpbmdJbnRlbnNpdHkoKXtyZXR1cm4gdGhpcy5fZGl0aGVyaW5nSW50ZW5zaXR5fXNldCBkaXRoZXJpbmdJbnRlbnNpdHkoZSl7dGhpcy5fZGl0aGVyaW5nSW50ZW5zaXR5IT09ZSYmKHRoaXMuX2RpdGhlcmluZ0ludGVuc2l0eT1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IHNraXBGaW5hbENvbG9yQ2xhbXAoKXtyZXR1cm4gdGhpcy5fc2tpcEZpbmFsQ29sb3JDbGFtcH1zZXQgc2tpcEZpbmFsQ29sb3JDbGFtcChlKXt0aGlzLl9za2lwRmluYWxDb2xvckNsYW1wIT09ZSYmKHRoaXMuX3NraXBGaW5hbENvbG9yQ2xhbXA9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBhcHBseUJ5UG9zdFByb2Nlc3MoKXtyZXR1cm4gdGhpcy5fYXBwbHlCeVBvc3RQcm9jZXNzfXNldCBhcHBseUJ5UG9zdFByb2Nlc3MoZSl7dGhpcy5fYXBwbHlCeVBvc3RQcm9jZXNzIT09ZSYmKHRoaXMuX2FwcGx5QnlQb3N0UHJvY2Vzcz1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IGlzRW5hYmxlZCgpe3JldHVybiB0aGlzLl9pc0VuYWJsZWR9c2V0IGlzRW5hYmxlZChlKXt0aGlzLl9pc0VuYWJsZWQhPT1lJiYodGhpcy5faXNFbmFibGVkPWUsdGhpcy5fdXBkYXRlUGFyYW1ldGVycygpKX1fdXBkYXRlUGFyYW1ldGVycygpe3RoaXMub25VcGRhdGVQYXJhbWV0ZXJzLm5vdGlmeU9ic2VydmVycyh0aGlzKX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iSW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbiJ9c3RhdGljIFByZXBhcmVVbmlmb3JtcyhlLHQpe3QuRVhQT1NVUkUmJmUucHVzaCgiZXhwb3N1cmVMaW5lYXIiKSx0LkNPTlRSQVNUJiZlLnB1c2goImNvbnRyYXN0IiksdC5DT0xPUkdSQURJTkcmJmUucHVzaCgiY29sb3JUcmFuc2Zvcm1TZXR0aW5ncyIpLCh0LlZJR05FVFRFfHx0LkRJVEhFUikmJmUucHVzaCgidkludmVyc2VTY3JlZW5TaXplIiksdC5WSUdORVRURSYmKGUucHVzaCgidmlnbmV0dGVTZXR0aW5nczEiKSxlLnB1c2goInZpZ25ldHRlU2V0dGluZ3MyIikpLHQuQ09MT1JDVVJWRVMmJkFlLlByZXBhcmVVbmlmb3JtcyhlKSx0LkRJVEhFUiYmZS5wdXNoKCJkaXRoZXJJbnRlbnNpdHkiKX1zdGF0aWMgUHJlcGFyZVNhbXBsZXJzKGUsdCl7dC5DT0xPUkdSQURJTkcmJmUucHVzaCgidHhDb2xvclRyYW5zZm9ybSIpfXByZXBhcmVEZWZpbmVzKGUsdD0hMSl7aWYodCE9PXRoaXMuYXBwbHlCeVBvc3RQcm9jZXNzfHwhdGhpcy5faXNFbmFibGVkKXtlLlZJR05FVFRFPSExLGUuVE9ORU1BUFBJTkc9ITEsZS5UT05FTUFQUElOR19BQ0VTPSExLGUuQ09OVFJBU1Q9ITEsZS5FWFBPU1VSRT0hMSxlLkNPTE9SQ1VSVkVTPSExLGUuQ09MT1JHUkFESU5HPSExLGUuQ09MT1JHUkFESU5HM0Q9ITEsZS5ESVRIRVI9ITEsZS5JTUFHRVBST0NFU1NJTkc9ITEsZS5TS0lQRklOQUxDT0xPUkNMQU1QPXRoaXMuc2tpcEZpbmFsQ29sb3JDbGFtcCxlLklNQUdFUFJPQ0VTU0lOR1BPU1RQUk9DRVNTPXRoaXMuYXBwbHlCeVBvc3RQcm9jZXNzJiZ0aGlzLl9pc0VuYWJsZWQ7cmV0dXJufXN3aXRjaChlLlZJR05FVFRFPXRoaXMudmlnbmV0dGVFbmFibGVkLGUuVklHTkVUVEVCTEVORE1PREVNVUxUSVBMWT10aGlzLnZpZ25ldHRlQmxlbmRNb2RlPT09cGUuX1ZJR05FVFRFTU9ERV9NVUxUSVBMWSxlLlZJR05FVFRFQkxFTkRNT0RFT1BBUVVFPSFlLlZJR05FVFRFQkxFTkRNT0RFTVVMVElQTFksZS5UT05FTUFQUElORz10aGlzLnRvbmVNYXBwaW5nRW5hYmxlZCx0aGlzLl90b25lTWFwcGluZ1R5cGUpe2Nhc2UgcGUuVE9ORU1BUFBJTkdfQUNFUzplLlRPTkVNQVBQSU5HX0FDRVM9ITA7YnJlYWs7ZGVmYXVsdDplLlRPTkVNQVBQSU5HX0FDRVM9ITE7YnJlYWt9ZS5DT05UUkFTVD10aGlzLmNvbnRyYXN0IT09MSxlLkVYUE9TVVJFPXRoaXMuZXhwb3N1cmUhPT0xLGUuQ09MT1JDVVJWRVM9dGhpcy5jb2xvckN1cnZlc0VuYWJsZWQmJiEhdGhpcy5jb2xvckN1cnZlcyxlLkNPTE9SR1JBRElORz10aGlzLmNvbG9yR3JhZGluZ0VuYWJsZWQmJiEhdGhpcy5jb2xvckdyYWRpbmdUZXh0dXJlLGUuQ09MT1JHUkFESU5HP2UuQ09MT1JHUkFESU5HM0Q9dGhpcy5jb2xvckdyYWRpbmdUZXh0dXJlLmlzM0Q6ZS5DT0xPUkdSQURJTkczRD0hMSxlLlNBTVBMRVIzREdSRUVOREVQVEg9dGhpcy5jb2xvckdyYWRpbmdXaXRoR3JlZW5EZXB0aCxlLlNBTVBMRVIzREJHUk1BUD10aGlzLmNvbG9yR3JhZGluZ0JHUixlLkRJVEhFUj10aGlzLl9kaXRoZXJpbmdFbmFibGVkLGUuSU1BR0VQUk9DRVNTSU5HUE9TVFBST0NFU1M9dGhpcy5hcHBseUJ5UG9zdFByb2Nlc3MsZS5TS0lQRklOQUxDT0xPUkNMQU1QPXRoaXMuc2tpcEZpbmFsQ29sb3JDbGFtcCxlLklNQUdFUFJPQ0VTU0lORz1lLlZJR05FVFRFfHxlLlRPTkVNQVBQSU5HfHxlLkNPTlRSQVNUfHxlLkVYUE9TVVJFfHxlLkNPTE9SQ1VSVkVTfHxlLkNPTE9SR1JBRElOR3x8ZS5ESVRIRVJ9aXNSZWFkeSgpe3JldHVybiF0aGlzLmNvbG9yR3JhZGluZ0VuYWJsZWR8fCF0aGlzLmNvbG9yR3JhZGluZ1RleHR1cmV8fHRoaXMuY29sb3JHcmFkaW5nVGV4dHVyZS5pc1JlYWR5KCl9YmluZChlLHQpe2lmKHRoaXMuX2NvbG9yQ3VydmVzRW5hYmxlZCYmdGhpcy5jb2xvckN1cnZlcyYmQWUuQmluZCh0aGlzLmNvbG9yQ3VydmVzLGUpLHRoaXMuX3ZpZ25ldHRlRW5hYmxlZHx8dGhpcy5fZGl0aGVyaW5nRW5hYmxlZCl7Y29uc3QgaT0xL2UuZ2V0RW5naW5lKCkuZ2V0UmVuZGVyV2lkdGgoKSxzPTEvZS5nZXRFbmdpbmUoKS5nZXRSZW5kZXJIZWlnaHQoKTtpZihlLnNldEZsb2F0MigidkludmVyc2VTY3JlZW5TaXplIixpLHMpLHRoaXMuX2RpdGhlcmluZ0VuYWJsZWQmJmUuc2V0RmxvYXQoImRpdGhlckludGVuc2l0eSIsLjUqdGhpcy5fZGl0aGVyaW5nSW50ZW5zaXR5KSx0aGlzLl92aWduZXR0ZUVuYWJsZWQpe2NvbnN0IHI9dD8/cy9pO2xldCBuPU1hdGgudGFuKHRoaXMudmlnbmV0dGVDYW1lcmFGb3YqLjUpLGE9bipyO2NvbnN0IG89TWF0aC5zcXJ0KGEqbik7YT1ILk1peChhLG8sdGhpcy52aWduZXR0ZVN0cmV0Y2gpLG49SC5NaXgobixvLHRoaXMudmlnbmV0dGVTdHJldGNoKSxlLnNldEZsb2F0NCgidmlnbmV0dGVTZXR0aW5nczEiLGEsbiwtYSp0aGlzLnZpZ25ldHRlQ2VudGVyWCwtbip0aGlzLnZpZ25ldHRlQ2VudGVyWSk7Y29uc3QgaD0tMip0aGlzLnZpZ25ldHRlV2VpZ2h0O2Uuc2V0RmxvYXQ0KCJ2aWduZXR0ZVNldHRpbmdzMiIsdGhpcy52aWduZXR0ZUNvbG9yLnIsdGhpcy52aWduZXR0ZUNvbG9yLmcsdGhpcy52aWduZXR0ZUNvbG9yLmIsaCl9fWlmKGUuc2V0RmxvYXQoImV4cG9zdXJlTGluZWFyIix0aGlzLmV4cG9zdXJlKSxlLnNldEZsb2F0KCJjb250cmFzdCIsdGhpcy5jb250cmFzdCksdGhpcy5jb2xvckdyYWRpbmdUZXh0dXJlKXtlLnNldFRleHR1cmUoInR4Q29sb3JUcmFuc2Zvcm0iLHRoaXMuY29sb3JHcmFkaW5nVGV4dHVyZSk7Y29uc3QgaT10aGlzLmNvbG9yR3JhZGluZ1RleHR1cmUuZ2V0U2l6ZSgpLmhlaWdodDtlLnNldEZsb2F0NCgiY29sb3JUcmFuc2Zvcm1TZXR0aW5ncyIsKGktMSkvaSwuNS9pLGksdGhpcy5jb2xvckdyYWRpbmdUZXh0dXJlLmxldmVsKX19Y2xvbmUoKXtyZXR1cm4gYWUuQ2xvbmUoKCk9Pm5ldyBwZSx0aGlzKX1zZXJpYWxpemUoKXtyZXR1cm4gYWUuU2VyaWFsaXplKHRoaXMpfXN0YXRpYyBQYXJzZShlKXtjb25zdCB0PWFlLlBhcnNlKCgpPT5uZXcgcGUsZSxudWxsLG51bGwpO3JldHVybiBlLnZpZ25ldHRlQ2VudHJlWCE9PXZvaWQgMCYmKHQudmlnbmV0dGVDZW50ZXJYPWUudmlnbmV0dGVDZW50cmVYKSxlLnZpZ25ldHRlQ2VudHJlWSE9PXZvaWQgMCYmKHQudmlnbmV0dGVDZW50ZXJZPWUudmlnbmV0dGVDZW50cmVZKSx0fXN0YXRpYyBnZXQgVklHTkVUVEVNT0RFX01VTFRJUExZKCl7cmV0dXJuIHRoaXMuX1ZJR05FVFRFTU9ERV9NVUxUSVBMWX1zdGF0aWMgZ2V0IFZJR05FVFRFTU9ERV9PUEFRVUUoKXtyZXR1cm4gdGhpcy5fVklHTkVUVEVNT0RFX09QQVFVRX19cGUuVE9ORU1BUFBJTkdfU1RBTkRBUkQ9MCxwZS5UT05FTUFQUElOR19BQ0VTPTEscGUuX1ZJR05FVFRFTU9ERV9NVUxUSVBMWT0wLHBlLl9WSUdORVRURU1PREVfT1BBUVVFPTEsVChbQW4oKV0scGUucHJvdG90eXBlLCJjb2xvckN1cnZlcyIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwiX2NvbG9yQ3VydmVzRW5hYmxlZCIsdm9pZCAwKSxUKFttdCgiY29sb3JHcmFkaW5nVGV4dHVyZSIpXSxwZS5wcm90b3R5cGUsIl9jb2xvckdyYWRpbmdUZXh0dXJlIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJfY29sb3JHcmFkaW5nRW5hYmxlZCIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwiX2NvbG9yR3JhZGluZ1dpdGhHcmVlbkRlcHRoIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJfY29sb3JHcmFkaW5nQkdSIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJfZXhwb3N1cmUiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsIl90b25lTWFwcGluZ0VuYWJsZWQiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsIl90b25lTWFwcGluZ1R5cGUiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsIl9jb250cmFzdCIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwidmlnbmV0dGVTdHJldGNoIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJ2aWduZXR0ZUNlbnRlclgiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsInZpZ25ldHRlQ2VudGVyWSIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwidmlnbmV0dGVXZWlnaHQiLHZvaWQgMCksVChbZHIoKV0scGUucHJvdG90eXBlLCJ2aWduZXR0ZUNvbG9yIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJ2aWduZXR0ZUNhbWVyYUZvdiIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwiX3ZpZ25ldHRlQmxlbmRNb2RlIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJfdmlnbmV0dGVFbmFibGVkIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJfZGl0aGVyaW5nRW5hYmxlZCIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwiX2RpdGhlcmluZ0ludGVuc2l0eSIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwiX3NraXBGaW5hbENvbG9yQ2xhbXAiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsIl9hcHBseUJ5UG9zdFByb2Nlc3MiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsIl9pc0VuYWJsZWQiLHZvaWQgMCksYWUuX0ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb25QYXJzZXI9cGUuUGFyc2Usb2UucHJvdG90eXBlLmNyZWF0ZVVuaWZvcm1CdWZmZXI9ZnVuY3Rpb24oYyl7Y29uc3QgZT10aGlzLl9nbC5jcmVhdGVCdWZmZXIoKTtpZighZSl0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBjcmVhdGUgdW5pZm9ybSBidWZmZXIiKTtjb25zdCB0PW5ldyBEaShlKTtyZXR1cm4gdGhpcy5iaW5kVW5pZm9ybUJ1ZmZlcih0KSxjIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5P3RoaXMuX2dsLmJ1ZmZlckRhdGEodGhpcy5fZ2wuVU5JRk9STV9CVUZGRVIsYyx0aGlzLl9nbC5TVEFUSUNfRFJBVyk6dGhpcy5fZ2wuYnVmZmVyRGF0YSh0aGlzLl9nbC5VTklGT1JNX0JVRkZFUixuZXcgRmxvYXQzMkFycmF5KGMpLHRoaXMuX2dsLlNUQVRJQ19EUkFXKSx0aGlzLmJpbmRVbmlmb3JtQnVmZmVyKG51bGwpLHQucmVmZXJlbmNlcz0xLHR9LG9lLnByb3RvdHlwZS5jcmVhdGVEeW5hbWljVW5pZm9ybUJ1ZmZlcj1mdW5jdGlvbihjKXtjb25zdCBlPXRoaXMuX2dsLmNyZWF0ZUJ1ZmZlcigpO2lmKCFlKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSBkeW5hbWljIHVuaWZvcm0gYnVmZmVyIik7Y29uc3QgdD1uZXcgRGkoZSk7cmV0dXJuIHRoaXMuYmluZFVuaWZvcm1CdWZmZXIodCksYyBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheT90aGlzLl9nbC5idWZmZXJEYXRhKHRoaXMuX2dsLlVOSUZPUk1fQlVGRkVSLGMsdGhpcy5fZ2wuRFlOQU1JQ19EUkFXKTp0aGlzLl9nbC5idWZmZXJEYXRhKHRoaXMuX2dsLlVOSUZPUk1fQlVGRkVSLG5ldyBGbG9hdDMyQXJyYXkoYyksdGhpcy5fZ2wuRFlOQU1JQ19EUkFXKSx0aGlzLmJpbmRVbmlmb3JtQnVmZmVyKG51bGwpLHQucmVmZXJlbmNlcz0xLHR9LG9lLnByb3RvdHlwZS51cGRhdGVVbmlmb3JtQnVmZmVyPWZ1bmN0aW9uKGMsZSx0LGkpe3RoaXMuYmluZFVuaWZvcm1CdWZmZXIoYyksdD09PXZvaWQgMCYmKHQ9MCksaT09PXZvaWQgMD9lIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5P3RoaXMuX2dsLmJ1ZmZlclN1YkRhdGEodGhpcy5fZ2wuVU5JRk9STV9CVUZGRVIsdCxlKTp0aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLlVOSUZPUk1fQlVGRkVSLHQsbmV3IEZsb2F0MzJBcnJheShlKSk6ZSBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheT90aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLlVOSUZPUk1fQlVGRkVSLDAsZS5zdWJhcnJheSh0LHQraSkpOnRoaXMuX2dsLmJ1ZmZlclN1YkRhdGEodGhpcy5fZ2wuVU5JRk9STV9CVUZGRVIsMCxuZXcgRmxvYXQzMkFycmF5KGUpLnN1YmFycmF5KHQsdCtpKSksdGhpcy5iaW5kVW5pZm9ybUJ1ZmZlcihudWxsKX0sb2UucHJvdG90eXBlLmJpbmRVbmlmb3JtQnVmZmVyPWZ1bmN0aW9uKGMpe3RoaXMuX2dsLmJpbmRCdWZmZXIodGhpcy5fZ2wuVU5JRk9STV9CVUZGRVIsYz9jLnVuZGVybHlpbmdSZXNvdXJjZTpudWxsKX0sb2UucHJvdG90eXBlLmJpbmRVbmlmb3JtQnVmZmVyQmFzZT1mdW5jdGlvbihjLGUsdCl7dGhpcy5fZ2wuYmluZEJ1ZmZlckJhc2UodGhpcy5fZ2wuVU5JRk9STV9CVUZGRVIsZSxjP2MudW5kZXJseWluZ1Jlc291cmNlOm51bGwpfSxvZS5wcm90b3R5cGUuYmluZFVuaWZvcm1CbG9jaz1mdW5jdGlvbihjLGUsdCl7Y29uc3QgaT1jLnByb2dyYW0scz10aGlzLl9nbC5nZXRVbmlmb3JtQmxvY2tJbmRleChpLGUpO3MhPT00Mjk0OTY3Mjk1JiZ0aGlzLl9nbC51bmlmb3JtQmxvY2tCaW5kaW5nKGkscyx0KX07Y2xhc3MgVntjb25zdHJ1Y3RvcihlLHQsaSxzLHI9ITEpe3RoaXMuX3ZhbHVlQ2FjaGU9e30sdGhpcy5fZW5naW5lPWUsdGhpcy5fbm9VQk89IWUuc3VwcG9ydHNVbmlmb3JtQnVmZmVyc3x8cix0aGlzLl9keW5hbWljPWksdGhpcy5fbmFtZT1zPz8ibm8tbmFtZSIsdGhpcy5fZGF0YT10fHxbXSx0aGlzLl91bmlmb3JtTG9jYXRpb25zPXt9LHRoaXMuX3VuaWZvcm1TaXplcz17fSx0aGlzLl91bmlmb3JtQXJyYXlTaXplcz17fSx0aGlzLl91bmlmb3JtTG9jYXRpb25Qb2ludGVyPTAsdGhpcy5fbmVlZFN5bmM9ITEsdGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lJiYodGhpcy5fYnVmZmVycz1bXSx0aGlzLl9idWZmZXJJbmRleD0tMSx0aGlzLl9jcmVhdGVCdWZmZXJPbldyaXRlPSExLHRoaXMuX2N1cnJlbnRGcmFtZUlkPTApLHRoaXMuX25vVUJPPyh0aGlzLnVwZGF0ZU1hdHJpeDN4Mz10aGlzLl91cGRhdGVNYXRyaXgzeDNGb3JFZmZlY3QsdGhpcy51cGRhdGVNYXRyaXgyeDI9dGhpcy5fdXBkYXRlTWF0cml4MngyRm9yRWZmZWN0LHRoaXMudXBkYXRlRmxvYXQ9dGhpcy5fdXBkYXRlRmxvYXRGb3JFZmZlY3QsdGhpcy51cGRhdGVGbG9hdDI9dGhpcy5fdXBkYXRlRmxvYXQyRm9yRWZmZWN0LHRoaXMudXBkYXRlRmxvYXQzPXRoaXMuX3VwZGF0ZUZsb2F0M0ZvckVmZmVjdCx0aGlzLnVwZGF0ZUZsb2F0ND10aGlzLl91cGRhdGVGbG9hdDRGb3JFZmZlY3QsdGhpcy51cGRhdGVGbG9hdEFycmF5PXRoaXMuX3VwZGF0ZUZsb2F0QXJyYXlGb3JFZmZlY3QsdGhpcy51cGRhdGVBcnJheT10aGlzLl91cGRhdGVBcnJheUZvckVmZmVjdCx0aGlzLnVwZGF0ZUludEFycmF5PXRoaXMuX3VwZGF0ZUludEFycmF5Rm9yRWZmZWN0LHRoaXMudXBkYXRlVUludEFycmF5PXRoaXMuX3VwZGF0ZVVJbnRBcnJheUZvckVmZmVjdCx0aGlzLnVwZGF0ZU1hdHJpeD10aGlzLl91cGRhdGVNYXRyaXhGb3JFZmZlY3QsdGhpcy51cGRhdGVNYXRyaWNlcz10aGlzLl91cGRhdGVNYXRyaWNlc0ZvckVmZmVjdCx0aGlzLnVwZGF0ZVZlY3RvcjM9dGhpcy5fdXBkYXRlVmVjdG9yM0ZvckVmZmVjdCx0aGlzLnVwZGF0ZVZlY3RvcjQ9dGhpcy5fdXBkYXRlVmVjdG9yNEZvckVmZmVjdCx0aGlzLnVwZGF0ZUNvbG9yMz10aGlzLl91cGRhdGVDb2xvcjNGb3JFZmZlY3QsdGhpcy51cGRhdGVDb2xvcjQ9dGhpcy5fdXBkYXRlQ29sb3I0Rm9yRWZmZWN0LHRoaXMudXBkYXRlRGlyZWN0Q29sb3I0PXRoaXMuX3VwZGF0ZURpcmVjdENvbG9yNEZvckVmZmVjdCx0aGlzLnVwZGF0ZUludD10aGlzLl91cGRhdGVJbnRGb3JFZmZlY3QsdGhpcy51cGRhdGVJbnQyPXRoaXMuX3VwZGF0ZUludDJGb3JFZmZlY3QsdGhpcy51cGRhdGVJbnQzPXRoaXMuX3VwZGF0ZUludDNGb3JFZmZlY3QsdGhpcy51cGRhdGVJbnQ0PXRoaXMuX3VwZGF0ZUludDRGb3JFZmZlY3QsdGhpcy51cGRhdGVVSW50PXRoaXMuX3VwZGF0ZVVJbnRGb3JFZmZlY3QsdGhpcy51cGRhdGVVSW50Mj10aGlzLl91cGRhdGVVSW50MkZvckVmZmVjdCx0aGlzLnVwZGF0ZVVJbnQzPXRoaXMuX3VwZGF0ZVVJbnQzRm9yRWZmZWN0LHRoaXMudXBkYXRlVUludDQ9dGhpcy5fdXBkYXRlVUludDRGb3JFZmZlY3QpOih0aGlzLl9lbmdpbmUuX3VuaWZvcm1CdWZmZXJzLnB1c2godGhpcyksdGhpcy51cGRhdGVNYXRyaXgzeDM9dGhpcy5fdXBkYXRlTWF0cml4M3gzRm9yVW5pZm9ybSx0aGlzLnVwZGF0ZU1hdHJpeDJ4Mj10aGlzLl91cGRhdGVNYXRyaXgyeDJGb3JVbmlmb3JtLHRoaXMudXBkYXRlRmxvYXQ9dGhpcy5fdXBkYXRlRmxvYXRGb3JVbmlmb3JtLHRoaXMudXBkYXRlRmxvYXQyPXRoaXMuX3VwZGF0ZUZsb2F0MkZvclVuaWZvcm0sdGhpcy51cGRhdGVGbG9hdDM9dGhpcy5fdXBkYXRlRmxvYXQzRm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUZsb2F0ND10aGlzLl91cGRhdGVGbG9hdDRGb3JVbmlmb3JtLHRoaXMudXBkYXRlRmxvYXRBcnJheT10aGlzLl91cGRhdGVGbG9hdEFycmF5Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUFycmF5PXRoaXMuX3VwZGF0ZUFycmF5Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUludEFycmF5PXRoaXMuX3VwZGF0ZUludEFycmF5Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZVVJbnRBcnJheT10aGlzLl91cGRhdGVVSW50QXJyYXlGb3JVbmlmb3JtLHRoaXMudXBkYXRlTWF0cml4PXRoaXMuX3VwZGF0ZU1hdHJpeEZvclVuaWZvcm0sdGhpcy51cGRhdGVNYXRyaWNlcz10aGlzLl91cGRhdGVNYXRyaWNlc0ZvclVuaWZvcm0sdGhpcy51cGRhdGVWZWN0b3IzPXRoaXMuX3VwZGF0ZVZlY3RvcjNGb3JVbmlmb3JtLHRoaXMudXBkYXRlVmVjdG9yND10aGlzLl91cGRhdGVWZWN0b3I0Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUNvbG9yMz10aGlzLl91cGRhdGVDb2xvcjNGb3JVbmlmb3JtLHRoaXMudXBkYXRlQ29sb3I0PXRoaXMuX3VwZGF0ZUNvbG9yNEZvclVuaWZvcm0sdGhpcy51cGRhdGVEaXJlY3RDb2xvcjQ9dGhpcy5fdXBkYXRlRGlyZWN0Q29sb3I0Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUludD10aGlzLl91cGRhdGVJbnRGb3JVbmlmb3JtLHRoaXMudXBkYXRlSW50Mj10aGlzLl91cGRhdGVJbnQyRm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUludDM9dGhpcy5fdXBkYXRlSW50M0ZvclVuaWZvcm0sdGhpcy51cGRhdGVJbnQ0PXRoaXMuX3VwZGF0ZUludDRGb3JVbmlmb3JtLHRoaXMudXBkYXRlVUludD10aGlzLl91cGRhdGVVSW50Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZVVJbnQyPXRoaXMuX3VwZGF0ZVVJbnQyRm9yVW5pZm9ybSx0aGlzLnVwZGF0ZVVJbnQzPXRoaXMuX3VwZGF0ZVVJbnQzRm9yVW5pZm9ybSx0aGlzLnVwZGF0ZVVJbnQ0PXRoaXMuX3VwZGF0ZVVJbnQ0Rm9yVW5pZm9ybSl9Z2V0IHVzZVVibygpe3JldHVybiF0aGlzLl9ub1VCT31nZXQgaXNTeW5jKCl7cmV0dXJuIXRoaXMuX25lZWRTeW5jfWlzRHluYW1pYygpe3JldHVybiB0aGlzLl9keW5hbWljIT09dm9pZCAwfWdldERhdGEoKXtyZXR1cm4gdGhpcy5fYnVmZmVyRGF0YX1nZXRCdWZmZXIoKXtyZXR1cm4gdGhpcy5fYnVmZmVyfV9maWxsQWxpZ25tZW50KGUpe2xldCB0O2lmKGU8PTI/dD1lOnQ9NCx0aGlzLl91bmlmb3JtTG9jYXRpb25Qb2ludGVyJXQhPT0wKXtjb25zdCBpPXRoaXMuX3VuaWZvcm1Mb2NhdGlvblBvaW50ZXI7dGhpcy5fdW5pZm9ybUxvY2F0aW9uUG9pbnRlcis9dC10aGlzLl91bmlmb3JtTG9jYXRpb25Qb2ludGVyJXQ7Y29uc3Qgcz10aGlzLl91bmlmb3JtTG9jYXRpb25Qb2ludGVyLWk7Zm9yKGxldCByPTA7cjxzO3IrKyl0aGlzLl9kYXRhLnB1c2goMCl9fWFkZFVuaWZvcm0oZSx0LGk9MCl7aWYodGhpcy5fbm9VQk98fHRoaXMuX3VuaWZvcm1Mb2NhdGlvbnNbZV0hPT12b2lkIDApcmV0dXJuO2xldCBzO2lmKGk+MCl7aWYodCBpbnN0YW5jZW9mIEFycmF5KXRocm93ImFkZFVuaWZvcm0gc2hvdWxkIG5vdCBiZSB1c2Ugd2l0aCBBcnJheSBpbiBVQk86ICIrZTtpZih0aGlzLl9maWxsQWxpZ25tZW50KDQpLHRoaXMuX3VuaWZvcm1BcnJheVNpemVzW2VdPXtzdHJpZGVTaXplOnQsYXJyYXlTaXplOml9LHQ9PTE2KXQ9dCppO2Vsc2V7Y29uc3Qgbj0oNC10KSppO3Q9dCppK259cz1bXTtmb3IobGV0IHI9MDtyPHQ7cisrKXMucHVzaCgwKX1lbHNle2lmKHQgaW5zdGFuY2VvZiBBcnJheSlzPXQsdD1zLmxlbmd0aDtlbHNle3Q9dCxzPVtdO2ZvcihsZXQgcj0wO3I8dDtyKyspcy5wdXNoKDApfXRoaXMuX2ZpbGxBbGlnbm1lbnQodCl9dGhpcy5fdW5pZm9ybVNpemVzW2VdPXQsdGhpcy5fdW5pZm9ybUxvY2F0aW9uc1tlXT10aGlzLl91bmlmb3JtTG9jYXRpb25Qb2ludGVyLHRoaXMuX3VuaWZvcm1Mb2NhdGlvblBvaW50ZXIrPXQ7Zm9yKGxldCByPTA7cjx0O3IrKyl0aGlzLl9kYXRhLnB1c2goc1tyXSk7dGhpcy5fbmVlZFN5bmM9ITB9YWRkTWF0cml4KGUsdCl7dGhpcy5hZGRVbmlmb3JtKGUsQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodC50b0FycmF5KCkpKX1hZGRGbG9hdDIoZSx0LGkpe2NvbnN0IHM9W3QsaV07dGhpcy5hZGRVbmlmb3JtKGUscyl9YWRkRmxvYXQzKGUsdCxpLHMpe2NvbnN0IHI9W3QsaSxzXTt0aGlzLmFkZFVuaWZvcm0oZSxyKX1hZGRDb2xvcjMoZSx0KXtjb25zdCBpPVt0LnIsdC5nLHQuYl07dGhpcy5hZGRVbmlmb3JtKGUsaSl9YWRkQ29sb3I0KGUsdCxpKXtjb25zdCBzPVt0LnIsdC5nLHQuYixpXTt0aGlzLmFkZFVuaWZvcm0oZSxzKX1hZGRWZWN0b3IzKGUsdCl7Y29uc3QgaT1bdC54LHQueSx0LnpdO3RoaXMuYWRkVW5pZm9ybShlLGkpfWFkZE1hdHJpeDN4MyhlKXt0aGlzLmFkZFVuaWZvcm0oZSwxMil9YWRkTWF0cml4MngyKGUpe3RoaXMuYWRkVW5pZm9ybShlLDgpfWNyZWF0ZSgpe3RoaXMuX25vVUJPfHx0aGlzLl9idWZmZXJ8fCh0aGlzLl9maWxsQWxpZ25tZW50KDQpLHRoaXMuX2J1ZmZlckRhdGE9bmV3IEZsb2F0MzJBcnJheSh0aGlzLl9kYXRhKSx0aGlzLl9yZWJ1aWxkKCksdGhpcy5fbmVlZFN5bmM9ITApfV9yZWJ1aWxkKCl7dGhpcy5fbm9VQk98fCF0aGlzLl9idWZmZXJEYXRhfHwodGhpcy5fZHluYW1pYz90aGlzLl9idWZmZXI9dGhpcy5fZW5naW5lLmNyZWF0ZUR5bmFtaWNVbmlmb3JtQnVmZmVyKHRoaXMuX2J1ZmZlckRhdGEpOnRoaXMuX2J1ZmZlcj10aGlzLl9lbmdpbmUuY3JlYXRlVW5pZm9ybUJ1ZmZlcih0aGlzLl9idWZmZXJEYXRhKSx0aGlzLl9lbmdpbmUuX2ZlYXR1cmVzLnRyYWNrVWJvc0luRnJhbWUmJih0aGlzLl9idWZmZXJzLnB1c2goW3RoaXMuX2J1ZmZlcix0aGlzLl9lbmdpbmUuX2ZlYXR1cmVzLmNoZWNrVWJvc0NvbnRlbnRCZWZvcmVVcGxvYWQ/dGhpcy5fYnVmZmVyRGF0YS5zbGljZSgpOnZvaWQgMF0pLHRoaXMuX2J1ZmZlckluZGV4PXRoaXMuX2J1ZmZlcnMubGVuZ3RoLTEsdGhpcy5fY3JlYXRlQnVmZmVyT25Xcml0ZT0hMSkpfWdldCBfbnVtQnVmZmVycygpe3JldHVybiB0aGlzLl9idWZmZXJzLmxlbmd0aH1nZXQgX2luZGV4QnVmZmVyKCl7cmV0dXJuIHRoaXMuX2J1ZmZlckluZGV4fWdldCBuYW1lKCl7cmV0dXJuIHRoaXMuX25hbWV9X2J1ZmZlcnNFcXVhbChlLHQpe2ZvcihsZXQgaT0wO2k8ZS5sZW5ndGg7KytpKWlmKGVbaV0hPT10W2ldKXJldHVybiExO3JldHVybiEwfV9jb3B5QnVmZmVyKGUsdCl7Zm9yKGxldCBpPTA7aTxlLmxlbmd0aDsrK2kpdFtpXT1lW2ldfXVwZGF0ZSgpe2lmKCF0aGlzLl9ub1VCTyl7aWYodGhpcy5iaW5kVW5pZm9ybUJ1ZmZlcigpLCF0aGlzLl9idWZmZXIpe3RoaXMuY3JlYXRlKCk7cmV0dXJufWlmKCF0aGlzLl9keW5hbWljJiYhdGhpcy5fbmVlZFN5bmMpe3RoaXMuX2NyZWF0ZUJ1ZmZlck9uV3JpdGU9dGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lO3JldHVybn1pZih0aGlzLl9idWZmZXJzJiZ0aGlzLl9idWZmZXJzLmxlbmd0aD4xJiZ0aGlzLl9idWZmZXJzW3RoaXMuX2J1ZmZlckluZGV4XVsxXSlpZih0aGlzLl9idWZmZXJzRXF1YWwodGhpcy5fYnVmZmVyRGF0YSx0aGlzLl9idWZmZXJzW3RoaXMuX2J1ZmZlckluZGV4XVsxXSkpe3RoaXMuX25lZWRTeW5jPSExLHRoaXMuX2NyZWF0ZUJ1ZmZlck9uV3JpdGU9dGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lO3JldHVybn1lbHNlIHRoaXMuX2NvcHlCdWZmZXIodGhpcy5fYnVmZmVyRGF0YSx0aGlzLl9idWZmZXJzW3RoaXMuX2J1ZmZlckluZGV4XVsxXSk7dGhpcy5fZW5naW5lLnVwZGF0ZVVuaWZvcm1CdWZmZXIodGhpcy5fYnVmZmVyLHRoaXMuX2J1ZmZlckRhdGEpLHRoaXMuX2VuZ2luZS5fZmVhdHVyZXMuX2NvbGxlY3RVYm9zVXBkYXRlZEluRnJhbWUmJihWLl9VcGRhdGVkVWJvc0luRnJhbWVbdGhpcy5fbmFtZV18fChWLl9VcGRhdGVkVWJvc0luRnJhbWVbdGhpcy5fbmFtZV09MCksVi5fVXBkYXRlZFVib3NJbkZyYW1lW3RoaXMuX25hbWVdKyspLHRoaXMuX25lZWRTeW5jPSExLHRoaXMuX2NyZWF0ZUJ1ZmZlck9uV3JpdGU9dGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lfX1fY3JlYXRlTmV3QnVmZmVyKCl7dGhpcy5fYnVmZmVySW5kZXgrMTx0aGlzLl9idWZmZXJzLmxlbmd0aD8odGhpcy5fYnVmZmVySW5kZXgrKyx0aGlzLl9idWZmZXI9dGhpcy5fYnVmZmVyc1t0aGlzLl9idWZmZXJJbmRleF1bMF0sdGhpcy5fY3JlYXRlQnVmZmVyT25Xcml0ZT0hMSx0aGlzLl9uZWVkU3luYz0hMCk6dGhpcy5fcmVidWlsZCgpfV9jaGVja05ld0ZyYW1lKCl7dGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lJiZ0aGlzLl9jdXJyZW50RnJhbWVJZCE9PXRoaXMuX2VuZ2luZS5mcmFtZUlkJiYodGhpcy5fY3VycmVudEZyYW1lSWQ9dGhpcy5fZW5naW5lLmZyYW1lSWQsdGhpcy5fY3JlYXRlQnVmZmVyT25Xcml0ZT0hMSx0aGlzLl9idWZmZXJzJiZ0aGlzLl9idWZmZXJzLmxlbmd0aD4wPyh0aGlzLl9uZWVkU3luYz10aGlzLl9idWZmZXJJbmRleCE9PTAsdGhpcy5fYnVmZmVySW5kZXg9MCx0aGlzLl9idWZmZXI9dGhpcy5fYnVmZmVyc1t0aGlzLl9idWZmZXJJbmRleF1bMF0pOnRoaXMuX2J1ZmZlckluZGV4PS0xKX11cGRhdGVVbmlmb3JtKGUsdCxpKXt0aGlzLl9jaGVja05ld0ZyYW1lKCk7bGV0IHM9dGhpcy5fdW5pZm9ybUxvY2F0aW9uc1tlXTtpZihzPT09dm9pZCAwKXtpZih0aGlzLl9idWZmZXIpe08uRXJyb3IoIkNhbm5vdCBhZGQgYW4gdW5pZm9ybSBhZnRlciBVQk8gaGFzIGJlZW4gY3JlYXRlZC4iKTtyZXR1cm59dGhpcy5hZGRVbmlmb3JtKGUsaSkscz10aGlzLl91bmlmb3JtTG9jYXRpb25zW2VdfWlmKHRoaXMuX2J1ZmZlcnx8dGhpcy5jcmVhdGUoKSx0aGlzLl9keW5hbWljKWZvcihsZXQgcj0wO3I8aTtyKyspdGhpcy5fYnVmZmVyRGF0YVtzK3JdPXRbcl07ZWxzZXtsZXQgcj0hMTtmb3IobGV0IG49MDtuPGk7bisrKShpPT09MTYmJiF0aGlzLl9lbmdpbmUuX2ZlYXR1cmVzLnVuaWZvcm1CdWZmZXJIYXJkQ2hlY2tNYXRyaXh8fHRoaXMuX2J1ZmZlckRhdGFbcytuXSE9PUguRmxvYXRSb3VuZCh0W25dKSkmJihyPSEwLHRoaXMuX2NyZWF0ZUJ1ZmZlck9uV3JpdGUmJnRoaXMuX2NyZWF0ZU5ld0J1ZmZlcigpLHRoaXMuX2J1ZmZlckRhdGFbcytuXT10W25dKTt0aGlzLl9uZWVkU3luYz10aGlzLl9uZWVkU3luY3x8cn19dXBkYXRlVW5pZm9ybUFycmF5KGUsdCxpKXt0aGlzLl9jaGVja05ld0ZyYW1lKCk7Y29uc3Qgcz10aGlzLl91bmlmb3JtTG9jYXRpb25zW2VdO2lmKHM9PT12b2lkIDApe08uRXJyb3IoIkNhbm5vdCBhZGQgYW4gdW5pZm9ybSBBcnJheSBkeW5hbWljYWxseS4gUGxlYXNlLCBhZGQgaXQgdXNpbmcgYWRkVW5pZm9ybSBhbmQgbWFrZSBzdXJlIHRoYXQgdW5pZm9ybSBidWZmZXJzIGFyZSBzdXBwb3J0ZWQgYnkgdGhlIGN1cnJlbnQgZW5naW5lLiIpO3JldHVybn10aGlzLl9idWZmZXJ8fHRoaXMuY3JlYXRlKCk7Y29uc3Qgcj10aGlzLl91bmlmb3JtQXJyYXlTaXplc1tlXTtpZih0aGlzLl9keW5hbWljKWZvcihsZXQgbj0wO248aTtuKyspdGhpcy5fYnVmZmVyRGF0YVtzK25dPXRbbl07ZWxzZXtsZXQgbj0hMSxhPTAsbz0wO2ZvcihsZXQgaD0wO2g8aTtoKyspaWYodGhpcy5fYnVmZmVyRGF0YVtzK28qNCthXSE9PUguRmxvYXRSb3VuZCh0W2hdKSYmKG49ITAsdGhpcy5fY3JlYXRlQnVmZmVyT25Xcml0ZSYmdGhpcy5fY3JlYXRlTmV3QnVmZmVyKCksdGhpcy5fYnVmZmVyRGF0YVtzK28qNCthXT10W2hdKSxhKyssYT09PXIuc3RyaWRlU2l6ZSl7Zm9yKDthPDQ7YSsrKXRoaXMuX2J1ZmZlckRhdGFbcytvKjQrYV09MDthPTAsbysrfXRoaXMuX25lZWRTeW5jPXRoaXMuX25lZWRTeW5jfHxufX1fY2FjaGVNYXRyaXgoZSx0KXt0aGlzLl9jaGVja05ld0ZyYW1lKCk7Y29uc3QgaT10aGlzLl92YWx1ZUNhY2hlW2VdLHM9dC51cGRhdGVGbGFnO3JldHVybiBpIT09dm9pZCAwJiZpPT09cz8hMToodGhpcy5fdmFsdWVDYWNoZVtlXT1zLCEwKX1fdXBkYXRlTWF0cml4M3gzRm9yVW5pZm9ybShlLHQpe2ZvcihsZXQgaT0wO2k8MztpKyspVi5fVGVtcEJ1ZmZlcltpKjRdPXRbaSozXSxWLl9UZW1wQnVmZmVyW2kqNCsxXT10W2kqMysxXSxWLl9UZW1wQnVmZmVyW2kqNCsyXT10W2kqMysyXSxWLl9UZW1wQnVmZmVyW2kqNCszXT0wO3RoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsMTIpfV91cGRhdGVNYXRyaXgzeDNGb3JFZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldE1hdHJpeDN4MyhlLHQpfV91cGRhdGVNYXRyaXgyeDJGb3JFZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldE1hdHJpeDJ4MihlLHQpfV91cGRhdGVNYXRyaXgyeDJGb3JVbmlmb3JtKGUsdCl7Zm9yKGxldCBpPTA7aTwyO2krKylWLl9UZW1wQnVmZmVyW2kqNF09dFtpKjJdLFYuX1RlbXBCdWZmZXJbaSo0KzFdPXRbaSoyKzFdLFYuX1RlbXBCdWZmZXJbaSo0KzJdPTAsVi5fVGVtcEJ1ZmZlcltpKjQrM109MDt0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDgpfV91cGRhdGVGbG9hdEZvckVmZmVjdChlLHQpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0RmxvYXQoZSx0KX1fdXBkYXRlRmxvYXRGb3JVbmlmb3JtKGUsdCl7Vi5fVGVtcEJ1ZmZlclswXT10LHRoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsMSl9X3VwZGF0ZUZsb2F0MkZvckVmZmVjdChlLHQsaSxzPSIiKXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldEZsb2F0MihlK3MsdCxpKX1fdXBkYXRlRmxvYXQyRm9yVW5pZm9ybShlLHQsaSl7Vi5fVGVtcEJ1ZmZlclswXT10LFYuX1RlbXBCdWZmZXJbMV09aSx0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDIpfV91cGRhdGVGbG9hdDNGb3JFZmZlY3QoZSx0LGkscyxyPSIiKXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldEZsb2F0MyhlK3IsdCxpLHMpfV91cGRhdGVGbG9hdDNGb3JVbmlmb3JtKGUsdCxpLHMpe1YuX1RlbXBCdWZmZXJbMF09dCxWLl9UZW1wQnVmZmVyWzFdPWksVi5fVGVtcEJ1ZmZlclsyXT1zLHRoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsMyl9X3VwZGF0ZUZsb2F0NEZvckVmZmVjdChlLHQsaSxzLHIsbj0iIil7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRGbG9hdDQoZStuLHQsaSxzLHIpfV91cGRhdGVGbG9hdDRGb3JVbmlmb3JtKGUsdCxpLHMscil7Vi5fVGVtcEJ1ZmZlclswXT10LFYuX1RlbXBCdWZmZXJbMV09aSxWLl9UZW1wQnVmZmVyWzJdPXMsVi5fVGVtcEJ1ZmZlclszXT1yLHRoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsNCl9X3VwZGF0ZUZsb2F0QXJyYXlGb3JFZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldEZsb2F0QXJyYXkoZSx0KX1fdXBkYXRlRmxvYXRBcnJheUZvclVuaWZvcm0oZSx0KXt0aGlzLnVwZGF0ZVVuaWZvcm1BcnJheShlLHQsdC5sZW5ndGgpfV91cGRhdGVBcnJheUZvckVmZmVjdChlLHQpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0QXJyYXkoZSx0KX1fdXBkYXRlQXJyYXlGb3JVbmlmb3JtKGUsdCl7dGhpcy51cGRhdGVVbmlmb3JtQXJyYXkoZSx0LHQubGVuZ3RoKX1fdXBkYXRlSW50QXJyYXlGb3JFZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldEludEFycmF5KGUsdCl9X3VwZGF0ZUludEFycmF5Rm9yVW5pZm9ybShlLHQpe1YuX1RlbXBCdWZmZXJJbnQzMlZpZXcuc2V0KHQpLHRoaXMudXBkYXRlVW5pZm9ybUFycmF5KGUsVi5fVGVtcEJ1ZmZlcix0Lmxlbmd0aCl9X3VwZGF0ZVVJbnRBcnJheUZvckVmZmVjdChlLHQpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0VUludEFycmF5KGUsdCl9X3VwZGF0ZVVJbnRBcnJheUZvclVuaWZvcm0oZSx0KXtWLl9UZW1wQnVmZmVyVUludDMyVmlldy5zZXQodCksdGhpcy51cGRhdGVVbmlmb3JtQXJyYXkoZSxWLl9UZW1wQnVmZmVyLHQubGVuZ3RoKX1fdXBkYXRlTWF0cml4Rm9yRWZmZWN0KGUsdCl7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRNYXRyaXgoZSx0KX1fdXBkYXRlTWF0cml4Rm9yVW5pZm9ybShlLHQpe3RoaXMuX2NhY2hlTWF0cml4KGUsdCkmJnRoaXMudXBkYXRlVW5pZm9ybShlLHQudG9BcnJheSgpLDE2KX1fdXBkYXRlTWF0cmljZXNGb3JFZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldE1hdHJpY2VzKGUsdCl9X3VwZGF0ZU1hdHJpY2VzRm9yVW5pZm9ybShlLHQpe3RoaXMudXBkYXRlVW5pZm9ybShlLHQsdC5sZW5ndGgpfV91cGRhdGVWZWN0b3IzRm9yRWZmZWN0KGUsdCl7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRWZWN0b3IzKGUsdCl9X3VwZGF0ZVZlY3RvcjNGb3JVbmlmb3JtKGUsdCl7Vi5fVGVtcEJ1ZmZlclswXT10LngsVi5fVGVtcEJ1ZmZlclsxXT10LnksVi5fVGVtcEJ1ZmZlclsyXT10LnosdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciwzKX1fdXBkYXRlVmVjdG9yNEZvckVmZmVjdChlLHQpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0VmVjdG9yNChlLHQpfV91cGRhdGVWZWN0b3I0Rm9yVW5pZm9ybShlLHQpe1YuX1RlbXBCdWZmZXJbMF09dC54LFYuX1RlbXBCdWZmZXJbMV09dC55LFYuX1RlbXBCdWZmZXJbMl09dC56LFYuX1RlbXBCdWZmZXJbM109dC53LHRoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsNCl9X3VwZGF0ZUNvbG9yM0ZvckVmZmVjdChlLHQsaT0iIil7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRDb2xvcjMoZStpLHQpfV91cGRhdGVDb2xvcjNGb3JVbmlmb3JtKGUsdCl7Vi5fVGVtcEJ1ZmZlclswXT10LnIsVi5fVGVtcEJ1ZmZlclsxXT10LmcsVi5fVGVtcEJ1ZmZlclsyXT10LmIsdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciwzKX1fdXBkYXRlQ29sb3I0Rm9yRWZmZWN0KGUsdCxpLHM9IiIpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0Q29sb3I0KGUrcyx0LGkpfV91cGRhdGVEaXJlY3RDb2xvcjRGb3JFZmZlY3QoZSx0LGk9IiIpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0RGlyZWN0Q29sb3I0KGUraSx0KX1fdXBkYXRlQ29sb3I0Rm9yVW5pZm9ybShlLHQsaSl7Vi5fVGVtcEJ1ZmZlclswXT10LnIsVi5fVGVtcEJ1ZmZlclsxXT10LmcsVi5fVGVtcEJ1ZmZlclsyXT10LmIsVi5fVGVtcEJ1ZmZlclszXT1pLHRoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsNCl9X3VwZGF0ZURpcmVjdENvbG9yNEZvclVuaWZvcm0oZSx0KXtWLl9UZW1wQnVmZmVyWzBdPXQucixWLl9UZW1wQnVmZmVyWzFdPXQuZyxWLl9UZW1wQnVmZmVyWzJdPXQuYixWLl9UZW1wQnVmZmVyWzNdPXQuYSx0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDQpfV91cGRhdGVJbnRGb3JFZmZlY3QoZSx0LGk9IiIpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0SW50KGUraSx0KX1fdXBkYXRlSW50Rm9yVW5pZm9ybShlLHQpe1YuX1RlbXBCdWZmZXJJbnQzMlZpZXdbMF09dCx0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDEpfV91cGRhdGVJbnQyRm9yRWZmZWN0KGUsdCxpLHM9IiIpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0SW50MihlK3MsdCxpKX1fdXBkYXRlSW50MkZvclVuaWZvcm0oZSx0LGkpe1YuX1RlbXBCdWZmZXJJbnQzMlZpZXdbMF09dCxWLl9UZW1wQnVmZmVySW50MzJWaWV3WzFdPWksdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciwyKX1fdXBkYXRlSW50M0ZvckVmZmVjdChlLHQsaSxzLHI9IiIpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0SW50MyhlK3IsdCxpLHMpfV91cGRhdGVJbnQzRm9yVW5pZm9ybShlLHQsaSxzKXtWLl9UZW1wQnVmZmVySW50MzJWaWV3WzBdPXQsVi5fVGVtcEJ1ZmZlckludDMyVmlld1sxXT1pLFYuX1RlbXBCdWZmZXJJbnQzMlZpZXdbMl09cyx0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDMpfV91cGRhdGVJbnQ0Rm9yRWZmZWN0KGUsdCxpLHMscixuPSIiKXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldEludDQoZStuLHQsaSxzLHIpfV91cGRhdGVJbnQ0Rm9yVW5pZm9ybShlLHQsaSxzLHIpe1YuX1RlbXBCdWZmZXJJbnQzMlZpZXdbMF09dCxWLl9UZW1wQnVmZmVySW50MzJWaWV3WzFdPWksVi5fVGVtcEJ1ZmZlckludDMyVmlld1syXT1zLFYuX1RlbXBCdWZmZXJJbnQzMlZpZXdbM109cix0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDQpfV91cGRhdGVVSW50Rm9yRWZmZWN0KGUsdCxpPSIiKXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldFVJbnQoZStpLHQpfV91cGRhdGVVSW50Rm9yVW5pZm9ybShlLHQpe1YuX1RlbXBCdWZmZXJVSW50MzJWaWV3WzBdPXQsdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciwxKX1fdXBkYXRlVUludDJGb3JFZmZlY3QoZSx0LGkscz0iIil7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRVSW50MihlK3MsdCxpKX1fdXBkYXRlVUludDJGb3JVbmlmb3JtKGUsdCxpKXtWLl9UZW1wQnVmZmVyVUludDMyVmlld1swXT10LFYuX1RlbXBCdWZmZXJVSW50MzJWaWV3WzFdPWksdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciwyKX1fdXBkYXRlVUludDNGb3JFZmZlY3QoZSx0LGkscyxyPSIiKXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldFVJbnQzKGUrcix0LGkscyl9X3VwZGF0ZVVJbnQzRm9yVW5pZm9ybShlLHQsaSxzKXtWLl9UZW1wQnVmZmVyVUludDMyVmlld1swXT10LFYuX1RlbXBCdWZmZXJVSW50MzJWaWV3WzFdPWksVi5fVGVtcEJ1ZmZlclVJbnQzMlZpZXdbMl09cyx0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDMpfV91cGRhdGVVSW50NEZvckVmZmVjdChlLHQsaSxzLHIsbj0iIil7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRVSW50NChlK24sdCxpLHMscil9X3VwZGF0ZVVJbnQ0Rm9yVW5pZm9ybShlLHQsaSxzLHIpe1YuX1RlbXBCdWZmZXJVSW50MzJWaWV3WzBdPXQsVi5fVGVtcEJ1ZmZlclVJbnQzMlZpZXdbMV09aSxWLl9UZW1wQnVmZmVyVUludDMyVmlld1syXT1zLFYuX1RlbXBCdWZmZXJVSW50MzJWaWV3WzNdPXIsdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciw0KX1zZXRUZXh0dXJlKGUsdCl7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRUZXh0dXJlKGUsdCl9dXBkYXRlVW5pZm9ybURpcmVjdGx5KGUsdCl7dGhpcy51cGRhdGVVbmlmb3JtKGUsdCx0Lmxlbmd0aCksdGhpcy51cGRhdGUoKX1iaW5kVG9FZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0PWUsdGhpcy5fY3VycmVudEVmZmVjdE5hbWU9dH1iaW5kVW5pZm9ybUJ1ZmZlcigpeyF0aGlzLl9ub1VCTyYmdGhpcy5fYnVmZmVyJiZ0aGlzLl9jdXJyZW50RWZmZWN0JiZ0aGlzLl9jdXJyZW50RWZmZWN0LmJpbmRVbmlmb3JtQnVmZmVyKHRoaXMuX2J1ZmZlcix0aGlzLl9jdXJyZW50RWZmZWN0TmFtZSl9dW5iaW5kRWZmZWN0KCl7dGhpcy5fY3VycmVudEVmZmVjdD12b2lkIDAsdGhpcy5fY3VycmVudEVmZmVjdE5hbWU9dm9pZCAwfXNldERhdGFCdWZmZXIoZSl7aWYoIXRoaXMuX2J1ZmZlcnMpcmV0dXJuIHRoaXMuX2J1ZmZlcj09PWU7Zm9yKGxldCB0PTA7dDx0aGlzLl9idWZmZXJzLmxlbmd0aDsrK3QpaWYodGhpcy5fYnVmZmVyc1t0XVswXT09PWUpcmV0dXJuIHRoaXMuX2J1ZmZlckluZGV4PXQsdGhpcy5fYnVmZmVyPWUsdGhpcy5fY3JlYXRlQnVmZmVyT25Xcml0ZT0hMSx0aGlzLl9jdXJyZW50RWZmZWN0PXZvaWQgMCwhMDtyZXR1cm4hMX1kaXNwb3NlKCl7aWYodGhpcy5fbm9VQk8pcmV0dXJuO2NvbnN0IGU9dGhpcy5fZW5naW5lLl91bmlmb3JtQnVmZmVycyx0PWUuaW5kZXhPZih0aGlzKTtpZih0IT09LTEmJihlW3RdPWVbZS5sZW5ndGgtMV0sZS5wb3AoKSksdGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lJiZ0aGlzLl9idWZmZXJzKWZvcihsZXQgaT0wO2k8dGhpcy5fYnVmZmVycy5sZW5ndGg7KytpKXtjb25zdCBzPXRoaXMuX2J1ZmZlcnNbaV1bMF07dGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHMpfWVsc2UgdGhpcy5fYnVmZmVyJiZ0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5fYnVmZmVyKSYmKHRoaXMuX2J1ZmZlcj1udWxsKX19Vi5fVXBkYXRlZFVib3NJbkZyYW1lPXt9LFYuX01BWF9VTklGT1JNX1NJWkU9MjU2LFYuX1RlbXBCdWZmZXI9bmV3IEZsb2F0MzJBcnJheShWLl9NQVhfVU5JRk9STV9TSVpFKSxWLl9UZW1wQnVmZmVySW50MzJWaWV3PW5ldyBJbnQzMkFycmF5KFYuX1RlbXBCdWZmZXIuYnVmZmVyKSxWLl9UZW1wQnVmZmVyVUludDMyVmlldz1uZXcgVWludDMyQXJyYXkoVi5fVGVtcEJ1ZmZlci5idWZmZXIpO2NsYXNzICRpe2NvbnN0cnVjdG9yKGUsdCxpLHM9MCxyPSExLG49ITEsYT0hMSxvKXt0aGlzLl9pc0FscmVhZHlPd25lZD0hMSxlLmdldFNjZW5lP3RoaXMuX2VuZ2luZT1lLmdldFNjZW5lKCkuZ2V0RW5naW5lKCk6dGhpcy5fZW5naW5lPWUsdGhpcy5fdXBkYXRhYmxlPWksdGhpcy5faW5zdGFuY2VkPW4sdGhpcy5fZGl2aXNvcj1vfHwxLHQgaW5zdGFuY2VvZiBQaT8odGhpcy5fZGF0YT1udWxsLHRoaXMuX2J1ZmZlcj10KToodGhpcy5fZGF0YT10LHRoaXMuX2J1ZmZlcj1udWxsKSx0aGlzLmJ5dGVTdHJpZGU9YT9zOnMqRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5ULHJ8fHRoaXMuY3JlYXRlKCl9Y3JlYXRlVmVydGV4QnVmZmVyKGUsdCxpLHMscixuPSExLGEpe2NvbnN0IG89bj90OnQqRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5ULGg9cz9uP3M6cypGbG9hdDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQ6dGhpcy5ieXRlU3RyaWRlO3JldHVybiBuZXcgZyh0aGlzLl9lbmdpbmUsdGhpcyxlLHRoaXMuX3VwZGF0YWJsZSwhMCxoLHI9PT12b2lkIDA/dGhpcy5faW5zdGFuY2VkOnIsbyxpLHZvaWQgMCx2b2lkIDAsITAsdGhpcy5fZGl2aXNvcnx8YSl9aXNVcGRhdGFibGUoKXtyZXR1cm4gdGhpcy5fdXBkYXRhYmxlfWdldERhdGEoKXtyZXR1cm4gdGhpcy5fZGF0YX1nZXRCdWZmZXIoKXtyZXR1cm4gdGhpcy5fYnVmZmVyfWdldFN0cmlkZVNpemUoKXtyZXR1cm4gdGhpcy5ieXRlU3RyaWRlL0Zsb2F0MzJBcnJheS5CWVRFU19QRVJfRUxFTUVOVH1jcmVhdGUoZT1udWxsKXshZSYmdGhpcy5fYnVmZmVyfHwoZT1lfHx0aGlzLl9kYXRhLGUmJih0aGlzLl9idWZmZXI/dGhpcy5fdXBkYXRhYmxlJiYodGhpcy5fZW5naW5lLnVwZGF0ZUR5bmFtaWNWZXJ0ZXhCdWZmZXIodGhpcy5fYnVmZmVyLGUpLHRoaXMuX2RhdGE9ZSk6dGhpcy5fdXBkYXRhYmxlPyh0aGlzLl9idWZmZXI9dGhpcy5fZW5naW5lLmNyZWF0ZUR5bmFtaWNWZXJ0ZXhCdWZmZXIoZSksdGhpcy5fZGF0YT1lKTp0aGlzLl9idWZmZXI9dGhpcy5fZW5naW5lLmNyZWF0ZVZlcnRleEJ1ZmZlcihlKSkpfV9yZWJ1aWxkKCl7dGhpcy5fYnVmZmVyPW51bGwsdGhpcy5jcmVhdGUodGhpcy5fZGF0YSl9dXBkYXRlKGUpe3RoaXMuY3JlYXRlKGUpfXVwZGF0ZURpcmVjdGx5KGUsdCxpLHM9ITEpe3RoaXMuX2J1ZmZlciYmdGhpcy5fdXBkYXRhYmxlJiYodGhpcy5fZW5naW5lLnVwZGF0ZUR5bmFtaWNWZXJ0ZXhCdWZmZXIodGhpcy5fYnVmZmVyLGUscz90OnQqRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5ULGk/aSp0aGlzLmJ5dGVTdHJpZGU6dm9pZCAwKSx0PT09MCYmaT09PXZvaWQgMD90aGlzLl9kYXRhPWU6dGhpcy5fZGF0YT1udWxsKX1faW5jcmVhc2VSZWZlcmVuY2VzKCl7aWYodGhpcy5fYnVmZmVyKXtpZighdGhpcy5faXNBbHJlYWR5T3duZWQpe3RoaXMuX2lzQWxyZWFkeU93bmVkPSEwO3JldHVybn10aGlzLl9idWZmZXIucmVmZXJlbmNlcysrfX1kaXNwb3NlKCl7dGhpcy5fYnVmZmVyJiZ0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5fYnVmZmVyKSYmKHRoaXMuX2J1ZmZlcj1udWxsLHRoaXMuX2RhdGE9bnVsbCl9fWNsYXNzIGd7Y29uc3RydWN0b3IoZSx0LGkscyxyLG4sYSxvLGgsbCx1PSExLGQ9ITEsZj0xLF89ITEpe2lmKHQgaW5zdGFuY2VvZiAkaT8odGhpcy5fYnVmZmVyPXQsdGhpcy5fb3duc0J1ZmZlcj1fKToodGhpcy5fYnVmZmVyPW5ldyAkaShlLHQscyxuLHIsYSxkKSx0aGlzLl9vd25zQnVmZmVyPSEwKSx0aGlzLnVuaXF1ZUlkPWcuX0NvdW50ZXIrKyx0aGlzLl9raW5kPWksbD09bnVsbCl7Y29uc3QgbT10aGlzLmdldERhdGEoKTt0aGlzLnR5cGU9Zy5GTE9BVCxtIGluc3RhbmNlb2YgSW50OEFycmF5P3RoaXMudHlwZT1nLkJZVEU6bSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXk/dGhpcy50eXBlPWcuVU5TSUdORURfQllURTptIGluc3RhbmNlb2YgSW50MTZBcnJheT90aGlzLnR5cGU9Zy5TSE9SVDptIGluc3RhbmNlb2YgVWludDE2QXJyYXk/dGhpcy50eXBlPWcuVU5TSUdORURfU0hPUlQ6bSBpbnN0YW5jZW9mIEludDMyQXJyYXk/dGhpcy50eXBlPWcuSU5UOm0gaW5zdGFuY2VvZiBVaW50MzJBcnJheSYmKHRoaXMudHlwZT1nLlVOU0lHTkVEX0lOVCl9ZWxzZSB0aGlzLnR5cGU9bDtjb25zdCBFPWcuR2V0VHlwZUJ5dGVMZW5ndGgodGhpcy50eXBlKTtkPyh0aGlzLl9zaXplPWh8fChuP24vRTpnLkRlZHVjZVN0cmlkZShpKSksdGhpcy5ieXRlU3RyaWRlPW58fHRoaXMuX2J1ZmZlci5ieXRlU3RyaWRlfHx0aGlzLl9zaXplKkUsdGhpcy5ieXRlT2Zmc2V0PW98fDApOih0aGlzLl9zaXplPWh8fG58fGcuRGVkdWNlU3RyaWRlKGkpLHRoaXMuYnl0ZVN0cmlkZT1uP24qRTp0aGlzLl9idWZmZXIuYnl0ZVN0cmlkZXx8dGhpcy5fc2l6ZSpFLHRoaXMuYnl0ZU9mZnNldD0ob3x8MCkqRSksdGhpcy5ub3JtYWxpemVkPXUsdGhpcy5faW5zdGFuY2VkPWEhPT12b2lkIDA/YTohMSx0aGlzLl9pbnN0YW5jZURpdmlzb3I9YT9mOjAsdGhpcy5fY29tcHV0ZUhhc2hDb2RlKCl9Z2V0IGluc3RhbmNlRGl2aXNvcigpe3JldHVybiB0aGlzLl9pbnN0YW5jZURpdmlzb3J9c2V0IGluc3RhbmNlRGl2aXNvcihlKXtjb25zdCB0PWUhPTA7dGhpcy5faW5zdGFuY2VEaXZpc29yPWUsdCE9PXRoaXMuX2luc3RhbmNlZCYmKHRoaXMuX2luc3RhbmNlZD10LHRoaXMuX2NvbXB1dGVIYXNoQ29kZSgpKX1fY29tcHV0ZUhhc2hDb2RlKCl7dGhpcy5oYXNoQ29kZT0odGhpcy50eXBlLTUxMjA8PDApKygodGhpcy5ub3JtYWxpemVkPzE6MCk8PDMpKyh0aGlzLl9zaXplPDw0KSsoKHRoaXMuX2luc3RhbmNlZD8xOjApPDw2KSsodGhpcy5ieXRlU3RyaWRlPDwxMil9X3JlYnVpbGQoKXt0aGlzLl9idWZmZXImJnRoaXMuX2J1ZmZlci5fcmVidWlsZCgpfWdldEtpbmQoKXtyZXR1cm4gdGhpcy5fa2luZH1pc1VwZGF0YWJsZSgpe3JldHVybiB0aGlzLl9idWZmZXIuaXNVcGRhdGFibGUoKX1nZXREYXRhKCl7cmV0dXJuIHRoaXMuX2J1ZmZlci5nZXREYXRhKCl9Z2V0RmxvYXREYXRhKGUsdCl7Y29uc3QgaT10aGlzLmdldERhdGEoKTtpZighaSlyZXR1cm4gbnVsbDtjb25zdCBzPXRoaXMuZ2V0U2l6ZSgpKmcuR2V0VHlwZUJ5dGVMZW5ndGgodGhpcy50eXBlKSxyPWUqdGhpcy5nZXRTaXplKCk7aWYodGhpcy50eXBlIT09Zy5GTE9BVHx8dGhpcy5ieXRlU3RyaWRlIT09cyl7Y29uc3Qgbj1uZXcgRmxvYXQzMkFycmF5KHIpO3JldHVybiB0aGlzLmZvckVhY2gociwoYSxvKT0+bltvXT1hKSxufWlmKCEoaSBpbnN0YW5jZW9mIEFycmF5fHxpIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5KXx8dGhpcy5ieXRlT2Zmc2V0IT09MHx8aS5sZW5ndGghPT1yKWlmKGkgaW5zdGFuY2VvZiBBcnJheSl7Y29uc3Qgbj10aGlzLmJ5dGVPZmZzZXQvNDtyZXR1cm4gaS5zbGljZShuLG4rcil9ZWxzZXtpZihpIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpcmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoaSx0aGlzLmJ5dGVPZmZzZXQscik7e2xldCBuPWkuYnl0ZU9mZnNldCt0aGlzLmJ5dGVPZmZzZXQ7aWYodCl7Y29uc3Qgbz1uZXcgRmxvYXQzMkFycmF5KHIpLGg9bmV3IEZsb2F0MzJBcnJheShpLmJ1ZmZlcixuLHIpO3JldHVybiBvLnNldChoKSxvfWNvbnN0IGE9biU0O3JldHVybiBhJiYobj1NYXRoLm1heCgwLG4tYSkpLG5ldyBGbG9hdDMyQXJyYXkoaS5idWZmZXIsbixyKX19cmV0dXJuIHQ/aS5zbGljZSgpOml9Z2V0QnVmZmVyKCl7cmV0dXJuIHRoaXMuX2J1ZmZlci5nZXRCdWZmZXIoKX1nZXRTdHJpZGVTaXplKCl7cmV0dXJuIHRoaXMuYnl0ZVN0cmlkZS9nLkdldFR5cGVCeXRlTGVuZ3RoKHRoaXMudHlwZSl9Z2V0T2Zmc2V0KCl7cmV0dXJuIHRoaXMuYnl0ZU9mZnNldC9nLkdldFR5cGVCeXRlTGVuZ3RoKHRoaXMudHlwZSl9Z2V0U2l6ZShlPSExKXtyZXR1cm4gZT90aGlzLl9zaXplKmcuR2V0VHlwZUJ5dGVMZW5ndGgodGhpcy50eXBlKTp0aGlzLl9zaXplfWdldElzSW5zdGFuY2VkKCl7cmV0dXJuIHRoaXMuX2luc3RhbmNlZH1nZXRJbnN0YW5jZURpdmlzb3IoKXtyZXR1cm4gdGhpcy5faW5zdGFuY2VEaXZpc29yfWNyZWF0ZShlKXt0aGlzLl9idWZmZXIuY3JlYXRlKGUpfXVwZGF0ZShlKXt0aGlzLl9idWZmZXIudXBkYXRlKGUpfXVwZGF0ZURpcmVjdGx5KGUsdCxpPSExKXt0aGlzLl9idWZmZXIudXBkYXRlRGlyZWN0bHkoZSx0LHZvaWQgMCxpKX1kaXNwb3NlKCl7dGhpcy5fb3duc0J1ZmZlciYmdGhpcy5fYnVmZmVyLmRpc3Bvc2UoKX1mb3JFYWNoKGUsdCl7Zy5Gb3JFYWNoKHRoaXMuX2J1ZmZlci5nZXREYXRhKCksdGhpcy5ieXRlT2Zmc2V0LHRoaXMuYnl0ZVN0cmlkZSx0aGlzLl9zaXplLHRoaXMudHlwZSxlLHRoaXMubm9ybWFsaXplZCx0KX1zdGF0aWMgRGVkdWNlU3RyaWRlKGUpe3N3aXRjaChlKXtjYXNlIGcuVVZLaW5kOmNhc2UgZy5VVjJLaW5kOmNhc2UgZy5VVjNLaW5kOmNhc2UgZy5VVjRLaW5kOmNhc2UgZy5VVjVLaW5kOmNhc2UgZy5VVjZLaW5kOnJldHVybiAyO2Nhc2UgZy5Ob3JtYWxLaW5kOmNhc2UgZy5Qb3NpdGlvbktpbmQ6cmV0dXJuIDM7Y2FzZSBnLkNvbG9yS2luZDpjYXNlIGcuTWF0cmljZXNJbmRpY2VzS2luZDpjYXNlIGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kOmNhc2UgZy5NYXRyaWNlc1dlaWdodHNLaW5kOmNhc2UgZy5NYXRyaWNlc1dlaWdodHNFeHRyYUtpbmQ6Y2FzZSBnLlRhbmdlbnRLaW5kOnJldHVybiA0O2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGtpbmQgJyIrZSsiJyIpfX1zdGF0aWMgR2V0VHlwZUJ5dGVMZW5ndGgoZSl7c3dpdGNoKGUpe2Nhc2UgZy5CWVRFOmNhc2UgZy5VTlNJR05FRF9CWVRFOnJldHVybiAxO2Nhc2UgZy5TSE9SVDpjYXNlIGcuVU5TSUdORURfU0hPUlQ6cmV0dXJuIDI7Y2FzZSBnLklOVDpjYXNlIGcuVU5TSUdORURfSU5UOmNhc2UgZy5GTE9BVDpyZXR1cm4gNDtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgSW52YWxpZCB0eXBlICcke2V9J2ApfX1zdGF0aWMgRm9yRWFjaChlLHQsaSxzLHIsbixhLG8pe2lmKGUgaW5zdGFuY2VvZiBBcnJheSl7bGV0IGg9dC80O2NvbnN0IGw9aS80O2ZvcihsZXQgdT0wO3U8bjt1Kz1zKXtmb3IobGV0IGQ9MDtkPHM7ZCsrKW8oZVtoK2RdLHUrZCk7aCs9bH19ZWxzZXtjb25zdCBoPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgRGF0YVZpZXcoZSk6bmV3IERhdGFWaWV3KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCxlLmJ5dGVMZW5ndGgpLGw9Zy5HZXRUeXBlQnl0ZUxlbmd0aChyKTtmb3IobGV0IHU9MDt1PG47dSs9cyl7bGV0IGQ9dDtmb3IobGV0IGY9MDtmPHM7ZisrKXtjb25zdCBfPWcuX0dldEZsb2F0VmFsdWUoaCxyLGQsYSk7byhfLHUrZiksZCs9bH10Kz1pfX19c3RhdGljIF9HZXRGbG9hdFZhbHVlKGUsdCxpLHMpe3N3aXRjaCh0KXtjYXNlIGcuQllURTp7bGV0IHI9ZS5nZXRJbnQ4KGkpO3JldHVybiBzJiYocj1NYXRoLm1heChyLzEyNywtMSkpLHJ9Y2FzZSBnLlVOU0lHTkVEX0JZVEU6e2xldCByPWUuZ2V0VWludDgoaSk7cmV0dXJuIHMmJihyPXIvMjU1KSxyfWNhc2UgZy5TSE9SVDp7bGV0IHI9ZS5nZXRJbnQxNihpLCEwKTtyZXR1cm4gcyYmKHI9TWF0aC5tYXgoci8zMjc2NywtMSkpLHJ9Y2FzZSBnLlVOU0lHTkVEX1NIT1JUOntsZXQgcj1lLmdldFVpbnQxNihpLCEwKTtyZXR1cm4gcyYmKHI9ci82NTUzNSkscn1jYXNlIGcuSU5UOnJldHVybiBlLmdldEludDMyKGksITApO2Nhc2UgZy5VTlNJR05FRF9JTlQ6cmV0dXJuIGUuZ2V0VWludDMyKGksITApO2Nhc2UgZy5GTE9BVDpyZXR1cm4gZS5nZXRGbG9hdDMyKGksITApO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGNvbXBvbmVudCB0eXBlICR7dH1gKX19fWcuX0NvdW50ZXI9MCxnLkJZVEU9NTEyMCxnLlVOU0lHTkVEX0JZVEU9NTEyMSxnLlNIT1JUPTUxMjIsZy5VTlNJR05FRF9TSE9SVD01MTIzLGcuSU5UPTUxMjQsZy5VTlNJR05FRF9JTlQ9NTEyNSxnLkZMT0FUPTUxMjYsZy5Qb3NpdGlvbktpbmQ9InBvc2l0aW9uIixnLk5vcm1hbEtpbmQ9Im5vcm1hbCIsZy5UYW5nZW50S2luZD0idGFuZ2VudCIsZy5VVktpbmQ9InV2IixnLlVWMktpbmQ9InV2MiIsZy5VVjNLaW5kPSJ1djMiLGcuVVY0S2luZD0idXY0IixnLlVWNUtpbmQ9InV2NSIsZy5VVjZLaW5kPSJ1djYiLGcuQ29sb3JLaW5kPSJjb2xvciIsZy5Db2xvckluc3RhbmNlS2luZD0iaW5zdGFuY2VDb2xvciIsZy5NYXRyaWNlc0luZGljZXNLaW5kPSJtYXRyaWNlc0luZGljZXMiLGcuTWF0cmljZXNXZWlnaHRzS2luZD0ibWF0cmljZXNXZWlnaHRzIixnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZD0ibWF0cmljZXNJbmRpY2VzRXh0cmEiLGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kPSJtYXRyaWNlc1dlaWdodHNFeHRyYSI7Y2xhc3MgVXR7Y29uc3RydWN0b3IoKXt0aGlzLmhpdD0hMSx0aGlzLmRpc3RhbmNlPTAsdGhpcy5waWNrZWRQb2ludD1udWxsLHRoaXMucGlja2VkTWVzaD1udWxsLHRoaXMuYnU9MCx0aGlzLmJ2PTAsdGhpcy5mYWNlSWQ9LTEsdGhpcy5zdWJNZXNoRmFjZUlkPS0xLHRoaXMuc3ViTWVzaElkPTAsdGhpcy5waWNrZWRTcHJpdGU9bnVsbCx0aGlzLnRoaW5JbnN0YW5jZUluZGV4PS0xLHRoaXMucmF5PW51bGwsdGhpcy5vcmlnaW5NZXNoPW51bGwsdGhpcy5haW1UcmFuc2Zvcm09bnVsbCx0aGlzLmdyaXBUcmFuc2Zvcm09bnVsbH1nZXROb3JtYWwoZT0hMSx0PSEwKXtpZighdGhpcy5waWNrZWRNZXNofHx0JiYhdGhpcy5waWNrZWRNZXNoLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk5vcm1hbEtpbmQpKXJldHVybiBudWxsO2NvbnN0IGk9dGhpcy5waWNrZWRNZXNoLmdldEluZGljZXMoKTtpZighaSlyZXR1cm4gbnVsbDtsZXQgcztpZih0KXtjb25zdCBuPXRoaXMucGlja2VkTWVzaC5nZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kKTtsZXQgYT1wLkZyb21BcnJheShuLGlbdGhpcy5mYWNlSWQqM10qMyksbz1wLkZyb21BcnJheShuLGlbdGhpcy5mYWNlSWQqMysxXSozKSxoPXAuRnJvbUFycmF5KG4saVt0aGlzLmZhY2VJZCozKzJdKjMpO2E9YS5zY2FsZSh0aGlzLmJ1KSxvPW8uc2NhbGUodGhpcy5idiksaD1oLnNjYWxlKDEtdGhpcy5idS10aGlzLmJ2KSxzPW5ldyBwKGEueCtvLngraC54LGEueStvLnkraC55LGEueitvLnoraC56KX1lbHNle2NvbnN0IG49dGhpcy5waWNrZWRNZXNoLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCksYT1wLkZyb21BcnJheShuLGlbdGhpcy5mYWNlSWQqM10qMyksbz1wLkZyb21BcnJheShuLGlbdGhpcy5mYWNlSWQqMysxXSozKSxoPXAuRnJvbUFycmF5KG4saVt0aGlzLmZhY2VJZCozKzJdKjMpLGw9YS5zdWJ0cmFjdChvKSx1PWguc3VidHJhY3Qobyk7cz1wLkNyb3NzKGwsdSl9Y29uc3Qgcj0obixhKT0+e2xldCBvPW4uZ2V0V29ybGRNYXRyaXgoKTtuLm5vblVuaWZvcm1TY2FsaW5nJiYoRC5NYXRyaXhbMF0uY29weUZyb20obyksbz1ELk1hdHJpeFswXSxvLnNldFRyYW5zbGF0aW9uRnJvbUZsb2F0cygwLDAsMCksby5pbnZlcnQoKSxvLnRyYW5zcG9zZVRvUmVmKEQuTWF0cml4WzFdKSxvPUQuTWF0cml4WzFdKSxwLlRyYW5zZm9ybU5vcm1hbFRvUmVmKGEsbyxhKX07aWYoZSYmcih0aGlzLnBpY2tlZE1lc2gscyksdGhpcy5yYXkpe2NvbnN0IG49RC5WZWN0b3IzWzBdLmNvcHlGcm9tKHMpO2V8fHIodGhpcy5waWNrZWRNZXNoLG4pLHAuRG90KG4sdGhpcy5yYXkuZGlyZWN0aW9uKT4wJiZzLm5lZ2F0ZUluUGxhY2UoKX1yZXR1cm4gcy5ub3JtYWxpemUoKSxzfWdldFRleHR1cmVDb29yZGluYXRlcygpe2lmKCF0aGlzLnBpY2tlZE1lc2h8fCF0aGlzLnBpY2tlZE1lc2guaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuVVZLaW5kKSlyZXR1cm4gbnVsbDtjb25zdCBlPXRoaXMucGlja2VkTWVzaC5nZXRJbmRpY2VzKCk7aWYoIWUpcmV0dXJuIG51bGw7Y29uc3QgdD10aGlzLnBpY2tlZE1lc2guZ2V0VmVydGljZXNEYXRhKGcuVVZLaW5kKTtpZighdClyZXR1cm4gbnVsbDtsZXQgaT12ZS5Gcm9tQXJyYXkodCxlW3RoaXMuZmFjZUlkKjNdKjIpLHM9dmUuRnJvbUFycmF5KHQsZVt0aGlzLmZhY2VJZCozKzFdKjIpLHI9dmUuRnJvbUFycmF5KHQsZVt0aGlzLmZhY2VJZCozKzJdKjIpO3JldHVybiBpPWkuc2NhbGUodGhpcy5idSkscz1zLnNjYWxlKHRoaXMuYnYpLHI9ci5zY2FsZSgxLXRoaXMuYnUtdGhpcy5idiksbmV3IHZlKGkueCtzLngrci54LGkueStzLnkrci55KX19Y2xhc3MgVmV7Y29uc3RydWN0b3IoZSx0LGkscyxyLG4pe3RoaXMuc291cmNlPWUsdGhpcy5wb2ludGVyWD10LHRoaXMucG9pbnRlclk9aSx0aGlzLm1lc2hVbmRlclBvaW50ZXI9cyx0aGlzLnNvdXJjZUV2ZW50PXIsdGhpcy5hZGRpdGlvbmFsRGF0YT1ufXN0YXRpYyBDcmVhdGVOZXcoZSx0LGkpe2NvbnN0IHM9ZS5nZXRTY2VuZSgpO3JldHVybiBuZXcgVmUoZSxzLnBvaW50ZXJYLHMucG9pbnRlclkscy5tZXNoVW5kZXJQb2ludGVyfHxlLHQsaSl9c3RhdGljIENyZWF0ZU5ld0Zyb21TcHJpdGUoZSx0LGkscyl7cmV0dXJuIG5ldyBWZShlLHQucG9pbnRlclgsdC5wb2ludGVyWSx0Lm1lc2hVbmRlclBvaW50ZXIsaSxzKX1zdGF0aWMgQ3JlYXRlTmV3RnJvbVNjZW5lKGUsdCl7cmV0dXJuIG5ldyBWZShudWxsLGUucG9pbnRlclgsZS5wb2ludGVyWSxlLm1lc2hVbmRlclBvaW50ZXIsdCl9c3RhdGljIENyZWF0ZU5ld0Zyb21QcmltaXRpdmUoZSx0LGkscyl7cmV0dXJuIG5ldyBWZShlLHQueCx0LnksbnVsbCxpLHMpfX1jbGFzcyBRaXtjb25zdHJ1Y3RvcihlKXt0aGlzLl92ZXJ0ZXhCdWZmZXJzPXt9LHRoaXMuX3NjZW5lPWV9X3ByZXBhcmVCdWZmZXJzKCl7aWYodGhpcy5fdmVydGV4QnVmZmVyc1tnLlBvc2l0aW9uS2luZF0pcmV0dXJuO2NvbnN0IGU9W107ZS5wdXNoKDEsMSksZS5wdXNoKC0xLDEpLGUucHVzaCgtMSwtMSksZS5wdXNoKDEsLTEpLHRoaXMuX3ZlcnRleEJ1ZmZlcnNbZy5Qb3NpdGlvbktpbmRdPW5ldyBnKHRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLGUsZy5Qb3NpdGlvbktpbmQsITEsITEsMiksdGhpcy5fYnVpbGRJbmRleEJ1ZmZlcigpfV9idWlsZEluZGV4QnVmZmVyKCl7Y29uc3QgZT1bXTtlLnB1c2goMCksZS5wdXNoKDEpLGUucHVzaCgyKSxlLnB1c2goMCksZS5wdXNoKDIpLGUucHVzaCgzKSx0aGlzLl9pbmRleEJ1ZmZlcj10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5jcmVhdGVJbmRleEJ1ZmZlcihlKX1fcmVidWlsZCgpe2NvbnN0IGU9dGhpcy5fdmVydGV4QnVmZmVyc1tnLlBvc2l0aW9uS2luZF07ZSYmKGUuX3JlYnVpbGQoKSx0aGlzLl9idWlsZEluZGV4QnVmZmVyKCkpfV9wcmVwYXJlRnJhbWUoZT1udWxsLHQ9bnVsbCl7Y29uc3QgaT10aGlzLl9zY2VuZS5hY3RpdmVDYW1lcmE7cmV0dXJuIWl8fCh0PXR8fGkuX3Bvc3RQcm9jZXNzZXMuZmlsdGVyKHM9PnMhPW51bGwpLCF0fHx0Lmxlbmd0aD09PTB8fCF0aGlzLl9zY2VuZS5wb3N0UHJvY2Vzc2VzRW5hYmxlZCk/ITE6KHRbMF0uYWN0aXZhdGUoaSxlLHQhPW51bGwpLCEwKX1kaXJlY3RSZW5kZXIoZSx0PW51bGwsaT0hMSxzPTAscj0wLG49ITEpe3ZhciBhO2NvbnN0IG89dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7Zm9yKGxldCBoPTA7aDxlLmxlbmd0aDtoKyspe2g8ZS5sZW5ndGgtMT9lW2grMV0uYWN0aXZhdGUodGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLHQ9PW51bGw/dm9pZCAwOnQudGV4dHVyZSk6KHQ/by5iaW5kRnJhbWVidWZmZXIodCxzLHZvaWQgMCx2b2lkIDAsaSxyKTpufHxvLnJlc3RvcmVEZWZhdWx0RnJhbWVidWZmZXIoKSwoYT1vLl9kZWJ1Z0luc2VydE1hcmtlcik9PT1udWxsfHxhPT09dm9pZCAwfHxhLmNhbGwobyxgcG9zdCBwcm9jZXNzICR7ZVtoXS5uYW1lfSBvdXRwdXRgKSk7Y29uc3QgbD1lW2hdLHU9bC5hcHBseSgpO3UmJihsLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModSksdGhpcy5fcHJlcGFyZUJ1ZmZlcnMoKSxvLmJpbmRCdWZmZXJzKHRoaXMuX3ZlcnRleEJ1ZmZlcnMsdGhpcy5faW5kZXhCdWZmZXIsdSksby5kcmF3RWxlbWVudHNUeXBlKDAsMCw2KSxsLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh1KSl9by5zZXREZXB0aEJ1ZmZlcighMCksby5zZXREZXB0aFdyaXRlKCEwKX1fZmluYWxpemVGcmFtZShlLHQsaSxzLHI9ITEpe3ZhciBuO2NvbnN0IGE9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhO2lmKCFhfHwocz1zfHxhLl9wb3N0UHJvY2Vzc2VzLmZpbHRlcihoPT5oIT1udWxsKSxzLmxlbmd0aD09PTB8fCF0aGlzLl9zY2VuZS5wb3N0UHJvY2Vzc2VzRW5hYmxlZCkpcmV0dXJuO2NvbnN0IG89dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7Zm9yKGxldCBoPTAsbD1zLmxlbmd0aDtoPGw7aCsrKXtjb25zdCB1PXNbaF07aWYoaDxsLTE/dS5fb3V0cHV0VGV4dHVyZT1zW2grMV0uYWN0aXZhdGUoYSx0PT1udWxsP3ZvaWQgMDp0LnRleHR1cmUpOih0PyhvLmJpbmRGcmFtZWJ1ZmZlcih0LGksdm9pZCAwLHZvaWQgMCxyKSx1Ll9vdXRwdXRUZXh0dXJlPXQpOihvLnJlc3RvcmVEZWZhdWx0RnJhbWVidWZmZXIoKSx1Ll9vdXRwdXRUZXh0dXJlPW51bGwpLChuPW8uX2RlYnVnSW5zZXJ0TWFya2VyKT09PW51bGx8fG49PT12b2lkIDB8fG4uY2FsbChvLGBwb3N0IHByb2Nlc3MgJHtzW2hdLm5hbWV9IG91dHB1dGApKSxlKWJyZWFrO2NvbnN0IGQ9dS5hcHBseSgpO2QmJih1Lm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZCksdGhpcy5fcHJlcGFyZUJ1ZmZlcnMoKSxvLmJpbmRCdWZmZXJzKHRoaXMuX3ZlcnRleEJ1ZmZlcnMsdGhpcy5faW5kZXhCdWZmZXIsZCksby5kcmF3RWxlbWVudHNUeXBlKDAsMCw2KSx1Lm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhkKSl9by5zZXREZXB0aEJ1ZmZlcighMCksby5zZXREZXB0aFdyaXRlKCEwKSxvLnNldEFscGhhTW9kZSgwKX1kaXNwb3NlKCl7Y29uc3QgZT10aGlzLl92ZXJ0ZXhCdWZmZXJzW2cuUG9zaXRpb25LaW5kXTtlJiYoZS5kaXNwb3NlKCksdGhpcy5fdmVydGV4QnVmZmVyc1tnLlBvc2l0aW9uS2luZF09bnVsbCksdGhpcy5faW5kZXhCdWZmZXImJih0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5fcmVsZWFzZUJ1ZmZlcih0aGlzLl9pbmRleEJ1ZmZlciksdGhpcy5faW5kZXhCdWZmZXI9bnVsbCl9fWNsYXNzIFN0e2NvbnN0cnVjdG9yKGUsdCxpPW51bGwscz1udWxsLHI9bnVsbCl7dGhpcy5pbmRleD1lLHRoaXMuX29wYXF1ZVN1Yk1lc2hlcz1uZXcgJGUoMjU2KSx0aGlzLl90cmFuc3BhcmVudFN1Yk1lc2hlcz1uZXcgJGUoMjU2KSx0aGlzLl9hbHBoYVRlc3RTdWJNZXNoZXM9bmV3ICRlKDI1NiksdGhpcy5fZGVwdGhPbmx5U3ViTWVzaGVzPW5ldyAkZSgyNTYpLHRoaXMuX3BhcnRpY2xlU3lzdGVtcz1uZXcgJGUoMjU2KSx0aGlzLl9zcHJpdGVNYW5hZ2Vycz1uZXcgJGUoMjU2KSx0aGlzLl9lbXB0eT0hMCx0aGlzLl9lZGdlc1JlbmRlcmVycz1uZXcgaGkoMTYpLHRoaXMuX3NjZW5lPXQsdGhpcy5vcGFxdWVTb3J0Q29tcGFyZUZuPWksdGhpcy5hbHBoYVRlc3RTb3J0Q29tcGFyZUZuPXMsdGhpcy50cmFuc3BhcmVudFNvcnRDb21wYXJlRm49cn1zZXQgb3BhcXVlU29ydENvbXBhcmVGbihlKXtlP3RoaXMuX29wYXF1ZVNvcnRDb21wYXJlRm49ZTp0aGlzLl9vcGFxdWVTb3J0Q29tcGFyZUZuPVN0LlBhaW50ZXJTb3J0Q29tcGFyZSx0aGlzLl9yZW5kZXJPcGFxdWU9dGhpcy5fcmVuZGVyT3BhcXVlU29ydGVkfXNldCBhbHBoYVRlc3RTb3J0Q29tcGFyZUZuKGUpe2U/dGhpcy5fYWxwaGFUZXN0U29ydENvbXBhcmVGbj1lOnRoaXMuX2FscGhhVGVzdFNvcnRDb21wYXJlRm49U3QuUGFpbnRlclNvcnRDb21wYXJlLHRoaXMuX3JlbmRlckFscGhhVGVzdD10aGlzLl9yZW5kZXJBbHBoYVRlc3RTb3J0ZWR9c2V0IHRyYW5zcGFyZW50U29ydENvbXBhcmVGbihlKXtlP3RoaXMuX3RyYW5zcGFyZW50U29ydENvbXBhcmVGbj1lOnRoaXMuX3RyYW5zcGFyZW50U29ydENvbXBhcmVGbj1TdC5kZWZhdWx0VHJhbnNwYXJlbnRTb3J0Q29tcGFyZSx0aGlzLl9yZW5kZXJUcmFuc3BhcmVudD10aGlzLl9yZW5kZXJUcmFuc3BhcmVudFNvcnRlZH1yZW5kZXIoZSx0LGkscyl7aWYoZSl7ZSh0aGlzLl9vcGFxdWVTdWJNZXNoZXMsdGhpcy5fYWxwaGFUZXN0U3ViTWVzaGVzLHRoaXMuX3RyYW5zcGFyZW50U3ViTWVzaGVzLHRoaXMuX2RlcHRoT25seVN1Yk1lc2hlcyk7cmV0dXJufWNvbnN0IHI9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7dGhpcy5fZGVwdGhPbmx5U3ViTWVzaGVzLmxlbmd0aCE9PTAmJihyLnNldENvbG9yV3JpdGUoITEpLHRoaXMuX3JlbmRlckFscGhhVGVzdCh0aGlzLl9kZXB0aE9ubHlTdWJNZXNoZXMpLHIuc2V0Q29sb3JXcml0ZSghMCkpLHRoaXMuX29wYXF1ZVN1Yk1lc2hlcy5sZW5ndGghPT0wJiZ0aGlzLl9yZW5kZXJPcGFxdWUodGhpcy5fb3BhcXVlU3ViTWVzaGVzKSx0aGlzLl9hbHBoYVRlc3RTdWJNZXNoZXMubGVuZ3RoIT09MCYmdGhpcy5fcmVuZGVyQWxwaGFUZXN0KHRoaXMuX2FscGhhVGVzdFN1Yk1lc2hlcyk7Y29uc3Qgbj1yLmdldFN0ZW5jaWxCdWZmZXIoKTtpZihyLnNldFN0ZW5jaWxCdWZmZXIoITEpLHQmJnRoaXMuX3JlbmRlclNwcml0ZXMoKSxpJiZ0aGlzLl9yZW5kZXJQYXJ0aWNsZXMocyksdGhpcy5vbkJlZm9yZVRyYW5zcGFyZW50UmVuZGVyaW5nJiZ0aGlzLm9uQmVmb3JlVHJhbnNwYXJlbnRSZW5kZXJpbmcoKSx0aGlzLl90cmFuc3BhcmVudFN1Yk1lc2hlcy5sZW5ndGghPT0wfHx0aGlzLl9zY2VuZS51c2VPcmRlckluZGVwZW5kZW50VHJhbnNwYXJlbmN5KXtpZihyLnNldFN0ZW5jaWxCdWZmZXIobiksdGhpcy5fc2NlbmUudXNlT3JkZXJJbmRlcGVuZGVudFRyYW5zcGFyZW5jeSl7Y29uc3QgYT10aGlzLl9zY2VuZS5kZXB0aFBlZWxpbmdSZW5kZXJlci5yZW5kZXIodGhpcy5fdHJhbnNwYXJlbnRTdWJNZXNoZXMpO2EubGVuZ3RoJiZ0aGlzLl9yZW5kZXJUcmFuc3BhcmVudChhKX1lbHNlIHRoaXMuX3JlbmRlclRyYW5zcGFyZW50KHRoaXMuX3RyYW5zcGFyZW50U3ViTWVzaGVzKTtyLnNldEFscGhhTW9kZSgwKX1pZihyLnNldFN0ZW5jaWxCdWZmZXIoITEpLHRoaXMuX2VkZ2VzUmVuZGVyZXJzLmxlbmd0aCl7Zm9yKGxldCBhPTA7YTx0aGlzLl9lZGdlc1JlbmRlcmVycy5sZW5ndGg7YSsrKXRoaXMuX2VkZ2VzUmVuZGVyZXJzLmRhdGFbYV0ucmVuZGVyKCk7ci5zZXRBbHBoYU1vZGUoMCl9ci5zZXRTdGVuY2lsQnVmZmVyKG4pfV9yZW5kZXJPcGFxdWVTb3J0ZWQoZSl7cmV0dXJuIFN0Ll9SZW5kZXJTb3J0ZWQoZSx0aGlzLl9vcGFxdWVTb3J0Q29tcGFyZUZuLHRoaXMuX3NjZW5lLmFjdGl2ZUNhbWVyYSwhMSl9X3JlbmRlckFscGhhVGVzdFNvcnRlZChlKXtyZXR1cm4gU3QuX1JlbmRlclNvcnRlZChlLHRoaXMuX2FscGhhVGVzdFNvcnRDb21wYXJlRm4sdGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLCExKX1fcmVuZGVyVHJhbnNwYXJlbnRTb3J0ZWQoZSl7cmV0dXJuIFN0Ll9SZW5kZXJTb3J0ZWQoZSx0aGlzLl90cmFuc3BhcmVudFNvcnRDb21wYXJlRm4sdGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLCEwKX1zdGF0aWMgX1JlbmRlclNvcnRlZChlLHQsaSxzKXtsZXQgcj0wLG47Y29uc3QgYT1pP2kuZ2xvYmFsUG9zaXRpb246U3QuX1plcm9WZWN0b3I7aWYocylmb3IoO3I8ZS5sZW5ndGg7cisrKW49ZS5kYXRhW3JdLG4uX2FscGhhSW5kZXg9bi5nZXRNZXNoKCkuYWxwaGFJbmRleCxuLl9kaXN0YW5jZVRvQ2FtZXJhPXAuRGlzdGFuY2Uobi5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ1NwaGVyZS5jZW50ZXJXb3JsZCxhKTtjb25zdCBvPWUubGVuZ3RoPT09ZS5kYXRhLmxlbmd0aD9lLmRhdGE6ZS5kYXRhLnNsaWNlKDAsZS5sZW5ndGgpO3QmJm8uc29ydCh0KTtjb25zdCBoPW9bMF0uZ2V0TWVzaCgpLmdldFNjZW5lKCk7Zm9yKHI9MDtyPG8ubGVuZ3RoO3IrKylpZihuPW9bcl0sIShoLl9hY3RpdmVNZXNoZXNGcm96ZW5CdXRLZWVwQ2xpcHBpbmcmJiFuLmlzSW5GcnVzdHVtKGguX2ZydXN0dW1QbGFuZXMpKSl7aWYocyl7Y29uc3QgbD1uLmdldE1hdGVyaWFsKCk7aWYobCYmbC5uZWVkRGVwdGhQcmVQYXNzKXtjb25zdCB1PWwuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKTt1LnNldENvbG9yV3JpdGUoITEpLHUuc2V0QWxwaGFNb2RlKDApLG4ucmVuZGVyKCExKSx1LnNldENvbG9yV3JpdGUoITApfX1uLnJlbmRlcihzKX19c3RhdGljIGRlZmF1bHRUcmFuc3BhcmVudFNvcnRDb21wYXJlKGUsdCl7cmV0dXJuIGUuX2FscGhhSW5kZXg+dC5fYWxwaGFJbmRleD8xOmUuX2FscGhhSW5kZXg8dC5fYWxwaGFJbmRleD8tMTpTdC5iYWNrVG9Gcm9udFNvcnRDb21wYXJlKGUsdCl9c3RhdGljIGJhY2tUb0Zyb250U29ydENvbXBhcmUoZSx0KXtyZXR1cm4gZS5fZGlzdGFuY2VUb0NhbWVyYTx0Ll9kaXN0YW5jZVRvQ2FtZXJhPzE6ZS5fZGlzdGFuY2VUb0NhbWVyYT50Ll9kaXN0YW5jZVRvQ2FtZXJhPy0xOjB9c3RhdGljIGZyb250VG9CYWNrU29ydENvbXBhcmUoZSx0KXtyZXR1cm4gZS5fZGlzdGFuY2VUb0NhbWVyYTx0Ll9kaXN0YW5jZVRvQ2FtZXJhPy0xOmUuX2Rpc3RhbmNlVG9DYW1lcmE+dC5fZGlzdGFuY2VUb0NhbWVyYT8xOjB9c3RhdGljIFBhaW50ZXJTb3J0Q29tcGFyZShlLHQpe2NvbnN0IGk9ZS5nZXRNZXNoKCkscz10LmdldE1lc2goKTtyZXR1cm4gaS5tYXRlcmlhbCYmcy5tYXRlcmlhbD9pLm1hdGVyaWFsLnVuaXF1ZUlkLXMubWF0ZXJpYWwudW5pcXVlSWQ6aS51bmlxdWVJZC1zLnVuaXF1ZUlkfXByZXBhcmUoKXt0aGlzLl9vcGFxdWVTdWJNZXNoZXMucmVzZXQoKSx0aGlzLl90cmFuc3BhcmVudFN1Yk1lc2hlcy5yZXNldCgpLHRoaXMuX2FscGhhVGVzdFN1Yk1lc2hlcy5yZXNldCgpLHRoaXMuX2RlcHRoT25seVN1Yk1lc2hlcy5yZXNldCgpLHRoaXMuX3BhcnRpY2xlU3lzdGVtcy5yZXNldCgpLHRoaXMucHJlcGFyZVNwcml0ZXMoKSx0aGlzLl9lZGdlc1JlbmRlcmVycy5yZXNldCgpLHRoaXMuX2VtcHR5PSEwfXByZXBhcmVTcHJpdGVzKCl7dGhpcy5fc3ByaXRlTWFuYWdlcnMucmVzZXQoKX1kaXNwb3NlKCl7dGhpcy5fb3BhcXVlU3ViTWVzaGVzLmRpc3Bvc2UoKSx0aGlzLl90cmFuc3BhcmVudFN1Yk1lc2hlcy5kaXNwb3NlKCksdGhpcy5fYWxwaGFUZXN0U3ViTWVzaGVzLmRpc3Bvc2UoKSx0aGlzLl9kZXB0aE9ubHlTdWJNZXNoZXMuZGlzcG9zZSgpLHRoaXMuX3BhcnRpY2xlU3lzdGVtcy5kaXNwb3NlKCksdGhpcy5fc3ByaXRlTWFuYWdlcnMuZGlzcG9zZSgpLHRoaXMuX2VkZ2VzUmVuZGVyZXJzLmRpc3Bvc2UoKX1kaXNwYXRjaChlLHQsaSl7dD09PXZvaWQgMCYmKHQ9ZS5nZXRNZXNoKCkpLGk9PT12b2lkIDAmJihpPWUuZ2V0TWF0ZXJpYWwoKSksaSE9bnVsbCYmKGkubmVlZEFscGhhQmxlbmRpbmdGb3JNZXNoKHQpP3RoaXMuX3RyYW5zcGFyZW50U3ViTWVzaGVzLnB1c2goZSk6aS5uZWVkQWxwaGFUZXN0aW5nKCk/KGkubmVlZERlcHRoUHJlUGFzcyYmdGhpcy5fZGVwdGhPbmx5U3ViTWVzaGVzLnB1c2goZSksdGhpcy5fYWxwaGFUZXN0U3ViTWVzaGVzLnB1c2goZSkpOihpLm5lZWREZXB0aFByZVBhc3MmJnRoaXMuX2RlcHRoT25seVN1Yk1lc2hlcy5wdXNoKGUpLHRoaXMuX29wYXF1ZVN1Yk1lc2hlcy5wdXNoKGUpKSx0Ll9yZW5kZXJpbmdHcm91cD10aGlzLHQuX2VkZ2VzUmVuZGVyZXImJnQuX2VkZ2VzUmVuZGVyZXIuaXNFbmFibGVkJiZ0aGlzLl9lZGdlc1JlbmRlcmVycy5wdXNoTm9EdXBsaWNhdGUodC5fZWRnZXNSZW5kZXJlciksdGhpcy5fZW1wdHk9ITEpfWRpc3BhdGNoU3ByaXRlcyhlKXt0aGlzLl9zcHJpdGVNYW5hZ2Vycy5wdXNoKGUpLHRoaXMuX2VtcHR5PSExfWRpc3BhdGNoUGFydGljbGVzKGUpe3RoaXMuX3BhcnRpY2xlU3lzdGVtcy5wdXNoKGUpLHRoaXMuX2VtcHR5PSExfV9yZW5kZXJQYXJ0aWNsZXMoZSl7aWYodGhpcy5fcGFydGljbGVTeXN0ZW1zLmxlbmd0aD09PTApcmV0dXJuO2NvbnN0IHQ9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhO3RoaXMuX3NjZW5lLm9uQmVmb3JlUGFydGljbGVzUmVuZGVyaW5nT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcy5fc2NlbmUpO2ZvcihsZXQgaT0wO2k8dGhpcy5fcGFydGljbGVTeXN0ZW1zLmxlbmd0aDtpKyspe2NvbnN0IHM9dGhpcy5fcGFydGljbGVTeXN0ZW1zLmRhdGFbaV07aWYoKHQmJnQubGF5ZXJNYXNrJnMubGF5ZXJNYXNrKT09PTApY29udGludWU7Y29uc3Qgcj1zLmVtaXR0ZXI7KCFyLnBvc2l0aW9ufHwhZXx8ZS5pbmRleE9mKHIpIT09LTEpJiZ0aGlzLl9zY2VuZS5fYWN0aXZlUGFydGljbGVzLmFkZENvdW50KHMucmVuZGVyKCksITEpfXRoaXMuX3NjZW5lLm9uQWZ0ZXJQYXJ0aWNsZXNSZW5kZXJpbmdPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzLl9zY2VuZSl9X3JlbmRlclNwcml0ZXMoKXtpZighdGhpcy5fc2NlbmUuc3ByaXRlc0VuYWJsZWR8fHRoaXMuX3Nwcml0ZU1hbmFnZXJzLmxlbmd0aD09PTApcmV0dXJuO2NvbnN0IGU9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhO3RoaXMuX3NjZW5lLm9uQmVmb3JlU3ByaXRlc1JlbmRlcmluZ09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMuX3NjZW5lKTtmb3IobGV0IHQ9MDt0PHRoaXMuX3Nwcml0ZU1hbmFnZXJzLmxlbmd0aDt0Kyspe2NvbnN0IGk9dGhpcy5fc3ByaXRlTWFuYWdlcnMuZGF0YVt0XTsoZSYmZS5sYXllck1hc2smaS5sYXllck1hc2spIT09MCYmaS5yZW5kZXIoKX10aGlzLl9zY2VuZS5vbkFmdGVyU3ByaXRlc1JlbmRlcmluZ09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMuX3NjZW5lKX19U3QuX1plcm9WZWN0b3I9cC5aZXJvKCk7Y2xhc3MgeW57fWNsYXNzIFdle2NvbnN0cnVjdG9yKGUpe3RoaXMuX3VzZVNjZW5lQXV0b0NsZWFyU2V0dXA9ITEsdGhpcy5fcmVuZGVyaW5nR3JvdXBzPW5ldyBBcnJheSx0aGlzLl9hdXRvQ2xlYXJEZXB0aFN0ZW5jaWw9e30sdGhpcy5fY3VzdG9tT3BhcXVlU29ydENvbXBhcmVGbj17fSx0aGlzLl9jdXN0b21BbHBoYVRlc3RTb3J0Q29tcGFyZUZuPXt9LHRoaXMuX2N1c3RvbVRyYW5zcGFyZW50U29ydENvbXBhcmVGbj17fSx0aGlzLl9yZW5kZXJpbmdHcm91cEluZm89bmV3IHluLHRoaXMuX21haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzPSExLHRoaXMuX3NjZW5lPWU7Zm9yKGxldCB0PVdlLk1JTl9SRU5ERVJJTkdHUk9VUFM7dDxXZS5NQVhfUkVOREVSSU5HR1JPVVBTO3QrKyl0aGlzLl9hdXRvQ2xlYXJEZXB0aFN0ZW5jaWxbdF09e2F1dG9DbGVhcjohMCxkZXB0aDohMCxzdGVuY2lsOiEwfX1nZXQgbWFpbnRhaW5TdGF0ZUJldHdlZW5GcmFtZXMoKXtyZXR1cm4gdGhpcy5fbWFpbnRhaW5TdGF0ZUJldHdlZW5GcmFtZXN9c2V0IG1haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzKGUpe2lmKGUhPT10aGlzLl9tYWludGFpblN0YXRlQmV0d2VlbkZyYW1lcyYmKHRoaXMuX21haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzPWUsIXRoaXMuX21haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzKSl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fc2NlbmUubWVzaGVzKWlmKHQuc3ViTWVzaGVzKWZvcihjb25zdCBpIG9mIHQuc3ViTWVzaGVzKWkuX3dhc0Rpc3BhdGNoZWQ9ITE7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fc2NlbmUuc3ByaXRlTWFuYWdlcnMpdC5fd2FzRGlzcGF0Y2hlZD0hMTtmb3IoY29uc3QgdCBvZiB0aGlzLl9zY2VuZS5wYXJ0aWNsZVN5c3RlbXMpdC5fd2FzRGlzcGF0Y2hlZD0hMX19Z2V0UmVuZGVyaW5nR3JvdXAoZSl7Y29uc3QgdD1lfHwwO3JldHVybiB0aGlzLl9wcmVwYXJlUmVuZGVyaW5nR3JvdXAodCksdGhpcy5fcmVuZGVyaW5nR3JvdXBzW3RdfV9jbGVhckRlcHRoU3RlbmNpbEJ1ZmZlcihlPSEwLHQ9ITApe3RoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlckFscmVhZHlDbGVhbmVkfHwodGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkuY2xlYXIobnVsbCwhMSxlLHQpLHRoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlckFscmVhZHlDbGVhbmVkPSEwKX1yZW5kZXIoZSx0LGkscyl7Y29uc3Qgcj10aGlzLl9yZW5kZXJpbmdHcm91cEluZm87aWYoci5zY2VuZT10aGlzLl9zY2VuZSxyLmNhbWVyYT10aGlzLl9zY2VuZS5hY3RpdmVDYW1lcmEsdGhpcy5fc2NlbmUuc3ByaXRlTWFuYWdlcnMmJnMpZm9yKGxldCBuPTA7bjx0aGlzLl9zY2VuZS5zcHJpdGVNYW5hZ2Vycy5sZW5ndGg7bisrKXtjb25zdCBhPXRoaXMuX3NjZW5lLnNwcml0ZU1hbmFnZXJzW25dO3RoaXMuZGlzcGF0Y2hTcHJpdGVzKGEpfWZvcihsZXQgbj1XZS5NSU5fUkVOREVSSU5HR1JPVVBTO248V2UuTUFYX1JFTkRFUklOR0dST1VQUztuKyspe3RoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlckFscmVhZHlDbGVhbmVkPW49PT1XZS5NSU5fUkVOREVSSU5HR1JPVVBTO2NvbnN0IGE9dGhpcy5fcmVuZGVyaW5nR3JvdXBzW25dO2lmKCFhfHxhLl9lbXB0eSljb250aW51ZTtjb25zdCBvPU1hdGgucG93KDIsbik7aWYoci5yZW5kZXJpbmdHcm91cElkPW4sdGhpcy5fc2NlbmUub25CZWZvcmVSZW5kZXJpbmdHcm91cE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHIsbyksV2UuQVVUT0NMRUFSKXtjb25zdCBoPXRoaXMuX3VzZVNjZW5lQXV0b0NsZWFyU2V0dXA/dGhpcy5fc2NlbmUuZ2V0QXV0b0NsZWFyRGVwdGhTdGVuY2lsU2V0dXAobik6dGhpcy5fYXV0b0NsZWFyRGVwdGhTdGVuY2lsW25dO2gmJmguYXV0b0NsZWFyJiZ0aGlzLl9jbGVhckRlcHRoU3RlbmNpbEJ1ZmZlcihoLmRlcHRoLGguc3RlbmNpbCl9Zm9yKGNvbnN0IGggb2YgdGhpcy5fc2NlbmUuX2JlZm9yZVJlbmRlcmluZ0dyb3VwRHJhd1N0YWdlKWguYWN0aW9uKG4pO2EucmVuZGVyKGUscyxpLHQpO2Zvcihjb25zdCBoIG9mIHRoaXMuX3NjZW5lLl9hZnRlclJlbmRlcmluZ0dyb3VwRHJhd1N0YWdlKWguYWN0aW9uKG4pO3RoaXMuX3NjZW5lLm9uQWZ0ZXJSZW5kZXJpbmdHcm91cE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHIsbyl9fXJlc2V0KCl7aWYoIXRoaXMubWFpbnRhaW5TdGF0ZUJldHdlZW5GcmFtZXMpZm9yKGxldCBlPVdlLk1JTl9SRU5ERVJJTkdHUk9VUFM7ZTxXZS5NQVhfUkVOREVSSU5HR1JPVVBTO2UrKyl7Y29uc3QgdD10aGlzLl9yZW5kZXJpbmdHcm91cHNbZV07dCYmdC5wcmVwYXJlKCl9fXJlc2V0U3ByaXRlcygpe2lmKCF0aGlzLm1haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzKWZvcihsZXQgZT1XZS5NSU5fUkVOREVSSU5HR1JPVVBTO2U8V2UuTUFYX1JFTkRFUklOR0dST1VQUztlKyspe2NvbnN0IHQ9dGhpcy5fcmVuZGVyaW5nR3JvdXBzW2VdO3QmJnQucHJlcGFyZVNwcml0ZXMoKX19ZGlzcG9zZSgpe3RoaXMuZnJlZVJlbmRlcmluZ0dyb3VwcygpLHRoaXMuX3JlbmRlcmluZ0dyb3Vwcy5sZW5ndGg9MCx0aGlzLl9yZW5kZXJpbmdHcm91cEluZm89bnVsbH1mcmVlUmVuZGVyaW5nR3JvdXBzKCl7Zm9yKGxldCBlPVdlLk1JTl9SRU5ERVJJTkdHUk9VUFM7ZTxXZS5NQVhfUkVOREVSSU5HR1JPVVBTO2UrKyl7Y29uc3QgdD10aGlzLl9yZW5kZXJpbmdHcm91cHNbZV07dCYmdC5kaXNwb3NlKCl9fV9wcmVwYXJlUmVuZGVyaW5nR3JvdXAoZSl7dGhpcy5fcmVuZGVyaW5nR3JvdXBzW2VdPT09dm9pZCAwJiYodGhpcy5fcmVuZGVyaW5nR3JvdXBzW2VdPW5ldyBTdChlLHRoaXMuX3NjZW5lLHRoaXMuX2N1c3RvbU9wYXF1ZVNvcnRDb21wYXJlRm5bZV0sdGhpcy5fY3VzdG9tQWxwaGFUZXN0U29ydENvbXBhcmVGbltlXSx0aGlzLl9jdXN0b21UcmFuc3BhcmVudFNvcnRDb21wYXJlRm5bZV0pKX1kaXNwYXRjaFNwcml0ZXMoZSl7dGhpcy5tYWludGFpblN0YXRlQmV0d2VlbkZyYW1lcyYmZS5fd2FzRGlzcGF0Y2hlZHx8KGUuX3dhc0Rpc3BhdGNoZWQ9ITAsdGhpcy5nZXRSZW5kZXJpbmdHcm91cChlLnJlbmRlcmluZ0dyb3VwSWQpLmRpc3BhdGNoU3ByaXRlcyhlKSl9ZGlzcGF0Y2hQYXJ0aWNsZXMoZSl7dGhpcy5tYWludGFpblN0YXRlQmV0d2VlbkZyYW1lcyYmZS5fd2FzRGlzcGF0Y2hlZHx8KGUuX3dhc0Rpc3BhdGNoZWQ9ITAsdGhpcy5nZXRSZW5kZXJpbmdHcm91cChlLnJlbmRlcmluZ0dyb3VwSWQpLmRpc3BhdGNoUGFydGljbGVzKGUpKX1kaXNwYXRjaChlLHQsaSl7dD09PXZvaWQgMCYmKHQ9ZS5nZXRNZXNoKCkpLCEodGhpcy5tYWludGFpblN0YXRlQmV0d2VlbkZyYW1lcyYmZS5fd2FzRGlzcGF0Y2hlZCkmJihlLl93YXNEaXNwYXRjaGVkPSEwLHRoaXMuZ2V0UmVuZGVyaW5nR3JvdXAodC5yZW5kZXJpbmdHcm91cElkKS5kaXNwYXRjaChlLHQsaSkpfXNldFJlbmRlcmluZ09yZGVyKGUsdD1udWxsLGk9bnVsbCxzPW51bGwpe2lmKHRoaXMuX2N1c3RvbU9wYXF1ZVNvcnRDb21wYXJlRm5bZV09dCx0aGlzLl9jdXN0b21BbHBoYVRlc3RTb3J0Q29tcGFyZUZuW2VdPWksdGhpcy5fY3VzdG9tVHJhbnNwYXJlbnRTb3J0Q29tcGFyZUZuW2VdPXMsdGhpcy5fcmVuZGVyaW5nR3JvdXBzW2VdKXtjb25zdCByPXRoaXMuX3JlbmRlcmluZ0dyb3Vwc1tlXTtyLm9wYXF1ZVNvcnRDb21wYXJlRm49dGhpcy5fY3VzdG9tT3BhcXVlU29ydENvbXBhcmVGbltlXSxyLmFscGhhVGVzdFNvcnRDb21wYXJlRm49dGhpcy5fY3VzdG9tQWxwaGFUZXN0U29ydENvbXBhcmVGbltlXSxyLnRyYW5zcGFyZW50U29ydENvbXBhcmVGbj10aGlzLl9jdXN0b21UcmFuc3BhcmVudFNvcnRDb21wYXJlRm5bZV19fXNldFJlbmRlcmluZ0F1dG9DbGVhckRlcHRoU3RlbmNpbChlLHQsaT0hMCxzPSEwKXt0aGlzLl9hdXRvQ2xlYXJEZXB0aFN0ZW5jaWxbZV09e2F1dG9DbGVhcjp0LGRlcHRoOmksc3RlbmNpbDpzfX1nZXRBdXRvQ2xlYXJEZXB0aFN0ZW5jaWxTZXR1cChlKXtyZXR1cm4gdGhpcy5fYXV0b0NsZWFyRGVwdGhTdGVuY2lsW2VdfX1XZS5NQVhfUkVOREVSSU5HR1JPVVBTPTQsV2UuTUlOX1JFTkRFUklOR0dST1VQUz0wLFdlLkFVVE9DTEVBUj0hMDtjbGFzcyBxe31xLk5BTUVfRUZGRUNUTEFZRVI9IkVmZmVjdExheWVyIixxLk5BTUVfTEFZRVI9IkxheWVyIixxLk5BTUVfTEVOU0ZMQVJFU1lTVEVNPSJMZW5zRmxhcmVTeXN0ZW0iLHEuTkFNRV9CT1VORElOR0JPWFJFTkRFUkVSPSJCb3VuZGluZ0JveFJlbmRlcmVyIixxLk5BTUVfUEFSVElDTEVTWVNURU09IlBhcnRpY2xlU3lzdGVtIixxLk5BTUVfR0FNRVBBRD0iR2FtZXBhZCIscS5OQU1FX1NJTVBMSUZJQ0FUSU9OUVVFVUU9IlNpbXBsaWZpY2F0aW9uUXVldWUiLHEuTkFNRV9HRU9NRVRSWUJVRkZFUlJFTkRFUkVSPSJHZW9tZXRyeUJ1ZmZlclJlbmRlcmVyIixxLk5BTUVfUFJFUEFTU1JFTkRFUkVSPSJQcmVQYXNzUmVuZGVyZXIiLHEuTkFNRV9ERVBUSFJFTkRFUkVSPSJEZXB0aFJlbmRlcmVyIixxLk5BTUVfREVQVEhQRUVMSU5HUkVOREVSRVI9IkRlcHRoUGVlbGluZ1JlbmRlcmVyIixxLk5BTUVfUE9TVFBST0NFU1NSRU5ERVJQSVBFTElORU1BTkFHRVI9IlBvc3RQcm9jZXNzUmVuZGVyUGlwZWxpbmVNYW5hZ2VyIixxLk5BTUVfU1BSSVRFPSJTcHJpdGUiLHEuTkFNRV9TVUJTVVJGQUNFPSJTdWJTdXJmYWNlIixxLk5BTUVfT1VUTElORVJFTkRFUkVSPSJPdXRsaW5lIixxLk5BTUVfUFJPQ0VEVVJBTFRFWFRVUkU9IlByb2NlZHVyYWxUZXh0dXJlIixxLk5BTUVfU0hBRE9XR0VORVJBVE9SPSJTaGFkb3dHZW5lcmF0b3IiLHEuTkFNRV9PQ1RSRUU9Ik9jdHJlZSIscS5OQU1FX1BIWVNJQ1NFTkdJTkU9IlBoeXNpY3NFbmdpbmUiLHEuTkFNRV9BVURJTz0iQXVkaW8iLHEuTkFNRV9GTFVJRFJFTkRFUkVSPSJGbHVpZFJlbmRlcmVyIixxLlNURVBfSVNSRUFEWUZPUk1FU0hfRUZGRUNUTEFZRVI9MCxxLlNURVBfQkVGT1JFRVZBTFVBVEVBQ1RJVkVNRVNIX0JPVU5ESU5HQk9YUkVOREVSRVI9MCxxLlNURVBfRVZBTFVBVEVTVUJNRVNIX0JPVU5ESU5HQk9YUkVOREVSRVI9MCxxLlNURVBfUFJFQUNUSVZFTUVTSF9CT1VORElOR0JPWFJFTkRFUkVSPTAscS5TVEVQX0NBTUVSQURSQVdSRU5ERVJUQVJHRVRfRUZGRUNUTEFZRVI9MSxxLlNURVBfQkVGT1JFQ0FNRVJBRFJBV19QUkVQQVNTPTAscS5TVEVQX0JFRk9SRUNBTUVSQURSQVdfRUZGRUNUTEFZRVI9MSxxLlNURVBfQkVGT1JFQ0FNRVJBRFJBV19MQVlFUj0yLHEuU1RFUF9CRUZPUkVSRU5ERVJUQVJHRVREUkFXX1BSRVBBU1M9MCxxLlNURVBfQkVGT1JFUkVOREVSVEFSR0VURFJBV19MQVlFUj0xLHEuU1RFUF9CRUZPUkVSRU5ERVJJTkdNRVNIX1BSRVBBU1M9MCxxLlNURVBfQkVGT1JFUkVOREVSSU5HTUVTSF9PVVRMSU5FPTEscS5TVEVQX0FGVEVSUkVOREVSSU5HTUVTSF9QUkVQQVNTPTAscS5TVEVQX0FGVEVSUkVOREVSSU5HTUVTSF9PVVRMSU5FPTEscS5TVEVQX0FGVEVSUkVOREVSSU5HR1JPVVBEUkFXX0VGRkVDVExBWUVSX0RSQVc9MCxxLlNURVBfQUZURVJSRU5ERVJJTkdHUk9VUERSQVdfQk9VTkRJTkdCT1hSRU5ERVJFUj0xLHEuU1RFUF9CRUZPUkVDQU1FUkFVUERBVEVfU0lNUExJRklDQVRJT05RVUVVRT0wLHEuU1RFUF9CRUZPUkVDQU1FUkFVUERBVEVfR0FNRVBBRD0xLHEuU1RFUF9CRUZPUkVDTEVBUl9QUk9DRURVUkFMVEVYVFVSRT0wLHEuU1RFUF9CRUZPUkVDTEVBUl9QUkVQQVNTPTEscS5TVEVQX0JFRk9SRVJFTkRFUlRBUkdFVENMRUFSX1BSRVBBU1M9MCxxLlNURVBfQUZURVJSRU5ERVJUQVJHRVREUkFXX1BSRVBBU1M9MCxxLlNURVBfQUZURVJSRU5ERVJUQVJHRVREUkFXX0xBWUVSPTEscS5TVEVQX0FGVEVSQ0FNRVJBRFJBV19QUkVQQVNTPTAscS5TVEVQX0FGVEVSQ0FNRVJBRFJBV19FRkZFQ1RMQVlFUj0xLHEuU1RFUF9BRlRFUkNBTUVSQURSQVdfTEVOU0ZMQVJFU1lTVEVNPTIscS5TVEVQX0FGVEVSQ0FNRVJBRFJBV19FRkZFQ1RMQVlFUl9EUkFXPTMscS5TVEVQX0FGVEVSQ0FNRVJBRFJBV19MQVlFUj00LHEuU1RFUF9BRlRFUkNBTUVSQURSQVdfRkxVSURSRU5ERVJFUj01LHEuU1RFUF9BRlRFUkNBTUVSQVBPU1RQUk9DRVNTX0xBWUVSPTAscS5TVEVQX0FGVEVSUkVOREVSVEFSR0VUUE9TVFBST0NFU1NfTEFZRVI9MCxxLlNURVBfQUZURVJSRU5ERVJfQVVESU89MCxxLlNURVBfR0FUSEVSUkVOREVSVEFSR0VUU19ERVBUSFJFTkRFUkVSPTAscS5TVEVQX0dBVEhFUlJFTkRFUlRBUkdFVFNfR0VPTUVUUllCVUZGRVJSRU5ERVJFUj0xLHEuU1RFUF9HQVRIRVJSRU5ERVJUQVJHRVRTX1NIQURPV0dFTkVSQVRPUj0yLHEuU1RFUF9HQVRIRVJSRU5ERVJUQVJHRVRTX1BPU1RQUk9DRVNTUkVOREVSUElQRUxJTkVNQU5BR0VSPTMscS5TVEVQX0dBVEhFUkFDVElWRUNBTUVSQVJFTkRFUlRBUkdFVFNfREVQVEhSRU5ERVJFUj0wLHEuU1RFUF9HQVRIRVJBQ1RJVkVDQU1FUkFSRU5ERVJUQVJHRVRTX0ZMVUlEUkVOREVSRVI9MSxxLlNURVBfUE9JTlRFUk1PVkVfU1BSSVRFPTAscS5TVEVQX1BPSU5URVJET1dOX1NQUklURT0wLHEuU1RFUF9QT0lOVEVSVVBfU1BSSVRFPTA7Y2xhc3MgSWUgZXh0ZW5kcyBBcnJheXtjb25zdHJ1Y3RvcihlKXtzdXBlciguLi5lKX1zdGF0aWMgQ3JlYXRlKCl7cmV0dXJuIE9iamVjdC5jcmVhdGUoSWUucHJvdG90eXBlKX1yZWdpc3RlclN0ZXAoZSx0LGkpe2xldCBzPTAscj1OdW1iZXIuTUFYX1ZBTFVFO2Zvcig7czx0aGlzLmxlbmd0aCYmKHI9dGhpc1tzXS5pbmRleCwhKGU8cikpO3MrKyk7dGhpcy5zcGxpY2UocywwLHtpbmRleDplLGNvbXBvbmVudDp0LGFjdGlvbjppLmJpbmQodCl9KX1jbGVhcigpe3RoaXMubGVuZ3RoPTB9fWNsYXNzIFRle31UZS5QT0lOVEVSRE9XTj0xLFRlLlBPSU5URVJVUD0yLFRlLlBPSU5URVJNT1ZFPTQsVGUuUE9JTlRFUldIRUVMPTgsVGUuUE9JTlRFUlBJQ0s9MTYsVGUuUE9JTlRFUlRBUD0zMixUZS5QT0lOVEVSRE9VQkxFVEFQPTY0O2NsYXNzIGZye2NvbnN0cnVjdG9yKGUsdCl7dGhpcy50eXBlPWUsdGhpcy5ldmVudD10fX1jbGFzcyBDbiBleHRlbmRzIGZye2NvbnN0cnVjdG9yKGUsdCxpLHMpe3N1cGVyKGUsdCksdGhpcy5yYXk9bnVsbCx0aGlzLm9yaWdpbmFsUGlja2luZ0luZm89bnVsbCx0aGlzLnNraXBPblBvaW50ZXJPYnNlcnZhYmxlPSExLHRoaXMubG9jYWxQb3NpdGlvbj1uZXcgdmUoaSxzKX19Y2xhc3MgdWkgZXh0ZW5kcyBmcntjb25zdHJ1Y3RvcihlLHQsaSxzPW51bGwpe3N1cGVyKGUsdCksdGhpcy5fcGlja0luZm89aSx0aGlzLl9pbnB1dE1hbmFnZXI9c31nZXQgcGlja0luZm8oKXtyZXR1cm4gdGhpcy5fcGlja0luZm98fHRoaXMuX2dlbmVyYXRlUGlja0luZm8oKSx0aGlzLl9waWNrSW5mb31fZ2VuZXJhdGVQaWNrSW5mbygpe3RoaXMuX2lucHV0TWFuYWdlciYmKHRoaXMuX3BpY2tJbmZvPXRoaXMuX2lucHV0TWFuYWdlci5fcGlja01vdmUodGhpcy5ldmVudC5wb2ludGVySWQpLHRoaXMuX2lucHV0TWFuYWdlci5fc2V0UmF5T25Qb2ludGVySW5mbyh0aGlzLl9waWNrSW5mbyx0aGlzLmV2ZW50KSx0aGlzLl9pbnB1dE1hbmFnZXI9bnVsbCl9fWNsYXNzIHV0e2NvbnN0cnVjdG9yKCl7dGhpcy5ob3ZlckN1cnNvcj0iIix0aGlzLmFjdGlvbnM9bmV3IEFycmF5LHRoaXMuaXNSZWN1cnNpdmU9ITF9c3RhdGljIGdldCBIYXNUcmlnZ2Vycygpe2Zvcihjb25zdCBlIGluIHV0LlRyaWdnZXJzKWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh1dC5UcmlnZ2VycyxlKSlyZXR1cm4hMDtyZXR1cm4hMX1zdGF0aWMgZ2V0IEhhc1BpY2tUcmlnZ2Vycygpe2Zvcihjb25zdCBlIGluIHV0LlRyaWdnZXJzKWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh1dC5UcmlnZ2VycyxlKSl7Y29uc3QgdD1wYXJzZUludChlKTtpZih0Pj0xJiZ0PD03KXJldHVybiEwfXJldHVybiExfXN0YXRpYyBIYXNTcGVjaWZpY1RyaWdnZXIoZSl7Zm9yKGNvbnN0IHQgaW4gdXQuVHJpZ2dlcnMpaWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHV0LlRyaWdnZXJzLHQpJiZwYXJzZUludCh0KT09PWUpcmV0dXJuITA7cmV0dXJuITF9fXV0LlRyaWdnZXJzPXt9O2NsYXNzIEppe31KaS5LRVlET1dOPTEsSmkuS0VZVVA9MjtjbGFzcyBDc3tjb25zdHJ1Y3RvcihlLHQpe3RoaXMudHlwZT1lLHRoaXMuZXZlbnQ9dH19Y2xhc3MgX3IgZXh0ZW5kcyBDc3tjb25zdHJ1Y3RvcihlLHQpe3N1cGVyKGUsdCksdGhpcy50eXBlPWUsdGhpcy5ldmVudD10LHRoaXMuc2tpcE9uS2V5Ym9hcmRPYnNlcnZhYmxlPSExfWdldCBza2lwT25Qb2ludGVyT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLnNraXBPbktleWJvYXJkT2JzZXJ2YWJsZX1zZXQgc2tpcE9uUG9pbnRlck9ic2VydmFibGUoZSl7dGhpcy5za2lwT25LZXlib2FyZE9ic2VydmFibGU9ZX19dmFyIHo7KGZ1bmN0aW9uKGMpe2NbYy5HZW5lcmljPTBdPSJHZW5lcmljIixjW2MuS2V5Ym9hcmQ9MV09IktleWJvYXJkIixjW2MuTW91c2U9Ml09Ik1vdXNlIixjW2MuVG91Y2g9M109IlRvdWNoIixjW2MuRHVhbFNob2NrPTRdPSJEdWFsU2hvY2siLGNbYy5YYm94PTVdPSJYYm94IixjW2MuU3dpdGNoPTZdPSJTd2l0Y2giLGNbYy5EdWFsU2Vuc2U9N109IkR1YWxTZW5zZSJ9KSh6fHwoej17fSkpO3ZhciBROyhmdW5jdGlvbihjKXtjW2MuSG9yaXpvbnRhbD0wXT0iSG9yaXpvbnRhbCIsY1tjLlZlcnRpY2FsPTFdPSJWZXJ0aWNhbCIsY1tjLkxlZnRDbGljaz0yXT0iTGVmdENsaWNrIixjW2MuTWlkZGxlQ2xpY2s9M109Ik1pZGRsZUNsaWNrIixjW2MuUmlnaHRDbGljaz00XT0iUmlnaHRDbGljayIsY1tjLkJyb3dzZXJCYWNrPTVdPSJCcm93c2VyQmFjayIsY1tjLkJyb3dzZXJGb3J3YXJkPTZdPSJCcm93c2VyRm9yd2FyZCIsY1tjLk1vdXNlV2hlZWxYPTddPSJNb3VzZVdoZWVsWCIsY1tjLk1vdXNlV2hlZWxZPThdPSJNb3VzZVdoZWVsWSIsY1tjLk1vdXNlV2hlZWxaPTldPSJNb3VzZVdoZWVsWiIsY1tjLk1vdmU9MTJdPSJNb3ZlIn0pKFF8fChRPXt9KSk7dmFyIGVzOyhmdW5jdGlvbihjKXtjW2MuSG9yaXpvbnRhbD0wXT0iSG9yaXpvbnRhbCIsY1tjLlZlcnRpY2FsPTFdPSJWZXJ0aWNhbCIsY1tjLkxlZnRDbGljaz0yXT0iTGVmdENsaWNrIixjW2MuTWlkZGxlQ2xpY2s9M109Ik1pZGRsZUNsaWNrIixjW2MuUmlnaHRDbGljaz00XT0iUmlnaHRDbGljayIsY1tjLkJyb3dzZXJCYWNrPTVdPSJCcm93c2VyQmFjayIsY1tjLkJyb3dzZXJGb3J3YXJkPTZdPSJCcm93c2VyRm9yd2FyZCIsY1tjLk1vdXNlV2hlZWxYPTddPSJNb3VzZVdoZWVsWCIsY1tjLk1vdXNlV2hlZWxZPThdPSJNb3VzZVdoZWVsWSIsY1tjLk1vdXNlV2hlZWxaPTldPSJNb3VzZVdoZWVsWiIsY1tjLkRlbHRhSG9yaXpvbnRhbD0xMF09IkRlbHRhSG9yaXpvbnRhbCIsY1tjLkRlbHRhVmVydGljYWw9MTFdPSJEZWx0YVZlcnRpY2FsIn0pKGVzfHwoZXM9e30pKTt2YXIgZ3I7KGZ1bmN0aW9uKGMpe2NbYy5Dcm9zcz0wXT0iQ3Jvc3MiLGNbYy5DaXJjbGU9MV09IkNpcmNsZSIsY1tjLlNxdWFyZT0yXT0iU3F1YXJlIixjW2MuVHJpYW5nbGU9M109IlRyaWFuZ2xlIixjW2MuTDE9NF09IkwxIixjW2MuUjE9NV09IlIxIixjW2MuTDI9Nl09IkwyIixjW2MuUjI9N109IlIyIixjW2MuU2hhcmU9OF09IlNoYXJlIixjW2MuT3B0aW9ucz05XT0iT3B0aW9ucyIsY1tjLkwzPTEwXT0iTDMiLGNbYy5SMz0xMV09IlIzIixjW2MuRFBhZFVwPTEyXT0iRFBhZFVwIixjW2MuRFBhZERvd249MTNdPSJEUGFkRG93biIsY1tjLkRQYWRMZWZ0PTE0XT0iRFBhZExlZnQiLGNbYy5EUGFkUmlnaHQ9MTVdPSJEUGFkUmlnaHQiLGNbYy5Ib21lPTE2XT0iSG9tZSIsY1tjLlRvdWNoUGFkPTE3XT0iVG91Y2hQYWQiLGNbYy5MU3RpY2tYQXhpcz0xOF09IkxTdGlja1hBeGlzIixjW2MuTFN0aWNrWUF4aXM9MTldPSJMU3RpY2tZQXhpcyIsY1tjLlJTdGlja1hBeGlzPTIwXT0iUlN0aWNrWEF4aXMiLGNbYy5SU3RpY2tZQXhpcz0yMV09IlJTdGlja1lBeGlzIn0pKGdyfHwoZ3I9e30pKTt2YXIgcHI7KGZ1bmN0aW9uKGMpe2NbYy5Dcm9zcz0wXT0iQ3Jvc3MiLGNbYy5DaXJjbGU9MV09IkNpcmNsZSIsY1tjLlNxdWFyZT0yXT0iU3F1YXJlIixjW2MuVHJpYW5nbGU9M109IlRyaWFuZ2xlIixjW2MuTDE9NF09IkwxIixjW2MuUjE9NV09IlIxIixjW2MuTDI9Nl09IkwyIixjW2MuUjI9N109IlIyIixjW2MuQ3JlYXRlPThdPSJDcmVhdGUiLGNbYy5PcHRpb25zPTldPSJPcHRpb25zIixjW2MuTDM9MTBdPSJMMyIsY1tjLlIzPTExXT0iUjMiLGNbYy5EUGFkVXA9MTJdPSJEUGFkVXAiLGNbYy5EUGFkRG93bj0xM109IkRQYWREb3duIixjW2MuRFBhZExlZnQ9MTRdPSJEUGFkTGVmdCIsY1tjLkRQYWRSaWdodD0xNV09IkRQYWRSaWdodCIsY1tjLkhvbWU9MTZdPSJIb21lIixjW2MuVG91Y2hQYWQ9MTddPSJUb3VjaFBhZCIsY1tjLkxTdGlja1hBeGlzPTE4XT0iTFN0aWNrWEF4aXMiLGNbYy5MU3RpY2tZQXhpcz0xOV09IkxTdGlja1lBeGlzIixjW2MuUlN0aWNrWEF4aXM9MjBdPSJSU3RpY2tYQXhpcyIsY1tjLlJTdGlja1lBeGlzPTIxXT0iUlN0aWNrWUF4aXMifSkocHJ8fChwcj17fSkpO3ZhciBtcjsoZnVuY3Rpb24oYyl7Y1tjLkE9MF09IkEiLGNbYy5CPTFdPSJCIixjW2MuWD0yXT0iWCIsY1tjLlk9M109IlkiLGNbYy5MQj00XT0iTEIiLGNbYy5SQj01XT0iUkIiLGNbYy5MVD02XT0iTFQiLGNbYy5SVD03XT0iUlQiLGNbYy5CYWNrPThdPSJCYWNrIixjW2MuU3RhcnQ9OV09IlN0YXJ0IixjW2MuTFM9MTBdPSJMUyIsY1tjLlJTPTExXT0iUlMiLGNbYy5EUGFkVXA9MTJdPSJEUGFkVXAiLGNbYy5EUGFkRG93bj0xM109IkRQYWREb3duIixjW2MuRFBhZExlZnQ9MTRdPSJEUGFkTGVmdCIsY1tjLkRQYWRSaWdodD0xNV09IkRQYWRSaWdodCIsY1tjLkhvbWU9MTZdPSJIb21lIixjW2MuTFN0aWNrWEF4aXM9MTddPSJMU3RpY2tYQXhpcyIsY1tjLkxTdGlja1lBeGlzPTE4XT0iTFN0aWNrWUF4aXMiLGNbYy5SU3RpY2tYQXhpcz0xOV09IlJTdGlja1hBeGlzIixjW2MuUlN0aWNrWUF4aXM9MjBdPSJSU3RpY2tZQXhpcyJ9KShtcnx8KG1yPXt9KSk7dmFyIEVyOyhmdW5jdGlvbihjKXtjW2MuQj0wXT0iQiIsY1tjLkE9MV09IkEiLGNbYy5ZPTJdPSJZIixjW2MuWD0zXT0iWCIsY1tjLkw9NF09IkwiLGNbYy5SPTVdPSJSIixjW2MuWkw9Nl09IlpMIixjW2MuWlI9N109IlpSIixjW2MuTWludXM9OF09Ik1pbnVzIixjW2MuUGx1cz05XT0iUGx1cyIsY1tjLkxTPTEwXT0iTFMiLGNbYy5SUz0xMV09IlJTIixjW2MuRFBhZFVwPTEyXT0iRFBhZFVwIixjW2MuRFBhZERvd249MTNdPSJEUGFkRG93biIsY1tjLkRQYWRMZWZ0PTE0XT0iRFBhZExlZnQiLGNbYy5EUGFkUmlnaHQ9MTVdPSJEUGFkUmlnaHQiLGNbYy5Ib21lPTE2XT0iSG9tZSIsY1tjLkNhcHR1cmU9MTddPSJDYXB0dXJlIixjW2MuTFN0aWNrWEF4aXM9MThdPSJMU3RpY2tYQXhpcyIsY1tjLkxTdGlja1lBeGlzPTE5XT0iTFN0aWNrWUF4aXMiLGNbYy5SU3RpY2tYQXhpcz0yMF09IlJTdGlja1hBeGlzIixjW2MuUlN0aWNrWUF4aXM9MjFdPSJSU3RpY2tZQXhpcyJ9KShFcnx8KEVyPXt9KSk7dmFyIHZyOyhmdW5jdGlvbihjKXtjW2MuUG9pbnRlck1vdmU9MF09IlBvaW50ZXJNb3ZlIixjW2MuUG9pbnRlckRvd249MV09IlBvaW50ZXJEb3duIixjW2MuUG9pbnRlclVwPTJdPSJQb2ludGVyVXAifSkodnJ8fCh2cj17fSkpO2NsYXNzIHRze310cy5ET01fREVMVEFfUElYRUw9MCx0cy5ET01fREVMVEFfTElORT0xLHRzLkRPTV9ERUxUQV9QQUdFPTI7Y2xhc3MgZGl7c3RhdGljIENyZWF0ZURldmljZUV2ZW50KGUsdCxpLHMscixuKXtzd2l0Y2goZSl7Y2FzZSB6LktleWJvYXJkOnJldHVybiB0aGlzLl9DcmVhdGVLZXlib2FyZEV2ZW50KGkscyxyLG4pO2Nhc2Ugei5Nb3VzZTppZihpPT09US5Nb3VzZVdoZWVsWHx8aT09PVEuTW91c2VXaGVlbFl8fGk9PT1RLk1vdXNlV2hlZWxaKXJldHVybiB0aGlzLl9DcmVhdGVXaGVlbEV2ZW50KGUsdCxpLHMscixuKTtjYXNlIHouVG91Y2g6cmV0dXJuIHRoaXMuX0NyZWF0ZVBvaW50ZXJFdmVudChlLHQsaSxzLHIsbik7ZGVmYXVsdDp0aHJvd2BVbmFibGUgdG8gZ2VuZXJhdGUgZXZlbnQgZm9yIGRldmljZSAke3pbZV19YH19c3RhdGljIF9DcmVhdGVQb2ludGVyRXZlbnQoZSx0LGkscyxyLG4pe2NvbnN0IGE9dGhpcy5fQ3JlYXRlTW91c2VFdmVudChlLHQsaSxzLHIsbik7cmV0dXJuIGU9PT16Lk1vdXNlPyhhLmRldmljZVR5cGU9ei5Nb3VzZSxhLnBvaW50ZXJJZD0xLGEucG9pbnRlclR5cGU9Im1vdXNlIik6KGEuZGV2aWNlVHlwZT16LlRvdWNoLGEucG9pbnRlcklkPXQsYS5wb2ludGVyVHlwZT0idG91Y2giKSxpPT09US5Nb3ZlP2EudHlwZT0icG9pbnRlcm1vdmUiOmk+PVEuTGVmdENsaWNrJiZpPD1RLlJpZ2h0Q2xpY2smJihhLnR5cGU9cz09PTE/InBvaW50ZXJkb3duIjoicG9pbnRlcnVwIixhLmJ1dHRvbj1pLTIpLGF9c3RhdGljIF9DcmVhdGVXaGVlbEV2ZW50KGUsdCxpLHMscixuKXtjb25zdCBhPXRoaXMuX0NyZWF0ZU1vdXNlRXZlbnQoZSx0LGkscyxyLG4pO3N3aXRjaChhLnR5cGU9IndoZWVsIixhLmRlbHRhTW9kZT10cy5ET01fREVMVEFfUElYRUwsYS5kZWx0YVg9MCxhLmRlbHRhWT0wLGEuZGVsdGFaPTAsaSl7Y2FzZSBRLk1vdXNlV2hlZWxYOmEuZGVsdGFYPXM7YnJlYWs7Y2FzZSBRLk1vdXNlV2hlZWxZOmEuZGVsdGFZPXM7YnJlYWs7Y2FzZSBRLk1vdXNlV2hlZWxaOmEuZGVsdGFaPXM7YnJlYWt9cmV0dXJuIGF9c3RhdGljIF9DcmVhdGVNb3VzZUV2ZW50KGUsdCxpLHMscixuKXtjb25zdCBhPXRoaXMuX0NyZWF0ZUV2ZW50KG4pLG89ci5wb2xsSW5wdXQoZSx0LFEuSG9yaXpvbnRhbCksaD1yLnBvbGxJbnB1dChlLHQsUS5WZXJ0aWNhbCk7cmV0dXJuIG4/KGEubW92ZW1lbnRYPTAsYS5tb3ZlbWVudFk9MCxhLm9mZnNldFg9YS5tb3ZlbWVudFgtbi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS54LGEub2Zmc2V0WT1hLm1vdmVtZW50WS1uLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnkpOihhLm1vdmVtZW50WD1yLnBvbGxJbnB1dChlLHQsZXMuRGVsdGFIb3Jpem9udGFsKSxhLm1vdmVtZW50WT1yLnBvbGxJbnB1dChlLHQsZXMuRGVsdGFWZXJ0aWNhbCksYS5vZmZzZXRYPTAsYS5vZmZzZXRZPTApLHRoaXMuX0NoZWNrTm9uQ2hhcmFjdGVyS2V5cyhhLHIpLGEuY2xpZW50WD1vLGEuY2xpZW50WT1oLGEueD1vLGEueT1oLGEuZGV2aWNlVHlwZT1lLGEuZGV2aWNlU2xvdD10LGEuaW5wdXRJbmRleD1pLGF9c3RhdGljIF9DcmVhdGVLZXlib2FyZEV2ZW50KGUsdCxpLHMpe2NvbnN0IHI9dGhpcy5fQ3JlYXRlRXZlbnQocyk7cmV0dXJuIHRoaXMuX0NoZWNrTm9uQ2hhcmFjdGVyS2V5cyhyLGkpLHIuZGV2aWNlVHlwZT16LktleWJvYXJkLHIuZGV2aWNlU2xvdD0wLHIuaW5wdXRJbmRleD1lLHIudHlwZT10PT09MT8ia2V5ZG93biI6ImtleXVwIixyLmtleT1TdHJpbmcuZnJvbUNoYXJDb2RlKGUpLHIua2V5Q29kZT1lLHJ9c3RhdGljIF9DaGVja05vbkNoYXJhY3RlcktleXMoZSx0KXtjb25zdCBpPXQuaXNEZXZpY2VBdmFpbGFibGUoei5LZXlib2FyZCkscz1pJiZ0LnBvbGxJbnB1dCh6LktleWJvYXJkLDAsMTgpPT09MSxyPWkmJnQucG9sbElucHV0KHouS2V5Ym9hcmQsMCwxNyk9PT0xLG49aSYmKHQucG9sbElucHV0KHouS2V5Ym9hcmQsMCw5MSk9PT0xfHx0LnBvbGxJbnB1dCh6LktleWJvYXJkLDAsOTIpPT09MXx8dC5wb2xsSW5wdXQoei5LZXlib2FyZCwwLDkzKT09PTEpLGE9aSYmdC5wb2xsSW5wdXQoei5LZXlib2FyZCwwLDE2KT09PTE7ZS5hbHRLZXk9cyxlLmN0cmxLZXk9cixlLm1ldGFLZXk9bixlLnNoaWZ0S2V5PWF9c3RhdGljIF9DcmVhdGVFdmVudChlKXtjb25zdCB0PXt9O3JldHVybiB0LnByZXZlbnREZWZhdWx0PSgpPT57fSx0LnRhcmdldD1lLHR9fWNsYXNzIElue2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLl9uYXRpdmVJbnB1dD1fbmF0aXZlLkRldmljZUlucHV0U3lzdGVtP25ldyBfbmF0aXZlLkRldmljZUlucHV0U3lzdGVtKGUsdCwocyxyLG4sYSk9Pntjb25zdCBvPWRpLkNyZWF0ZURldmljZUV2ZW50KHMscixuLGEsdGhpcyk7aShzLHIsbyl9KTp0aGlzLl9jcmVhdGVEdW1teU5hdGl2ZUlucHV0KCl9cG9sbElucHV0KGUsdCxpKXtyZXR1cm4gdGhpcy5fbmF0aXZlSW5wdXQucG9sbElucHV0KGUsdCxpKX1pc0RldmljZUF2YWlsYWJsZShlKXtyZXR1cm4gZT09PXouTW91c2V8fGU9PT16LlRvdWNofWRpc3Bvc2UoKXt0aGlzLl9uYXRpdmVJbnB1dC5kaXNwb3NlKCl9X2NyZWF0ZUR1bW15TmF0aXZlSW5wdXQoKXtyZXR1cm57cG9sbElucHV0OigpPT4wLGlzRGV2aWNlQXZhaWxhYmxlOigpPT4hMSxkaXNwb3NlOigpPT57fX19fWNvbnN0IFRyPTI1NSxicj1PYmplY3Qua2V5cyhRKS5sZW5ndGgvMjtjbGFzcyBQbntjb25zdHJ1Y3RvcihlLHQsaSxzKXt0aGlzLl9pbnB1dHM9W10sdGhpcy5fa2V5Ym9hcmRBY3RpdmU9ITEsdGhpcy5fcG9pbnRlckFjdGl2ZT0hMSx0aGlzLl91c2luZ1NhZmFyaT1ILklzU2FmYXJpKCksdGhpcy5fdXNpbmdNYWNPUz0vKE1hY3xpUGhvbmV8aVBvZHxpUGFkKS9pLnRlc3QobmF2aWdhdG9yLnBsYXRmb3JtKSx0aGlzLl9rZXlib2FyZERvd25FdmVudD1yPT57fSx0aGlzLl9rZXlib2FyZFVwRXZlbnQ9cj0+e30sdGhpcy5fa2V5Ym9hcmRCbHVyRXZlbnQ9cj0+e30sdGhpcy5fcG9pbnRlck1vdmVFdmVudD1yPT57fSx0aGlzLl9wb2ludGVyRG93bkV2ZW50PXI9Pnt9LHRoaXMuX3BvaW50ZXJVcEV2ZW50PXI9Pnt9LHRoaXMuX3BvaW50ZXJDYW5jZWxFdmVudD1yPT57fSx0aGlzLl9wb2ludGVyV2hlZWxFdmVudD1yPT57fSx0aGlzLl9wb2ludGVyQmx1ckV2ZW50PXI9Pnt9LHRoaXMuX2V2ZW50c0F0dGFjaGVkPSExLHRoaXMuX21vdXNlSWQ9LTEsdGhpcy5faXNVc2luZ0ZpcmVmb3g9cHMuSXNOYXZpZ2F0b3JBdmFpbGFibGUoKSYmbmF2aWdhdG9yLnVzZXJBZ2VudCYmbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJGaXJlZm94IikhPT0tMSx0aGlzLl9tYXhUb3VjaFBvaW50cz0wLHRoaXMuX3BvaW50ZXJJbnB1dENsZWFyT2JzZXJ2ZXI9bnVsbCx0aGlzLl9nYW1lcGFkQ29ubmVjdGVkRXZlbnQ9cj0+e30sdGhpcy5fZ2FtZXBhZERpc2Nvbm5lY3RlZEV2ZW50PXI9Pnt9LHRoaXMuX2V2ZW50UHJlZml4PUguR2V0UG9pbnRlclByZWZpeChlKSx0aGlzLl9lbmdpbmU9ZSx0aGlzLl9vbkRldmljZUNvbm5lY3RlZD10LHRoaXMuX29uRGV2aWNlRGlzY29ubmVjdGVkPWksdGhpcy5fb25JbnB1dENoYW5nZWQ9cyx0aGlzLl9lbmFibGVFdmVudHMoKSx0aGlzLl91c2luZ01hY09TJiYodGhpcy5fbWV0YUtleXM9W10pLHRoaXMuX2VuZ2luZS5fb25FbmdpbmVWaWV3Q2hhbmdlZHx8KHRoaXMuX2VuZ2luZS5fb25FbmdpbmVWaWV3Q2hhbmdlZD0oKT0+e3RoaXMuX2VuYWJsZUV2ZW50cygpfSl9cG9sbElucHV0KGUsdCxpKXtjb25zdCBzPXRoaXMuX2lucHV0c1tlXVt0XTtpZighcyl0aHJvd2BVbmFibGUgdG8gZmluZCBkZXZpY2UgJHt6W2VdfWA7ZT49ei5EdWFsU2hvY2smJmU8PXouRHVhbFNlbnNlJiZ0aGlzLl91cGRhdGVEZXZpY2UoZSx0LGkpO2NvbnN0IHI9c1tpXTtpZihyPT09dm9pZCAwKXRocm93YFVuYWJsZSB0byBmaW5kIGlucHV0ICR7aX0gZm9yIGRldmljZSAke3pbZV19IGluIHNsb3QgJHt0fWA7cmV0dXJuIGk9PT1RLk1vdmUmJkguV2FybigiVW5hYmxlIHRvIHByb3ZpZGUgaW5mb3JtYXRpb24gZm9yIFBvaW50ZXJJbnB1dC5Nb3ZlLiAgVHJ5IHVzaW5nIFBvaW50ZXJJbnB1dC5Ib3Jpem9udGFsIG9yIFBvaW50ZXJJbnB1dC5WZXJ0aWNhbCBmb3IgbW92ZSBkYXRhLiIpLHJ9aXNEZXZpY2VBdmFpbGFibGUoZSl7cmV0dXJuIHRoaXMuX2lucHV0c1tlXSE9PXZvaWQgMH1kaXNwb3NlKCl7dGhpcy5fb25EZXZpY2VDb25uZWN0ZWQ9KCk9Pnt9LHRoaXMuX29uRGV2aWNlRGlzY29ubmVjdGVkPSgpPT57fSx0aGlzLl9vbklucHV0Q2hhbmdlZD0oKT0+e30sZGVsZXRlIHRoaXMuX2VuZ2luZS5fb25FbmdpbmVWaWV3Q2hhbmdlZCx0aGlzLl9lbGVtZW50VG9BdHRhY2hUbyYmdGhpcy5fZGlzYWJsZUV2ZW50cygpfV9lbmFibGVFdmVudHMoKXtjb25zdCBlPXRoaXM9PT1udWxsfHx0aGlzPT09dm9pZCAwP3ZvaWQgMDp0aGlzLl9lbmdpbmUuZ2V0SW5wdXRFbGVtZW50KCk7aWYoZSYmKCF0aGlzLl9ldmVudHNBdHRhY2hlZHx8dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8hPT1lKSl7aWYodGhpcy5fZGlzYWJsZUV2ZW50cygpLHRoaXMuX2lucHV0cyl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5faW5wdXRzKWlmKHQpZm9yKGNvbnN0IGkgaW4gdCl7Y29uc3Qgcz0raSxyPXRbc107aWYocilmb3IobGV0IG49MDtuPHIubGVuZ3RoO24rKylyW25dPTB9fXRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvPWUsdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8udGFiSW5kZXg9dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8udGFiSW5kZXghPT0tMT90aGlzLl9lbGVtZW50VG9BdHRhY2hUby50YWJJbmRleDp0aGlzLl9lbmdpbmUuY2FudmFzVGFiSW5kZXgsdGhpcy5faGFuZGxlS2V5QWN0aW9ucygpLHRoaXMuX2hhbmRsZVBvaW50ZXJBY3Rpb25zKCksdGhpcy5faGFuZGxlR2FtZXBhZEFjdGlvbnMoKSx0aGlzLl9ldmVudHNBdHRhY2hlZD0hMCx0aGlzLl9jaGVja0ZvckNvbm5lY3RlZERldmljZXMoKX19X2Rpc2FibGVFdmVudHMoKXt0aGlzLl9lbGVtZW50VG9BdHRhY2hUbyYmKHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLnJlbW92ZUV2ZW50TGlzdGVuZXIoImJsdXIiLHRoaXMuX2tleWJvYXJkQmx1ckV2ZW50KSx0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZW1vdmVFdmVudExpc3RlbmVyKCJibHVyIix0aGlzLl9wb2ludGVyQmx1ckV2ZW50KSx0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlkb3duIix0aGlzLl9rZXlib2FyZERvd25FdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcigia2V5dXAiLHRoaXMuX2tleWJvYXJkVXBFdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl9ldmVudFByZWZpeCsibW92ZSIsdGhpcy5fcG9pbnRlck1vdmVFdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl9ldmVudFByZWZpeCsiZG93biIsdGhpcy5fcG9pbnRlckRvd25FdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl9ldmVudFByZWZpeCsidXAiLHRoaXMuX3BvaW50ZXJVcEV2ZW50KSx0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuX2V2ZW50UHJlZml4KyJjYW5jZWwiLHRoaXMuX3BvaW50ZXJDYW5jZWxFdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl93aGVlbEV2ZW50TmFtZSx0aGlzLl9wb2ludGVyV2hlZWxFdmVudCksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoImdhbWVwYWRjb25uZWN0ZWQiLHRoaXMuX2dhbWVwYWRDb25uZWN0ZWRFdmVudCksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoImdhbWVwYWRkaXNjb25uZWN0ZWQiLHRoaXMuX2dhbWVwYWREaXNjb25uZWN0ZWRFdmVudCkpLHRoaXMuX3BvaW50ZXJJbnB1dENsZWFyT2JzZXJ2ZXImJnRoaXMuX2VuZ2luZS5vbkVuZEZyYW1lT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fcG9pbnRlcklucHV0Q2xlYXJPYnNlcnZlciksdGhpcy5fZXZlbnRzQXR0YWNoZWQ9ITF9X2NoZWNrRm9yQ29ubmVjdGVkRGV2aWNlcygpe2lmKG5hdmlnYXRvci5nZXRHYW1lcGFkcyl7Y29uc3QgZT1uYXZpZ2F0b3IuZ2V0R2FtZXBhZHMoKTtmb3IoY29uc3QgdCBvZiBlKXQmJnRoaXMuX2FkZEdhbWVQYWQodCl9dHlwZW9mIG1hdGNoTWVkaWE9PSJmdW5jdGlvbiImJm1hdGNoTWVkaWEoIihwb2ludGVyOmZpbmUpIikubWF0Y2hlcyYmdGhpcy5fYWRkUG9pbnRlckRldmljZSh6Lk1vdXNlLDAsMCwwKX1fYWRkR2FtZVBhZChlKXtjb25zdCB0PXRoaXMuX2dldEdhbWVwYWREZXZpY2VUeXBlKGUuaWQpLGk9ZS5pbmRleDt0aGlzLl9nYW1lcGFkcz10aGlzLl9nYW1lcGFkc3x8bmV3IEFycmF5KGUuaW5kZXgrMSksdGhpcy5fcmVnaXN0ZXJEZXZpY2UodCxpLGUuYnV0dG9ucy5sZW5ndGgrZS5heGVzLmxlbmd0aCksdGhpcy5fZ2FtZXBhZHNbaV09dH1fYWRkUG9pbnRlckRldmljZShlLHQsaSxzKXt0aGlzLl9wb2ludGVyQWN0aXZlfHwodGhpcy5fcG9pbnRlckFjdGl2ZT0hMCksdGhpcy5fcmVnaXN0ZXJEZXZpY2UoZSx0LGJyKTtjb25zdCByPXRoaXMuX2lucHV0c1tlXVt0XTtyWzBdPWksclsxXT1zfV9yZWdpc3RlckRldmljZShlLHQsaSl7aWYodD09PXZvaWQgMCl0aHJvd2BVbmFibGUgdG8gcmVnaXN0ZXIgZGV2aWNlICR7eltlXX0gdG8gdW5kZWZpbmVkIHNsb3QuYDtpZih0aGlzLl9pbnB1dHNbZV18fCh0aGlzLl9pbnB1dHNbZV09e30pLCF0aGlzLl9pbnB1dHNbZV1bdF0pe2NvbnN0IHM9bmV3IEFycmF5KGkpO3MuZmlsbCgwKSx0aGlzLl9pbnB1dHNbZV1bdF09cyx0aGlzLl9vbkRldmljZUNvbm5lY3RlZChlLHQpfX1fdW5yZWdpc3RlckRldmljZShlLHQpe3RoaXMuX2lucHV0c1tlXVt0XSYmKGRlbGV0ZSB0aGlzLl9pbnB1dHNbZV1bdF0sdGhpcy5fb25EZXZpY2VEaXNjb25uZWN0ZWQoZSx0KSl9X2hhbmRsZUtleUFjdGlvbnMoKXt0aGlzLl9rZXlib2FyZERvd25FdmVudD1lPT57dGhpcy5fa2V5Ym9hcmRBY3RpdmV8fCh0aGlzLl9rZXlib2FyZEFjdGl2ZT0hMCx0aGlzLl9yZWdpc3RlckRldmljZSh6LktleWJvYXJkLDAsVHIpKTtjb25zdCB0PXRoaXMuX2lucHV0c1t6LktleWJvYXJkXVswXTtpZih0KXt0W2Uua2V5Q29kZV09MTtjb25zdCBpPWU7aS5pbnB1dEluZGV4PWUua2V5Q29kZSx0aGlzLl91c2luZ01hY09TJiZlLm1ldGFLZXkmJmUua2V5IT09Ik1ldGEiJiYodGhpcy5fbWV0YUtleXMuaW5jbHVkZXMoZS5rZXlDb2RlKXx8dGhpcy5fbWV0YUtleXMucHVzaChlLmtleUNvZGUpKSx0aGlzLl9vbklucHV0Q2hhbmdlZCh6LktleWJvYXJkLDAsaSl9fSx0aGlzLl9rZXlib2FyZFVwRXZlbnQ9ZT0+e3RoaXMuX2tleWJvYXJkQWN0aXZlfHwodGhpcy5fa2V5Ym9hcmRBY3RpdmU9ITAsdGhpcy5fcmVnaXN0ZXJEZXZpY2Uoei5LZXlib2FyZCwwLFRyKSk7Y29uc3QgdD10aGlzLl9pbnB1dHNbei5LZXlib2FyZF1bMF07aWYodCl7dFtlLmtleUNvZGVdPTA7Y29uc3QgaT1lO2lmKGkuaW5wdXRJbmRleD1lLmtleUNvZGUsdGhpcy5fdXNpbmdNYWNPUyYmZS5rZXk9PT0iTWV0YSImJnRoaXMuX21ldGFLZXlzLmxlbmd0aD4wKXtmb3IoY29uc3QgcyBvZiB0aGlzLl9tZXRhS2V5cyl7Y29uc3Qgcj1kaS5DcmVhdGVEZXZpY2VFdmVudCh6LktleWJvYXJkLDAscywwLHRoaXMsdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8pO3Rbc109MCx0aGlzLl9vbklucHV0Q2hhbmdlZCh6LktleWJvYXJkLDAscil9dGhpcy5fbWV0YUtleXMuc3BsaWNlKDAsdGhpcy5fbWV0YUtleXMubGVuZ3RoKX10aGlzLl9vbklucHV0Q2hhbmdlZCh6LktleWJvYXJkLDAsaSl9fSx0aGlzLl9rZXlib2FyZEJsdXJFdmVudD0oKT0+e2lmKHRoaXMuX2tleWJvYXJkQWN0aXZlKXtjb25zdCBlPXRoaXMuX2lucHV0c1t6LktleWJvYXJkXVswXTtmb3IobGV0IHQ9MDt0PGUubGVuZ3RoO3QrKylpZihlW3RdIT09MCl7ZVt0XT0wO2NvbnN0IGk9ZGkuQ3JlYXRlRGV2aWNlRXZlbnQoei5LZXlib2FyZCwwLHQsMCx0aGlzLHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvKTt0aGlzLl9vbklucHV0Q2hhbmdlZCh6LktleWJvYXJkLDAsaSl9dGhpcy5fdXNpbmdNYWNPUyYmdGhpcy5fbWV0YUtleXMuc3BsaWNlKDAsdGhpcy5fbWV0YUtleXMubGVuZ3RoKX19LHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLHRoaXMuX2tleWJvYXJkRG93bkV2ZW50KSx0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5hZGRFdmVudExpc3RlbmVyKCJrZXl1cCIsdGhpcy5fa2V5Ym9hcmRVcEV2ZW50KSx0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5hZGRFdmVudExpc3RlbmVyKCJibHVyIix0aGlzLl9rZXlib2FyZEJsdXJFdmVudCl9X2hhbmRsZVBvaW50ZXJBY3Rpb25zKCl7dGhpcy5fbWF4VG91Y2hQb2ludHM9cHMuSXNOYXZpZ2F0b3JBdmFpbGFibGUoKSYmbmF2aWdhdG9yLm1heFRvdWNoUG9pbnRzfHwyLHRoaXMuX2FjdGl2ZVRvdWNoSWRzfHwodGhpcy5fYWN0aXZlVG91Y2hJZHM9bmV3IEFycmF5KHRoaXMuX21heFRvdWNoUG9pbnRzKSk7Zm9yKGxldCBpPTA7aTx0aGlzLl9tYXhUb3VjaFBvaW50cztpKyspdGhpcy5fYWN0aXZlVG91Y2hJZHNbaV09LTE7dGhpcy5fcG9pbnRlck1vdmVFdmVudD1pPT57Y29uc3Qgcz10aGlzLl9nZXRQb2ludGVyVHlwZShpKSxyPXM9PT16Lk1vdXNlPzA6dGhpcy5fYWN0aXZlVG91Y2hJZHMuaW5kZXhPZihpLnBvaW50ZXJJZCk7dGhpcy5faW5wdXRzW3NdfHwodGhpcy5faW5wdXRzW3NdPXt9KSx0aGlzLl9pbnB1dHNbc11bcl18fHRoaXMuX2FkZFBvaW50ZXJEZXZpY2UocyxyLGkuY2xpZW50WCxpLmNsaWVudFkpO2NvbnN0IG49dGhpcy5faW5wdXRzW3NdW3JdO2lmKG4pe2NvbnN0IGE9aTthLmlucHV0SW5kZXg9US5Nb3ZlLG5bUS5Ib3Jpem9udGFsXT1pLmNsaWVudFgsbltRLlZlcnRpY2FsXT1pLmNsaWVudFksdGhpcy5fb25JbnB1dENoYW5nZWQocyxyLGEpLCF0aGlzLl91c2luZ1NhZmFyaSYmaS5idXR0b24hPT0tMSYmKGEuaW5wdXRJbmRleD1pLmJ1dHRvbisyLG5baS5idXR0b24rMl09bltpLmJ1dHRvbisyXT8wOjEsdGhpcy5fb25JbnB1dENoYW5nZWQocyxyLGEpKX19LHRoaXMuX3BvaW50ZXJEb3duRXZlbnQ9aT0+e2NvbnN0IHM9dGhpcy5fZ2V0UG9pbnRlclR5cGUoaSk7bGV0IHI9cz09PXouTW91c2U/MDppLnBvaW50ZXJJZDtpZihzPT09ei5Ub3VjaCl7Y29uc3QgYT10aGlzLl9hY3RpdmVUb3VjaElkcy5pbmRleE9mKC0xKTtpZihhPj0wKXI9YSx0aGlzLl9hY3RpdmVUb3VjaElkc1thXT1pLnBvaW50ZXJJZDtlbHNle0guV2FybihgTWF4IG51bWJlciBvZiB0b3VjaGVzIGV4Y2VlZGVkLiAgSWdub3JpbmcgdG91Y2hlcyBpbiBleGNlc3Mgb2YgJHt0aGlzLl9tYXhUb3VjaFBvaW50c31gKTtyZXR1cm59fXRoaXMuX2lucHV0c1tzXXx8KHRoaXMuX2lucHV0c1tzXT17fSksdGhpcy5faW5wdXRzW3NdW3JdP3M9PT16LlRvdWNoJiZ0aGlzLl9vbkRldmljZUNvbm5lY3RlZChzLHIpOnRoaXMuX2FkZFBvaW50ZXJEZXZpY2UocyxyLGkuY2xpZW50WCxpLmNsaWVudFkpO2NvbnN0IG49dGhpcy5faW5wdXRzW3NdW3JdO2lmKG4pe2NvbnN0IGE9bltRLkhvcml6b250YWxdLG89bltRLlZlcnRpY2FsXTtpZihzPT09ei5Nb3VzZSl7aWYodGhpcy5fbW91c2VJZD09PS0xJiYoaS5wb2ludGVySWQ9PT12b2lkIDA/dGhpcy5fbW91c2VJZD10aGlzLl9pc1VzaW5nRmlyZWZveD8wOjE6dGhpcy5fbW91c2VJZD1pLnBvaW50ZXJJZCksIWRvY3VtZW50LnBvaW50ZXJMb2NrRWxlbWVudCl0cnl7dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8uc2V0UG9pbnRlckNhcHR1cmUodGhpcy5fbW91c2VJZCl9Y2F0Y2h7fX1lbHNlIGlmKGkucG9pbnRlcklkJiYhZG9jdW1lbnQucG9pbnRlckxvY2tFbGVtZW50KXRyeXt0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5zZXRQb2ludGVyQ2FwdHVyZShpLnBvaW50ZXJJZCl9Y2F0Y2h7fW5bUS5Ib3Jpem9udGFsXT1pLmNsaWVudFgsbltRLlZlcnRpY2FsXT1pLmNsaWVudFksbltpLmJ1dHRvbisyXT0xO2NvbnN0IGg9aTtoLmlucHV0SW5kZXg9aS5idXR0b24rMix0aGlzLl9vbklucHV0Q2hhbmdlZChzLHIsaCksKGEhPT1pLmNsaWVudFh8fG8hPT1pLmNsaWVudFkpJiYoaC5pbnB1dEluZGV4PVEuTW92ZSx0aGlzLl9vbklucHV0Q2hhbmdlZChzLHIsaCkpfX0sdGhpcy5fcG9pbnRlclVwRXZlbnQ9aT0+e3ZhciBzLHIsbixhLG87Y29uc3QgaD10aGlzLl9nZXRQb2ludGVyVHlwZShpKSxsPWg9PT16Lk1vdXNlPzA6dGhpcy5fYWN0aXZlVG91Y2hJZHMuaW5kZXhPZihpLnBvaW50ZXJJZCk7aWYoaD09PXouVG91Y2gpe2lmKGw9PT0tMSlyZXR1cm47dGhpcy5fYWN0aXZlVG91Y2hJZHNbbF09LTF9Y29uc3QgdT0ocz10aGlzLl9pbnB1dHNbaF0pPT09bnVsbHx8cz09PXZvaWQgMD92b2lkIDA6c1tsXTtpZih1JiZ1W2kuYnV0dG9uKzJdIT09MCl7Y29uc3QgZD11W1EuSG9yaXpvbnRhbF0sZj11W1EuVmVydGljYWxdO3VbUS5Ib3Jpem9udGFsXT1pLmNsaWVudFgsdVtRLlZlcnRpY2FsXT1pLmNsaWVudFksdVtpLmJ1dHRvbisyXT0wO2NvbnN0IF89aTsoZCE9PWkuY2xpZW50WHx8ZiE9PWkuY2xpZW50WSkmJihfLmlucHV0SW5kZXg9US5Nb3ZlLHRoaXMuX29uSW5wdXRDaGFuZ2VkKGgsbCxfKSksXy5pbnB1dEluZGV4PWkuYnV0dG9uKzIsaD09PXouTW91c2UmJnRoaXMuX21vdXNlSWQ+PTAmJighKChuPShyPXRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvKS5oYXNQb2ludGVyQ2FwdHVyZSk9PT1udWxsfHxuPT09dm9pZCAwKSYmbi5jYWxsKHIsdGhpcy5fbW91c2VJZCkpP3RoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLnJlbGVhc2VQb2ludGVyQ2FwdHVyZSh0aGlzLl9tb3VzZUlkKTppLnBvaW50ZXJJZCYmKCEoKG89KGE9dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8pLmhhc1BvaW50ZXJDYXB0dXJlKT09PW51bGx8fG89PT12b2lkIDApJiZvLmNhbGwoYSxpLnBvaW50ZXJJZCkpJiZ0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZWxlYXNlUG9pbnRlckNhcHR1cmUoaS5wb2ludGVySWQpLHRoaXMuX29uSW5wdXRDaGFuZ2VkKGgsbCxfKSxoPT09ei5Ub3VjaCYmdGhpcy5fb25EZXZpY2VEaXNjb25uZWN0ZWQoaCxsKX19LHRoaXMuX3BvaW50ZXJDYW5jZWxFdmVudD1pPT57dmFyIHMscixuLGE7aWYoaS5wb2ludGVyVHlwZT09PSJtb3VzZSIpe2NvbnN0IG89dGhpcy5faW5wdXRzW3ouTW91c2VdWzBdO3RoaXMuX21vdXNlSWQ+PTAmJighKChyPShzPXRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvKS5oYXNQb2ludGVyQ2FwdHVyZSk9PT1udWxsfHxyPT09dm9pZCAwKSYmci5jYWxsKHMsdGhpcy5fbW91c2VJZCkpJiZ0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZWxlYXNlUG9pbnRlckNhcHR1cmUodGhpcy5fbW91c2VJZCk7Zm9yKGxldCBoPVEuTGVmdENsaWNrO2g8PVEuQnJvd3NlckZvcndhcmQ7aCsrKWlmKG9baF09PT0xKXtvW2hdPTA7Y29uc3QgbD1kaS5DcmVhdGVEZXZpY2VFdmVudCh6Lk1vdXNlLDAsaCwwLHRoaXMsdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8pO3RoaXMuX29uSW5wdXRDaGFuZ2VkKHouTW91c2UsMCxsKX19ZWxzZXtjb25zdCBvPXRoaXMuX2FjdGl2ZVRvdWNoSWRzLmluZGV4T2YoaS5wb2ludGVySWQpOyEoKGE9KG49dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8pLmhhc1BvaW50ZXJDYXB0dXJlKT09PW51bGx8fGE9PT12b2lkIDApJiZhLmNhbGwobixpLnBvaW50ZXJJZCkmJnRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLnJlbGVhc2VQb2ludGVyQ2FwdHVyZShpLnBvaW50ZXJJZCksdGhpcy5faW5wdXRzW3ouVG91Y2hdW29dW1EuTGVmdENsaWNrXT0wO2NvbnN0IGg9ZGkuQ3JlYXRlRGV2aWNlRXZlbnQoei5Ub3VjaCxvLFEuTGVmdENsaWNrLDAsdGhpcyx0aGlzLl9lbGVtZW50VG9BdHRhY2hUbyk7dGhpcy5fb25JbnB1dENoYW5nZWQoei5Ub3VjaCxvLGgpLHRoaXMuX2FjdGl2ZVRvdWNoSWRzW29dPS0xLHRoaXMuX29uRGV2aWNlRGlzY29ubmVjdGVkKHouVG91Y2gsbyl9fSx0aGlzLl93aGVlbEV2ZW50TmFtZT0ib253aGVlbCJpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKT8id2hlZWwiOmRvY3VtZW50Lm9ubW91c2V3aGVlbCE9PXZvaWQgMD8ibW91c2V3aGVlbCI6IkRPTU1vdXNlU2Nyb2xsIjtsZXQgZT0hMTtjb25zdCB0PWZ1bmN0aW9uKCl7fTt0cnl7Y29uc3QgaT1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sInBhc3NpdmUiLHtnZXQ6ZnVuY3Rpb24oKXtlPSEwfX0pO3RoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIoInRlc3QiLHQsaSksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcigidGVzdCIsdCxpKX1jYXRjaHt9dGhpcy5fcG9pbnRlckJsdXJFdmVudD0oKT0+e3ZhciBpLHMscixuLGE7aWYodGhpcy5pc0RldmljZUF2YWlsYWJsZSh6Lk1vdXNlKSl7Y29uc3Qgbz10aGlzLl9pbnB1dHNbei5Nb3VzZV1bMF07dGhpcy5fbW91c2VJZD49MCYmKCEoKHM9KGk9dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8pLmhhc1BvaW50ZXJDYXB0dXJlKT09PW51bGx8fHM9PT12b2lkIDApJiZzLmNhbGwoaSx0aGlzLl9tb3VzZUlkKSkmJnRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLnJlbGVhc2VQb2ludGVyQ2FwdHVyZSh0aGlzLl9tb3VzZUlkKTtmb3IobGV0IGg9US5MZWZ0Q2xpY2s7aDw9US5Ccm93c2VyRm9yd2FyZDtoKyspaWYob1toXT09PTEpe29baF09MDtjb25zdCBsPWRpLkNyZWF0ZURldmljZUV2ZW50KHouTW91c2UsMCxoLDAsdGhpcyx0aGlzLl9lbGVtZW50VG9BdHRhY2hUbyk7dGhpcy5fb25JbnB1dENoYW5nZWQoei5Nb3VzZSwwLGwpfX1pZih0aGlzLmlzRGV2aWNlQXZhaWxhYmxlKHouVG91Y2gpKXtjb25zdCBvPXRoaXMuX2lucHV0c1t6LlRvdWNoXTtmb3IobGV0IGg9MDtoPHRoaXMuX2FjdGl2ZVRvdWNoSWRzLmxlbmd0aDtoKyspe2NvbnN0IGw9dGhpcy5fYWN0aXZlVG91Y2hJZHNbaF07aWYoISgobj0ocj10aGlzLl9lbGVtZW50VG9BdHRhY2hUbykuaGFzUG9pbnRlckNhcHR1cmUpPT09bnVsbHx8bj09PXZvaWQgMCkmJm4uY2FsbChyLGwpJiZ0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZWxlYXNlUG9pbnRlckNhcHR1cmUobCksbCE9PS0xJiYoKGE9b1toXSk9PT1udWxsfHxhPT09dm9pZCAwP3ZvaWQgMDphW1EuTGVmdENsaWNrXSk9PT0xKXtvW2hdW1EuTGVmdENsaWNrXT0wO2NvbnN0IHU9ZGkuQ3JlYXRlRGV2aWNlRXZlbnQoei5Ub3VjaCxoLFEuTGVmdENsaWNrLDAsdGhpcyx0aGlzLl9lbGVtZW50VG9BdHRhY2hUbyk7dGhpcy5fb25JbnB1dENoYW5nZWQoei5Ub3VjaCxoLHUpLHRoaXMuX2FjdGl2ZVRvdWNoSWRzW2hdPS0xLHRoaXMuX29uRGV2aWNlRGlzY29ubmVjdGVkKHouVG91Y2gsaCl9fX19LHRoaXMuX3BvaW50ZXJXaGVlbEV2ZW50PWk9Pntjb25zdCBzPXouTW91c2Uscj0wO3RoaXMuX2lucHV0c1tzXXx8KHRoaXMuX2lucHV0c1tzXT1bXSksdGhpcy5faW5wdXRzW3NdW3JdfHwodGhpcy5fcG9pbnRlckFjdGl2ZT0hMCx0aGlzLl9yZWdpc3RlckRldmljZShzLHIsYnIpKTtjb25zdCBuPXRoaXMuX2lucHV0c1tzXVtyXTtpZihuKXtuW1EuTW91c2VXaGVlbFhdPWkuZGVsdGFYfHwwLG5bUS5Nb3VzZVdoZWVsWV09aS5kZWx0YVl8fGkud2hlZWxEZWx0YXx8MCxuW1EuTW91c2VXaGVlbFpdPWkuZGVsdGFafHwwO2NvbnN0IGE9aTtuW1EuTW91c2VXaGVlbFhdIT09MCYmKGEuaW5wdXRJbmRleD1RLk1vdXNlV2hlZWxYLHRoaXMuX29uSW5wdXRDaGFuZ2VkKHMscixhKSksbltRLk1vdXNlV2hlZWxZXSE9PTAmJihhLmlucHV0SW5kZXg9US5Nb3VzZVdoZWVsWSx0aGlzLl9vbklucHV0Q2hhbmdlZChzLHIsYSkpLG5bUS5Nb3VzZVdoZWVsWl0hPT0wJiYoYS5pbnB1dEluZGV4PVEuTW91c2VXaGVlbFosdGhpcy5fb25JbnB1dENoYW5nZWQocyxyLGEpKX19LHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5fZXZlbnRQcmVmaXgrIm1vdmUiLHRoaXMuX3BvaW50ZXJNb3ZlRXZlbnQpLHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5fZXZlbnRQcmVmaXgrImRvd24iLHRoaXMuX3BvaW50ZXJEb3duRXZlbnQpLHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5fZXZlbnRQcmVmaXgrInVwIix0aGlzLl9wb2ludGVyVXBFdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8uYWRkRXZlbnRMaXN0ZW5lcih0aGlzLl9ldmVudFByZWZpeCsiY2FuY2VsIix0aGlzLl9wb2ludGVyQ2FuY2VsRXZlbnQpLHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIoImJsdXIiLHRoaXMuX3BvaW50ZXJCbHVyRXZlbnQpLHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5fd2hlZWxFdmVudE5hbWUsdGhpcy5fcG9pbnRlcldoZWVsRXZlbnQsZT97cGFzc2l2ZTohMX06ITEpLHRoaXMuX3BvaW50ZXJJbnB1dENsZWFyT2JzZXJ2ZXI9dGhpcy5fZW5naW5lLm9uRW5kRnJhbWVPYnNlcnZhYmxlLmFkZCgoKT0+e2lmKHRoaXMuaXNEZXZpY2VBdmFpbGFibGUoei5Nb3VzZSkpe2NvbnN0IGk9dGhpcy5faW5wdXRzW3ouTW91c2VdWzBdO2lbUS5Nb3VzZVdoZWVsWF09MCxpW1EuTW91c2VXaGVlbFldPTAsaVtRLk1vdXNlV2hlZWxaXT0wfX0pfV9oYW5kbGVHYW1lcGFkQWN0aW9ucygpe3RoaXMuX2dhbWVwYWRDb25uZWN0ZWRFdmVudD1lPT57dGhpcy5fYWRkR2FtZVBhZChlLmdhbWVwYWQpfSx0aGlzLl9nYW1lcGFkRGlzY29ubmVjdGVkRXZlbnQ9ZT0+e2lmKHRoaXMuX2dhbWVwYWRzKXtjb25zdCB0PXRoaXMuX2dldEdhbWVwYWREZXZpY2VUeXBlKGUuZ2FtZXBhZC5pZCksaT1lLmdhbWVwYWQuaW5kZXg7dGhpcy5fdW5yZWdpc3RlckRldmljZSh0LGkpLGRlbGV0ZSB0aGlzLl9nYW1lcGFkc1tpXX19LHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJnYW1lcGFkY29ubmVjdGVkIix0aGlzLl9nYW1lcGFkQ29ubmVjdGVkRXZlbnQpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJnYW1lcGFkZGlzY29ubmVjdGVkIix0aGlzLl9nYW1lcGFkRGlzY29ubmVjdGVkRXZlbnQpfV91cGRhdGVEZXZpY2UoZSx0LGkpe2NvbnN0IHM9bmF2aWdhdG9yLmdldEdhbWVwYWRzKClbdF07aWYocyYmZT09PXRoaXMuX2dhbWVwYWRzW3RdKXtjb25zdCByPXRoaXMuX2lucHV0c1tlXVt0XTtpPj1zLmJ1dHRvbnMubGVuZ3RoP3JbaV09cy5heGVzW2ktcy5idXR0b25zLmxlbmd0aF0udmFsdWVPZigpOnJbaV09cy5idXR0b25zW2ldLnZhbHVlfX1fZ2V0R2FtZXBhZERldmljZVR5cGUoZSl7cmV0dXJuIGUuaW5kZXhPZigiMDU0YyIpIT09LTE/ZS5pbmRleE9mKCIwY2U2IikhPT0tMT96LkR1YWxTZW5zZTp6LkR1YWxTaG9jazplLmluZGV4T2YoIlhib3ggT25lIikhPT0tMXx8ZS5zZWFyY2goIlhib3ggMzYwIikhPT0tMXx8ZS5zZWFyY2goInhpbnB1dCIpIT09LTE/ei5YYm94OmUuaW5kZXhPZigiMDU3ZSIpIT09LTE/ei5Td2l0Y2g6ei5HZW5lcmljfV9nZXRQb2ludGVyVHlwZShlKXtsZXQgdD16Lk1vdXNlO3JldHVybihlLnBvaW50ZXJUeXBlPT09InRvdWNoInx8ZS5wb2ludGVyVHlwZT09PSJwZW4ifHxlLnRvdWNoZXMpJiYodD16LlRvdWNoKSx0fX1jbGFzcyBTcntjb25zdHJ1Y3RvcihlLHQsaT0wKXt0aGlzLmRldmljZVR5cGU9dCx0aGlzLmRldmljZVNsb3Q9aSx0aGlzLm9uSW5wdXRDaGFuZ2VkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9kZXZpY2VJbnB1dFN5c3RlbT1lfWdldElucHV0KGUpe3JldHVybiB0aGlzLl9kZXZpY2VJbnB1dFN5c3RlbS5wb2xsSW5wdXQodGhpcy5kZXZpY2VUeXBlLHRoaXMuZGV2aWNlU2xvdCxlKX19Y2xhc3MgRG57Y29uc3RydWN0b3IoZSl7dGhpcy5fcmVnaXN0ZXJlZE1hbmFnZXJzPW5ldyBBcnJheSx0aGlzLl9yZWZDb3VudD0wLHRoaXMucmVnaXN0ZXJNYW5hZ2VyPW49Pntmb3IobGV0IGE9MDthPHRoaXMuX2RldmljZXMubGVuZ3RoO2ErKyl7Y29uc3Qgbz10aGlzLl9kZXZpY2VzW2FdO2Zvcihjb25zdCBoIGluIG8pe2NvbnN0IGw9K2g7bi5fYWRkRGV2aWNlKG5ldyBTcih0aGlzLl9kZXZpY2VJbnB1dFN5c3RlbSxhLGwpKX19dGhpcy5fcmVnaXN0ZXJlZE1hbmFnZXJzLnB1c2gobil9LHRoaXMudW5yZWdpc3Rlck1hbmFnZXI9bj0+e2NvbnN0IGE9dGhpcy5fcmVnaXN0ZXJlZE1hbmFnZXJzLmluZGV4T2Yobik7YT4tMSYmdGhpcy5fcmVnaXN0ZXJlZE1hbmFnZXJzLnNwbGljZShhLDEpfTtjb25zdCB0PU9iamVjdC5rZXlzKHopLmxlbmd0aC8yO3RoaXMuX2RldmljZXM9bmV3IEFycmF5KHQpO2NvbnN0IGk9KG4sYSk9Pnt0aGlzLl9kZXZpY2VzW25dfHwodGhpcy5fZGV2aWNlc1tuXT1uZXcgQXJyYXkpLHRoaXMuX2RldmljZXNbbl1bYV18fCh0aGlzLl9kZXZpY2VzW25dW2FdPWEpO2Zvcihjb25zdCBvIG9mIHRoaXMuX3JlZ2lzdGVyZWRNYW5hZ2Vycyl7Y29uc3QgaD1uZXcgU3IodGhpcy5fZGV2aWNlSW5wdXRTeXN0ZW0sbixhKTtvLl9hZGREZXZpY2UoaCl9fSxzPShuLGEpPT57dmFyIG87ISgobz10aGlzLl9kZXZpY2VzW25dKT09PW51bGx8fG89PT12b2lkIDApJiZvW2FdJiZkZWxldGUgdGhpcy5fZGV2aWNlc1tuXVthXTtmb3IoY29uc3QgaCBvZiB0aGlzLl9yZWdpc3RlcmVkTWFuYWdlcnMpaC5fcmVtb3ZlRGV2aWNlKG4sYSl9LHI9KG4sYSxvKT0+e2lmKG8pZm9yKGNvbnN0IGggb2YgdGhpcy5fcmVnaXN0ZXJlZE1hbmFnZXJzKWguX29uSW5wdXRDaGFuZ2VkKG4sYSxvKX07dHlwZW9mIF9uYXRpdmU8InUiP3RoaXMuX2RldmljZUlucHV0U3lzdGVtPW5ldyBJbihpLHMscik6dGhpcy5fZGV2aWNlSW5wdXRTeXN0ZW09bmV3IFBuKGUsaSxzLHIpfWRpc3Bvc2UoKXt0aGlzLl9kZXZpY2VJbnB1dFN5c3RlbS5kaXNwb3NlKCl9fWNsYXNzIEZue2NvbnN0cnVjdG9yKGUpe2NvbnN0IHQ9T2JqZWN0LmtleXMoeikubGVuZ3RoLzI7dGhpcy5fZGV2aWNlcz1uZXcgQXJyYXkodCksdGhpcy5fZmlyc3REZXZpY2U9bmV3IEFycmF5KHQpLHRoaXMuX2VuZ2luZT1lLHRoaXMuX2VuZ2luZS5fZGV2aWNlU291cmNlTWFuYWdlcnx8KHRoaXMuX2VuZ2luZS5fZGV2aWNlU291cmNlTWFuYWdlcj1uZXcgRG4oZSkpLHRoaXMuX2VuZ2luZS5fZGV2aWNlU291cmNlTWFuYWdlci5fcmVmQ291bnQrKyx0aGlzLm9uRGV2aWNlQ29ubmVjdGVkT2JzZXJ2YWJsZT1uZXcgRihpPT57Zm9yKGNvbnN0IHMgb2YgdGhpcy5fZGV2aWNlcylpZihzKWZvcihjb25zdCByIG9mIHMpciYmdGhpcy5vbkRldmljZUNvbm5lY3RlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXIoaSxyKX0pLHRoaXMub25EZXZpY2VEaXNjb25uZWN0ZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX2VuZ2luZS5fZGV2aWNlU291cmNlTWFuYWdlci5yZWdpc3Rlck1hbmFnZXIodGhpcyksdGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXI9ZS5vbkRpc3Bvc2VPYnNlcnZhYmxlLmFkZCgoKT0+e3RoaXMuZGlzcG9zZSgpfSl9Z2V0RGV2aWNlU291cmNlKGUsdCl7aWYodD09PXZvaWQgMCl7aWYodGhpcy5fZmlyc3REZXZpY2VbZV09PT12b2lkIDApcmV0dXJuIG51bGw7dD10aGlzLl9maXJzdERldmljZVtlXX1yZXR1cm4hdGhpcy5fZGV2aWNlc1tlXXx8dGhpcy5fZGV2aWNlc1tlXVt0XT09PXZvaWQgMD9udWxsOnRoaXMuX2RldmljZXNbZV1bdF19Z2V0RGV2aWNlU291cmNlcyhlKXtyZXR1cm4gdGhpcy5fZGV2aWNlc1tlXT90aGlzLl9kZXZpY2VzW2VdLmZpbHRlcih0PT4hIXQpOltdfWRpc3Bvc2UoKXt0aGlzLm9uRGV2aWNlQ29ubmVjdGVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25EZXZpY2VEaXNjb25uZWN0ZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5fZW5naW5lLl9kZXZpY2VTb3VyY2VNYW5hZ2VyJiYodGhpcy5fZW5naW5lLl9kZXZpY2VTb3VyY2VNYW5hZ2VyLnVucmVnaXN0ZXJNYW5hZ2VyKHRoaXMpLC0tdGhpcy5fZW5naW5lLl9kZXZpY2VTb3VyY2VNYW5hZ2VyLl9yZWZDb3VudDwxJiYodGhpcy5fZW5naW5lLl9kZXZpY2VTb3VyY2VNYW5hZ2VyLmRpc3Bvc2UoKSxkZWxldGUgdGhpcy5fZW5naW5lLl9kZXZpY2VTb3VyY2VNYW5hZ2VyKSksdGhpcy5fZW5naW5lLm9uRGlzcG9zZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uRGlzcG9zZU9ic2VydmVyKX1fYWRkRGV2aWNlKGUpe3RoaXMuX2RldmljZXNbZS5kZXZpY2VUeXBlXXx8KHRoaXMuX2RldmljZXNbZS5kZXZpY2VUeXBlXT1uZXcgQXJyYXkpLHRoaXMuX2RldmljZXNbZS5kZXZpY2VUeXBlXVtlLmRldmljZVNsb3RdfHwodGhpcy5fZGV2aWNlc1tlLmRldmljZVR5cGVdW2UuZGV2aWNlU2xvdF09ZSx0aGlzLl91cGRhdGVGaXJzdERldmljZXMoZS5kZXZpY2VUeXBlKSksdGhpcy5vbkRldmljZUNvbm5lY3RlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpfV9yZW1vdmVEZXZpY2UoZSx0KXt2YXIgaSxzO2NvbnN0IHI9KGk9dGhpcy5fZGV2aWNlc1tlXSk9PT1udWxsfHxpPT09dm9pZCAwP3ZvaWQgMDppW3RdO3RoaXMub25EZXZpY2VEaXNjb25uZWN0ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhyKSwhKChzPXRoaXMuX2RldmljZXNbZV0pPT09bnVsbHx8cz09PXZvaWQgMCkmJnNbdF0mJmRlbGV0ZSB0aGlzLl9kZXZpY2VzW2VdW3RdLHRoaXMuX3VwZGF0ZUZpcnN0RGV2aWNlcyhlKX1fb25JbnB1dENoYW5nZWQoZSx0LGkpe3ZhciBzLHI7KHI9KHM9dGhpcy5fZGV2aWNlc1tlXSk9PT1udWxsfHxzPT09dm9pZCAwP3ZvaWQgMDpzW3RdKT09PW51bGx8fHI9PT12b2lkIDB8fHIub25JbnB1dENoYW5nZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhpKX1fdXBkYXRlRmlyc3REZXZpY2VzKGUpe3N3aXRjaChlKXtjYXNlIHouS2V5Ym9hcmQ6Y2FzZSB6Lk1vdXNlOnRoaXMuX2ZpcnN0RGV2aWNlW2VdPTA7YnJlYWs7Y2FzZSB6LlRvdWNoOmNhc2Ugei5EdWFsU2Vuc2U6Y2FzZSB6LkR1YWxTaG9jazpjYXNlIHouWGJveDpjYXNlIHouU3dpdGNoOmNhc2Ugei5HZW5lcmljOntkZWxldGUgdGhpcy5fZmlyc3REZXZpY2VbZV07Y29uc3QgdD10aGlzLl9kZXZpY2VzW2VdO2lmKHQpe2ZvcihsZXQgaT0wO2k8dC5sZW5ndGg7aSsrKWlmKHRbaV0pe3RoaXMuX2ZpcnN0RGV2aWNlW2VdPWk7YnJlYWt9fWJyZWFrfX19fWNsYXNzIHhye2NvbnN0cnVjdG9yKCl7dGhpcy5fc2luZ2xlQ2xpY2s9ITEsdGhpcy5fZG91YmxlQ2xpY2s9ITEsdGhpcy5faGFzU3dpcGVkPSExLHRoaXMuX2lnbm9yZT0hMX1nZXQgc2luZ2xlQ2xpY2soKXtyZXR1cm4gdGhpcy5fc2luZ2xlQ2xpY2t9Z2V0IGRvdWJsZUNsaWNrKCl7cmV0dXJuIHRoaXMuX2RvdWJsZUNsaWNrfWdldCBoYXNTd2lwZWQoKXtyZXR1cm4gdGhpcy5faGFzU3dpcGVkfWdldCBpZ25vcmUoKXtyZXR1cm4gdGhpcy5faWdub3JlfXNldCBzaW5nbGVDbGljayhlKXt0aGlzLl9zaW5nbGVDbGljaz1lfXNldCBkb3VibGVDbGljayhlKXt0aGlzLl9kb3VibGVDbGljaz1lfXNldCBoYXNTd2lwZWQoZSl7dGhpcy5faGFzU3dpcGVkPWV9c2V0IGlnbm9yZShlKXt0aGlzLl9pZ25vcmU9ZX19Y2xhc3MgRGV7Y29uc3RydWN0b3IoZSl7dGhpcy5fYWxyZWFkeUF0dGFjaGVkPSExLHRoaXMuX21lc2hQaWNrUHJvY2VlZD0hMSx0aGlzLl9jdXJyZW50UGlja1Jlc3VsdD1udWxsLHRoaXMuX3ByZXZpb3VzUGlja1Jlc3VsdD1udWxsLHRoaXMuX3RvdGFsUG9pbnRlcnNQcmVzc2VkPTAsdGhpcy5fZG91YmxlQ2xpY2tPY2N1cmVkPSExLHRoaXMuX2lzU3dpcGluZz0hMSx0aGlzLl9zd2lwZUJ1dHRvblByZXNzZWQ9LTEsdGhpcy5fc2tpcFBvaW50ZXJUYXA9ITEsdGhpcy5fcG9pbnRlclg9MCx0aGlzLl9wb2ludGVyWT0wLHRoaXMuX3N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uPW5ldyB2ZSgwLDApLHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyUG9zaXRpb249bmV3IHZlKDAsMCksdGhpcy5fc3RhcnRpbmdQb2ludGVyVGltZT0wLHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyVGltZT0wLHRoaXMuX3BvaW50ZXJDYXB0dXJlcz17fSx0aGlzLl9tZXNoVW5kZXJQb2ludGVySWQ9e30sdGhpcy5fbW92ZVBvaW50ZXJJbmZvPW51bGwsdGhpcy5fY2FtZXJhT2JzZXJ2ZXJDb3VudD0wLHRoaXMuX2RldmljZVNvdXJjZU1hbmFnZXI9bnVsbCx0aGlzLl9zY2VuZT1lfHxmZS5MYXN0Q3JlYXRlZFNjZW5lLHRoaXMuX3NjZW5lfWdldCBtZXNoVW5kZXJQb2ludGVyKCl7cmV0dXJuIHRoaXMuX21vdmVQb2ludGVySW5mbyYmKHRoaXMuX21vdmVQb2ludGVySW5mby5fZ2VuZXJhdGVQaWNrSW5mbygpLHRoaXMuX21vdmVQb2ludGVySW5mbz1udWxsKSx0aGlzLl9wb2ludGVyT3Zlck1lc2h9Z2V0TWVzaFVuZGVyUG9pbnRlckJ5UG9pbnRlcklkKGUpe3JldHVybiB0aGlzLl9tZXNoVW5kZXJQb2ludGVySWRbZV18fG51bGx9Z2V0IHVuVHJhbnNsYXRlZFBvaW50ZXIoKXtyZXR1cm4gbmV3IHZlKHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJYLHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJZKX1nZXQgcG9pbnRlclgoKXtyZXR1cm4gdGhpcy5fcG9pbnRlclh9c2V0IHBvaW50ZXJYKGUpe3RoaXMuX3BvaW50ZXJYPWV9Z2V0IHBvaW50ZXJZKCl7cmV0dXJuIHRoaXMuX3BvaW50ZXJZfXNldCBwb2ludGVyWShlKXt0aGlzLl9wb2ludGVyWT1lfV91cGRhdGVQb2ludGVyUG9zaXRpb24oZSl7Y29uc3QgdD10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5nZXRJbnB1dEVsZW1lbnRDbGllbnRSZWN0KCk7dCYmKHRoaXMuX3BvaW50ZXJYPWUuY2xpZW50WC10LmxlZnQsdGhpcy5fcG9pbnRlclk9ZS5jbGllbnRZLXQudG9wLHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJYPXRoaXMuX3BvaW50ZXJYLHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJZPXRoaXMuX3BvaW50ZXJZKX1fcHJvY2Vzc1BvaW50ZXJNb3ZlKGUsdCl7Y29uc3QgaT10aGlzLl9zY2VuZSxzPWkuZ2V0RW5naW5lKCkscj1zLmdldElucHV0RWxlbWVudCgpO3ImJihyLnRhYkluZGV4PXMuY2FudmFzVGFiSW5kZXgsaS5kb05vdEhhbmRsZUN1cnNvcnN8fChyLnN0eWxlLmN1cnNvcj1pLmRlZmF1bHRDdXJzb3IpKSx0aGlzLl9zZXRDdXJzb3JBbmRQb2ludGVyT3Zlck1lc2goZSx0LnBvaW50ZXJJZCxpKTtmb3IoY29uc3QgbyBvZiBpLl9wb2ludGVyTW92ZVN0YWdlKXtjb25zdCBoPSEhKGUhPW51bGwmJmUucGlja2VkTWVzaCk7ZT1vLmFjdGlvbih0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWCx0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWSxlLGgscil9Y29uc3Qgbj10LmlucHV0SW5kZXg+PVEuTW91c2VXaGVlbFgmJnQuaW5wdXRJbmRleDw9US5Nb3VzZVdoZWVsWj9UZS5QT0lOVEVSV0hFRUw6VGUuUE9JTlRFUk1PVkU7aS5vblBvaW50ZXJNb3ZlJiYoZT1lfHx0aGlzLl9waWNrTW92ZSh0LnBvaW50ZXJJZCksaS5vblBvaW50ZXJNb3ZlKHQsZSxuKSk7bGV0IGE7ZT8oYT1uZXcgdWkobix0LGUpLHRoaXMuX3NldFJheU9uUG9pbnRlckluZm8oZSx0KSk6KGE9bmV3IHVpKG4sdCxudWxsLHRoaXMpLHRoaXMuX21vdmVQb2ludGVySW5mbz1hKSxpLm9uUG9pbnRlck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkmJmkub25Qb2ludGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoYSxuKX1fc2V0UmF5T25Qb2ludGVySW5mbyhlLHQpe2NvbnN0IGk9dGhpcy5fc2NlbmU7ZSYmaS5fcGlja2luZ0F2YWlsYWJsZSYmKGUucmF5fHwoZS5yYXk9aS5jcmVhdGVQaWNraW5nUmF5KHQub2Zmc2V0WCx0Lm9mZnNldFkseC5JZGVudGl0eSgpLGkuYWN0aXZlQ2FtZXJhKSkpfV9hZGRDYW1lcmFQb2ludGVyT2JzZXJ2ZXIoZSx0KXtyZXR1cm4gdGhpcy5fY2FtZXJhT2JzZXJ2ZXJDb3VudCsrLHRoaXMuX3NjZW5lLm9uUG9pbnRlck9ic2VydmFibGUuYWRkKGUsdCl9X3JlbW92ZUNhbWVyYVBvaW50ZXJPYnNlcnZlcihlKXtyZXR1cm4gdGhpcy5fY2FtZXJhT2JzZXJ2ZXJDb3VudC0tLHRoaXMuX3NjZW5lLm9uUG9pbnRlck9ic2VydmFibGUucmVtb3ZlKGUpfV9jaGVja0ZvclBpY2tpbmcoKXtyZXR1cm4hISh0aGlzLl9zY2VuZS5vblBvaW50ZXJPYnNlcnZhYmxlLm9ic2VydmVycy5sZW5ndGg+dGhpcy5fY2FtZXJhT2JzZXJ2ZXJDb3VudHx8dGhpcy5fc2NlbmUub25Qb2ludGVyUGljayl9X2NoZWNrUHJlUG9pbnRlck9ic2VydmFibGUoZSx0LGkpe2NvbnN0IHM9dGhpcy5fc2NlbmUscj1uZXcgQ24oaSx0LHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJYLHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJZKTtyZXR1cm4gZSYmKHIub3JpZ2luYWxQaWNraW5nSW5mbz1lLHIucmF5PWUucmF5LGUub3JpZ2luTWVzaCYmKHIubmVhckludGVyYWN0aW9uUGlja2luZ0luZm89ZSkpLHMub25QcmVQb2ludGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMocixpKSwhIXIuc2tpcE9uUG9pbnRlck9ic2VydmFibGV9X3BpY2tNb3ZlKGUpe2NvbnN0IHQ9dGhpcy5fc2NlbmUsaT10LnBpY2sodGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclgsdGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclksdC5wb2ludGVyTW92ZVByZWRpY2F0ZSwhMSx0LmNhbWVyYVRvVXNlRm9yUG9pbnRlcnMsdC5wb2ludGVyTW92ZVRyaWFuZ2xlUHJlZGljYXRlKTtyZXR1cm4gdGhpcy5fc2V0Q3Vyc29yQW5kUG9pbnRlck92ZXJNZXNoKGksZSx0KSxpfV9zZXRDdXJzb3JBbmRQb2ludGVyT3Zlck1lc2goZSx0LGkpe2NvbnN0IHI9aS5nZXRFbmdpbmUoKS5nZXRJbnB1dEVsZW1lbnQoKTtpZihlIT1udWxsJiZlLnBpY2tlZE1lc2gpe2lmKHRoaXMuc2V0UG9pbnRlck92ZXJNZXNoKGUucGlja2VkTWVzaCx0LGUpLCFpLmRvTm90SGFuZGxlQ3Vyc29ycyYmciYmdGhpcy5fcG9pbnRlck92ZXJNZXNoKXtjb25zdCBuPXRoaXMuX3BvaW50ZXJPdmVyTWVzaC5fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoKTtuJiZuLmhhc1BvaW50ZXJUcmlnZ2VycyYmKHIuc3R5bGUuY3Vyc29yPW4uaG92ZXJDdXJzb3J8fGkuaG92ZXJDdXJzb3IpfX1lbHNlIHRoaXMuc2V0UG9pbnRlck92ZXJNZXNoKG51bGwsdCxlKX1zaW11bGF0ZVBvaW50ZXJNb3ZlKGUsdCl7Y29uc3QgaT1uZXcgUG9pbnRlckV2ZW50KCJwb2ludGVybW92ZSIsdCk7aS5pbnB1dEluZGV4PVEuTW92ZSwhdGhpcy5fY2hlY2tQcmVQb2ludGVyT2JzZXJ2YWJsZShlLGksVGUuUE9JTlRFUk1PVkUpJiZ0aGlzLl9wcm9jZXNzUG9pbnRlck1vdmUoZSxpKX1zaW11bGF0ZVBvaW50ZXJEb3duKGUsdCl7Y29uc3QgaT1uZXcgUG9pbnRlckV2ZW50KCJwb2ludGVyZG93biIsdCk7aS5pbnB1dEluZGV4PWkuYnV0dG9uKzIsIXRoaXMuX2NoZWNrUHJlUG9pbnRlck9ic2VydmFibGUoZSxpLFRlLlBPSU5URVJET1dOKSYmdGhpcy5fcHJvY2Vzc1BvaW50ZXJEb3duKGUsaSl9X3Byb2Nlc3NQb2ludGVyRG93bihlLHQpe2NvbnN0IGk9dGhpcy5fc2NlbmU7aWYoZSE9bnVsbCYmZS5waWNrZWRNZXNoKXt0aGlzLl9waWNrZWREb3duTWVzaD1lLnBpY2tlZE1lc2g7Y29uc3Qgbj1lLnBpY2tlZE1lc2guX2dldEFjdGlvbk1hbmFnZXJGb3JUcmlnZ2VyKCk7aWYobil7aWYobi5oYXNQaWNrVHJpZ2dlcnMpc3dpdGNoKG4ucHJvY2Vzc1RyaWdnZXIoNSxWZS5DcmVhdGVOZXcoZS5waWNrZWRNZXNoLHQpKSx0LmJ1dHRvbil7Y2FzZSAwOm4ucHJvY2Vzc1RyaWdnZXIoMixWZS5DcmVhdGVOZXcoZS5waWNrZWRNZXNoLHQpKTticmVhaztjYXNlIDE6bi5wcm9jZXNzVHJpZ2dlcig0LFZlLkNyZWF0ZU5ldyhlLnBpY2tlZE1lc2gsdCkpO2JyZWFrO2Nhc2UgMjpuLnByb2Nlc3NUcmlnZ2VyKDMsVmUuQ3JlYXRlTmV3KGUucGlja2VkTWVzaCx0KSk7YnJlYWt9bi5oYXNTcGVjaWZpY1RyaWdnZXIoOCkmJndpbmRvdy5zZXRUaW1lb3V0KCgpPT57Y29uc3QgYT1pLnBpY2sodGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclgsdGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclksbz0+by5pc1BpY2thYmxlJiZvLmlzVmlzaWJsZSYmby5pc1JlYWR5KCkmJm8uYWN0aW9uTWFuYWdlciYmby5hY3Rpb25NYW5hZ2VyLmhhc1NwZWNpZmljVHJpZ2dlcig4KSYmbz09PXRoaXMuX3BpY2tlZERvd25NZXNoLCExLGkuY2FtZXJhVG9Vc2VGb3JQb2ludGVycyk7YSE9bnVsbCYmYS5waWNrZWRNZXNoJiZuJiZ0aGlzLl90b3RhbFBvaW50ZXJzUHJlc3NlZCE9PTAmJkRhdGUubm93KCktdGhpcy5fc3RhcnRpbmdQb2ludGVyVGltZT5EZS5Mb25nUHJlc3NEZWxheSYmIXRoaXMuX2lzUG9pbnRlclN3aXBpbmcoKSYmKHRoaXMuX3N0YXJ0aW5nUG9pbnRlclRpbWU9MCxuLnByb2Nlc3NUcmlnZ2VyKDgsVmUuQ3JlYXRlTmV3KGEucGlja2VkTWVzaCx0KSkpfSxEZS5Mb25nUHJlc3NEZWxheSl9fWVsc2UgZm9yKGNvbnN0IG4gb2YgaS5fcG9pbnRlckRvd25TdGFnZSllPW4uYWN0aW9uKHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJYLHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJZLGUsdCwhMSk7bGV0IHM7Y29uc3Qgcj1UZS5QT0lOVEVSRE9XTjtlPyhpLm9uUG9pbnRlckRvd24mJmkub25Qb2ludGVyRG93bih0LGUscikscz1uZXcgdWkocix0LGUpLHRoaXMuX3NldFJheU9uUG9pbnRlckluZm8oZSx0KSk6cz1uZXcgdWkocix0LG51bGwsdGhpcyksaS5vblBvaW50ZXJPYnNlcnZhYmxlLmhhc09ic2VydmVycygpJiZpLm9uUG9pbnRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHMscil9X2lzUG9pbnRlclN3aXBpbmcoKXtyZXR1cm4gdGhpcy5faXNTd2lwaW5nfXNpbXVsYXRlUG9pbnRlclVwKGUsdCxpKXtjb25zdCBzPW5ldyBQb2ludGVyRXZlbnQoInBvaW50ZXJ1cCIsdCk7cy5pbnB1dEluZGV4PVEuTW92ZTtjb25zdCByPW5ldyB4cjtpP3IuZG91YmxlQ2xpY2s9ITA6ci5zaW5nbGVDbGljaz0hMCwhdGhpcy5fY2hlY2tQcmVQb2ludGVyT2JzZXJ2YWJsZShlLHMsVGUuUE9JTlRFUlVQKSYmdGhpcy5fcHJvY2Vzc1BvaW50ZXJVcChlLHMscil9X3Byb2Nlc3NQb2ludGVyVXAoZSx0LGkpe2NvbnN0IHM9dGhpcy5fc2NlbmU7aWYoZSE9bnVsbCYmZS5waWNrZWRNZXNoKXtpZih0aGlzLl9waWNrZWRVcE1lc2g9ZS5waWNrZWRNZXNoLHRoaXMuX3BpY2tlZERvd25NZXNoPT09dGhpcy5fcGlja2VkVXBNZXNoJiYocy5vblBvaW50ZXJQaWNrJiZzLm9uUG9pbnRlclBpY2sodCxlKSxpLnNpbmdsZUNsaWNrJiYhaS5pZ25vcmUmJnMub25Qb2ludGVyT2JzZXJ2YWJsZS5vYnNlcnZlcnMubGVuZ3RoPnRoaXMuX2NhbWVyYU9ic2VydmVyQ291bnQpKXtjb25zdCBuPVRlLlBPSU5URVJQSUNLLGE9bmV3IHVpKG4sdCxlKTt0aGlzLl9zZXRSYXlPblBvaW50ZXJJbmZvKGUsdCkscy5vblBvaW50ZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhhLG4pfWNvbnN0IHI9ZS5waWNrZWRNZXNoLl9nZXRBY3Rpb25NYW5hZ2VyRm9yVHJpZ2dlcigpO2lmKHImJiFpLmlnbm9yZSl7ci5wcm9jZXNzVHJpZ2dlcig3LFZlLkNyZWF0ZU5ldyhlLnBpY2tlZE1lc2gsdCxlKSksIWkuaGFzU3dpcGVkJiZpLnNpbmdsZUNsaWNrJiZyLnByb2Nlc3NUcmlnZ2VyKDEsVmUuQ3JlYXRlTmV3KGUucGlja2VkTWVzaCx0LGUpKTtjb25zdCBuPWUucGlja2VkTWVzaC5fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoNik7aS5kb3VibGVDbGljayYmbiYmbi5wcm9jZXNzVHJpZ2dlcig2LFZlLkNyZWF0ZU5ldyhlLnBpY2tlZE1lc2gsdCxlKSl9fWVsc2UgaWYoIWkuaWdub3JlKWZvcihjb25zdCByIG9mIHMuX3BvaW50ZXJVcFN0YWdlKWU9ci5hY3Rpb24odGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclgsdGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclksZSx0LGkuZG91YmxlQ2xpY2spO2lmKHRoaXMuX3BpY2tlZERvd25NZXNoJiZ0aGlzLl9waWNrZWREb3duTWVzaCE9PXRoaXMuX3BpY2tlZFVwTWVzaCl7Y29uc3Qgcj10aGlzLl9waWNrZWREb3duTWVzaC5fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoMTYpO3ImJnIucHJvY2Vzc1RyaWdnZXIoMTYsVmUuQ3JlYXRlTmV3KHRoaXMuX3BpY2tlZERvd25NZXNoLHQpKX1pZighaS5pZ25vcmUpe2NvbnN0IHI9bmV3IHVpKFRlLlBPSU5URVJVUCx0LGUpO2lmKHRoaXMuX3NldFJheU9uUG9pbnRlckluZm8oZSx0KSxzLm9uUG9pbnRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHIsVGUuUE9JTlRFUlVQKSxzLm9uUG9pbnRlclVwJiZzLm9uUG9pbnRlclVwKHQsZSxUZS5QT0lOVEVSVVApLCFpLmhhc1N3aXBlZCYmIXRoaXMuX3NraXBQb2ludGVyVGFwKXtsZXQgbj0wO2lmKGkuc2luZ2xlQ2xpY2s/bj1UZS5QT0lOVEVSVEFQOmkuZG91YmxlQ2xpY2smJihuPVRlLlBPSU5URVJET1VCTEVUQVApLG4pe2NvbnN0IGE9bmV3IHVpKG4sdCxlKTtzLm9uUG9pbnRlck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkmJnMub25Qb2ludGVyT2JzZXJ2YWJsZS5oYXNTcGVjaWZpY01hc2sobikmJnMub25Qb2ludGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoYSxuKX19fX1pc1BvaW50ZXJDYXB0dXJlZChlPTApe3JldHVybiB0aGlzLl9wb2ludGVyQ2FwdHVyZXNbZV19YXR0YWNoQ29udHJvbChlPSEwLHQ9ITAsaT0hMCxzPW51bGwpe2NvbnN0IHI9dGhpcy5fc2NlbmUsbj1yLmdldEVuZ2luZSgpO3N8fChzPW4uZ2V0SW5wdXRFbGVtZW50KCkpLHRoaXMuX2FscmVhZHlBdHRhY2hlZCYmdGhpcy5kZXRhY2hDb250cm9sKCkscyYmKHRoaXMuX2FscmVhZHlBdHRhY2hlZFRvPXMpLHRoaXMuX2RldmljZVNvdXJjZU1hbmFnZXI9bmV3IEZuKG4pLHRoaXMuX2luaXRBY3Rpb25NYW5hZ2VyPWE9PntpZighdGhpcy5fbWVzaFBpY2tQcm9jZWVkKXtjb25zdCBvPXIuc2tpcFBvaW50ZXJVcFBpY2tpbmd8fHIuX3JlZ2lzdGVyZWRBY3Rpb25zPT09MCYmIXRoaXMuX2NoZWNrRm9yUGlja2luZygpJiYhci5vblBvaW50ZXJVcD9udWxsOnIucGljayh0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWCx0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWSxyLnBvaW50ZXJVcFByZWRpY2F0ZSwhMSxyLmNhbWVyYVRvVXNlRm9yUG9pbnRlcnMpO3RoaXMuX2N1cnJlbnRQaWNrUmVzdWx0PW8sbyYmKGE9by5oaXQmJm8ucGlja2VkTWVzaD9vLnBpY2tlZE1lc2guX2dldEFjdGlvbk1hbmFnZXJGb3JUcmlnZ2VyKCk6bnVsbCksdGhpcy5fbWVzaFBpY2tQcm9jZWVkPSEwfXJldHVybiBhfSx0aGlzLl9kZWxheWVkU2ltcGxlQ2xpY2s9KGEsbyxoKT0+eyhEYXRlLm5vdygpLXRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyVGltZT5EZS5Eb3VibGVDbGlja0RlbGF5JiYhdGhpcy5fZG91YmxlQ2xpY2tPY2N1cmVkfHxhIT09dGhpcy5fcHJldmlvdXNCdXR0b25QcmVzc2VkKSYmKHRoaXMuX2RvdWJsZUNsaWNrT2NjdXJlZD0hMSxvLnNpbmdsZUNsaWNrPSEwLG8uaWdub3JlPSExLGgobyx0aGlzLl9jdXJyZW50UGlja1Jlc3VsdCkpfSx0aGlzLl9pbml0Q2xpY2tFdmVudD0oYSxvLGgsbCk9Pntjb25zdCB1PW5ldyB4cjt0aGlzLl9jdXJyZW50UGlja1Jlc3VsdD1udWxsO2xldCBkPW51bGwsZj1hLmhhc1NwZWNpZmljTWFzayhUZS5QT0lOVEVSUElDSyl8fG8uaGFzU3BlY2lmaWNNYXNrKFRlLlBPSU5URVJQSUNLKXx8YS5oYXNTcGVjaWZpY01hc2soVGUuUE9JTlRFUlRBUCl8fG8uaGFzU3BlY2lmaWNNYXNrKFRlLlBPSU5URVJUQVApfHxhLmhhc1NwZWNpZmljTWFzayhUZS5QT0lOVEVSRE9VQkxFVEFQKXx8by5oYXNTcGVjaWZpY01hc2soVGUuUE9JTlRFUkRPVUJMRVRBUCk7IWYmJnV0JiYoZD10aGlzLl9pbml0QWN0aW9uTWFuYWdlcihkLHUpLGQmJihmPWQuaGFzUGlja1RyaWdnZXJzKSk7bGV0IF89ITE7aWYoZil7Y29uc3QgRT1oLmJ1dHRvbjtpZih1Lmhhc1N3aXBlZD10aGlzLl9pc1BvaW50ZXJTd2lwaW5nKCksIXUuaGFzU3dpcGVkKXtsZXQgbT0hRGUuRXhjbHVzaXZlRG91YmxlQ2xpY2tNb2RlO218fChtPSFhLmhhc1NwZWNpZmljTWFzayhUZS5QT0lOVEVSRE9VQkxFVEFQKSYmIW8uaGFzU3BlY2lmaWNNYXNrKFRlLlBPSU5URVJET1VCTEVUQVApLG0mJiF1dC5IYXNTcGVjaWZpY1RyaWdnZXIoNikmJihkPXRoaXMuX2luaXRBY3Rpb25NYW5hZ2VyKGQsdSksZCYmKG09IWQuaGFzU3BlY2lmaWNUcmlnZ2VyKDYpKSkpLG0/KERhdGUubm93KCktdGhpcy5fcHJldmlvdXNTdGFydGluZ1BvaW50ZXJUaW1lPkRlLkRvdWJsZUNsaWNrRGVsYXl8fEUhPT10aGlzLl9wcmV2aW91c0J1dHRvblByZXNzZWQpJiYodS5zaW5nbGVDbGljaz0hMCxsKHUsdGhpcy5fY3VycmVudFBpY2tSZXN1bHQpLF89ITApOih0aGlzLl9wcmV2aW91c0RlbGF5ZWRTaW1wbGVDbGlja1RpbWVvdXQ9dGhpcy5fZGVsYXllZFNpbXBsZUNsaWNrVGltZW91dCx0aGlzLl9kZWxheWVkU2ltcGxlQ2xpY2tUaW1lb3V0PXdpbmRvdy5zZXRUaW1lb3V0KHRoaXMuX2RlbGF5ZWRTaW1wbGVDbGljay5iaW5kKHRoaXMsRSx1LGwpLERlLkRvdWJsZUNsaWNrRGVsYXkpKTtsZXQgdj1hLmhhc1NwZWNpZmljTWFzayhUZS5QT0lOVEVSRE9VQkxFVEFQKXx8by5oYXNTcGVjaWZpY01hc2soVGUuUE9JTlRFUkRPVUJMRVRBUCk7IXYmJnV0Lkhhc1NwZWNpZmljVHJpZ2dlcig2KSYmKGQ9dGhpcy5faW5pdEFjdGlvbk1hbmFnZXIoZCx1KSxkJiYodj1kLmhhc1NwZWNpZmljVHJpZ2dlcig2KSkpLHYmJihFPT09dGhpcy5fcHJldmlvdXNCdXR0b25QcmVzc2VkJiZEYXRlLm5vdygpLXRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyVGltZTxEZS5Eb3VibGVDbGlja0RlbGF5JiYhdGhpcy5fZG91YmxlQ2xpY2tPY2N1cmVkPyghdS5oYXNTd2lwZWQmJiF0aGlzLl9pc1BvaW50ZXJTd2lwaW5nKCk/KHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyVGltZT0wLHRoaXMuX2RvdWJsZUNsaWNrT2NjdXJlZD0hMCx1LmRvdWJsZUNsaWNrPSEwLHUuaWdub3JlPSExLERlLkV4Y2x1c2l2ZURvdWJsZUNsaWNrTW9kZSYmdGhpcy5fcHJldmlvdXNEZWxheWVkU2ltcGxlQ2xpY2tUaW1lb3V0JiZjbGVhclRpbWVvdXQodGhpcy5fcHJldmlvdXNEZWxheWVkU2ltcGxlQ2xpY2tUaW1lb3V0KSx0aGlzLl9wcmV2aW91c0RlbGF5ZWRTaW1wbGVDbGlja1RpbWVvdXQ9dGhpcy5fZGVsYXllZFNpbXBsZUNsaWNrVGltZW91dCxsKHUsdGhpcy5fY3VycmVudFBpY2tSZXN1bHQpKToodGhpcy5fZG91YmxlQ2xpY2tPY2N1cmVkPSExLHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyVGltZT10aGlzLl9zdGFydGluZ1BvaW50ZXJUaW1lLHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyUG9zaXRpb24ueD10aGlzLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi54LHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyUG9zaXRpb24ueT10aGlzLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi55LHRoaXMuX3ByZXZpb3VzQnV0dG9uUHJlc3NlZD1FLERlLkV4Y2x1c2l2ZURvdWJsZUNsaWNrTW9kZT8odGhpcy5fcHJldmlvdXNEZWxheWVkU2ltcGxlQ2xpY2tUaW1lb3V0JiZjbGVhclRpbWVvdXQodGhpcy5fcHJldmlvdXNEZWxheWVkU2ltcGxlQ2xpY2tUaW1lb3V0KSx0aGlzLl9wcmV2aW91c0RlbGF5ZWRTaW1wbGVDbGlja1RpbWVvdXQ9dGhpcy5fZGVsYXllZFNpbXBsZUNsaWNrVGltZW91dCxsKHUsdGhpcy5fcHJldmlvdXNQaWNrUmVzdWx0KSk6bCh1LHRoaXMuX2N1cnJlbnRQaWNrUmVzdWx0KSksXz0hMCk6KHRoaXMuX2RvdWJsZUNsaWNrT2NjdXJlZD0hMSx0aGlzLl9wcmV2aW91c1N0YXJ0aW5nUG9pbnRlclRpbWU9dGhpcy5fc3RhcnRpbmdQb2ludGVyVGltZSx0aGlzLl9wcmV2aW91c1N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uLng9dGhpcy5fc3RhcnRpbmdQb2ludGVyUG9zaXRpb24ueCx0aGlzLl9wcmV2aW91c1N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uLnk9dGhpcy5fc3RhcnRpbmdQb2ludGVyUG9zaXRpb24ueSx0aGlzLl9wcmV2aW91c0J1dHRvblByZXNzZWQ9RSkpfX1ffHxsKHUsdGhpcy5fY3VycmVudFBpY2tSZXN1bHQpfSx0aGlzLl9vblBvaW50ZXJNb3ZlPWE9PntpZihhLnBvaW50ZXJJZD09PXZvaWQgMCYmKGEucG9pbnRlcklkPTApLHRoaXMuX3VwZGF0ZVBvaW50ZXJQb3NpdGlvbihhKSwhdGhpcy5faXNTd2lwaW5nJiZ0aGlzLl9zd2lwZUJ1dHRvblByZXNzZWQhPT0tMSYmKHRoaXMuX2lzU3dpcGluZz1NYXRoLmFicyh0aGlzLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi54LXRoaXMuX3BvaW50ZXJYKT5EZS5EcmFnTW92ZW1lbnRUaHJlc2hvbGR8fE1hdGguYWJzKHRoaXMuX3N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uLnktdGhpcy5fcG9pbnRlclkpPkRlLkRyYWdNb3ZlbWVudFRocmVzaG9sZCksdGhpcy5fY2hlY2tQcmVQb2ludGVyT2JzZXJ2YWJsZShudWxsLGEsYS5pbnB1dEluZGV4Pj1RLk1vdXNlV2hlZWxYJiZhLmlucHV0SW5kZXg8PVEuTW91c2VXaGVlbFo/VGUuUE9JTlRFUldIRUVMOlRlLlBPSU5URVJNT1ZFKXx8IXIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycyYmIXIuYWN0aXZlQ2FtZXJhKXJldHVybjtpZihyLnNraXBQb2ludGVyTW92ZVBpY2tpbmcpe3RoaXMuX3Byb2Nlc3NQb2ludGVyTW92ZShuZXcgVXQsYSk7cmV0dXJufXIucG9pbnRlck1vdmVQcmVkaWNhdGV8fChyLnBvaW50ZXJNb3ZlUHJlZGljYXRlPWg9PmguaXNQaWNrYWJsZSYmaC5pc1Zpc2libGUmJmguaXNSZWFkeSgpJiZoLmlzRW5hYmxlZCgpJiYoaC5lbmFibGVQb2ludGVyTW92ZUV2ZW50c3x8ci5jb25zdGFudGx5VXBkYXRlTWVzaFVuZGVyUG9pbnRlcnx8aC5fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoKSE9PW51bGwpJiYoIXIuY2FtZXJhVG9Vc2VGb3JQb2ludGVyc3x8KHIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycy5sYXllck1hc2smaC5sYXllck1hc2spIT09MCkpO2NvbnN0IG89ci5fcmVnaXN0ZXJlZEFjdGlvbnM+MD90aGlzLl9waWNrTW92ZShhLnBvaW50ZXJJZCk6bnVsbDt0aGlzLl9wcm9jZXNzUG9pbnRlck1vdmUobyxhKX0sdGhpcy5fb25Qb2ludGVyRG93bj1hPT57aWYodGhpcy5fdG90YWxQb2ludGVyc1ByZXNzZWQrKyx0aGlzLl9waWNrZWREb3duTWVzaD1udWxsLHRoaXMuX21lc2hQaWNrUHJvY2VlZD0hMSxhLnBvaW50ZXJJZD09PXZvaWQgMCYmKGEucG9pbnRlcklkPTApLHRoaXMuX3VwZGF0ZVBvaW50ZXJQb3NpdGlvbihhKSx0aGlzLl9zd2lwZUJ1dHRvblByZXNzZWQ9PT0tMSYmKHRoaXMuX3N3aXBlQnV0dG9uUHJlc3NlZD1hLmJ1dHRvbiksci5wcmV2ZW50RGVmYXVsdE9uUG9pbnRlckRvd24mJnMmJihhLnByZXZlbnREZWZhdWx0KCkscy5mb2N1cygpKSx0aGlzLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi54PXRoaXMuX3BvaW50ZXJYLHRoaXMuX3N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uLnk9dGhpcy5fcG9pbnRlclksdGhpcy5fc3RhcnRpbmdQb2ludGVyVGltZT1EYXRlLm5vdygpLHRoaXMuX2NoZWNrUHJlUG9pbnRlck9ic2VydmFibGUobnVsbCxhLFRlLlBPSU5URVJET1dOKXx8IXIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycyYmIXIuYWN0aXZlQ2FtZXJhKXJldHVybjt0aGlzLl9wb2ludGVyQ2FwdHVyZXNbYS5wb2ludGVySWRdPSEwLHIucG9pbnRlckRvd25QcmVkaWNhdGV8fChyLnBvaW50ZXJEb3duUHJlZGljYXRlPWg9PmguaXNQaWNrYWJsZSYmaC5pc1Zpc2libGUmJmguaXNSZWFkeSgpJiZoLmlzRW5hYmxlZCgpJiYoIXIuY2FtZXJhVG9Vc2VGb3JQb2ludGVyc3x8KHIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycy5sYXllck1hc2smaC5sYXllck1hc2spIT09MCkpLHRoaXMuX3BpY2tlZERvd25NZXNoPW51bGw7bGV0IG87ci5za2lwUG9pbnRlckRvd25QaWNraW5nfHxyLl9yZWdpc3RlcmVkQWN0aW9ucz09PTAmJiF0aGlzLl9jaGVja0ZvclBpY2tpbmcoKSYmIXIub25Qb2ludGVyRG93bj9vPW5ldyBVdDpvPXIucGljayh0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWCx0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWSxyLnBvaW50ZXJEb3duUHJlZGljYXRlLCExLHIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycyksdGhpcy5fcHJvY2Vzc1BvaW50ZXJEb3duKG8sYSl9LHRoaXMuX29uUG9pbnRlclVwPWE9Pnt0aGlzLl90b3RhbFBvaW50ZXJzUHJlc3NlZCE9PTAmJih0aGlzLl90b3RhbFBvaW50ZXJzUHJlc3NlZC0tLHRoaXMuX3BpY2tlZFVwTWVzaD1udWxsLHRoaXMuX21lc2hQaWNrUHJvY2VlZD0hMSxhLnBvaW50ZXJJZD09PXZvaWQgMCYmKGEucG9pbnRlcklkPTApLHRoaXMuX3VwZGF0ZVBvaW50ZXJQb3NpdGlvbihhKSxyLnByZXZlbnREZWZhdWx0T25Qb2ludGVyVXAmJnMmJihhLnByZXZlbnREZWZhdWx0KCkscy5mb2N1cygpKSx0aGlzLl9pbml0Q2xpY2tFdmVudChyLm9uUHJlUG9pbnRlck9ic2VydmFibGUsci5vblBvaW50ZXJPYnNlcnZhYmxlLGEsKG8saCk9PntpZihyLm9uUHJlUG9pbnRlck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkmJih0aGlzLl9za2lwUG9pbnRlclRhcD0hMSwhby5pZ25vcmUpKXtpZih0aGlzLl9jaGVja1ByZVBvaW50ZXJPYnNlcnZhYmxlKG51bGwsYSxUZS5QT0lOVEVSVVApKXt0aGlzLl9zd2lwZUJ1dHRvblByZXNzZWQ9PT1hLmJ1dHRvbiYmKHRoaXMuX2lzU3dpcGluZz0hMSx0aGlzLl9zd2lwZUJ1dHRvblByZXNzZWQ9LTEpO3JldHVybn1vLmhhc1N3aXBlZHx8KG8uc2luZ2xlQ2xpY2smJnIub25QcmVQb2ludGVyT2JzZXJ2YWJsZS5oYXNTcGVjaWZpY01hc2soVGUuUE9JTlRFUlRBUCkmJnRoaXMuX2NoZWNrUHJlUG9pbnRlck9ic2VydmFibGUobnVsbCxhLFRlLlBPSU5URVJUQVApJiYodGhpcy5fc2tpcFBvaW50ZXJUYXA9ITApLG8uZG91YmxlQ2xpY2smJnIub25QcmVQb2ludGVyT2JzZXJ2YWJsZS5oYXNTcGVjaWZpY01hc2soVGUuUE9JTlRFUkRPVUJMRVRBUCkmJnRoaXMuX2NoZWNrUHJlUG9pbnRlck9ic2VydmFibGUobnVsbCxhLFRlLlBPSU5URVJET1VCTEVUQVApJiYodGhpcy5fc2tpcFBvaW50ZXJUYXA9ITApKX10aGlzLl9wb2ludGVyQ2FwdHVyZXNbYS5wb2ludGVySWRdPSExLCEoIXIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycyYmIXIuYWN0aXZlQ2FtZXJhKSYmKHIucG9pbnRlclVwUHJlZGljYXRlfHwoci5wb2ludGVyVXBQcmVkaWNhdGU9bD0+bC5pc1BpY2thYmxlJiZsLmlzVmlzaWJsZSYmbC5pc1JlYWR5KCkmJmwuaXNFbmFibGVkKCkmJighci5jYW1lcmFUb1VzZUZvclBvaW50ZXJzfHwoci5jYW1lcmFUb1VzZUZvclBvaW50ZXJzLmxheWVyTWFzayZsLmxheWVyTWFzaykhPT0wKSksIXRoaXMuX21lc2hQaWNrUHJvY2VlZCYmKHV0JiZ1dC5IYXNUcmlnZ2Vyc3x8dGhpcy5fY2hlY2tGb3JQaWNraW5nKCl8fHIub25Qb2ludGVyVXApJiZ0aGlzLl9pbml0QWN0aW9uTWFuYWdlcihudWxsLG8pLGh8fChoPXRoaXMuX2N1cnJlbnRQaWNrUmVzdWx0KSx0aGlzLl9wcm9jZXNzUG9pbnRlclVwKGgsYSxvKSx0aGlzLl9wcmV2aW91c1BpY2tSZXN1bHQ9dGhpcy5fY3VycmVudFBpY2tSZXN1bHQsdGhpcy5fc3dpcGVCdXR0b25QcmVzc2VkPT09YS5idXR0b24mJih0aGlzLl9pc1N3aXBpbmc9ITEsdGhpcy5fc3dpcGVCdXR0b25QcmVzc2VkPS0xKSl9KSl9LHRoaXMuX29uS2V5RG93bj1hPT57Y29uc3Qgbz1KaS5LRVlET1dOO2lmKHIub25QcmVLZXlib2FyZE9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkpe2NvbnN0IGg9bmV3IF9yKG8sYSk7aWYoci5vblByZUtleWJvYXJkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoaCxvKSxoLnNraXBPbktleWJvYXJkT2JzZXJ2YWJsZSlyZXR1cm59aWYoci5vbktleWJvYXJkT2JzZXJ2YWJsZS5oYXNPYnNlcnZlcnMoKSl7Y29uc3QgaD1uZXcgQ3MobyxhKTtyLm9uS2V5Ym9hcmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhoLG8pfXIuYWN0aW9uTWFuYWdlciYmci5hY3Rpb25NYW5hZ2VyLnByb2Nlc3NUcmlnZ2VyKDE0LFZlLkNyZWF0ZU5ld0Zyb21TY2VuZShyLGEpKX0sdGhpcy5fb25LZXlVcD1hPT57Y29uc3Qgbz1KaS5LRVlVUDtpZihyLm9uUHJlS2V5Ym9hcmRPYnNlcnZhYmxlLmhhc09ic2VydmVycygpKXtjb25zdCBoPW5ldyBfcihvLGEpO2lmKHIub25QcmVLZXlib2FyZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGgsbyksaC5za2lwT25LZXlib2FyZE9ic2VydmFibGUpcmV0dXJufWlmKHIub25LZXlib2FyZE9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkpe2NvbnN0IGg9bmV3IENzKG8sYSk7ci5vbktleWJvYXJkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoaCxvKX1yLmFjdGlvbk1hbmFnZXImJnIuYWN0aW9uTWFuYWdlci5wcm9jZXNzVHJpZ2dlcigxNSxWZS5DcmVhdGVOZXdGcm9tU2NlbmUocixhKSl9LHRoaXMuX2RldmljZVNvdXJjZU1hbmFnZXIub25EZXZpY2VDb25uZWN0ZWRPYnNlcnZhYmxlLmFkZChhPT57YS5kZXZpY2VUeXBlPT09ei5Nb3VzZT9hLm9uSW5wdXRDaGFuZ2VkT2JzZXJ2YWJsZS5hZGQobz0+e28uaW5wdXRJbmRleD09PVEuTGVmdENsaWNrfHxvLmlucHV0SW5kZXg9PT1RLk1pZGRsZUNsaWNrfHxvLmlucHV0SW5kZXg9PT1RLlJpZ2h0Q2xpY2t8fG8uaW5wdXRJbmRleD09PVEuQnJvd3NlckJhY2t8fG8uaW5wdXRJbmRleD09PVEuQnJvd3NlckZvcndhcmQ/dCYmYS5nZXRJbnB1dChvLmlucHV0SW5kZXgpPT09MT90aGlzLl9vblBvaW50ZXJEb3duKG8pOmUmJmEuZ2V0SW5wdXQoby5pbnB1dEluZGV4KT09PTAmJnRoaXMuX29uUG9pbnRlclVwKG8pOmkmJihvLmlucHV0SW5kZXg9PT1RLk1vdmU/dGhpcy5fb25Qb2ludGVyTW92ZShvKTooby5pbnB1dEluZGV4PT09US5Nb3VzZVdoZWVsWHx8by5pbnB1dEluZGV4PT09US5Nb3VzZVdoZWVsWXx8by5pbnB1dEluZGV4PT09US5Nb3VzZVdoZWVsWikmJnRoaXMuX29uUG9pbnRlck1vdmUobykpfSk6YS5kZXZpY2VUeXBlPT09ei5Ub3VjaD9hLm9uSW5wdXRDaGFuZ2VkT2JzZXJ2YWJsZS5hZGQobz0+e28uaW5wdXRJbmRleD09PVEuTGVmdENsaWNrJiYodCYmYS5nZXRJbnB1dChvLmlucHV0SW5kZXgpPT09MT90aGlzLl9vblBvaW50ZXJEb3duKG8pOmUmJmEuZ2V0SW5wdXQoby5pbnB1dEluZGV4KT09PTAmJnRoaXMuX29uUG9pbnRlclVwKG8pKSxpJiZvLmlucHV0SW5kZXg9PT1RLk1vdmUmJnRoaXMuX29uUG9pbnRlck1vdmUobyl9KTphLmRldmljZVR5cGU9PT16LktleWJvYXJkJiZhLm9uSW5wdXRDaGFuZ2VkT2JzZXJ2YWJsZS5hZGQobz0+e28udHlwZT09PSJrZXlkb3duIj90aGlzLl9vbktleURvd24obyk6by50eXBlPT09ImtleXVwIiYmdGhpcy5fb25LZXlVcChvKX0pfSksdGhpcy5fYWxyZWFkeUF0dGFjaGVkPSEwfWRldGFjaENvbnRyb2woKXt0aGlzLl9hbHJlYWR5QXR0YWNoZWQmJih0aGlzLl9kZXZpY2VTb3VyY2VNYW5hZ2VyLmRpc3Bvc2UoKSx0aGlzLl9kZXZpY2VTb3VyY2VNYW5hZ2VyPW51bGwsdGhpcy5fYWxyZWFkeUF0dGFjaGVkVG8mJiF0aGlzLl9zY2VuZS5kb05vdEhhbmRsZUN1cnNvcnMmJih0aGlzLl9hbHJlYWR5QXR0YWNoZWRUby5zdHlsZS5jdXJzb3I9dGhpcy5fc2NlbmUuZGVmYXVsdEN1cnNvciksdGhpcy5fYWxyZWFkeUF0dGFjaGVkPSExLHRoaXMuX2FscmVhZHlBdHRhY2hlZFRvPW51bGwpfXNldFBvaW50ZXJPdmVyTWVzaChlLHQ9MCxpKXtpZih0aGlzLl9tZXNoVW5kZXJQb2ludGVySWRbdF09PT1lJiYoIWV8fCFlLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9wb2ludGVyT3ZlckRpc2FibGVNZXNoVGVzdGluZykpcmV0dXJuO2NvbnN0IHM9dGhpcy5fbWVzaFVuZGVyUG9pbnRlcklkW3RdO2xldCByO3MmJihyPXMuX2dldEFjdGlvbk1hbmFnZXJGb3JUcmlnZ2VyKDEwKSxyJiZyLnByb2Nlc3NUcmlnZ2VyKDEwLFZlLkNyZWF0ZU5ldyhzLHZvaWQgMCx7cG9pbnRlcklkOnR9KSkpLGU/KHRoaXMuX21lc2hVbmRlclBvaW50ZXJJZFt0XT1lLHRoaXMuX3BvaW50ZXJPdmVyTWVzaD1lLHI9ZS5fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoOSksciYmci5wcm9jZXNzVHJpZ2dlcig5LFZlLkNyZWF0ZU5ldyhlLHZvaWQgMCx7cG9pbnRlcklkOnQscGlja1Jlc3VsdDppfSkpKTooZGVsZXRlIHRoaXMuX21lc2hVbmRlclBvaW50ZXJJZFt0XSx0aGlzLl9wb2ludGVyT3Zlck1lc2g9bnVsbCl9Z2V0UG9pbnRlck92ZXJNZXNoKCl7cmV0dXJuIHRoaXMubWVzaFVuZGVyUG9pbnRlcn1faW52YWxpZGF0ZU1lc2goZSl7dGhpcy5fcG9pbnRlck92ZXJNZXNoPT09ZSYmKHRoaXMuX3BvaW50ZXJPdmVyTWVzaD1udWxsKSx0aGlzLl9waWNrZWREb3duTWVzaD09PWUmJih0aGlzLl9waWNrZWREb3duTWVzaD1udWxsKSx0aGlzLl9waWNrZWRVcE1lc2g9PT1lJiYodGhpcy5fcGlja2VkVXBNZXNoPW51bGwpO2Zvcihjb25zdCB0IGluIHRoaXMuX21lc2hVbmRlclBvaW50ZXJJZCl0aGlzLl9tZXNoVW5kZXJQb2ludGVySWRbdF09PT1lJiZkZWxldGUgdGhpcy5fbWVzaFVuZGVyUG9pbnRlcklkW3RdfX1EZS5EcmFnTW92ZW1lbnRUaHJlc2hvbGQ9MTAsRGUuTG9uZ1ByZXNzRGVsYXk9NTAwLERlLkRvdWJsZUNsaWNrRGVsYXk9MzAwLERlLkV4Y2x1c2l2ZURvdWJsZUNsaWNrTW9kZT0hMTtjbGFzcyB4dHtjb25zdHJ1Y3RvcihlLHQsaSxzKXt0aGlzLm5vcm1hbD1uZXcgcChlLHQsaSksdGhpcy5kPXN9YXNBcnJheSgpe3JldHVyblt0aGlzLm5vcm1hbC54LHRoaXMubm9ybWFsLnksdGhpcy5ub3JtYWwueix0aGlzLmRdfWNsb25lKCl7cmV0dXJuIG5ldyB4dCh0aGlzLm5vcm1hbC54LHRoaXMubm9ybWFsLnksdGhpcy5ub3JtYWwueix0aGlzLmQpfWdldENsYXNzTmFtZSgpe3JldHVybiJQbGFuZSJ9Z2V0SGFzaENvZGUoKXtsZXQgZT10aGlzLm5vcm1hbC5nZXRIYXNoQ29kZSgpO3JldHVybiBlPWUqMzk3Xih0aGlzLmR8MCksZX1ub3JtYWxpemUoKXtjb25zdCBlPU1hdGguc3FydCh0aGlzLm5vcm1hbC54KnRoaXMubm9ybWFsLngrdGhpcy5ub3JtYWwueSp0aGlzLm5vcm1hbC55K3RoaXMubm9ybWFsLnoqdGhpcy5ub3JtYWwueik7bGV0IHQ9MDtyZXR1cm4gZSE9PTAmJih0PTEvZSksdGhpcy5ub3JtYWwueCo9dCx0aGlzLm5vcm1hbC55Kj10LHRoaXMubm9ybWFsLnoqPXQsdGhpcy5kKj10LHRoaXN9dHJhbnNmb3JtKGUpe2NvbnN0IHQ9eHQuX1RtcE1hdHJpeDtlLmludmVydFRvUmVmKHQpO2NvbnN0IGk9dC5tLHM9dGhpcy5ub3JtYWwueCxyPXRoaXMubm9ybWFsLnksbj10aGlzLm5vcm1hbC56LGE9dGhpcy5kLG89cyppWzBdK3IqaVsxXStuKmlbMl0rYSppWzNdLGg9cyppWzRdK3IqaVs1XStuKmlbNl0rYSppWzddLGw9cyppWzhdK3IqaVs5XStuKmlbMTBdK2EqaVsxMV0sdT1zKmlbMTJdK3IqaVsxM10rbippWzE0XSthKmlbMTVdO3JldHVybiBuZXcgeHQobyxoLGwsdSl9ZG90Q29vcmRpbmF0ZShlKXtyZXR1cm4gdGhpcy5ub3JtYWwueCplLngrdGhpcy5ub3JtYWwueSplLnkrdGhpcy5ub3JtYWwueiplLnordGhpcy5kfWNvcHlGcm9tUG9pbnRzKGUsdCxpKXtjb25zdCBzPXQueC1lLngscj10LnktZS55LG49dC56LWUueixhPWkueC1lLngsbz1pLnktZS55LGg9aS56LWUueixsPXIqaC1uKm8sdT1uKmEtcypoLGQ9cypvLXIqYSxmPU1hdGguc3FydChsKmwrdSp1K2QqZCk7bGV0IF87cmV0dXJuIGYhPT0wP189MS9mOl89MCx0aGlzLm5vcm1hbC54PWwqXyx0aGlzLm5vcm1hbC55PXUqXyx0aGlzLm5vcm1hbC56PWQqXyx0aGlzLmQ9LSh0aGlzLm5vcm1hbC54KmUueCt0aGlzLm5vcm1hbC55KmUueSt0aGlzLm5vcm1hbC56KmUueiksdGhpc31pc0Zyb250RmFjaW5nVG8oZSx0KXtyZXR1cm4gcC5Eb3QodGhpcy5ub3JtYWwsZSk8PXR9c2lnbmVkRGlzdGFuY2VUbyhlKXtyZXR1cm4gcC5Eb3QoZSx0aGlzLm5vcm1hbCkrdGhpcy5kfXN0YXRpYyBGcm9tQXJyYXkoZSl7cmV0dXJuIG5ldyB4dChlWzBdLGVbMV0sZVsyXSxlWzNdKX1zdGF0aWMgRnJvbVBvaW50cyhlLHQsaSl7Y29uc3Qgcz1uZXcgeHQoMCwwLDAsMCk7cmV0dXJuIHMuY29weUZyb21Qb2ludHMoZSx0LGkpLHN9c3RhdGljIEZyb21Qb3NpdGlvbkFuZE5vcm1hbChlLHQpe2NvbnN0IGk9bmV3IHh0KDAsMCwwLDApO3JldHVybiB0Lm5vcm1hbGl6ZSgpLGkubm9ybWFsPXQsaS5kPS0odC54KmUueCt0LnkqZS55K3QueiplLnopLGl9c3RhdGljIFNpZ25lZERpc3RhbmNlVG9QbGFuZUZyb21Qb3NpdGlvbkFuZE5vcm1hbChlLHQsaSl7Y29uc3Qgcz0tKHQueCplLngrdC55KmUueSt0LnoqZS56KTtyZXR1cm4gcC5Eb3QoaSx0KStzfX14dC5fVG1wTWF0cml4PXguSWRlbnRpdHkoKTtjbGFzcyBFdHtzdGF0aWMgR2V0UGxhbmVzKGUpe2NvbnN0IHQ9W107Zm9yKGxldCBpPTA7aTw2O2krKyl0LnB1c2gobmV3IHh0KDAsMCwwLDApKTtyZXR1cm4gRXQuR2V0UGxhbmVzVG9SZWYoZSx0KSx0fXN0YXRpYyBHZXROZWFyUGxhbmVUb1JlZihlLHQpe2NvbnN0IGk9ZS5tO3Qubm9ybWFsLng9aVszXStpWzJdLHQubm9ybWFsLnk9aVs3XStpWzZdLHQubm9ybWFsLno9aVsxMV0raVsxMF0sdC5kPWlbMTVdK2lbMTRdLHQubm9ybWFsaXplKCl9c3RhdGljIEdldEZhclBsYW5lVG9SZWYoZSx0KXtjb25zdCBpPWUubTt0Lm5vcm1hbC54PWlbM10taVsyXSx0Lm5vcm1hbC55PWlbN10taVs2XSx0Lm5vcm1hbC56PWlbMTFdLWlbMTBdLHQuZD1pWzE1XS1pWzE0XSx0Lm5vcm1hbGl6ZSgpfXN0YXRpYyBHZXRMZWZ0UGxhbmVUb1JlZihlLHQpe2NvbnN0IGk9ZS5tO3Qubm9ybWFsLng9aVszXStpWzBdLHQubm9ybWFsLnk9aVs3XStpWzRdLHQubm9ybWFsLno9aVsxMV0raVs4XSx0LmQ9aVsxNV0raVsxMl0sdC5ub3JtYWxpemUoKX1zdGF0aWMgR2V0UmlnaHRQbGFuZVRvUmVmKGUsdCl7Y29uc3QgaT1lLm07dC5ub3JtYWwueD1pWzNdLWlbMF0sdC5ub3JtYWwueT1pWzddLWlbNF0sdC5ub3JtYWwuej1pWzExXS1pWzhdLHQuZD1pWzE1XS1pWzEyXSx0Lm5vcm1hbGl6ZSgpfXN0YXRpYyBHZXRUb3BQbGFuZVRvUmVmKGUsdCl7Y29uc3QgaT1lLm07dC5ub3JtYWwueD1pWzNdLWlbMV0sdC5ub3JtYWwueT1pWzddLWlbNV0sdC5ub3JtYWwuej1pWzExXS1pWzldLHQuZD1pWzE1XS1pWzEzXSx0Lm5vcm1hbGl6ZSgpfXN0YXRpYyBHZXRCb3R0b21QbGFuZVRvUmVmKGUsdCl7Y29uc3QgaT1lLm07dC5ub3JtYWwueD1pWzNdK2lbMV0sdC5ub3JtYWwueT1pWzddK2lbNV0sdC5ub3JtYWwuej1pWzExXStpWzldLHQuZD1pWzE1XStpWzEzXSx0Lm5vcm1hbGl6ZSgpfXN0YXRpYyBHZXRQbGFuZXNUb1JlZihlLHQpe0V0LkdldE5lYXJQbGFuZVRvUmVmKGUsdFswXSksRXQuR2V0RmFyUGxhbmVUb1JlZihlLHRbMV0pLEV0LkdldExlZnRQbGFuZVRvUmVmKGUsdFsyXSksRXQuR2V0UmlnaHRQbGFuZVRvUmVmKGUsdFszXSksRXQuR2V0VG9wUGxhbmVUb1JlZihlLHRbNF0pLEV0LkdldEJvdHRvbVBsYW5lVG9SZWYoZSx0WzVdKX19Y2xhc3MgTXJ7c3RhdGljIGdldCBVbmlxdWVJZCgpe2NvbnN0IGU9dGhpcy5fVW5pcXVlSWRDb3VudGVyO3JldHVybiB0aGlzLl9VbmlxdWVJZENvdW50ZXIrKyxlfX1Nci5fVW5pcXVlSWRDb3VudGVyPTE7Y2xhc3MgRWV7c3RhdGljIENvbXBhcmVMaWdodHNQcmlvcml0eShlLHQpe3JldHVybiBlLnNoYWRvd0VuYWJsZWQhPT10LnNoYWRvd0VuYWJsZWQ/KHQuc2hhZG93RW5hYmxlZD8xOjApLShlLnNoYWRvd0VuYWJsZWQ/MTowKTp0LnJlbmRlclByaW9yaXR5LWUucmVuZGVyUHJpb3JpdHl9fUVlLkZBTExPRkZfREVGQVVMVD0wLEVlLkZBTExPRkZfUEhZU0lDQUw9MSxFZS5GQUxMT0ZGX0dMVEY9MixFZS5GQUxMT0ZGX1NUQU5EQVJEPTMsRWUuTElHSFRNQVBfREVGQVVMVD0wLEVlLkxJR0hUTUFQX1NQRUNVTEFSPTEsRWUuTElHSFRNQVBfU0hBRE9XU09OTFk9MixFZS5JTlRFTlNJVFlNT0RFX0FVVE9NQVRJQz0wLEVlLklOVEVOU0lUWU1PREVfTFVNSU5PVVNQT1dFUj0xLEVlLklOVEVOU0lUWU1PREVfTFVNSU5PVVNJTlRFTlNJVFk9MixFZS5JTlRFTlNJVFlNT0RFX0lMTFVNSU5BTkNFPTMsRWUuSU5URU5TSVRZTU9ERV9MVU1JTkFOQ0U9NCxFZS5MSUdIVFRZUEVJRF9QT0lOVExJR0hUPTAsRWUuTElHSFRUWVBFSURfRElSRUNUSU9OQUxMSUdIVD0xLEVlLkxJR0hUVFlQRUlEX1NQT1RMSUdIVD0yLEVlLkxJR0hUVFlQRUlEX0hFTUlTUEhFUklDTElHSFQ9Mzt2YXIgQ3Q7KGZ1bmN0aW9uKGMpe2NbYy5CYWNrd2FyZENvbXBhdGlibGU9MF09IkJhY2t3YXJkQ29tcGF0aWJsZSIsY1tjLkludGVybWVkaWF0ZT0xXT0iSW50ZXJtZWRpYXRlIixjW2MuQWdncmVzc2l2ZT0yXT0iQWdncmVzc2l2ZSJ9KShDdHx8KEN0PXt9KSk7Y2xhc3MgbmUgZXh0ZW5kcyBaaXtjb25zdHJ1Y3RvcihlLHQpe3N1cGVyKCksdGhpcy5faW5wdXRNYW5hZ2VyPW5ldyBEZSh0aGlzKSx0aGlzLmNhbWVyYVRvVXNlRm9yUG9pbnRlcnM9bnVsbCx0aGlzLl9pc1NjZW5lPSEwLHRoaXMuX2Jsb2NrRW50aXR5Q29sbGVjdGlvbj0hMSx0aGlzLmF1dG9DbGVhcj0hMCx0aGlzLmF1dG9DbGVhckRlcHRoQW5kU3RlbmNpbD0hMCx0aGlzLmNsZWFyQ29sb3I9bmV3IG1lKC4yLC4yLC4zLDEpLHRoaXMuYW1iaWVudENvbG9yPW5ldyByZSgwLDAsMCksdGhpcy5lbnZpcm9ubWVudEludGVuc2l0eT0xLHRoaXMuX3BlcmZvcm1hbmNlUHJpb3JpdHk9Q3QuQmFja3dhcmRDb21wYXRpYmxlLHRoaXMuX2ZvcmNlV2lyZWZyYW1lPSExLHRoaXMuX3NraXBGcnVzdHVtQ2xpcHBpbmc9ITEsdGhpcy5fZm9yY2VQb2ludHNDbG91ZD0hMSx0aGlzLmFuaW1hdGlvbnNFbmFibGVkPSEwLHRoaXMuX2FuaW1hdGlvblByb3BlcnRpZXNPdmVycmlkZT1udWxsLHRoaXMudXNlQ29uc3RhbnRBbmltYXRpb25EZWx0YVRpbWU9ITEsdGhpcy5jb25zdGFudGx5VXBkYXRlTWVzaFVuZGVyUG9pbnRlcj0hMSx0aGlzLmhvdmVyQ3Vyc29yPSJwb2ludGVyIix0aGlzLmRlZmF1bHRDdXJzb3I9IiIsdGhpcy5kb05vdEhhbmRsZUN1cnNvcnM9ITEsdGhpcy5wcmV2ZW50RGVmYXVsdE9uUG9pbnRlckRvd249ITAsdGhpcy5wcmV2ZW50RGVmYXVsdE9uUG9pbnRlclVwPSEwLHRoaXMubWV0YWRhdGE9bnVsbCx0aGlzLnJlc2VydmVkRGF0YVN0b3JlPW51bGwsdGhpcy5kaXNhYmxlT2ZmbGluZVN1cHBvcnRFeGNlcHRpb25SdWxlcz1uZXcgQXJyYXksdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX29uRGlzcG9zZU9ic2VydmVyPW51bGwsdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5fb25CZWZvcmVSZW5kZXJPYnNlcnZlcj1udWxsLHRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyUmVuZGVyQ2FtZXJhT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXI9bnVsbCx0aGlzLm9uQmVmb3JlQW5pbWF0aW9uc09ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyQW5pbWF0aW9uc09ic2VydmFibGU9bmV3IEYsdGhpcy5vbkJlZm9yZURyYXdQaGFzZU9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyRHJhd1BoYXNlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uUmVhZHlPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25CZWZvcmVDYW1lcmFSZW5kZXJPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX29uQmVmb3JlQ2FtZXJhUmVuZGVyT2JzZXJ2ZXI9bnVsbCx0aGlzLm9uQWZ0ZXJDYW1lcmFSZW5kZXJPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX29uQWZ0ZXJDYW1lcmFSZW5kZXJPYnNlcnZlcj1udWxsLHRoaXMub25CZWZvcmVBY3RpdmVNZXNoZXNFdmFsdWF0aW9uT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQWZ0ZXJBY3RpdmVNZXNoZXNFdmFsdWF0aW9uT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQmVmb3JlUGFydGljbGVzUmVuZGVyaW5nT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQWZ0ZXJQYXJ0aWNsZXNSZW5kZXJpbmdPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25EYXRhTG9hZGVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTmV3Q2FtZXJhQWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25DYW1lcmFSZW1vdmVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTmV3TGlnaHRBZGRlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkxpZ2h0UmVtb3ZlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbk5ld0dlb21ldHJ5QWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25HZW9tZXRyeVJlbW92ZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25OZXdUcmFuc2Zvcm1Ob2RlQWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25UcmFuc2Zvcm1Ob2RlUmVtb3ZlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbk5ld01lc2hBZGRlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbk1lc2hSZW1vdmVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTmV3U2tlbGV0b25BZGRlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vblNrZWxldG9uUmVtb3ZlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbk5ld01hdGVyaWFsQWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25OZXdNdWx0aU1hdGVyaWFsQWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25NYXRlcmlhbFJlbW92ZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25NdWx0aU1hdGVyaWFsUmVtb3ZlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbk5ld1RleHR1cmVBZGRlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vblRleHR1cmVSZW1vdmVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQmVmb3JlUmVuZGVyVGFyZ2V0c1JlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyUmVuZGVyVGFyZ2V0c1JlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkJlZm9yZVN0ZXBPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BZnRlclN0ZXBPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BY3RpdmVDYW1lcmFDaGFuZ2VkPW5ldyBGLHRoaXMub25BY3RpdmVDYW1lcmFzQ2hhbmdlZD1uZXcgRix0aGlzLm9uQmVmb3JlUmVuZGVyaW5nR3JvdXBPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BZnRlclJlbmRlcmluZ0dyb3VwT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTWVzaEltcG9ydGVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQW5pbWF0aW9uRmlsZUltcG9ydGVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9yZWdpc3RlcmVkRm9yTGF0ZUFuaW1hdGlvbkJpbmRpbmdzPW5ldyBoaSgyNTYpLHRoaXMuc2tpcFBvaW50ZXJNb3ZlUGlja2luZz0hMSx0aGlzLnNraXBQb2ludGVyRG93blBpY2tpbmc9ITEsdGhpcy5za2lwUG9pbnRlclVwUGlja2luZz0hMSx0aGlzLm9uUHJlUG9pbnRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vblBvaW50ZXJPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25QcmVLZXlib2FyZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbktleWJvYXJkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl91c2VSaWdodEhhbmRlZFN5c3RlbT0hMSx0aGlzLl90aW1lQWNjdW11bGF0b3I9MCx0aGlzLl9jdXJyZW50U3RlcElkPTAsdGhpcy5fY3VycmVudEludGVybmFsU3RlcD0wLHRoaXMuX2ZvZ0VuYWJsZWQ9ITAsdGhpcy5fZm9nTW9kZT1uZS5GT0dNT0RFX05PTkUsdGhpcy5mb2dDb2xvcj1uZXcgcmUoLjIsLjIsLjMpLHRoaXMuZm9nRGVuc2l0eT0uMSx0aGlzLmZvZ1N0YXJ0PTAsdGhpcy5mb2dFbmQ9MWUzLHRoaXMubmVlZHNQcmV2aW91c1dvcmxkTWF0cmljZXM9ITEsdGhpcy5fc2hhZG93c0VuYWJsZWQ9ITAsdGhpcy5fbGlnaHRzRW5hYmxlZD0hMCx0aGlzLl91bk9ic2VydmVBY3RpdmVDYW1lcmFzPW51bGwsdGhpcy5fdGV4dHVyZXNFbmFibGVkPSEwLHRoaXMucGh5c2ljc0VuYWJsZWQ9ITAsdGhpcy5wYXJ0aWNsZXNFbmFibGVkPSEwLHRoaXMuc3ByaXRlc0VuYWJsZWQ9ITAsdGhpcy5fc2tlbGV0b25zRW5hYmxlZD0hMCx0aGlzLmxlbnNGbGFyZXNFbmFibGVkPSEwLHRoaXMuY29sbGlzaW9uc0VuYWJsZWQ9ITAsdGhpcy5ncmF2aXR5PW5ldyBwKDAsLTkuODA3LDApLHRoaXMucG9zdFByb2Nlc3Nlc0VuYWJsZWQ9ITAsdGhpcy5yZW5kZXJUYXJnZXRzRW5hYmxlZD0hMCx0aGlzLmR1bXBOZXh0UmVuZGVyVGFyZ2V0cz0hMSx0aGlzLmN1c3RvbVJlbmRlclRhcmdldHM9bmV3IEFycmF5LHRoaXMuaW1wb3J0ZWRNZXNoZXNGaWxlcz1uZXcgQXJyYXksdGhpcy5wcm9iZXNFbmFibGVkPSEwLHRoaXMuX21lc2hlc0ZvckludGVyc2VjdGlvbnM9bmV3IGhpKDI1NiksdGhpcy5wcm9jZWR1cmFsVGV4dHVyZXNFbmFibGVkPSEwLHRoaXMuX3RvdGFsVmVydGljZXM9bmV3IFJ0LHRoaXMuX2FjdGl2ZUluZGljZXM9bmV3IFJ0LHRoaXMuX2FjdGl2ZVBhcnRpY2xlcz1uZXcgUnQsdGhpcy5fYWN0aXZlQm9uZXM9bmV3IFJ0LHRoaXMuX2FuaW1hdGlvblRpbWU9MCx0aGlzLmFuaW1hdGlvblRpbWVTY2FsZT0xLHRoaXMuX3JlbmRlcklkPTAsdGhpcy5fZnJhbWVJZD0wLHRoaXMuX2V4ZWN1dGVXaGVuUmVhZHlUaW1lb3V0SWQ9bnVsbCx0aGlzLl9pbnRlcm1lZGlhdGVSZW5kZXJpbmc9ITEsdGhpcy5fZGVmYXVsdEZyYW1lQnVmZmVyQ2xlYXJlZD0hMSx0aGlzLl92aWV3VXBkYXRlRmxhZz0tMSx0aGlzLl9wcm9qZWN0aW9uVXBkYXRlRmxhZz0tMSx0aGlzLl90b0JlRGlzcG9zZWQ9bmV3IEFycmF5KDI1NiksdGhpcy5fYWN0aXZlUmVxdWVzdHM9bmV3IEFycmF5LHRoaXMuX3BlbmRpbmdEYXRhPW5ldyBBcnJheSx0aGlzLl9pc0Rpc3Bvc2VkPSExLHRoaXMuZGlzcGF0Y2hBbGxTdWJNZXNoZXNPZkFjdGl2ZU1lc2hlcz0hMSx0aGlzLl9hY3RpdmVNZXNoZXM9bmV3ICRlKDI1NiksdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzPW5ldyAkZSgyNTYpLHRoaXMuX3JlbmRlclRhcmdldHM9bmV3IGhpKDI1NiksdGhpcy5fbWF0ZXJpYWxzUmVuZGVyVGFyZ2V0cz1uZXcgaGkoMjU2KSx0aGlzLl9hY3RpdmVQYXJ0aWNsZVN5c3RlbXM9bmV3ICRlKDI1NiksdGhpcy5fYWN0aXZlU2tlbGV0b25zPW5ldyBoaSgzMiksdGhpcy5fc29mdHdhcmVTa2lubmVkTWVzaGVzPW5ldyBoaSgzMiksdGhpcy5fYWN0aXZlQW5pbWF0YWJsZXM9bmV3IEFycmF5LHRoaXMuX3RyYW5zZm9ybU1hdHJpeD14Llplcm8oKSx0aGlzLnJlcXVpcmVMaWdodFNvcnRpbmc9ITEsdGhpcy5fY29tcG9uZW50cz1bXSx0aGlzLl9zZXJpYWxpemFibGVDb21wb25lbnRzPVtdLHRoaXMuX3RyYW5zaWVudENvbXBvbmVudHM9W10sdGhpcy5fYmVmb3JlQ2FtZXJhVXBkYXRlU3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fYmVmb3JlQ2xlYXJTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9iZWZvcmVSZW5kZXJUYXJnZXRDbGVhclN0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2dhdGhlclJlbmRlclRhcmdldHNTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9nYXRoZXJBY3RpdmVDYW1lcmFSZW5kZXJUYXJnZXRzU3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5faXNSZWFkeUZvck1lc2hTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9iZWZvcmVFdmFsdWF0ZUFjdGl2ZU1lc2hTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9ldmFsdWF0ZVN1Yk1lc2hTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9wcmVBY3RpdmVNZXNoU3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fY2FtZXJhRHJhd1JlbmRlclRhcmdldFN0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2JlZm9yZUNhbWVyYURyYXdTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9iZWZvcmVSZW5kZXJUYXJnZXREcmF3U3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fYmVmb3JlUmVuZGVyaW5nR3JvdXBEcmF3U3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fYmVmb3JlUmVuZGVyaW5nTWVzaFN0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2FmdGVyUmVuZGVyaW5nTWVzaFN0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2FmdGVyUmVuZGVyaW5nR3JvdXBEcmF3U3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fYWZ0ZXJDYW1lcmFEcmF3U3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fYWZ0ZXJDYW1lcmFQb3N0UHJvY2Vzc1N0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2FmdGVyUmVuZGVyVGFyZ2V0RHJhd1N0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2FmdGVyUmVuZGVyVGFyZ2V0UG9zdFByb2Nlc3NTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9hZnRlclJlbmRlclN0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX3BvaW50ZXJNb3ZlU3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fcG9pbnRlckRvd25TdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9wb2ludGVyVXBTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9nZW9tZXRyaWVzQnlVbmlxdWVJZD1udWxsLHRoaXMuX2RlZmF1bHRNZXNoQ2FuZGlkYXRlcz17ZGF0YTpbXSxsZW5ndGg6MH0sdGhpcy5fZGVmYXVsdFN1Yk1lc2hDYW5kaWRhdGVzPXtkYXRhOltdLGxlbmd0aDowfSx0aGlzLl9wcmV2ZW50RnJlZUFjdGl2ZU1lc2hlc0FuZFJlbmRlcmluZ0dyb3Vwcz0hMSx0aGlzLl9hY3RpdmVNZXNoZXNGcm96ZW49ITEsdGhpcy5fYWN0aXZlTWVzaGVzRnJvemVuQnV0S2VlcENsaXBwaW5nPSExLHRoaXMuX3NraXBFdmFsdWF0ZUFjdGl2ZU1lc2hlc0NvbXBsZXRlbHk9ITEsdGhpcy5fYWxsb3dQb3N0UHJvY2Vzc0NsZWFyQ29sb3I9ITAsdGhpcy5nZXREZXRlcm1pbmlzdGljRnJhbWVUaW1lPSgpPT50aGlzLl9lbmdpbmUuZ2V0VGltZVN0ZXAoKSx0aGlzLl9yZWdpc3RlcmVkQWN0aW9ucz0wLHRoaXMuX2Jsb2NrTWF0ZXJpYWxEaXJ0eU1lY2hhbmlzbT0hMSx0aGlzLl9wZXJmQ29sbGVjdG9yPW51bGwsdGhpcy5hY3RpdmVDYW1lcmFzPW5ldyBBcnJheTtjb25zdCBpPXt1c2VHZW9tZXRyeVVuaXF1ZUlkc01hcDohMCx1c2VNYXRlcmlhbE1lc2hNYXA6ITAsdXNlQ2xvbmVkTWVzaE1hcDohMCx2aXJ0dWFsOiExLC4uLnR9O3RoaXMuX2VuZ2luZT1lfHxmZS5MYXN0Q3JlYXRlZEVuZ2luZSxpLnZpcnR1YWw/dGhpcy5fZW5naW5lLl92aXJ0dWFsU2NlbmVzLnB1c2godGhpcyk6KGZlLl9MYXN0Q3JlYXRlZFNjZW5lPXRoaXMsdGhpcy5fZW5naW5lLnNjZW5lcy5wdXNoKHRoaXMpKSx0aGlzLl91aWQ9bnVsbCx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyPW5ldyBXZSh0aGlzKSxRaSYmKHRoaXMucG9zdFByb2Nlc3NNYW5hZ2VyPW5ldyBRaSh0aGlzKSksamUoKSYmdGhpcy5hdHRhY2hDb250cm9sKCksdGhpcy5fY3JlYXRlVWJvKCkscGUmJih0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uPW5ldyBwZSksdGhpcy5zZXREZWZhdWx0Q2FuZGlkYXRlUHJvdmlkZXJzKCksaS51c2VHZW9tZXRyeVVuaXF1ZUlkc01hcCYmKHRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkPXt9KSx0aGlzLnVzZU1hdGVyaWFsTWVzaE1hcD1pLnVzZU1hdGVyaWFsTWVzaE1hcCx0aGlzLnVzZUNsb25lZE1lc2hNYXA9aS51c2VDbG9uZWRNZXNoTWFwLCghdHx8IXQudmlydHVhbCkmJnRoaXMuX2VuZ2luZS5vbk5ld1NjZW5lQWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1zdGF0aWMgRGVmYXVsdE1hdGVyaWFsRmFjdG9yeShlKXt0aHJvdyAkKCJTdGFuZGFyZE1hdGVyaWFsIil9c3RhdGljIENvbGxpc2lvbkNvb3JkaW5hdG9yRmFjdG9yeSgpe3Rocm93ICQoIkRlZmF1bHRDb2xsaXNpb25Db29yZGluYXRvciIpfWdldCBlbnZpcm9ubWVudFRleHR1cmUoKXtyZXR1cm4gdGhpcy5fZW52aXJvbm1lbnRUZXh0dXJlfXNldCBlbnZpcm9ubWVudFRleHR1cmUoZSl7dGhpcy5fZW52aXJvbm1lbnRUZXh0dXJlIT09ZSYmKHRoaXMuX2Vudmlyb25tZW50VGV4dHVyZT1lLHRoaXMubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfWdldCBpbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uKCl7cmV0dXJuIHRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb259Z2V0IHBlcmZvcm1hbmNlUHJpb3JpdHkoKXtyZXR1cm4gdGhpcy5fcGVyZm9ybWFuY2VQcmlvcml0eX1zZXQgcGVyZm9ybWFuY2VQcmlvcml0eShlKXtpZihlIT09dGhpcy5fcGVyZm9ybWFuY2VQcmlvcml0eSlzd2l0Y2godGhpcy5fcGVyZm9ybWFuY2VQcmlvcml0eT1lLGUpe2Nhc2UgQ3QuQmFja3dhcmRDb21wYXRpYmxlOnRoaXMuc2tpcEZydXN0dW1DbGlwcGluZz0hMSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLm1haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzPSExLHRoaXMuc2tpcFBvaW50ZXJNb3ZlUGlja2luZz0hMSx0aGlzLmF1dG9DbGVhcj0hMDticmVhaztjYXNlIEN0LkludGVybWVkaWF0ZTp0aGlzLnNraXBGcnVzdHVtQ2xpcHBpbmc9ITEsdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5tYWludGFpblN0YXRlQmV0d2VlbkZyYW1lcz0hMSx0aGlzLnNraXBQb2ludGVyTW92ZVBpY2tpbmc9ITAsdGhpcy5hdXRvQ2xlYXI9ITE7YnJlYWs7Y2FzZSBDdC5BZ2dyZXNzaXZlOnRoaXMuc2tpcEZydXN0dW1DbGlwcGluZz0hMCx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLm1haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzPSEwLHRoaXMuc2tpcFBvaW50ZXJNb3ZlUGlja2luZz0hMCx0aGlzLmF1dG9DbGVhcj0hMTticmVha319c2V0IGZvcmNlV2lyZWZyYW1lKGUpe3RoaXMuX2ZvcmNlV2lyZWZyYW1lIT09ZSYmKHRoaXMuX2ZvcmNlV2lyZWZyYW1lPWUsdGhpcy5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxNikpfWdldCBmb3JjZVdpcmVmcmFtZSgpe3JldHVybiB0aGlzLl9mb3JjZVdpcmVmcmFtZX1zZXQgc2tpcEZydXN0dW1DbGlwcGluZyhlKXt0aGlzLl9za2lwRnJ1c3R1bUNsaXBwaW5nIT09ZSYmKHRoaXMuX3NraXBGcnVzdHVtQ2xpcHBpbmc9ZSl9Z2V0IHNraXBGcnVzdHVtQ2xpcHBpbmcoKXtyZXR1cm4gdGhpcy5fc2tpcEZydXN0dW1DbGlwcGluZ31zZXQgZm9yY2VQb2ludHNDbG91ZChlKXt0aGlzLl9mb3JjZVBvaW50c0Nsb3VkIT09ZSYmKHRoaXMuX2ZvcmNlUG9pbnRzQ2xvdWQ9ZSx0aGlzLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDE2KSl9Z2V0IGZvcmNlUG9pbnRzQ2xvdWQoKXtyZXR1cm4gdGhpcy5fZm9yY2VQb2ludHNDbG91ZH1nZXQgYW5pbWF0aW9uUHJvcGVydGllc092ZXJyaWRlKCl7cmV0dXJuIHRoaXMuX2FuaW1hdGlvblByb3BlcnRpZXNPdmVycmlkZX1zZXQgYW5pbWF0aW9uUHJvcGVydGllc092ZXJyaWRlKGUpe3RoaXMuX2FuaW1hdGlvblByb3BlcnRpZXNPdmVycmlkZT1lfXNldCBvbkRpc3Bvc2UoZSl7dGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXImJnRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXIpLHRoaXMuX29uRGlzcG9zZU9ic2VydmVyPXRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5hZGQoZSl9c2V0IGJlZm9yZVJlbmRlcihlKXt0aGlzLl9vbkJlZm9yZVJlbmRlck9ic2VydmVyJiZ0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25CZWZvcmVSZW5kZXJPYnNlcnZlciksZSYmKHRoaXMuX29uQmVmb3JlUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGUpKX1zZXQgYWZ0ZXJSZW5kZXIoZSl7dGhpcy5fb25BZnRlclJlbmRlck9ic2VydmVyJiZ0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXIpLGUmJih0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5hZGQoZSkpfXNldCBiZWZvcmVDYW1lcmFSZW5kZXIoZSl7dGhpcy5fb25CZWZvcmVDYW1lcmFSZW5kZXJPYnNlcnZlciYmdGhpcy5vbkJlZm9yZUNhbWVyYVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQmVmb3JlQ2FtZXJhUmVuZGVyT2JzZXJ2ZXIpLHRoaXMuX29uQmVmb3JlQ2FtZXJhUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkJlZm9yZUNhbWVyYVJlbmRlck9ic2VydmFibGUuYWRkKGUpfXNldCBhZnRlckNhbWVyYVJlbmRlcihlKXt0aGlzLl9vbkFmdGVyQ2FtZXJhUmVuZGVyT2JzZXJ2ZXImJnRoaXMub25BZnRlckNhbWVyYVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQWZ0ZXJDYW1lcmFSZW5kZXJPYnNlcnZlciksdGhpcy5fb25BZnRlckNhbWVyYVJlbmRlck9ic2VydmVyPXRoaXMub25BZnRlckNhbWVyYVJlbmRlck9ic2VydmFibGUuYWRkKGUpfWdldCB1blRyYW5zbGF0ZWRQb2ludGVyKCl7cmV0dXJuIHRoaXMuX2lucHV0TWFuYWdlci51blRyYW5zbGF0ZWRQb2ludGVyfXN0YXRpYyBnZXQgRHJhZ01vdmVtZW50VGhyZXNob2xkKCl7cmV0dXJuIERlLkRyYWdNb3ZlbWVudFRocmVzaG9sZH1zdGF0aWMgc2V0IERyYWdNb3ZlbWVudFRocmVzaG9sZChlKXtEZS5EcmFnTW92ZW1lbnRUaHJlc2hvbGQ9ZX1zdGF0aWMgZ2V0IExvbmdQcmVzc0RlbGF5KCl7cmV0dXJuIERlLkxvbmdQcmVzc0RlbGF5fXN0YXRpYyBzZXQgTG9uZ1ByZXNzRGVsYXkoZSl7RGUuTG9uZ1ByZXNzRGVsYXk9ZX1zdGF0aWMgZ2V0IERvdWJsZUNsaWNrRGVsYXkoKXtyZXR1cm4gRGUuRG91YmxlQ2xpY2tEZWxheX1zdGF0aWMgc2V0IERvdWJsZUNsaWNrRGVsYXkoZSl7RGUuRG91YmxlQ2xpY2tEZWxheT1lfXN0YXRpYyBnZXQgRXhjbHVzaXZlRG91YmxlQ2xpY2tNb2RlKCl7cmV0dXJuIERlLkV4Y2x1c2l2ZURvdWJsZUNsaWNrTW9kZX1zdGF0aWMgc2V0IEV4Y2x1c2l2ZURvdWJsZUNsaWNrTW9kZShlKXtEZS5FeGNsdXNpdmVEb3VibGVDbGlja01vZGU9ZX1iaW5kRXllUG9zaXRpb24oZSx0PSJ2RXllUG9zaXRpb24iLGk9ITEpe3ZhciBzO2NvbnN0IHI9dGhpcy5fZm9yY2VkVmlld1Bvc2l0aW9uP3RoaXMuX2ZvcmNlZFZpZXdQb3NpdGlvbjp0aGlzLl9taXJyb3JlZENhbWVyYVBvc2l0aW9uP3RoaXMuX21pcnJvcmVkQ2FtZXJhUG9zaXRpb246KHM9dGhpcy5hY3RpdmVDYW1lcmEuZ2xvYmFsUG9zaXRpb24pIT09bnVsbCYmcyE9PXZvaWQgMD9zOnRoaXMuYWN0aXZlQ2FtZXJhLmRldmljZVBvc2l0aW9uLG49dGhpcy51c2VSaWdodEhhbmRlZFN5c3RlbT09PSh0aGlzLl9taXJyb3JlZENhbWVyYVBvc2l0aW9uIT1udWxsKTtyZXR1cm4gRC5WZWN0b3I0WzBdLnNldChyLngsci55LHIueixuPy0xOjEpLGUmJihpP2Uuc2V0RmxvYXQzKHQsRC5WZWN0b3I0WzBdLngsRC5WZWN0b3I0WzBdLnksRC5WZWN0b3I0WzBdLnopOmUuc2V0VmVjdG9yNCh0LEQuVmVjdG9yNFswXSkpLEQuVmVjdG9yNFswXX1maW5hbGl6ZVNjZW5lVWJvKCl7Y29uc3QgZT10aGlzLmdldFNjZW5lVW5pZm9ybUJ1ZmZlcigpLHQ9dGhpcy5iaW5kRXllUG9zaXRpb24obnVsbCk7cmV0dXJuIGUudXBkYXRlRmxvYXQ0KCJ2RXllUG9zaXRpb24iLHQueCx0LnksdC56LHQudyksZS51cGRhdGUoKSxlfXNldCB1c2VSaWdodEhhbmRlZFN5c3RlbShlKXt0aGlzLl91c2VSaWdodEhhbmRlZFN5c3RlbSE9PWUmJih0aGlzLl91c2VSaWdodEhhbmRlZFN5c3RlbT1lLHRoaXMubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMTYpKX1nZXQgdXNlUmlnaHRIYW5kZWRTeXN0ZW0oKXtyZXR1cm4gdGhpcy5fdXNlUmlnaHRIYW5kZWRTeXN0ZW19c2V0U3RlcElkKGUpe3RoaXMuX2N1cnJlbnRTdGVwSWQ9ZX1nZXRTdGVwSWQoKXtyZXR1cm4gdGhpcy5fY3VycmVudFN0ZXBJZH1nZXRJbnRlcm5hbFN0ZXAoKXtyZXR1cm4gdGhpcy5fY3VycmVudEludGVybmFsU3RlcH1zZXQgZm9nRW5hYmxlZChlKXt0aGlzLl9mb2dFbmFibGVkIT09ZSYmKHRoaXMuX2ZvZ0VuYWJsZWQ9ZSx0aGlzLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDE2KSl9Z2V0IGZvZ0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5fZm9nRW5hYmxlZH1zZXQgZm9nTW9kZShlKXt0aGlzLl9mb2dNb2RlIT09ZSYmKHRoaXMuX2ZvZ01vZGU9ZSx0aGlzLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDE2KSl9Z2V0IGZvZ01vZGUoKXtyZXR1cm4gdGhpcy5fZm9nTW9kZX1nZXQgcHJlUGFzcygpe3JldHVybiEhdGhpcy5wcmVQYXNzUmVuZGVyZXImJnRoaXMucHJlUGFzc1JlbmRlcmVyLmRlZmF1bHRSVC5lbmFibGVkfXNldCBzaGFkb3dzRW5hYmxlZChlKXt0aGlzLl9zaGFkb3dzRW5hYmxlZCE9PWUmJih0aGlzLl9zaGFkb3dzRW5hYmxlZD1lLHRoaXMubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMikpfWdldCBzaGFkb3dzRW5hYmxlZCgpe3JldHVybiB0aGlzLl9zaGFkb3dzRW5hYmxlZH1zZXQgbGlnaHRzRW5hYmxlZChlKXt0aGlzLl9saWdodHNFbmFibGVkIT09ZSYmKHRoaXMuX2xpZ2h0c0VuYWJsZWQ9ZSx0aGlzLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDIpKX1nZXQgbGlnaHRzRW5hYmxlZCgpe3JldHVybiB0aGlzLl9saWdodHNFbmFibGVkfWdldCBhY3RpdmVDYW1lcmFzKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUNhbWVyYXN9c2V0IGFjdGl2ZUNhbWVyYXMoZSl7dGhpcy5fdW5PYnNlcnZlQWN0aXZlQ2FtZXJhcyYmKHRoaXMuX3VuT2JzZXJ2ZUFjdGl2ZUNhbWVyYXMoKSx0aGlzLl91bk9ic2VydmVBY3RpdmVDYW1lcmFzPW51bGwpLGUmJih0aGlzLl91bk9ic2VydmVBY3RpdmVDYW1lcmFzPSRzKGUsKCk9Pnt0aGlzLm9uQWN0aXZlQ2FtZXJhc0NoYW5nZWQubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpfSkpLHRoaXMuX2FjdGl2ZUNhbWVyYXM9ZX1nZXQgYWN0aXZlQ2FtZXJhKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUNhbWVyYX1zZXQgYWN0aXZlQ2FtZXJhKGUpe2UhPT10aGlzLl9hY3RpdmVDYW1lcmEmJih0aGlzLl9hY3RpdmVDYW1lcmE9ZSx0aGlzLm9uQWN0aXZlQ2FtZXJhQ2hhbmdlZC5ub3RpZnlPYnNlcnZlcnModGhpcykpfWdldCBkZWZhdWx0TWF0ZXJpYWwoKXtyZXR1cm4gdGhpcy5fZGVmYXVsdE1hdGVyaWFsfHwodGhpcy5fZGVmYXVsdE1hdGVyaWFsPW5lLkRlZmF1bHRNYXRlcmlhbEZhY3RvcnkodGhpcykpLHRoaXMuX2RlZmF1bHRNYXRlcmlhbH1zZXQgZGVmYXVsdE1hdGVyaWFsKGUpe3RoaXMuX2RlZmF1bHRNYXRlcmlhbD1lfXNldCB0ZXh0dXJlc0VuYWJsZWQoZSl7dGhpcy5fdGV4dHVyZXNFbmFibGVkIT09ZSYmKHRoaXMuX3RleHR1cmVzRW5hYmxlZD1lLHRoaXMubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfWdldCB0ZXh0dXJlc0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZXNFbmFibGVkfXNldCBza2VsZXRvbnNFbmFibGVkKGUpe3RoaXMuX3NrZWxldG9uc0VuYWJsZWQhPT1lJiYodGhpcy5fc2tlbGV0b25zRW5hYmxlZD1lLHRoaXMubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoOCkpfWdldCBza2VsZXRvbnNFbmFibGVkKCl7cmV0dXJuIHRoaXMuX3NrZWxldG9uc0VuYWJsZWR9Z2V0IGNvbGxpc2lvbkNvb3JkaW5hdG9yKCl7cmV0dXJuIHRoaXMuX2NvbGxpc2lvbkNvb3JkaW5hdG9yfHwodGhpcy5fY29sbGlzaW9uQ29vcmRpbmF0b3I9bmUuQ29sbGlzaW9uQ29vcmRpbmF0b3JGYWN0b3J5KCksdGhpcy5fY29sbGlzaW9uQ29vcmRpbmF0b3IuaW5pdCh0aGlzKSksdGhpcy5fY29sbGlzaW9uQ29vcmRpbmF0b3J9Z2V0IHJlbmRlcmluZ01hbmFnZXIoKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nTWFuYWdlcn1nZXQgZnJ1c3R1bVBsYW5lcygpe3JldHVybiB0aGlzLl9mcnVzdHVtUGxhbmVzfV9yZWdpc3RlclRyYW5zaWVudENvbXBvbmVudHMoKXtpZih0aGlzLl90cmFuc2llbnRDb21wb25lbnRzLmxlbmd0aD4wKXtmb3IoY29uc3QgZSBvZiB0aGlzLl90cmFuc2llbnRDb21wb25lbnRzKWUucmVnaXN0ZXIoKTt0aGlzLl90cmFuc2llbnRDb21wb25lbnRzLmxlbmd0aD0wfX1fYWRkQ29tcG9uZW50KGUpe3RoaXMuX2NvbXBvbmVudHMucHVzaChlKSx0aGlzLl90cmFuc2llbnRDb21wb25lbnRzLnB1c2goZSk7Y29uc3QgdD1lO3QuYWRkRnJvbUNvbnRhaW5lciYmdC5zZXJpYWxpemUmJnRoaXMuX3NlcmlhbGl6YWJsZUNvbXBvbmVudHMucHVzaCh0KX1fZ2V0Q29tcG9uZW50KGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuX2NvbXBvbmVudHMpaWYodC5uYW1lPT09ZSlyZXR1cm4gdDtyZXR1cm4gbnVsbH1nZXRDbGFzc05hbWUoKXtyZXR1cm4iU2NlbmUifV9nZXREZWZhdWx0TWVzaENhbmRpZGF0ZXMoKXtyZXR1cm4gdGhpcy5fZGVmYXVsdE1lc2hDYW5kaWRhdGVzLmRhdGE9dGhpcy5tZXNoZXMsdGhpcy5fZGVmYXVsdE1lc2hDYW5kaWRhdGVzLmxlbmd0aD10aGlzLm1lc2hlcy5sZW5ndGgsdGhpcy5fZGVmYXVsdE1lc2hDYW5kaWRhdGVzfV9nZXREZWZhdWx0U3ViTWVzaENhbmRpZGF0ZXMoZSl7cmV0dXJuIHRoaXMuX2RlZmF1bHRTdWJNZXNoQ2FuZGlkYXRlcy5kYXRhPWUuc3ViTWVzaGVzLHRoaXMuX2RlZmF1bHRTdWJNZXNoQ2FuZGlkYXRlcy5sZW5ndGg9ZS5zdWJNZXNoZXMubGVuZ3RoLHRoaXMuX2RlZmF1bHRTdWJNZXNoQ2FuZGlkYXRlc31zZXREZWZhdWx0Q2FuZGlkYXRlUHJvdmlkZXJzKCl7dGhpcy5nZXRBY3RpdmVNZXNoQ2FuZGlkYXRlcz10aGlzLl9nZXREZWZhdWx0TWVzaENhbmRpZGF0ZXMuYmluZCh0aGlzKSx0aGlzLmdldEFjdGl2ZVN1Yk1lc2hDYW5kaWRhdGVzPXRoaXMuX2dldERlZmF1bHRTdWJNZXNoQ2FuZGlkYXRlcy5iaW5kKHRoaXMpLHRoaXMuZ2V0SW50ZXJzZWN0aW5nU3ViTWVzaENhbmRpZGF0ZXM9dGhpcy5fZ2V0RGVmYXVsdFN1Yk1lc2hDYW5kaWRhdGVzLmJpbmQodGhpcyksdGhpcy5nZXRDb2xsaWRpbmdTdWJNZXNoQ2FuZGlkYXRlcz10aGlzLl9nZXREZWZhdWx0U3ViTWVzaENhbmRpZGF0ZXMuYmluZCh0aGlzKX1nZXQgbWVzaFVuZGVyUG9pbnRlcigpe3JldHVybiB0aGlzLl9pbnB1dE1hbmFnZXIubWVzaFVuZGVyUG9pbnRlcn1nZXQgcG9pbnRlclgoKXtyZXR1cm4gdGhpcy5faW5wdXRNYW5hZ2VyLnBvaW50ZXJYfXNldCBwb2ludGVyWChlKXt0aGlzLl9pbnB1dE1hbmFnZXIucG9pbnRlclg9ZX1nZXQgcG9pbnRlclkoKXtyZXR1cm4gdGhpcy5faW5wdXRNYW5hZ2VyLnBvaW50ZXJZfXNldCBwb2ludGVyWShlKXt0aGlzLl9pbnB1dE1hbmFnZXIucG9pbnRlclk9ZX1nZXRDYWNoZWRNYXRlcmlhbCgpe3JldHVybiB0aGlzLl9jYWNoZWRNYXRlcmlhbH1nZXRDYWNoZWRFZmZlY3QoKXtyZXR1cm4gdGhpcy5fY2FjaGVkRWZmZWN0fWdldENhY2hlZFZpc2liaWxpdHkoKXtyZXR1cm4gdGhpcy5fY2FjaGVkVmlzaWJpbGl0eX1pc0NhY2hlZE1hdGVyaWFsSW52YWxpZChlLHQsaT0xKXtyZXR1cm4gdGhpcy5fY2FjaGVkRWZmZWN0IT09dHx8dGhpcy5fY2FjaGVkTWF0ZXJpYWwhPT1lfHx0aGlzLl9jYWNoZWRWaXNpYmlsaXR5IT09aX1nZXRFbmdpbmUoKXtyZXR1cm4gdGhpcy5fZW5naW5lfWdldFRvdGFsVmVydGljZXMoKXtyZXR1cm4gdGhpcy5fdG90YWxWZXJ0aWNlcy5jdXJyZW50fWdldCB0b3RhbFZlcnRpY2VzUGVyZkNvdW50ZXIoKXtyZXR1cm4gdGhpcy5fdG90YWxWZXJ0aWNlc31nZXRBY3RpdmVJbmRpY2VzKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUluZGljZXMuY3VycmVudH1nZXQgdG90YWxBY3RpdmVJbmRpY2VzUGVyZkNvdW50ZXIoKXtyZXR1cm4gdGhpcy5fYWN0aXZlSW5kaWNlc31nZXRBY3RpdmVQYXJ0aWNsZXMoKXtyZXR1cm4gdGhpcy5fYWN0aXZlUGFydGljbGVzLmN1cnJlbnR9Z2V0IGFjdGl2ZVBhcnRpY2xlc1BlcmZDb3VudGVyKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZVBhcnRpY2xlc31nZXRBY3RpdmVCb25lcygpe3JldHVybiB0aGlzLl9hY3RpdmVCb25lcy5jdXJyZW50fWdldCBhY3RpdmVCb25lc1BlcmZDb3VudGVyKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUJvbmVzfWdldEFjdGl2ZU1lc2hlcygpe3JldHVybiB0aGlzLl9hY3RpdmVNZXNoZXN9Z2V0QW5pbWF0aW9uUmF0aW8oKXtyZXR1cm4gdGhpcy5fYW5pbWF0aW9uUmF0aW8hPT12b2lkIDA/dGhpcy5fYW5pbWF0aW9uUmF0aW86MX1nZXRSZW5kZXJJZCgpe3JldHVybiB0aGlzLl9yZW5kZXJJZH1nZXRGcmFtZUlkKCl7cmV0dXJuIHRoaXMuX2ZyYW1lSWR9aW5jcmVtZW50UmVuZGVySWQoKXt0aGlzLl9yZW5kZXJJZCsrfV9jcmVhdGVVYm8oKXt0aGlzLnNldFNjZW5lVW5pZm9ybUJ1ZmZlcih0aGlzLmNyZWF0ZVNjZW5lVW5pZm9ybUJ1ZmZlcigpKX1zaW11bGF0ZVBvaW50ZXJNb3ZlKGUsdCl7cmV0dXJuIHRoaXMuX2lucHV0TWFuYWdlci5zaW11bGF0ZVBvaW50ZXJNb3ZlKGUsdCksdGhpc31zaW11bGF0ZVBvaW50ZXJEb3duKGUsdCl7cmV0dXJuIHRoaXMuX2lucHV0TWFuYWdlci5zaW11bGF0ZVBvaW50ZXJEb3duKGUsdCksdGhpc31zaW11bGF0ZVBvaW50ZXJVcChlLHQsaSl7cmV0dXJuIHRoaXMuX2lucHV0TWFuYWdlci5zaW11bGF0ZVBvaW50ZXJVcChlLHQsaSksdGhpc31pc1BvaW50ZXJDYXB0dXJlZChlPTApe3JldHVybiB0aGlzLl9pbnB1dE1hbmFnZXIuaXNQb2ludGVyQ2FwdHVyZWQoZSl9YXR0YWNoQ29udHJvbChlPSEwLHQ9ITAsaT0hMCl7dGhpcy5faW5wdXRNYW5hZ2VyLmF0dGFjaENvbnRyb2woZSx0LGkpfWRldGFjaENvbnRyb2woKXt0aGlzLl9pbnB1dE1hbmFnZXIuZGV0YWNoQ29udHJvbCgpfWlzUmVhZHkoZT0hMCl7aWYodGhpcy5faXNEaXNwb3NlZClyZXR1cm4hMTtsZXQgdDtjb25zdCBpPXRoaXMuZ2V0RW5naW5lKCk7bGV0IHM9ITA7Zm9yKHRoaXMuX3BlbmRpbmdEYXRhLmxlbmd0aD4wJiYocz0hMSksZSYmKHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5yZXNldCgpLHRoaXMuX21hdGVyaWFsc1JlbmRlclRhcmdldHMucmVzZXQoKSksdD0wO3Q8dGhpcy5tZXNoZXMubGVuZ3RoO3QrKyl7Y29uc3Qgcj10aGlzLm1lc2hlc1t0XTtpZighci5zdWJNZXNoZXN8fHIuc3ViTWVzaGVzLmxlbmd0aD09PTApY29udGludWU7aWYoIXIuaXNSZWFkeSghMCkpe3M9ITE7Y29udGludWV9Y29uc3Qgbj1yLmhhc1RoaW5JbnN0YW5jZXN8fHIuZ2V0Q2xhc3NOYW1lKCk9PT0iSW5zdGFuY2VkTWVzaCJ8fHIuZ2V0Q2xhc3NOYW1lKCk9PT0iSW5zdGFuY2VkTGluZXNNZXNoInx8aS5nZXRDYXBzKCkuaW5zdGFuY2VkQXJyYXlzJiZyLmluc3RhbmNlcy5sZW5ndGg+MDtmb3IoY29uc3QgbyBvZiB0aGlzLl9pc1JlYWR5Rm9yTWVzaFN0YWdlKW8uYWN0aW9uKHIsbil8fChzPSExKTtpZighZSljb250aW51ZTtjb25zdCBhPXIubWF0ZXJpYWx8fHRoaXMuZGVmYXVsdE1hdGVyaWFsO2lmKGEpaWYoYS5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcylmb3IoY29uc3QgbyBvZiByLnN1Yk1lc2hlcyl7Y29uc3QgaD1vLmdldE1hdGVyaWFsKCk7aCYmaC5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyYmaC5nZXRSZW5kZXJUYXJnZXRUZXh0dXJlcyE9bnVsbCYmdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzLmluZGV4T2YoaCk9PT0tMSYmKHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5wdXNoKGgpLHRoaXMuX21hdGVyaWFsc1JlbmRlclRhcmdldHMuY29uY2F0V2l0aE5vRHVwbGljYXRlKGguZ2V0UmVuZGVyVGFyZ2V0VGV4dHVyZXMoKSkpfWVsc2UgYS5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyYmYS5nZXRSZW5kZXJUYXJnZXRUZXh0dXJlcyE9bnVsbCYmdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzLmluZGV4T2YoYSk9PT0tMSYmKHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5wdXNoKGEpLHRoaXMuX21hdGVyaWFsc1JlbmRlclRhcmdldHMuY29uY2F0V2l0aE5vRHVwbGljYXRlKGEuZ2V0UmVuZGVyVGFyZ2V0VGV4dHVyZXMoKSkpfWlmKCFzfHwhaS5hcmVBbGxFZmZlY3RzUmVhZHkoKSlyZXR1cm4hMTtpZihlKXtmb3IodD0wO3Q8dGhpcy5fbWF0ZXJpYWxzUmVuZGVyVGFyZ2V0cy5sZW5ndGg7Kyt0KWlmKCF0aGlzLl9tYXRlcmlhbHNSZW5kZXJUYXJnZXRzLmRhdGFbdF0uaXNSZWFkeUZvclJlbmRlcmluZygpKXJldHVybiExfWZvcih0PTA7dDx0aGlzLmdlb21ldHJpZXMubGVuZ3RoO3QrKylpZih0aGlzLmdlb21ldHJpZXNbdF0uZGVsYXlMb2FkU3RhdGU9PT0yKXJldHVybiExO2lmKHRoaXMuYWN0aXZlQ2FtZXJhcyYmdGhpcy5hY3RpdmVDYW1lcmFzLmxlbmd0aD4wKXtmb3IoY29uc3QgciBvZiB0aGlzLmFjdGl2ZUNhbWVyYXMpaWYoIXIuaXNSZWFkeSghMCkpcmV0dXJuITF9ZWxzZSBpZih0aGlzLmFjdGl2ZUNhbWVyYSYmIXRoaXMuYWN0aXZlQ2FtZXJhLmlzUmVhZHkoITApKXJldHVybiExO2Zvcihjb25zdCByIG9mIHRoaXMucGFydGljbGVTeXN0ZW1zKWlmKCFyLmlzUmVhZHkoKSlyZXR1cm4hMTtyZXR1cm4hMH1yZXNldENhY2hlZE1hdGVyaWFsKCl7dGhpcy5fY2FjaGVkTWF0ZXJpYWw9bnVsbCx0aGlzLl9jYWNoZWRFZmZlY3Q9bnVsbCx0aGlzLl9jYWNoZWRWaXNpYmlsaXR5PW51bGx9cmVnaXN0ZXJCZWZvcmVSZW5kZXIoZSl7dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGUpfXVucmVnaXN0ZXJCZWZvcmVSZW5kZXIoZSl7dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlQ2FsbGJhY2soZSl9cmVnaXN0ZXJBZnRlclJlbmRlcihlKXt0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLmFkZChlKX11bnJlZ2lzdGVyQWZ0ZXJSZW5kZXIoZSl7dGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmVDYWxsYmFjayhlKX1fZXhlY3V0ZU9uY2VCZWZvcmVSZW5kZXIoZSl7Y29uc3QgdD0oKT0+e2UoKSxzZXRUaW1lb3V0KCgpPT57dGhpcy51bnJlZ2lzdGVyQmVmb3JlUmVuZGVyKHQpfSl9O3RoaXMucmVnaXN0ZXJCZWZvcmVSZW5kZXIodCl9ZXhlY3V0ZU9uY2VCZWZvcmVSZW5kZXIoZSx0KXt0IT09dm9pZCAwP3NldFRpbWVvdXQoKCk9Pnt0aGlzLl9leGVjdXRlT25jZUJlZm9yZVJlbmRlcihlKX0sdCk6dGhpcy5fZXhlY3V0ZU9uY2VCZWZvcmVSZW5kZXIoZSl9YWRkUGVuZGluZ0RhdGEoZSl7dGhpcy5fcGVuZGluZ0RhdGEucHVzaChlKX1yZW1vdmVQZW5kaW5nRGF0YShlKXtjb25zdCB0PXRoaXMuaXNMb2FkaW5nLGk9dGhpcy5fcGVuZGluZ0RhdGEuaW5kZXhPZihlKTtpIT09LTEmJnRoaXMuX3BlbmRpbmdEYXRhLnNwbGljZShpLDEpLHQmJiF0aGlzLmlzTG9hZGluZyYmdGhpcy5vbkRhdGFMb2FkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1nZXRXYWl0aW5nSXRlbXNDb3VudCgpe3JldHVybiB0aGlzLl9wZW5kaW5nRGF0YS5sZW5ndGh9Z2V0IGlzTG9hZGluZygpe3JldHVybiB0aGlzLl9wZW5kaW5nRGF0YS5sZW5ndGg+MH1leGVjdXRlV2hlblJlYWR5KGUsdD0hMSl7dGhpcy5vblJlYWR5T2JzZXJ2YWJsZS5hZGRPbmNlKGUpLHRoaXMuX2V4ZWN1dGVXaGVuUmVhZHlUaW1lb3V0SWQ9PT1udWxsJiZ0aGlzLl9jaGVja0lzUmVhZHkodCl9d2hlblJlYWR5QXN5bmMoZT0hMSl7cmV0dXJuIG5ldyBQcm9taXNlKHQ9Pnt0aGlzLmV4ZWN1dGVXaGVuUmVhZHkoKCk9Pnt0KCl9LGUpfSl9X2NoZWNrSXNSZWFkeShlPSExKXtpZih0aGlzLl9yZWdpc3RlclRyYW5zaWVudENvbXBvbmVudHMoKSx0aGlzLmlzUmVhZHkoZSkpe3RoaXMub25SZWFkeU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25SZWFkeU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9leGVjdXRlV2hlblJlYWR5VGltZW91dElkPW51bGw7cmV0dXJufWlmKHRoaXMuX2lzRGlzcG9zZWQpe3RoaXMub25SZWFkeU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9leGVjdXRlV2hlblJlYWR5VGltZW91dElkPW51bGw7cmV0dXJufXRoaXMuX2V4ZWN1dGVXaGVuUmVhZHlUaW1lb3V0SWQ9c2V0VGltZW91dCgoKT0+e3RoaXMuaW5jcmVtZW50UmVuZGVySWQoKSx0aGlzLl9jaGVja0lzUmVhZHkoZSl9LDEwMCl9Z2V0IGFuaW1hdGFibGVzKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUFuaW1hdGFibGVzfXJlc2V0TGFzdEFuaW1hdGlvblRpbWVGcmFtZSgpe3RoaXMuX2FuaW1hdGlvblRpbWVMYXN0PWFpLk5vd31nZXRWaWV3TWF0cml4KCl7cmV0dXJuIHRoaXMuX3ZpZXdNYXRyaXh9Z2V0UHJvamVjdGlvbk1hdHJpeCgpe3JldHVybiB0aGlzLl9wcm9qZWN0aW9uTWF0cml4fWdldFRyYW5zZm9ybU1hdHJpeCgpe3JldHVybiB0aGlzLl90cmFuc2Zvcm1NYXRyaXh9c2V0VHJhbnNmb3JtTWF0cml4KGUsdCxpLHMpeyFpJiYhcyYmdGhpcy5fbXVsdGl2aWV3U2NlbmVVYm8mJih0aGlzLl9tdWx0aXZpZXdTY2VuZVViby5kaXNwb3NlKCksdGhpcy5fbXVsdGl2aWV3U2NlbmVVYm89bnVsbCksISh0aGlzLl92aWV3VXBkYXRlRmxhZz09PWUudXBkYXRlRmxhZyYmdGhpcy5fcHJvamVjdGlvblVwZGF0ZUZsYWc9PT10LnVwZGF0ZUZsYWcpJiYodGhpcy5fdmlld1VwZGF0ZUZsYWc9ZS51cGRhdGVGbGFnLHRoaXMuX3Byb2plY3Rpb25VcGRhdGVGbGFnPXQudXBkYXRlRmxhZyx0aGlzLl92aWV3TWF0cml4PWUsdGhpcy5fcHJvamVjdGlvbk1hdHJpeD10LHRoaXMuX3ZpZXdNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLl9wcm9qZWN0aW9uTWF0cml4LHRoaXMuX3RyYW5zZm9ybU1hdHJpeCksdGhpcy5fZnJ1c3R1bVBsYW5lcz9FdC5HZXRQbGFuZXNUb1JlZih0aGlzLl90cmFuc2Zvcm1NYXRyaXgsdGhpcy5fZnJ1c3R1bVBsYW5lcyk6dGhpcy5fZnJ1c3R1bVBsYW5lcz1FdC5HZXRQbGFuZXModGhpcy5fdHJhbnNmb3JtTWF0cml4KSx0aGlzLl9tdWx0aXZpZXdTY2VuZVVibyYmdGhpcy5fbXVsdGl2aWV3U2NlbmVVYm8udXNlVWJvP3RoaXMuX3VwZGF0ZU11bHRpdmlld1VibyhpLHMpOnRoaXMuX3NjZW5lVWJvLnVzZVVibyYmKHRoaXMuX3NjZW5lVWJvLnVwZGF0ZU1hdHJpeCgidmlld1Byb2plY3Rpb24iLHRoaXMuX3RyYW5zZm9ybU1hdHJpeCksdGhpcy5fc2NlbmVVYm8udXBkYXRlTWF0cml4KCJ2aWV3Iix0aGlzLl92aWV3TWF0cml4KSx0aGlzLl9zY2VuZVViby51cGRhdGVNYXRyaXgoInByb2plY3Rpb24iLHRoaXMuX3Byb2plY3Rpb25NYXRyaXgpKSl9Z2V0U2NlbmVVbmlmb3JtQnVmZmVyKCl7cmV0dXJuIHRoaXMuX211bHRpdmlld1NjZW5lVWJvP3RoaXMuX211bHRpdmlld1NjZW5lVWJvOnRoaXMuX3NjZW5lVWJvfWNyZWF0ZVNjZW5lVW5pZm9ybUJ1ZmZlcihlKXtjb25zdCB0PW5ldyBWKHRoaXMuX2VuZ2luZSx2b2lkIDAsITEsZT8/InNjZW5lIik7cmV0dXJuIHQuYWRkVW5pZm9ybSgidmlld1Byb2plY3Rpb24iLDE2KSx0LmFkZFVuaWZvcm0oInZpZXciLDE2KSx0LmFkZFVuaWZvcm0oInByb2plY3Rpb24iLDE2KSx0LmFkZFVuaWZvcm0oInZFeWVQb3NpdGlvbiIsNCksdH1zZXRTY2VuZVVuaWZvcm1CdWZmZXIoZSl7dGhpcy5fc2NlbmVVYm89ZSx0aGlzLl92aWV3VXBkYXRlRmxhZz0tMSx0aGlzLl9wcm9qZWN0aW9uVXBkYXRlRmxhZz0tMX1nZXRVbmlxdWVJZCgpe3JldHVybiBNci5VbmlxdWVJZH1hZGRNZXNoKGUsdD0hMSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHwodGhpcy5tZXNoZXMucHVzaChlKSxlLl9yZXN5bmNMaWdodFNvdXJjZXMoKSxlLnBhcmVudHx8ZS5fYWRkVG9TY2VuZVJvb3ROb2RlcygpLHRoaXMub25OZXdNZXNoQWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0JiZlLmdldENoaWxkTWVzaGVzKCkuZm9yRWFjaChpPT57dGhpcy5hZGRNZXNoKGkpfSkpfXJlbW92ZU1lc2goZSx0PSExKXtjb25zdCBpPXRoaXMubWVzaGVzLmluZGV4T2YoZSk7cmV0dXJuIGkhPT0tMSYmKHRoaXMubWVzaGVzW2ldPXRoaXMubWVzaGVzW3RoaXMubWVzaGVzLmxlbmd0aC0xXSx0aGlzLm1lc2hlcy5wb3AoKSxlLnBhcmVudHx8ZS5fcmVtb3ZlRnJvbVNjZW5lUm9vdE5vZGVzKCkpLHRoaXMuX2lucHV0TWFuYWdlci5faW52YWxpZGF0ZU1lc2goZSksdGhpcy5vbk1lc2hSZW1vdmVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSksdCYmZS5nZXRDaGlsZE1lc2hlcygpLmZvckVhY2gocz0+e3RoaXMucmVtb3ZlTWVzaChzKX0pLGl9YWRkVHJhbnNmb3JtTm9kZShlKXt0aGlzLl9ibG9ja0VudGl0eUNvbGxlY3Rpb258fGUuZ2V0U2NlbmUoKT09PXRoaXMmJmUuX2luZGV4SW5TY2VuZVRyYW5zZm9ybU5vZGVzQXJyYXkhPT0tMXx8KGUuX2luZGV4SW5TY2VuZVRyYW5zZm9ybU5vZGVzQXJyYXk9dGhpcy50cmFuc2Zvcm1Ob2Rlcy5sZW5ndGgsdGhpcy50cmFuc2Zvcm1Ob2Rlcy5wdXNoKGUpLGUucGFyZW50fHxlLl9hZGRUb1NjZW5lUm9vdE5vZGVzKCksdGhpcy5vbk5ld1RyYW5zZm9ybU5vZGVBZGRlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpKX1yZW1vdmVUcmFuc2Zvcm1Ob2RlKGUpe2NvbnN0IHQ9ZS5faW5kZXhJblNjZW5lVHJhbnNmb3JtTm9kZXNBcnJheTtpZih0IT09LTEpe2lmKHQhPT10aGlzLnRyYW5zZm9ybU5vZGVzLmxlbmd0aC0xKXtjb25zdCBpPXRoaXMudHJhbnNmb3JtTm9kZXNbdGhpcy50cmFuc2Zvcm1Ob2Rlcy5sZW5ndGgtMV07dGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XT1pLGkuX2luZGV4SW5TY2VuZVRyYW5zZm9ybU5vZGVzQXJyYXk9dH1lLl9pbmRleEluU2NlbmVUcmFuc2Zvcm1Ob2Rlc0FycmF5PS0xLHRoaXMudHJhbnNmb3JtTm9kZXMucG9wKCksZS5wYXJlbnR8fGUuX3JlbW92ZUZyb21TY2VuZVJvb3ROb2RlcygpfXJldHVybiB0aGlzLm9uVHJhbnNmb3JtTm9kZVJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0fXJlbW92ZVNrZWxldG9uKGUpe2NvbnN0IHQ9dGhpcy5za2VsZXRvbnMuaW5kZXhPZihlKTtyZXR1cm4gdCE9PS0xJiYodGhpcy5za2VsZXRvbnMuc3BsaWNlKHQsMSksdGhpcy5vblNrZWxldG9uUmVtb3ZlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpLHRoaXMuX2V4ZWN1dGVBY3RpdmVDb250YWluZXJDbGVhbnVwKHRoaXMuX2FjdGl2ZVNrZWxldG9ucykpLHR9cmVtb3ZlTW9ycGhUYXJnZXRNYW5hZ2VyKGUpe2NvbnN0IHQ9dGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmdGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzLnNwbGljZSh0LDEpLHR9cmVtb3ZlTGlnaHQoZSl7Y29uc3QgdD10aGlzLmxpZ2h0cy5pbmRleE9mKGUpO2lmKHQhPT0tMSl7Zm9yKGNvbnN0IGkgb2YgdGhpcy5tZXNoZXMpaS5fcmVtb3ZlTGlnaHRTb3VyY2UoZSwhMSk7dGhpcy5saWdodHMuc3BsaWNlKHQsMSksdGhpcy5zb3J0TGlnaHRzQnlQcmlvcml0eSgpLGUucGFyZW50fHxlLl9yZW1vdmVGcm9tU2NlbmVSb290Tm9kZXMoKX1yZXR1cm4gdGhpcy5vbkxpZ2h0UmVtb3ZlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpLHR9cmVtb3ZlQ2FtZXJhKGUpe2NvbnN0IHQ9dGhpcy5jYW1lcmFzLmluZGV4T2YoZSk7aWYodCE9PS0xJiYodGhpcy5jYW1lcmFzLnNwbGljZSh0LDEpLGUucGFyZW50fHxlLl9yZW1vdmVGcm9tU2NlbmVSb290Tm9kZXMoKSksdGhpcy5hY3RpdmVDYW1lcmFzKXtjb25zdCBpPXRoaXMuYWN0aXZlQ2FtZXJhcy5pbmRleE9mKGUpO2khPT0tMSYmdGhpcy5hY3RpdmVDYW1lcmFzLnNwbGljZShpLDEpfXJldHVybiB0aGlzLmFjdGl2ZUNhbWVyYT09PWUmJih0aGlzLmNhbWVyYXMubGVuZ3RoPjA/dGhpcy5hY3RpdmVDYW1lcmE9dGhpcy5jYW1lcmFzWzBdOnRoaXMuYWN0aXZlQ2FtZXJhPW51bGwpLHRoaXMub25DYW1lcmFSZW1vdmVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSksdH1yZW1vdmVQYXJ0aWNsZVN5c3RlbShlKXtjb25zdCB0PXRoaXMucGFydGljbGVTeXN0ZW1zLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmKHRoaXMucGFydGljbGVTeXN0ZW1zLnNwbGljZSh0LDEpLHRoaXMuX2V4ZWN1dGVBY3RpdmVDb250YWluZXJDbGVhbnVwKHRoaXMuX2FjdGl2ZVBhcnRpY2xlU3lzdGVtcykpLHR9cmVtb3ZlQW5pbWF0aW9uKGUpe2NvbnN0IHQ9dGhpcy5hbmltYXRpb25zLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmdGhpcy5hbmltYXRpb25zLnNwbGljZSh0LDEpLHR9c3RvcEFuaW1hdGlvbihlLHQsaSl7fXJlbW92ZUFuaW1hdGlvbkdyb3VwKGUpe2NvbnN0IHQ9dGhpcy5hbmltYXRpb25Hcm91cHMuaW5kZXhPZihlKTtyZXR1cm4gdCE9PS0xJiZ0aGlzLmFuaW1hdGlvbkdyb3Vwcy5zcGxpY2UodCwxKSx0fXJlbW92ZU11bHRpTWF0ZXJpYWwoZSl7Y29uc3QgdD10aGlzLm11bHRpTWF0ZXJpYWxzLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmdGhpcy5tdWx0aU1hdGVyaWFscy5zcGxpY2UodCwxKSx0aGlzLm9uTXVsdGlNYXRlcmlhbFJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0fXJlbW92ZU1hdGVyaWFsKGUpe2NvbnN0IHQ9ZS5faW5kZXhJblNjZW5lTWF0ZXJpYWxBcnJheTtpZih0IT09LTEmJnQ8dGhpcy5tYXRlcmlhbHMubGVuZ3RoKXtpZih0IT09dGhpcy5tYXRlcmlhbHMubGVuZ3RoLTEpe2NvbnN0IGk9dGhpcy5tYXRlcmlhbHNbdGhpcy5tYXRlcmlhbHMubGVuZ3RoLTFdO3RoaXMubWF0ZXJpYWxzW3RdPWksaS5faW5kZXhJblNjZW5lTWF0ZXJpYWxBcnJheT10fWUuX2luZGV4SW5TY2VuZU1hdGVyaWFsQXJyYXk9LTEsdGhpcy5tYXRlcmlhbHMucG9wKCl9cmV0dXJuIHRoaXMub25NYXRlcmlhbFJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0fXJlbW92ZUFjdGlvbk1hbmFnZXIoZSl7Y29uc3QgdD10aGlzLmFjdGlvbk1hbmFnZXJzLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmdGhpcy5hY3Rpb25NYW5hZ2Vycy5zcGxpY2UodCwxKSx0fXJlbW92ZVRleHR1cmUoZSl7Y29uc3QgdD10aGlzLnRleHR1cmVzLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmdGhpcy50ZXh0dXJlcy5zcGxpY2UodCwxKSx0aGlzLm9uVGV4dHVyZVJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0fWFkZExpZ2h0KGUpe2lmKCF0aGlzLl9ibG9ja0VudGl0eUNvbGxlY3Rpb24pe3RoaXMubGlnaHRzLnB1c2goZSksdGhpcy5zb3J0TGlnaHRzQnlQcmlvcml0eSgpLGUucGFyZW50fHxlLl9hZGRUb1NjZW5lUm9vdE5vZGVzKCk7Zm9yKGNvbnN0IHQgb2YgdGhpcy5tZXNoZXMpdC5saWdodFNvdXJjZXMuaW5kZXhPZihlKT09PS0xJiYodC5saWdodFNvdXJjZXMucHVzaChlKSx0Ll9yZXN5bmNMaWdodFNvdXJjZXMoKSk7dGhpcy5vbk5ld0xpZ2h0QWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKX19c29ydExpZ2h0c0J5UHJpb3JpdHkoKXt0aGlzLnJlcXVpcmVMaWdodFNvcnRpbmcmJnRoaXMubGlnaHRzLnNvcnQoRWUuQ29tcGFyZUxpZ2h0c1ByaW9yaXR5KX1hZGRDYW1lcmEoZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHwodGhpcy5jYW1lcmFzLnB1c2goZSksdGhpcy5vbk5ld0NhbWVyYUFkZGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSksZS5wYXJlbnR8fGUuX2FkZFRvU2NlbmVSb290Tm9kZXMoKSl9YWRkU2tlbGV0b24oZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHwodGhpcy5za2VsZXRvbnMucHVzaChlKSx0aGlzLm9uTmV3U2tlbGV0b25BZGRlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpKX1hZGRQYXJ0aWNsZVN5c3RlbShlKXt0aGlzLl9ibG9ja0VudGl0eUNvbGxlY3Rpb258fHRoaXMucGFydGljbGVTeXN0ZW1zLnB1c2goZSl9YWRkQW5pbWF0aW9uKGUpe3RoaXMuX2Jsb2NrRW50aXR5Q29sbGVjdGlvbnx8dGhpcy5hbmltYXRpb25zLnB1c2goZSl9YWRkQW5pbWF0aW9uR3JvdXAoZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHx0aGlzLmFuaW1hdGlvbkdyb3Vwcy5wdXNoKGUpfWFkZE11bHRpTWF0ZXJpYWwoZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHwodGhpcy5tdWx0aU1hdGVyaWFscy5wdXNoKGUpLHRoaXMub25OZXdNdWx0aU1hdGVyaWFsQWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSl9YWRkTWF0ZXJpYWwoZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHxlLmdldFNjZW5lKCk9PT10aGlzJiZlLl9pbmRleEluU2NlbmVNYXRlcmlhbEFycmF5IT09LTF8fChlLl9pbmRleEluU2NlbmVNYXRlcmlhbEFycmF5PXRoaXMubWF0ZXJpYWxzLmxlbmd0aCx0aGlzLm1hdGVyaWFscy5wdXNoKGUpLHRoaXMub25OZXdNYXRlcmlhbEFkZGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSkpfWFkZE1vcnBoVGFyZ2V0TWFuYWdlcihlKXt0aGlzLl9ibG9ja0VudGl0eUNvbGxlY3Rpb258fHRoaXMubW9ycGhUYXJnZXRNYW5hZ2Vycy5wdXNoKGUpfWFkZEdlb21ldHJ5KGUpe3RoaXMuX2Jsb2NrRW50aXR5Q29sbGVjdGlvbnx8KHRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkJiYodGhpcy5fZ2VvbWV0cmllc0J5VW5pcXVlSWRbZS51bmlxdWVJZF09dGhpcy5nZW9tZXRyaWVzLmxlbmd0aCksdGhpcy5nZW9tZXRyaWVzLnB1c2goZSkpfWFkZEFjdGlvbk1hbmFnZXIoZSl7dGhpcy5hY3Rpb25NYW5hZ2Vycy5wdXNoKGUpfWFkZFRleHR1cmUoZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHwodGhpcy50ZXh0dXJlcy5wdXNoKGUpLHRoaXMub25OZXdUZXh0dXJlQWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSl9c3dpdGNoQWN0aXZlQ2FtZXJhKGUsdD0hMCl7dGhpcy5fZW5naW5lLmdldElucHV0RWxlbWVudCgpJiYodGhpcy5hY3RpdmVDYW1lcmEmJnRoaXMuYWN0aXZlQ2FtZXJhLmRldGFjaENvbnRyb2woKSx0aGlzLmFjdGl2ZUNhbWVyYT1lLHQmJmUuYXR0YWNoQ29udHJvbCgpKX1zZXRBY3RpdmVDYW1lcmFCeUlkKGUpe2NvbnN0IHQ9dGhpcy5nZXRDYW1lcmFCeUlkKGUpO3JldHVybiB0Pyh0aGlzLmFjdGl2ZUNhbWVyYT10LHQpOm51bGx9c2V0QWN0aXZlQ2FtZXJhQnlOYW1lKGUpe2NvbnN0IHQ9dGhpcy5nZXRDYW1lcmFCeU5hbWUoZSk7cmV0dXJuIHQ/KHRoaXMuYWN0aXZlQ2FtZXJhPXQsdCk6bnVsbH1nZXRBbmltYXRpb25Hcm91cEJ5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMuYW5pbWF0aW9uR3JvdXBzLmxlbmd0aDt0KyspaWYodGhpcy5hbmltYXRpb25Hcm91cHNbdF0ubmFtZT09PWUpcmV0dXJuIHRoaXMuYW5pbWF0aW9uR3JvdXBzW3RdO3JldHVybiBudWxsfV9nZXRNYXRlcmlhbChlLHQpe2ZvcihsZXQgaT0wO2k8dGhpcy5tYXRlcmlhbHMubGVuZ3RoO2krKyl7Y29uc3Qgcz10aGlzLm1hdGVyaWFsc1tpXTtpZih0KHMpKXJldHVybiBzfWlmKGUpZm9yKGxldCBpPTA7aTx0aGlzLm11bHRpTWF0ZXJpYWxzLmxlbmd0aDtpKyspe2NvbnN0IHM9dGhpcy5tdWx0aU1hdGVyaWFsc1tpXTtpZih0KHMpKXJldHVybiBzfXJldHVybiBudWxsfWdldE1hdGVyaWFsQnlVbmlxdWVJRChlLHQ9ITEpe3JldHVybiB0aGlzLl9nZXRNYXRlcmlhbCh0LGk9PmkudW5pcXVlSWQ9PT1lKX1nZXRNYXRlcmlhbEJ5SWQoZSx0PSExKXtyZXR1cm4gdGhpcy5fZ2V0TWF0ZXJpYWwodCxpPT5pLmlkPT09ZSl9Z2V0TWF0ZXJpYWxCeU5hbWUoZSx0PSExKXtyZXR1cm4gdGhpcy5fZ2V0TWF0ZXJpYWwodCxpPT5pLm5hbWU9PT1lKX1nZXRMYXN0TWF0ZXJpYWxCeUlkKGUsdD0hMSl7Zm9yKGxldCBpPXRoaXMubWF0ZXJpYWxzLmxlbmd0aC0xO2k+PTA7aS0tKWlmKHRoaXMubWF0ZXJpYWxzW2ldLmlkPT09ZSlyZXR1cm4gdGhpcy5tYXRlcmlhbHNbaV07aWYodCl7Zm9yKGxldCBpPXRoaXMubXVsdGlNYXRlcmlhbHMubGVuZ3RoLTE7aT49MDtpLS0paWYodGhpcy5tdWx0aU1hdGVyaWFsc1tpXS5pZD09PWUpcmV0dXJuIHRoaXMubXVsdGlNYXRlcmlhbHNbaV19cmV0dXJuIG51bGx9Z2V0VGV4dHVyZUJ5VW5pcXVlSWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnRleHR1cmVzLmxlbmd0aDt0KyspaWYodGhpcy50ZXh0dXJlc1t0XS51bmlxdWVJZD09PWUpcmV0dXJuIHRoaXMudGV4dHVyZXNbdF07cmV0dXJuIG51bGx9Z2V0VGV4dHVyZUJ5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMudGV4dHVyZXMubGVuZ3RoO3QrKylpZih0aGlzLnRleHR1cmVzW3RdLm5hbWU9PT1lKXJldHVybiB0aGlzLnRleHR1cmVzW3RdO3JldHVybiBudWxsfWdldENhbWVyYUJ5SWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLmNhbWVyYXMubGVuZ3RoO3QrKylpZih0aGlzLmNhbWVyYXNbdF0uaWQ9PT1lKXJldHVybiB0aGlzLmNhbWVyYXNbdF07cmV0dXJuIG51bGx9Z2V0Q2FtZXJhQnlVbmlxdWVJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMuY2FtZXJhcy5sZW5ndGg7dCsrKWlmKHRoaXMuY2FtZXJhc1t0XS51bmlxdWVJZD09PWUpcmV0dXJuIHRoaXMuY2FtZXJhc1t0XTtyZXR1cm4gbnVsbH1nZXRDYW1lcmFCeU5hbWUoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLmNhbWVyYXMubGVuZ3RoO3QrKylpZih0aGlzLmNhbWVyYXNbdF0ubmFtZT09PWUpcmV0dXJuIHRoaXMuY2FtZXJhc1t0XTtyZXR1cm4gbnVsbH1nZXRCb25lQnlJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMuc2tlbGV0b25zLmxlbmd0aDt0Kyspe2NvbnN0IGk9dGhpcy5za2VsZXRvbnNbdF07Zm9yKGxldCBzPTA7czxpLmJvbmVzLmxlbmd0aDtzKyspaWYoaS5ib25lc1tzXS5pZD09PWUpcmV0dXJuIGkuYm9uZXNbc119cmV0dXJuIG51bGx9Z2V0Qm9uZUJ5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMuc2tlbGV0b25zLmxlbmd0aDt0Kyspe2NvbnN0IGk9dGhpcy5za2VsZXRvbnNbdF07Zm9yKGxldCBzPTA7czxpLmJvbmVzLmxlbmd0aDtzKyspaWYoaS5ib25lc1tzXS5uYW1lPT09ZSlyZXR1cm4gaS5ib25lc1tzXX1yZXR1cm4gbnVsbH1nZXRMaWdodEJ5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMubGlnaHRzLmxlbmd0aDt0KyspaWYodGhpcy5saWdodHNbdF0ubmFtZT09PWUpcmV0dXJuIHRoaXMubGlnaHRzW3RdO3JldHVybiBudWxsfWdldExpZ2h0QnlJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMubGlnaHRzLmxlbmd0aDt0KyspaWYodGhpcy5saWdodHNbdF0uaWQ9PT1lKXJldHVybiB0aGlzLmxpZ2h0c1t0XTtyZXR1cm4gbnVsbH1nZXRMaWdodEJ5VW5pcXVlSWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLmxpZ2h0cy5sZW5ndGg7dCsrKWlmKHRoaXMubGlnaHRzW3RdLnVuaXF1ZUlkPT09ZSlyZXR1cm4gdGhpcy5saWdodHNbdF07cmV0dXJuIG51bGx9Z2V0UGFydGljbGVTeXN0ZW1CeUlkKGUpe2ZvcihsZXQgdD0wO3Q8dGhpcy5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO3QrKylpZih0aGlzLnBhcnRpY2xlU3lzdGVtc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMucGFydGljbGVTeXN0ZW1zW3RdO3JldHVybiBudWxsfWdldEdlb21ldHJ5QnlJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7dCsrKWlmKHRoaXMuZ2VvbWV0cmllc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMuZ2VvbWV0cmllc1t0XTtyZXR1cm4gbnVsbH1fZ2V0R2VvbWV0cnlCeVVuaXF1ZUlkKGUpe2lmKHRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkKXtjb25zdCB0PXRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkW2VdO2lmKHQhPT12b2lkIDApcmV0dXJuIHRoaXMuZ2VvbWV0cmllc1t0XX1lbHNlIGZvcihsZXQgdD0wO3Q8dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDt0KyspaWYodGhpcy5nZW9tZXRyaWVzW3RdLnVuaXF1ZUlkPT09ZSlyZXR1cm4gdGhpcy5nZW9tZXRyaWVzW3RdO3JldHVybiBudWxsfXB1c2hHZW9tZXRyeShlLHQpe3JldHVybiF0JiZ0aGlzLl9nZXRHZW9tZXRyeUJ5VW5pcXVlSWQoZS51bmlxdWVJZCk/ITE6KHRoaXMuYWRkR2VvbWV0cnkoZSksdGhpcy5vbk5ld0dlb21ldHJ5QWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSwhMCl9cmVtb3ZlR2VvbWV0cnkoZSl7bGV0IHQ7aWYodGhpcy5fZ2VvbWV0cmllc0J5VW5pcXVlSWQpe2lmKHQ9dGhpcy5fZ2VvbWV0cmllc0J5VW5pcXVlSWRbZS51bmlxdWVJZF0sdD09PXZvaWQgMClyZXR1cm4hMX1lbHNlIGlmKHQ9dGhpcy5nZW9tZXRyaWVzLmluZGV4T2YoZSksdDwwKXJldHVybiExO2lmKHQhPT10aGlzLmdlb21ldHJpZXMubGVuZ3RoLTEpe2NvbnN0IGk9dGhpcy5nZW9tZXRyaWVzW3RoaXMuZ2VvbWV0cmllcy5sZW5ndGgtMV07aSYmKHRoaXMuZ2VvbWV0cmllc1t0XT1pLHRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkJiYodGhpcy5fZ2VvbWV0cmllc0J5VW5pcXVlSWRbaS51bmlxdWVJZF09dCkpfXJldHVybiB0aGlzLl9nZW9tZXRyaWVzQnlVbmlxdWVJZCYmKHRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkW2UudW5pcXVlSWRdPXZvaWQgMCksdGhpcy5nZW9tZXRyaWVzLnBvcCgpLHRoaXMub25HZW9tZXRyeVJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSwhMH1nZXRHZW9tZXRyaWVzKCl7cmV0dXJuIHRoaXMuZ2VvbWV0cmllc31nZXRNZXNoQnlJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMubWVzaGVzLmxlbmd0aDt0KyspaWYodGhpcy5tZXNoZXNbdF0uaWQ9PT1lKXJldHVybiB0aGlzLm1lc2hlc1t0XTtyZXR1cm4gbnVsbH1nZXRNZXNoZXNCeUlkKGUpe3JldHVybiB0aGlzLm1lc2hlcy5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIHQuaWQ9PT1lfSl9Z2V0VHJhbnNmb3JtTm9kZUJ5SWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnRyYW5zZm9ybU5vZGVzLmxlbmd0aDt0KyspaWYodGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMudHJhbnNmb3JtTm9kZXNbdF07cmV0dXJuIG51bGx9Z2V0VHJhbnNmb3JtTm9kZUJ5VW5pcXVlSWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnRyYW5zZm9ybU5vZGVzLmxlbmd0aDt0KyspaWYodGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XS51bmlxdWVJZD09PWUpcmV0dXJuIHRoaXMudHJhbnNmb3JtTm9kZXNbdF07cmV0dXJuIG51bGx9Z2V0VHJhbnNmb3JtTm9kZXNCeUlkKGUpe3JldHVybiB0aGlzLnRyYW5zZm9ybU5vZGVzLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm4gdC5pZD09PWV9KX1nZXRNZXNoQnlVbmlxdWVJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMubWVzaGVzLmxlbmd0aDt0KyspaWYodGhpcy5tZXNoZXNbdF0udW5pcXVlSWQ9PT1lKXJldHVybiB0aGlzLm1lc2hlc1t0XTtyZXR1cm4gbnVsbH1nZXRMYXN0TWVzaEJ5SWQoZSl7Zm9yKGxldCB0PXRoaXMubWVzaGVzLmxlbmd0aC0xO3Q+PTA7dC0tKWlmKHRoaXMubWVzaGVzW3RdLmlkPT09ZSlyZXR1cm4gdGhpcy5tZXNoZXNbdF07cmV0dXJuIG51bGx9Z2V0TGFzdEVudHJ5QnlJZChlKXtsZXQgdDtmb3IodD10aGlzLm1lc2hlcy5sZW5ndGgtMTt0Pj0wO3QtLSlpZih0aGlzLm1lc2hlc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMubWVzaGVzW3RdO2Zvcih0PXRoaXMudHJhbnNmb3JtTm9kZXMubGVuZ3RoLTE7dD49MDt0LS0paWYodGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMudHJhbnNmb3JtTm9kZXNbdF07Zm9yKHQ9dGhpcy5jYW1lcmFzLmxlbmd0aC0xO3Q+PTA7dC0tKWlmKHRoaXMuY2FtZXJhc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMuY2FtZXJhc1t0XTtmb3IodD10aGlzLmxpZ2h0cy5sZW5ndGgtMTt0Pj0wO3QtLSlpZih0aGlzLmxpZ2h0c1t0XS5pZD09PWUpcmV0dXJuIHRoaXMubGlnaHRzW3RdO3JldHVybiBudWxsfWdldE5vZGVCeUlkKGUpe2NvbnN0IHQ9dGhpcy5nZXRNZXNoQnlJZChlKTtpZih0KXJldHVybiB0O2NvbnN0IGk9dGhpcy5nZXRUcmFuc2Zvcm1Ob2RlQnlJZChlKTtpZihpKXJldHVybiBpO2NvbnN0IHM9dGhpcy5nZXRMaWdodEJ5SWQoZSk7aWYocylyZXR1cm4gcztjb25zdCByPXRoaXMuZ2V0Q2FtZXJhQnlJZChlKTtpZihyKXJldHVybiByO2NvbnN0IG49dGhpcy5nZXRCb25lQnlJZChlKTtyZXR1cm4gbnx8bnVsbH1nZXROb2RlQnlOYW1lKGUpe2NvbnN0IHQ9dGhpcy5nZXRNZXNoQnlOYW1lKGUpO2lmKHQpcmV0dXJuIHQ7Y29uc3QgaT10aGlzLmdldFRyYW5zZm9ybU5vZGVCeU5hbWUoZSk7aWYoaSlyZXR1cm4gaTtjb25zdCBzPXRoaXMuZ2V0TGlnaHRCeU5hbWUoZSk7aWYocylyZXR1cm4gcztjb25zdCByPXRoaXMuZ2V0Q2FtZXJhQnlOYW1lKGUpO2lmKHIpcmV0dXJuIHI7Y29uc3Qgbj10aGlzLmdldEJvbmVCeU5hbWUoZSk7cmV0dXJuIG58fG51bGx9Z2V0TWVzaEJ5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMubWVzaGVzLmxlbmd0aDt0KyspaWYodGhpcy5tZXNoZXNbdF0ubmFtZT09PWUpcmV0dXJuIHRoaXMubWVzaGVzW3RdO3JldHVybiBudWxsfWdldFRyYW5zZm9ybU5vZGVCeU5hbWUoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnRyYW5zZm9ybU5vZGVzLmxlbmd0aDt0KyspaWYodGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XS5uYW1lPT09ZSlyZXR1cm4gdGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XTtyZXR1cm4gbnVsbH1nZXRMYXN0U2tlbGV0b25CeUlkKGUpe2ZvcihsZXQgdD10aGlzLnNrZWxldG9ucy5sZW5ndGgtMTt0Pj0wO3QtLSlpZih0aGlzLnNrZWxldG9uc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMuc2tlbGV0b25zW3RdO3JldHVybiBudWxsfWdldFNrZWxldG9uQnlVbmlxdWVJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMuc2tlbGV0b25zLmxlbmd0aDt0KyspaWYodGhpcy5za2VsZXRvbnNbdF0udW5pcXVlSWQ9PT1lKXJldHVybiB0aGlzLnNrZWxldG9uc1t0XTtyZXR1cm4gbnVsbH1nZXRTa2VsZXRvbkJ5SWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnNrZWxldG9ucy5sZW5ndGg7dCsrKWlmKHRoaXMuc2tlbGV0b25zW3RdLmlkPT09ZSlyZXR1cm4gdGhpcy5za2VsZXRvbnNbdF07cmV0dXJuIG51bGx9Z2V0U2tlbGV0b25CeU5hbWUoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnNrZWxldG9ucy5sZW5ndGg7dCsrKWlmKHRoaXMuc2tlbGV0b25zW3RdLm5hbWU9PT1lKXJldHVybiB0aGlzLnNrZWxldG9uc1t0XTtyZXR1cm4gbnVsbH1nZXRNb3JwaFRhcmdldE1hbmFnZXJCeUlkKGUpe2ZvcihsZXQgdD0wO3Q8dGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzLmxlbmd0aDt0KyspaWYodGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzW3RdLnVuaXF1ZUlkPT09ZSlyZXR1cm4gdGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzW3RdO3JldHVybiBudWxsfWdldE1vcnBoVGFyZ2V0QnlJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMubW9ycGhUYXJnZXRNYW5hZ2Vycy5sZW5ndGg7Kyt0KXtjb25zdCBpPXRoaXMubW9ycGhUYXJnZXRNYW5hZ2Vyc1t0XTtmb3IobGV0IHM9MDtzPGkubnVtVGFyZ2V0czsrK3Mpe2NvbnN0IHI9aS5nZXRUYXJnZXQocyk7aWYoci5pZD09PWUpcmV0dXJuIHJ9fXJldHVybiBudWxsfWdldE1vcnBoVGFyZ2V0QnlOYW1lKGUpe2ZvcihsZXQgdD0wO3Q8dGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzLmxlbmd0aDsrK3Qpe2NvbnN0IGk9dGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzW3RdO2ZvcihsZXQgcz0wO3M8aS5udW1UYXJnZXRzOysrcyl7Y29uc3Qgcj1pLmdldFRhcmdldChzKTtpZihyLm5hbWU9PT1lKXJldHVybiByfX1yZXR1cm4gbnVsbH1nZXRQb3N0UHJvY2Vzc0J5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMucG9zdFByb2Nlc3Nlcy5sZW5ndGg7Kyt0KXtjb25zdCBpPXRoaXMucG9zdFByb2Nlc3Nlc1t0XTtpZihpLm5hbWU9PT1lKXJldHVybiBpfXJldHVybiBudWxsfWlzQWN0aXZlTWVzaChlKXtyZXR1cm4gdGhpcy5fYWN0aXZlTWVzaGVzLmluZGV4T2YoZSkhPT0tMX1nZXQgdWlkKCl7cmV0dXJuIHRoaXMuX3VpZHx8KHRoaXMuX3VpZD1ILlJhbmRvbUlkKCkpLHRoaXMuX3VpZH1hZGRFeHRlcm5hbERhdGEoZSx0KXtyZXR1cm4gdGhpcy5fZXh0ZXJuYWxEYXRhfHwodGhpcy5fZXh0ZXJuYWxEYXRhPW5ldyBjciksdGhpcy5fZXh0ZXJuYWxEYXRhLmFkZChlLHQpfWdldEV4dGVybmFsRGF0YShlKXtyZXR1cm4gdGhpcy5fZXh0ZXJuYWxEYXRhP3RoaXMuX2V4dGVybmFsRGF0YS5nZXQoZSk6bnVsbH1nZXRPckFkZEV4dGVybmFsRGF0YVdpdGhGYWN0b3J5KGUsdCl7cmV0dXJuIHRoaXMuX2V4dGVybmFsRGF0YXx8KHRoaXMuX2V4dGVybmFsRGF0YT1uZXcgY3IpLHRoaXMuX2V4dGVybmFsRGF0YS5nZXRPckFkZFdpdGhGYWN0b3J5KGUsdCl9cmVtb3ZlRXh0ZXJuYWxEYXRhKGUpe3JldHVybiB0aGlzLl9leHRlcm5hbERhdGEucmVtb3ZlKGUpfV9ldmFsdWF0ZVN1Yk1lc2goZSx0LGkscyl7aWYoc3x8ZS5pc0luRnJ1c3R1bSh0aGlzLl9mcnVzdHVtUGxhbmVzKSl7Zm9yKGNvbnN0IG4gb2YgdGhpcy5fZXZhbHVhdGVTdWJNZXNoU3RhZ2Upbi5hY3Rpb24odCxlKTtjb25zdCByPWUuZ2V0TWF0ZXJpYWwoKTtyIT1udWxsJiYoci5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyYmci5nZXRSZW5kZXJUYXJnZXRUZXh0dXJlcyE9bnVsbCYmdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzLmluZGV4T2Yocik9PT0tMSYmKHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5wdXNoKHIpLHRoaXMuX21hdGVyaWFsc1JlbmRlclRhcmdldHMuY29uY2F0V2l0aE5vRHVwbGljYXRlKHIuZ2V0UmVuZGVyVGFyZ2V0VGV4dHVyZXMoKSkpLHRoaXMuX3JlbmRlcmluZ01hbmFnZXIuZGlzcGF0Y2goZSx0LHIpKX19ZnJlZVByb2Nlc3NlZE1hdGVyaWFscygpe3RoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5kaXNwb3NlKCl9Z2V0IGJsb2NrZnJlZUFjdGl2ZU1lc2hlc0FuZFJlbmRlcmluZ0dyb3Vwcygpe3JldHVybiB0aGlzLl9wcmV2ZW50RnJlZUFjdGl2ZU1lc2hlc0FuZFJlbmRlcmluZ0dyb3Vwc31zZXQgYmxvY2tmcmVlQWN0aXZlTWVzaGVzQW5kUmVuZGVyaW5nR3JvdXBzKGUpe3RoaXMuX3ByZXZlbnRGcmVlQWN0aXZlTWVzaGVzQW5kUmVuZGVyaW5nR3JvdXBzIT09ZSYmKGUmJih0aGlzLmZyZWVBY3RpdmVNZXNoZXMoKSx0aGlzLmZyZWVSZW5kZXJpbmdHcm91cHMoKSksdGhpcy5fcHJldmVudEZyZWVBY3RpdmVNZXNoZXNBbmRSZW5kZXJpbmdHcm91cHM9ZSl9ZnJlZUFjdGl2ZU1lc2hlcygpe2lmKCF0aGlzLmJsb2NrZnJlZUFjdGl2ZU1lc2hlc0FuZFJlbmRlcmluZ0dyb3VwcyYmKHRoaXMuX2FjdGl2ZU1lc2hlcy5kaXNwb3NlKCksdGhpcy5hY3RpdmVDYW1lcmEmJnRoaXMuYWN0aXZlQ2FtZXJhLl9hY3RpdmVNZXNoZXMmJnRoaXMuYWN0aXZlQ2FtZXJhLl9hY3RpdmVNZXNoZXMuZGlzcG9zZSgpLHRoaXMuYWN0aXZlQ2FtZXJhcykpZm9yKGxldCBlPTA7ZTx0aGlzLmFjdGl2ZUNhbWVyYXMubGVuZ3RoO2UrKyl7Y29uc3QgdD10aGlzLmFjdGl2ZUNhbWVyYXNbZV07dCYmdC5fYWN0aXZlTWVzaGVzJiZ0Ll9hY3RpdmVNZXNoZXMuZGlzcG9zZSgpfX1mcmVlUmVuZGVyaW5nR3JvdXBzKCl7aWYoIXRoaXMuYmxvY2tmcmVlQWN0aXZlTWVzaGVzQW5kUmVuZGVyaW5nR3JvdXBzJiYodGhpcy5fcmVuZGVyaW5nTWFuYWdlciYmdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5mcmVlUmVuZGVyaW5nR3JvdXBzKCksdGhpcy50ZXh0dXJlcykpZm9yKGxldCBlPTA7ZTx0aGlzLnRleHR1cmVzLmxlbmd0aDtlKyspe2NvbnN0IHQ9dGhpcy50ZXh0dXJlc1tlXTt0JiZ0LnJlbmRlckxpc3QmJnQuZnJlZVJlbmRlcmluZ0dyb3VwcygpfX1faXNJbkludGVybWVkaWF0ZVJlbmRlcmluZygpe3JldHVybiB0aGlzLl9pbnRlcm1lZGlhdGVSZW5kZXJpbmd9ZnJlZXplQWN0aXZlTWVzaGVzKGU9ITEsdCxpLHM9ITAscj0hMSl7cmV0dXJuIHRoaXMuZXhlY3V0ZVdoZW5SZWFkeSgoKT0+e2lmKCF0aGlzLmFjdGl2ZUNhbWVyYSl7aSYmaSgiTm8gYWN0aXZlIGNhbWVyYSBmb3VuZCIpO3JldHVybn1pZih0aGlzLl9mcnVzdHVtUGxhbmVzfHx0aGlzLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCgpLHRoaXMuX2V2YWx1YXRlQWN0aXZlTWVzaGVzKCksdGhpcy5fYWN0aXZlTWVzaGVzRnJvemVuPSEwLHRoaXMuX2FjdGl2ZU1lc2hlc0Zyb3plbkJ1dEtlZXBDbGlwcGluZz1yLHRoaXMuX3NraXBFdmFsdWF0ZUFjdGl2ZU1lc2hlc0NvbXBsZXRlbHk9ZSxzKWZvcihsZXQgbj0wO248dGhpcy5fYWN0aXZlTWVzaGVzLmxlbmd0aDtuKyspdGhpcy5fYWN0aXZlTWVzaGVzLmRhdGFbbl0uX2ZyZWV6ZSgpO3QmJnQoKX0pLHRoaXN9dW5mcmVlemVBY3RpdmVNZXNoZXMoKXtmb3IobGV0IGU9MDtlPHRoaXMubWVzaGVzLmxlbmd0aDtlKyspe2NvbnN0IHQ9dGhpcy5tZXNoZXNbZV07dC5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mbyYmKHQuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2lzQWN0aXZlPSExKX1mb3IobGV0IGU9MDtlPHRoaXMuX2FjdGl2ZU1lc2hlcy5sZW5ndGg7ZSsrKXRoaXMuX2FjdGl2ZU1lc2hlcy5kYXRhW2VdLl91bkZyZWV6ZSgpO3JldHVybiB0aGlzLl9hY3RpdmVNZXNoZXNGcm96ZW49ITEsdGhpc31fZXhlY3V0ZUFjdGl2ZUNvbnRhaW5lckNsZWFudXAoZSl7ISh0aGlzLl9lbmdpbmUuc25hcHNob3RSZW5kZXJpbmcmJnRoaXMuX2VuZ2luZS5zbmFwc2hvdFJlbmRlcmluZ01vZGU9PT0xKSYmdGhpcy5fYWN0aXZlTWVzaGVzRnJvemVuJiZ0aGlzLl9hY3RpdmVNZXNoZXMubGVuZ3RofHx0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5hZGRPbmNlKCgpPT5lLmRpc3Bvc2UoKSl9X2V2YWx1YXRlQWN0aXZlTWVzaGVzKCl7dmFyIGU7aWYodGhpcy5fZW5naW5lLnNuYXBzaG90UmVuZGVyaW5nJiZ0aGlzLl9lbmdpbmUuc25hcHNob3RSZW5kZXJpbmdNb2RlPT09MSl7dGhpcy5fYWN0aXZlTWVzaGVzLmxlbmd0aD4wJiYoKGU9dGhpcy5hY3RpdmVDYW1lcmEpPT09bnVsbHx8ZT09PXZvaWQgMHx8ZS5fYWN0aXZlTWVzaGVzLnJlc2V0KCksdGhpcy5fYWN0aXZlTWVzaGVzLnJlc2V0KCksdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5yZXNldCgpLHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5yZXNldCgpLHRoaXMuX2FjdGl2ZVBhcnRpY2xlU3lzdGVtcy5yZXNldCgpLHRoaXMuX2FjdGl2ZVNrZWxldG9ucy5yZXNldCgpLHRoaXMuX3NvZnR3YXJlU2tpbm5lZE1lc2hlcy5yZXNldCgpKTtyZXR1cm59aWYodGhpcy5fYWN0aXZlTWVzaGVzRnJvemVuJiZ0aGlzLl9hY3RpdmVNZXNoZXMubGVuZ3RoKXtpZighdGhpcy5fc2tpcEV2YWx1YXRlQWN0aXZlTWVzaGVzQ29tcGxldGVseSl7Y29uc3Qgcz10aGlzLl9hY3RpdmVNZXNoZXMubGVuZ3RoO2ZvcihsZXQgcj0wO3I8cztyKyspdGhpcy5fYWN0aXZlTWVzaGVzLmRhdGFbcl0uY29tcHV0ZVdvcmxkTWF0cml4KCl9aWYodGhpcy5fYWN0aXZlUGFydGljbGVTeXN0ZW1zKXtjb25zdCBzPXRoaXMuX2FjdGl2ZVBhcnRpY2xlU3lzdGVtcy5sZW5ndGg7Zm9yKGxldCByPTA7cjxzO3IrKyl0aGlzLl9hY3RpdmVQYXJ0aWNsZVN5c3RlbXMuZGF0YVtyXS5hbmltYXRlKCl9dGhpcy5fcmVuZGVyaW5nTWFuYWdlci5yZXNldFNwcml0ZXMoKTtyZXR1cm59aWYoIXRoaXMuYWN0aXZlQ2FtZXJhKXJldHVybjt0aGlzLm9uQmVmb3JlQWN0aXZlTWVzaGVzRXZhbHVhdGlvbk9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuYWN0aXZlQ2FtZXJhLl9hY3RpdmVNZXNoZXMucmVzZXQoKSx0aGlzLl9hY3RpdmVNZXNoZXMucmVzZXQoKSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnJlc2V0KCksdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzLnJlc2V0KCksdGhpcy5fYWN0aXZlUGFydGljbGVTeXN0ZW1zLnJlc2V0KCksdGhpcy5fYWN0aXZlU2tlbGV0b25zLnJlc2V0KCksdGhpcy5fc29mdHdhcmVTa2lubmVkTWVzaGVzLnJlc2V0KCksdGhpcy5fbWF0ZXJpYWxzUmVuZGVyVGFyZ2V0cy5yZXNldCgpO2Zvcihjb25zdCBzIG9mIHRoaXMuX2JlZm9yZUV2YWx1YXRlQWN0aXZlTWVzaFN0YWdlKXMuYWN0aW9uKCk7Y29uc3QgdD10aGlzLmdldEFjdGl2ZU1lc2hDYW5kaWRhdGVzKCksaT10Lmxlbmd0aDtmb3IobGV0IHM9MDtzPGk7cysrKXtjb25zdCByPXQuZGF0YVtzXTtpZihyLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9jdXJyZW50TE9ESXNVcFRvRGF0ZT0hMSxyLmlzQmxvY2tlZHx8KHRoaXMuX3RvdGFsVmVydGljZXMuYWRkQ291bnQoci5nZXRUb3RhbFZlcnRpY2VzKCksITEpLCFyLmlzUmVhZHkoKXx8IXIuaXNFbmFibGVkKCl8fHIuc2NhbGluZy5oYXNBWmVyb0NvbXBvbmVudCkpY29udGludWU7ci5jb21wdXRlV29ybGRNYXRyaXgoKSxyLmFjdGlvbk1hbmFnZXImJnIuYWN0aW9uTWFuYWdlci5oYXNTcGVjaWZpY1RyaWdnZXJzMigxMiwxMykmJnRoaXMuX21lc2hlc0ZvckludGVyc2VjdGlvbnMucHVzaE5vRHVwbGljYXRlKHIpO2xldCBuPXRoaXMuY3VzdG9tTE9EU2VsZWN0b3I/dGhpcy5jdXN0b21MT0RTZWxlY3RvcihyLHRoaXMuYWN0aXZlQ2FtZXJhKTpyLmdldExPRCh0aGlzLmFjdGl2ZUNhbWVyYSk7aWYoci5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fY3VycmVudExPRD1uLHIuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2N1cnJlbnRMT0RJc1VwVG9EYXRlPSEwLG4hPW51bGwmJihuIT09ciYmbi5iaWxsYm9hcmRNb2RlIT09MCYmbi5jb21wdXRlV29ybGRNYXRyaXgoKSxyLl9wcmVBY3RpdmF0ZSgpLHIuaXNWaXNpYmxlJiZyLnZpc2liaWxpdHk+MCYmci5sYXllck1hc2smdGhpcy5hY3RpdmVDYW1lcmEubGF5ZXJNYXNrJiYodGhpcy5fc2tpcEZydXN0dW1DbGlwcGluZ3x8ci5hbHdheXNTZWxlY3RBc0FjdGl2ZU1lc2h8fHIuaXNJbkZydXN0dW0odGhpcy5fZnJ1c3R1bVBsYW5lcykpKSl7dGhpcy5fYWN0aXZlTWVzaGVzLnB1c2gociksdGhpcy5hY3RpdmVDYW1lcmEuX2FjdGl2ZU1lc2hlcy5wdXNoKHIpLG4hPT1yJiZuLl9hY3RpdmF0ZSh0aGlzLl9yZW5kZXJJZCwhMSk7Zm9yKGNvbnN0IGEgb2YgdGhpcy5fcHJlQWN0aXZlTWVzaFN0YWdlKWEuYWN0aW9uKHIpO3IuX2FjdGl2YXRlKHRoaXMuX3JlbmRlcklkLCExKSYmKHIuaXNBbkluc3RhbmNlP3IuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2FjdEFzUmVndWxhck1lc2gmJihuPXIpOm4uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX29ubHlGb3JJbnN0YW5jZXM9ITEsbi5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5faXNBY3RpdmU9ITAsdGhpcy5fYWN0aXZlTWVzaChyLG4pKSxyLl9wb3N0QWN0aXZhdGUoKX19aWYodGhpcy5wYXJ0aWNsZXNFbmFibGVkKXt0aGlzLm9uQmVmb3JlUGFydGljbGVzUmVuZGVyaW5nT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyk7Zm9yKGxldCBzPTA7czx0aGlzLnBhcnRpY2xlU3lzdGVtcy5sZW5ndGg7cysrKXtjb25zdCByPXRoaXMucGFydGljbGVTeXN0ZW1zW3NdO2lmKCFyLmlzU3RhcnRlZCgpfHwhci5lbWl0dGVyKWNvbnRpbnVlO2NvbnN0IG49ci5lbWl0dGVyOyghbi5wb3NpdGlvbnx8bi5pc0VuYWJsZWQoKSkmJih0aGlzLl9hY3RpdmVQYXJ0aWNsZVN5c3RlbXMucHVzaChyKSxyLmFuaW1hdGUoKSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLmRpc3BhdGNoUGFydGljbGVzKHIpKX10aGlzLm9uQWZ0ZXJQYXJ0aWNsZXNSZW5kZXJpbmdPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX19X2FjdGl2ZU1lc2goZSx0KXt0aGlzLl9za2VsZXRvbnNFbmFibGVkJiZ0LnNrZWxldG9uIT09bnVsbCYmdC5za2VsZXRvbiE9PXZvaWQgMCYmKHRoaXMuX2FjdGl2ZVNrZWxldG9ucy5wdXNoTm9EdXBsaWNhdGUodC5za2VsZXRvbikmJih0LnNrZWxldG9uLnByZXBhcmUoKSx0aGlzLl9hY3RpdmVCb25lcy5hZGRDb3VudCh0LnNrZWxldG9uLmJvbmVzLmxlbmd0aCwhMSkpLHQuY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzfHx0aGlzLl9zb2Z0d2FyZVNraW5uZWRNZXNoZXMucHVzaE5vRHVwbGljYXRlKHQpKTtsZXQgaT1lLmhhc0luc3RhbmNlc3x8ZS5pc0FuSW5zdGFuY2V8fHRoaXMuZGlzcGF0Y2hBbGxTdWJNZXNoZXNPZkFjdGl2ZU1lc2hlc3x8dGhpcy5fc2tpcEZydXN0dW1DbGlwcGluZ3x8dC5hbHdheXNTZWxlY3RBc0FjdGl2ZU1lc2g7aWYodCYmdC5zdWJNZXNoZXMmJnQuc3ViTWVzaGVzLmxlbmd0aD4wKXtjb25zdCBzPXRoaXMuZ2V0QWN0aXZlU3ViTWVzaENhbmRpZGF0ZXModCkscj1zLmxlbmd0aDtpPWl8fHI9PT0xO2ZvcihsZXQgbj0wO248cjtuKyspe2NvbnN0IGE9cy5kYXRhW25dO3RoaXMuX2V2YWx1YXRlU3ViTWVzaChhLHQsZSxpKX19fXVwZGF0ZVRyYW5zZm9ybU1hdHJpeChlKXtpZih0aGlzLmFjdGl2ZUNhbWVyYSlpZih0aGlzLmFjdGl2ZUNhbWVyYS5fcmVuZGVyaW5nTXVsdGl2aWV3KXtjb25zdCB0PXRoaXMuYWN0aXZlQ2FtZXJhLl9yaWdDYW1lcmFzWzBdLGk9dGhpcy5hY3RpdmVDYW1lcmEuX3JpZ0NhbWVyYXNbMV07dGhpcy5zZXRUcmFuc2Zvcm1NYXRyaXgodC5nZXRWaWV3TWF0cml4KCksdC5nZXRQcm9qZWN0aW9uTWF0cml4KGUpLGkuZ2V0Vmlld01hdHJpeCgpLGkuZ2V0UHJvamVjdGlvbk1hdHJpeChlKSl9ZWxzZSB0aGlzLnNldFRyYW5zZm9ybU1hdHJpeCh0aGlzLmFjdGl2ZUNhbWVyYS5nZXRWaWV3TWF0cml4KCksdGhpcy5hY3RpdmVDYW1lcmEuZ2V0UHJvamVjdGlvbk1hdHJpeChlKSl9X2JpbmRGcmFtZUJ1ZmZlcihlLHQ9ITApe2UmJmUuX211bHRpdmlld1RleHR1cmU/ZS5fbXVsdGl2aWV3VGV4dHVyZS5fYmluZEZyYW1lQnVmZmVyKCk6ZSYmZS5vdXRwdXRSZW5kZXJUYXJnZXQ/ZS5vdXRwdXRSZW5kZXJUYXJnZXQuX2JpbmRGcmFtZUJ1ZmZlcigpOnRoaXMuX2VuZ2luZS5fY3VycmVudEZyYW1lQnVmZmVySXNEZWZhdWx0RnJhbWVCdWZmZXIoKXx8dGhpcy5fZW5naW5lLnJlc3RvcmVEZWZhdWx0RnJhbWVidWZmZXIoKSx0JiZ0aGlzLl9jbGVhckZyYW1lQnVmZmVyKGUpfV9jbGVhckZyYW1lQnVmZmVyKGUpe2lmKCEoZSYmZS5fbXVsdGl2aWV3VGV4dHVyZSkpaWYoZSYmZS5vdXRwdXRSZW5kZXJUYXJnZXQmJiFlLl9yZW5kZXJpbmdNdWx0aXZpZXcpe2NvbnN0IHQ9ZS5vdXRwdXRSZW5kZXJUYXJnZXQ7dC5vbkNsZWFyT2JzZXJ2YWJsZS5oYXNPYnNlcnZlcnMoKT90Lm9uQ2xlYXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzLl9lbmdpbmUpOnQuc2tpcEluaXRpYWxDbGVhcnx8KHRoaXMuYXV0b0NsZWFyJiZ0aGlzLl9lbmdpbmUuY2xlYXIodC5jbGVhckNvbG9yfHx0aGlzLmNsZWFyQ29sb3IsIXQuX2NsZWFyZWQsITAsITApLHQuX2NsZWFyZWQ9ITApfWVsc2UgdGhpcy5fZGVmYXVsdEZyYW1lQnVmZmVyQ2xlYXJlZD90aGlzLl9lbmdpbmUuY2xlYXIobnVsbCwhMSwhMCwhMCk6KHRoaXMuX2RlZmF1bHRGcmFtZUJ1ZmZlckNsZWFyZWQ9ITAsdGhpcy5fY2xlYXIoKSl9X3JlbmRlckZvckNhbWVyYShlLHQsaT0hMCl7dmFyIHMscixuO2lmKGUmJmUuX3NraXBSZW5kZXJpbmcpcmV0dXJuO2NvbnN0IGE9dGhpcy5fZW5naW5lO2lmKHRoaXMuX2FjdGl2ZUNhbWVyYT1lLCF0aGlzLmFjdGl2ZUNhbWVyYSl0aHJvdyBuZXcgRXJyb3IoIkFjdGl2ZSBjYW1lcmEgbm90IHNldCIpO2lmKGEuc2V0Vmlld3BvcnQodGhpcy5hY3RpdmVDYW1lcmEudmlld3BvcnQpLHRoaXMucmVzZXRDYWNoZWRNYXRlcmlhbCgpLHRoaXMuX3JlbmRlcklkKyssIXRoaXMucHJlUGFzcyYmaSl7bGV0IGg9ITA7ZS5fcmVuZGVyaW5nTXVsdGl2aWV3JiZlLm91dHB1dFJlbmRlclRhcmdldCYmKGg9ZS5vdXRwdXRSZW5kZXJUYXJnZXQuc2tpcEluaXRpYWxDbGVhcix0aGlzLmF1dG9DbGVhciYmKGUub3V0cHV0UmVuZGVyVGFyZ2V0LnNraXBJbml0aWFsQ2xlYXI9ITEpKSx0aGlzLl9iaW5kRnJhbWVCdWZmZXIodGhpcy5fYWN0aXZlQ2FtZXJhKSxlLl9yZW5kZXJpbmdNdWx0aXZpZXcmJmUub3V0cHV0UmVuZGVyVGFyZ2V0JiYoZS5vdXRwdXRSZW5kZXJUYXJnZXQuc2tpcEluaXRpYWxDbGVhcj1oKX10aGlzLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCgpLHRoaXMub25CZWZvcmVDYW1lcmFSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzLmFjdGl2ZUNhbWVyYSksdGhpcy5fZXZhbHVhdGVBY3RpdmVNZXNoZXMoKTtmb3IobGV0IGg9MDtoPHRoaXMuX3NvZnR3YXJlU2tpbm5lZE1lc2hlcy5sZW5ndGg7aCsrKXtjb25zdCBsPXRoaXMuX3NvZnR3YXJlU2tpbm5lZE1lc2hlcy5kYXRhW2hdO2wuYXBwbHlTa2VsZXRvbihsLnNrZWxldG9uKX10aGlzLm9uQmVmb3JlUmVuZGVyVGFyZ2V0c1JlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX3JlbmRlclRhcmdldHMuY29uY2F0V2l0aE5vRHVwbGljYXRlKHRoaXMuX21hdGVyaWFsc1JlbmRlclRhcmdldHMpLGUuY3VzdG9tUmVuZGVyVGFyZ2V0cyYmZS5jdXN0b21SZW5kZXJUYXJnZXRzLmxlbmd0aD4wJiZ0aGlzLl9yZW5kZXJUYXJnZXRzLmNvbmNhdFdpdGhOb0R1cGxpY2F0ZShlLmN1c3RvbVJlbmRlclRhcmdldHMpLHQmJnQuY3VzdG9tUmVuZGVyVGFyZ2V0cyYmdC5jdXN0b21SZW5kZXJUYXJnZXRzLmxlbmd0aD4wJiZ0aGlzLl9yZW5kZXJUYXJnZXRzLmNvbmNhdFdpdGhOb0R1cGxpY2F0ZSh0LmN1c3RvbVJlbmRlclRhcmdldHMpLHRoaXMuZW52aXJvbm1lbnRUZXh0dXJlJiZ0aGlzLmVudmlyb25tZW50VGV4dHVyZS5pc1JlbmRlclRhcmdldCYmdGhpcy5fcmVuZGVyVGFyZ2V0cy5wdXNoTm9EdXBsaWNhdGUodGhpcy5lbnZpcm9ubWVudFRleHR1cmUpO2Zvcihjb25zdCBoIG9mIHRoaXMuX2dhdGhlckFjdGl2ZUNhbWVyYVJlbmRlclRhcmdldHNTdGFnZSloLmFjdGlvbih0aGlzLl9yZW5kZXJUYXJnZXRzKTtsZXQgbz0hMTtpZih0aGlzLnJlbmRlclRhcmdldHNFbmFibGVkKXtpZih0aGlzLl9pbnRlcm1lZGlhdGVSZW5kZXJpbmc9ITAsdGhpcy5fcmVuZGVyVGFyZ2V0cy5sZW5ndGg+MCl7SC5TdGFydFBlcmZvcm1hbmNlQ291bnRlcigiUmVuZGVyIHRhcmdldHMiLHRoaXMuX3JlbmRlclRhcmdldHMubGVuZ3RoPjApO2ZvcihsZXQgaD0wO2g8dGhpcy5fcmVuZGVyVGFyZ2V0cy5sZW5ndGg7aCsrKXtjb25zdCBsPXRoaXMuX3JlbmRlclRhcmdldHMuZGF0YVtoXTtpZihsLl9zaG91bGRSZW5kZXIoKSl7dGhpcy5fcmVuZGVySWQrKztjb25zdCB1PWwuYWN0aXZlQ2FtZXJhJiZsLmFjdGl2ZUNhbWVyYSE9PXRoaXMuYWN0aXZlQ2FtZXJhO2wucmVuZGVyKHUsdGhpcy5kdW1wTmV4dFJlbmRlclRhcmdldHMpLG89ITB9fUguRW5kUGVyZm9ybWFuY2VDb3VudGVyKCJSZW5kZXIgdGFyZ2V0cyIsdGhpcy5fcmVuZGVyVGFyZ2V0cy5sZW5ndGg+MCksdGhpcy5fcmVuZGVySWQrK31mb3IoY29uc3QgaCBvZiB0aGlzLl9jYW1lcmFEcmF3UmVuZGVyVGFyZ2V0U3RhZ2Upbz1oLmFjdGlvbih0aGlzLmFjdGl2ZUNhbWVyYSl8fG87dGhpcy5faW50ZXJtZWRpYXRlUmVuZGVyaW5nPSExfXRoaXMuX2VuZ2luZS5jdXJyZW50UmVuZGVyUGFzc0lkPShuPShyPShzPWUub3V0cHV0UmVuZGVyVGFyZ2V0KT09PW51bGx8fHM9PT12b2lkIDA/dm9pZCAwOnMucmVuZGVyUGFzc0lkKSE9PW51bGwmJnIhPT12b2lkIDA/cjplLnJlbmRlclBhc3NJZCkhPT1udWxsJiZuIT09dm9pZCAwP246MCxvJiYhdGhpcy5wcmVQYXNzJiZ0aGlzLl9iaW5kRnJhbWVCdWZmZXIodGhpcy5fYWN0aXZlQ2FtZXJhLCExKSx0aGlzLm9uQWZ0ZXJSZW5kZXJUYXJnZXRzUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5wb3N0UHJvY2Vzc01hbmFnZXImJiFlLl9tdWx0aXZpZXdUZXh0dXJlJiYhdGhpcy5wcmVQYXNzJiZ0aGlzLnBvc3RQcm9jZXNzTWFuYWdlci5fcHJlcGFyZUZyYW1lKCk7Zm9yKGNvbnN0IGggb2YgdGhpcy5fYmVmb3JlQ2FtZXJhRHJhd1N0YWdlKWguYWN0aW9uKHRoaXMuYWN0aXZlQ2FtZXJhKTt0aGlzLm9uQmVmb3JlRHJhd1BoYXNlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksYS5zbmFwc2hvdFJlbmRlcmluZyYmYS5zbmFwc2hvdFJlbmRlcmluZ01vZGU9PT0xJiZ0aGlzLmZpbmFsaXplU2NlbmVVYm8oKSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnJlbmRlcihudWxsLG51bGwsITAsITApLHRoaXMub25BZnRlckRyYXdQaGFzZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2Zvcihjb25zdCBoIG9mIHRoaXMuX2FmdGVyQ2FtZXJhRHJhd1N0YWdlKWguYWN0aW9uKHRoaXMuYWN0aXZlQ2FtZXJhKTtpZih0aGlzLnBvc3RQcm9jZXNzTWFuYWdlciYmIWUuX211bHRpdmlld1RleHR1cmUpe2NvbnN0IGg9ZS5vdXRwdXRSZW5kZXJUYXJnZXQ/ZS5vdXRwdXRSZW5kZXJUYXJnZXQucmVuZGVyVGFyZ2V0OnZvaWQgMDt0aGlzLnBvc3RQcm9jZXNzTWFuYWdlci5fZmluYWxpemVGcmFtZShlLmlzSW50ZXJtZWRpYXRlLGgpfWZvcihjb25zdCBoIG9mIHRoaXMuX2FmdGVyQ2FtZXJhUG9zdFByb2Nlc3NTdGFnZSloLmFjdGlvbih0aGlzLmFjdGl2ZUNhbWVyYSk7dGhpcy5fcmVuZGVyVGFyZ2V0cy5yZXNldCgpLHRoaXMub25BZnRlckNhbWVyYVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMuYWN0aXZlQ2FtZXJhKX1fcHJvY2Vzc1N1YkNhbWVyYXMoZSx0PSEwKXtpZihlLmNhbWVyYVJpZ01vZGU9PT0wfHxlLl9yZW5kZXJpbmdNdWx0aXZpZXcpe2UuX3JlbmRlcmluZ011bHRpdmlldyYmIXRoaXMuX211bHRpdmlld1NjZW5lVWJvJiZ0aGlzLl9jcmVhdGVNdWx0aXZpZXdVYm8oKSx0aGlzLl9yZW5kZXJGb3JDYW1lcmEoZSx2b2lkIDAsdCksdGhpcy5vbkFmdGVyUmVuZGVyQ2FtZXJhT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSk7cmV0dXJufWlmKGUuX3VzZU11bHRpdmlld1RvU2luZ2xlVmlldyl0aGlzLl9yZW5kZXJNdWx0aXZpZXdUb1NpbmdsZVZpZXcoZSk7ZWxzZXt0aGlzLm9uQmVmb3JlQ2FtZXJhUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSk7Zm9yKGxldCBpPTA7aTxlLl9yaWdDYW1lcmFzLmxlbmd0aDtpKyspdGhpcy5fcmVuZGVyRm9yQ2FtZXJhKGUuX3JpZ0NhbWVyYXNbaV0sZSl9dGhpcy5fYWN0aXZlQ2FtZXJhPWUsdGhpcy51cGRhdGVUcmFuc2Zvcm1NYXRyaXgoKSx0aGlzLm9uQWZ0ZXJSZW5kZXJDYW1lcmFPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKX1fY2hlY2tJbnRlcnNlY3Rpb25zKCl7Zm9yKGxldCBlPTA7ZTx0aGlzLl9tZXNoZXNGb3JJbnRlcnNlY3Rpb25zLmxlbmd0aDtlKyspe2NvbnN0IHQ9dGhpcy5fbWVzaGVzRm9ySW50ZXJzZWN0aW9ucy5kYXRhW2VdO2lmKHQuYWN0aW9uTWFuYWdlcilmb3IobGV0IGk9MDt0LmFjdGlvbk1hbmFnZXImJmk8dC5hY3Rpb25NYW5hZ2VyLmFjdGlvbnMubGVuZ3RoO2krKyl7Y29uc3Qgcz10LmFjdGlvbk1hbmFnZXIuYWN0aW9uc1tpXTtpZihzLnRyaWdnZXI9PT0xMnx8cy50cmlnZ2VyPT09MTMpe2NvbnN0IHI9cy5nZXRUcmlnZ2VyUGFyYW1ldGVyKCksbj1yLm1lc2g/ci5tZXNoOnIsYT1uLmludGVyc2VjdHNNZXNoKHQsci51c2VQcmVjaXNlSW50ZXJzZWN0aW9uKSxvPXQuX2ludGVyc2VjdGlvbnNJblByb2dyZXNzLmluZGV4T2Yobik7YSYmbz09PS0xP3MudHJpZ2dlcj09PTEyPyhzLl9leGVjdXRlQ3VycmVudChWZS5DcmVhdGVOZXcodCx2b2lkIDAsbikpLHQuX2ludGVyc2VjdGlvbnNJblByb2dyZXNzLnB1c2gobikpOnMudHJpZ2dlcj09PTEzJiZ0Ll9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5wdXNoKG4pOiFhJiZvPi0xJiYocy50cmlnZ2VyPT09MTMmJnMuX2V4ZWN1dGVDdXJyZW50KFZlLkNyZWF0ZU5ldyh0LHZvaWQgMCxuKSksKCF0LmFjdGlvbk1hbmFnZXIuaGFzU3BlY2lmaWNUcmlnZ2VyKDEzLGg9Pntjb25zdCBsPWgubWVzaD9oLm1lc2g6aDtyZXR1cm4gbj09PWx9KXx8cy50cmlnZ2VyPT09MTMpJiZ0Ll9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5zcGxpY2UobywxKSl9fX19X2FkdmFuY2VQaHlzaWNzRW5naW5lU3RlcChlKXt9X2FuaW1hdGUoKXt9YW5pbWF0ZSgpe2lmKHRoaXMuX2VuZ2luZS5pc0RldGVybWluaXN0aWNMb2NrU3RlcCgpKXtsZXQgZT1NYXRoLm1heChuZS5NaW5EZWx0YVRpbWUsTWF0aC5taW4odGhpcy5fZW5naW5lLmdldERlbHRhVGltZSgpLG5lLk1heERlbHRhVGltZSkpK3RoaXMuX3RpbWVBY2N1bXVsYXRvcjtjb25zdCB0PXRoaXMuX2VuZ2luZS5nZXRUaW1lU3RlcCgpLGk9MWUzL3QvMWUzO2xldCBzPTA7Y29uc3Qgcj10aGlzLl9lbmdpbmUuZ2V0TG9ja3N0ZXBNYXhTdGVwcygpO2xldCBuPU1hdGguZmxvb3IoZS90KTtmb3Iobj1NYXRoLm1pbihuLHIpO2U+MCYmczxuOyl0aGlzLm9uQmVmb3JlU3RlcE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX2FuaW1hdGlvblJhdGlvPXQqaSx0aGlzLl9hbmltYXRlKCksdGhpcy5vbkFmdGVyQW5pbWF0aW9uc09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMucGh5c2ljc0VuYWJsZWQmJnRoaXMuX2FkdmFuY2VQaHlzaWNzRW5naW5lU3RlcCh0KSx0aGlzLm9uQWZ0ZXJTdGVwT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5fY3VycmVudFN0ZXBJZCsrLHMrKyxlLT10O3RoaXMuX3RpbWVBY2N1bXVsYXRvcj1lPDA/MDplfWVsc2V7Y29uc3QgZT10aGlzLnVzZUNvbnN0YW50QW5pbWF0aW9uRGVsdGFUaW1lPzE2Ok1hdGgubWF4KG5lLk1pbkRlbHRhVGltZSxNYXRoLm1pbih0aGlzLl9lbmdpbmUuZ2V0RGVsdGFUaW1lKCksbmUuTWF4RGVsdGFUaW1lKSk7dGhpcy5fYW5pbWF0aW9uUmF0aW89ZSooNjAvMWUzKSx0aGlzLl9hbmltYXRlKCksdGhpcy5vbkFmdGVyQW5pbWF0aW9uc09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMucGh5c2ljc0VuYWJsZWQmJnRoaXMuX2FkdmFuY2VQaHlzaWNzRW5naW5lU3RlcChlKX19X2NsZWFyKCl7KHRoaXMuYXV0b0NsZWFyRGVwdGhBbmRTdGVuY2lsfHx0aGlzLmF1dG9DbGVhcikmJnRoaXMuX2VuZ2luZS5jbGVhcih0aGlzLmNsZWFyQ29sb3IsdGhpcy5hdXRvQ2xlYXJ8fHRoaXMuZm9yY2VXaXJlZnJhbWV8fHRoaXMuZm9yY2VQb2ludHNDbG91ZCx0aGlzLmF1dG9DbGVhckRlcHRoQW5kU3RlbmNpbCx0aGlzLmF1dG9DbGVhckRlcHRoQW5kU3RlbmNpbCl9X2NoZWNrQ2FtZXJhUmVuZGVyVGFyZ2V0KGUpe3ZhciB0O2lmKGUhPW51bGwmJmUub3V0cHV0UmVuZGVyVGFyZ2V0JiYhKGUhPW51bGwmJmUuaXNSaWdDYW1lcmEpJiYoZS5vdXRwdXRSZW5kZXJUYXJnZXQuX2NsZWFyZWQ9ITEpLCEoKHQ9ZT09bnVsbD92b2lkIDA6ZS5yaWdDYW1lcmFzKT09PW51bGx8fHQ9PT12b2lkIDApJiZ0Lmxlbmd0aClmb3IobGV0IGk9MDtpPGUucmlnQ2FtZXJhcy5sZW5ndGg7KytpKXtjb25zdCBzPWUucmlnQ2FtZXJhc1tpXS5vdXRwdXRSZW5kZXJUYXJnZXQ7cyYmKHMuX2NsZWFyZWQ9ITEpfX1yZXNldERyYXdDYWNoZShlKXtpZih0aGlzLm1lc2hlcylmb3IoY29uc3QgdCBvZiB0aGlzLm1lc2hlcyl0LnJlc2V0RHJhd0NhY2hlKGUpfXJlbmRlcihlPSEwLHQ9ITEpe3ZhciBpLHMscjtpZih0aGlzLmlzRGlzcG9zZWQpcmV0dXJuO3RoaXMub25SZWFkeU9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkmJnRoaXMuX2V4ZWN1dGVXaGVuUmVhZHlUaW1lb3V0SWQ9PT1udWxsJiZ0aGlzLl9jaGVja0lzUmVhZHkoKSx0aGlzLl9mcmFtZUlkKyssdGhpcy5fZGVmYXVsdEZyYW1lQnVmZmVyQ2xlYXJlZD0hMSx0aGlzLl9jaGVja0NhbWVyYVJlbmRlclRhcmdldCh0aGlzLmFjdGl2ZUNhbWVyYSksISgoaT10aGlzLmFjdGl2ZUNhbWVyYXMpPT09bnVsbHx8aT09PXZvaWQgMCkmJmkubGVuZ3RoJiZ0aGlzLmFjdGl2ZUNhbWVyYXMuZm9yRWFjaCh0aGlzLl9jaGVja0NhbWVyYVJlbmRlclRhcmdldCksdGhpcy5fcmVnaXN0ZXJUcmFuc2llbnRDb21wb25lbnRzKCksdGhpcy5fYWN0aXZlUGFydGljbGVzLmZldGNoTmV3RnJhbWUoKSx0aGlzLl90b3RhbFZlcnRpY2VzLmZldGNoTmV3RnJhbWUoKSx0aGlzLl9hY3RpdmVJbmRpY2VzLmZldGNoTmV3RnJhbWUoKSx0aGlzLl9hY3RpdmVCb25lcy5mZXRjaE5ld0ZyYW1lKCksdGhpcy5fbWVzaGVzRm9ySW50ZXJzZWN0aW9ucy5yZXNldCgpLHRoaXMucmVzZXRDYWNoZWRNYXRlcmlhbCgpLHRoaXMub25CZWZvcmVBbmltYXRpb25zT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5hY3Rpb25NYW5hZ2VyJiZ0aGlzLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoMTEpLHR8fHRoaXMuYW5pbWF0ZSgpO2Zvcihjb25zdCBvIG9mIHRoaXMuX2JlZm9yZUNhbWVyYVVwZGF0ZVN0YWdlKW8uYWN0aW9uKCk7aWYoZSl7aWYodGhpcy5hY3RpdmVDYW1lcmFzJiZ0aGlzLmFjdGl2ZUNhbWVyYXMubGVuZ3RoPjApZm9yKGxldCBvPTA7bzx0aGlzLmFjdGl2ZUNhbWVyYXMubGVuZ3RoO28rKyl7Y29uc3QgaD10aGlzLmFjdGl2ZUNhbWVyYXNbb107aWYoaC51cGRhdGUoKSxoLmNhbWVyYVJpZ01vZGUhPT0wKWZvcihsZXQgbD0wO2w8aC5fcmlnQ2FtZXJhcy5sZW5ndGg7bCsrKWguX3JpZ0NhbWVyYXNbbF0udXBkYXRlKCl9ZWxzZSBpZih0aGlzLmFjdGl2ZUNhbWVyYSYmKHRoaXMuYWN0aXZlQ2FtZXJhLnVwZGF0ZSgpLHRoaXMuYWN0aXZlQ2FtZXJhLmNhbWVyYVJpZ01vZGUhPT0wKSlmb3IobGV0IG89MDtvPHRoaXMuYWN0aXZlQ2FtZXJhLl9yaWdDYW1lcmFzLmxlbmd0aDtvKyspdGhpcy5hY3RpdmVDYW1lcmEuX3JpZ0NhbWVyYXNbb10udXBkYXRlKCl9dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2NvbnN0IG49dGhpcy5nZXRFbmdpbmUoKTt0aGlzLm9uQmVmb3JlUmVuZGVyVGFyZ2V0c1JlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2NvbnN0IGE9ISgocz10aGlzLmFjdGl2ZUNhbWVyYXMpPT09bnVsbHx8cz09PXZvaWQgMCkmJnMubGVuZ3RoP3RoaXMuYWN0aXZlQ2FtZXJhc1swXTp0aGlzLmFjdGl2ZUNhbWVyYTtpZih0aGlzLnJlbmRlclRhcmdldHNFbmFibGVkKXtILlN0YXJ0UGVyZm9ybWFuY2VDb3VudGVyKCJDdXN0b20gcmVuZGVyIHRhcmdldHMiLHRoaXMuY3VzdG9tUmVuZGVyVGFyZ2V0cy5sZW5ndGg+MCksdGhpcy5faW50ZXJtZWRpYXRlUmVuZGVyaW5nPSEwO2ZvcihsZXQgbz0wO288dGhpcy5jdXN0b21SZW5kZXJUYXJnZXRzLmxlbmd0aDtvKyspe2NvbnN0IGg9dGhpcy5jdXN0b21SZW5kZXJUYXJnZXRzW29dO2lmKGguX3Nob3VsZFJlbmRlcigpKXtpZih0aGlzLl9yZW5kZXJJZCsrLHRoaXMuYWN0aXZlQ2FtZXJhPWguYWN0aXZlQ2FtZXJhfHx0aGlzLmFjdGl2ZUNhbWVyYSwhdGhpcy5hY3RpdmVDYW1lcmEpdGhyb3cgbmV3IEVycm9yKCJBY3RpdmUgY2FtZXJhIG5vdCBzZXQiKTtuLnNldFZpZXdwb3J0KHRoaXMuYWN0aXZlQ2FtZXJhLnZpZXdwb3J0KSx0aGlzLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCgpLGgucmVuZGVyKGEhPT10aGlzLmFjdGl2ZUNhbWVyYSx0aGlzLmR1bXBOZXh0UmVuZGVyVGFyZ2V0cyl9fUguRW5kUGVyZm9ybWFuY2VDb3VudGVyKCJDdXN0b20gcmVuZGVyIHRhcmdldHMiLHRoaXMuY3VzdG9tUmVuZGVyVGFyZ2V0cy5sZW5ndGg+MCksdGhpcy5faW50ZXJtZWRpYXRlUmVuZGVyaW5nPSExLHRoaXMuX3JlbmRlcklkKyt9dGhpcy5fZW5naW5lLmN1cnJlbnRSZW5kZXJQYXNzSWQ9KHI9YT09bnVsbD92b2lkIDA6YS5yZW5kZXJQYXNzSWQpIT09bnVsbCYmciE9PXZvaWQgMD9yOjAsdGhpcy5hY3RpdmVDYW1lcmE9YSx0aGlzLl9hY3RpdmVDYW1lcmEmJnRoaXMuX2FjdGl2ZUNhbWVyYS5jYW1lcmFSaWdNb2RlIT09MjImJiF0aGlzLnByZVBhc3MmJnRoaXMuX2JpbmRGcmFtZUJ1ZmZlcih0aGlzLl9hY3RpdmVDYW1lcmEsITEpLHRoaXMub25BZnRlclJlbmRlclRhcmdldHNSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKTtmb3IoY29uc3QgbyBvZiB0aGlzLl9iZWZvcmVDbGVhclN0YWdlKW8uYWN0aW9uKCk7dGhpcy5fY2xlYXJGcmFtZUJ1ZmZlcih0aGlzLmFjdGl2ZUNhbWVyYSk7Zm9yKGNvbnN0IG8gb2YgdGhpcy5fZ2F0aGVyUmVuZGVyVGFyZ2V0c1N0YWdlKW8uYWN0aW9uKHRoaXMuX3JlbmRlclRhcmdldHMpO2lmKHRoaXMuYWN0aXZlQ2FtZXJhcyYmdGhpcy5hY3RpdmVDYW1lcmFzLmxlbmd0aD4wKWZvcihsZXQgbz0wO288dGhpcy5hY3RpdmVDYW1lcmFzLmxlbmd0aDtvKyspdGhpcy5fcHJvY2Vzc1N1YkNhbWVyYXModGhpcy5hY3RpdmVDYW1lcmFzW29dLG8+MCk7ZWxzZXtpZighdGhpcy5hY3RpdmVDYW1lcmEpdGhyb3cgbmV3IEVycm9yKCJObyBjYW1lcmEgZGVmaW5lZCIpO3RoaXMuX3Byb2Nlc3NTdWJDYW1lcmFzKHRoaXMuYWN0aXZlQ2FtZXJhLCEhdGhpcy5hY3RpdmVDYW1lcmEub3V0cHV0UmVuZGVyVGFyZ2V0KX10aGlzLl9jaGVja0ludGVyc2VjdGlvbnMoKTtmb3IoY29uc3QgbyBvZiB0aGlzLl9hZnRlclJlbmRlclN0YWdlKW8uYWN0aW9uKCk7aWYodGhpcy5hZnRlclJlbmRlciYmdGhpcy5hZnRlclJlbmRlcigpLHRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX3RvQmVEaXNwb3NlZC5sZW5ndGgpe2ZvcihsZXQgbz0wO288dGhpcy5fdG9CZURpc3Bvc2VkLmxlbmd0aDtvKyspe2NvbnN0IGg9dGhpcy5fdG9CZURpc3Bvc2VkW29dO2gmJmguZGlzcG9zZSgpfXRoaXMuX3RvQmVEaXNwb3NlZC5sZW5ndGg9MH10aGlzLmR1bXBOZXh0UmVuZGVyVGFyZ2V0cyYmKHRoaXMuZHVtcE5leHRSZW5kZXJUYXJnZXRzPSExKSx0aGlzLl9hY3RpdmVCb25lcy5hZGRDb3VudCgwLCEwKSx0aGlzLl9hY3RpdmVJbmRpY2VzLmFkZENvdW50KDAsITApLHRoaXMuX2FjdGl2ZVBhcnRpY2xlcy5hZGRDb3VudCgwLCEwKSx0aGlzLl9lbmdpbmUucmVzdG9yZURlZmF1bHRGcmFtZWJ1ZmZlcigpfWZyZWV6ZU1hdGVyaWFscygpe2ZvcihsZXQgZT0wO2U8dGhpcy5tYXRlcmlhbHMubGVuZ3RoO2UrKyl0aGlzLm1hdGVyaWFsc1tlXS5mcmVlemUoKX11bmZyZWV6ZU1hdGVyaWFscygpe2ZvcihsZXQgZT0wO2U8dGhpcy5tYXRlcmlhbHMubGVuZ3RoO2UrKyl0aGlzLm1hdGVyaWFsc1tlXS51bmZyZWV6ZSgpfWRpc3Bvc2UoKXtpZih0aGlzLmlzRGlzcG9zZWQpcmV0dXJuO3RoaXMuYmVmb3JlUmVuZGVyPW51bGwsdGhpcy5hZnRlclJlbmRlcj1udWxsLHRoaXMubWV0YWRhdGE9bnVsbCx0aGlzLnNrZWxldG9ucy5sZW5ndGg9MCx0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlcnMubGVuZ3RoPTAsdGhpcy5fdHJhbnNpZW50Q29tcG9uZW50cy5sZW5ndGg9MCx0aGlzLl9pc1JlYWR5Rm9yTWVzaFN0YWdlLmNsZWFyKCksdGhpcy5fYmVmb3JlRXZhbHVhdGVBY3RpdmVNZXNoU3RhZ2UuY2xlYXIoKSx0aGlzLl9ldmFsdWF0ZVN1Yk1lc2hTdGFnZS5jbGVhcigpLHRoaXMuX3ByZUFjdGl2ZU1lc2hTdGFnZS5jbGVhcigpLHRoaXMuX2NhbWVyYURyYXdSZW5kZXJUYXJnZXRTdGFnZS5jbGVhcigpLHRoaXMuX2JlZm9yZUNhbWVyYURyYXdTdGFnZS5jbGVhcigpLHRoaXMuX2JlZm9yZVJlbmRlclRhcmdldERyYXdTdGFnZS5jbGVhcigpLHRoaXMuX2JlZm9yZVJlbmRlcmluZ0dyb3VwRHJhd1N0YWdlLmNsZWFyKCksdGhpcy5fYmVmb3JlUmVuZGVyaW5nTWVzaFN0YWdlLmNsZWFyKCksdGhpcy5fYWZ0ZXJSZW5kZXJpbmdNZXNoU3RhZ2UuY2xlYXIoKSx0aGlzLl9hZnRlclJlbmRlcmluZ0dyb3VwRHJhd1N0YWdlLmNsZWFyKCksdGhpcy5fYWZ0ZXJDYW1lcmFEcmF3U3RhZ2UuY2xlYXIoKSx0aGlzLl9hZnRlclJlbmRlclRhcmdldERyYXdTdGFnZS5jbGVhcigpLHRoaXMuX2FmdGVyUmVuZGVyU3RhZ2UuY2xlYXIoKSx0aGlzLl9iZWZvcmVDYW1lcmFVcGRhdGVTdGFnZS5jbGVhcigpLHRoaXMuX2JlZm9yZUNsZWFyU3RhZ2UuY2xlYXIoKSx0aGlzLl9nYXRoZXJSZW5kZXJUYXJnZXRzU3RhZ2UuY2xlYXIoKSx0aGlzLl9nYXRoZXJBY3RpdmVDYW1lcmFSZW5kZXJUYXJnZXRzU3RhZ2UuY2xlYXIoKSx0aGlzLl9wb2ludGVyTW92ZVN0YWdlLmNsZWFyKCksdGhpcy5fcG9pbnRlckRvd25TdGFnZS5jbGVhcigpLHRoaXMuX3BvaW50ZXJVcFN0YWdlLmNsZWFyKCksdGhpcy5pbXBvcnRlZE1lc2hlc0ZpbGVzPW5ldyBBcnJheSx0aGlzLnN0b3BBbGxBbmltYXRpb25zJiZ0aGlzLnN0b3BBbGxBbmltYXRpb25zKCksdGhpcy5yZXNldENhY2hlZE1hdGVyaWFsKCksdGhpcy5hY3RpdmVDYW1lcmEmJih0aGlzLmFjdGl2ZUNhbWVyYS5fYWN0aXZlTWVzaGVzLmRpc3Bvc2UoKSx0aGlzLmFjdGl2ZUNhbWVyYT1udWxsKSx0aGlzLmFjdGl2ZUNhbWVyYXM9bnVsbCx0aGlzLl9hY3RpdmVNZXNoZXMuZGlzcG9zZSgpLHRoaXMuX3JlbmRlcmluZ01hbmFnZXIuZGlzcG9zZSgpLHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5kaXNwb3NlKCksdGhpcy5fYWN0aXZlUGFydGljbGVTeXN0ZW1zLmRpc3Bvc2UoKSx0aGlzLl9hY3RpdmVTa2VsZXRvbnMuZGlzcG9zZSgpLHRoaXMuX3NvZnR3YXJlU2tpbm5lZE1lc2hlcy5kaXNwb3NlKCksdGhpcy5fcmVuZGVyVGFyZ2V0cy5kaXNwb3NlKCksdGhpcy5fbWF0ZXJpYWxzUmVuZGVyVGFyZ2V0cy5kaXNwb3NlKCksdGhpcy5fcmVnaXN0ZXJlZEZvckxhdGVBbmltYXRpb25CaW5kaW5ncy5kaXNwb3NlKCksdGhpcy5fbWVzaGVzRm9ySW50ZXJzZWN0aW9ucy5kaXNwb3NlKCksdGhpcy5fdG9CZURpc3Bvc2VkLmxlbmd0aD0wO2NvbnN0IGU9dGhpcy5fYWN0aXZlUmVxdWVzdHMuc2xpY2UoKTtmb3IoY29uc3QgciBvZiBlKXIuYWJvcnQoKTt0aGlzLl9hY3RpdmVSZXF1ZXN0cy5sZW5ndGg9MDt0cnl7dGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1jYXRjaChyKXtjb25zb2xlLmVycm9yKCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBjYWxsaW5nIG9uRGlzcG9zZU9ic2VydmFibGUhIixyKX1pZih0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlUmVuZGVyVGFyZ2V0c1JlbmRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQWZ0ZXJSZW5kZXJUYXJnZXRzUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlclN0ZXBPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkJlZm9yZVN0ZXBPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkJlZm9yZUFjdGl2ZU1lc2hlc0V2YWx1YXRpb25PYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkFmdGVyQWN0aXZlTWVzaGVzRXZhbHVhdGlvbk9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlUGFydGljbGVzUmVuZGVyaW5nT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlclBhcnRpY2xlc1JlbmRlcmluZ09ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlRHJhd1BoYXNlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlckRyYXdQaGFzZU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlQW5pbWF0aW9uc09ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQWZ0ZXJBbmltYXRpb25zT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25EYXRhTG9hZGVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25CZWZvcmVSZW5kZXJpbmdHcm91cE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQWZ0ZXJSZW5kZXJpbmdHcm91cE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uTWVzaEltcG9ydGVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25CZWZvcmVDYW1lcmFSZW5kZXJPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkFmdGVyQ2FtZXJhUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25SZWFkeU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uTmV3Q2FtZXJhQWRkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNhbWVyYVJlbW92ZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbk5ld0xpZ2h0QWRkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkxpZ2h0UmVtb3ZlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uTmV3R2VvbWV0cnlBZGRlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uR2VvbWV0cnlSZW1vdmVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25OZXdUcmFuc2Zvcm1Ob2RlQWRkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vblRyYW5zZm9ybU5vZGVSZW1vdmVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25OZXdNZXNoQWRkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbk1lc2hSZW1vdmVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25OZXdTa2VsZXRvbkFkZGVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25Ta2VsZXRvblJlbW92ZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbk5ld01hdGVyaWFsQWRkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbk5ld011bHRpTWF0ZXJpYWxBZGRlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uTWF0ZXJpYWxSZW1vdmVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25NdWx0aU1hdGVyaWFsUmVtb3ZlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uTmV3VGV4dHVyZUFkZGVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25UZXh0dXJlUmVtb3ZlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uUHJlUG9pbnRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uUG9pbnRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uUHJlS2V5Ym9hcmRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbktleWJvYXJkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BY3RpdmVDYW1lcmFDaGFuZ2VkLmNsZWFyKCksdGhpcy5kZXRhY2hDb250cm9sKCksdGhpcy5fZW5naW5lLmdldElucHV0RWxlbWVudCgpKWZvcihsZXQgcj0wO3I8dGhpcy5jYW1lcmFzLmxlbmd0aDtyKyspdGhpcy5jYW1lcmFzW3JdLmRldGFjaENvbnRyb2woKTt0aGlzLl9kaXNwb3NlTGlzdCh0aGlzLmFuaW1hdGlvbkdyb3VwcyksdGhpcy5fZGlzcG9zZUxpc3QodGhpcy5saWdodHMpLHRoaXMuX2Rpc3Bvc2VMaXN0KHRoaXMubWVzaGVzLHI9PnIuZGlzcG9zZSghMCkpLHRoaXMuX2Rpc3Bvc2VMaXN0KHRoaXMudHJhbnNmb3JtTm9kZXMscj0+ci5kaXNwb3NlKCEwKSk7Y29uc3QgaT10aGlzLmNhbWVyYXM7dGhpcy5fZGlzcG9zZUxpc3QoaSksdGhpcy5fZGVmYXVsdE1hdGVyaWFsJiZ0aGlzLl9kZWZhdWx0TWF0ZXJpYWwuZGlzcG9zZSgpLHRoaXMuX2Rpc3Bvc2VMaXN0KHRoaXMubXVsdGlNYXRlcmlhbHMpLHRoaXMuX2Rpc3Bvc2VMaXN0KHRoaXMubWF0ZXJpYWxzKSx0aGlzLl9kaXNwb3NlTGlzdCh0aGlzLnBhcnRpY2xlU3lzdGVtcyksdGhpcy5fZGlzcG9zZUxpc3QodGhpcy5wb3N0UHJvY2Vzc2VzKSx0aGlzLl9kaXNwb3NlTGlzdCh0aGlzLnRleHR1cmVzKSx0aGlzLl9kaXNwb3NlTGlzdCh0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlcnMpLHRoaXMuX3NjZW5lVWJvLmRpc3Bvc2UoKSx0aGlzLl9tdWx0aXZpZXdTY2VuZVVibyYmdGhpcy5fbXVsdGl2aWV3U2NlbmVVYm8uZGlzcG9zZSgpLHRoaXMucG9zdFByb2Nlc3NNYW5hZ2VyLmRpc3Bvc2UoKSx0aGlzLl9kaXNwb3NlTGlzdCh0aGlzLl9jb21wb25lbnRzKTtsZXQgcz10aGlzLl9lbmdpbmUuc2NlbmVzLmluZGV4T2YodGhpcyk7cz4tMSYmdGhpcy5fZW5naW5lLnNjZW5lcy5zcGxpY2UocywxKSxmZS5fTGFzdENyZWF0ZWRTY2VuZT09PXRoaXMmJih0aGlzLl9lbmdpbmUuc2NlbmVzLmxlbmd0aD4wP2ZlLl9MYXN0Q3JlYXRlZFNjZW5lPXRoaXMuX2VuZ2luZS5zY2VuZXNbdGhpcy5fZW5naW5lLnNjZW5lcy5sZW5ndGgtMV06ZmUuX0xhc3RDcmVhdGVkU2NlbmU9bnVsbCkscz10aGlzLl9lbmdpbmUuX3ZpcnR1YWxTY2VuZXMuaW5kZXhPZih0aGlzKSxzPi0xJiZ0aGlzLl9lbmdpbmUuX3ZpcnR1YWxTY2VuZXMuc3BsaWNlKHMsMSksdGhpcy5fZW5naW5lLndpcGVDYWNoZXMoITApLHRoaXMuX2lzRGlzcG9zZWQ9ITB9X2Rpc3Bvc2VMaXN0KGUsdCl7Y29uc3QgaT1lLnNsaWNlKDApO3Q9dD8/KHM9PnMuZGlzcG9zZSgpKTtmb3IoY29uc3QgcyBvZiBpKXQocyk7ZS5sZW5ndGg9MH1nZXQgaXNEaXNwb3NlZCgpe3JldHVybiB0aGlzLl9pc0Rpc3Bvc2VkfWNsZWFyQ2FjaGVkVmVydGV4RGF0YSgpe2ZvcihsZXQgZT0wO2U8dGhpcy5tZXNoZXMubGVuZ3RoO2UrKyl7Y29uc3QgaT10aGlzLm1lc2hlc1tlXS5nZW9tZXRyeTtpJiZpLmNsZWFyQ2FjaGVkRGF0YSgpfX1jbGVhbkNhY2hlZFRleHR1cmVCdWZmZXIoKXtmb3IoY29uc3QgZSBvZiB0aGlzLnRleHR1cmVzKWUuX2J1ZmZlciYmKGUuX2J1ZmZlcj1udWxsKX1nZXRXb3JsZEV4dGVuZHMoZSl7Y29uc3QgdD1uZXcgcChOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSksaT1uZXcgcCgtTnVtYmVyLk1BWF9WQUxVRSwtTnVtYmVyLk1BWF9WQUxVRSwtTnVtYmVyLk1BWF9WQUxVRSk7cmV0dXJuIGU9ZXx8KCgpPT4hMCksdGhpcy5tZXNoZXMuZmlsdGVyKGUpLmZvckVhY2gocz0+e2lmKHMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSwhcy5zdWJNZXNoZXN8fHMuc3ViTWVzaGVzLmxlbmd0aD09PTB8fHMuaW5maW5pdGVEaXN0YW5jZSlyZXR1cm47Y29uc3Qgcj1zLmdldEJvdW5kaW5nSW5mbygpLG49ci5ib3VuZGluZ0JveC5taW5pbXVtV29ybGQsYT1yLmJvdW5kaW5nQm94Lm1heGltdW1Xb3JsZDtwLkNoZWNrRXh0ZW5kcyhuLHQsaSkscC5DaGVja0V4dGVuZHMoYSx0LGkpfSkse21pbjp0LG1heDppfX1jcmVhdGVQaWNraW5nUmF5KGUsdCxpLHMscj0hMSl7dGhyb3cgJCgiUmF5Iil9Y3JlYXRlUGlja2luZ1JheVRvUmVmKGUsdCxpLHMscixuPSExLGE9ITEpe3Rocm93ICQoIlJheSIpfWNyZWF0ZVBpY2tpbmdSYXlJbkNhbWVyYVNwYWNlKGUsdCxpKXt0aHJvdyAkKCJSYXkiKX1jcmVhdGVQaWNraW5nUmF5SW5DYW1lcmFTcGFjZVRvUmVmKGUsdCxpLHMpe3Rocm93ICQoIlJheSIpfWdldCBfcGlja2luZ0F2YWlsYWJsZSgpe3JldHVybiExfXBpY2soZSx0LGkscyxyLG4pe3JldHVybiBuZXcgVXR9cGlja1dpdGhCb3VuZGluZ0luZm8oZSx0LGkscyxyKXtyZXR1cm4gbmV3IFV0fXBpY2tXaXRoUmF5KGUsdCxpLHMpe3Rocm93ICQoIlJheSIpfW11bHRpUGljayhlLHQsaSxzLHIpe3Rocm93ICQoIlJheSIpfW11bHRpUGlja1dpdGhSYXkoZSx0LGkpe3Rocm93ICQoIlJheSIpfXNldFBvaW50ZXJPdmVyTWVzaChlLHQsaSl7dGhpcy5faW5wdXRNYW5hZ2VyLnNldFBvaW50ZXJPdmVyTWVzaChlLHQsaSl9Z2V0UG9pbnRlck92ZXJNZXNoKCl7cmV0dXJuIHRoaXMuX2lucHV0TWFuYWdlci5nZXRQb2ludGVyT3Zlck1lc2goKX1fcmVidWlsZEdlb21ldHJpZXMoKXtmb3IoY29uc3QgZSBvZiB0aGlzLmdlb21ldHJpZXMpZS5fcmVidWlsZCgpO2Zvcihjb25zdCBlIG9mIHRoaXMubWVzaGVzKWUuX3JlYnVpbGQoKTt0aGlzLnBvc3RQcm9jZXNzTWFuYWdlciYmdGhpcy5wb3N0UHJvY2Vzc01hbmFnZXIuX3JlYnVpbGQoKTtmb3IoY29uc3QgZSBvZiB0aGlzLl9jb21wb25lbnRzKWUucmVidWlsZCgpO2Zvcihjb25zdCBlIG9mIHRoaXMucGFydGljbGVTeXN0ZW1zKWUucmVidWlsZCgpO2lmKHRoaXMuc3ByaXRlTWFuYWdlcnMpZm9yKGNvbnN0IGUgb2YgdGhpcy5zcHJpdGVNYW5hZ2VycyllLnJlYnVpbGQoKX1fcmVidWlsZFRleHR1cmVzKCl7Zm9yKGNvbnN0IGUgb2YgdGhpcy50ZXh0dXJlcyllLl9yZWJ1aWxkKCk7dGhpcy5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKX1fZ2V0QnlUYWdzKGUsdCxpKXtpZih0PT09dm9pZCAwKXJldHVybiBlO2NvbnN0IHM9W107aT1pfHwocj0+e30pO2Zvcihjb25zdCByIGluIGUpe2NvbnN0IG49ZVtyXTtnZSYmZ2UuTWF0Y2hlc1F1ZXJ5KG4sdCkmJihzLnB1c2gobiksaShuKSl9cmV0dXJuIHN9Z2V0TWVzaGVzQnlUYWdzKGUsdCl7cmV0dXJuIHRoaXMuX2dldEJ5VGFncyh0aGlzLm1lc2hlcyxlLHQpfWdldENhbWVyYXNCeVRhZ3MoZSx0KXtyZXR1cm4gdGhpcy5fZ2V0QnlUYWdzKHRoaXMuY2FtZXJhcyxlLHQpfWdldExpZ2h0c0J5VGFncyhlLHQpe3JldHVybiB0aGlzLl9nZXRCeVRhZ3ModGhpcy5saWdodHMsZSx0KX1nZXRNYXRlcmlhbEJ5VGFncyhlLHQpe3JldHVybiB0aGlzLl9nZXRCeVRhZ3ModGhpcy5tYXRlcmlhbHMsZSx0KS5jb25jYXQodGhpcy5fZ2V0QnlUYWdzKHRoaXMubXVsdGlNYXRlcmlhbHMsZSx0KSl9Z2V0VHJhbnNmb3JtTm9kZXNCeVRhZ3MoZSx0KXtyZXR1cm4gdGhpcy5fZ2V0QnlUYWdzKHRoaXMudHJhbnNmb3JtTm9kZXMsZSx0KX1zZXRSZW5kZXJpbmdPcmRlcihlLHQ9bnVsbCxpPW51bGwscz1udWxsKXt0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnNldFJlbmRlcmluZ09yZGVyKGUsdCxpLHMpfXNldFJlbmRlcmluZ0F1dG9DbGVhckRlcHRoU3RlbmNpbChlLHQsaT0hMCxzPSEwKXt0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnNldFJlbmRlcmluZ0F1dG9DbGVhckRlcHRoU3RlbmNpbChlLHQsaSxzKX1nZXRBdXRvQ2xlYXJEZXB0aFN0ZW5jaWxTZXR1cChlKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5nZXRBdXRvQ2xlYXJEZXB0aFN0ZW5jaWxTZXR1cChlKX1nZXQgYmxvY2tNYXRlcmlhbERpcnR5TWVjaGFuaXNtKCl7cmV0dXJuIHRoaXMuX2Jsb2NrTWF0ZXJpYWxEaXJ0eU1lY2hhbmlzbX1zZXQgYmxvY2tNYXRlcmlhbERpcnR5TWVjaGFuaXNtKGUpe3RoaXMuX2Jsb2NrTWF0ZXJpYWxEaXJ0eU1lY2hhbmlzbSE9PWUmJih0aGlzLl9ibG9ja01hdGVyaWFsRGlydHlNZWNoYW5pc209ZSxlfHx0aGlzLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDYzKSl9bWFya0FsbE1hdGVyaWFsc0FzRGlydHkoZSx0KXtpZighdGhpcy5fYmxvY2tNYXRlcmlhbERpcnR5TWVjaGFuaXNtKWZvcihjb25zdCBpIG9mIHRoaXMubWF0ZXJpYWxzKXQmJiF0KGkpfHxpLm1hcmtBc0RpcnR5KGUpfV9sb2FkRmlsZShlLHQsaSxzLHIsbixhKXtjb25zdCBvPWp0KGUsdCxpLHM/dGhpcy5vZmZsaW5lUHJvdmlkZXI6dm9pZCAwLHIsbixhKTtyZXR1cm4gdGhpcy5fYWN0aXZlUmVxdWVzdHMucHVzaChvKSxvLm9uQ29tcGxldGVPYnNlcnZhYmxlLmFkZChoPT57dGhpcy5fYWN0aXZlUmVxdWVzdHMuc3BsaWNlKHRoaXMuX2FjdGl2ZVJlcXVlc3RzLmluZGV4T2YoaCksMSl9KSxvfV9sb2FkRmlsZUFzeW5jKGUsdCxpLHMscil7cmV0dXJuIG5ldyBQcm9taXNlKChuLGEpPT57dGhpcy5fbG9hZEZpbGUoZSxvPT57bihvKX0sdCxpLHMsKG8saCk9PnthKGgpfSxyKX0pfV9yZXF1ZXN0RmlsZShlLHQsaSxzLHIsbixhKXtjb25zdCBvPXhzKGUsdCxpLHM/dGhpcy5vZmZsaW5lUHJvdmlkZXI6dm9pZCAwLHIsbixhKTtyZXR1cm4gdGhpcy5fYWN0aXZlUmVxdWVzdHMucHVzaChvKSxvLm9uQ29tcGxldGVPYnNlcnZhYmxlLmFkZChoPT57dGhpcy5fYWN0aXZlUmVxdWVzdHMuc3BsaWNlKHRoaXMuX2FjdGl2ZVJlcXVlc3RzLmluZGV4T2YoaCksMSl9KSxvfV9yZXF1ZXN0RmlsZUFzeW5jKGUsdCxpLHMscil7cmV0dXJuIG5ldyBQcm9taXNlKChuLGEpPT57dGhpcy5fcmVxdWVzdEZpbGUoZSxvPT57bihvKX0sdCxpLHMsbz0+e2Eobyl9LHIpfSl9X3JlYWRGaWxlKGUsdCxpLHMscil7Y29uc3Qgbj13aShlLHQsaSxzLHIpO3JldHVybiB0aGlzLl9hY3RpdmVSZXF1ZXN0cy5wdXNoKG4pLG4ub25Db21wbGV0ZU9ic2VydmFibGUuYWRkKGE9Pnt0aGlzLl9hY3RpdmVSZXF1ZXN0cy5zcGxpY2UodGhpcy5fYWN0aXZlUmVxdWVzdHMuaW5kZXhPZihhKSwxKX0pLG59X3JlYWRGaWxlQXN5bmMoZSx0LGkpe3JldHVybiBuZXcgUHJvbWlzZSgocyxyKT0+e3RoaXMuX3JlYWRGaWxlKGUsbj0+e3Mobil9LHQsaSxuPT57cihuKX0pfSl9Z2V0UGVyZkNvbGxlY3Rvcigpe3Rocm93ICQoInBlcmZvcm1hbmNlVmlld2VyU2NlbmVFeHRlbnNpb24iKX19bmUuRk9HTU9ERV9OT05FPTAsbmUuRk9HTU9ERV9FWFA9MSxuZS5GT0dNT0RFX0VYUDI9MixuZS5GT0dNT0RFX0xJTkVBUj0zLG5lLk1pbkRlbHRhVGltZT0xLG5lLk1heERlbHRhVGltZT0xZTMsbmUucHJvdG90eXBlLnNldEFjdGl2ZUNhbWVyYUJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuc2V0QWN0aXZlQ2FtZXJhQnlJZChjKX0sbmUucHJvdG90eXBlLmdldExhc3RNYXRlcmlhbEJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0TGFzdE1hdGVyaWFsQnlJZChjKX0sbmUucHJvdG90eXBlLmdldE1hdGVyaWFsQnlJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRNYXRlcmlhbEJ5SWQoYyl9LG5lLnByb3RvdHlwZS5nZXRUZXh0dXJlQnlVbmlxdWVJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRUZXh0dXJlQnlVbmlxdWVJZChjKX0sbmUucHJvdG90eXBlLmdldENhbWVyYUJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0Q2FtZXJhQnlJZChjKX0sbmUucHJvdG90eXBlLmdldENhbWVyYUJ5VW5pcXVlSUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0Q2FtZXJhQnlVbmlxdWVJZChjKX0sbmUucHJvdG90eXBlLmdldEJvbmVCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmdldEJvbmVCeUlkKGMpfSxuZS5wcm90b3R5cGUuZ2V0TGlnaHRCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmdldExpZ2h0QnlJZChjKX0sbmUucHJvdG90eXBlLmdldExpZ2h0QnlVbmlxdWVJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRMaWdodEJ5VW5pcXVlSWQoYyl9LG5lLnByb3RvdHlwZS5nZXRQYXJ0aWNsZVN5c3RlbUJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0UGFydGljbGVTeXN0ZW1CeUlkKGMpfSxuZS5wcm90b3R5cGUuZ2V0R2VvbWV0cnlCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmdldEdlb21ldHJ5QnlJZChjKX0sbmUucHJvdG90eXBlLmdldE1lc2hCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmdldE1lc2hCeUlkKGMpfSxuZS5wcm90b3R5cGUuZ2V0TWVzaGVzQnlJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRNZXNoZXNCeUlkKGMpfSxuZS5wcm90b3R5cGUuZ2V0VHJhbnNmb3JtTm9kZUJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0VHJhbnNmb3JtTm9kZUJ5SWQoYyl9LG5lLnByb3RvdHlwZS5nZXRUcmFuc2Zvcm1Ob2RlQnlVbmlxdWVJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRUcmFuc2Zvcm1Ob2RlQnlVbmlxdWVJZChjKX0sbmUucHJvdG90eXBlLmdldFRyYW5zZm9ybU5vZGVzQnlJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRUcmFuc2Zvcm1Ob2Rlc0J5SWQoYyl9LG5lLnByb3RvdHlwZS5nZXRNZXNoQnlVbmlxdWVJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRNZXNoQnlVbmlxdWVJZChjKX0sbmUucHJvdG90eXBlLmdldExhc3RNZXNoQnlJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRMYXN0TWVzaEJ5SWQoYyl9LG5lLnByb3RvdHlwZS5nZXRMYXN0RW50cnlCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmdldExhc3RFbnRyeUJ5SWQoYyl9LG5lLnByb3RvdHlwZS5nZXROb2RlQnlJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXROb2RlQnlJZChjKX0sbmUucHJvdG90eXBlLmdldExhc3RTa2VsZXRvbkJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0TGFzdFNrZWxldG9uQnlJZChjKX07ZnVuY3Rpb24gSXMoYyxlLHQpe3RyeXtjb25zdCBpPWMubmV4dCgpO2kuZG9uZT9lKGkpOmkudmFsdWU/aS52YWx1ZS50aGVuKCgpPT57aS52YWx1ZT12b2lkIDAsZShpKX0sdCk6ZShpKX1jYXRjaChpKXt0KGkpfX1mdW5jdGlvbiB3bihjPTI1KXtsZXQgZTtyZXR1cm4odCxpLHMpPT57Y29uc3Qgcj1wZXJmb3JtYW5jZS5ub3coKTtlPT09dm9pZCAwfHxyLWU+Yz8oZT1yLHNldFRpbWVvdXQoKCk9PntJcyh0LGkscyl9LDApKTpJcyh0LGkscyl9fWZ1bmN0aW9uIEFyKGMsZSx0LGkscyl7Y29uc3Qgcj0oKT0+e2xldCBuO2NvbnN0IGE9bz0+e28uZG9uZT90KG8udmFsdWUpOm49PT12b2lkIDA/bj0hMDpyKCl9O2RvIG49dm9pZCAwLCFzfHwhcy5hYm9ydGVkP2UoYyxhLGkpOmkobmV3IEVycm9yKCJBYm9ydGVkIikpLG49PT12b2lkIDAmJihuPSExKTt3aGlsZShuKX07cigpfWZ1bmN0aW9uIFBzKGMsZSl7bGV0IHQ7cmV0dXJuIEFyKGMsSXMsaT0+dD1pLGk9Pnt0aHJvdyBpfSxlKSx0fWZ1bmN0aW9uIE9uKGMsZSx0KXtyZXR1cm4gbmV3IFByb21pc2UoKGkscyk9PntBcihjLGUsaSxzLHQpfSl9ZnVuY3Rpb24gTG4oYyxlKXtyZXR1cm4oLi4udCk9PlBzKGMoLi4udCksZSl9Y2xhc3MgTm57Y29uc3RydWN0b3IoKXt0aGlzLl9kb05vdFNlcmlhbGl6ZT0hMSx0aGlzLl9pc0Rpc3Bvc2VkPSExLHRoaXMuX3NjZW5lUm9vdE5vZGVzSW5kZXg9LTEsdGhpcy5faXNFbmFibGVkPSEwLHRoaXMuX2lzUGFyZW50RW5hYmxlZD0hMCx0aGlzLl9pc1JlYWR5PSEwLHRoaXMuX29uRW5hYmxlZFN0YXRlQ2hhbmdlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5fb25DbG9uZWRPYnNlcnZhYmxlPW5ldyBGfX1jbGFzcyB6ZXtjb25zdHJ1Y3RvcihlLHQ9bnVsbCl7dGhpcy5faXNEaXJ0eT0hMSx0aGlzLl9ub2RlRGF0YVN0b3JhZ2U9bmV3IE5uLHRoaXMuc3RhdGU9IiIsdGhpcy5tZXRhZGF0YT1udWxsLHRoaXMucmVzZXJ2ZWREYXRhU3RvcmU9bnVsbCx0aGlzLl9hY2Nlc3NpYmlsaXR5VGFnPW51bGwsdGhpcy5vbkFjY2Vzc2liaWxpdHlUYWdDaGFuZ2VkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9wYXJlbnRDb250YWluZXI9bnVsbCx0aGlzLmFuaW1hdGlvbnM9bmV3IEFycmF5LHRoaXMuX3Jhbmdlcz17fSx0aGlzLm9uUmVhZHk9bnVsbCx0aGlzLl9jdXJyZW50UmVuZGVySWQ9LTEsdGhpcy5fcGFyZW50VXBkYXRlSWQ9LTEsdGhpcy5fY2hpbGRVcGRhdGVJZD0tMSx0aGlzLl93YWl0aW5nUGFyZW50SWQ9bnVsbCx0aGlzLl93YWl0aW5nUGFyZW50SW5zdGFuY2VJbmRleD1udWxsLHRoaXMuX3dhaXRpbmdQYXJzZWRVbmlxdWVJZD1udWxsLHRoaXMuX2NhY2hlPXt9LHRoaXMuX3BhcmVudE5vZGU9bnVsbCx0aGlzLl9jaGlsZHJlbj1udWxsLHRoaXMuX3dvcmxkTWF0cml4PXguSWRlbnRpdHkoKSx0aGlzLl93b3JsZE1hdHJpeERldGVybWluYW50PTAsdGhpcy5fd29ybGRNYXRyaXhEZXRlcm1pbmFudElzRGlydHk9ITAsdGhpcy5fYW5pbWF0aW9uUHJvcGVydGllc092ZXJyaWRlPW51bGwsdGhpcy5faXNOb2RlPSEwLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlcj1udWxsLHRoaXMuX2JlaGF2aW9ycz1uZXcgQXJyYXksdGhpcy5uYW1lPWUsdGhpcy5pZD1lLHRoaXMuX3NjZW5lPXR8fGZlLkxhc3RDcmVhdGVkU2NlbmUsdGhpcy51bmlxdWVJZD10aGlzLl9zY2VuZS5nZXRVbmlxdWVJZCgpLHRoaXMuX2luaXRDYWNoZSgpfXN0YXRpYyBBZGROb2RlQ29uc3RydWN0b3IoZSx0KXt0aGlzLl9Ob2RlQ29uc3RydWN0b3JzW2VdPXR9c3RhdGljIENvbnN0cnVjdChlLHQsaSxzKXtjb25zdCByPXRoaXMuX05vZGVDb25zdHJ1Y3RvcnNbZV07cmV0dXJuIHI/cih0LGkscyk6bnVsbH1zZXQgYWNjZXNzaWJpbGl0eVRhZyhlKXt0aGlzLl9hY2Nlc3NpYmlsaXR5VGFnPWUsdGhpcy5vbkFjY2Vzc2liaWxpdHlUYWdDaGFuZ2VkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSl9Z2V0IGFjY2Vzc2liaWxpdHlUYWcoKXtyZXR1cm4gdGhpcy5fYWNjZXNzaWJpbGl0eVRhZ31nZXQgZG9Ob3RTZXJpYWxpemUoKXtyZXR1cm4gdGhpcy5fbm9kZURhdGFTdG9yYWdlLl9kb05vdFNlcmlhbGl6ZT8hMDp0aGlzLl9wYXJlbnROb2RlP3RoaXMuX3BhcmVudE5vZGUuZG9Ob3RTZXJpYWxpemU6ITF9c2V0IGRvTm90U2VyaWFsaXplKGUpe3RoaXMuX25vZGVEYXRhU3RvcmFnZS5fZG9Ob3RTZXJpYWxpemU9ZX1pc0Rpc3Bvc2VkKCl7cmV0dXJuIHRoaXMuX25vZGVEYXRhU3RvcmFnZS5faXNEaXNwb3NlZH1zZXQgcGFyZW50KGUpe2lmKHRoaXMuX3BhcmVudE5vZGU9PT1lKXJldHVybjtjb25zdCB0PXRoaXMuX3BhcmVudE5vZGU7aWYodGhpcy5fcGFyZW50Tm9kZSYmdGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRyZW4hPT12b2lkIDAmJnRoaXMuX3BhcmVudE5vZGUuX2NoaWxkcmVuIT09bnVsbCl7Y29uc3QgaT10aGlzLl9wYXJlbnROb2RlLl9jaGlsZHJlbi5pbmRleE9mKHRoaXMpO2khPT0tMSYmdGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRyZW4uc3BsaWNlKGksMSksIWUmJiF0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzRGlzcG9zZWQmJnRoaXMuX2FkZFRvU2NlbmVSb290Tm9kZXMoKX10aGlzLl9wYXJlbnROb2RlPWUsdGhpcy5fcGFyZW50Tm9kZSYmKCh0aGlzLl9wYXJlbnROb2RlLl9jaGlsZHJlbj09PXZvaWQgMHx8dGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRyZW49PT1udWxsKSYmKHRoaXMuX3BhcmVudE5vZGUuX2NoaWxkcmVuPW5ldyBBcnJheSksdGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRyZW4ucHVzaCh0aGlzKSx0fHx0aGlzLl9yZW1vdmVGcm9tU2NlbmVSb290Tm9kZXMoKSksdGhpcy5fc3luY1BhcmVudEVuYWJsZWRTdGF0ZSgpfWdldCBwYXJlbnQoKXtyZXR1cm4gdGhpcy5fcGFyZW50Tm9kZX1fc2VyaWFsaXplQXNQYXJlbnQoZSl7ZS5wYXJlbnRJZD10aGlzLnVuaXF1ZUlkfV9hZGRUb1NjZW5lUm9vdE5vZGVzKCl7dGhpcy5fbm9kZURhdGFTdG9yYWdlLl9zY2VuZVJvb3ROb2Rlc0luZGV4PT09LTEmJih0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX3NjZW5lUm9vdE5vZGVzSW5kZXg9dGhpcy5fc2NlbmUucm9vdE5vZGVzLmxlbmd0aCx0aGlzLl9zY2VuZS5yb290Tm9kZXMucHVzaCh0aGlzKSl9X3JlbW92ZUZyb21TY2VuZVJvb3ROb2Rlcygpe2lmKHRoaXMuX25vZGVEYXRhU3RvcmFnZS5fc2NlbmVSb290Tm9kZXNJbmRleCE9PS0xKXtjb25zdCBlPXRoaXMuX3NjZW5lLnJvb3ROb2Rlcyx0PWUubGVuZ3RoLTE7ZVt0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX3NjZW5lUm9vdE5vZGVzSW5kZXhdPWVbdF0sZVt0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX3NjZW5lUm9vdE5vZGVzSW5kZXhdLl9ub2RlRGF0YVN0b3JhZ2UuX3NjZW5lUm9vdE5vZGVzSW5kZXg9dGhpcy5fbm9kZURhdGFTdG9yYWdlLl9zY2VuZVJvb3ROb2Rlc0luZGV4LHRoaXMuX3NjZW5lLnJvb3ROb2Rlcy5wb3AoKSx0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX3NjZW5lUm9vdE5vZGVzSW5kZXg9LTF9fWdldCBhbmltYXRpb25Qcm9wZXJ0aWVzT3ZlcnJpZGUoKXtyZXR1cm4gdGhpcy5fYW5pbWF0aW9uUHJvcGVydGllc092ZXJyaWRlP3RoaXMuX2FuaW1hdGlvblByb3BlcnRpZXNPdmVycmlkZTp0aGlzLl9zY2VuZS5hbmltYXRpb25Qcm9wZXJ0aWVzT3ZlcnJpZGV9c2V0IGFuaW1hdGlvblByb3BlcnRpZXNPdmVycmlkZShlKXt0aGlzLl9hbmltYXRpb25Qcm9wZXJ0aWVzT3ZlcnJpZGU9ZX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iTm9kZSJ9c2V0IG9uRGlzcG9zZShlKXt0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlciYmdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlciksdGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXI9dGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLmFkZChlKX1nZXQgb25FbmFibGVkU3RhdGVDaGFuZ2VkT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX29uRW5hYmxlZFN0YXRlQ2hhbmdlZE9ic2VydmFibGV9Z2V0IG9uQ2xvbmVkT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX29uQ2xvbmVkT2JzZXJ2YWJsZX1nZXRTY2VuZSgpe3JldHVybiB0aGlzLl9zY2VuZX1nZXRFbmdpbmUoKXtyZXR1cm4gdGhpcy5fc2NlbmUuZ2V0RW5naW5lKCl9YWRkQmVoYXZpb3IoZSx0PSExKXtyZXR1cm4gdGhpcy5fYmVoYXZpb3JzLmluZGV4T2YoZSkhPT0tMT90aGlzOihlLmluaXQoKSx0aGlzLl9zY2VuZS5pc0xvYWRpbmcmJiF0P3RoaXMuX3NjZW5lLm9uRGF0YUxvYWRlZE9ic2VydmFibGUuYWRkT25jZSgoKT0+e2UuYXR0YWNoKHRoaXMpfSk6ZS5hdHRhY2godGhpcyksdGhpcy5fYmVoYXZpb3JzLnB1c2goZSksdGhpcyl9cmVtb3ZlQmVoYXZpb3IoZSl7Y29uc3QgdD10aGlzLl9iZWhhdmlvcnMuaW5kZXhPZihlKTtyZXR1cm4gdD09PS0xP3RoaXM6KHRoaXMuX2JlaGF2aW9yc1t0XS5kZXRhY2goKSx0aGlzLl9iZWhhdmlvcnMuc3BsaWNlKHQsMSksdGhpcyl9Z2V0IGJlaGF2aW9ycygpe3JldHVybiB0aGlzLl9iZWhhdmlvcnN9Z2V0QmVoYXZpb3JCeU5hbWUoZSl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fYmVoYXZpb3JzKWlmKHQubmFtZT09PWUpcmV0dXJuIHQ7cmV0dXJuIG51bGx9Z2V0V29ybGRNYXRyaXgoKXtyZXR1cm4gdGhpcy5fY3VycmVudFJlbmRlcklkIT09dGhpcy5fc2NlbmUuZ2V0UmVuZGVySWQoKSYmdGhpcy5jb21wdXRlV29ybGRNYXRyaXgoKSx0aGlzLl93b3JsZE1hdHJpeH1fZ2V0V29ybGRNYXRyaXhEZXRlcm1pbmFudCgpe3JldHVybiB0aGlzLl93b3JsZE1hdHJpeERldGVybWluYW50SXNEaXJ0eSYmKHRoaXMuX3dvcmxkTWF0cml4RGV0ZXJtaW5hbnRJc0RpcnR5PSExLHRoaXMuX3dvcmxkTWF0cml4RGV0ZXJtaW5hbnQ9dGhpcy5fd29ybGRNYXRyaXguZGV0ZXJtaW5hbnQoKSksdGhpcy5fd29ybGRNYXRyaXhEZXRlcm1pbmFudH1nZXQgd29ybGRNYXRyaXhGcm9tQ2FjaGUoKXtyZXR1cm4gdGhpcy5fd29ybGRNYXRyaXh9X2luaXRDYWNoZSgpe3RoaXMuX2NhY2hlPXt9LHRoaXMuX2NhY2hlLnBhcmVudD12b2lkIDB9dXBkYXRlQ2FjaGUoZSl7IWUmJnRoaXMuaXNTeW5jaHJvbml6ZWQoKXx8KHRoaXMuX2NhY2hlLnBhcmVudD10aGlzLnBhcmVudCx0aGlzLl91cGRhdGVDYWNoZSgpKX1fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoZSx0PSEwKXtyZXR1cm4gdGhpcy5wYXJlbnQ/dGhpcy5wYXJlbnQuX2dldEFjdGlvbk1hbmFnZXJGb3JUcmlnZ2VyKGUsITEpOm51bGx9X3VwZGF0ZUNhY2hlKGUpe31faXNTeW5jaHJvbml6ZWQoKXtyZXR1cm4hMH1fbWFya1N5bmNlZFdpdGhQYXJlbnQoKXt0aGlzLl9wYXJlbnROb2RlJiYodGhpcy5fcGFyZW50VXBkYXRlSWQ9dGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRVcGRhdGVJZCl9aXNTeW5jaHJvbml6ZWRXaXRoUGFyZW50KCl7cmV0dXJuIHRoaXMuX3BhcmVudE5vZGU/dGhpcy5fcGFyZW50Tm9kZS5faXNEaXJ0eXx8dGhpcy5fcGFyZW50VXBkYXRlSWQhPT10aGlzLl9wYXJlbnROb2RlLl9jaGlsZFVwZGF0ZUlkPyExOnRoaXMuX3BhcmVudE5vZGUuaXNTeW5jaHJvbml6ZWQoKTohMH1pc1N5bmNocm9uaXplZCgpe3JldHVybiB0aGlzLl9jYWNoZS5wYXJlbnQhPT10aGlzLl9wYXJlbnROb2RlPyh0aGlzLl9jYWNoZS5wYXJlbnQ9dGhpcy5fcGFyZW50Tm9kZSwhMSk6dGhpcy5fcGFyZW50Tm9kZSYmIXRoaXMuaXNTeW5jaHJvbml6ZWRXaXRoUGFyZW50KCk/ITE6dGhpcy5faXNTeW5jaHJvbml6ZWQoKX1pc1JlYWR5KGU9ITEpe3JldHVybiB0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzUmVhZHl9bWFya0FzRGlydHkoZSl7cmV0dXJuIHRoaXMuX2N1cnJlbnRSZW5kZXJJZD1OdW1iZXIuTUFYX1ZBTFVFLHRoaXMuX2lzRGlydHk9ITAsdGhpc31pc0VuYWJsZWQoZT0hMCl7cmV0dXJuIGU9PT0hMT90aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzRW5hYmxlZDp0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzRW5hYmxlZD90aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzUGFyZW50RW5hYmxlZDohMX1fc3luY1BhcmVudEVuYWJsZWRTdGF0ZSgpe3RoaXMuX25vZGVEYXRhU3RvcmFnZS5faXNQYXJlbnRFbmFibGVkPXRoaXMuX3BhcmVudE5vZGU/dGhpcy5fcGFyZW50Tm9kZS5pc0VuYWJsZWQoKTohMCx0aGlzLl9jaGlsZHJlbiYmdGhpcy5fY2hpbGRyZW4uZm9yRWFjaChlPT57ZS5fc3luY1BhcmVudEVuYWJsZWRTdGF0ZSgpfSl9c2V0RW5hYmxlZChlKXt0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzRW5hYmxlZCE9PWUmJih0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzRW5hYmxlZD1lLHRoaXMuX3N5bmNQYXJlbnRFbmFibGVkU3RhdGUoKSx0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX29uRW5hYmxlZFN0YXRlQ2hhbmdlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpKX1pc0Rlc2NlbmRhbnRPZihlKXtyZXR1cm4gdGhpcy5wYXJlbnQ/dGhpcy5wYXJlbnQ9PT1lPyEwOnRoaXMucGFyZW50LmlzRGVzY2VuZGFudE9mKGUpOiExfV9nZXREZXNjZW5kYW50cyhlLHQ9ITEsaSl7aWYodGhpcy5fY2hpbGRyZW4pZm9yKGxldCBzPTA7czx0aGlzLl9jaGlsZHJlbi5sZW5ndGg7cysrKXtjb25zdCByPXRoaXMuX2NoaWxkcmVuW3NdOyghaXx8aShyKSkmJmUucHVzaChyKSx0fHxyLl9nZXREZXNjZW5kYW50cyhlLCExLGkpfX1nZXREZXNjZW5kYW50cyhlLHQpe2NvbnN0IGk9bmV3IEFycmF5O3JldHVybiB0aGlzLl9nZXREZXNjZW5kYW50cyhpLGUsdCksaX1nZXRDaGlsZE1lc2hlcyhlLHQpe2NvbnN0IGk9W107cmV0dXJuIHRoaXMuX2dldERlc2NlbmRhbnRzKGksZSxzPT4oIXR8fHQocykpJiZzLmN1bGxpbmdTdHJhdGVneSE9PXZvaWQgMCksaX1nZXRDaGlsZHJlbihlLHQ9ITApe3JldHVybiB0aGlzLmdldERlc2NlbmRhbnRzKHQsZSl9X3NldFJlYWR5KGUpe2lmKGUhPT10aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzUmVhZHkpe2lmKCFlKXt0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzUmVhZHk9ITE7cmV0dXJufXRoaXMub25SZWFkeSYmdGhpcy5vblJlYWR5KHRoaXMpLHRoaXMuX25vZGVEYXRhU3RvcmFnZS5faXNSZWFkeT0hMH19Z2V0QW5pbWF0aW9uQnlOYW1lKGUpe2ZvcihsZXQgdD0wO3Q8dGhpcy5hbmltYXRpb25zLmxlbmd0aDt0Kyspe2NvbnN0IGk9dGhpcy5hbmltYXRpb25zW3RdO2lmKGkubmFtZT09PWUpcmV0dXJuIGl9cmV0dXJuIG51bGx9Y3JlYXRlQW5pbWF0aW9uUmFuZ2UoZSx0LGkpe2lmKCF0aGlzLl9yYW5nZXNbZV0pe3RoaXMuX3Jhbmdlc1tlXT16ZS5fQW5pbWF0aW9uUmFuZ2VGYWN0b3J5KGUsdCxpKTtmb3IobGV0IHM9MCxyPXRoaXMuYW5pbWF0aW9ucy5sZW5ndGg7czxyO3MrKyl0aGlzLmFuaW1hdGlvbnNbc10mJnRoaXMuYW5pbWF0aW9uc1tzXS5jcmVhdGVSYW5nZShlLHQsaSl9fWRlbGV0ZUFuaW1hdGlvblJhbmdlKGUsdD0hMCl7Zm9yKGxldCBpPTAscz10aGlzLmFuaW1hdGlvbnMubGVuZ3RoO2k8cztpKyspdGhpcy5hbmltYXRpb25zW2ldJiZ0aGlzLmFuaW1hdGlvbnNbaV0uZGVsZXRlUmFuZ2UoZSx0KTt0aGlzLl9yYW5nZXNbZV09bnVsbH1nZXRBbmltYXRpb25SYW5nZShlKXtyZXR1cm4gdGhpcy5fcmFuZ2VzW2VdfHxudWxsfWdldEFuaW1hdGlvblJhbmdlcygpe2NvbnN0IGU9W107bGV0IHQ7Zm9yKHQgaW4gdGhpcy5fcmFuZ2VzKWUucHVzaCh0aGlzLl9yYW5nZXNbdF0pO3JldHVybiBlfWJlZ2luQW5pbWF0aW9uKGUsdCxpLHMpe2NvbnN0IHI9dGhpcy5nZXRBbmltYXRpb25SYW5nZShlKTtyZXR1cm4gcj90aGlzLl9zY2VuZS5iZWdpbkFuaW1hdGlvbih0aGlzLHIuZnJvbSxyLnRvLHQsaSxzKTpudWxsfXNlcmlhbGl6ZUFuaW1hdGlvblJhbmdlcygpe2NvbnN0IGU9W107Zm9yKGNvbnN0IHQgaW4gdGhpcy5fcmFuZ2VzKXtjb25zdCBpPXRoaXMuX3Jhbmdlc1t0XTtpZighaSljb250aW51ZTtjb25zdCBzPXt9O3MubmFtZT10LHMuZnJvbT1pLmZyb20scy50bz1pLnRvLGUucHVzaChzKX1yZXR1cm4gZX1jb21wdXRlV29ybGRNYXRyaXgoZSl7cmV0dXJuIHRoaXMuX3dvcmxkTWF0cml4fHwodGhpcy5fd29ybGRNYXRyaXg9eC5JZGVudGl0eSgpKSx0aGlzLl93b3JsZE1hdHJpeH1kaXNwb3NlKGUsdD0hMSl7aWYodGhpcy5fbm9kZURhdGFTdG9yYWdlLl9pc0Rpc3Bvc2VkPSEwLCFlKXtjb25zdCBpPXRoaXMuZ2V0RGVzY2VuZGFudHMoITApO2Zvcihjb25zdCBzIG9mIGkpcy5kaXNwb3NlKGUsdCl9dGhpcy5wYXJlbnQ/dGhpcy5wYXJlbnQ9bnVsbDp0aGlzLl9yZW1vdmVGcm9tU2NlbmVSb290Tm9kZXMoKSx0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25FbmFibGVkU3RhdGVDaGFuZ2VkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25DbG9uZWRPYnNlcnZhYmxlLmNsZWFyKCk7Zm9yKGNvbnN0IGkgb2YgdGhpcy5fYmVoYXZpb3JzKWkuZGV0YWNoKCk7dGhpcy5fYmVoYXZpb3JzLmxlbmd0aD0wLHRoaXMubWV0YWRhdGE9bnVsbH1zdGF0aWMgUGFyc2VBbmltYXRpb25SYW5nZXMoZSx0LGkpe2lmKHQucmFuZ2VzKWZvcihsZXQgcz0wO3M8dC5yYW5nZXMubGVuZ3RoO3MrKyl7Y29uc3Qgcj10LnJhbmdlc1tzXTtlLmNyZWF0ZUFuaW1hdGlvblJhbmdlKHIubmFtZSxyLmZyb20sci50byl9fWdldEhpZXJhcmNoeUJvdW5kaW5nVmVjdG9ycyhlPSEwLHQ9bnVsbCl7dGhpcy5nZXRTY2VuZSgpLmluY3JlbWVudFJlbmRlcklkKCksdGhpcy5jb21wdXRlV29ybGRNYXRyaXgoITApO2xldCBpLHM7Y29uc3Qgcj10aGlzO2lmKHIuZ2V0Qm91bmRpbmdJbmZvJiZyLnN1Yk1lc2hlcyl7Y29uc3Qgbj1yLmdldEJvdW5kaW5nSW5mbygpO2k9bi5ib3VuZGluZ0JveC5taW5pbXVtV29ybGQuY2xvbmUoKSxzPW4uYm91bmRpbmdCb3gubWF4aW11bVdvcmxkLmNsb25lKCl9ZWxzZSBpPW5ldyBwKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSxzPW5ldyBwKC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFKTtpZihlKXtjb25zdCBuPXRoaXMuZ2V0RGVzY2VuZGFudHMoITEpO2Zvcihjb25zdCBhIG9mIG4pe2NvbnN0IG89YTtpZihvLmNvbXB1dGVXb3JsZE1hdHJpeCghMCksdCYmIXQobyl8fCFvLmdldEJvdW5kaW5nSW5mb3x8by5nZXRUb3RhbFZlcnRpY2VzKCk9PT0wKWNvbnRpbnVlO2NvbnN0IGw9by5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ0JveCx1PWwubWluaW11bVdvcmxkLGQ9bC5tYXhpbXVtV29ybGQ7cC5DaGVja0V4dGVuZHModSxpLHMpLHAuQ2hlY2tFeHRlbmRzKGQsaSxzKX19cmV0dXJue21pbjppLG1heDpzfX19emUuX0FuaW1hdGlvblJhbmdlRmFjdG9yeT0oYyxlLHQpPT57dGhyb3cgJCgiQW5pbWF0aW9uUmFuZ2UiKX0semUuX05vZGVDb25zdHJ1Y3RvcnM9e30sVChbUigpXSx6ZS5wcm90b3R5cGUsIm5hbWUiLHZvaWQgMCksVChbUigpXSx6ZS5wcm90b3R5cGUsImlkIix2b2lkIDApLFQoW1IoKV0semUucHJvdG90eXBlLCJ1bmlxdWVJZCIsdm9pZCAwKSxUKFtSKCldLHplLnByb3RvdHlwZSwic3RhdGUiLHZvaWQgMCksVChbUigpXSx6ZS5wcm90b3R5cGUsIm1ldGFkYXRhIix2b2lkIDApO2NsYXNzIEJpe2NvbnN0cnVjdG9yKGUsdCxpLHMpe3RoaXMueD1lLHRoaXMueT10LHRoaXMud2lkdGg9aSx0aGlzLmhlaWdodD1zfXRvR2xvYmFsKGUsdCl7cmV0dXJuIG5ldyBCaSh0aGlzLngqZSx0aGlzLnkqdCx0aGlzLndpZHRoKmUsdGhpcy5oZWlnaHQqdCl9dG9HbG9iYWxUb1JlZihlLHQsaSl7cmV0dXJuIGkueD10aGlzLngqZSxpLnk9dGhpcy55KnQsaS53aWR0aD10aGlzLndpZHRoKmUsaS5oZWlnaHQ9dGhpcy5oZWlnaHQqdCx0aGlzfWNsb25lKCl7cmV0dXJuIG5ldyBCaSh0aGlzLngsdGhpcy55LHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpfX1jbGFzcyBqIGV4dGVuZHMgemV7Y29uc3RydWN0b3IoZSx0LGkscz0hMCl7c3VwZXIoZSxpKSx0aGlzLl9wb3NpdGlvbj1wLlplcm8oKSx0aGlzLl91cFZlY3Rvcj1wLlVwKCksdGhpcy5fb3J0aG9MZWZ0PW51bGwsdGhpcy5fb3J0aG9SaWdodD1udWxsLHRoaXMuX29ydGhvQm90dG9tPW51bGwsdGhpcy5fb3J0aG9Ub3A9bnVsbCx0aGlzLmZvdj0uOCx0aGlzLnByb2plY3Rpb25QbGFuZVRpbHQ9MCx0aGlzLm1pblo9MSx0aGlzLm1heFo9MWU0LHRoaXMuaW5lcnRpYT0uOSx0aGlzLl9tb2RlPWouUEVSU1BFQ1RJVkVfQ0FNRVJBLHRoaXMuaXNJbnRlcm1lZGlhdGU9ITEsdGhpcy52aWV3cG9ydD1uZXcgQmkoMCwwLDEsMSksdGhpcy5sYXllck1hc2s9MjY4NDM1NDU1LHRoaXMuZm92TW9kZT1qLkZPVk1PREVfVkVSVElDQUxfRklYRUQsdGhpcy5jYW1lcmFSaWdNb2RlPWouUklHX01PREVfTk9ORSx0aGlzLmN1c3RvbVJlbmRlclRhcmdldHM9bmV3IEFycmF5LHRoaXMub3V0cHV0UmVuZGVyVGFyZ2V0PW51bGwsdGhpcy5vblZpZXdNYXRyaXhDaGFuZ2VkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uUHJvamVjdGlvbk1hdHJpeENoYW5nZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BZnRlckNoZWNrSW5wdXRzT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uUmVzdG9yZVN0YXRlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLmlzUmlnQ2FtZXJhPSExLHRoaXMuX3JpZ0NhbWVyYXM9bmV3IEFycmF5LHRoaXMuX3dlYnZyVmlld01hdHJpeD14LklkZW50aXR5KCksdGhpcy5fc2tpcFJlbmRlcmluZz0hMSx0aGlzLl9wcm9qZWN0aW9uTWF0cml4PW5ldyB4LHRoaXMuX3Bvc3RQcm9jZXNzZXM9bmV3IEFycmF5LHRoaXMuX2FjdGl2ZU1lc2hlcz1uZXcgJGUoMjU2KSx0aGlzLl9nbG9iYWxQb3NpdGlvbj1wLlplcm8oKSx0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXg9eC5JZGVudGl0eSgpLHRoaXMuX2RvTm90Q29tcHV0ZVByb2plY3Rpb25NYXRyaXg9ITEsdGhpcy5fdHJhbnNmb3JtTWF0cml4PXguWmVybygpLHRoaXMuX3JlZnJlc2hGcnVzdHVtUGxhbmVzPSEwLHRoaXMuX2Fic29sdXRlUm90YXRpb249Wi5JZGVudGl0eSgpLHRoaXMuX2lzQ2FtZXJhPSEwLHRoaXMuX2lzTGVmdENhbWVyYT0hMSx0aGlzLl9pc1JpZ2h0Q2FtZXJhPSExLHRoaXMuZ2V0U2NlbmUoKS5hZGRDYW1lcmEodGhpcykscyYmIXRoaXMuZ2V0U2NlbmUoKS5hY3RpdmVDYW1lcmEmJih0aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhPXRoaXMpLHRoaXMucG9zaXRpb249dCx0aGlzLnJlbmRlclBhc3NJZD10aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkuY3JlYXRlUmVuZGVyUGFzc0lkKGBDYW1lcmEgJHtlfWApfWdldCBwb3NpdGlvbigpe3JldHVybiB0aGlzLl9wb3NpdGlvbn1zZXQgcG9zaXRpb24oZSl7dGhpcy5fcG9zaXRpb249ZX1zZXQgdXBWZWN0b3IoZSl7dGhpcy5fdXBWZWN0b3I9ZX1nZXQgdXBWZWN0b3IoKXtyZXR1cm4gdGhpcy5fdXBWZWN0b3J9Z2V0IHNjcmVlbkFyZWEoKXt2YXIgZSx0LGkscztsZXQgcj0wLG49MDtpZih0aGlzLm1vZGU9PT1qLlBFUlNQRUNUSVZFX0NBTUVSQSl0aGlzLmZvdk1vZGU9PT1qLkZPVk1PREVfVkVSVElDQUxfRklYRUQ/KG49dGhpcy5taW5aKjIqTWF0aC50YW4odGhpcy5mb3YvMikscj10aGlzLmdldEVuZ2luZSgpLmdldEFzcGVjdFJhdGlvKHRoaXMpKm4pOihyPXRoaXMubWluWioyKk1hdGgudGFuKHRoaXMuZm92LzIpLG49ci90aGlzLmdldEVuZ2luZSgpLmdldEFzcGVjdFJhdGlvKHRoaXMpKTtlbHNle2NvbnN0IGE9dGhpcy5nZXRFbmdpbmUoKS5nZXRSZW5kZXJXaWR0aCgpLzIsbz10aGlzLmdldEVuZ2luZSgpLmdldFJlbmRlckhlaWdodCgpLzI7cj0oKGU9dGhpcy5vcnRob1JpZ2h0KSE9PW51bGwmJmUhPT12b2lkIDA/ZTphKS0oKHQ9dGhpcy5vcnRob0xlZnQpIT09bnVsbCYmdCE9PXZvaWQgMD90Oi1hKSxuPSgoaT10aGlzLm9ydGhvVG9wKSE9PW51bGwmJmkhPT12b2lkIDA/aTpvKS0oKHM9dGhpcy5vcnRob0JvdHRvbSkhPT1udWxsJiZzIT09dm9pZCAwP3M6LW8pfXJldHVybiByKm59c2V0IG9ydGhvTGVmdChlKXt0aGlzLl9vcnRob0xlZnQ9ZTtmb3IoY29uc3QgdCBvZiB0aGlzLl9yaWdDYW1lcmFzKXQub3J0aG9MZWZ0PWV9Z2V0IG9ydGhvTGVmdCgpe3JldHVybiB0aGlzLl9vcnRob0xlZnR9c2V0IG9ydGhvUmlnaHQoZSl7dGhpcy5fb3J0aG9SaWdodD1lO2Zvcihjb25zdCB0IG9mIHRoaXMuX3JpZ0NhbWVyYXMpdC5vcnRob1JpZ2h0PWV9Z2V0IG9ydGhvUmlnaHQoKXtyZXR1cm4gdGhpcy5fb3J0aG9SaWdodH1zZXQgb3J0aG9Cb3R0b20oZSl7dGhpcy5fb3J0aG9Cb3R0b209ZTtmb3IoY29uc3QgdCBvZiB0aGlzLl9yaWdDYW1lcmFzKXQub3J0aG9Cb3R0b209ZX1nZXQgb3J0aG9Cb3R0b20oKXtyZXR1cm4gdGhpcy5fb3J0aG9Cb3R0b219c2V0IG9ydGhvVG9wKGUpe3RoaXMuX29ydGhvVG9wPWU7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fcmlnQ2FtZXJhcyl0Lm9ydGhvVG9wPWV9Z2V0IG9ydGhvVG9wKCl7cmV0dXJuIHRoaXMuX29ydGhvVG9wfXNldCBtb2RlKGUpe3RoaXMuX21vZGU9ZTtmb3IoY29uc3QgdCBvZiB0aGlzLl9yaWdDYW1lcmFzKXQubW9kZT1lfWdldCBtb2RlKCl7cmV0dXJuIHRoaXMuX21vZGV9c3RvcmVTdGF0ZSgpe3JldHVybiB0aGlzLl9zdGF0ZVN0b3JlZD0hMCx0aGlzLl9zdG9yZWRGb3Y9dGhpcy5mb3YsdGhpc31fcmVzdG9yZVN0YXRlVmFsdWVzKCl7cmV0dXJuIHRoaXMuX3N0YXRlU3RvcmVkPyh0aGlzLmZvdj10aGlzLl9zdG9yZWRGb3YsITApOiExfXJlc3RvcmVTdGF0ZSgpe3JldHVybiB0aGlzLl9yZXN0b3JlU3RhdGVWYWx1ZXMoKT8odGhpcy5vblJlc3RvcmVTdGF0ZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLCEwKTohMX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iQ2FtZXJhIn10b1N0cmluZyhlKXtsZXQgdD0iTmFtZTogIit0aGlzLm5hbWU7aWYodCs9IiwgdHlwZTogIit0aGlzLmdldENsYXNzTmFtZSgpLHRoaXMuYW5pbWF0aW9ucylmb3IobGV0IGk9MDtpPHRoaXMuYW5pbWF0aW9ucy5sZW5ndGg7aSsrKXQrPSIsIGFuaW1hdGlvblswXTogIit0aGlzLmFuaW1hdGlvbnNbaV0udG9TdHJpbmcoZSk7cmV0dXJuIHR9YXBwbHlWZXJ0aWNhbENvcnJlY3Rpb24oKXtjb25zdCBlPXRoaXMuYWJzb2x1dGVSb3RhdGlvbi50b0V1bGVyQW5nbGVzKCk7dGhpcy5wcm9qZWN0aW9uUGxhbmVUaWx0PXRoaXMuX3NjZW5lLnVzZVJpZ2h0SGFuZGVkU3lzdGVtPy1lLng6ZS54fWdldCBnbG9iYWxQb3NpdGlvbigpe3JldHVybiB0aGlzLl9nbG9iYWxQb3NpdGlvbn1nZXRBY3RpdmVNZXNoZXMoKXtyZXR1cm4gdGhpcy5fYWN0aXZlTWVzaGVzfWlzQWN0aXZlTWVzaChlKXtyZXR1cm4gdGhpcy5fYWN0aXZlTWVzaGVzLmluZGV4T2YoZSkhPT0tMX1pc1JlYWR5KGU9ITEpe2lmKGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuX3Bvc3RQcm9jZXNzZXMpaWYodCYmIXQuaXNSZWFkeSgpKXJldHVybiExfXJldHVybiBzdXBlci5pc1JlYWR5KGUpfV9pbml0Q2FjaGUoKXtzdXBlci5faW5pdENhY2hlKCksdGhpcy5fY2FjaGUucG9zaXRpb249bmV3IHAoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLHRoaXMuX2NhY2hlLnVwVmVjdG9yPW5ldyBwKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSx0aGlzLl9jYWNoZS5tb2RlPXZvaWQgMCx0aGlzLl9jYWNoZS5taW5aPXZvaWQgMCx0aGlzLl9jYWNoZS5tYXhaPXZvaWQgMCx0aGlzLl9jYWNoZS5mb3Y9dm9pZCAwLHRoaXMuX2NhY2hlLmZvdk1vZGU9dm9pZCAwLHRoaXMuX2NhY2hlLmFzcGVjdFJhdGlvPXZvaWQgMCx0aGlzLl9jYWNoZS5vcnRob0xlZnQ9dm9pZCAwLHRoaXMuX2NhY2hlLm9ydGhvUmlnaHQ9dm9pZCAwLHRoaXMuX2NhY2hlLm9ydGhvQm90dG9tPXZvaWQgMCx0aGlzLl9jYWNoZS5vcnRob1RvcD12b2lkIDAsdGhpcy5fY2FjaGUucmVuZGVyV2lkdGg9dm9pZCAwLHRoaXMuX2NhY2hlLnJlbmRlckhlaWdodD12b2lkIDB9X3VwZGF0ZUNhY2hlKGUpe2V8fHN1cGVyLl91cGRhdGVDYWNoZSgpLHRoaXMuX2NhY2hlLnBvc2l0aW9uLmNvcHlGcm9tKHRoaXMucG9zaXRpb24pLHRoaXMuX2NhY2hlLnVwVmVjdG9yLmNvcHlGcm9tKHRoaXMudXBWZWN0b3IpfV9pc1N5bmNocm9uaXplZCgpe3JldHVybiB0aGlzLl9pc1N5bmNocm9uaXplZFZpZXdNYXRyaXgoKSYmdGhpcy5faXNTeW5jaHJvbml6ZWRQcm9qZWN0aW9uTWF0cml4KCl9X2lzU3luY2hyb25pemVkVmlld01hdHJpeCgpe3JldHVybiBzdXBlci5faXNTeW5jaHJvbml6ZWQoKT90aGlzLl9jYWNoZS5wb3NpdGlvbi5lcXVhbHModGhpcy5wb3NpdGlvbikmJnRoaXMuX2NhY2hlLnVwVmVjdG9yLmVxdWFscyh0aGlzLnVwVmVjdG9yKSYmdGhpcy5pc1N5bmNocm9uaXplZFdpdGhQYXJlbnQoKTohMX1faXNTeW5jaHJvbml6ZWRQcm9qZWN0aW9uTWF0cml4KCl7bGV0IGU9dGhpcy5fY2FjaGUubW9kZT09PXRoaXMubW9kZSYmdGhpcy5fY2FjaGUubWluWj09PXRoaXMubWluWiYmdGhpcy5fY2FjaGUubWF4Wj09PXRoaXMubWF4WjtpZighZSlyZXR1cm4hMTtjb25zdCB0PXRoaXMuZ2V0RW5naW5lKCk7cmV0dXJuIHRoaXMubW9kZT09PWouUEVSU1BFQ1RJVkVfQ0FNRVJBP2U9dGhpcy5fY2FjaGUuZm92PT09dGhpcy5mb3YmJnRoaXMuX2NhY2hlLmZvdk1vZGU9PT10aGlzLmZvdk1vZGUmJnRoaXMuX2NhY2hlLmFzcGVjdFJhdGlvPT09dC5nZXRBc3BlY3RSYXRpbyh0aGlzKSYmdGhpcy5fY2FjaGUucHJvamVjdGlvblBsYW5lVGlsdD09PXRoaXMucHJvamVjdGlvblBsYW5lVGlsdDplPXRoaXMuX2NhY2hlLm9ydGhvTGVmdD09PXRoaXMub3J0aG9MZWZ0JiZ0aGlzLl9jYWNoZS5vcnRob1JpZ2h0PT09dGhpcy5vcnRob1JpZ2h0JiZ0aGlzLl9jYWNoZS5vcnRob0JvdHRvbT09PXRoaXMub3J0aG9Cb3R0b20mJnRoaXMuX2NhY2hlLm9ydGhvVG9wPT09dGhpcy5vcnRob1RvcCYmdGhpcy5fY2FjaGUucmVuZGVyV2lkdGg9PT10LmdldFJlbmRlcldpZHRoKCkmJnRoaXMuX2NhY2hlLnJlbmRlckhlaWdodD09PXQuZ2V0UmVuZGVySGVpZ2h0KCksZX1hdHRhY2hDb250cm9sKGUsdCl7fWRldGFjaENvbnRyb2woZSl7fXVwZGF0ZSgpe3RoaXMuX2NoZWNrSW5wdXRzKCksdGhpcy5jYW1lcmFSaWdNb2RlIT09ai5SSUdfTU9ERV9OT05FJiZ0aGlzLl91cGRhdGVSaWdDYW1lcmFzKCl9X2NoZWNrSW5wdXRzKCl7dGhpcy5vbkFmdGVyQ2hlY2tJbnB1dHNPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1nZXQgcmlnQ2FtZXJhcygpe3JldHVybiB0aGlzLl9yaWdDYW1lcmFzfWdldCByaWdQb3N0UHJvY2Vzcygpe3JldHVybiB0aGlzLl9yaWdQb3N0UHJvY2Vzc31fZ2V0Rmlyc3RQb3N0UHJvY2Vzcygpe2ZvcihsZXQgZT0wO2U8dGhpcy5fcG9zdFByb2Nlc3Nlcy5sZW5ndGg7ZSsrKWlmKHRoaXMuX3Bvc3RQcm9jZXNzZXNbZV0hPT1udWxsKXJldHVybiB0aGlzLl9wb3N0UHJvY2Vzc2VzW2VdO3JldHVybiBudWxsfV9jYXNjYWRlUG9zdFByb2Nlc3Nlc1RvUmlnQ2Ftcygpe2NvbnN0IGU9dGhpcy5fZ2V0Rmlyc3RQb3N0UHJvY2VzcygpO2UmJmUubWFya1RleHR1cmVEaXJ0eSgpO2ZvcihsZXQgdD0wLGk9dGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg7dDxpO3QrKyl7Y29uc3Qgcz10aGlzLl9yaWdDYW1lcmFzW3RdLHI9cy5fcmlnUG9zdFByb2Nlc3M7cj8oci5nZXRFZmZlY3ROYW1lKCk9PT0icGFzcyImJihzLmlzSW50ZXJtZWRpYXRlPXRoaXMuX3Bvc3RQcm9jZXNzZXMubGVuZ3RoPT09MCkscy5fcG9zdFByb2Nlc3Nlcz10aGlzLl9wb3N0UHJvY2Vzc2VzLnNsaWNlKDApLmNvbmNhdChyKSxyLm1hcmtUZXh0dXJlRGlydHkoKSk6cy5fcG9zdFByb2Nlc3Nlcz10aGlzLl9wb3N0UHJvY2Vzc2VzLnNsaWNlKDApfX1hdHRhY2hQb3N0UHJvY2VzcyhlLHQ9bnVsbCl7cmV0dXJuIWUuaXNSZXVzYWJsZSgpJiZ0aGlzLl9wb3N0UHJvY2Vzc2VzLmluZGV4T2YoZSk+LTE/KE8uRXJyb3IoIllvdSdyZSB0cnlpbmcgdG8gcmV1c2UgYSBwb3N0IHByb2Nlc3Mgbm90IGRlZmluZWQgYXMgcmV1c2FibGUuIiksMCk6KHQ9PW51bGx8fHQ8MD90aGlzLl9wb3N0UHJvY2Vzc2VzLnB1c2goZSk6dGhpcy5fcG9zdFByb2Nlc3Nlc1t0XT09PW51bGw/dGhpcy5fcG9zdFByb2Nlc3Nlc1t0XT1lOnRoaXMuX3Bvc3RQcm9jZXNzZXMuc3BsaWNlKHQsMCxlKSx0aGlzLl9jYXNjYWRlUG9zdFByb2Nlc3Nlc1RvUmlnQ2FtcygpLHRoaXMuX3NjZW5lLnByZVBhc3NSZW5kZXJlciYmdGhpcy5fc2NlbmUucHJlUGFzc1JlbmRlcmVyLm1hcmtBc0RpcnR5KCksdGhpcy5fcG9zdFByb2Nlc3Nlcy5pbmRleE9mKGUpKX1kZXRhY2hQb3N0UHJvY2VzcyhlKXtjb25zdCB0PXRoaXMuX3Bvc3RQcm9jZXNzZXMuaW5kZXhPZihlKTt0IT09LTEmJih0aGlzLl9wb3N0UHJvY2Vzc2VzW3RdPW51bGwpLHRoaXMuX3NjZW5lLnByZVBhc3NSZW5kZXJlciYmdGhpcy5fc2NlbmUucHJlUGFzc1JlbmRlcmVyLm1hcmtBc0RpcnR5KCksdGhpcy5fY2FzY2FkZVBvc3RQcm9jZXNzZXNUb1JpZ0NhbXMoKX1nZXRXb3JsZE1hdHJpeCgpe3JldHVybiB0aGlzLl9pc1N5bmNocm9uaXplZFZpZXdNYXRyaXgoKT90aGlzLl93b3JsZE1hdHJpeDoodGhpcy5nZXRWaWV3TWF0cml4KCksdGhpcy5fd29ybGRNYXRyaXgpfV9nZXRWaWV3TWF0cml4KCl7cmV0dXJuIHguSWRlbnRpdHkoKX1nZXRWaWV3TWF0cml4KGUpe3JldHVybiFlJiZ0aGlzLl9pc1N5bmNocm9uaXplZFZpZXdNYXRyaXgoKT90aGlzLl9jb21wdXRlZFZpZXdNYXRyaXg6KHRoaXMudXBkYXRlQ2FjaGUoKSx0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXg9dGhpcy5fZ2V0Vmlld01hdHJpeCgpLHRoaXMuX2N1cnJlbnRSZW5kZXJJZD10aGlzLmdldFNjZW5lKCkuZ2V0UmVuZGVySWQoKSx0aGlzLl9jaGlsZFVwZGF0ZUlkKyssdGhpcy5fcmVmcmVzaEZydXN0dW1QbGFuZXM9ITAsdGhpcy5fY2FtZXJhUmlnUGFyYW1zJiZ0aGlzLl9jYW1lcmFSaWdQYXJhbXMudnJQcmVWaWV3TWF0cml4JiZ0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLl9jYW1lcmFSaWdQYXJhbXMudnJQcmVWaWV3TWF0cml4LHRoaXMuX2NvbXB1dGVkVmlld01hdHJpeCksdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50Lm9uVmlld01hdHJpeENoYW5nZWRPYnNlcnZhYmxlJiZ0aGlzLnBhcmVudC5vblZpZXdNYXRyaXhDaGFuZ2VkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcy5wYXJlbnQpLHRoaXMub25WaWV3TWF0cml4Q2hhbmdlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX2NvbXB1dGVkVmlld01hdHJpeC5pbnZlcnRUb1JlZih0aGlzLl93b3JsZE1hdHJpeCksdGhpcy5fY29tcHV0ZWRWaWV3TWF0cml4KX1mcmVlemVQcm9qZWN0aW9uTWF0cml4KGUpe3RoaXMuX2RvTm90Q29tcHV0ZVByb2plY3Rpb25NYXRyaXg9ITAsZSE9PXZvaWQgMCYmKHRoaXMuX3Byb2plY3Rpb25NYXRyaXg9ZSl9dW5mcmVlemVQcm9qZWN0aW9uTWF0cml4KCl7dGhpcy5fZG9Ob3RDb21wdXRlUHJvamVjdGlvbk1hdHJpeD0hMX1nZXRQcm9qZWN0aW9uTWF0cml4KGUpe3ZhciB0LGkscyxyLG4sYSxvLGg7aWYodGhpcy5fZG9Ob3RDb21wdXRlUHJvamVjdGlvbk1hdHJpeHx8IWUmJnRoaXMuX2lzU3luY2hyb25pemVkUHJvamVjdGlvbk1hdHJpeCgpKXJldHVybiB0aGlzLl9wcm9qZWN0aW9uTWF0cml4O3RoaXMuX2NhY2hlLm1vZGU9dGhpcy5tb2RlLHRoaXMuX2NhY2hlLm1pblo9dGhpcy5taW5aLHRoaXMuX2NhY2hlLm1heFo9dGhpcy5tYXhaLHRoaXMuX3JlZnJlc2hGcnVzdHVtUGxhbmVzPSEwO2NvbnN0IGw9dGhpcy5nZXRFbmdpbmUoKSx1PXRoaXMuZ2V0U2NlbmUoKSxkPWwudXNlUmV2ZXJzZURlcHRoQnVmZmVyO2lmKHRoaXMubW9kZT09PWouUEVSU1BFQ1RJVkVfQ0FNRVJBKXt0aGlzLl9jYWNoZS5mb3Y9dGhpcy5mb3YsdGhpcy5fY2FjaGUuZm92TW9kZT10aGlzLmZvdk1vZGUsdGhpcy5fY2FjaGUuYXNwZWN0UmF0aW89bC5nZXRBc3BlY3RSYXRpbyh0aGlzKSx0aGlzLl9jYWNoZS5wcm9qZWN0aW9uUGxhbmVUaWx0PXRoaXMucHJvamVjdGlvblBsYW5lVGlsdCx0aGlzLm1pblo8PTAmJih0aGlzLm1pblo9LjEpO2xldCBmO3UudXNlUmlnaHRIYW5kZWRTeXN0ZW0/Zj14LlBlcnNwZWN0aXZlRm92UkhUb1JlZjpmPXguUGVyc3BlY3RpdmVGb3ZMSFRvUmVmLGYodGhpcy5mb3YsbC5nZXRBc3BlY3RSYXRpbyh0aGlzKSxkP3RoaXMubWF4Wjp0aGlzLm1pblosZD90aGlzLm1pblo6dGhpcy5tYXhaLHRoaXMuX3Byb2plY3Rpb25NYXRyaXgsdGhpcy5mb3ZNb2RlPT09ai5GT1ZNT0RFX1ZFUlRJQ0FMX0ZJWEVELGwuaXNORENIYWxmWlJhbmdlLHRoaXMucHJvamVjdGlvblBsYW5lVGlsdCxkKX1lbHNle2NvbnN0IGY9bC5nZXRSZW5kZXJXaWR0aCgpLzIsXz1sLmdldFJlbmRlckhlaWdodCgpLzI7dS51c2VSaWdodEhhbmRlZFN5c3RlbT94Lk9ydGhvT2ZmQ2VudGVyUkhUb1JlZigodD10aGlzLm9ydGhvTGVmdCkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6LWYsKGk9dGhpcy5vcnRob1JpZ2h0KSE9PW51bGwmJmkhPT12b2lkIDA/aTpmLChzPXRoaXMub3J0aG9Cb3R0b20pIT09bnVsbCYmcyE9PXZvaWQgMD9zOi1fLChyPXRoaXMub3J0aG9Ub3ApIT09bnVsbCYmciE9PXZvaWQgMD9yOl8sZD90aGlzLm1heFo6dGhpcy5taW5aLGQ/dGhpcy5taW5aOnRoaXMubWF4Wix0aGlzLl9wcm9qZWN0aW9uTWF0cml4LGwuaXNORENIYWxmWlJhbmdlKTp4Lk9ydGhvT2ZmQ2VudGVyTEhUb1JlZigobj10aGlzLm9ydGhvTGVmdCkhPT1udWxsJiZuIT09dm9pZCAwP246LWYsKGE9dGhpcy5vcnRob1JpZ2h0KSE9PW51bGwmJmEhPT12b2lkIDA/YTpmLChvPXRoaXMub3J0aG9Cb3R0b20pIT09bnVsbCYmbyE9PXZvaWQgMD9vOi1fLChoPXRoaXMub3J0aG9Ub3ApIT09bnVsbCYmaCE9PXZvaWQgMD9oOl8sZD90aGlzLm1heFo6dGhpcy5taW5aLGQ/dGhpcy5taW5aOnRoaXMubWF4Wix0aGlzLl9wcm9qZWN0aW9uTWF0cml4LGwuaXNORENIYWxmWlJhbmdlKSx0aGlzLl9jYWNoZS5vcnRob0xlZnQ9dGhpcy5vcnRob0xlZnQsdGhpcy5fY2FjaGUub3J0aG9SaWdodD10aGlzLm9ydGhvUmlnaHQsdGhpcy5fY2FjaGUub3J0aG9Cb3R0b209dGhpcy5vcnRob0JvdHRvbSx0aGlzLl9jYWNoZS5vcnRob1RvcD10aGlzLm9ydGhvVG9wLHRoaXMuX2NhY2hlLnJlbmRlcldpZHRoPWwuZ2V0UmVuZGVyV2lkdGgoKSx0aGlzLl9jYWNoZS5yZW5kZXJIZWlnaHQ9bC5nZXRSZW5kZXJIZWlnaHQoKX1yZXR1cm4gdGhpcy5vblByb2plY3Rpb25NYXRyaXhDaGFuZ2VkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5fcHJvamVjdGlvbk1hdHJpeH1nZXRUcmFuc2Zvcm1hdGlvbk1hdHJpeCgpe3JldHVybiB0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLl9wcm9qZWN0aW9uTWF0cml4LHRoaXMuX3RyYW5zZm9ybU1hdHJpeCksdGhpcy5fdHJhbnNmb3JtTWF0cml4fV91cGRhdGVGcnVzdHVtUGxhbmVzKCl7dGhpcy5fcmVmcmVzaEZydXN0dW1QbGFuZXMmJih0aGlzLmdldFRyYW5zZm9ybWF0aW9uTWF0cml4KCksdGhpcy5fZnJ1c3R1bVBsYW5lcz9FdC5HZXRQbGFuZXNUb1JlZih0aGlzLl90cmFuc2Zvcm1NYXRyaXgsdGhpcy5fZnJ1c3R1bVBsYW5lcyk6dGhpcy5fZnJ1c3R1bVBsYW5lcz1FdC5HZXRQbGFuZXModGhpcy5fdHJhbnNmb3JtTWF0cml4KSx0aGlzLl9yZWZyZXNoRnJ1c3R1bVBsYW5lcz0hMSl9aXNJbkZydXN0dW0oZSx0PSExKXtpZih0aGlzLl91cGRhdGVGcnVzdHVtUGxhbmVzKCksdCYmdGhpcy5yaWdDYW1lcmFzLmxlbmd0aD4wKXtsZXQgaT0hMTtyZXR1cm4gdGhpcy5yaWdDYW1lcmFzLmZvckVhY2gocz0+e3MuX3VwZGF0ZUZydXN0dW1QbGFuZXMoKSxpPWl8fGUuaXNJbkZydXN0dW0ocy5fZnJ1c3R1bVBsYW5lcyl9KSxpfWVsc2UgcmV0dXJuIGUuaXNJbkZydXN0dW0odGhpcy5fZnJ1c3R1bVBsYW5lcyl9aXNDb21wbGV0ZWx5SW5GcnVzdHVtKGUpe3JldHVybiB0aGlzLl91cGRhdGVGcnVzdHVtUGxhbmVzKCksZS5pc0NvbXBsZXRlbHlJbkZydXN0dW0odGhpcy5fZnJ1c3R1bVBsYW5lcyl9Z2V0Rm9yd2FyZFJheShlPTEwMCx0LGkpe3Rocm93ICQoIlJheSIpfWdldEZvcndhcmRSYXlUb1JlZihlLHQ9MTAwLGkscyl7dGhyb3cgJCgiUmF5Iil9ZGlzcG9zZShlLHQ9ITEpe2Zvcih0aGlzLm9uVmlld01hdHJpeENoYW5nZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vblByb2plY3Rpb25NYXRyaXhDaGFuZ2VkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlckNoZWNrSW5wdXRzT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25SZXN0b3JlU3RhdGVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5pbnB1dHMmJnRoaXMuaW5wdXRzLmNsZWFyKCksdGhpcy5nZXRTY2VuZSgpLnN0b3BBbmltYXRpb24odGhpcyksdGhpcy5nZXRTY2VuZSgpLnJlbW92ZUNhbWVyYSh0aGlzKTt0aGlzLl9yaWdDYW1lcmFzLmxlbmd0aD4wOyl7Y29uc3Qgcz10aGlzLl9yaWdDYW1lcmFzLnBvcCgpO3MmJnMuZGlzcG9zZSgpfWlmKHRoaXMuX3BhcmVudENvbnRhaW5lcil7Y29uc3Qgcz10aGlzLl9wYXJlbnRDb250YWluZXIuY2FtZXJhcy5pbmRleE9mKHRoaXMpO3M+LTEmJnRoaXMuX3BhcmVudENvbnRhaW5lci5jYW1lcmFzLnNwbGljZShzLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfWlmKHRoaXMuX3JpZ1Bvc3RQcm9jZXNzKXRoaXMuX3JpZ1Bvc3RQcm9jZXNzLmRpc3Bvc2UodGhpcyksdGhpcy5fcmlnUG9zdFByb2Nlc3M9bnVsbCx0aGlzLl9wb3N0UHJvY2Vzc2VzLmxlbmd0aD0wO2Vsc2UgaWYodGhpcy5jYW1lcmFSaWdNb2RlIT09ai5SSUdfTU9ERV9OT05FKXRoaXMuX3JpZ1Bvc3RQcm9jZXNzPW51bGwsdGhpcy5fcG9zdFByb2Nlc3Nlcy5sZW5ndGg9MDtlbHNle2xldCBzPXRoaXMuX3Bvc3RQcm9jZXNzZXMubGVuZ3RoO2Zvcig7LS1zPj0wOyl7Y29uc3Qgcj10aGlzLl9wb3N0UHJvY2Vzc2VzW3NdO3ImJnIuZGlzcG9zZSh0aGlzKX19bGV0IGk9dGhpcy5jdXN0b21SZW5kZXJUYXJnZXRzLmxlbmd0aDtmb3IoOy0taT49MDspdGhpcy5jdXN0b21SZW5kZXJUYXJnZXRzW2ldLmRpc3Bvc2UoKTt0aGlzLmN1c3RvbVJlbmRlclRhcmdldHMubGVuZ3RoPTAsdGhpcy5fYWN0aXZlTWVzaGVzLmRpc3Bvc2UoKSx0aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkucmVsZWFzZVJlbmRlclBhc3NJZCh0aGlzLnJlbmRlclBhc3NJZCksc3VwZXIuZGlzcG9zZShlLHQpfWdldCBpc0xlZnRDYW1lcmEoKXtyZXR1cm4gdGhpcy5faXNMZWZ0Q2FtZXJhfWdldCBpc1JpZ2h0Q2FtZXJhKCl7cmV0dXJuIHRoaXMuX2lzUmlnaHRDYW1lcmF9Z2V0IGxlZnRDYW1lcmEoKXtyZXR1cm4gdGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg8MT9udWxsOnRoaXMuX3JpZ0NhbWVyYXNbMF19Z2V0IHJpZ2h0Q2FtZXJhKCl7cmV0dXJuIHRoaXMuX3JpZ0NhbWVyYXMubGVuZ3RoPDI/bnVsbDp0aGlzLl9yaWdDYW1lcmFzWzFdfWdldExlZnRUYXJnZXQoKXtyZXR1cm4gdGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg8MT9udWxsOnRoaXMuX3JpZ0NhbWVyYXNbMF0uZ2V0VGFyZ2V0KCl9Z2V0UmlnaHRUYXJnZXQoKXtyZXR1cm4gdGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg8Mj9udWxsOnRoaXMuX3JpZ0NhbWVyYXNbMV0uZ2V0VGFyZ2V0KCl9c2V0Q2FtZXJhUmlnTW9kZShlLHQpe2lmKHRoaXMuY2FtZXJhUmlnTW9kZSE9PWUpe2Zvcig7dGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg+MDspe2NvbnN0IGk9dGhpcy5fcmlnQ2FtZXJhcy5wb3AoKTtpJiZpLmRpc3Bvc2UoKX1pZih0aGlzLmNhbWVyYVJpZ01vZGU9ZSx0aGlzLl9jYW1lcmFSaWdQYXJhbXM9e30sdGhpcy5fY2FtZXJhUmlnUGFyYW1zLmludGVyYXhpYWxEaXN0YW5jZT10LmludGVyYXhpYWxEaXN0YW5jZXx8LjA2MzcsdGhpcy5fY2FtZXJhUmlnUGFyYW1zLnN0ZXJlb0hhbGZBbmdsZT1ILlRvUmFkaWFucyh0aGlzLl9jYW1lcmFSaWdQYXJhbXMuaW50ZXJheGlhbERpc3RhbmNlLy4wNjM3KSx0aGlzLmNhbWVyYVJpZ01vZGUhPT1qLlJJR19NT0RFX05PTkUpe2NvbnN0IGk9dGhpcy5jcmVhdGVSaWdDYW1lcmEodGhpcy5uYW1lKyJfTCIsMCk7aSYmKGkuX2lzTGVmdENhbWVyYT0hMCk7Y29uc3Qgcz10aGlzLmNyZWF0ZVJpZ0NhbWVyYSh0aGlzLm5hbWUrIl9SIiwxKTtzJiYocy5faXNSaWdodENhbWVyYT0hMCksaSYmcyYmKHRoaXMuX3JpZ0NhbWVyYXMucHVzaChpKSx0aGlzLl9yaWdDYW1lcmFzLnB1c2gocykpfXRoaXMuX3NldFJpZ01vZGUodCksdGhpcy5fY2FzY2FkZVBvc3RQcm9jZXNzZXNUb1JpZ0NhbXMoKSx0aGlzLnVwZGF0ZSgpfX1fc2V0UmlnTW9kZShlKXt9X2dldFZSUHJvamVjdGlvbk1hdHJpeCgpe3JldHVybiB4LlBlcnNwZWN0aXZlRm92TEhUb1JlZih0aGlzLl9jYW1lcmFSaWdQYXJhbXMudnJNZXRyaWNzLmFzcGVjdFJhdGlvRm92LHRoaXMuX2NhbWVyYVJpZ1BhcmFtcy52ck1ldHJpY3MuYXNwZWN0UmF0aW8sdGhpcy5taW5aLHRoaXMubWF4Wix0aGlzLl9jYW1lcmFSaWdQYXJhbXMudnJXb3JrTWF0cml4LCEwLHRoaXMuZ2V0RW5naW5lKCkuaXNORENIYWxmWlJhbmdlKSx0aGlzLl9jYW1lcmFSaWdQYXJhbXMudnJXb3JrTWF0cml4Lm11bHRpcGx5VG9SZWYodGhpcy5fY2FtZXJhUmlnUGFyYW1zLnZySE1hdHJpeCx0aGlzLl9wcm9qZWN0aW9uTWF0cml4KSx0aGlzLl9wcm9qZWN0aW9uTWF0cml4fV91cGRhdGVDYW1lcmFSb3RhdGlvbk1hdHJpeCgpe31fdXBkYXRlV2ViVlJDYW1lcmFSb3RhdGlvbk1hdHJpeCgpe31fZ2V0V2ViVlJQcm9qZWN0aW9uTWF0cml4KCl7cmV0dXJuIHguSWRlbnRpdHkoKX1fZ2V0V2ViVlJWaWV3TWF0cml4KCl7cmV0dXJuIHguSWRlbnRpdHkoKX1zZXRDYW1lcmFSaWdQYXJhbWV0ZXIoZSx0KXt0aGlzLl9jYW1lcmFSaWdQYXJhbXN8fCh0aGlzLl9jYW1lcmFSaWdQYXJhbXM9e30pLHRoaXMuX2NhbWVyYVJpZ1BhcmFtc1tlXT10LGU9PT0iaW50ZXJheGlhbERpc3RhbmNlIiYmKHRoaXMuX2NhbWVyYVJpZ1BhcmFtcy5zdGVyZW9IYWxmQW5nbGU9SC5Ub1JhZGlhbnModC8uMDYzNykpfWNyZWF0ZVJpZ0NhbWVyYShlLHQpe3JldHVybiBudWxsfV91cGRhdGVSaWdDYW1lcmFzKCl7Zm9yKGxldCBlPTA7ZTx0aGlzLl9yaWdDYW1lcmFzLmxlbmd0aDtlKyspdGhpcy5fcmlnQ2FtZXJhc1tlXS5taW5aPXRoaXMubWluWix0aGlzLl9yaWdDYW1lcmFzW2VdLm1heFo9dGhpcy5tYXhaLHRoaXMuX3JpZ0NhbWVyYXNbZV0uZm92PXRoaXMuZm92LHRoaXMuX3JpZ0NhbWVyYXNbZV0udXBWZWN0b3IuY29weUZyb20odGhpcy51cFZlY3Rvcik7dGhpcy5jYW1lcmFSaWdNb2RlPT09ai5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfQU5BR0xZUEgmJih0aGlzLl9yaWdDYW1lcmFzWzBdLnZpZXdwb3J0PXRoaXMuX3JpZ0NhbWVyYXNbMV0udmlld3BvcnQ9dGhpcy52aWV3cG9ydCl9X3NldHVwSW5wdXRzKCl7fXNlcmlhbGl6ZSgpe2NvbnN0IGU9YWUuU2VyaWFsaXplKHRoaXMpO3JldHVybiBlLnVuaXF1ZUlkPXRoaXMudW5pcXVlSWQsZS50eXBlPXRoaXMuZ2V0Q2xhc3NOYW1lKCksdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50Ll9zZXJpYWxpemVBc1BhcmVudChlKSx0aGlzLmlucHV0cyYmdGhpcy5pbnB1dHMuc2VyaWFsaXplKGUpLGFlLkFwcGVuZFNlcmlhbGl6ZWRBbmltYXRpb25zKHRoaXMsZSksZS5yYW5nZXM9dGhpcy5zZXJpYWxpemVBbmltYXRpb25SYW5nZXMoKSxlLmlzRW5hYmxlZD10aGlzLmlzRW5hYmxlZCgpLGV9Y2xvbmUoZSx0PW51bGwpe2NvbnN0IGk9YWUuQ2xvbmUoai5HZXRDb25zdHJ1Y3RvckZyb21OYW1lKHRoaXMuZ2V0Q2xhc3NOYW1lKCksZSx0aGlzLmdldFNjZW5lKCksdGhpcy5pbnRlcmF4aWFsRGlzdGFuY2UsdGhpcy5pc1N0ZXJlb3Njb3BpY1NpZGVCeVNpZGUpLHRoaXMpO3JldHVybiBpLm5hbWU9ZSxpLnBhcmVudD10LHRoaXMub25DbG9uZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhpKSxpfWdldERpcmVjdGlvbihlKXtjb25zdCB0PXAuWmVybygpO3JldHVybiB0aGlzLmdldERpcmVjdGlvblRvUmVmKGUsdCksdH1nZXQgYWJzb2x1dGVSb3RhdGlvbigpe3JldHVybiB0aGlzLmdldFdvcmxkTWF0cml4KCkuZGVjb21wb3NlKHZvaWQgMCx0aGlzLl9hYnNvbHV0ZVJvdGF0aW9uKSx0aGlzLl9hYnNvbHV0ZVJvdGF0aW9ufWdldERpcmVjdGlvblRvUmVmKGUsdCl7cC5UcmFuc2Zvcm1Ob3JtYWxUb1JlZihlLHRoaXMuZ2V0V29ybGRNYXRyaXgoKSx0KX1zdGF0aWMgR2V0Q29uc3RydWN0b3JGcm9tTmFtZShlLHQsaSxzPTAscj0hMCl7Y29uc3Qgbj16ZS5Db25zdHJ1Y3QoZSx0LGkse2ludGVyYXhpYWxfZGlzdGFuY2U6cyxpc1N0ZXJlb3Njb3BpY1NpZGVCeVNpZGU6cn0pO3JldHVybiBufHwoKCk9PmouX0NyZWF0ZURlZmF1bHRQYXJzZWRDYW1lcmEodCxpKSl9Y29tcHV0ZVdvcmxkTWF0cml4KCl7cmV0dXJuIHRoaXMuZ2V0V29ybGRNYXRyaXgoKX1zdGF0aWMgUGFyc2UoZSx0KXtjb25zdCBpPWUudHlwZSxzPWouR2V0Q29uc3RydWN0b3JGcm9tTmFtZShpLGUubmFtZSx0LGUuaW50ZXJheGlhbF9kaXN0YW5jZSxlLmlzU3RlcmVvc2NvcGljU2lkZUJ5U2lkZSkscj1hZS5QYXJzZShzLGUsdCk7aWYoZS5wYXJlbnRJZCE9PXZvaWQgMCYmKHIuX3dhaXRpbmdQYXJlbnRJZD1lLnBhcmVudElkKSxlLnBhcmVudEluc3RhbmNlSW5kZXghPT12b2lkIDAmJihyLl93YWl0aW5nUGFyZW50SW5zdGFuY2VJbmRleD1lLnBhcmVudEluc3RhbmNlSW5kZXgpLHIuaW5wdXRzJiYoci5pbnB1dHMucGFyc2UoZSksci5fc2V0dXBJbnB1dHMoKSksZS51cFZlY3RvciYmKHIudXBWZWN0b3I9cC5Gcm9tQXJyYXkoZS51cFZlY3RvcikpLHIuc2V0UG9zaXRpb24mJihyLnBvc2l0aW9uLmNvcHlGcm9tRmxvYXRzKDAsMCwwKSxyLnNldFBvc2l0aW9uKHAuRnJvbUFycmF5KGUucG9zaXRpb24pKSksZS50YXJnZXQmJnIuc2V0VGFyZ2V0JiZyLnNldFRhcmdldChwLkZyb21BcnJheShlLnRhcmdldCkpLGUuY2FtZXJhUmlnTW9kZSl7Y29uc3Qgbj1lLmludGVyYXhpYWxfZGlzdGFuY2U/e2ludGVyYXhpYWxEaXN0YW5jZTplLmludGVyYXhpYWxfZGlzdGFuY2V9Ont9O3Iuc2V0Q2FtZXJhUmlnTW9kZShlLmNhbWVyYVJpZ01vZGUsbil9aWYoZS5hbmltYXRpb25zKXtmb3IobGV0IG49MDtuPGUuYW5pbWF0aW9ucy5sZW5ndGg7bisrKXtjb25zdCBhPWUuYW5pbWF0aW9uc1tuXSxvPXJpKCJCQUJZTE9OLkFuaW1hdGlvbiIpO28mJnIuYW5pbWF0aW9ucy5wdXNoKG8uUGFyc2UoYSkpfXplLlBhcnNlQW5pbWF0aW9uUmFuZ2VzKHIsZSx0KX1yZXR1cm4gZS5hdXRvQW5pbWF0ZSYmdC5iZWdpbkFuaW1hdGlvbihyLGUuYXV0b0FuaW1hdGVGcm9tLGUuYXV0b0FuaW1hdGVUbyxlLmF1dG9BbmltYXRlTG9vcCxlLmF1dG9BbmltYXRlU3BlZWR8fDEpLGUuaXNFbmFibGVkIT09dm9pZCAwJiZyLnNldEVuYWJsZWQoZS5pc0VuYWJsZWQpLHJ9fWouX0NyZWF0ZURlZmF1bHRQYXJzZWRDYW1lcmE9KGMsZSk9Pnt0aHJvdyAkKCJVbml2ZXJzYWxDYW1lcmEiKX0sai5QRVJTUEVDVElWRV9DQU1FUkE9MCxqLk9SVEhPR1JBUEhJQ19DQU1FUkE9MSxqLkZPVk1PREVfVkVSVElDQUxfRklYRUQ9MCxqLkZPVk1PREVfSE9SSVpPTlRBTF9GSVhFRD0xLGouUklHX01PREVfTk9ORT0wLGouUklHX01PREVfU1RFUkVPU0NPUElDX0FOQUdMWVBIPTEwLGouUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfUEFSQUxMRUw9MTEsai5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9DUk9TU0VZRUQ9MTIsai5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfT1ZFUlVOREVSPTEzLGouUklHX01PREVfU1RFUkVPU0NPUElDX0lOVEVSTEFDRUQ9MTQsai5SSUdfTU9ERV9WUj0yMCxqLlJJR19NT0RFX1dFQlZSPTIxLGouUklHX01PREVfQ1VTVE9NPTIyLGouRm9yY2VBdHRhY2hDb250cm9sVG9BbHdheXNQcmV2ZW50RGVmYXVsdD0hMSxUKFtCdCgicG9zaXRpb24iKV0sai5wcm90b3R5cGUsIl9wb3NpdGlvbiIsdm9pZCAwKSxUKFtCdCgidXBWZWN0b3IiKV0sai5wcm90b3R5cGUsIl91cFZlY3RvciIsdm9pZCAwKSxUKFtSKCldLGoucHJvdG90eXBlLCJvcnRob0xlZnQiLG51bGwpLFQoW1IoKV0sai5wcm90b3R5cGUsIm9ydGhvUmlnaHQiLG51bGwpLFQoW1IoKV0sai5wcm90b3R5cGUsIm9ydGhvQm90dG9tIixudWxsKSxUKFtSKCldLGoucHJvdG90eXBlLCJvcnRob1RvcCIsbnVsbCksVChbUigpXSxqLnByb3RvdHlwZSwiZm92Iix2b2lkIDApLFQoW1IoKV0sai5wcm90b3R5cGUsInByb2plY3Rpb25QbGFuZVRpbHQiLHZvaWQgMCksVChbUigpXSxqLnByb3RvdHlwZSwibWluWiIsdm9pZCAwKSxUKFtSKCldLGoucHJvdG90eXBlLCJtYXhaIix2b2lkIDApLFQoW1IoKV0sai5wcm90b3R5cGUsImluZXJ0aWEiLHZvaWQgMCksVChbUigpXSxqLnByb3RvdHlwZSwibW9kZSIsbnVsbCksVChbUigpXSxqLnByb3RvdHlwZSwibGF5ZXJNYXNrIix2b2lkIDApLFQoW1IoKV0sai5wcm90b3R5cGUsImZvdk1vZGUiLHZvaWQgMCksVChbUigpXSxqLnByb3RvdHlwZSwiY2FtZXJhUmlnTW9kZSIsdm9pZCAwKSxUKFtSKCldLGoucHJvdG90eXBlLCJpbnRlcmF4aWFsRGlzdGFuY2UiLHZvaWQgMCksVChbUigpXSxqLnByb3RvdHlwZSwiaXNTdGVyZW9zY29waWNTaWRlQnlTaWRlIix2b2lkIDApO2NsYXNzIGVle2NvbnN0cnVjdG9yKCl7dGhpcy5fYXBwbHlUbz1Mbih0aGlzLl9hcHBseVRvQ29yb3V0aW5lLmJpbmQodGhpcykpfXNldChlLHQpe3N3aXRjaChlLmxlbmd0aHx8Ty5XYXJuKGBTZXR0aW5nIHZlcnRleCBkYXRhIGtpbmQgJyR7dH0nIHdpdGggYW4gZW1wdHkgYXJyYXlgKSx0KXtjYXNlIGcuUG9zaXRpb25LaW5kOnRoaXMucG9zaXRpb25zPWU7YnJlYWs7Y2FzZSBnLk5vcm1hbEtpbmQ6dGhpcy5ub3JtYWxzPWU7YnJlYWs7Y2FzZSBnLlRhbmdlbnRLaW5kOnRoaXMudGFuZ2VudHM9ZTticmVhaztjYXNlIGcuVVZLaW5kOnRoaXMudXZzPWU7YnJlYWs7Y2FzZSBnLlVWMktpbmQ6dGhpcy51dnMyPWU7YnJlYWs7Y2FzZSBnLlVWM0tpbmQ6dGhpcy51dnMzPWU7YnJlYWs7Y2FzZSBnLlVWNEtpbmQ6dGhpcy51dnM0PWU7YnJlYWs7Y2FzZSBnLlVWNUtpbmQ6dGhpcy51dnM1PWU7YnJlYWs7Y2FzZSBnLlVWNktpbmQ6dGhpcy51dnM2PWU7YnJlYWs7Y2FzZSBnLkNvbG9yS2luZDp0aGlzLmNvbG9ycz1lO2JyZWFrO2Nhc2UgZy5NYXRyaWNlc0luZGljZXNLaW5kOnRoaXMubWF0cmljZXNJbmRpY2VzPWU7YnJlYWs7Y2FzZSBnLk1hdHJpY2VzV2VpZ2h0c0tpbmQ6dGhpcy5tYXRyaWNlc1dlaWdodHM9ZTticmVhaztjYXNlIGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kOnRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmE9ZTticmVhaztjYXNlIGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kOnRoaXMubWF0cmljZXNXZWlnaHRzRXh0cmE9ZTticmVha319YXBwbHlUb01lc2goZSx0KXtyZXR1cm4gdGhpcy5fYXBwbHlUbyhlLHQsITEpLHRoaXN9YXBwbHlUb0dlb21ldHJ5KGUsdCl7cmV0dXJuIHRoaXMuX2FwcGx5VG8oZSx0LCExKSx0aGlzfXVwZGF0ZU1lc2goZSl7cmV0dXJuIHRoaXMuX3VwZGF0ZShlKSx0aGlzfXVwZGF0ZUdlb21ldHJ5KGUpe3JldHVybiB0aGlzLl91cGRhdGUoZSksdGhpc30qX2FwcGx5VG9Db3JvdXRpbmUoZSx0PSExLGkpe3JldHVybiB0aGlzLnBvc2l0aW9ucyYmKGUuc2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kLHRoaXMucG9zaXRpb25zLHQpLGkmJih5aWVsZCkpLHRoaXMubm9ybWFscyYmKGUuc2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCx0aGlzLm5vcm1hbHMsdCksaSYmKHlpZWxkKSksdGhpcy50YW5nZW50cyYmKGUuc2V0VmVydGljZXNEYXRhKGcuVGFuZ2VudEtpbmQsdGhpcy50YW5nZW50cyx0KSxpJiYoeWllbGQpKSx0aGlzLnV2cyYmKGUuc2V0VmVydGljZXNEYXRhKGcuVVZLaW5kLHRoaXMudXZzLHQpLGkmJih5aWVsZCkpLHRoaXMudXZzMiYmKGUuc2V0VmVydGljZXNEYXRhKGcuVVYyS2luZCx0aGlzLnV2czIsdCksaSYmKHlpZWxkKSksdGhpcy51dnMzJiYoZS5zZXRWZXJ0aWNlc0RhdGEoZy5VVjNLaW5kLHRoaXMudXZzMyx0KSxpJiYoeWllbGQpKSx0aGlzLnV2czQmJihlLnNldFZlcnRpY2VzRGF0YShnLlVWNEtpbmQsdGhpcy51dnM0LHQpLGkmJih5aWVsZCkpLHRoaXMudXZzNSYmKGUuc2V0VmVydGljZXNEYXRhKGcuVVY1S2luZCx0aGlzLnV2czUsdCksaSYmKHlpZWxkKSksdGhpcy51dnM2JiYoZS5zZXRWZXJ0aWNlc0RhdGEoZy5VVjZLaW5kLHRoaXMudXZzNix0KSxpJiYoeWllbGQpKSx0aGlzLmNvbG9ycyYmKGUuc2V0VmVydGljZXNEYXRhKGcuQ29sb3JLaW5kLHRoaXMuY29sb3JzLHQpLGkmJih5aWVsZCkpLHRoaXMubWF0cmljZXNJbmRpY2VzJiYoZS5zZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzLHQpLGkmJih5aWVsZCkpLHRoaXMubWF0cmljZXNXZWlnaHRzJiYoZS5zZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc1dlaWdodHNLaW5kLHRoaXMubWF0cmljZXNXZWlnaHRzLHQpLGkmJih5aWVsZCkpLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEmJihlLnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCx0aGlzLm1hdHJpY2VzSW5kaWNlc0V4dHJhLHQpLGkmJih5aWVsZCkpLHRoaXMubWF0cmljZXNXZWlnaHRzRXh0cmEmJihlLnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCx0aGlzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhLHQpLGkmJih5aWVsZCkpLHRoaXMuaW5kaWNlcz8oZS5zZXRJbmRpY2VzKHRoaXMuaW5kaWNlcyxudWxsLHQpLGkmJih5aWVsZCkpOmUuc2V0SW5kaWNlcyhbXSxudWxsKSx0aGlzfV91cGRhdGUoZSx0LGkpe3JldHVybiB0aGlzLnBvc2l0aW9ucyYmZS51cGRhdGVWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsdGhpcy5wb3NpdGlvbnMsdCxpKSx0aGlzLm5vcm1hbHMmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCx0aGlzLm5vcm1hbHMsdCxpKSx0aGlzLnRhbmdlbnRzJiZlLnVwZGF0ZVZlcnRpY2VzRGF0YShnLlRhbmdlbnRLaW5kLHRoaXMudGFuZ2VudHMsdCxpKSx0aGlzLnV2cyYmZS51cGRhdGVWZXJ0aWNlc0RhdGEoZy5VVktpbmQsdGhpcy51dnMsdCxpKSx0aGlzLnV2czImJmUudXBkYXRlVmVydGljZXNEYXRhKGcuVVYyS2luZCx0aGlzLnV2czIsdCxpKSx0aGlzLnV2czMmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuVVYzS2luZCx0aGlzLnV2czMsdCxpKSx0aGlzLnV2czQmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuVVY0S2luZCx0aGlzLnV2czQsdCxpKSx0aGlzLnV2czUmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuVVY1S2luZCx0aGlzLnV2czUsdCxpKSx0aGlzLnV2czYmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuVVY2S2luZCx0aGlzLnV2czYsdCxpKSx0aGlzLmNvbG9ycyYmZS51cGRhdGVWZXJ0aWNlc0RhdGEoZy5Db2xvcktpbmQsdGhpcy5jb2xvcnMsdCxpKSx0aGlzLm1hdHJpY2VzSW5kaWNlcyYmZS51cGRhdGVWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzLHQsaSksdGhpcy5tYXRyaWNlc1dlaWdodHMmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCx0aGlzLm1hdHJpY2VzV2VpZ2h0cyx0LGkpLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEsdCxpKSx0aGlzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhJiZlLnVwZGF0ZVZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCx0aGlzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhLHQsaSksdGhpcy5pbmRpY2VzJiZlLnNldEluZGljZXModGhpcy5pbmRpY2VzLG51bGwpLHRoaXN9c3RhdGljIF9UcmFuc2Zvcm1WZWN0b3IzQ29vcmRpbmF0ZXMoZSx0LGk9MCxzPWUubGVuZ3RoKXtjb25zdCByPUQuVmVjdG9yM1swXSxuPUQuVmVjdG9yM1sxXTtmb3IobGV0IGE9aTthPGkrczthKz0zKXAuRnJvbUFycmF5VG9SZWYoZSxhLHIpLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZihyLHQsbiksZVthXT1uLngsZVthKzFdPW4ueSxlW2ErMl09bi56fXN0YXRpYyBfVHJhbnNmb3JtVmVjdG9yM05vcm1hbHMoZSx0LGk9MCxzPWUubGVuZ3RoKXtjb25zdCByPUQuVmVjdG9yM1swXSxuPUQuVmVjdG9yM1sxXTtmb3IobGV0IGE9aTthPGkrczthKz0zKXAuRnJvbUFycmF5VG9SZWYoZSxhLHIpLHAuVHJhbnNmb3JtTm9ybWFsVG9SZWYocix0LG4pLGVbYV09bi54LGVbYSsxXT1uLnksZVthKzJdPW4uen1zdGF0aWMgX1RyYW5zZm9ybVZlY3RvcjROb3JtYWxzKGUsdCxpPTAscz1lLmxlbmd0aCl7Y29uc3Qgcj1ELlZlY3RvcjRbMF0sbj1ELlZlY3RvcjRbMV07Zm9yKGxldCBhPWk7YTxpK3M7YSs9NClDZS5Gcm9tQXJyYXlUb1JlZihlLGEsciksQ2UuVHJhbnNmb3JtTm9ybWFsVG9SZWYocix0LG4pLGVbYV09bi54LGVbYSsxXT1uLnksZVthKzJdPW4ueixlW2ErM109bi53fXN0YXRpYyBfRmxpcEZhY2VzKGUsdD0wLGk9ZS5sZW5ndGgpe2ZvcihsZXQgcz10O3M8dCtpO3MrPTMpe2NvbnN0IHI9ZVtzKzFdO2VbcysxXT1lW3MrMl0sZVtzKzJdPXJ9fXRyYW5zZm9ybShlKXtjb25zdCB0PWUuZGV0ZXJtaW5hbnQoKTwwO3JldHVybiB0aGlzLnBvc2l0aW9ucyYmZWUuX1RyYW5zZm9ybVZlY3RvcjNDb29yZGluYXRlcyh0aGlzLnBvc2l0aW9ucyxlKSx0aGlzLm5vcm1hbHMmJmVlLl9UcmFuc2Zvcm1WZWN0b3IzTm9ybWFscyh0aGlzLm5vcm1hbHMsZSksdGhpcy50YW5nZW50cyYmZWUuX1RyYW5zZm9ybVZlY3RvcjROb3JtYWxzKHRoaXMudGFuZ2VudHMsZSksdCYmdGhpcy5pbmRpY2VzJiZlZS5fRmxpcEZhY2VzKHRoaXMuaW5kaWNlcyksdGhpc31tZXJnZShlLHQ9ITEsaT0hMSl7Y29uc3Qgcz1BcnJheS5pc0FycmF5KGUpP2UubWFwKHI9PltyLHZvaWQgMF0pOltbZSx2b2lkIDBdXTtyZXR1cm4gUHModGhpcy5fbWVyZ2VDb3JvdXRpbmUodm9pZCAwLHMsdCwhMSxpKSl9Kl9tZXJnZUNvcm91dGluZShlLHQsaT0hMSxzLHIpe3ZhciBuLGEsbyxoO3RoaXMuX3ZhbGlkYXRlKCk7Y29uc3QgbD10Lm1hcChfPT5fWzBdKTtmb3IoY29uc3QgXyBvZiBsKWlmKF8uX3ZhbGlkYXRlKCksIXRoaXMubm9ybWFscyE9IV8ubm9ybWFsc3x8IXRoaXMudGFuZ2VudHMhPSFfLnRhbmdlbnRzfHwhdGhpcy51dnMhPSFfLnV2c3x8IXRoaXMudXZzMiE9IV8udXZzMnx8IXRoaXMudXZzMyE9IV8udXZzM3x8IXRoaXMudXZzNCE9IV8udXZzNHx8IXRoaXMudXZzNSE9IV8udXZzNXx8IXRoaXMudXZzNiE9IV8udXZzNnx8IXRoaXMuY29sb3JzIT0hXy5jb2xvcnN8fCF0aGlzLm1hdHJpY2VzSW5kaWNlcyE9IV8ubWF0cmljZXNJbmRpY2VzfHwhdGhpcy5tYXRyaWNlc1dlaWdodHMhPSFfLm1hdHJpY2VzV2VpZ2h0c3x8IXRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEhPSFfLm1hdHJpY2VzSW5kaWNlc0V4dHJhfHwhdGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYSE9IV8ubWF0cmljZXNXZWlnaHRzRXh0cmEpdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgbWVyZ2UgdmVydGV4IGRhdGEgdGhhdCBkbyBub3QgaGF2ZSB0aGUgc2FtZSBzZXQgb2YgYXR0cmlidXRlcyIpO2NvbnN0IHU9bC5yZWR1Y2UoKF8sRSk9Pnt2YXIgbSx2O3JldHVybiBfKygodj0obT1FLmluZGljZXMpPT09bnVsbHx8bT09PXZvaWQgMD92b2lkIDA6bS5sZW5ndGgpIT09bnVsbCYmdiE9PXZvaWQgMD92OjApfSwoYT0obj10aGlzLmluZGljZXMpPT09bnVsbHx8bj09PXZvaWQgMD92b2lkIDA6bi5sZW5ndGgpIT09bnVsbCYmYSE9PXZvaWQgMD9hOjApO2xldCBmPXJ8fGwuc29tZShfPT5fLmluZGljZXM9PT10aGlzLmluZGljZXMpPyhvPXRoaXMuaW5kaWNlcyk9PT1udWxsfHxvPT09dm9pZCAwP3ZvaWQgMDpvLnNsaWNlKCk6dGhpcy5pbmRpY2VzO2lmKHU+MCl7bGV0IF89KGg9Zj09bnVsbD92b2lkIDA6Zi5sZW5ndGgpIT09bnVsbCYmaCE9PXZvaWQgMD9oOjA7aWYoZnx8KGY9bmV3IEFycmF5KHUpKSxmLmxlbmd0aCE9PXUpe2lmKEFycmF5LmlzQXJyYXkoZikpZi5sZW5ndGg9dTtlbHNle2NvbnN0IG09aXx8ZiBpbnN0YW5jZW9mIFVpbnQzMkFycmF5P25ldyBVaW50MzJBcnJheSh1KTpuZXcgVWludDE2QXJyYXkodSk7bS5zZXQoZiksZj1tfWUmJmUuZGV0ZXJtaW5hbnQoKTwwJiZlZS5fRmxpcEZhY2VzKGYsMCxfKX1sZXQgRT10aGlzLnBvc2l0aW9ucz90aGlzLnBvc2l0aW9ucy5sZW5ndGgvMzowO2Zvcihjb25zdFttLHZdb2YgdClpZihtLmluZGljZXMpe2ZvcihsZXQgUz0wO1M8bS5pbmRpY2VzLmxlbmd0aDtTKyspZltfK1NdPW0uaW5kaWNlc1tTXStFO3YmJnYuZGV0ZXJtaW5hbnQoKTwwJiZlZS5fRmxpcEZhY2VzKGYsXyxtLmluZGljZXMubGVuZ3RoKSxFKz1tLnBvc2l0aW9ucy5sZW5ndGgvMyxfKz1tLmluZGljZXMubGVuZ3RoLHMmJih5aWVsZCl9fXJldHVybiB0aGlzLmluZGljZXM9Zix0aGlzLnBvc2l0aW9ucz1lZS5fTWVyZ2VFbGVtZW50KGcuUG9zaXRpb25LaW5kLHRoaXMucG9zaXRpb25zLGUsdC5tYXAoXz0+W19bMF0ucG9zaXRpb25zLF9bMV1dKSkscyYmKHlpZWxkKSx0aGlzLm5vcm1hbHM9ZWUuX01lcmdlRWxlbWVudChnLk5vcm1hbEtpbmQsdGhpcy5ub3JtYWxzLGUsdC5tYXAoXz0+W19bMF0ubm9ybWFscyxfWzFdXSkpLHMmJih5aWVsZCksdGhpcy50YW5nZW50cz1lZS5fTWVyZ2VFbGVtZW50KGcuVGFuZ2VudEtpbmQsdGhpcy50YW5nZW50cyxlLHQubWFwKF89PltfWzBdLnRhbmdlbnRzLF9bMV1dKSkscyYmKHlpZWxkKSx0aGlzLnV2cz1lZS5fTWVyZ2VFbGVtZW50KGcuVVZLaW5kLHRoaXMudXZzLGUsdC5tYXAoXz0+W19bMF0udXZzLF9bMV1dKSkscyYmKHlpZWxkKSx0aGlzLnV2czI9ZWUuX01lcmdlRWxlbWVudChnLlVWMktpbmQsdGhpcy51dnMyLGUsdC5tYXAoXz0+W19bMF0udXZzMixfWzFdXSkpLHMmJih5aWVsZCksdGhpcy51dnMzPWVlLl9NZXJnZUVsZW1lbnQoZy5VVjNLaW5kLHRoaXMudXZzMyxlLHQubWFwKF89PltfWzBdLnV2czMsX1sxXV0pKSxzJiYoeWllbGQpLHRoaXMudXZzND1lZS5fTWVyZ2VFbGVtZW50KGcuVVY0S2luZCx0aGlzLnV2czQsZSx0Lm1hcChfPT5bX1swXS51dnM0LF9bMV1dKSkscyYmKHlpZWxkKSx0aGlzLnV2czU9ZWUuX01lcmdlRWxlbWVudChnLlVWNUtpbmQsdGhpcy51dnM1LGUsdC5tYXAoXz0+W19bMF0udXZzNSxfWzFdXSkpLHMmJih5aWVsZCksdGhpcy51dnM2PWVlLl9NZXJnZUVsZW1lbnQoZy5VVjZLaW5kLHRoaXMudXZzNixlLHQubWFwKF89PltfWzBdLnV2czYsX1sxXV0pKSxzJiYoeWllbGQpLHRoaXMuY29sb3JzPWVlLl9NZXJnZUVsZW1lbnQoZy5Db2xvcktpbmQsdGhpcy5jb2xvcnMsZSx0Lm1hcChfPT5bX1swXS5jb2xvcnMsX1sxXV0pKSxzJiYoeWllbGQpLHRoaXMubWF0cmljZXNJbmRpY2VzPWVlLl9NZXJnZUVsZW1lbnQoZy5NYXRyaWNlc0luZGljZXNLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzLGUsdC5tYXAoXz0+W19bMF0ubWF0cmljZXNJbmRpY2VzLF9bMV1dKSkscyYmKHlpZWxkKSx0aGlzLm1hdHJpY2VzV2VpZ2h0cz1lZS5fTWVyZ2VFbGVtZW50KGcuTWF0cmljZXNXZWlnaHRzS2luZCx0aGlzLm1hdHJpY2VzV2VpZ2h0cyxlLHQubWFwKF89PltfWzBdLm1hdHJpY2VzV2VpZ2h0cyxfWzFdXSkpLHMmJih5aWVsZCksdGhpcy5tYXRyaWNlc0luZGljZXNFeHRyYT1lZS5fTWVyZ2VFbGVtZW50KGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEsZSx0Lm1hcChfPT5bX1swXS5tYXRyaWNlc0luZGljZXNFeHRyYSxfWzFdXSkpLHMmJih5aWVsZCksdGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYT1lZS5fTWVyZ2VFbGVtZW50KGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kLHRoaXMubWF0cmljZXNXZWlnaHRzRXh0cmEsZSx0Lm1hcChfPT5bX1swXS5tYXRyaWNlc1dlaWdodHNFeHRyYSxfWzFdXSkpLHRoaXN9c3RhdGljIF9NZXJnZUVsZW1lbnQoZSx0LGkscyl7Y29uc3Qgcj1zLmZpbHRlcihvPT5vWzBdIT09bnVsbCYmb1swXSE9PXZvaWQgMCk7aWYoIXQmJnIubGVuZ3RoPT0wKXJldHVybiB0O2lmKCF0KXJldHVybiB0aGlzLl9NZXJnZUVsZW1lbnQoZSxyWzBdWzBdLHJbMF1bMV0sci5zbGljZSgxKSk7Y29uc3Qgbj1yLnJlZHVjZSgobyxoKT0+bytoWzBdLmxlbmd0aCx0Lmxlbmd0aCksYT1lPT09Zy5Qb3NpdGlvbktpbmQ/ZWUuX1RyYW5zZm9ybVZlY3RvcjNDb29yZGluYXRlczplPT09Zy5Ob3JtYWxLaW5kP2VlLl9UcmFuc2Zvcm1WZWN0b3IzTm9ybWFsczplPT09Zy5UYW5nZW50S2luZD9lZS5fVHJhbnNmb3JtVmVjdG9yNE5vcm1hbHM6KCk9Pnt9O2lmKHQgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXkpe2NvbnN0IG89bmV3IEZsb2F0MzJBcnJheShuKTtvLnNldCh0KSxpJiZhKG8saSwwLHQubGVuZ3RoKTtsZXQgaD10Lmxlbmd0aDtmb3IoY29uc3RbbCx1XW9mIHIpby5zZXQobCxoKSx1JiZhKG8sdSxoLGwubGVuZ3RoKSxoKz1sLmxlbmd0aDtyZXR1cm4gb31lbHNle2NvbnN0IG89bmV3IEFycmF5KG4pO2ZvcihsZXQgbD0wO2w8dC5sZW5ndGg7bCsrKW9bbF09dFtsXTtpJiZhKG8saSwwLHQubGVuZ3RoKTtsZXQgaD10Lmxlbmd0aDtmb3IoY29uc3RbbCx1XW9mIHIpe2ZvcihsZXQgZD0wO2Q8bC5sZW5ndGg7ZCsrKW9baCtkXT1sW2RdO3UmJmEobyx1LGgsbC5sZW5ndGgpLGgrPWwubGVuZ3RofXJldHVybiBvfX1fdmFsaWRhdGUoKXtpZighdGhpcy5wb3NpdGlvbnMpdGhyb3cgbmV3IE50KCJQb3NpdGlvbnMgYXJlIHJlcXVpcmVkIixvaS5NZXNoSW52YWxpZFBvc2l0aW9uc0Vycm9yKTtjb25zdCBlPShzLHIpPT57Y29uc3Qgbj1nLkRlZHVjZVN0cmlkZShzKTtpZihyLmxlbmd0aCVuIT09MCl0aHJvdyBuZXcgRXJyb3IoIlRoZSAiK3MrInMgYXJyYXkgY291bnQgbXVzdCBiZSBhIG11bHRpcGxlIG9mICIrbik7cmV0dXJuIHIubGVuZ3RoL259LHQ9ZShnLlBvc2l0aW9uS2luZCx0aGlzLnBvc2l0aW9ucyksaT0ocyxyKT0+e2NvbnN0IG49ZShzLHIpO2lmKG4hPT10KXRocm93IG5ldyBFcnJvcigiVGhlICIrcysicyBlbGVtZW50IGNvdW50ICgiK24rIikgZG9lcyBub3QgbWF0Y2ggdGhlIHBvc2l0aW9ucyBjb3VudCAoIit0KyIpIil9O3RoaXMubm9ybWFscyYmaShnLk5vcm1hbEtpbmQsdGhpcy5ub3JtYWxzKSx0aGlzLnRhbmdlbnRzJiZpKGcuVGFuZ2VudEtpbmQsdGhpcy50YW5nZW50cyksdGhpcy51dnMmJmkoZy5VVktpbmQsdGhpcy51dnMpLHRoaXMudXZzMiYmaShnLlVWMktpbmQsdGhpcy51dnMyKSx0aGlzLnV2czMmJmkoZy5VVjNLaW5kLHRoaXMudXZzMyksdGhpcy51dnM0JiZpKGcuVVY0S2luZCx0aGlzLnV2czQpLHRoaXMudXZzNSYmaShnLlVWNUtpbmQsdGhpcy51dnM1KSx0aGlzLnV2czYmJmkoZy5VVjZLaW5kLHRoaXMudXZzNiksdGhpcy5jb2xvcnMmJmkoZy5Db2xvcktpbmQsdGhpcy5jb2xvcnMpLHRoaXMubWF0cmljZXNJbmRpY2VzJiZpKGcuTWF0cmljZXNJbmRpY2VzS2luZCx0aGlzLm1hdHJpY2VzSW5kaWNlcyksdGhpcy5tYXRyaWNlc1dlaWdodHMmJmkoZy5NYXRyaWNlc1dlaWdodHNLaW5kLHRoaXMubWF0cmljZXNXZWlnaHRzKSx0aGlzLm1hdHJpY2VzSW5kaWNlc0V4dHJhJiZpKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEpLHRoaXMubWF0cmljZXNXZWlnaHRzRXh0cmEmJmkoZy5NYXRyaWNlc1dlaWdodHNFeHRyYUtpbmQsdGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYSl9c2VyaWFsaXplKCl7Y29uc3QgZT17fTtyZXR1cm4gdGhpcy5wb3NpdGlvbnMmJihlLnBvc2l0aW9ucz10aGlzLnBvc2l0aW9ucyksdGhpcy5ub3JtYWxzJiYoZS5ub3JtYWxzPXRoaXMubm9ybWFscyksdGhpcy50YW5nZW50cyYmKGUudGFuZ2VudHM9dGhpcy50YW5nZW50cyksdGhpcy51dnMmJihlLnV2cz10aGlzLnV2cyksdGhpcy51dnMyJiYoZS51dnMyPXRoaXMudXZzMiksdGhpcy51dnMzJiYoZS51dnMzPXRoaXMudXZzMyksdGhpcy51dnM0JiYoZS51dnM0PXRoaXMudXZzNCksdGhpcy51dnM1JiYoZS51dnM1PXRoaXMudXZzNSksdGhpcy51dnM2JiYoZS51dnM2PXRoaXMudXZzNiksdGhpcy5jb2xvcnMmJihlLmNvbG9ycz10aGlzLmNvbG9ycyksdGhpcy5tYXRyaWNlc0luZGljZXMmJihlLm1hdHJpY2VzSW5kaWNlcz10aGlzLm1hdHJpY2VzSW5kaWNlcyxlLm1hdHJpY2VzSW5kaWNlcy5faXNFeHBhbmRlZD0hMCksdGhpcy5tYXRyaWNlc1dlaWdodHMmJihlLm1hdHJpY2VzV2VpZ2h0cz10aGlzLm1hdHJpY2VzV2VpZ2h0cyksdGhpcy5tYXRyaWNlc0luZGljZXNFeHRyYSYmKGUubWF0cmljZXNJbmRpY2VzRXh0cmE9dGhpcy5tYXRyaWNlc0luZGljZXNFeHRyYSxlLm1hdHJpY2VzSW5kaWNlc0V4dHJhLl9pc0V4cGFuZGVkPSEwKSx0aGlzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhJiYoZS5tYXRyaWNlc1dlaWdodHNFeHRyYT10aGlzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhKSxlLmluZGljZXM9dGhpcy5pbmRpY2VzLGV9c3RhdGljIEV4dHJhY3RGcm9tTWVzaChlLHQsaSl7cmV0dXJuIGVlLl9FeHRyYWN0RnJvbShlLHQsaSl9c3RhdGljIEV4dHJhY3RGcm9tR2VvbWV0cnkoZSx0LGkpe3JldHVybiBlZS5fRXh0cmFjdEZyb20oZSx0LGkpfXN0YXRpYyBfRXh0cmFjdEZyb20oZSx0LGkpe2NvbnN0IHM9bmV3IGVlO3JldHVybiBlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlBvc2l0aW9uS2luZCkmJihzLnBvc2l0aW9ucz1lLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk5vcm1hbEtpbmQpJiYocy5ub3JtYWxzPWUuZ2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlRhbmdlbnRLaW5kKSYmKHMudGFuZ2VudHM9ZS5nZXRWZXJ0aWNlc0RhdGEoZy5UYW5nZW50S2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWS2luZCkmJihzLnV2cz1lLmdldFZlcnRpY2VzRGF0YShnLlVWS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWMktpbmQpJiYocy51dnMyPWUuZ2V0VmVydGljZXNEYXRhKGcuVVYyS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWM0tpbmQpJiYocy51dnMzPWUuZ2V0VmVydGljZXNEYXRhKGcuVVYzS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNEtpbmQpJiYocy51dnM0PWUuZ2V0VmVydGljZXNEYXRhKGcuVVY0S2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNUtpbmQpJiYocy51dnM1PWUuZ2V0VmVydGljZXNEYXRhKGcuVVY1S2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNktpbmQpJiYocy51dnM2PWUuZ2V0VmVydGljZXNEYXRhKGcuVVY2S2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLkNvbG9yS2luZCkmJihzLmNvbG9ycz1lLmdldFZlcnRpY2VzRGF0YShnLkNvbG9yS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk1hdHJpY2VzSW5kaWNlc0tpbmQpJiYocy5tYXRyaWNlc0luZGljZXM9ZS5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kLHQsaSkpLGUuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTWF0cmljZXNXZWlnaHRzS2luZCkmJihzLm1hdHJpY2VzV2VpZ2h0cz1lLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQsdCxpKSksZS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5NYXRyaWNlc0luZGljZXNFeHRyYUtpbmQpJiYocy5tYXRyaWNlc0luZGljZXNFeHRyYT1lLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCkmJihzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhPWUuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kLHQsaSkpLHMuaW5kaWNlcz1lLmdldEluZGljZXModCxpKSxzfXN0YXRpYyBDcmVhdGVSaWJib24oZSl7dGhyb3cgJCgicmliYm9uQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVCb3goZSl7dGhyb3cgJCgiYm94QnVpbGRlciIpfXN0YXRpYyBDcmVhdGVUaWxlZEJveChlKXt0aHJvdyAkKCJ0aWxlZEJveEJ1aWxkZXIiKX1zdGF0aWMgQ3JlYXRlVGlsZWRQbGFuZShlKXt0aHJvdyAkKCJ0aWxlZFBsYW5lQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVTcGhlcmUoZSl7dGhyb3cgJCgic3BoZXJlQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVDeWxpbmRlcihlKXt0aHJvdyAkKCJjeWxpbmRlckJ1aWxkZXIiKX1zdGF0aWMgQ3JlYXRlVG9ydXMoZSl7dGhyb3cgJCgidG9ydXNCdWlsZGVyIil9c3RhdGljIENyZWF0ZUxpbmVTeXN0ZW0oZSl7dGhyb3cgJCgibGluZXNCdWlsZGVyIil9c3RhdGljIENyZWF0ZURhc2hlZExpbmVzKGUpe3Rocm93ICQoImxpbmVzQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVHcm91bmQoZSl7dGhyb3cgJCgiZ3JvdW5kQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVUaWxlZEdyb3VuZChlKXt0aHJvdyAkKCJncm91bmRCdWlsZGVyIil9c3RhdGljIENyZWF0ZUdyb3VuZEZyb21IZWlnaHRNYXAoZSl7dGhyb3cgJCgiZ3JvdW5kQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVQbGFuZShlKXt0aHJvdyAkKCJwbGFuZUJ1aWxkZXIiKX1zdGF0aWMgQ3JlYXRlRGlzYyhlKXt0aHJvdyAkKCJkaXNjQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVQb2x5Z29uKGUsdCxpLHMscixuLGEpe3Rocm93ICQoInBvbHlnb25CdWlsZGVyIil9c3RhdGljIENyZWF0ZUljb1NwaGVyZShlKXt0aHJvdyAkKCJpY29TcGhlcmVCdWlsZGVyIil9c3RhdGljIENyZWF0ZVBvbHloZWRyb24oZSl7dGhyb3cgJCgicG9seWhlZHJvbkJ1aWxkZXIiKX1zdGF0aWMgQ3JlYXRlQ2Fwc3VsZShlPXtvcmllbnRhdGlvbjpwLlVwKCksc3ViZGl2aXNpb25zOjIsdGVzc2VsbGF0aW9uOjE2LGhlaWdodDoxLHJhZGl1czouMjUsY2FwU3ViZGl2aXNpb25zOjZ9KXt0aHJvdyAkKCJjYXBzdWxlQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVUb3J1c0tub3QoZSl7dGhyb3cgJCgidG9ydXNLbm90QnVpbGRlciIpfXN0YXRpYyBDb21wdXRlTm9ybWFscyhlLHQsaSxzKXtsZXQgcj0wLG49MCxhPTAsbz0wLGg9MCxsPTAsdT0wLGQ9MCxmPTAsXz0wLEU9MCxtPTAsdj0wLFM9MCx5PTAsQT0wLEM9MCxiPTAsTT0wLEw9MCxrPSExLHc9ITEsZGU9ITEsY2U9ITEsc2U9MSx0ZT0wLEZlPW51bGw7cyYmKGs9ISFzLmZhY2V0Tm9ybWFscyx3PSEhcy5mYWNldFBvc2l0aW9ucyxkZT0hIXMuZmFjZXRQYXJ0aXRpb25pbmcsc2U9cy51c2VSaWdodEhhbmRlZFN5c3RlbT09PSEwPy0xOjEsdGU9cy5yYXRpb3x8MCxjZT0hIXMuZGVwdGhTb3J0LEZlPXMuZGlzdGFuY2VUbyxjZSYmRmU9PT12b2lkIDAmJihGZT1wLlplcm8oKSkpO2xldCB3ZT0wLEhlPTAsS2U9MCxZZT0wO2ZvcihkZSYmcyYmcy5iYlNpemUmJih3ZT1zLnN1YkRpdi5YKnRlL3MuYmJTaXplLngsSGU9cy5zdWJEaXYuWSp0ZS9zLmJiU2l6ZS55LEtlPXMuc3ViRGl2LloqdGUvcy5iYlNpemUueixZZT1zLnN1YkRpdi5tYXgqcy5zdWJEaXYubWF4LHMuZmFjZXRQYXJ0aXRpb25pbmcubGVuZ3RoPTApLHI9MDtyPGUubGVuZ3RoO3IrKylpW3JdPTA7Y29uc3QgcHQ9dC5sZW5ndGgvM3wwO2ZvcihyPTA7cjxwdDtyKyspe2lmKG09dFtyKjNdKjMsdj1tKzEsUz1tKzIseT10W3IqMysxXSozLEE9eSsxLEM9eSsyLGI9dFtyKjMrMl0qMyxNPWIrMSxMPWIrMixuPWVbbV0tZVt5XSxhPWVbdl0tZVtBXSxvPWVbU10tZVtDXSxoPWVbYl0tZVt5XSxsPWVbTV0tZVtBXSx1PWVbTF0tZVtDXSxkPXNlKihhKnUtbypsKSxmPXNlKihvKmgtbip1KSxfPXNlKihuKmwtYSpoKSxFPU1hdGguc3FydChkKmQrZipmK18qXyksRT1FPT09MD8xOkUsZC89RSxmLz1FLF8vPUUsayYmcyYmKHMuZmFjZXROb3JtYWxzW3JdLng9ZCxzLmZhY2V0Tm9ybWFsc1tyXS55PWYscy5mYWNldE5vcm1hbHNbcl0uej1fKSx3JiZzJiYocy5mYWNldFBvc2l0aW9uc1tyXS54PShlW21dK2VbeV0rZVtiXSkvMyxzLmZhY2V0UG9zaXRpb25zW3JdLnk9KGVbdl0rZVtBXStlW01dKS8zLHMuZmFjZXRQb3NpdGlvbnNbcl0uej0oZVtTXStlW0NdK2VbTF0pLzMpLGRlJiZzKXtjb25zdCBodD1NYXRoLmZsb29yKChzLmZhY2V0UG9zaXRpb25zW3JdLngtcy5iSW5mby5taW5pbXVtLngqdGUpKndlKSx3dD1NYXRoLmZsb29yKChzLmZhY2V0UG9zaXRpb25zW3JdLnktcy5iSW5mby5taW5pbXVtLnkqdGUpKkhlKSxzaT1NYXRoLmZsb29yKChzLmZhY2V0UG9zaXRpb25zW3JdLnotcy5iSW5mby5taW5pbXVtLnoqdGUpKktlKSxkcz1NYXRoLmZsb29yKChlW21dLXMuYkluZm8ubWluaW11bS54KnRlKSp3ZSksZnM9TWF0aC5mbG9vcigoZVt2XS1zLmJJbmZvLm1pbmltdW0ueSp0ZSkqSGUpLF9zPU1hdGguZmxvb3IoKGVbU10tcy5iSW5mby5taW5pbXVtLnoqdGUpKktlKSxYcz1NYXRoLmZsb29yKChlW3ldLXMuYkluZm8ubWluaW11bS54KnRlKSp3ZSksSHM9TWF0aC5mbG9vcigoZVtBXS1zLmJJbmZvLm1pbmltdW0ueSp0ZSkqSGUpLEtzPU1hdGguZmxvb3IoKGVbQ10tcy5iSW5mby5taW5pbXVtLnoqdGUpKktlKSxZcz1NYXRoLmZsb29yKChlW2JdLXMuYkluZm8ubWluaW11bS54KnRlKSp3ZSksWnM9TWF0aC5mbG9vcigoZVtNXS1zLmJJbmZvLm1pbmltdW0ueSp0ZSkqSGUpLHFzPU1hdGguZmxvb3IoKGVbTF0tcy5iSW5mby5taW5pbXVtLnoqdGUpKktlKSxIdD1kcytzLnN1YkRpdi5tYXgqZnMrWWUqX3MsS3Q9WHMrcy5zdWJEaXYubWF4KkhzK1llKktzLFl0PVlzK3Muc3ViRGl2Lm1heCpacytZZSpxcyxadD1odCtzLnN1YkRpdi5tYXgqd3QrWWUqc2k7cy5mYWNldFBhcnRpdGlvbmluZ1tadF09cy5mYWNldFBhcnRpdGlvbmluZ1tadF0/cy5mYWNldFBhcnRpdGlvbmluZ1tadF06bmV3IEFycmF5LHMuZmFjZXRQYXJ0aXRpb25pbmdbSHRdPXMuZmFjZXRQYXJ0aXRpb25pbmdbSHRdP3MuZmFjZXRQYXJ0aXRpb25pbmdbSHRdOm5ldyBBcnJheSxzLmZhY2V0UGFydGl0aW9uaW5nW0t0XT1zLmZhY2V0UGFydGl0aW9uaW5nW0t0XT9zLmZhY2V0UGFydGl0aW9uaW5nW0t0XTpuZXcgQXJyYXkscy5mYWNldFBhcnRpdGlvbmluZ1tZdF09cy5mYWNldFBhcnRpdGlvbmluZ1tZdF0/cy5mYWNldFBhcnRpdGlvbmluZ1tZdF06bmV3IEFycmF5LHMuZmFjZXRQYXJ0aXRpb25pbmdbSHRdLnB1c2gociksS3QhPUh0JiZzLmZhY2V0UGFydGl0aW9uaW5nW0t0XS5wdXNoKHIpLFl0PT1LdHx8WXQ9PUh0fHxzLmZhY2V0UGFydGl0aW9uaW5nW1l0XS5wdXNoKHIpLFp0PT1IdHx8WnQ9PUt0fHxadD09WXR8fHMuZmFjZXRQYXJ0aXRpb25pbmdbWnRdLnB1c2gocil9aWYoY2UmJnMmJnMuZmFjZXRQb3NpdGlvbnMpe2NvbnN0IGh0PXMuZGVwdGhTb3J0ZWRGYWNldHNbcl07aHQuaW5kPXIqMyxodC5zcURpc3RhbmNlPXAuRGlzdGFuY2VTcXVhcmVkKHMuZmFjZXRQb3NpdGlvbnNbcl0sRmUpfWlbbV0rPWQsaVt2XSs9ZixpW1NdKz1fLGlbeV0rPWQsaVtBXSs9ZixpW0NdKz1fLGlbYl0rPWQsaVtNXSs9ZixpW0xdKz1ffWZvcihyPTA7cjxpLmxlbmd0aC8zO3IrKylkPWlbciozXSxmPWlbciozKzFdLF89aVtyKjMrMl0sRT1NYXRoLnNxcnQoZCpkK2YqZitfKl8pLEU9RT09PTA/MTpFLGQvPUUsZi89RSxfLz1FLGlbciozXT1kLGlbciozKzFdPWYsaVtyKjMrMl09X31zdGF0aWMgX0NvbXB1dGVTaWRlcyhlLHQsaSxzLHIsbixhKXtjb25zdCBvPWkubGVuZ3RoLGg9cy5sZW5ndGg7bGV0IGwsdTtzd2l0Y2goZT1lfHxlZS5ERUZBVUxUU0lERSxlKXtjYXNlIGVlLkZST05UU0lERTpicmVhaztjYXNlIGVlLkJBQ0tTSURFOmZvcihsPTA7bDxvO2wrPTMpe2NvbnN0IGQ9aVtsXTtpW2xdPWlbbCsyXSxpW2wrMl09ZH1mb3IodT0wO3U8aDt1Kyspc1t1XT0tc1t1XTticmVhaztjYXNlIGVlLkRPVUJMRVNJREU6e2NvbnN0IGQ9dC5sZW5ndGgsZj1kLzM7Zm9yKGxldCBtPTA7bTxkO20rKyl0W2QrbV09dFttXTtmb3IobD0wO2w8bztsKz0zKWlbbCtvXT1pW2wrMl0rZixpW2wrMStvXT1pW2wrMV0rZixpW2wrMitvXT1pW2xdK2Y7Zm9yKHU9MDt1PGg7dSsrKXNbaCt1XT0tc1t1XTtjb25zdCBfPXIubGVuZ3RoO2xldCBFPTA7Zm9yKEU9MDtFPF87RSsrKXJbRStfXT1yW0VdO2ZvcihuPW58fG5ldyBDZSgwLDAsMSwxKSxhPWF8fG5ldyBDZSgwLDAsMSwxKSxFPTAsbD0wO2w8Xy8yO2wrKylyW0VdPW4ueCsobi56LW4ueCkqcltFXSxyW0UrMV09bi55KyhuLnctbi55KSpyW0UrMV0scltFK19dPWEueCsoYS56LWEueCkqcltFK19dLHJbRStfKzFdPWEueSsoYS53LWEueSkqcltFK18rMV0sRSs9MjticmVha319fXN0YXRpYyBJbXBvcnRWZXJ0ZXhEYXRhKGUsdCl7Y29uc3QgaT1uZXcgZWUscz1lLnBvc2l0aW9ucztzJiZpLnNldChzLGcuUG9zaXRpb25LaW5kKTtjb25zdCByPWUubm9ybWFscztyJiZpLnNldChyLGcuTm9ybWFsS2luZCk7Y29uc3Qgbj1lLnRhbmdlbnRzO24mJmkuc2V0KG4sZy5UYW5nZW50S2luZCk7Y29uc3QgYT1lLnV2czthJiZpLnNldChhLGcuVVZLaW5kKTtjb25zdCBvPWUudXYycztvJiZpLnNldChvLGcuVVYyS2luZCk7Y29uc3QgaD1lLnV2M3M7aCYmaS5zZXQoaCxnLlVWM0tpbmQpO2NvbnN0IGw9ZS51djRzO2wmJmkuc2V0KGwsZy5VVjRLaW5kKTtjb25zdCB1PWUudXY1czt1JiZpLnNldCh1LGcuVVY1S2luZCk7Y29uc3QgZD1lLnV2NnM7ZCYmaS5zZXQoZCxnLlVWNktpbmQpO2NvbnN0IGY9ZS5jb2xvcnM7ZiYmaS5zZXQobWUuQ2hlY2tDb2xvcnM0KGYscy5sZW5ndGgvMyksZy5Db2xvcktpbmQpO2NvbnN0IF89ZS5tYXRyaWNlc0luZGljZXM7XyYmaS5zZXQoXyxnLk1hdHJpY2VzSW5kaWNlc0tpbmQpO2NvbnN0IEU9ZS5tYXRyaWNlc1dlaWdodHM7RSYmaS5zZXQoRSxnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpO2NvbnN0IG09ZS5pbmRpY2VzO20mJihpLmluZGljZXM9bSksdC5zZXRBbGxWZXJ0aWNlc0RhdGEoaSxlLnVwZGF0YWJsZSl9fWVlLkZST05UU0lERT0wLGVlLkJBQ0tTSURFPTEsZWUuRE9VQkxFU0lERT0yLGVlLkRFRkFVTFRTSURFPTAsVChbJHQuZmlsdGVyKCguLi5bY10pPT4hQXJyYXkuaXNBcnJheShjKSldLGVlLCJfVHJhbnNmb3JtVmVjdG9yM0Nvb3JkaW5hdGVzIixudWxsKSxUKFskdC5maWx0ZXIoKC4uLltjXSk9PiFBcnJheS5pc0FycmF5KGMpKV0sZWUsIl9UcmFuc2Zvcm1WZWN0b3IzTm9ybWFscyIsbnVsbCksVChbJHQuZmlsdGVyKCguLi5bY10pPT4hQXJyYXkuaXNBcnJheShjKSldLGVlLCJfVHJhbnNmb3JtVmVjdG9yNE5vcm1hbHMiLG51bGwpLFQoWyR0LmZpbHRlcigoLi4uW2NdKT0+IUFycmF5LmlzQXJyYXkoYykpXSxlZSwiX0ZsaXBGYWNlcyIsbnVsbCk7Y2xhc3MgRHN7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMuYnU9ZSx0aGlzLmJ2PXQsdGhpcy5kaXN0YW5jZT1pLHRoaXMuZmFjZUlkPTAsdGhpcy5zdWJNZXNoSWQ9MH19Y2xhc3Mga3R7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMudmVjdG9ycz1CZS5CdWlsZEFycmF5KDgscC5aZXJvKSx0aGlzLmNlbnRlcj1wLlplcm8oKSx0aGlzLmNlbnRlcldvcmxkPXAuWmVybygpLHRoaXMuZXh0ZW5kU2l6ZT1wLlplcm8oKSx0aGlzLmV4dGVuZFNpemVXb3JsZD1wLlplcm8oKSx0aGlzLmRpcmVjdGlvbnM9QmUuQnVpbGRBcnJheSgzLHAuWmVybyksdGhpcy52ZWN0b3JzV29ybGQ9QmUuQnVpbGRBcnJheSg4LHAuWmVybyksdGhpcy5taW5pbXVtV29ybGQ9cC5aZXJvKCksdGhpcy5tYXhpbXVtV29ybGQ9cC5aZXJvKCksdGhpcy5taW5pbXVtPXAuWmVybygpLHRoaXMubWF4aW11bT1wLlplcm8oKSx0aGlzLl9kcmF3V3JhcHBlckZyb250PW51bGwsdGhpcy5fZHJhd1dyYXBwZXJCYWNrPW51bGwsdGhpcy5yZUNvbnN0cnVjdChlLHQsaSl9cmVDb25zdHJ1Y3QoZSx0LGkpe2NvbnN0IHM9ZS54LHI9ZS55LG49ZS56LGE9dC54LG89dC55LGg9dC56LGw9dGhpcy52ZWN0b3JzO3RoaXMubWluaW11bS5jb3B5RnJvbUZsb2F0cyhzLHIsbiksdGhpcy5tYXhpbXVtLmNvcHlGcm9tRmxvYXRzKGEsbyxoKSxsWzBdLmNvcHlGcm9tRmxvYXRzKHMscixuKSxsWzFdLmNvcHlGcm9tRmxvYXRzKGEsbyxoKSxsWzJdLmNvcHlGcm9tRmxvYXRzKGEscixuKSxsWzNdLmNvcHlGcm9tRmxvYXRzKHMsbyxuKSxsWzRdLmNvcHlGcm9tRmxvYXRzKHMscixoKSxsWzVdLmNvcHlGcm9tRmxvYXRzKGEsbyxuKSxsWzZdLmNvcHlGcm9tRmxvYXRzKHMsbyxoKSxsWzddLmNvcHlGcm9tRmxvYXRzKGEscixoKSx0LmFkZFRvUmVmKGUsdGhpcy5jZW50ZXIpLnNjYWxlSW5QbGFjZSguNSksdC5zdWJ0cmFjdFRvUmVmKGUsdGhpcy5leHRlbmRTaXplKS5zY2FsZUluUGxhY2UoLjUpLHRoaXMuX3dvcmxkTWF0cml4PWl8fHguSWRlbnRpdHlSZWFkT25seSx0aGlzLl91cGRhdGUodGhpcy5fd29ybGRNYXRyaXgpfXNjYWxlKGUpe2NvbnN0IHQ9a3QuX1RtcFZlY3RvcjMsaT10aGlzLm1heGltdW0uc3VidHJhY3RUb1JlZih0aGlzLm1pbmltdW0sdFswXSkscz1pLmxlbmd0aCgpO2kubm9ybWFsaXplRnJvbUxlbmd0aChzKTtjb25zdCByPXMqZSxuPWkuc2NhbGVJblBsYWNlKHIqLjUpLGE9dGhpcy5jZW50ZXIuc3VidHJhY3RUb1JlZihuLHRbMV0pLG89dGhpcy5jZW50ZXIuYWRkVG9SZWYobix0WzJdKTtyZXR1cm4gdGhpcy5yZUNvbnN0cnVjdChhLG8sdGhpcy5fd29ybGRNYXRyaXgpLHRoaXN9Z2V0V29ybGRNYXRyaXgoKXtyZXR1cm4gdGhpcy5fd29ybGRNYXRyaXh9X3VwZGF0ZShlKXtjb25zdCB0PXRoaXMubWluaW11bVdvcmxkLGk9dGhpcy5tYXhpbXVtV29ybGQscz10aGlzLmRpcmVjdGlvbnMscj10aGlzLnZlY3RvcnNXb3JsZCxuPXRoaXMudmVjdG9ycztpZihlLmlzSWRlbnRpdHkoKSl7dC5jb3B5RnJvbSh0aGlzLm1pbmltdW0pLGkuY29weUZyb20odGhpcy5tYXhpbXVtKTtmb3IobGV0IGE9MDthPDg7KythKXJbYV0uY29weUZyb20oblthXSk7dGhpcy5leHRlbmRTaXplV29ybGQuY29weUZyb20odGhpcy5leHRlbmRTaXplKSx0aGlzLmNlbnRlcldvcmxkLmNvcHlGcm9tKHRoaXMuY2VudGVyKX1lbHNle3Quc2V0QWxsKE51bWJlci5NQVhfVkFMVUUpLGkuc2V0QWxsKC1OdW1iZXIuTUFYX1ZBTFVFKTtmb3IobGV0IGE9MDthPDg7KythKXtjb25zdCBvPXJbYV07cC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKG5bYV0sZSxvKSx0Lm1pbmltaXplSW5QbGFjZShvKSxpLm1heGltaXplSW5QbGFjZShvKX1pLnN1YnRyYWN0VG9SZWYodCx0aGlzLmV4dGVuZFNpemVXb3JsZCkuc2NhbGVJblBsYWNlKC41KSxpLmFkZFRvUmVmKHQsdGhpcy5jZW50ZXJXb3JsZCkuc2NhbGVJblBsYWNlKC41KX1wLkZyb21BcnJheVRvUmVmKGUubSwwLHNbMF0pLHAuRnJvbUFycmF5VG9SZWYoZS5tLDQsc1sxXSkscC5Gcm9tQXJyYXlUb1JlZihlLm0sOCxzWzJdKSx0aGlzLl93b3JsZE1hdHJpeD1lfWlzSW5GcnVzdHVtKGUpe3JldHVybiBrdC5Jc0luRnJ1c3R1bSh0aGlzLnZlY3RvcnNXb3JsZCxlKX1pc0NvbXBsZXRlbHlJbkZydXN0dW0oZSl7cmV0dXJuIGt0LklzQ29tcGxldGVseUluRnJ1c3R1bSh0aGlzLnZlY3RvcnNXb3JsZCxlKX1pbnRlcnNlY3RzUG9pbnQoZSl7Y29uc3QgdD10aGlzLm1pbmltdW1Xb3JsZCxpPXRoaXMubWF4aW11bVdvcmxkLHM9dC54LHI9dC55LG49dC56LGE9aS54LG89aS55LGg9aS56LGw9ZS54LHU9ZS55LGQ9ZS56LGY9LXhlO3JldHVybiEoYS1sPGZ8fGY+bC1zfHxvLXU8Znx8Zj51LXJ8fGgtZDxmfHxmPmQtbil9aW50ZXJzZWN0c1NwaGVyZShlKXtyZXR1cm4ga3QuSW50ZXJzZWN0c1NwaGVyZSh0aGlzLm1pbmltdW1Xb3JsZCx0aGlzLm1heGltdW1Xb3JsZCxlLmNlbnRlcldvcmxkLGUucmFkaXVzV29ybGQpfWludGVyc2VjdHNNaW5NYXgoZSx0KXtjb25zdCBpPXRoaXMubWluaW11bVdvcmxkLHM9dGhpcy5tYXhpbXVtV29ybGQscj1pLngsbj1pLnksYT1pLnosbz1zLngsaD1zLnksbD1zLnosdT1lLngsZD1lLnksZj1lLnosXz10LngsRT10LnksbT10Lno7cmV0dXJuIShvPHV8fHI+X3x8aDxkfHxuPkV8fGw8Znx8YT5tKX1kaXNwb3NlKCl7dmFyIGUsdDsoZT10aGlzLl9kcmF3V3JhcHBlckZyb250KT09PW51bGx8fGU9PT12b2lkIDB8fGUuZGlzcG9zZSgpLCh0PXRoaXMuX2RyYXdXcmFwcGVyQmFjayk9PT1udWxsfHx0PT09dm9pZCAwfHx0LmRpc3Bvc2UoKX1zdGF0aWMgSW50ZXJzZWN0cyhlLHQpe3JldHVybiBlLmludGVyc2VjdHNNaW5NYXgodC5taW5pbXVtV29ybGQsdC5tYXhpbXVtV29ybGQpfXN0YXRpYyBJbnRlcnNlY3RzU3BoZXJlKGUsdCxpLHMpe2NvbnN0IHI9a3QuX1RtcFZlY3RvcjNbMF07cmV0dXJuIHAuQ2xhbXBUb1JlZihpLGUsdCxyKSxwLkRpc3RhbmNlU3F1YXJlZChpLHIpPD1zKnN9c3RhdGljIElzQ29tcGxldGVseUluRnJ1c3R1bShlLHQpe2ZvcihsZXQgaT0wO2k8NjsrK2kpe2NvbnN0IHM9dFtpXTtmb3IobGV0IHI9MDtyPDg7KytyKWlmKHMuZG90Q29vcmRpbmF0ZShlW3JdKTwwKXJldHVybiExfXJldHVybiEwfXN0YXRpYyBJc0luRnJ1c3R1bShlLHQpe2ZvcihsZXQgaT0wO2k8NjsrK2kpe2xldCBzPSEwO2NvbnN0IHI9dFtpXTtmb3IobGV0IG49MDtuPDg7KytuKWlmKHIuZG90Q29vcmRpbmF0ZShlW25dKT49MCl7cz0hMTticmVha31pZihzKXJldHVybiExfXJldHVybiEwfX1rdC5fVG1wVmVjdG9yMz1CZS5CdWlsZEFycmF5KDMscC5aZXJvKTtjbGFzcyBmaXtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5jZW50ZXI9cC5aZXJvKCksdGhpcy5jZW50ZXJXb3JsZD1wLlplcm8oKSx0aGlzLm1pbmltdW09cC5aZXJvKCksdGhpcy5tYXhpbXVtPXAuWmVybygpLHRoaXMucmVDb25zdHJ1Y3QoZSx0LGkpfXJlQ29uc3RydWN0KGUsdCxpKXt0aGlzLm1pbmltdW0uY29weUZyb20oZSksdGhpcy5tYXhpbXVtLmNvcHlGcm9tKHQpO2NvbnN0IHM9cC5EaXN0YW5jZShlLHQpO3QuYWRkVG9SZWYoZSx0aGlzLmNlbnRlcikuc2NhbGVJblBsYWNlKC41KSx0aGlzLnJhZGl1cz1zKi41LHRoaXMuX3VwZGF0ZShpfHx4LklkZW50aXR5UmVhZE9ubHkpfXNjYWxlKGUpe2NvbnN0IHQ9dGhpcy5yYWRpdXMqZSxpPWZpLl9UbXBWZWN0b3IzLHM9aVswXS5zZXRBbGwodCkscj10aGlzLmNlbnRlci5zdWJ0cmFjdFRvUmVmKHMsaVsxXSksbj10aGlzLmNlbnRlci5hZGRUb1JlZihzLGlbMl0pO3JldHVybiB0aGlzLnJlQ29uc3RydWN0KHIsbix0aGlzLl93b3JsZE1hdHJpeCksdGhpc31nZXRXb3JsZE1hdHJpeCgpe3JldHVybiB0aGlzLl93b3JsZE1hdHJpeH1fdXBkYXRlKGUpe2lmKGUuaXNJZGVudGl0eSgpKXRoaXMuY2VudGVyV29ybGQuY29weUZyb20odGhpcy5jZW50ZXIpLHRoaXMucmFkaXVzV29ybGQ9dGhpcy5yYWRpdXM7ZWxzZXtwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodGhpcy5jZW50ZXIsZSx0aGlzLmNlbnRlcldvcmxkKTtjb25zdCB0PWZpLl9UbXBWZWN0b3IzWzBdO3AuVHJhbnNmb3JtTm9ybWFsRnJvbUZsb2F0c1RvUmVmKDEsMSwxLGUsdCksdGhpcy5yYWRpdXNXb3JsZD1NYXRoLm1heChNYXRoLmFicyh0LngpLE1hdGguYWJzKHQueSksTWF0aC5hYnModC56KSkqdGhpcy5yYWRpdXN9fWlzSW5GcnVzdHVtKGUpe2NvbnN0IHQ9dGhpcy5jZW50ZXJXb3JsZCxpPXRoaXMucmFkaXVzV29ybGQ7Zm9yKGxldCBzPTA7czw2O3MrKylpZihlW3NdLmRvdENvb3JkaW5hdGUodCk8PS1pKXJldHVybiExO3JldHVybiEwfWlzQ2VudGVySW5GcnVzdHVtKGUpe2NvbnN0IHQ9dGhpcy5jZW50ZXJXb3JsZDtmb3IobGV0IGk9MDtpPDY7aSsrKWlmKGVbaV0uZG90Q29vcmRpbmF0ZSh0KTwwKXJldHVybiExO3JldHVybiEwfWludGVyc2VjdHNQb2ludChlKXtjb25zdCB0PXAuRGlzdGFuY2VTcXVhcmVkKHRoaXMuY2VudGVyV29ybGQsZSk7cmV0dXJuISh0aGlzLnJhZGl1c1dvcmxkKnRoaXMucmFkaXVzV29ybGQ8dCl9c3RhdGljIEludGVyc2VjdHMoZSx0KXtjb25zdCBpPXAuRGlzdGFuY2VTcXVhcmVkKGUuY2VudGVyV29ybGQsdC5jZW50ZXJXb3JsZCkscz1lLnJhZGl1c1dvcmxkK3QucmFkaXVzV29ybGQ7cmV0dXJuIShzKnM8aSl9c3RhdGljIENyZWF0ZUZyb21DZW50ZXJBbmRSYWRpdXMoZSx0LGkpe3RoaXMuX1RtcFZlY3RvcjNbMF0uY29weUZyb20oZSksdGhpcy5fVG1wVmVjdG9yM1sxXS5jb3B5RnJvbUZsb2F0cygwLDAsdCksdGhpcy5fVG1wVmVjdG9yM1syXS5jb3B5RnJvbShlKSx0aGlzLl9UbXBWZWN0b3IzWzBdLmFkZEluUGxhY2UodGhpcy5fVG1wVmVjdG9yM1sxXSksdGhpcy5fVG1wVmVjdG9yM1syXS5zdWJ0cmFjdEluUGxhY2UodGhpcy5fVG1wVmVjdG9yM1sxXSk7Y29uc3Qgcz1uZXcgZmkodGhpcy5fVG1wVmVjdG9yM1swXSx0aGlzLl9UbXBWZWN0b3IzWzJdKTtyZXR1cm4gaT9zLl93b3JsZE1hdHJpeD1pOnMuX3dvcmxkTWF0cml4PXguSWRlbnRpdHkoKSxzfX1maS5fVG1wVmVjdG9yMz1CZS5CdWlsZEFycmF5KDMscC5aZXJvKTtjb25zdCBGcz17bWluOjAsbWF4OjB9LHdzPXttaW46MCxtYXg6MH0sUnI9KGMsZSx0KT0+e2NvbnN0IGk9cC5Eb3QoZS5jZW50ZXJXb3JsZCxjKSxzPU1hdGguYWJzKHAuRG90KGUuZGlyZWN0aW9uc1swXSxjKSkqZS5leHRlbmRTaXplLngscj1NYXRoLmFicyhwLkRvdChlLmRpcmVjdGlvbnNbMV0sYykpKmUuZXh0ZW5kU2l6ZS55LG49TWF0aC5hYnMocC5Eb3QoZS5kaXJlY3Rpb25zWzJdLGMpKSplLmV4dGVuZFNpemUueixhPXMrcituO3QubWluPWktYSx0Lm1heD1pK2F9LHJ0PShjLGUsdCk9PihScihjLGUsRnMpLFJyKGMsdCx3cyksIShGcy5taW4+d3MubWF4fHx3cy5taW4+RnMubWF4KSk7Y2xhc3MgZHR7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMuX2lzTG9ja2VkPSExLHRoaXMuYm91bmRpbmdCb3g9bmV3IGt0KGUsdCxpKSx0aGlzLmJvdW5kaW5nU3BoZXJlPW5ldyBmaShlLHQsaSl9cmVDb25zdHJ1Y3QoZSx0LGkpe3RoaXMuYm91bmRpbmdCb3gucmVDb25zdHJ1Y3QoZSx0LGkpLHRoaXMuYm91bmRpbmdTcGhlcmUucmVDb25zdHJ1Y3QoZSx0LGkpfWdldCBtaW5pbXVtKCl7cmV0dXJuIHRoaXMuYm91bmRpbmdCb3gubWluaW11bX1nZXQgbWF4aW11bSgpe3JldHVybiB0aGlzLmJvdW5kaW5nQm94Lm1heGltdW19Z2V0IGlzTG9ja2VkKCl7cmV0dXJuIHRoaXMuX2lzTG9ja2VkfXNldCBpc0xvY2tlZChlKXt0aGlzLl9pc0xvY2tlZD1lfXVwZGF0ZShlKXt0aGlzLl9pc0xvY2tlZHx8KHRoaXMuYm91bmRpbmdCb3guX3VwZGF0ZShlKSx0aGlzLmJvdW5kaW5nU3BoZXJlLl91cGRhdGUoZSkpfWNlbnRlck9uKGUsdCl7Y29uc3QgaT1kdC5fVG1wVmVjdG9yM1swXS5jb3B5RnJvbShlKS5zdWJ0cmFjdEluUGxhY2UodCkscz1kdC5fVG1wVmVjdG9yM1sxXS5jb3B5RnJvbShlKS5hZGRJblBsYWNlKHQpO3JldHVybiB0aGlzLmJvdW5kaW5nQm94LnJlQ29uc3RydWN0KGkscyx0aGlzLmJvdW5kaW5nQm94LmdldFdvcmxkTWF0cml4KCkpLHRoaXMuYm91bmRpbmdTcGhlcmUucmVDb25zdHJ1Y3QoaSxzLHRoaXMuYm91bmRpbmdCb3guZ2V0V29ybGRNYXRyaXgoKSksdGhpc31lbmNhcHN1bGF0ZShlKXtjb25zdCB0PXAuTWluaW1pemUodGhpcy5taW5pbXVtLGUpLGk9cC5NYXhpbWl6ZSh0aGlzLm1heGltdW0sZSk7cmV0dXJuIHRoaXMucmVDb25zdHJ1Y3QodCxpLHRoaXMuYm91bmRpbmdCb3guZ2V0V29ybGRNYXRyaXgoKSksdGhpc31lbmNhcHN1bGF0ZUJvdW5kaW5nSW5mbyhlKXtyZXR1cm4gdGhpcy5lbmNhcHN1bGF0ZShlLmJvdW5kaW5nQm94LmNlbnRlcldvcmxkLnN1YnRyYWN0KGUuYm91bmRpbmdCb3guZXh0ZW5kU2l6ZVdvcmxkKSksdGhpcy5lbmNhcHN1bGF0ZShlLmJvdW5kaW5nQm94LmNlbnRlcldvcmxkLmFkZChlLmJvdW5kaW5nQm94LmV4dGVuZFNpemVXb3JsZCkpLHRoaXN9c2NhbGUoZSl7cmV0dXJuIHRoaXMuYm91bmRpbmdCb3guc2NhbGUoZSksdGhpcy5ib3VuZGluZ1NwaGVyZS5zY2FsZShlKSx0aGlzfWlzSW5GcnVzdHVtKGUsdD0wKXtyZXR1cm4odD09PTJ8fHQ9PT0zKSYmdGhpcy5ib3VuZGluZ1NwaGVyZS5pc0NlbnRlckluRnJ1c3R1bShlKT8hMDp0aGlzLmJvdW5kaW5nU3BoZXJlLmlzSW5GcnVzdHVtKGUpP3Q9PT0xfHx0PT09Mz8hMDp0aGlzLmJvdW5kaW5nQm94LmlzSW5GcnVzdHVtKGUpOiExfWdldCBkaWFnb25hbExlbmd0aCgpe2NvbnN0IGU9dGhpcy5ib3VuZGluZ0JveDtyZXR1cm4gZS5tYXhpbXVtV29ybGQuc3VidHJhY3RUb1JlZihlLm1pbmltdW1Xb3JsZCxkdC5fVG1wVmVjdG9yM1swXSkubGVuZ3RoKCl9aXNDb21wbGV0ZWx5SW5GcnVzdHVtKGUpe3JldHVybiB0aGlzLmJvdW5kaW5nQm94LmlzQ29tcGxldGVseUluRnJ1c3R1bShlKX1fY2hlY2tDb2xsaXNpb24oZSl7cmV0dXJuIGUuX2NhbkRvQ29sbGlzaW9uKHRoaXMuYm91bmRpbmdTcGhlcmUuY2VudGVyV29ybGQsdGhpcy5ib3VuZGluZ1NwaGVyZS5yYWRpdXNXb3JsZCx0aGlzLmJvdW5kaW5nQm94Lm1pbmltdW1Xb3JsZCx0aGlzLmJvdW5kaW5nQm94Lm1heGltdW1Xb3JsZCl9aW50ZXJzZWN0c1BvaW50KGUpe3JldHVybiEoIXRoaXMuYm91bmRpbmdTcGhlcmUuY2VudGVyV29ybGR8fCF0aGlzLmJvdW5kaW5nU3BoZXJlLmludGVyc2VjdHNQb2ludChlKXx8IXRoaXMuYm91bmRpbmdCb3guaW50ZXJzZWN0c1BvaW50KGUpKX1pbnRlcnNlY3RzKGUsdCl7aWYoIWZpLkludGVyc2VjdHModGhpcy5ib3VuZGluZ1NwaGVyZSxlLmJvdW5kaW5nU3BoZXJlKXx8IWt0LkludGVyc2VjdHModGhpcy5ib3VuZGluZ0JveCxlLmJvdW5kaW5nQm94KSlyZXR1cm4hMTtpZighdClyZXR1cm4hMDtjb25zdCBpPXRoaXMuYm91bmRpbmdCb3gscz1lLmJvdW5kaW5nQm94O3JldHVybiEoIXJ0KGkuZGlyZWN0aW9uc1swXSxpLHMpfHwhcnQoaS5kaXJlY3Rpb25zWzFdLGkscyl8fCFydChpLmRpcmVjdGlvbnNbMl0saSxzKXx8IXJ0KHMuZGlyZWN0aW9uc1swXSxpLHMpfHwhcnQocy5kaXJlY3Rpb25zWzFdLGkscyl8fCFydChzLmRpcmVjdGlvbnNbMl0saSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzBdLHMuZGlyZWN0aW9uc1swXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzBdLHMuZGlyZWN0aW9uc1sxXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzBdLHMuZGlyZWN0aW9uc1syXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzFdLHMuZGlyZWN0aW9uc1swXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzFdLHMuZGlyZWN0aW9uc1sxXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzFdLHMuZGlyZWN0aW9uc1syXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzJdLHMuZGlyZWN0aW9uc1swXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzJdLHMuZGlyZWN0aW9uc1sxXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzJdLHMuZGlyZWN0aW9uc1syXSksaSxzKSl9fWR0Ll9UbXBWZWN0b3IzPUJlLkJ1aWxkQXJyYXkoMixwLlplcm8pO2NsYXNzIGlze3N0YXRpYyBleHRyYWN0TWluQW5kTWF4SW5kZXhlZChlLHQsaSxzLHIsbil7Zm9yKGxldCBhPWk7YTxpK3M7YSsrKXtjb25zdCBvPXRbYV0qMyxoPWVbb10sbD1lW28rMV0sdT1lW28rMl07ci5taW5pbWl6ZUluUGxhY2VGcm9tRmxvYXRzKGgsbCx1KSxuLm1heGltaXplSW5QbGFjZUZyb21GbG9hdHMoaCxsLHUpfX1zdGF0aWMgZXh0cmFjdE1pbkFuZE1heChlLHQsaSxzLHIsbil7Zm9yKGxldCBhPXQsbz10KnM7YTx0K2k7YSsrLG8rPXMpe2NvbnN0IGg9ZVtvXSxsPWVbbysxXSx1PWVbbysyXTtyLm1pbmltaXplSW5QbGFjZUZyb21GbG9hdHMoaCxsLHUpLG4ubWF4aW1pemVJblBsYWNlRnJvbUZsb2F0cyhoLGwsdSl9fX1UKFskdC5maWx0ZXIoKC4uLltjLGVdKT0+IUFycmF5LmlzQXJyYXkoYykmJiFBcnJheS5pc0FycmF5KGUpKV0saXMsImV4dHJhY3RNaW5BbmRNYXhJbmRleGVkIixudWxsKSxUKFskdC5maWx0ZXIoKC4uLltjXSk9PiFBcnJheS5pc0FycmF5KGMpKV0saXMsImV4dHJhY3RNaW5BbmRNYXgiLG51bGwpO2Z1bmN0aW9uIEJuKGMsZSx0LGkscz1udWxsKXtjb25zdCByPW5ldyBwKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSxuPW5ldyBwKC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFKTtyZXR1cm4gaXMuZXh0cmFjdE1pbkFuZE1heEluZGV4ZWQoYyxlLHQsaSxyLG4pLHMmJihyLngtPXIueCpzLngrcy55LHIueS09ci55KnMueCtzLnksci56LT1yLnoqcy54K3MueSxuLngrPW4ueCpzLngrcy55LG4ueSs9bi55KnMueCtzLnksbi56Kz1uLnoqcy54K3MueSkse21pbmltdW06cixtYXhpbXVtOm59fWZ1bmN0aW9uIHlyKGMsZSx0LGk9bnVsbCxzKXtjb25zdCByPW5ldyBwKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSxuPW5ldyBwKC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFKTtyZXR1cm4gc3x8KHM9MyksaXMuZXh0cmFjdE1pbkFuZE1heChjLGUsdCxzLHIsbiksaSYmKHIueC09ci54KmkueCtpLnksci55LT1yLnkqaS54K2kueSxyLnotPXIueippLngraS55LG4ueCs9bi54KmkueCtpLnksbi55Kz1uLnkqaS54K2kueSxuLnorPW4ueippLngraS55KSx7bWluaW11bTpyLG1heGltdW06bn19Y2xhc3MgdnR7Y29uc3RydWN0b3IoZSx0LGkscyxyLG4sYSxvPSEwLGg9ITApe3RoaXMubWF0ZXJpYWxJbmRleD1lLHRoaXMudmVydGljZXNTdGFydD10LHRoaXMudmVydGljZXNDb3VudD1pLHRoaXMuaW5kZXhTdGFydD1zLHRoaXMuaW5kZXhDb3VudD1yLHRoaXMuX21haW5EcmF3V3JhcHBlck92ZXJyaWRlPW51bGwsdGhpcy5fbGluZXNJbmRleENvdW50PTAsdGhpcy5fbGluZXNJbmRleEJ1ZmZlcj1udWxsLHRoaXMuX2xhc3RDb2xsaWRlcldvcmxkVmVydGljZXM9bnVsbCx0aGlzLl9sYXN0Q29sbGlkZXJUcmFuc2Zvcm1NYXRyaXg9bnVsbCx0aGlzLl93YXNEaXNwYXRjaGVkPSExLHRoaXMuX3JlbmRlcklkPTAsdGhpcy5fYWxwaGFJbmRleD0wLHRoaXMuX2Rpc3RhbmNlVG9DYW1lcmE9MCx0aGlzLl9jdXJyZW50TWF0ZXJpYWw9bnVsbCx0aGlzLl9tZXNoPW4sdGhpcy5fcmVuZGVyaW5nTWVzaD1hfHxuLGgmJm4uc3ViTWVzaGVzLnB1c2godGhpcyksdGhpcy5fZW5naW5lPXRoaXMuX21lc2guZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKSx0aGlzLnJlc2V0RHJhd0NhY2hlKCksdGhpcy5fdHJpYW5nbGVQbGFuZXM9W10sdGhpcy5faWQ9bi5zdWJNZXNoZXMubGVuZ3RoLTEsbyYmKHRoaXMucmVmcmVzaEJvdW5kaW5nSW5mbygpLG4uY29tcHV0ZVdvcmxkTWF0cml4KCEwKSl9Z2V0IG1hdGVyaWFsRGVmaW5lcygpe3ZhciBlO3JldHVybiB0aGlzLl9tYWluRHJhd1dyYXBwZXJPdmVycmlkZT90aGlzLl9tYWluRHJhd1dyYXBwZXJPdmVycmlkZS5kZWZpbmVzOihlPXRoaXMuX2dldERyYXdXcmFwcGVyKCkpPT09bnVsbHx8ZT09PXZvaWQgMD92b2lkIDA6ZS5kZWZpbmVzfXNldCBtYXRlcmlhbERlZmluZXMoZSl7dmFyIHQ7Y29uc3QgaT0odD10aGlzLl9tYWluRHJhd1dyYXBwZXJPdmVycmlkZSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6dGhpcy5fZ2V0RHJhd1dyYXBwZXIodm9pZCAwLCEwKTtpLmRlZmluZXM9ZX1fZ2V0RHJhd1dyYXBwZXIoZSx0PSExKXtlPWU/P3RoaXMuX2VuZ2luZS5jdXJyZW50UmVuZGVyUGFzc0lkO2xldCBpPXRoaXMuX2RyYXdXcmFwcGVyc1tlXTtyZXR1cm4haSYmdCYmKHRoaXMuX2RyYXdXcmFwcGVyc1tlXT1pPW5ldyBtaSh0aGlzLl9tZXNoLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkpKSxpfV9yZW1vdmVEcmF3V3JhcHBlcihlLHQ9ITApe3ZhciBpO3QmJigoaT10aGlzLl9kcmF3V3JhcHBlcnNbZV0pPT09bnVsbHx8aT09PXZvaWQgMHx8aS5kaXNwb3NlKCkpLHRoaXMuX2RyYXdXcmFwcGVyc1tlXT12b2lkIDB9Z2V0IGVmZmVjdCgpe3ZhciBlLHQ7cmV0dXJuIHRoaXMuX21haW5EcmF3V3JhcHBlck92ZXJyaWRlP3RoaXMuX21haW5EcmF3V3JhcHBlck92ZXJyaWRlLmVmZmVjdDoodD0oZT10aGlzLl9nZXREcmF3V3JhcHBlcigpKT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUuZWZmZWN0KSE9PW51bGwmJnQhPT12b2lkIDA/dDpudWxsfWdldCBfZHJhd1dyYXBwZXIoKXt2YXIgZTtyZXR1cm4oZT10aGlzLl9tYWluRHJhd1dyYXBwZXJPdmVycmlkZSkhPT1udWxsJiZlIT09dm9pZCAwP2U6dGhpcy5fZ2V0RHJhd1dyYXBwZXIodm9pZCAwLCEwKX1nZXQgX2RyYXdXcmFwcGVyT3ZlcnJpZGUoKXtyZXR1cm4gdGhpcy5fbWFpbkRyYXdXcmFwcGVyT3ZlcnJpZGV9X3NldE1haW5EcmF3V3JhcHBlck92ZXJyaWRlKGUpe3RoaXMuX21haW5EcmF3V3JhcHBlck92ZXJyaWRlPWV9c2V0RWZmZWN0KGUsdD1udWxsLGkscz0hMCl7Y29uc3Qgcj10aGlzLl9kcmF3V3JhcHBlcjtyLnNldEVmZmVjdChlLHQscyksaSE9PXZvaWQgMCYmKHIubWF0ZXJpYWxDb250ZXh0PWkpLGV8fChyLmRlZmluZXM9bnVsbCxyLm1hdGVyaWFsQ29udGV4dD12b2lkIDApfXJlc2V0RHJhd0NhY2hlKGUpe2lmKHRoaXMuX2RyYXdXcmFwcGVycylpZihlIT09dm9pZCAwKXt0aGlzLl9yZW1vdmVEcmF3V3JhcHBlcihlKTtyZXR1cm59ZWxzZSBmb3IoY29uc3QgdCBvZiB0aGlzLl9kcmF3V3JhcHBlcnMpdD09bnVsbHx8dC5kaXNwb3NlKCk7dGhpcy5fZHJhd1dyYXBwZXJzPVtdfXN0YXRpYyBBZGRUb01lc2goZSx0LGkscyxyLG4sYSxvPSEwKXtyZXR1cm4gbmV3IHZ0KGUsdCxpLHMscixuLGEsbyl9Z2V0IElzR2xvYmFsKCl7cmV0dXJuIHRoaXMudmVydGljZXNTdGFydD09PTAmJnRoaXMudmVydGljZXNDb3VudD09PXRoaXMuX21lc2guZ2V0VG90YWxWZXJ0aWNlcygpJiZ0aGlzLmluZGV4U3RhcnQ9PT0wJiZ0aGlzLmluZGV4Q291bnQ9PT10aGlzLl9tZXNoLmdldFRvdGFsSW5kaWNlcygpfWdldEJvdW5kaW5nSW5mbygpe3JldHVybiB0aGlzLklzR2xvYmFsP3RoaXMuX21lc2guZ2V0Qm91bmRpbmdJbmZvKCk6dGhpcy5fYm91bmRpbmdJbmZvfXNldEJvdW5kaW5nSW5mbyhlKXtyZXR1cm4gdGhpcy5fYm91bmRpbmdJbmZvPWUsdGhpc31nZXRNZXNoKCl7cmV0dXJuIHRoaXMuX21lc2h9Z2V0UmVuZGVyaW5nTWVzaCgpe3JldHVybiB0aGlzLl9yZW5kZXJpbmdNZXNofWdldFJlcGxhY2VtZW50TWVzaCgpe3JldHVybiB0aGlzLl9tZXNoLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hY3RBc1JlZ3VsYXJNZXNoP3RoaXMuX21lc2g6bnVsbH1nZXRFZmZlY3RpdmVNZXNoKCl7Y29uc3QgZT10aGlzLl9tZXNoLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hY3RBc1JlZ3VsYXJNZXNoP3RoaXMuX21lc2g6bnVsbDtyZXR1cm4gZXx8dGhpcy5fcmVuZGVyaW5nTWVzaH1nZXRNYXRlcmlhbChlPSEwKXt2YXIgdDtjb25zdCBpPSh0PXRoaXMuX3JlbmRlcmluZ01lc2guZ2V0TWF0ZXJpYWxGb3JSZW5kZXJQYXNzKHRoaXMuX2VuZ2luZS5jdXJyZW50UmVuZGVyUGFzc0lkKSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6dGhpcy5fcmVuZGVyaW5nTWVzaC5tYXRlcmlhbDtpZihpKXtpZih0aGlzLl9pc011bHRpTWF0ZXJpYWwoaSkpe2NvbnN0IHM9aS5nZXRTdWJNYXRlcmlhbCh0aGlzLm1hdGVyaWFsSW5kZXgpO3JldHVybiB0aGlzLl9jdXJyZW50TWF0ZXJpYWwhPT1zJiYodGhpcy5fY3VycmVudE1hdGVyaWFsPXMsdGhpcy5yZXNldERyYXdDYWNoZSgpKSxzfX1lbHNlIHJldHVybiBlP3RoaXMuX21lc2guZ2V0U2NlbmUoKS5kZWZhdWx0TWF0ZXJpYWw6bnVsbDtyZXR1cm4gaX1faXNNdWx0aU1hdGVyaWFsKGUpe3JldHVybiBlLmdldFN1Yk1hdGVyaWFsIT09dm9pZCAwfXJlZnJlc2hCb3VuZGluZ0luZm8oZT1udWxsKXtpZih0aGlzLl9sYXN0Q29sbGlkZXJXb3JsZFZlcnRpY2VzPW51bGwsdGhpcy5Jc0dsb2JhbHx8IXRoaXMuX3JlbmRlcmluZ01lc2h8fCF0aGlzLl9yZW5kZXJpbmdNZXNoLmdlb21ldHJ5KXJldHVybiB0aGlzO2lmKGV8fChlPXRoaXMuX3JlbmRlcmluZ01lc2guZ2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kKSksIWUpcmV0dXJuIHRoaXMuX2JvdW5kaW5nSW5mbz10aGlzLl9tZXNoLmdldEJvdW5kaW5nSW5mbygpLHRoaXM7Y29uc3QgdD10aGlzLl9yZW5kZXJpbmdNZXNoLmdldEluZGljZXMoKTtsZXQgaTtpZih0aGlzLmluZGV4U3RhcnQ9PT0wJiZ0aGlzLmluZGV4Q291bnQ9PT10Lmxlbmd0aCl7Y29uc3Qgcz10aGlzLl9yZW5kZXJpbmdNZXNoLmdldEJvdW5kaW5nSW5mbygpO2k9e21pbmltdW06cy5taW5pbXVtLmNsb25lKCksbWF4aW11bTpzLm1heGltdW0uY2xvbmUoKX19ZWxzZSBpPUJuKGUsdCx0aGlzLmluZGV4U3RhcnQsdGhpcy5pbmRleENvdW50LHRoaXMuX3JlbmRlcmluZ01lc2guZ2VvbWV0cnkuYm91bmRpbmdCaWFzKTtyZXR1cm4gdGhpcy5fYm91bmRpbmdJbmZvP3RoaXMuX2JvdW5kaW5nSW5mby5yZUNvbnN0cnVjdChpLm1pbmltdW0saS5tYXhpbXVtKTp0aGlzLl9ib3VuZGluZ0luZm89bmV3IGR0KGkubWluaW11bSxpLm1heGltdW0pLHRoaXN9X2NoZWNrQ29sbGlzaW9uKGUpe3JldHVybiB0aGlzLmdldEJvdW5kaW5nSW5mbygpLl9jaGVja0NvbGxpc2lvbihlKX11cGRhdGVCb3VuZGluZ0luZm8oZSl7bGV0IHQ9dGhpcy5nZXRCb3VuZGluZ0luZm8oKTtyZXR1cm4gdHx8KHRoaXMucmVmcmVzaEJvdW5kaW5nSW5mbygpLHQ9dGhpcy5nZXRCb3VuZGluZ0luZm8oKSksdCYmdC51cGRhdGUoZSksdGhpc31pc0luRnJ1c3R1bShlKXtjb25zdCB0PXRoaXMuZ2V0Qm91bmRpbmdJbmZvKCk7cmV0dXJuIHQ/dC5pc0luRnJ1c3R1bShlLHRoaXMuX21lc2guY3VsbGluZ1N0cmF0ZWd5KTohMX1pc0NvbXBsZXRlbHlJbkZydXN0dW0oZSl7Y29uc3QgdD10aGlzLmdldEJvdW5kaW5nSW5mbygpO3JldHVybiB0P3QuaXNDb21wbGV0ZWx5SW5GcnVzdHVtKGUpOiExfXJlbmRlcihlKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nTWVzaC5yZW5kZXIodGhpcyxlLHRoaXMuX21lc2guX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2FjdEFzUmVndWxhck1lc2g/dGhpcy5fbWVzaDp2b2lkIDApLHRoaXN9X2dldExpbmVzSW5kZXhCdWZmZXIoZSx0KXtpZighdGhpcy5fbGluZXNJbmRleEJ1ZmZlcil7Y29uc3QgaT1bXTtmb3IobGV0IHM9dGhpcy5pbmRleFN0YXJ0O3M8dGhpcy5pbmRleFN0YXJ0K3RoaXMuaW5kZXhDb3VudDtzKz0zKWkucHVzaChlW3NdLGVbcysxXSxlW3MrMV0sZVtzKzJdLGVbcysyXSxlW3NdKTt0aGlzLl9saW5lc0luZGV4QnVmZmVyPXQuY3JlYXRlSW5kZXhCdWZmZXIoaSksdGhpcy5fbGluZXNJbmRleENvdW50PWkubGVuZ3RofXJldHVybiB0aGlzLl9saW5lc0luZGV4QnVmZmVyfWNhbkludGVyc2VjdHMoZSl7Y29uc3QgdD10aGlzLmdldEJvdW5kaW5nSW5mbygpO3JldHVybiB0P2UuaW50ZXJzZWN0c0JveCh0LmJvdW5kaW5nQm94KTohMX1pbnRlcnNlY3RzKGUsdCxpLHMscil7Y29uc3Qgbj10aGlzLmdldE1hdGVyaWFsKCk7aWYoIW4pcmV0dXJuIG51bGw7bGV0IGE9MyxvPSExO3N3aXRjaChuLmZpbGxNb2RlKXtjYXNlIDM6Y2FzZSA1OmNhc2UgNjpjYXNlIDg6cmV0dXJuIG51bGw7Y2FzZSA3OmE9MSxvPSEwO2JyZWFrfXJldHVybiBuLmZpbGxNb2RlPT09ND9pLmxlbmd0aD90aGlzLl9pbnRlcnNlY3RMaW5lcyhlLHQsaSx0aGlzLl9tZXNoLmludGVyc2VjdGlvblRocmVzaG9sZCxzKTp0aGlzLl9pbnRlcnNlY3RVbkluZGV4ZWRMaW5lcyhlLHQsaSx0aGlzLl9tZXNoLmludGVyc2VjdGlvblRocmVzaG9sZCxzKTohaS5sZW5ndGgmJnRoaXMuX21lc2guX3VuSW5kZXhlZD90aGlzLl9pbnRlcnNlY3RVbkluZGV4ZWRUcmlhbmdsZXMoZSx0LGkscyxyKTp0aGlzLl9pbnRlcnNlY3RUcmlhbmdsZXMoZSx0LGksYSxvLHMscil9X2ludGVyc2VjdExpbmVzKGUsdCxpLHMscil7bGV0IG49bnVsbDtmb3IobGV0IGE9dGhpcy5pbmRleFN0YXJ0O2E8dGhpcy5pbmRleFN0YXJ0K3RoaXMuaW5kZXhDb3VudDthKz0yKXtjb25zdCBvPXRbaVthXV0saD10W2lbYSsxXV0sbD1lLmludGVyc2VjdGlvblNlZ21lbnQobyxoLHMpO2lmKCEobDwwKSYmKHJ8fCFufHxsPG4uZGlzdGFuY2UpJiYobj1uZXcgRHMobnVsbCxudWxsLGwpLG4uZmFjZUlkPWEvMixyKSlicmVha31yZXR1cm4gbn1faW50ZXJzZWN0VW5JbmRleGVkTGluZXMoZSx0LGkscyxyKXtsZXQgbj1udWxsO2ZvcihsZXQgYT10aGlzLnZlcnRpY2VzU3RhcnQ7YTx0aGlzLnZlcnRpY2VzU3RhcnQrdGhpcy52ZXJ0aWNlc0NvdW50O2ErPTIpe2NvbnN0IG89dFthXSxoPXRbYSsxXSxsPWUuaW50ZXJzZWN0aW9uU2VnbWVudChvLGgscyk7aWYoIShsPDApJiYocnx8IW58fGw8bi5kaXN0YW5jZSkmJihuPW5ldyBEcyhudWxsLG51bGwsbCksbi5mYWNlSWQ9YS8yLHIpKWJyZWFrfXJldHVybiBufV9pbnRlcnNlY3RUcmlhbmdsZXMoZSx0LGkscyxyLG4sYSl7bGV0IG89bnVsbCxoPS0xO2ZvcihsZXQgbD10aGlzLmluZGV4U3RhcnQ7bDx0aGlzLmluZGV4U3RhcnQrdGhpcy5pbmRleENvdW50LSgzLXMpO2wrPXMpe2grKztjb25zdCB1PWlbbF0sZD1pW2wrMV0sZj1pW2wrMl07aWYociYmZj09PTQyOTQ5NjcyOTUpe2wrPTI7Y29udGludWV9Y29uc3QgXz10W3VdLEU9dFtkXSxtPXRbZl07aWYoIV98fCFFfHwhbXx8YSYmIWEoXyxFLG0sZSx1LGQsZikpY29udGludWU7Y29uc3Qgdj1lLmludGVyc2VjdHNUcmlhbmdsZShfLEUsbSk7aWYodil7aWYodi5kaXN0YW5jZTwwKWNvbnRpbnVlO2lmKChufHwhb3x8di5kaXN0YW5jZTxvLmRpc3RhbmNlKSYmKG89dixvLmZhY2VJZD1oLG4pKWJyZWFrfX1yZXR1cm4gb31faW50ZXJzZWN0VW5JbmRleGVkVHJpYW5nbGVzKGUsdCxpLHMscil7bGV0IG49bnVsbDtmb3IobGV0IGE9dGhpcy52ZXJ0aWNlc1N0YXJ0O2E8dGhpcy52ZXJ0aWNlc1N0YXJ0K3RoaXMudmVydGljZXNDb3VudDthKz0zKXtjb25zdCBvPXRbYV0saD10W2ErMV0sbD10W2ErMl07aWYociYmIXIobyxoLGwsZSwtMSwtMSwtMSkpY29udGludWU7Y29uc3QgdT1lLmludGVyc2VjdHNUcmlhbmdsZShvLGgsbCk7aWYodSl7aWYodS5kaXN0YW5jZTwwKWNvbnRpbnVlO2lmKChzfHwhbnx8dS5kaXN0YW5jZTxuLmRpc3RhbmNlKSYmKG49dSxuLmZhY2VJZD1hLzMscykpYnJlYWt9fXJldHVybiBufV9yZWJ1aWxkKCl7dGhpcy5fbGluZXNJbmRleEJ1ZmZlciYmKHRoaXMuX2xpbmVzSW5kZXhCdWZmZXI9bnVsbCl9Y2xvbmUoZSx0KXtjb25zdCBpPW5ldyB2dCh0aGlzLm1hdGVyaWFsSW5kZXgsdGhpcy52ZXJ0aWNlc1N0YXJ0LHRoaXMudmVydGljZXNDb3VudCx0aGlzLmluZGV4U3RhcnQsdGhpcy5pbmRleENvdW50LGUsdCwhMSk7aWYoIXRoaXMuSXNHbG9iYWwpe2NvbnN0IHM9dGhpcy5nZXRCb3VuZGluZ0luZm8oKTtpZighcylyZXR1cm4gaTtpLl9ib3VuZGluZ0luZm89bmV3IGR0KHMubWluaW11bSxzLm1heGltdW0pfXJldHVybiBpfWRpc3Bvc2UoKXt0aGlzLl9saW5lc0luZGV4QnVmZmVyJiYodGhpcy5fbWVzaC5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLl9yZWxlYXNlQnVmZmVyKHRoaXMuX2xpbmVzSW5kZXhCdWZmZXIpLHRoaXMuX2xpbmVzSW5kZXhCdWZmZXI9bnVsbCk7Y29uc3QgZT10aGlzLl9tZXNoLnN1Yk1lc2hlcy5pbmRleE9mKHRoaXMpO3RoaXMuX21lc2guc3ViTWVzaGVzLnNwbGljZShlLDEpLHRoaXMucmVzZXREcmF3Q2FjaGUoKX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iU3ViTWVzaCJ9c3RhdGljIENyZWF0ZUZyb21JbmRpY2VzKGUsdCxpLHMscixuPSEwKXtsZXQgYT1OdW1iZXIuTUFYX1ZBTFVFLG89LU51bWJlci5NQVhfVkFMVUU7Y29uc3QgbD0ocnx8cykuZ2V0SW5kaWNlcygpO2ZvcihsZXQgdT10O3U8dCtpO3UrKyl7Y29uc3QgZD1sW3VdO2Q8YSYmKGE9ZCksZD5vJiYobz1kKX1yZXR1cm4gbmV3IHZ0KGUsYSxvLWErMSx0LGkscyxyLG4pfX1jbGFzcyBPZXtzdGF0aWMgZ2V0IEZvcmNlRnVsbFNjZW5lTG9hZGluZ0ZvckluY3JlbWVudGFsKCl7cmV0dXJuIE9lLl9Gb3JjZUZ1bGxTY2VuZUxvYWRpbmdGb3JJbmNyZW1lbnRhbH1zdGF0aWMgc2V0IEZvcmNlRnVsbFNjZW5lTG9hZGluZ0ZvckluY3JlbWVudGFsKGUpe09lLl9Gb3JjZUZ1bGxTY2VuZUxvYWRpbmdGb3JJbmNyZW1lbnRhbD1lfXN0YXRpYyBnZXQgU2hvd0xvYWRpbmdTY3JlZW4oKXtyZXR1cm4gT2UuX1Nob3dMb2FkaW5nU2NyZWVufXN0YXRpYyBzZXQgU2hvd0xvYWRpbmdTY3JlZW4oZSl7T2UuX1Nob3dMb2FkaW5nU2NyZWVuPWV9c3RhdGljIGdldCBsb2dnaW5nTGV2ZWwoKXtyZXR1cm4gT2UuX0xvZ2dpbmdMZXZlbH1zdGF0aWMgc2V0IGxvZ2dpbmdMZXZlbChlKXtPZS5fTG9nZ2luZ0xldmVsPWV9c3RhdGljIGdldCBDbGVhbkJvbmVNYXRyaXhXZWlnaHRzKCl7cmV0dXJuIE9lLl9DbGVhbkJvbmVNYXRyaXhXZWlnaHRzfXN0YXRpYyBzZXQgQ2xlYW5Cb25lTWF0cml4V2VpZ2h0cyhlKXtPZS5fQ2xlYW5Cb25lTWF0cml4V2VpZ2h0cz1lfX1PZS5fRm9yY2VGdWxsU2NlbmVMb2FkaW5nRm9ySW5jcmVtZW50YWw9ITEsT2UuX1Nob3dMb2FkaW5nU2NyZWVuPSEwLE9lLl9DbGVhbkJvbmVNYXRyaXhXZWlnaHRzPSExLE9lLl9Mb2dnaW5nTGV2ZWw9MDtjbGFzcyBmdHt9ZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVj0hMTtjbGFzcyBhdHtjb25zdHJ1Y3RvcihlLHQsaSxzPSExLHI9bnVsbCl7dGhpcy5kZWxheUxvYWRTdGF0ZT0wLHRoaXMuX3RvdGFsVmVydGljZXM9MCx0aGlzLl9pc0Rpc3Bvc2VkPSExLHRoaXMuX2luZGV4QnVmZmVySXNVcGRhdGFibGU9ITEsdGhpcy5fcG9zaXRpb25zQ2FjaGU9W10sdGhpcy5fcGFyZW50Q29udGFpbmVyPW51bGwsdGhpcy51c2VCb3VuZGluZ0luZm9Gcm9tR2VvbWV0cnk9ITEsdGhpcy5fc2NlbmU9dHx8ZmUuTGFzdENyZWF0ZWRTY2VuZSx0aGlzLl9zY2VuZSYmKHRoaXMuaWQ9ZSx0aGlzLnVuaXF1ZUlkPXRoaXMuX3NjZW5lLmdldFVuaXF1ZUlkKCksdGhpcy5fZW5naW5lPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLHRoaXMuX21lc2hlcz1bXSx0aGlzLl92ZXJ0ZXhCdWZmZXJzPXt9LHRoaXMuX2luZGljZXM9W10sdGhpcy5fdXBkYXRhYmxlPXMsaT90aGlzLnNldEFsbFZlcnRpY2VzRGF0YShpLHMpOnRoaXMuX3RvdGFsVmVydGljZXM9MCx0aGlzLl9lbmdpbmUuZ2V0Q2FwcygpLnZlcnRleEFycmF5T2JqZWN0JiYodGhpcy5fdmVydGV4QXJyYXlPYmplY3RzPXt9KSxyJiYodGhpcy5hcHBseVRvTWVzaChyKSxyLmNvbXB1dGVXb3JsZE1hdHJpeCghMCkpKX1nZXQgYm91bmRpbmdCaWFzKCl7cmV0dXJuIHRoaXMuX2JvdW5kaW5nQmlhc31zZXQgYm91bmRpbmdCaWFzKGUpe3RoaXMuX2JvdW5kaW5nQmlhcz90aGlzLl9ib3VuZGluZ0JpYXMuY29weUZyb20oZSk6dGhpcy5fYm91bmRpbmdCaWFzPWUuY2xvbmUoKSx0aGlzLl91cGRhdGVCb3VuZGluZ0luZm8oITAsbnVsbCl9c3RhdGljIENyZWF0ZUdlb21ldHJ5Rm9yTWVzaChlKXtjb25zdCB0PW5ldyBhdChhdC5SYW5kb21JZCgpLGUuZ2V0U2NlbmUoKSk7cmV0dXJuIHQuYXBwbHlUb01lc2goZSksdH1nZXQgbWVzaGVzKCl7cmV0dXJuIHRoaXMuX21lc2hlc31nZXQgZXh0ZW5kKCl7cmV0dXJuIHRoaXMuX2V4dGVuZH1nZXRTY2VuZSgpe3JldHVybiB0aGlzLl9zY2VuZX1nZXRFbmdpbmUoKXtyZXR1cm4gdGhpcy5fZW5naW5lfWlzUmVhZHkoKXtyZXR1cm4gdGhpcy5kZWxheUxvYWRTdGF0ZT09PTF8fHRoaXMuZGVsYXlMb2FkU3RhdGU9PT0wfWdldCBkb05vdFNlcmlhbGl6ZSgpe2ZvcihsZXQgZT0wO2U8dGhpcy5fbWVzaGVzLmxlbmd0aDtlKyspaWYoIXRoaXMuX21lc2hlc1tlXS5kb05vdFNlcmlhbGl6ZSlyZXR1cm4hMTtyZXR1cm4hMH1fcmVidWlsZCgpe3RoaXMuX3ZlcnRleEFycmF5T2JqZWN0cyYmKHRoaXMuX3ZlcnRleEFycmF5T2JqZWN0cz17fSksdGhpcy5fbWVzaGVzLmxlbmd0aCE9PTAmJnRoaXMuX2luZGljZXMmJih0aGlzLl9pbmRleEJ1ZmZlcj10aGlzLl9lbmdpbmUuY3JlYXRlSW5kZXhCdWZmZXIodGhpcy5faW5kaWNlcyx0aGlzLl91cGRhdGFibGUpKTtmb3IoY29uc3QgZSBpbiB0aGlzLl92ZXJ0ZXhCdWZmZXJzKXRoaXMuX3ZlcnRleEJ1ZmZlcnNbZV0uX3JlYnVpbGQoKX1zZXRBbGxWZXJ0aWNlc0RhdGEoZSx0KXtlLmFwcGx5VG9HZW9tZXRyeSh0aGlzLHQpLHRoaXMuX25vdGlmeVVwZGF0ZSgpfXNldFZlcnRpY2VzRGF0YShlLHQsaT0hMSxzKXtpJiZBcnJheS5pc0FycmF5KHQpJiYodD1uZXcgRmxvYXQzMkFycmF5KHQpKTtjb25zdCByPW5ldyBnKHRoaXMuX2VuZ2luZSx0LGUsaSx0aGlzLl9tZXNoZXMubGVuZ3RoPT09MCxzKTt0aGlzLnNldFZlcnRpY2VzQnVmZmVyKHIpfXJlbW92ZVZlcnRpY2VzRGF0YShlKXt0aGlzLl92ZXJ0ZXhCdWZmZXJzW2VdJiYodGhpcy5fdmVydGV4QnVmZmVyc1tlXS5kaXNwb3NlKCksZGVsZXRlIHRoaXMuX3ZlcnRleEJ1ZmZlcnNbZV0pLHRoaXMuX3ZlcnRleEFycmF5T2JqZWN0cyYmdGhpcy5fZGlzcG9zZVZlcnRleEFycmF5T2JqZWN0cygpfXNldFZlcnRpY2VzQnVmZmVyKGUsdD1udWxsLGk9ITApe2NvbnN0IHM9ZS5nZXRLaW5kKCk7dGhpcy5fdmVydGV4QnVmZmVyc1tzXSYmaSYmdGhpcy5fdmVydGV4QnVmZmVyc1tzXS5kaXNwb3NlKCksZS5fYnVmZmVyJiZlLl9idWZmZXIuX2luY3JlYXNlUmVmZXJlbmNlcygpLHRoaXMuX3ZlcnRleEJ1ZmZlcnNbc109ZTtjb25zdCByPXRoaXMuX21lc2hlcyxuPXIubGVuZ3RoO2lmKHM9PT1nLlBvc2l0aW9uS2luZCl7Y29uc3QgYT1lLmdldERhdGEoKTt0IT1udWxsP3RoaXMuX3RvdGFsVmVydGljZXM9dDphIT1udWxsJiYodGhpcy5fdG90YWxWZXJ0aWNlcz1hLmxlbmd0aC8oZS50eXBlPT09Zy5CWVRFP2UuYnl0ZVN0cmlkZTplLmJ5dGVTdHJpZGUvNCkpLHRoaXMuX3VwZGF0ZUV4dGVuZChhKSx0aGlzLl9yZXNldFBvaW50c0FycmF5Q2FjaGUoKTtmb3IobGV0IG89MDtvPG47bysrKXtjb25zdCBoPXJbb107aC5idWlsZEJvdW5kaW5nSW5mbyh0aGlzLl9leHRlbmQubWluaW11bSx0aGlzLl9leHRlbmQubWF4aW11bSksaC5fY3JlYXRlR2xvYmFsU3ViTWVzaChoLmlzVW5JbmRleGVkKSxoLmNvbXB1dGVXb3JsZE1hdHJpeCghMCksaC5zeW5jaHJvbml6ZUluc3RhbmNlcygpfX10aGlzLl9ub3RpZnlVcGRhdGUocyl9dXBkYXRlVmVydGljZXNEYXRhRGlyZWN0bHkoZSx0LGkscz0hMSl7Y29uc3Qgcj10aGlzLmdldFZlcnRleEJ1ZmZlcihlKTtyJiYoci51cGRhdGVEaXJlY3RseSh0LGkscyksdGhpcy5fbm90aWZ5VXBkYXRlKGUpKX11cGRhdGVWZXJ0aWNlc0RhdGEoZSx0LGk9ITEpe2NvbnN0IHM9dGhpcy5nZXRWZXJ0ZXhCdWZmZXIoZSk7cyYmKHMudXBkYXRlKHQpLGU9PT1nLlBvc2l0aW9uS2luZCYmdGhpcy5fdXBkYXRlQm91bmRpbmdJbmZvKGksdCksdGhpcy5fbm90aWZ5VXBkYXRlKGUpKX1fdXBkYXRlQm91bmRpbmdJbmZvKGUsdCl7aWYoZSYmdGhpcy5fdXBkYXRlRXh0ZW5kKHQpLHRoaXMuX3Jlc2V0UG9pbnRzQXJyYXlDYWNoZSgpLGUpe2NvbnN0IGk9dGhpcy5fbWVzaGVzO2Zvcihjb25zdCBzIG9mIGkpe3MuaGFzQm91bmRpbmdJbmZvP3MuZ2V0Qm91bmRpbmdJbmZvKCkucmVDb25zdHJ1Y3QodGhpcy5fZXh0ZW5kLm1pbmltdW0sdGhpcy5fZXh0ZW5kLm1heGltdW0pOnMuYnVpbGRCb3VuZGluZ0luZm8odGhpcy5fZXh0ZW5kLm1pbmltdW0sdGhpcy5fZXh0ZW5kLm1heGltdW0pO2NvbnN0IHI9cy5zdWJNZXNoZXM7Zm9yKGNvbnN0IG4gb2YgciluLnJlZnJlc2hCb3VuZGluZ0luZm8oKX19fV9iaW5kKGUsdCxpLHMpe2lmKCFlKXJldHVybjt0PT09dm9pZCAwJiYodD10aGlzLl9pbmRleEJ1ZmZlcik7Y29uc3Qgcj10aGlzLmdldFZlcnRleEJ1ZmZlcnMoKTtpZighcilyZXR1cm47aWYodCE9dGhpcy5faW5kZXhCdWZmZXJ8fCF0aGlzLl92ZXJ0ZXhBcnJheU9iamVjdHMmJiFzKXt0aGlzLl9lbmdpbmUuYmluZEJ1ZmZlcnMocix0LGUsaSk7cmV0dXJufWNvbnN0IG49c3x8dGhpcy5fdmVydGV4QXJyYXlPYmplY3RzO25bZS5rZXldfHwobltlLmtleV09dGhpcy5fZW5naW5lLnJlY29yZFZlcnRleEFycmF5T2JqZWN0KHIsdCxlLGkpKSx0aGlzLl9lbmdpbmUuYmluZFZlcnRleEFycmF5T2JqZWN0KG5bZS5rZXldLHQpfWdldFRvdGFsVmVydGljZXMoKXtyZXR1cm4gdGhpcy5pc1JlYWR5KCk/dGhpcy5fdG90YWxWZXJ0aWNlczowfWdldFZlcnRpY2VzRGF0YShlLHQsaSl7Y29uc3Qgcz10aGlzLmdldFZlcnRleEJ1ZmZlcihlKTtyZXR1cm4gcz9zLmdldEZsb2F0RGF0YSh0aGlzLl90b3RhbFZlcnRpY2VzLGl8fHQmJnRoaXMuX21lc2hlcy5sZW5ndGghPT0xKTpudWxsfWlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGUpe2NvbnN0IHQ9dGhpcy5fdmVydGV4QnVmZmVyc1tlXTtyZXR1cm4gdD90LmlzVXBkYXRhYmxlKCk6ITF9Z2V0VmVydGV4QnVmZmVyKGUpe3JldHVybiB0aGlzLmlzUmVhZHkoKT90aGlzLl92ZXJ0ZXhCdWZmZXJzW2VdOm51bGx9Z2V0VmVydGV4QnVmZmVycygpe3JldHVybiB0aGlzLmlzUmVhZHkoKT90aGlzLl92ZXJ0ZXhCdWZmZXJzOm51bGx9aXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUpe3JldHVybiB0aGlzLl92ZXJ0ZXhCdWZmZXJzP3RoaXMuX3ZlcnRleEJ1ZmZlcnNbZV0hPT12b2lkIDA6dGhpcy5fZGVsYXlJbmZvP3RoaXMuX2RlbGF5SW5mby5pbmRleE9mKGUpIT09LTE6ITF9Z2V0VmVydGljZXNEYXRhS2luZHMoKXtjb25zdCBlPVtdO2xldCB0O2lmKCF0aGlzLl92ZXJ0ZXhCdWZmZXJzJiZ0aGlzLl9kZWxheUluZm8pZm9yKHQgaW4gdGhpcy5fZGVsYXlJbmZvKWUucHVzaCh0KTtlbHNlIGZvcih0IGluIHRoaXMuX3ZlcnRleEJ1ZmZlcnMpZS5wdXNoKHQpO3JldHVybiBlfXVwZGF0ZUluZGljZXMoZSx0LGk9ITEpe2lmKHRoaXMuX2luZGV4QnVmZmVyKWlmKCF0aGlzLl9pbmRleEJ1ZmZlcklzVXBkYXRhYmxlKXRoaXMuc2V0SW5kaWNlcyhlLG51bGwsITApO2Vsc2V7Y29uc3Qgcz1lLmxlbmd0aCE9PXRoaXMuX2luZGljZXMubGVuZ3RoO2lmKGl8fCh0aGlzLl9pbmRpY2VzPWUuc2xpY2UoKSksdGhpcy5fZW5naW5lLnVwZGF0ZUR5bmFtaWNJbmRleEJ1ZmZlcih0aGlzLl9pbmRleEJ1ZmZlcixlLHQpLHMpZm9yKGNvbnN0IHIgb2YgdGhpcy5fbWVzaGVzKXIuX2NyZWF0ZUdsb2JhbFN1Yk1lc2goITApfX1zZXRJbmRpY2VzKGUsdD1udWxsLGk9ITEpe3RoaXMuX2luZGV4QnVmZmVyJiZ0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5faW5kZXhCdWZmZXIpLHRoaXMuX2luZGljZXM9ZSx0aGlzLl9pbmRleEJ1ZmZlcklzVXBkYXRhYmxlPWksdGhpcy5fbWVzaGVzLmxlbmd0aCE9PTAmJnRoaXMuX2luZGljZXMmJih0aGlzLl9pbmRleEJ1ZmZlcj10aGlzLl9lbmdpbmUuY3JlYXRlSW5kZXhCdWZmZXIodGhpcy5faW5kaWNlcyxpKSksdCE9bnVsbCYmKHRoaXMuX3RvdGFsVmVydGljZXM9dCk7Zm9yKGNvbnN0IHMgb2YgdGhpcy5fbWVzaGVzKXMuX2NyZWF0ZUdsb2JhbFN1Yk1lc2goITApLHMuc3luY2hyb25pemVJbnN0YW5jZXMoKTt0aGlzLl9ub3RpZnlVcGRhdGUoKX1nZXRUb3RhbEluZGljZXMoKXtyZXR1cm4gdGhpcy5pc1JlYWR5KCk/dGhpcy5faW5kaWNlcy5sZW5ndGg6MH1nZXRJbmRpY2VzKGUsdCl7aWYoIXRoaXMuaXNSZWFkeSgpKXJldHVybiBudWxsO2NvbnN0IGk9dGhpcy5faW5kaWNlcztyZXR1cm4hdCYmKCFlfHx0aGlzLl9tZXNoZXMubGVuZ3RoPT09MSk/aTppLnNsaWNlKCl9Z2V0SW5kZXhCdWZmZXIoKXtyZXR1cm4gdGhpcy5pc1JlYWR5KCk/dGhpcy5faW5kZXhCdWZmZXI6bnVsbH1fcmVsZWFzZVZlcnRleEFycmF5T2JqZWN0KGU9bnVsbCl7IWV8fCF0aGlzLl92ZXJ0ZXhBcnJheU9iamVjdHN8fHRoaXMuX3ZlcnRleEFycmF5T2JqZWN0c1tlLmtleV0mJih0aGlzLl9lbmdpbmUucmVsZWFzZVZlcnRleEFycmF5T2JqZWN0KHRoaXMuX3ZlcnRleEFycmF5T2JqZWN0c1tlLmtleV0pLGRlbGV0ZSB0aGlzLl92ZXJ0ZXhBcnJheU9iamVjdHNbZS5rZXldKX1yZWxlYXNlRm9yTWVzaChlLHQpe2NvbnN0IGk9dGhpcy5fbWVzaGVzLHM9aS5pbmRleE9mKGUpO3MhPT0tMSYmKGkuc3BsaWNlKHMsMSksdGhpcy5fdmVydGV4QXJyYXlPYmplY3RzJiZlLl9pbnZhbGlkYXRlSW5zdGFuY2VWZXJ0ZXhBcnJheU9iamVjdCgpLGUuX2dlb21ldHJ5PW51bGwsaS5sZW5ndGg9PT0wJiZ0JiZ0aGlzLmRpc3Bvc2UoKSl9YXBwbHlUb01lc2goZSl7aWYoZS5fZ2VvbWV0cnk9PT10aGlzKXJldHVybjtjb25zdCB0PWUuX2dlb21ldHJ5O3QmJnQucmVsZWFzZUZvck1lc2goZSksdGhpcy5fdmVydGV4QXJyYXlPYmplY3RzJiZlLl9pbnZhbGlkYXRlSW5zdGFuY2VWZXJ0ZXhBcnJheU9iamVjdCgpO2NvbnN0IGk9dGhpcy5fbWVzaGVzO2UuX2dlb21ldHJ5PXRoaXMsZS5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fcG9zaXRpb25zPW51bGwsdGhpcy5fc2NlbmUucHVzaEdlb21ldHJ5KHRoaXMpLGkucHVzaChlKSx0aGlzLmlzUmVhZHkoKT90aGlzLl9hcHBseVRvTWVzaChlKTp0aGlzLl9ib3VuZGluZ0luZm8mJmUuc2V0Qm91bmRpbmdJbmZvKHRoaXMuX2JvdW5kaW5nSW5mbyl9X3VwZGF0ZUV4dGVuZChlPW51bGwpe2lmKHRoaXMudXNlQm91bmRpbmdJbmZvRnJvbUdlb21ldHJ5JiZ0aGlzLl9ib3VuZGluZ0luZm8pdGhpcy5fZXh0ZW5kPXttaW5pbXVtOnRoaXMuX2JvdW5kaW5nSW5mby5taW5pbXVtLmNsb25lKCksbWF4aW11bTp0aGlzLl9ib3VuZGluZ0luZm8ubWF4aW11bS5jbG9uZSgpfTtlbHNle2lmKCFlJiYoZT10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCksIWUpKXJldHVybjt0aGlzLl9leHRlbmQ9eXIoZSwwLHRoaXMuX3RvdGFsVmVydGljZXMsdGhpcy5ib3VuZGluZ0JpYXMsMyl9fV9hcHBseVRvTWVzaChlKXtjb25zdCB0PXRoaXMuX21lc2hlcy5sZW5ndGg7Zm9yKGNvbnN0IGkgaW4gdGhpcy5fdmVydGV4QnVmZmVycyl0PT09MSYmdGhpcy5fdmVydGV4QnVmZmVyc1tpXS5jcmVhdGUoKSxpPT09Zy5Qb3NpdGlvbktpbmQmJih0aGlzLl9leHRlbmR8fHRoaXMuX3VwZGF0ZUV4dGVuZCgpLGUuYnVpbGRCb3VuZGluZ0luZm8odGhpcy5fZXh0ZW5kLm1pbmltdW0sdGhpcy5fZXh0ZW5kLm1heGltdW0pLGUuX2NyZWF0ZUdsb2JhbFN1Yk1lc2goZS5pc1VuSW5kZXhlZCksZS5fdXBkYXRlQm91bmRpbmdJbmZvKCkpO3Q9PT0xJiZ0aGlzLl9pbmRpY2VzJiZ0aGlzLl9pbmRpY2VzLmxlbmd0aD4wJiYodGhpcy5faW5kZXhCdWZmZXI9dGhpcy5fZW5naW5lLmNyZWF0ZUluZGV4QnVmZmVyKHRoaXMuX2luZGljZXMsdGhpcy5fdXBkYXRhYmxlKSksZS5fc3luY0dlb21ldHJ5V2l0aE1vcnBoVGFyZ2V0TWFuYWdlcigpLGUuc3luY2hyb25pemVJbnN0YW5jZXMoKX1fbm90aWZ5VXBkYXRlKGUpe3RoaXMub25HZW9tZXRyeVVwZGF0ZWQmJnRoaXMub25HZW9tZXRyeVVwZGF0ZWQodGhpcyxlKSx0aGlzLl92ZXJ0ZXhBcnJheU9iamVjdHMmJnRoaXMuX2Rpc3Bvc2VWZXJ0ZXhBcnJheU9iamVjdHMoKTtmb3IoY29uc3QgdCBvZiB0aGlzLl9tZXNoZXMpdC5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCl9bG9hZChlLHQpe2lmKHRoaXMuZGVsYXlMb2FkU3RhdGUhPT0yKXtpZih0aGlzLmlzUmVhZHkoKSl7dCYmdCgpO3JldHVybn10aGlzLmRlbGF5TG9hZFN0YXRlPTIsdGhpcy5fcXVldWVMb2FkKGUsdCl9fV9xdWV1ZUxvYWQoZSx0KXt0aGlzLmRlbGF5TG9hZGluZ0ZpbGUmJihlLmFkZFBlbmRpbmdEYXRhKHRoaXMpLGUuX2xvYWRGaWxlKHRoaXMuZGVsYXlMb2FkaW5nRmlsZSxpPT57aWYoIXRoaXMuX2RlbGF5TG9hZGluZ0Z1bmN0aW9uKXJldHVybjt0aGlzLl9kZWxheUxvYWRpbmdGdW5jdGlvbihKU09OLnBhcnNlKGkpLHRoaXMpLHRoaXMuZGVsYXlMb2FkU3RhdGU9MSx0aGlzLl9kZWxheUluZm89W10sZS5yZW1vdmVQZW5kaW5nRGF0YSh0aGlzKTtjb25zdCBzPXRoaXMuX21lc2hlcyxyPXMubGVuZ3RoO2ZvcihsZXQgbj0wO248cjtuKyspdGhpcy5fYXBwbHlUb01lc2goc1tuXSk7dCYmdCgpfSx2b2lkIDAsITApKX10b0xlZnRIYW5kZWQoKXtjb25zdCBlPXRoaXMuZ2V0SW5kaWNlcyghMSk7aWYoZSE9bnVsbCYmZS5sZW5ndGg+MCl7Zm9yKGxldCBzPTA7czxlLmxlbmd0aDtzKz0zKXtjb25zdCByPWVbcyswXTtlW3MrMF09ZVtzKzJdLGVbcysyXT1yfXRoaXMuc2V0SW5kaWNlcyhlKX1jb25zdCB0PXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kLCExKTtpZih0IT1udWxsJiZ0Lmxlbmd0aD4wKXtmb3IobGV0IHM9MDtzPHQubGVuZ3RoO3MrPTMpdFtzKzJdPS10W3MrMl07dGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsdCwhMSl9Y29uc3QgaT10aGlzLmdldFZlcnRpY2VzRGF0YShnLk5vcm1hbEtpbmQsITEpO2lmKGkhPW51bGwmJmkubGVuZ3RoPjApe2ZvcihsZXQgcz0wO3M8aS5sZW5ndGg7cys9MylpW3MrMl09LWlbcysyXTt0aGlzLnNldFZlcnRpY2VzRGF0YShnLk5vcm1hbEtpbmQsaSwhMSl9fV9yZXNldFBvaW50c0FycmF5Q2FjaGUoKXt0aGlzLl9wb3NpdGlvbnM9bnVsbH1fZ2VuZXJhdGVQb2ludHNBcnJheSgpe2lmKHRoaXMuX3Bvc2l0aW9ucylyZXR1cm4hMDtjb25zdCBlPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kKTtpZighZXx8ZS5sZW5ndGg9PT0wKXJldHVybiExO2ZvcihsZXQgdD10aGlzLl9wb3NpdGlvbnNDYWNoZS5sZW5ndGgqMyxpPXRoaXMuX3Bvc2l0aW9uc0NhY2hlLmxlbmd0aDt0PGUubGVuZ3RoO3QrPTMsKytpKXRoaXMuX3Bvc2l0aW9uc0NhY2hlW2ldPXAuRnJvbUFycmF5KGUsdCk7Zm9yKGxldCB0PTAsaT0wO3Q8ZS5sZW5ndGg7dCs9MywrK2kpdGhpcy5fcG9zaXRpb25zQ2FjaGVbaV0uc2V0KGVbMCt0XSxlWzErdF0sZVsyK3RdKTtyZXR1cm4gdGhpcy5fcG9zaXRpb25zQ2FjaGUubGVuZ3RoPWUubGVuZ3RoLzMsdGhpcy5fcG9zaXRpb25zPXRoaXMuX3Bvc2l0aW9uc0NhY2hlLCEwfWlzRGlzcG9zZWQoKXtyZXR1cm4gdGhpcy5faXNEaXNwb3NlZH1fZGlzcG9zZVZlcnRleEFycmF5T2JqZWN0cygpe2lmKHRoaXMuX3ZlcnRleEFycmF5T2JqZWN0cyl7Zm9yKGNvbnN0IGkgaW4gdGhpcy5fdmVydGV4QXJyYXlPYmplY3RzKXRoaXMuX2VuZ2luZS5yZWxlYXNlVmVydGV4QXJyYXlPYmplY3QodGhpcy5fdmVydGV4QXJyYXlPYmplY3RzW2ldKTt0aGlzLl92ZXJ0ZXhBcnJheU9iamVjdHM9e307Y29uc3QgZT10aGlzLl9tZXNoZXMsdD1lLmxlbmd0aDtmb3IobGV0IGk9MDtpPHQ7aSsrKWVbaV0uX2ludmFsaWRhdGVJbnN0YW5jZVZlcnRleEFycmF5T2JqZWN0KCl9fWRpc3Bvc2UoKXtjb25zdCBlPXRoaXMuX21lc2hlcyx0PWUubGVuZ3RoO2xldCBpO2ZvcihpPTA7aTx0O2krKyl0aGlzLnJlbGVhc2VGb3JNZXNoKGVbaV0pO3RoaXMuX21lc2hlcy5sZW5ndGg9MCx0aGlzLl9kaXNwb3NlVmVydGV4QXJyYXlPYmplY3RzKCk7Zm9yKGNvbnN0IHMgaW4gdGhpcy5fdmVydGV4QnVmZmVycyl0aGlzLl92ZXJ0ZXhCdWZmZXJzW3NdLmRpc3Bvc2UoKTtpZih0aGlzLl92ZXJ0ZXhCdWZmZXJzPXt9LHRoaXMuX3RvdGFsVmVydGljZXM9MCx0aGlzLl9pbmRleEJ1ZmZlciYmdGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHRoaXMuX2luZGV4QnVmZmVyKSx0aGlzLl9pbmRleEJ1ZmZlcj1udWxsLHRoaXMuX2luZGljZXM9W10sdGhpcy5kZWxheUxvYWRTdGF0ZT0wLHRoaXMuZGVsYXlMb2FkaW5nRmlsZT1udWxsLHRoaXMuX2RlbGF5TG9hZGluZ0Z1bmN0aW9uPW51bGwsdGhpcy5fZGVsYXlJbmZvPVtdLHRoaXMuX2JvdW5kaW5nSW5mbz1udWxsLHRoaXMuX3NjZW5lLnJlbW92ZUdlb21ldHJ5KHRoaXMpLHRoaXMuX3BhcmVudENvbnRhaW5lcil7Y29uc3Qgcz10aGlzLl9wYXJlbnRDb250YWluZXIuZ2VvbWV0cmllcy5pbmRleE9mKHRoaXMpO3M+LTEmJnRoaXMuX3BhcmVudENvbnRhaW5lci5nZW9tZXRyaWVzLnNwbGljZShzLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfXRoaXMuX2lzRGlzcG9zZWQ9ITB9Y29weShlKXtjb25zdCB0PW5ldyBlZTt0LmluZGljZXM9W107Y29uc3QgaT10aGlzLmdldEluZGljZXMoKTtpZihpKWZvcihsZXQgbz0wO288aS5sZW5ndGg7bysrKXQuaW5kaWNlcy5wdXNoKGlbb10pO2xldCBzPSExLHI9ITEsbjtmb3IobiBpbiB0aGlzLl92ZXJ0ZXhCdWZmZXJzKXtjb25zdCBvPXRoaXMuZ2V0VmVydGljZXNEYXRhKG4pO2lmKG8mJihvIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5P3Quc2V0KG5ldyBGbG9hdDMyQXJyYXkobyksbik6dC5zZXQoby5zbGljZSgwKSxuKSwhcikpe2NvbnN0IGg9dGhpcy5nZXRWZXJ0ZXhCdWZmZXIobik7aCYmKHM9aC5pc1VwZGF0YWJsZSgpLHI9IXMpfX1jb25zdCBhPW5ldyBhdChlLHRoaXMuX3NjZW5lLHQscyk7YS5kZWxheUxvYWRTdGF0ZT10aGlzLmRlbGF5TG9hZFN0YXRlLGEuZGVsYXlMb2FkaW5nRmlsZT10aGlzLmRlbGF5TG9hZGluZ0ZpbGUsYS5fZGVsYXlMb2FkaW5nRnVuY3Rpb249dGhpcy5fZGVsYXlMb2FkaW5nRnVuY3Rpb247Zm9yKG4gaW4gdGhpcy5fZGVsYXlJbmZvKWEuX2RlbGF5SW5mbz1hLl9kZWxheUluZm98fFtdLGEuX2RlbGF5SW5mby5wdXNoKG4pO3JldHVybiBhLl9ib3VuZGluZ0luZm89bmV3IGR0KHRoaXMuX2V4dGVuZC5taW5pbXVtLHRoaXMuX2V4dGVuZC5tYXhpbXVtKSxhfXNlcmlhbGl6ZSgpe2NvbnN0IGU9e307cmV0dXJuIGUuaWQ9dGhpcy5pZCxlLnVuaXF1ZUlkPXRoaXMudW5pcXVlSWQsZS51cGRhdGFibGU9dGhpcy5fdXBkYXRhYmxlLGdlJiZnZS5IYXNUYWdzKHRoaXMpJiYoZS50YWdzPWdlLkdldFRhZ3ModGhpcykpLGV9X3RvTnVtYmVyQXJyYXkoZSl7cmV0dXJuIEFycmF5LmlzQXJyYXkoZSk/ZTpBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChlKX1jbGVhckNhY2hlZERhdGEoKXt0aGlzLl9pbmRpY2VzPVtdLHRoaXMuX3Jlc2V0UG9pbnRzQXJyYXlDYWNoZSgpO2Zvcihjb25zdCBlIGluIHRoaXMuX3ZlcnRleEJ1ZmZlcnMpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuX3ZlcnRleEJ1ZmZlcnMsZSkmJih0aGlzLl92ZXJ0ZXhCdWZmZXJzW2VdLl9idWZmZXIuX2RhdGE9bnVsbCl9c2VyaWFsaXplVmVydGljZURhdGEoKXtjb25zdCBlPXRoaXMuc2VyaWFsaXplKCk7cmV0dXJuIHRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuUG9zaXRpb25LaW5kKSYmKGUucG9zaXRpb25zPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQpKSx0aGlzLmlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGcuUG9zaXRpb25LaW5kKSYmKGUucG9zaXRpb25zLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk5vcm1hbEtpbmQpJiYoZS5ub3JtYWxzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLk5vcm1hbEtpbmQpJiYoZS5ub3JtYWxzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlRhbmdlbnRLaW5kKSYmKGUudGFuZ2VudHM9dGhpcy5fdG9OdW1iZXJBcnJheSh0aGlzLmdldFZlcnRpY2VzRGF0YShnLlRhbmdlbnRLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlRhbmdlbnRLaW5kKSYmKGUudGFuZ2VudHMuX3VwZGF0YWJsZT0hMCkpLHRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuVVZLaW5kKSYmKGUudXZzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVktpbmQpKSx0aGlzLmlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGcuVVZLaW5kKSYmKGUudXZzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWMktpbmQpJiYoZS51djJzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVjJLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlVWMktpbmQpJiYoZS51djJzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWM0tpbmQpJiYoZS51djNzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVjNLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlVWM0tpbmQpJiYoZS51djNzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNEtpbmQpJiYoZS51djRzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVjRLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlVWNEtpbmQpJiYoZS51djRzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNUtpbmQpJiYoZS51djVzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVjVLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlVWNUtpbmQpJiYoZS51djVzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNktpbmQpJiYoZS51djZzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVjZLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlVWNktpbmQpJiYoZS51djZzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLkNvbG9yS2luZCkmJihlLmNvbG9ycz10aGlzLl90b051bWJlckFycmF5KHRoaXMuZ2V0VmVydGljZXNEYXRhKGcuQ29sb3JLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLkNvbG9yS2luZCkmJihlLmNvbG9ycy5fdXBkYXRhYmxlPSEwKSksdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5NYXRyaWNlc0luZGljZXNLaW5kKSYmKGUubWF0cmljZXNJbmRpY2VzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kKSksZS5tYXRyaWNlc0luZGljZXMuX2lzRXhwYW5kZWQ9ITAsdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLk1hdHJpY2VzSW5kaWNlc0tpbmQpJiYoZS5tYXRyaWNlc0luZGljZXMuX3VwZGF0YWJsZT0hMCkpLHRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTWF0cmljZXNXZWlnaHRzS2luZCkmJihlLm1hdHJpY2VzV2VpZ2h0cz10aGlzLl90b051bWJlckFycmF5KHRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCkpLHRoaXMuaXNWZXJ0ZXhCdWZmZXJVcGRhdGFibGUoZy5NYXRyaWNlc1dlaWdodHNLaW5kKSYmKGUubWF0cmljZXNXZWlnaHRzLl91cGRhdGFibGU9ITApKSxlLmluZGljZXM9dGhpcy5fdG9OdW1iZXJBcnJheSh0aGlzLmdldEluZGljZXMoKSksZX1zdGF0aWMgRXh0cmFjdEZyb21NZXNoKGUsdCl7Y29uc3QgaT1lLl9nZW9tZXRyeTtyZXR1cm4gaT9pLmNvcHkodCk6bnVsbH1zdGF0aWMgUmFuZG9tSWQoKXtyZXR1cm4gSC5SYW5kb21JZCgpfXN0YXRpYyBfR2V0R2VvbWV0cnlCeUxvYWRlZFVuaXF1ZUlkKGUsdCl7Zm9yKGxldCBpPTA7aTx0Lmdlb21ldHJpZXMubGVuZ3RoO2krKylpZih0Lmdlb21ldHJpZXNbaV0uX2xvYWRlZFVuaXF1ZUlkPT09ZSlyZXR1cm4gdC5nZW9tZXRyaWVzW2ldO3JldHVybiBudWxsfXN0YXRpYyBfSW1wb3J0R2VvbWV0cnkoZSx0KXtjb25zdCBpPXQuZ2V0U2NlbmUoKSxzPWUuZ2VvbWV0cnlVbmlxdWVJZCxyPWUuZ2VvbWV0cnlJZDtpZihzfHxyKXtjb25zdCBuPXM/dGhpcy5fR2V0R2VvbWV0cnlCeUxvYWRlZFVuaXF1ZUlkKHMsaSk6aS5nZXRHZW9tZXRyeUJ5SWQocik7biYmbi5hcHBseVRvTWVzaCh0KX1lbHNlIGlmKGUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcil7Y29uc3Qgbj10Ll9iaW5hcnlJbmZvO2lmKG4ucG9zaXRpb25zQXR0ckRlc2MmJm4ucG9zaXRpb25zQXR0ckRlc2MuY291bnQ+MCl7Y29uc3QgYT1uZXcgRmxvYXQzMkFycmF5KGUsbi5wb3NpdGlvbnNBdHRyRGVzYy5vZmZzZXQsbi5wb3NpdGlvbnNBdHRyRGVzYy5jb3VudCk7dC5zZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsYSwhMSl9aWYobi5ub3JtYWxzQXR0ckRlc2MmJm4ubm9ybWFsc0F0dHJEZXNjLmNvdW50PjApe2NvbnN0IGE9bmV3IEZsb2F0MzJBcnJheShlLG4ubm9ybWFsc0F0dHJEZXNjLm9mZnNldCxuLm5vcm1hbHNBdHRyRGVzYy5jb3VudCk7dC5zZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kLGEsITEpfWlmKG4udGFuZ2V0c0F0dHJEZXNjJiZuLnRhbmdldHNBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBGbG9hdDMyQXJyYXkoZSxuLnRhbmdldHNBdHRyRGVzYy5vZmZzZXQsbi50YW5nZXRzQXR0ckRlc2MuY291bnQpO3Quc2V0VmVydGljZXNEYXRhKGcuVGFuZ2VudEtpbmQsYSwhMSl9aWYobi51dnNBdHRyRGVzYyYmbi51dnNBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBGbG9hdDMyQXJyYXkoZSxuLnV2c0F0dHJEZXNjLm9mZnNldCxuLnV2c0F0dHJEZXNjLmNvdW50KTtpZihmdC5Vc2VPcGVuR0xPcmllbnRhdGlvbkZvclVWKWZvcihsZXQgbz0xO288YS5sZW5ndGg7bys9MilhW29dPTEtYVtvXTt0LnNldFZlcnRpY2VzRGF0YShnLlVWS2luZCxhLCExKX1pZihuLnV2czJBdHRyRGVzYyYmbi51dnMyQXR0ckRlc2MuY291bnQ+MCl7Y29uc3QgYT1uZXcgRmxvYXQzMkFycmF5KGUsbi51dnMyQXR0ckRlc2Mub2Zmc2V0LG4udXZzMkF0dHJEZXNjLmNvdW50KTtpZihmdC5Vc2VPcGVuR0xPcmllbnRhdGlvbkZvclVWKWZvcihsZXQgbz0xO288YS5sZW5ndGg7bys9MilhW29dPTEtYVtvXTt0LnNldFZlcnRpY2VzRGF0YShnLlVWMktpbmQsYSwhMSl9aWYobi51dnMzQXR0ckRlc2MmJm4udXZzM0F0dHJEZXNjLmNvdW50PjApe2NvbnN0IGE9bmV3IEZsb2F0MzJBcnJheShlLG4udXZzM0F0dHJEZXNjLm9mZnNldCxuLnV2czNBdHRyRGVzYy5jb3VudCk7aWYoZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVilmb3IobGV0IG89MTtvPGEubGVuZ3RoO28rPTIpYVtvXT0xLWFbb107dC5zZXRWZXJ0aWNlc0RhdGEoZy5VVjNLaW5kLGEsITEpfWlmKG4udXZzNEF0dHJEZXNjJiZuLnV2czRBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBGbG9hdDMyQXJyYXkoZSxuLnV2czRBdHRyRGVzYy5vZmZzZXQsbi51dnM0QXR0ckRlc2MuY291bnQpO2lmKGZ0LlVzZU9wZW5HTE9yaWVudGF0aW9uRm9yVVYpZm9yKGxldCBvPTE7bzxhLmxlbmd0aDtvKz0yKWFbb109MS1hW29dO3Quc2V0VmVydGljZXNEYXRhKGcuVVY0S2luZCxhLCExKX1pZihuLnV2czVBdHRyRGVzYyYmbi51dnM1QXR0ckRlc2MuY291bnQ+MCl7Y29uc3QgYT1uZXcgRmxvYXQzMkFycmF5KGUsbi51dnM1QXR0ckRlc2Mub2Zmc2V0LG4udXZzNUF0dHJEZXNjLmNvdW50KTtpZihmdC5Vc2VPcGVuR0xPcmllbnRhdGlvbkZvclVWKWZvcihsZXQgbz0xO288YS5sZW5ndGg7bys9MilhW29dPTEtYVtvXTt0LnNldFZlcnRpY2VzRGF0YShnLlVWNUtpbmQsYSwhMSl9aWYobi51dnM2QXR0ckRlc2MmJm4udXZzNkF0dHJEZXNjLmNvdW50PjApe2NvbnN0IGE9bmV3IEZsb2F0MzJBcnJheShlLG4udXZzNkF0dHJEZXNjLm9mZnNldCxuLnV2czZBdHRyRGVzYy5jb3VudCk7aWYoZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVilmb3IobGV0IG89MTtvPGEubGVuZ3RoO28rPTIpYVtvXT0xLWFbb107dC5zZXRWZXJ0aWNlc0RhdGEoZy5VVjZLaW5kLGEsITEpfWlmKG4uY29sb3JzQXR0ckRlc2MmJm4uY29sb3JzQXR0ckRlc2MuY291bnQ+MCl7Y29uc3QgYT1uZXcgRmxvYXQzMkFycmF5KGUsbi5jb2xvcnNBdHRyRGVzYy5vZmZzZXQsbi5jb2xvcnNBdHRyRGVzYy5jb3VudCk7dC5zZXRWZXJ0aWNlc0RhdGEoZy5Db2xvcktpbmQsYSwhMSxuLmNvbG9yc0F0dHJEZXNjLnN0cmlkZSl9aWYobi5tYXRyaWNlc0luZGljZXNBdHRyRGVzYyYmbi5tYXRyaWNlc0luZGljZXNBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBJbnQzMkFycmF5KGUsbi5tYXRyaWNlc0luZGljZXNBdHRyRGVzYy5vZmZzZXQsbi5tYXRyaWNlc0luZGljZXNBdHRyRGVzYy5jb3VudCksbz1bXTtmb3IobGV0IGg9MDtoPGEubGVuZ3RoO2grKyl7Y29uc3QgbD1hW2hdO28ucHVzaChsJjI1NSksby5wdXNoKChsJjY1MjgwKT4+OCksby5wdXNoKChsJjE2NzExNjgwKT4+MTYpLG8ucHVzaChsPj4yNCYyNTUpfXQuc2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzS2luZCxvLCExKX1pZihuLm1hdHJpY2VzSW5kaWNlc0V4dHJhQXR0ckRlc2MmJm4ubWF0cmljZXNJbmRpY2VzRXh0cmFBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBJbnQzMkFycmF5KGUsbi5tYXRyaWNlc0luZGljZXNFeHRyYUF0dHJEZXNjLm9mZnNldCxuLm1hdHJpY2VzSW5kaWNlc0V4dHJhQXR0ckRlc2MuY291bnQpLG89W107Zm9yKGxldCBoPTA7aDxhLmxlbmd0aDtoKyspe2NvbnN0IGw9YVtoXTtvLnB1c2gobCYyNTUpLG8ucHVzaCgobCY2NTI4MCk+PjgpLG8ucHVzaCgobCYxNjcxMTY4MCk+PjE2KSxvLnB1c2gobD4+MjQmMjU1KX10LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCxvLCExKX1pZihuLm1hdHJpY2VzV2VpZ2h0c0F0dHJEZXNjJiZuLm1hdHJpY2VzV2VpZ2h0c0F0dHJEZXNjLmNvdW50PjApe2NvbnN0IGE9bmV3IEZsb2F0MzJBcnJheShlLG4ubWF0cmljZXNXZWlnaHRzQXR0ckRlc2Mub2Zmc2V0LG4ubWF0cmljZXNXZWlnaHRzQXR0ckRlc2MuY291bnQpO3Quc2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCxhLCExKX1pZihuLmluZGljZXNBdHRyRGVzYyYmbi5pbmRpY2VzQXR0ckRlc2MuY291bnQ+MCl7Y29uc3QgYT1uZXcgSW50MzJBcnJheShlLG4uaW5kaWNlc0F0dHJEZXNjLm9mZnNldCxuLmluZGljZXNBdHRyRGVzYy5jb3VudCk7dC5zZXRJbmRpY2VzKGEsbnVsbCl9aWYobi5zdWJNZXNoZXNBdHRyRGVzYyYmbi5zdWJNZXNoZXNBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBJbnQzMkFycmF5KGUsbi5zdWJNZXNoZXNBdHRyRGVzYy5vZmZzZXQsbi5zdWJNZXNoZXNBdHRyRGVzYy5jb3VudCo1KTt0LnN1Yk1lc2hlcz1bXTtmb3IobGV0IG89MDtvPG4uc3ViTWVzaGVzQXR0ckRlc2MuY291bnQ7bysrKXtjb25zdCBoPWFbbyo1KzBdLGw9YVtvKjUrMV0sdT1hW28qNSsyXSxkPWFbbyo1KzNdLGY9YVtvKjUrNF07dnQuQWRkVG9NZXNoKGgsbCx1LGQsZix0KX19fWVsc2UgaWYoZS5wb3NpdGlvbnMmJmUubm9ybWFscyYmZS5pbmRpY2VzKXtpZih0LnNldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCxlLnBvc2l0aW9ucyxlLnBvc2l0aW9ucy5fdXBkYXRhYmxlKSx0LnNldFZlcnRpY2VzRGF0YShnLk5vcm1hbEtpbmQsZS5ub3JtYWxzLGUubm9ybWFscy5fdXBkYXRhYmxlKSxlLnRhbmdlbnRzJiZ0LnNldFZlcnRpY2VzRGF0YShnLlRhbmdlbnRLaW5kLGUudGFuZ2VudHMsZS50YW5nZW50cy5fdXBkYXRhYmxlKSxlLnV2cyYmdC5zZXRWZXJ0aWNlc0RhdGEoZy5VVktpbmQsZS51dnMsZS51dnMuX3VwZGF0YWJsZSksZS51dnMyJiZ0LnNldFZlcnRpY2VzRGF0YShnLlVWMktpbmQsZS51dnMyLGUudXZzMi5fdXBkYXRhYmxlKSxlLnV2czMmJnQuc2V0VmVydGljZXNEYXRhKGcuVVYzS2luZCxlLnV2czMsZS51dnMzLl91cGRhdGFibGUpLGUudXZzNCYmdC5zZXRWZXJ0aWNlc0RhdGEoZy5VVjRLaW5kLGUudXZzNCxlLnV2czQuX3VwZGF0YWJsZSksZS51dnM1JiZ0LnNldFZlcnRpY2VzRGF0YShnLlVWNUtpbmQsZS51dnM1LGUudXZzNS5fdXBkYXRhYmxlKSxlLnV2czYmJnQuc2V0VmVydGljZXNEYXRhKGcuVVY2S2luZCxlLnV2czYsZS51dnM2Ll91cGRhdGFibGUpLGUuY29sb3JzJiZ0LnNldFZlcnRpY2VzRGF0YShnLkNvbG9yS2luZCxtZS5DaGVja0NvbG9yczQoZS5jb2xvcnMsZS5wb3NpdGlvbnMubGVuZ3RoLzMpLGUuY29sb3JzLl91cGRhdGFibGUpLGUubWF0cmljZXNJbmRpY2VzKWlmKGUubWF0cmljZXNJbmRpY2VzLl9pc0V4cGFuZGVkKWRlbGV0ZSBlLm1hdHJpY2VzSW5kaWNlcy5faXNFeHBhbmRlZCx0LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0tpbmQsZS5tYXRyaWNlc0luZGljZXMsZS5tYXRyaWNlc0luZGljZXMuX3VwZGF0YWJsZSk7ZWxzZXtjb25zdCBuPVtdO2ZvcihsZXQgYT0wO2E8ZS5tYXRyaWNlc0luZGljZXMubGVuZ3RoO2ErKyl7Y29uc3Qgbz1lLm1hdHJpY2VzSW5kaWNlc1thXTtuLnB1c2gobyYyNTUpLG4ucHVzaCgobyY2NTI4MCk+PjgpLG4ucHVzaCgobyYxNjcxMTY4MCk+PjE2KSxuLnB1c2gobz4+MjQmMjU1KX10LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0tpbmQsbixlLm1hdHJpY2VzSW5kaWNlcy5fdXBkYXRhYmxlKX1pZihlLm1hdHJpY2VzSW5kaWNlc0V4dHJhKWlmKGUubWF0cmljZXNJbmRpY2VzRXh0cmEuX2lzRXhwYW5kZWQpZGVsZXRlIGUubWF0cmljZXNJbmRpY2VzLl9pc0V4cGFuZGVkLHQuc2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kLGUubWF0cmljZXNJbmRpY2VzRXh0cmEsZS5tYXRyaWNlc0luZGljZXNFeHRyYS5fdXBkYXRhYmxlKTtlbHNle2NvbnN0IG49W107Zm9yKGxldCBhPTA7YTxlLm1hdHJpY2VzSW5kaWNlc0V4dHJhLmxlbmd0aDthKyspe2NvbnN0IG89ZS5tYXRyaWNlc0luZGljZXNFeHRyYVthXTtuLnB1c2gobyYyNTUpLG4ucHVzaCgobyY2NTI4MCk+PjgpLG4ucHVzaCgobyYxNjcxMTY4MCk+PjE2KSxuLnB1c2gobz4+MjQmMjU1KX10LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCxuLGUubWF0cmljZXNJbmRpY2VzRXh0cmEuX3VwZGF0YWJsZSl9ZS5tYXRyaWNlc1dlaWdodHMmJihhdC5fQ2xlYW5NYXRyaWNlc1dlaWdodHMoZSx0KSx0LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQsZS5tYXRyaWNlc1dlaWdodHMsZS5tYXRyaWNlc1dlaWdodHMuX3VwZGF0YWJsZSkpLGUubWF0cmljZXNXZWlnaHRzRXh0cmEmJnQuc2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kLGUubWF0cmljZXNXZWlnaHRzRXh0cmEsZS5tYXRyaWNlc1dlaWdodHMuX3VwZGF0YWJsZSksdC5zZXRJbmRpY2VzKGUuaW5kaWNlcyxudWxsKX1pZihlLnN1Yk1lc2hlcyl7dC5zdWJNZXNoZXM9W107Zm9yKGxldCBuPTA7bjxlLnN1Yk1lc2hlcy5sZW5ndGg7bisrKXtjb25zdCBhPWUuc3ViTWVzaGVzW25dO3Z0LkFkZFRvTWVzaChhLm1hdGVyaWFsSW5kZXgsYS52ZXJ0aWNlc1N0YXJ0LGEudmVydGljZXNDb3VudCxhLmluZGV4U3RhcnQsYS5pbmRleENvdW50LHQpfX10Ll9zaG91bGRHZW5lcmF0ZUZsYXRTaGFkaW5nJiYodC5jb252ZXJ0VG9GbGF0U2hhZGVkTWVzaCgpLHQuX3Nob3VsZEdlbmVyYXRlRmxhdFNoYWRpbmc9ITEpLHQuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSxpLm9uTWVzaEltcG9ydGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModCl9c3RhdGljIF9DbGVhbk1hdHJpY2VzV2VpZ2h0cyhlLHQpe2lmKCFPZS5DbGVhbkJvbmVNYXRyaXhXZWlnaHRzKXJldHVybjtsZXQgcz0wO2lmKGUuc2tlbGV0b25JZD4tMSl7Y29uc3QgdT10LmdldFNjZW5lKCkuZ2V0TGFzdFNrZWxldG9uQnlJZChlLnNrZWxldG9uSWQpO2lmKCF1KXJldHVybjtzPXUuYm9uZXMubGVuZ3RofWVsc2UgcmV0dXJuO2NvbnN0IHI9dC5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kKSxuPXQuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kKSxhPWUubWF0cmljZXNXZWlnaHRzLG89ZS5tYXRyaWNlc1dlaWdodHNFeHRyYSxoPWUubnVtQm9uZUluZmx1ZW5jZXIsbD1hLmxlbmd0aDtmb3IobGV0IHU9MDt1PGw7dSs9NCl7bGV0IGQ9MCxmPS0xO2ZvcihsZXQgXz0wO188NDtfKyspe2NvbnN0IEU9YVt1K19dO2QrPUUsRTwuMDAxJiZmPDAmJihmPV8pfWlmKG8pZm9yKGxldCBfPTA7Xzw0O18rKyl7Y29uc3QgRT1vW3UrX107ZCs9RSxFPC4wMDEmJmY8MCYmKGY9Xys0KX1pZigoZjwwfHxmPmgtMSkmJihmPWgtMSksZD4uMDAxKXtjb25zdCBfPTEvZDtmb3IobGV0IEU9MDtFPDQ7RSsrKWFbdStFXSo9XztpZihvKWZvcihsZXQgRT0wO0U8NDtFKyspb1t1K0VdKj1ffWVsc2UgZj49ND8ob1t1K2YtNF09MS1kLG5bdStmLTRdPXMpOihhW3UrZl09MS1kLHJbdStmXT1zKX10LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0tpbmQsciksZS5tYXRyaWNlc1dlaWdodHNFeHRyYSYmdC5zZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNFeHRyYUtpbmQsbil9c3RhdGljIFBhcnNlKGUsdCxpKXtjb25zdCBzPW5ldyBhdChlLmlkLHQsdm9pZCAwLGUudXBkYXRhYmxlKTtyZXR1cm4gcy5fbG9hZGVkVW5pcXVlSWQ9ZS51bmlxdWVJZCxnZSYmZ2UuQWRkVGFnc1RvKHMsZS50YWdzKSxlLmRlbGF5TG9hZGluZ0ZpbGU/KHMuZGVsYXlMb2FkU3RhdGU9NCxzLmRlbGF5TG9hZGluZ0ZpbGU9aStlLmRlbGF5TG9hZGluZ0ZpbGUscy5fYm91bmRpbmdJbmZvPW5ldyBkdChwLkZyb21BcnJheShlLmJvdW5kaW5nQm94TWluaW11bSkscC5Gcm9tQXJyYXkoZS5ib3VuZGluZ0JveE1heGltdW0pKSxzLl9kZWxheUluZm89W10sZS5oYXNVVnMmJnMuX2RlbGF5SW5mby5wdXNoKGcuVVZLaW5kKSxlLmhhc1VWczImJnMuX2RlbGF5SW5mby5wdXNoKGcuVVYyS2luZCksZS5oYXNVVnMzJiZzLl9kZWxheUluZm8ucHVzaChnLlVWM0tpbmQpLGUuaGFzVVZzNCYmcy5fZGVsYXlJbmZvLnB1c2goZy5VVjRLaW5kKSxlLmhhc1VWczUmJnMuX2RlbGF5SW5mby5wdXNoKGcuVVY1S2luZCksZS5oYXNVVnM2JiZzLl9kZWxheUluZm8ucHVzaChnLlVWNktpbmQpLGUuaGFzQ29sb3JzJiZzLl9kZWxheUluZm8ucHVzaChnLkNvbG9yS2luZCksZS5oYXNNYXRyaWNlc0luZGljZXMmJnMuX2RlbGF5SW5mby5wdXNoKGcuTWF0cmljZXNJbmRpY2VzS2luZCksZS5oYXNNYXRyaWNlc1dlaWdodHMmJnMuX2RlbGF5SW5mby5wdXNoKGcuTWF0cmljZXNXZWlnaHRzS2luZCkscy5fZGVsYXlMb2FkaW5nRnVuY3Rpb249ZWUuSW1wb3J0VmVydGV4RGF0YSk6ZWUuSW1wb3J0VmVydGV4RGF0YShlLHMpLHQucHVzaEdlb21ldHJ5KHMsITApLHN9fXZhciBWdDsoZnVuY3Rpb24oYyl7Y1tjLkxPQ0FMPTBdPSJMT0NBTCIsY1tjLldPUkxEPTFdPSJXT1JMRCIsY1tjLkJPTkU9Ml09IkJPTkUifSkoVnR8fChWdD17fSkpO2NsYXNzIF9pe31faS5YPW5ldyBwKDEsMCwwKSxfaS5ZPW5ldyBwKDAsMSwwKSxfaS5aPW5ldyBwKDAsMCwxKTt2YXIgQ3I7KGZ1bmN0aW9uKGMpe2NbYy5YPTBdPSJYIixjW2MuWT0xXT0iWSIsY1tjLlo9Ml09IloifSkoQ3J8fChDcj17fSkpO2NsYXNzIEogZXh0ZW5kcyB6ZXtjb25zdHJ1Y3RvcihlLHQ9bnVsbCxpPSEwKXtzdXBlcihlLHQpLHRoaXMuX2ZvcndhcmQ9bmV3IHAoMCwwLDEpLHRoaXMuX3VwPW5ldyBwKDAsMSwwKSx0aGlzLl9yaWdodD1uZXcgcCgxLDAsMCksdGhpcy5fcG9zaXRpb249cC5aZXJvKCksdGhpcy5fcm90YXRpb249cC5aZXJvKCksdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uPW51bGwsdGhpcy5fc2NhbGluZz1wLk9uZSgpLHRoaXMuX3RyYW5zZm9ybVRvQm9uZVJlZmVyYWw9bnVsbCx0aGlzLl9pc0Fic29sdXRlU3luY2VkPSExLHRoaXMuX2JpbGxib2FyZE1vZGU9Si5CSUxMQk9BUkRNT0RFX05PTkUsdGhpcy5fcHJlc2VydmVQYXJlbnRSb3RhdGlvbkZvckJpbGxib2FyZD0hMSx0aGlzLnNjYWxpbmdEZXRlcm1pbmFudD0xLHRoaXMuX2luZmluaXRlRGlzdGFuY2U9ITEsdGhpcy5pZ25vcmVOb25Vbmlmb3JtU2NhbGluZz0hMSx0aGlzLnJlSW50ZWdyYXRlUm90YXRpb25JbnRvUm90YXRpb25RdWF0ZXJuaW9uPSExLHRoaXMuX3Bvc2VNYXRyaXg9bnVsbCx0aGlzLl9sb2NhbE1hdHJpeD14Llplcm8oKSx0aGlzLl91c2VQaXZvdE1hdHJpeD0hMSx0aGlzLl9hYnNvbHV0ZVBvc2l0aW9uPXAuWmVybygpLHRoaXMuX2Fic29sdXRlU2NhbGluZz1wLlplcm8oKSx0aGlzLl9hYnNvbHV0ZVJvdGF0aW9uUXVhdGVybmlvbj1aLklkZW50aXR5KCksdGhpcy5fcGl2b3RNYXRyaXg9eC5JZGVudGl0eSgpLHRoaXMuX3Bvc3RNdWx0aXBseVBpdm90TWF0cml4PSExLHRoaXMuX2lzV29ybGRNYXRyaXhGcm96ZW49ITEsdGhpcy5faW5kZXhJblNjZW5lVHJhbnNmb3JtTm9kZXNBcnJheT0tMSx0aGlzLm9uQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZU9ic2VydmFibGU9bmV3IEYsdGhpcy5fbm9uVW5pZm9ybVNjYWxpbmc9ITEsaSYmdGhpcy5nZXRTY2VuZSgpLmFkZFRyYW5zZm9ybU5vZGUodGhpcyl9Z2V0IGJpbGxib2FyZE1vZGUoKXtyZXR1cm4gdGhpcy5fYmlsbGJvYXJkTW9kZX1zZXQgYmlsbGJvYXJkTW9kZShlKXt0aGlzLl9iaWxsYm9hcmRNb2RlIT09ZSYmKHRoaXMuX2JpbGxib2FyZE1vZGU9ZSl9Z2V0IHByZXNlcnZlUGFyZW50Um90YXRpb25Gb3JCaWxsYm9hcmQoKXtyZXR1cm4gdGhpcy5fcHJlc2VydmVQYXJlbnRSb3RhdGlvbkZvckJpbGxib2FyZH1zZXQgcHJlc2VydmVQYXJlbnRSb3RhdGlvbkZvckJpbGxib2FyZChlKXtlIT09dGhpcy5fcHJlc2VydmVQYXJlbnRSb3RhdGlvbkZvckJpbGxib2FyZCYmKHRoaXMuX3ByZXNlcnZlUGFyZW50Um90YXRpb25Gb3JCaWxsYm9hcmQ9ZSl9Z2V0IGluZmluaXRlRGlzdGFuY2UoKXtyZXR1cm4gdGhpcy5faW5maW5pdGVEaXN0YW5jZX1zZXQgaW5maW5pdGVEaXN0YW5jZShlKXt0aGlzLl9pbmZpbml0ZURpc3RhbmNlIT09ZSYmKHRoaXMuX2luZmluaXRlRGlzdGFuY2U9ZSl9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIlRyYW5zZm9ybU5vZGUifWdldCBwb3NpdGlvbigpe3JldHVybiB0aGlzLl9wb3NpdGlvbn1zZXQgcG9zaXRpb24oZSl7dGhpcy5fcG9zaXRpb249ZSx0aGlzLl9pc0RpcnR5PSEwfWlzVXNpbmdQaXZvdE1hdHJpeCgpe3JldHVybiB0aGlzLl91c2VQaXZvdE1hdHJpeH1nZXQgcm90YXRpb24oKXtyZXR1cm4gdGhpcy5fcm90YXRpb259c2V0IHJvdGF0aW9uKGUpe3RoaXMuX3JvdGF0aW9uPWUsdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uPW51bGwsdGhpcy5faXNEaXJ0eT0hMH1nZXQgc2NhbGluZygpe3JldHVybiB0aGlzLl9zY2FsaW5nfXNldCBzY2FsaW5nKGUpe3RoaXMuX3NjYWxpbmc9ZSx0aGlzLl9pc0RpcnR5PSEwfWdldCByb3RhdGlvblF1YXRlcm5pb24oKXtyZXR1cm4gdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9ufXNldCByb3RhdGlvblF1YXRlcm5pb24oZSl7dGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uPWUsZSYmdGhpcy5fcm90YXRpb24uc2V0QWxsKDApLHRoaXMuX2lzRGlydHk9ITB9Z2V0IGZvcndhcmQoKXtyZXR1cm4gcC5UcmFuc2Zvcm1Ob3JtYWxGcm9tRmxvYXRzVG9SZWYoMCwwLHRoaXMuZ2V0U2NlbmUoKS51c2VSaWdodEhhbmRlZFN5c3RlbT8tMToxLHRoaXMuZ2V0V29ybGRNYXRyaXgoKSx0aGlzLl9mb3J3YXJkKSx0aGlzLl9mb3J3YXJkLm5vcm1hbGl6ZSgpfWdldCB1cCgpe3JldHVybiBwLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZigwLDEsMCx0aGlzLmdldFdvcmxkTWF0cml4KCksdGhpcy5fdXApLHRoaXMuX3VwLm5vcm1hbGl6ZSgpfWdldCByaWdodCgpe3JldHVybiBwLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZih0aGlzLmdldFNjZW5lKCkudXNlUmlnaHRIYW5kZWRTeXN0ZW0/LTE6MSwwLDAsdGhpcy5nZXRXb3JsZE1hdHJpeCgpLHRoaXMuX3JpZ2h0KSx0aGlzLl9yaWdodC5ub3JtYWxpemUoKX11cGRhdGVQb3NlTWF0cml4KGUpe3JldHVybiB0aGlzLl9wb3NlTWF0cml4Pyh0aGlzLl9wb3NlTWF0cml4LmNvcHlGcm9tKGUpLHRoaXMpOih0aGlzLl9wb3NlTWF0cml4PWUuY2xvbmUoKSx0aGlzKX1nZXRQb3NlTWF0cml4KCl7cmV0dXJuIHRoaXMuX3Bvc2VNYXRyaXh8fCh0aGlzLl9wb3NlTWF0cml4PXguSWRlbnRpdHkoKSksdGhpcy5fcG9zZU1hdHJpeH1faXNTeW5jaHJvbml6ZWQoKXtjb25zdCBlPXRoaXMuX2NhY2hlO3JldHVybiEodGhpcy5fYmlsbGJvYXJkTW9kZSE9PWUuYmlsbGJvYXJkTW9kZXx8dGhpcy5fYmlsbGJvYXJkTW9kZSE9PUouQklMTEJPQVJETU9ERV9OT05FfHxlLnBpdm90TWF0cml4VXBkYXRlZHx8dGhpcy5faW5maW5pdGVEaXN0YW5jZXx8dGhpcy5fcG9zaXRpb24uX2lzRGlydHl8fHRoaXMuX3NjYWxpbmcuX2lzRGlydHl8fHRoaXMuX3JvdGF0aW9uUXVhdGVybmlvbiYmdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uLl9pc0RpcnR5fHx0aGlzLl9yb3RhdGlvbi5faXNEaXJ0eSl9X2luaXRDYWNoZSgpe3N1cGVyLl9pbml0Q2FjaGUoKTtjb25zdCBlPXRoaXMuX2NhY2hlO2UubG9jYWxNYXRyaXhVcGRhdGVkPSExLGUuYmlsbGJvYXJkTW9kZT0tMSxlLmluZmluaXRlRGlzdGFuY2U9ITF9Z2V0IGFic29sdXRlUG9zaXRpb24oKXtyZXR1cm4gdGhpcy5nZXRBYnNvbHV0ZVBvc2l0aW9uKCl9Z2V0IGFic29sdXRlU2NhbGluZygpe3JldHVybiB0aGlzLl9zeW5jQWJzb2x1dGVTY2FsaW5nQW5kUm90YXRpb24oKSx0aGlzLl9hYnNvbHV0ZVNjYWxpbmd9Z2V0IGFic29sdXRlUm90YXRpb25RdWF0ZXJuaW9uKCl7cmV0dXJuIHRoaXMuX3N5bmNBYnNvbHV0ZVNjYWxpbmdBbmRSb3RhdGlvbigpLHRoaXMuX2Fic29sdXRlUm90YXRpb25RdWF0ZXJuaW9ufXNldFByZVRyYW5zZm9ybU1hdHJpeChlKXtyZXR1cm4gdGhpcy5zZXRQaXZvdE1hdHJpeChlLCExKX1zZXRQaXZvdE1hdHJpeChlLHQ9ITApe3JldHVybiB0aGlzLl9waXZvdE1hdHJpeC5jb3B5RnJvbShlKSx0aGlzLl91c2VQaXZvdE1hdHJpeD0hdGhpcy5fcGl2b3RNYXRyaXguaXNJZGVudGl0eSgpLHRoaXMuX2NhY2hlLnBpdm90TWF0cml4VXBkYXRlZD0hMCx0aGlzLl9wb3N0TXVsdGlwbHlQaXZvdE1hdHJpeD10LHRoaXMuX3Bvc3RNdWx0aXBseVBpdm90TWF0cml4JiYodGhpcy5fcGl2b3RNYXRyaXhJbnZlcnNlP3RoaXMuX3Bpdm90TWF0cml4LmludmVydFRvUmVmKHRoaXMuX3Bpdm90TWF0cml4SW52ZXJzZSk6dGhpcy5fcGl2b3RNYXRyaXhJbnZlcnNlPXguSW52ZXJ0KHRoaXMuX3Bpdm90TWF0cml4KSksdGhpc31nZXRQaXZvdE1hdHJpeCgpe3JldHVybiB0aGlzLl9waXZvdE1hdHJpeH1pbnN0YW50aWF0ZUhpZXJhcmNoeShlPW51bGwsdCxpKXtjb25zdCBzPXRoaXMuY2xvbmUoIkNsb25lIG9mICIrKHRoaXMubmFtZXx8dGhpcy5pZCksZXx8dGhpcy5wYXJlbnQsITApO3MmJmkmJmkodGhpcyxzKTtmb3IoY29uc3QgciBvZiB0aGlzLmdldENoaWxkVHJhbnNmb3JtTm9kZXMoITApKXIuaW5zdGFudGlhdGVIaWVyYXJjaHkocyx0LGkpO3JldHVybiBzfWZyZWV6ZVdvcmxkTWF0cml4KGU9bnVsbCx0PSExKXtyZXR1cm4gZT90Pyh0aGlzLl9yb3RhdGlvbi5zZXRBbGwoMCksdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uPXRoaXMuX3JvdGF0aW9uUXVhdGVybmlvbnx8Wi5JZGVudGl0eSgpLGUuZGVjb21wb3NlKHRoaXMuX3NjYWxpbmcsdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uLHRoaXMuX3Bvc2l0aW9uKSx0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCghMCkpOih0aGlzLl93b3JsZE1hdHJpeD1lLHRoaXMuX2Fic29sdXRlUG9zaXRpb24uY29weUZyb21GbG9hdHModGhpcy5fd29ybGRNYXRyaXgubVsxMl0sdGhpcy5fd29ybGRNYXRyaXgubVsxM10sdGhpcy5fd29ybGRNYXRyaXgubVsxNF0pLHRoaXMuX2FmdGVyQ29tcHV0ZVdvcmxkTWF0cml4KCkpOih0aGlzLl9pc1dvcmxkTWF0cml4RnJvemVuPSExLHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSksdGhpcy5faXNEaXJ0eT0hMSx0aGlzLl9pc1dvcmxkTWF0cml4RnJvemVuPSEwLHRoaXN9dW5mcmVlemVXb3JsZE1hdHJpeCgpe3JldHVybiB0aGlzLl9pc1dvcmxkTWF0cml4RnJvemVuPSExLHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSx0aGlzfWdldCBpc1dvcmxkTWF0cml4RnJvemVuKCl7cmV0dXJuIHRoaXMuX2lzV29ybGRNYXRyaXhGcm96ZW59Z2V0QWJzb2x1dGVQb3NpdGlvbigpe3JldHVybiB0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCgpLHRoaXMuX2Fic29sdXRlUG9zaXRpb259c2V0QWJzb2x1dGVQb3NpdGlvbihlKXtpZighZSlyZXR1cm4gdGhpcztsZXQgdCxpLHM7aWYoZS54PT09dm9pZCAwKXtpZihhcmd1bWVudHMubGVuZ3RoPDMpcmV0dXJuIHRoaXM7dD1hcmd1bWVudHNbMF0saT1hcmd1bWVudHNbMV0scz1hcmd1bWVudHNbMl19ZWxzZSB0PWUueCxpPWUueSxzPWUuejtpZih0aGlzLnBhcmVudCl7Y29uc3Qgcj1ELk1hdHJpeFswXTt0aGlzLnBhcmVudC5nZXRXb3JsZE1hdHJpeCgpLmludmVydFRvUmVmKHIpLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNGcm9tRmxvYXRzVG9SZWYodCxpLHMscix0aGlzLnBvc2l0aW9uKX1lbHNlIHRoaXMucG9zaXRpb24ueD10LHRoaXMucG9zaXRpb24ueT1pLHRoaXMucG9zaXRpb24uej1zO3JldHVybiB0aGlzLl9hYnNvbHV0ZVBvc2l0aW9uLmNvcHlGcm9tKGUpLHRoaXN9c2V0UG9zaXRpb25XaXRoTG9jYWxWZWN0b3IoZSl7cmV0dXJuIHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCksdGhpcy5wb3NpdGlvbj1wLlRyYW5zZm9ybU5vcm1hbChlLHRoaXMuX2xvY2FsTWF0cml4KSx0aGlzfWdldFBvc2l0aW9uRXhwcmVzc2VkSW5Mb2NhbFNwYWNlKCl7dGhpcy5jb21wdXRlV29ybGRNYXRyaXgoKTtjb25zdCBlPUQuTWF0cml4WzBdO3JldHVybiB0aGlzLl9sb2NhbE1hdHJpeC5pbnZlcnRUb1JlZihlKSxwLlRyYW5zZm9ybU5vcm1hbCh0aGlzLnBvc2l0aW9uLGUpfWxvY2FsbHlUcmFuc2xhdGUoZSl7cmV0dXJuIHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSx0aGlzLnBvc2l0aW9uPXAuVHJhbnNmb3JtQ29vcmRpbmF0ZXMoZSx0aGlzLl9sb2NhbE1hdHJpeCksdGhpc31sb29rQXQoZSx0PTAsaT0wLHM9MCxyPVZ0LkxPQ0FMKXtjb25zdCBuPUouX0xvb2tBdFZlY3RvckNhY2hlLGE9cj09PVZ0LkxPQ0FMP3RoaXMucG9zaXRpb246dGhpcy5nZXRBYnNvbHV0ZVBvc2l0aW9uKCk7aWYoZS5zdWJ0cmFjdFRvUmVmKGEsbiksdGhpcy5zZXREaXJlY3Rpb24obix0LGkscykscj09PVZ0LldPUkxEJiZ0aGlzLnBhcmVudClpZih0aGlzLnJvdGF0aW9uUXVhdGVybmlvbil7Y29uc3Qgbz1ELk1hdHJpeFswXTt0aGlzLnJvdGF0aW9uUXVhdGVybmlvbi50b1JvdGF0aW9uTWF0cml4KG8pO2NvbnN0IGg9RC5NYXRyaXhbMV07dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKS5nZXRSb3RhdGlvbk1hdHJpeFRvUmVmKGgpLGguaW52ZXJ0KCksby5tdWx0aXBseVRvUmVmKGgsbyksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24uZnJvbVJvdGF0aW9uTWF0cml4KG8pfWVsc2V7Y29uc3Qgbz1ELlF1YXRlcm5pb25bMF07Wi5Gcm9tRXVsZXJWZWN0b3JUb1JlZih0aGlzLnJvdGF0aW9uLG8pO2NvbnN0IGg9RC5NYXRyaXhbMF07by50b1JvdGF0aW9uTWF0cml4KGgpO2NvbnN0IGw9RC5NYXRyaXhbMV07dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKS5nZXRSb3RhdGlvbk1hdHJpeFRvUmVmKGwpLGwuaW52ZXJ0KCksaC5tdWx0aXBseVRvUmVmKGwsaCksby5mcm9tUm90YXRpb25NYXRyaXgoaCksby50b0V1bGVyQW5nbGVzVG9SZWYodGhpcy5yb3RhdGlvbil9cmV0dXJuIHRoaXN9Z2V0RGlyZWN0aW9uKGUpe2NvbnN0IHQ9cC5aZXJvKCk7cmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uVG9SZWYoZSx0KSx0fWdldERpcmVjdGlvblRvUmVmKGUsdCl7cmV0dXJuIHAuVHJhbnNmb3JtTm9ybWFsVG9SZWYoZSx0aGlzLmdldFdvcmxkTWF0cml4KCksdCksdGhpc31zZXREaXJlY3Rpb24oZSx0PTAsaT0wLHM9MCl7Y29uc3Qgcj0tTWF0aC5hdGFuMihlLnosZS54KStNYXRoLlBJLzIsbj1NYXRoLnNxcnQoZS54KmUueCtlLnoqZS56KSxhPS1NYXRoLmF0YW4yKGUueSxuKTtyZXR1cm4gdGhpcy5yb3RhdGlvblF1YXRlcm5pb24/Wi5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKHIrdCxhK2kscyx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbik6KHRoaXMucm90YXRpb24ueD1hK2ksdGhpcy5yb3RhdGlvbi55PXIrdCx0aGlzLnJvdGF0aW9uLno9cyksdGhpc31zZXRQaXZvdFBvaW50KGUsdD1WdC5MT0NBTCl7dGhpcy5nZXRTY2VuZSgpLmdldFJlbmRlcklkKCk9PTAmJnRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKTtjb25zdCBpPXRoaXMuZ2V0V29ybGRNYXRyaXgoKTtpZih0PT1WdC5XT1JMRCl7Y29uc3Qgcz1ELk1hdHJpeFswXTtpLmludmVydFRvUmVmKHMpLGU9cC5UcmFuc2Zvcm1Db29yZGluYXRlcyhlLHMpfXJldHVybiB0aGlzLnNldFBpdm90TWF0cml4KHguVHJhbnNsYXRpb24oLWUueCwtZS55LC1lLnopLCEwKX1nZXRQaXZvdFBvaW50KCl7Y29uc3QgZT1wLlplcm8oKTtyZXR1cm4gdGhpcy5nZXRQaXZvdFBvaW50VG9SZWYoZSksZX1nZXRQaXZvdFBvaW50VG9SZWYoZSl7cmV0dXJuIGUueD0tdGhpcy5fcGl2b3RNYXRyaXgubVsxMl0sZS55PS10aGlzLl9waXZvdE1hdHJpeC5tWzEzXSxlLno9LXRoaXMuX3Bpdm90TWF0cml4Lm1bMTRdLHRoaXN9Z2V0QWJzb2x1dGVQaXZvdFBvaW50KCl7Y29uc3QgZT1wLlplcm8oKTtyZXR1cm4gdGhpcy5nZXRBYnNvbHV0ZVBpdm90UG9pbnRUb1JlZihlKSxlfWdldEFic29sdXRlUGl2b3RQb2ludFRvUmVmKGUpe3JldHVybiB0aGlzLmdldFBpdm90UG9pbnRUb1JlZihlKSxwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYoZSx0aGlzLmdldFdvcmxkTWF0cml4KCksZSksdGhpc31tYXJrQXNEaXJ0eShlKXtpZih0aGlzLl9pc0RpcnR5KXJldHVybiB0aGlzO2lmKHRoaXMuX2NoaWxkcmVuKWZvcihjb25zdCB0IG9mIHRoaXMuX2NoaWxkcmVuKXQubWFya0FzRGlydHkoZSk7cmV0dXJuIHN1cGVyLm1hcmtBc0RpcnR5KGUpfXNldFBhcmVudChlLHQ9ITEsaT0hMSl7aWYoIWUmJiF0aGlzLnBhcmVudClyZXR1cm4gdGhpcztjb25zdCBzPUQuUXVhdGVybmlvblswXSxyPUQuVmVjdG9yM1swXSxuPUQuVmVjdG9yM1sxXSxhPUQuTWF0cml4WzFdO3guSWRlbnRpdHlUb1JlZihhKTtjb25zdCBvPUQuTWF0cml4WzBdO3RoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKTtsZXQgaD10aGlzLnJvdGF0aW9uUXVhdGVybmlvbjtyZXR1cm4gaHx8KGg9Si5fVG1wUm90YXRpb24sWi5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKHRoaXMuX3JvdGF0aW9uLnksdGhpcy5fcm90YXRpb24ueCx0aGlzLl9yb3RhdGlvbi56LGgpKSx4LkNvbXBvc2VUb1JlZih0aGlzLnNjYWxpbmcsaCx0aGlzLnBvc2l0aW9uLG8pLHRoaXMucGFyZW50JiZvLm11bHRpcGx5VG9SZWYodGhpcy5wYXJlbnQuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSxvKSxlJiYoZS5jb21wdXRlV29ybGRNYXRyaXgoITApLmludmVydFRvUmVmKGEpLG8ubXVsdGlwbHlUb1JlZihhLG8pKSxvLmRlY29tcG9zZShuLHMscix0P3RoaXM6dm9pZCAwKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj90aGlzLnJvdGF0aW9uUXVhdGVybmlvbi5jb3B5RnJvbShzKTpzLnRvRXVsZXJBbmdsZXNUb1JlZih0aGlzLnJvdGF0aW9uKSx0aGlzLnNjYWxpbmcuY29weUZyb20obiksdGhpcy5wb3NpdGlvbi5jb3B5RnJvbShyKSx0aGlzLnBhcmVudD1lLGkmJnRoaXMuc2V0UGl2b3RNYXRyaXgoeC5JZGVudGl0eSgpKSx0aGlzfWdldCBub25Vbmlmb3JtU2NhbGluZygpe3JldHVybiB0aGlzLl9ub25Vbmlmb3JtU2NhbGluZ31fdXBkYXRlTm9uVW5pZm9ybVNjYWxpbmdTdGF0ZShlKXtyZXR1cm4gdGhpcy5fbm9uVW5pZm9ybVNjYWxpbmc9PT1lPyExOih0aGlzLl9ub25Vbmlmb3JtU2NhbGluZz1lLCEwKX1hdHRhY2hUb0JvbmUoZSx0KXtyZXR1cm4gdGhpcy5fY3VycmVudFBhcmVudFdoZW5BdHRhY2hpbmdUb0JvbmU9dGhpcy5wYXJlbnQsdGhpcy5fdHJhbnNmb3JtVG9Cb25lUmVmZXJhbD10LHRoaXMucGFyZW50PWUsZS5nZXRTa2VsZXRvbigpLnByZXBhcmUoKSxlLmdldFdvcmxkTWF0cml4KCkuZGV0ZXJtaW5hbnQoKTwwJiYodGhpcy5zY2FsaW5nRGV0ZXJtaW5hbnQqPS0xKSx0aGlzfWRldGFjaEZyb21Cb25lKGU9ITEpe3JldHVybiB0aGlzLnBhcmVudD8odGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKS5kZXRlcm1pbmFudCgpPDAmJih0aGlzLnNjYWxpbmdEZXRlcm1pbmFudCo9LTEpLHRoaXMuX3RyYW5zZm9ybVRvQm9uZVJlZmVyYWw9bnVsbCxlP3RoaXMucGFyZW50PXRoaXMuX2N1cnJlbnRQYXJlbnRXaGVuQXR0YWNoaW5nVG9Cb25lOnRoaXMucGFyZW50PW51bGwsdGhpcyk6KGUmJih0aGlzLnBhcmVudD10aGlzLl9jdXJyZW50UGFyZW50V2hlbkF0dGFjaGluZ1RvQm9uZSksdGhpcyl9cm90YXRlKGUsdCxpKXtlLm5vcm1hbGl6ZSgpLHRoaXMucm90YXRpb25RdWF0ZXJuaW9ufHwodGhpcy5yb3RhdGlvblF1YXRlcm5pb249dGhpcy5yb3RhdGlvbi50b1F1YXRlcm5pb24oKSx0aGlzLnJvdGF0aW9uLnNldEFsbCgwKSk7bGV0IHM7aWYoIWl8fGk9PT1WdC5MT0NBTClzPVouUm90YXRpb25BeGlzVG9SZWYoZSx0LEouX1JvdGF0aW9uQXhpc0NhY2hlKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbi5tdWx0aXBseVRvUmVmKHMsdGhpcy5yb3RhdGlvblF1YXRlcm5pb24pO2Vsc2V7aWYodGhpcy5wYXJlbnQpe2NvbnN0IHI9RC5NYXRyaXhbMF07dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKS5pbnZlcnRUb1JlZihyKSxlPXAuVHJhbnNmb3JtTm9ybWFsKGUscil9cz1aLlJvdGF0aW9uQXhpc1RvUmVmKGUsdCxKLl9Sb3RhdGlvbkF4aXNDYWNoZSkscy5tdWx0aXBseVRvUmVmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uKX1yZXR1cm4gdGhpc31yb3RhdGVBcm91bmQoZSx0LGkpe3Qubm9ybWFsaXplKCksdGhpcy5yb3RhdGlvblF1YXRlcm5pb258fCh0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj1aLlJvdGF0aW9uWWF3UGl0Y2hSb2xsKHRoaXMucm90YXRpb24ueSx0aGlzLnJvdGF0aW9uLngsdGhpcy5yb3RhdGlvbi56KSx0aGlzLnJvdGF0aW9uLnNldEFsbCgwKSk7Y29uc3Qgcz1ELlZlY3RvcjNbMF0scj1ELlZlY3RvcjNbMV0sbj1ELlZlY3RvcjNbMl0sYT1ELlF1YXRlcm5pb25bMF0sbz1ELk1hdHJpeFswXSxoPUQuTWF0cml4WzFdLGw9RC5NYXRyaXhbMl0sdT1ELk1hdHJpeFszXTtyZXR1cm4gZS5zdWJ0cmFjdFRvUmVmKHRoaXMucG9zaXRpb24scykseC5UcmFuc2xhdGlvblRvUmVmKHMueCxzLnkscy56LG8pLHguVHJhbnNsYXRpb25Ub1JlZigtcy54LC1zLnksLXMueixoKSx4LlJvdGF0aW9uQXhpc1RvUmVmKHQsaSxsKSxoLm11bHRpcGx5VG9SZWYobCx1KSx1Lm11bHRpcGx5VG9SZWYobyx1KSx1LmRlY29tcG9zZShyLGEsbiksdGhpcy5wb3NpdGlvbi5hZGRJblBsYWNlKG4pLGEubXVsdGlwbHlUb1JlZih0aGlzLnJvdGF0aW9uUXVhdGVybmlvbix0aGlzLnJvdGF0aW9uUXVhdGVybmlvbiksdGhpc310cmFuc2xhdGUoZSx0LGkpe2NvbnN0IHM9ZS5zY2FsZSh0KTtpZighaXx8aT09PVZ0LkxPQ0FMKXtjb25zdCByPXRoaXMuZ2V0UG9zaXRpb25FeHByZXNzZWRJbkxvY2FsU3BhY2UoKS5hZGQocyk7dGhpcy5zZXRQb3NpdGlvbldpdGhMb2NhbFZlY3RvcihyKX1lbHNlIHRoaXMuc2V0QWJzb2x1dGVQb3NpdGlvbih0aGlzLmdldEFic29sdXRlUG9zaXRpb24oKS5hZGQocykpO3JldHVybiB0aGlzfWFkZFJvdGF0aW9uKGUsdCxpKXtsZXQgczt0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj9zPXRoaXMucm90YXRpb25RdWF0ZXJuaW9uOihzPUQuUXVhdGVybmlvblsxXSxaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodGhpcy5yb3RhdGlvbi55LHRoaXMucm90YXRpb24ueCx0aGlzLnJvdGF0aW9uLnoscykpO2NvbnN0IHI9RC5RdWF0ZXJuaW9uWzBdO3JldHVybiBaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodCxlLGkscikscy5tdWx0aXBseUluUGxhY2UociksdGhpcy5yb3RhdGlvblF1YXRlcm5pb258fHMudG9FdWxlckFuZ2xlc1RvUmVmKHRoaXMucm90YXRpb24pLHRoaXN9X2dldEVmZmVjdGl2ZVBhcmVudCgpe3JldHVybiB0aGlzLnBhcmVudH1jb21wdXRlV29ybGRNYXRyaXgoZSl7aWYodGhpcy5faXNXb3JsZE1hdHJpeEZyb3plbiYmIXRoaXMuX2lzRGlydHkpcmV0dXJuIHRoaXMuX3dvcmxkTWF0cml4O2NvbnN0IHQ9dGhpcy5nZXRTY2VuZSgpLmdldFJlbmRlcklkKCk7aWYoIXRoaXMuX2lzRGlydHkmJiFlJiYodGhpcy5fY3VycmVudFJlbmRlcklkPT09dHx8dGhpcy5pc1N5bmNocm9uaXplZCgpKSlyZXR1cm4gdGhpcy5fY3VycmVudFJlbmRlcklkPXQsdGhpcy5fd29ybGRNYXRyaXg7Y29uc3QgaT10aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhLHM9KHRoaXMuX2JpbGxib2FyZE1vZGUmSi5CSUxMQk9BUkRNT0RFX1VTRV9QT1NJVElPTikhPT0wLHI9dGhpcy5fYmlsbGJvYXJkTW9kZSE9PUouQklMTEJPQVJETU9ERV9OT05FJiYhdGhpcy5wcmVzZXJ2ZVBhcmVudFJvdGF0aW9uRm9yQmlsbGJvYXJkO3RoaXMuX3VwZGF0ZUNhY2hlKCk7Y29uc3Qgbj10aGlzLl9jYWNoZTtuLnBpdm90TWF0cml4VXBkYXRlZD0hMSxuLmJpbGxib2FyZE1vZGU9dGhpcy5iaWxsYm9hcmRNb2RlLG4uaW5maW5pdGVEaXN0YW5jZT10aGlzLmluZmluaXRlRGlzdGFuY2Usbi5wYXJlbnQ9dGhpcy5fcGFyZW50Tm9kZSx0aGlzLl9jdXJyZW50UmVuZGVySWQ9dCx0aGlzLl9jaGlsZFVwZGF0ZUlkKz0xLHRoaXMuX2lzRGlydHk9ITEsdGhpcy5fcG9zaXRpb24uX2lzRGlydHk9ITEsdGhpcy5fcm90YXRpb24uX2lzRGlydHk9ITEsdGhpcy5fc2NhbGluZy5faXNEaXJ0eT0hMTtjb25zdCBhPXRoaXMuX2dldEVmZmVjdGl2ZVBhcmVudCgpLG89Si5fVG1wU2NhbGluZztsZXQgaD10aGlzLl9wb3NpdGlvbjtpZih0aGlzLl9pbmZpbml0ZURpc3RhbmNlJiYhdGhpcy5wYXJlbnQmJmkpe2NvbnN0IHU9aS5nZXRXb3JsZE1hdHJpeCgpLGQ9bmV3IHAodS5tWzEyXSx1Lm1bMTNdLHUubVsxNF0pO2g9Si5fVG1wVHJhbnNsYXRpb24saC5jb3B5RnJvbUZsb2F0cyh0aGlzLl9wb3NpdGlvbi54K2QueCx0aGlzLl9wb3NpdGlvbi55K2QueSx0aGlzLl9wb3NpdGlvbi56K2Queil9by5jb3B5RnJvbUZsb2F0cyh0aGlzLl9zY2FsaW5nLngqdGhpcy5zY2FsaW5nRGV0ZXJtaW5hbnQsdGhpcy5fc2NhbGluZy55KnRoaXMuc2NhbGluZ0RldGVybWluYW50LHRoaXMuX3NjYWxpbmcueip0aGlzLnNjYWxpbmdEZXRlcm1pbmFudCk7bGV0IGw7aWYodGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uPyh0aGlzLl9yb3RhdGlvblF1YXRlcm5pb24uX2lzRGlydHk9ITEsbD10aGlzLl9yb3RhdGlvblF1YXRlcm5pb24sdGhpcy5yZUludGVncmF0ZVJvdGF0aW9uSW50b1JvdGF0aW9uUXVhdGVybmlvbiYmdGhpcy5yb3RhdGlvbi5sZW5ndGhTcXVhcmVkKCkmJih0aGlzLl9yb3RhdGlvblF1YXRlcm5pb24ubXVsdGlwbHlJblBsYWNlKFouUm90YXRpb25ZYXdQaXRjaFJvbGwodGhpcy5fcm90YXRpb24ueSx0aGlzLl9yb3RhdGlvbi54LHRoaXMuX3JvdGF0aW9uLnopKSx0aGlzLl9yb3RhdGlvbi5jb3B5RnJvbUZsb2F0cygwLDAsMCkpKToobD1KLl9UbXBSb3RhdGlvbixaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodGhpcy5fcm90YXRpb24ueSx0aGlzLl9yb3RhdGlvbi54LHRoaXMuX3JvdGF0aW9uLnosbCkpLHRoaXMuX3VzZVBpdm90TWF0cml4KXtjb25zdCB1PUQuTWF0cml4WzFdO3guU2NhbGluZ1RvUmVmKG8ueCxvLnksby56LHUpO2NvbnN0IGQ9RC5NYXRyaXhbMF07bC50b1JvdGF0aW9uTWF0cml4KGQpLHRoaXMuX3Bpdm90TWF0cml4Lm11bHRpcGx5VG9SZWYodSxELk1hdHJpeFs0XSksRC5NYXRyaXhbNF0ubXVsdGlwbHlUb1JlZihkLHRoaXMuX2xvY2FsTWF0cml4KSx0aGlzLl9wb3N0TXVsdGlwbHlQaXZvdE1hdHJpeCYmdGhpcy5fbG9jYWxNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLl9waXZvdE1hdHJpeEludmVyc2UsdGhpcy5fbG9jYWxNYXRyaXgpLHRoaXMuX2xvY2FsTWF0cml4LmFkZFRyYW5zbGF0aW9uRnJvbUZsb2F0cyhoLngsaC55LGgueil9ZWxzZSB4LkNvbXBvc2VUb1JlZihvLGwsaCx0aGlzLl9sb2NhbE1hdHJpeCk7aWYoYSYmYS5nZXRXb3JsZE1hdHJpeCl7aWYoZSYmYS5jb21wdXRlV29ybGRNYXRyaXgoZSkscil7dGhpcy5fdHJhbnNmb3JtVG9Cb25lUmVmZXJhbD9hLmdldFdvcmxkTWF0cml4KCkubXVsdGlwbHlUb1JlZih0aGlzLl90cmFuc2Zvcm1Ub0JvbmVSZWZlcmFsLmdldFdvcmxkTWF0cml4KCksRC5NYXRyaXhbN10pOkQuTWF0cml4WzddLmNvcHlGcm9tKGEuZ2V0V29ybGRNYXRyaXgoKSk7Y29uc3QgdT1ELlZlY3RvcjNbNV0sZD1ELlZlY3RvcjNbNl0sZj1ELlF1YXRlcm5pb25bMF07RC5NYXRyaXhbN10uZGVjb21wb3NlKGQsZix1KSx4LlNjYWxpbmdUb1JlZihkLngsZC55LGQueixELk1hdHJpeFs3XSksRC5NYXRyaXhbN10uc2V0VHJhbnNsYXRpb24odSksSi5CaWxsYm9hcmRVc2VQYXJlbnRPcmllbnRhdGlvbiYmKHRoaXMuX3Bvc2l0aW9uLmFwcGx5Um90YXRpb25RdWF0ZXJuaW9uVG9SZWYoZix1KSx0aGlzLl9sb2NhbE1hdHJpeC5zZXRUcmFuc2xhdGlvbih1KSksdGhpcy5fbG9jYWxNYXRyaXgubXVsdGlwbHlUb1JlZihELk1hdHJpeFs3XSx0aGlzLl93b3JsZE1hdHJpeCl9ZWxzZSB0aGlzLl90cmFuc2Zvcm1Ub0JvbmVSZWZlcmFsPyh0aGlzLl9sb2NhbE1hdHJpeC5tdWx0aXBseVRvUmVmKGEuZ2V0V29ybGRNYXRyaXgoKSxELk1hdHJpeFs2XSksRC5NYXRyaXhbNl0ubXVsdGlwbHlUb1JlZih0aGlzLl90cmFuc2Zvcm1Ub0JvbmVSZWZlcmFsLmdldFdvcmxkTWF0cml4KCksdGhpcy5fd29ybGRNYXRyaXgpKTp0aGlzLl9sb2NhbE1hdHJpeC5tdWx0aXBseVRvUmVmKGEuZ2V0V29ybGRNYXRyaXgoKSx0aGlzLl93b3JsZE1hdHJpeCk7dGhpcy5fbWFya1N5bmNlZFdpdGhQYXJlbnQoKX1lbHNlIHRoaXMuX3dvcmxkTWF0cml4LmNvcHlGcm9tKHRoaXMuX2xvY2FsTWF0cml4KTtpZihyJiZpJiZ0aGlzLmJpbGxib2FyZE1vZGUmJiFzKXtjb25zdCB1PUQuVmVjdG9yM1swXTtpZih0aGlzLl93b3JsZE1hdHJpeC5nZXRUcmFuc2xhdGlvblRvUmVmKHUpLEQuTWF0cml4WzFdLmNvcHlGcm9tKGkuZ2V0Vmlld01hdHJpeCgpKSxELk1hdHJpeFsxXS5zZXRUcmFuc2xhdGlvbkZyb21GbG9hdHMoMCwwLDApLEQuTWF0cml4WzFdLmludmVydFRvUmVmKEQuTWF0cml4WzBdKSwodGhpcy5iaWxsYm9hcmRNb2RlJkouQklMTEJPQVJETU9ERV9BTEwpIT09Si5CSUxMQk9BUkRNT0RFX0FMTCl7RC5NYXRyaXhbMF0uZGVjb21wb3NlKHZvaWQgMCxELlF1YXRlcm5pb25bMF0sdm9pZCAwKTtjb25zdCBkPUQuVmVjdG9yM1sxXTtELlF1YXRlcm5pb25bMF0udG9FdWxlckFuZ2xlc1RvUmVmKGQpLCh0aGlzLmJpbGxib2FyZE1vZGUmSi5CSUxMQk9BUkRNT0RFX1gpIT09Si5CSUxMQk9BUkRNT0RFX1gmJihkLng9MCksKHRoaXMuYmlsbGJvYXJkTW9kZSZKLkJJTExCT0FSRE1PREVfWSkhPT1KLkJJTExCT0FSRE1PREVfWSYmKGQueT0wKSwodGhpcy5iaWxsYm9hcmRNb2RlJkouQklMTEJPQVJETU9ERV9aKSE9PUouQklMTEJPQVJETU9ERV9aJiYoZC56PTApLHguUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZihkLnksZC54LGQueixELk1hdHJpeFswXSl9dGhpcy5fd29ybGRNYXRyaXguc2V0VHJhbnNsYXRpb25Gcm9tRmxvYXRzKDAsMCwwKSx0aGlzLl93b3JsZE1hdHJpeC5tdWx0aXBseVRvUmVmKEQuTWF0cml4WzBdLHRoaXMuX3dvcmxkTWF0cml4KSx0aGlzLl93b3JsZE1hdHJpeC5zZXRUcmFuc2xhdGlvbihELlZlY3RvcjNbMF0pfWVsc2UgaWYociYmaSYmdGhpcy5iaWxsYm9hcmRNb2RlJiZzKXtjb25zdCB1PUQuVmVjdG9yM1swXTt0aGlzLl93b3JsZE1hdHJpeC5nZXRUcmFuc2xhdGlvblRvUmVmKHUpO2NvbnN0IGQ9aS5nbG9iYWxQb3NpdGlvbjt0aGlzLl93b3JsZE1hdHJpeC5pbnZlcnRUb1JlZihELk1hdHJpeFsxXSk7Y29uc3QgZj1ELlZlY3RvcjNbMV07cC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGQsRC5NYXRyaXhbMV0sZiksZi5ub3JtYWxpemUoKTtjb25zdCBfPS1NYXRoLmF0YW4yKGYueixmLngpK01hdGguUEkvMixFPU1hdGguc3FydChmLngqZi54K2YueipmLnopLG09LU1hdGguYXRhbjIoZi55LEUpO2lmKFouUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZihfLG0sMCxELlF1YXRlcm5pb25bMF0pLCh0aGlzLmJpbGxib2FyZE1vZGUmSi5CSUxMQk9BUkRNT0RFX0FMTCkhPT1KLkJJTExCT0FSRE1PREVfQUxMKXtjb25zdCB2PUQuVmVjdG9yM1sxXTtELlF1YXRlcm5pb25bMF0udG9FdWxlckFuZ2xlc1RvUmVmKHYpLCh0aGlzLmJpbGxib2FyZE1vZGUmSi5CSUxMQk9BUkRNT0RFX1gpIT09Si5CSUxMQk9BUkRNT0RFX1gmJih2Lng9MCksKHRoaXMuYmlsbGJvYXJkTW9kZSZKLkJJTExCT0FSRE1PREVfWSkhPT1KLkJJTExCT0FSRE1PREVfWSYmKHYueT0wKSwodGhpcy5iaWxsYm9hcmRNb2RlJkouQklMTEJPQVJETU9ERV9aKSE9PUouQklMTEJPQVJETU9ERV9aJiYodi56PTApLHguUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZih2Lnksdi54LHYueixELk1hdHJpeFswXSl9ZWxzZSB4LkZyb21RdWF0ZXJuaW9uVG9SZWYoRC5RdWF0ZXJuaW9uWzBdLEQuTWF0cml4WzBdKTt0aGlzLl93b3JsZE1hdHJpeC5zZXRUcmFuc2xhdGlvbkZyb21GbG9hdHMoMCwwLDApLHRoaXMuX3dvcmxkTWF0cml4Lm11bHRpcGx5VG9SZWYoRC5NYXRyaXhbMF0sdGhpcy5fd29ybGRNYXRyaXgpLHRoaXMuX3dvcmxkTWF0cml4LnNldFRyYW5zbGF0aW9uKEQuVmVjdG9yM1swXSl9cmV0dXJuIHRoaXMuaWdub3JlTm9uVW5pZm9ybVNjYWxpbmc/dGhpcy5fdXBkYXRlTm9uVW5pZm9ybVNjYWxpbmdTdGF0ZSghMSk6dGhpcy5fc2NhbGluZy5pc05vblVuaWZvcm1XaXRoaW5FcHNpbG9uKDFlLTYpP3RoaXMuX3VwZGF0ZU5vblVuaWZvcm1TY2FsaW5nU3RhdGUoITApOmEmJmEuX25vblVuaWZvcm1TY2FsaW5nP3RoaXMuX3VwZGF0ZU5vblVuaWZvcm1TY2FsaW5nU3RhdGUoYS5fbm9uVW5pZm9ybVNjYWxpbmcpOnRoaXMuX3VwZGF0ZU5vblVuaWZvcm1TY2FsaW5nU3RhdGUoITEpLHRoaXMuX2FmdGVyQ29tcHV0ZVdvcmxkTWF0cml4KCksdGhpcy5fYWJzb2x1dGVQb3NpdGlvbi5jb3B5RnJvbUZsb2F0cyh0aGlzLl93b3JsZE1hdHJpeC5tWzEyXSx0aGlzLl93b3JsZE1hdHJpeC5tWzEzXSx0aGlzLl93b3JsZE1hdHJpeC5tWzE0XSksdGhpcy5faXNBYnNvbHV0ZVN5bmNlZD0hMSx0aGlzLm9uQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX3Bvc2VNYXRyaXh8fCh0aGlzLl9wb3NlTWF0cml4PXguSW52ZXJ0KHRoaXMuX3dvcmxkTWF0cml4KSksdGhpcy5fd29ybGRNYXRyaXhEZXRlcm1pbmFudElzRGlydHk9ITAsdGhpcy5fd29ybGRNYXRyaXh9cmVzZXRMb2NhbE1hdHJpeChlPSEwKXtpZih0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCgpLGUpe2NvbnN0IHQ9dGhpcy5nZXRDaGlsZHJlbigpO2ZvcihsZXQgaT0wO2k8dC5sZW5ndGg7KytpKXtjb25zdCBzPXRbaV07aWYocyl7cy5jb21wdXRlV29ybGRNYXRyaXgoKTtjb25zdCByPUQuTWF0cml4WzBdO3MuX2xvY2FsTWF0cml4Lm11bHRpcGx5VG9SZWYodGhpcy5fbG9jYWxNYXRyaXgscik7Y29uc3Qgbj1ELlF1YXRlcm5pb25bMF07ci5kZWNvbXBvc2Uocy5zY2FsaW5nLG4scy5wb3NpdGlvbikscy5yb3RhdGlvblF1YXRlcm5pb24/cy5yb3RhdGlvblF1YXRlcm5pb24uY29weUZyb20obik6bi50b0V1bGVyQW5nbGVzVG9SZWYocy5yb3RhdGlvbil9fX10aGlzLnNjYWxpbmcuY29weUZyb21GbG9hdHMoMSwxLDEpLHRoaXMucG9zaXRpb24uY29weUZyb21GbG9hdHMoMCwwLDApLHRoaXMucm90YXRpb24uY29weUZyb21GbG9hdHMoMCwwLDApLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uJiYodGhpcy5yb3RhdGlvblF1YXRlcm5pb249Wi5JZGVudGl0eSgpKSx0aGlzLl93b3JsZE1hdHJpeD14LklkZW50aXR5KCl9X2FmdGVyQ29tcHV0ZVdvcmxkTWF0cml4KCl7fXJlZ2lzdGVyQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZShlKXtyZXR1cm4gdGhpcy5vbkFmdGVyV29ybGRNYXRyaXhVcGRhdGVPYnNlcnZhYmxlLmFkZChlKSx0aGlzfXVucmVnaXN0ZXJBZnRlcldvcmxkTWF0cml4VXBkYXRlKGUpe3JldHVybiB0aGlzLm9uQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZU9ic2VydmFibGUucmVtb3ZlQ2FsbGJhY2soZSksdGhpc31nZXRQb3NpdGlvbkluQ2FtZXJhU3BhY2UoZT1udWxsKXtyZXR1cm4gZXx8KGU9dGhpcy5nZXRTY2VuZSgpLmFjdGl2ZUNhbWVyYSkscC5UcmFuc2Zvcm1Db29yZGluYXRlcyh0aGlzLmdldEFic29sdXRlUG9zaXRpb24oKSxlLmdldFZpZXdNYXRyaXgoKSl9Z2V0RGlzdGFuY2VUb0NhbWVyYShlPW51bGwpe3JldHVybiBlfHwoZT10aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhKSx0aGlzLmdldEFic29sdXRlUG9zaXRpb24oKS5zdWJ0cmFjdChlLmdsb2JhbFBvc2l0aW9uKS5sZW5ndGgoKX1jbG9uZShlLHQsaSl7Y29uc3Qgcz1hZS5DbG9uZSgoKT0+bmV3IEooZSx0aGlzLmdldFNjZW5lKCkpLHRoaXMpO2lmKHMubmFtZT1lLHMuaWQ9ZSx0JiYocy5wYXJlbnQ9dCksIWkpe2NvbnN0IHI9dGhpcy5nZXREZXNjZW5kYW50cyghMCk7Zm9yKGxldCBuPTA7bjxyLmxlbmd0aDtuKyspe2NvbnN0IGE9cltuXTthLmNsb25lJiZhLmNsb25lKGUrIi4iK2EubmFtZSxzKX19cmV0dXJuIHN9c2VyaWFsaXplKGUpe2NvbnN0IHQ9YWUuU2VyaWFsaXplKHRoaXMsZSk7cmV0dXJuIHQudHlwZT10aGlzLmdldENsYXNzTmFtZSgpLHQudW5pcXVlSWQ9dGhpcy51bmlxdWVJZCx0aGlzLnBhcmVudCYmdGhpcy5wYXJlbnQuX3NlcmlhbGl6ZUFzUGFyZW50KHQpLHQubG9jYWxNYXRyaXg9dGhpcy5nZXRQaXZvdE1hdHJpeCgpLmFzQXJyYXkoKSx0LmlzRW5hYmxlZD10aGlzLmlzRW5hYmxlZCgpLHR9c3RhdGljIFBhcnNlKGUsdCxpKXtjb25zdCBzPWFlLlBhcnNlKCgpPT5uZXcgSihlLm5hbWUsdCksZSx0LGkpO3JldHVybiBlLmxvY2FsTWF0cml4P3Muc2V0UHJlVHJhbnNmb3JtTWF0cml4KHguRnJvbUFycmF5KGUubG9jYWxNYXRyaXgpKTplLnBpdm90TWF0cml4JiZzLnNldFBpdm90TWF0cml4KHguRnJvbUFycmF5KGUucGl2b3RNYXRyaXgpKSxzLnNldEVuYWJsZWQoZS5pc0VuYWJsZWQpLHMuX3dhaXRpbmdQYXJzZWRVbmlxdWVJZD1lLnVuaXF1ZUlkLGUucGFyZW50SWQhPT12b2lkIDAmJihzLl93YWl0aW5nUGFyZW50SWQ9ZS5wYXJlbnRJZCksZS5wYXJlbnRJbnN0YW5jZUluZGV4IT09dm9pZCAwJiYocy5fd2FpdGluZ1BhcmVudEluc3RhbmNlSW5kZXg9ZS5wYXJlbnRJbnN0YW5jZUluZGV4KSxzfWdldENoaWxkVHJhbnNmb3JtTm9kZXMoZSx0KXtjb25zdCBpPVtdO3JldHVybiB0aGlzLl9nZXREZXNjZW5kYW50cyhpLGUscz0+KCF0fHx0KHMpKSYmcyBpbnN0YW5jZW9mIEopLGl9ZGlzcG9zZShlLHQ9ITEpe2lmKHRoaXMuZ2V0U2NlbmUoKS5zdG9wQW5pbWF0aW9uKHRoaXMpLHRoaXMuZ2V0U2NlbmUoKS5yZW1vdmVUcmFuc2Zvcm1Ob2RlKHRoaXMpLHRoaXMuX3BhcmVudENvbnRhaW5lcil7Y29uc3QgaT10aGlzLl9wYXJlbnRDb250YWluZXIudHJhbnNmb3JtTm9kZXMuaW5kZXhPZih0aGlzKTtpPi0xJiZ0aGlzLl9wYXJlbnRDb250YWluZXIudHJhbnNmb3JtTm9kZXMuc3BsaWNlKGksMSksdGhpcy5fcGFyZW50Q29udGFpbmVyPW51bGx9aWYodGhpcy5vbkFmdGVyV29ybGRNYXRyaXhVcGRhdGVPYnNlcnZhYmxlLmNsZWFyKCksZSl7Y29uc3QgaT10aGlzLmdldENoaWxkVHJhbnNmb3JtTm9kZXMoITApO2Zvcihjb25zdCBzIG9mIGkpcy5wYXJlbnQ9bnVsbCxzLmNvbXB1dGVXb3JsZE1hdHJpeCghMCl9c3VwZXIuZGlzcG9zZShlLHQpfW5vcm1hbGl6ZVRvVW5pdEN1YmUoZT0hMCx0PSExLGkpe2xldCBzPW51bGwscj1udWxsO3QmJih0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj8ocj10aGlzLnJvdGF0aW9uUXVhdGVybmlvbi5jbG9uZSgpLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uLmNvcHlGcm9tRmxvYXRzKDAsMCwwLDEpKTp0aGlzLnJvdGF0aW9uJiYocz10aGlzLnJvdGF0aW9uLmNsb25lKCksdGhpcy5yb3RhdGlvbi5jb3B5RnJvbUZsb2F0cygwLDAsMCkpKTtjb25zdCBuPXRoaXMuZ2V0SGllcmFyY2h5Qm91bmRpbmdWZWN0b3JzKGUsaSksYT1uLm1heC5zdWJ0cmFjdChuLm1pbiksbz1NYXRoLm1heChhLngsYS55LGEueik7aWYobz09PTApcmV0dXJuIHRoaXM7Y29uc3QgaD0xL287cmV0dXJuIHRoaXMuc2NhbGluZy5zY2FsZUluUGxhY2UoaCksdCYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uJiZyP3RoaXMucm90YXRpb25RdWF0ZXJuaW9uLmNvcHlGcm9tKHIpOnRoaXMucm90YXRpb24mJnMmJnRoaXMucm90YXRpb24uY29weUZyb20ocykpLHRoaXN9X3N5bmNBYnNvbHV0ZVNjYWxpbmdBbmRSb3RhdGlvbigpe3RoaXMuX2lzQWJzb2x1dGVTeW5jZWR8fCh0aGlzLl93b3JsZE1hdHJpeC5kZWNvbXBvc2UodGhpcy5fYWJzb2x1dGVTY2FsaW5nLHRoaXMuX2Fic29sdXRlUm90YXRpb25RdWF0ZXJuaW9uKSx0aGlzLl9pc0Fic29sdXRlU3luY2VkPSEwKX19Si5CSUxMQk9BUkRNT0RFX05PTkU9MCxKLkJJTExCT0FSRE1PREVfWD0xLEouQklMTEJPQVJETU9ERV9ZPTIsSi5CSUxMQk9BUkRNT0RFX1o9NCxKLkJJTExCT0FSRE1PREVfQUxMPTcsSi5CSUxMQk9BUkRNT0RFX1VTRV9QT1NJVElPTj0xMjgsSi5CaWxsYm9hcmRVc2VQYXJlbnRPcmllbnRhdGlvbj0hMSxKLl9UbXBSb3RhdGlvbj1aLlplcm8oKSxKLl9UbXBTY2FsaW5nPXAuWmVybygpLEouX1RtcFRyYW5zbGF0aW9uPXAuWmVybygpLEouX0xvb2tBdFZlY3RvckNhY2hlPW5ldyBwKDAsMCwwKSxKLl9Sb3RhdGlvbkF4aXNDYWNoZT1uZXcgWixUKFtCdCgicG9zaXRpb24iKV0sSi5wcm90b3R5cGUsIl9wb3NpdGlvbiIsdm9pZCAwKSxUKFtCdCgicm90YXRpb24iKV0sSi5wcm90b3R5cGUsIl9yb3RhdGlvbiIsdm9pZCAwKSxUKFtSbigicm90YXRpb25RdWF0ZXJuaW9uIildLEoucHJvdG90eXBlLCJfcm90YXRpb25RdWF0ZXJuaW9uIix2b2lkIDApLFQoW0J0KCJzY2FsaW5nIildLEoucHJvdG90eXBlLCJfc2NhbGluZyIsdm9pZCAwKSxUKFtSKCJiaWxsYm9hcmRNb2RlIildLEoucHJvdG90eXBlLCJfYmlsbGJvYXJkTW9kZSIsdm9pZCAwKSxUKFtSKCldLEoucHJvdG90eXBlLCJzY2FsaW5nRGV0ZXJtaW5hbnQiLHZvaWQgMCksVChbUigiaW5maW5pdGVEaXN0YW5jZSIpXSxKLnByb3RvdHlwZSwiX2luZmluaXRlRGlzdGFuY2UiLHZvaWQgMCksVChbUigpXSxKLnByb3RvdHlwZSwiaWdub3JlTm9uVW5pZm9ybVNjYWxpbmciLHZvaWQgMCksVChbUigpXSxKLnByb3RvdHlwZSwicmVJbnRlZ3JhdGVSb3RhdGlvbkludG9Sb3RhdGlvblF1YXRlcm5pb24iLHZvaWQgMCk7Y2xhc3MgVW57Y29uc3RydWN0b3IoKXt0aGlzLl9jaGVja0NvbGxpc2lvbnM9ITEsdGhpcy5fY29sbGlzaW9uTWFzaz0tMSx0aGlzLl9jb2xsaXNpb25Hcm91cD0tMSx0aGlzLl9zdXJyb3VuZGluZ01lc2hlcz1udWxsLHRoaXMuX2NvbGxpZGVyPW51bGwsdGhpcy5fb2xkUG9zaXRpb25Gb3JDb2xsaXNpb25zPW5ldyBwKDAsMCwwKSx0aGlzLl9kaWZmUG9zaXRpb25Gb3JDb2xsaXNpb25zPW5ldyBwKDAsMCwwKSx0aGlzLl9jb2xsaXNpb25SZXNwb25zZT0hMH19Y2xhc3Mga257Y29uc3RydWN0b3IoKXt0aGlzLmZhY2V0TmI9MCx0aGlzLnBhcnRpdGlvbmluZ1N1YmRpdmlzaW9ucz0xMCx0aGlzLnBhcnRpdGlvbmluZ0JCb3hSYXRpbz0xLjAxLHRoaXMuZmFjZXREYXRhRW5hYmxlZD0hMSx0aGlzLmZhY2V0UGFyYW1ldGVycz17fSx0aGlzLmJiU2l6ZT1wLlplcm8oKSx0aGlzLnN1YkRpdj17bWF4OjEsWDoxLFk6MSxaOjF9LHRoaXMuZmFjZXREZXB0aFNvcnQ9ITEsdGhpcy5mYWNldERlcHRoU29ydEVuYWJsZWQ9ITF9fWNsYXNzIFZue2NvbnN0cnVjdG9yKCl7dGhpcy5faGFzVmVydGV4QWxwaGE9ITEsdGhpcy5fdXNlVmVydGV4Q29sb3JzPSEwLHRoaXMuX251bUJvbmVJbmZsdWVuY2Vycz00LHRoaXMuX2FwcGx5Rm9nPSEwLHRoaXMuX3JlY2VpdmVTaGFkb3dzPSExLHRoaXMuX2ZhY2V0RGF0YT1uZXcga24sdGhpcy5fdmlzaWJpbGl0eT0xLHRoaXMuX3NrZWxldG9uPW51bGwsdGhpcy5fbGF5ZXJNYXNrPTI2ODQzNTQ1NSx0aGlzLl9jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnM9ITAsdGhpcy5faXNBY3RpdmU9ITEsdGhpcy5fb25seUZvckluc3RhbmNlcz0hMSx0aGlzLl9pc0FjdGl2ZUludGVybWVkaWF0ZT0hMSx0aGlzLl9vbmx5Rm9ySW5zdGFuY2VzSW50ZXJtZWRpYXRlPSExLHRoaXMuX2FjdEFzUmVndWxhck1lc2g9ITEsdGhpcy5fY3VycmVudExPRD1udWxsLHRoaXMuX2N1cnJlbnRMT0RJc1VwVG9EYXRlPSExLHRoaXMuX2NvbGxpc2lvblJldHJ5Q291bnQ9Myx0aGlzLl9tb3JwaFRhcmdldE1hbmFnZXI9bnVsbCx0aGlzLl9yZW5kZXJpbmdHcm91cElkPTAsdGhpcy5fYmFrZWRWZXJ0ZXhBbmltYXRpb25NYW5hZ2VyPW51bGwsdGhpcy5fbWF0ZXJpYWw9bnVsbCx0aGlzLl9wb3NpdGlvbnM9bnVsbCx0aGlzLl9wb2ludGVyT3ZlckRpc2FibGVNZXNoVGVzdGluZz0hMSx0aGlzLl9tZXNoQ29sbGlzaW9uRGF0YT1uZXcgVW4sdGhpcy5fZW5hYmxlRGlzdGFudFBpY2tpbmc9ITF9fWNsYXNzIG90IGV4dGVuZHMgSntjb25zdHJ1Y3RvcihlLHQ9bnVsbCl7c3dpdGNoKHN1cGVyKGUsdCwhMSksdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mbz1uZXcgVm4sdGhpcy5fd2FpdGluZ01hdGVyaWFsSWQ9bnVsbCx0aGlzLmN1bGxpbmdTdHJhdGVneT1vdC5DVUxMSU5HU1RSQVRFR1lfQk9VTkRJTkdTUEhFUkVfT05MWSx0aGlzLm9uQ29sbGlkZU9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTWF0ZXJpYWxDaGFuZ2VkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLmRlZmluZWRGYWNpbmdGb3J3YXJkPSEwLHRoaXMuX29jY2x1c2lvblF1ZXJ5PW51bGwsdGhpcy5fcmVuZGVyaW5nR3JvdXA9bnVsbCx0aGlzLmFscGhhSW5kZXg9TnVtYmVyLk1BWF9WQUxVRSx0aGlzLmlzVmlzaWJsZT0hMCx0aGlzLmlzUGlja2FibGU9ITAsdGhpcy5pc05lYXJQaWNrYWJsZT0hMSx0aGlzLmlzTmVhckdyYWJiYWJsZT0hMSx0aGlzLnNob3dTdWJNZXNoZXNCb3VuZGluZ0JveD0hMSx0aGlzLmlzQmxvY2tlcj0hMSx0aGlzLmVuYWJsZVBvaW50ZXJNb3ZlRXZlbnRzPSExLHRoaXMub3V0bGluZUNvbG9yPXJlLlJlZCgpLHRoaXMub3V0bGluZVdpZHRoPS4wMix0aGlzLm92ZXJsYXlDb2xvcj1yZS5SZWQoKSx0aGlzLm92ZXJsYXlBbHBoYT0uNSx0aGlzLnVzZU9jdHJlZUZvclJlbmRlcmluZ1NlbGVjdGlvbj0hMCx0aGlzLnVzZU9jdHJlZUZvclBpY2tpbmc9ITAsdGhpcy51c2VPY3RyZWVGb3JDb2xsaXNpb25zPSEwLHRoaXMuYWx3YXlzU2VsZWN0QXNBY3RpdmVNZXNoPSExLHRoaXMuZG9Ob3RTeW5jQm91bmRpbmdJbmZvPSExLHRoaXMuYWN0aW9uTWFuYWdlcj1udWxsLHRoaXMuZWxsaXBzb2lkPW5ldyBwKC41LDEsLjUpLHRoaXMuZWxsaXBzb2lkT2Zmc2V0PW5ldyBwKDAsMCwwKSx0aGlzLmVkZ2VzV2lkdGg9MSx0aGlzLmVkZ2VzQ29sb3I9bmV3IG1lKDEsMCwwLDEpLHRoaXMuX2VkZ2VzUmVuZGVyZXI9bnVsbCx0aGlzLl9tYXN0ZXJNZXNoPW51bGwsdGhpcy5fYm91bmRpbmdJbmZvPW51bGwsdGhpcy5fYm91bmRpbmdJbmZvSXNEaXJ0eT0hMCx0aGlzLl9yZW5kZXJJZD0wLHRoaXMuX2ludGVyc2VjdGlvbnNJblByb2dyZXNzPW5ldyBBcnJheSx0aGlzLl91bkluZGV4ZWQ9ITEsdGhpcy5fbGlnaHRTb3VyY2VzPW5ldyBBcnJheSx0aGlzLl93YWl0aW5nRGF0YT17bG9kczpudWxsLGFjdGlvbnM6bnVsbCxmcmVlemVXb3JsZE1hdHJpeDpudWxsfSx0aGlzLl9ib25lc1RyYW5zZm9ybU1hdHJpY2VzPW51bGwsdGhpcy5fdHJhbnNmb3JtTWF0cml4VGV4dHVyZT1udWxsLHRoaXMub25SZWJ1aWxkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlPShpLHMscj1udWxsKT0+e3Muc3VidHJhY3RUb1JlZih0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fb2xkUG9zaXRpb25Gb3JDb2xsaXNpb25zLHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9kaWZmUG9zaXRpb25Gb3JDb2xsaXNpb25zKSx0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fZGlmZlBvc2l0aW9uRm9yQ29sbGlzaW9ucy5sZW5ndGgoKT5JLkNvbGxpc2lvbnNFcHNpbG9uJiZ0aGlzLnBvc2l0aW9uLmFkZEluUGxhY2UodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX2RpZmZQb3NpdGlvbkZvckNvbGxpc2lvbnMpLHImJnRoaXMub25Db2xsaWRlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMociksdGhpcy5vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcy5wb3NpdGlvbil9LHQ9dGhpcy5nZXRTY2VuZSgpLHQuYWRkTWVzaCh0aGlzKSx0aGlzLl9yZXN5bmNMaWdodFNvdXJjZXMoKSx0aGlzLl91bmlmb3JtQnVmZmVyPW5ldyBWKHRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKSx2b2lkIDAsdm9pZCAwLGUsIXRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5pc1dlYkdQVSksdGhpcy5fYnVpbGRVbmlmb3JtTGF5b3V0KCksdC5wZXJmb3JtYW5jZVByaW9yaXR5KXtjYXNlIEN0LkFnZ3Jlc3NpdmU6dGhpcy5kb05vdFN5bmNCb3VuZGluZ0luZm89ITA7Y2FzZSBDdC5JbnRlcm1lZGlhdGU6dGhpcy5hbHdheXNTZWxlY3RBc0FjdGl2ZU1lc2g9ITAsdGhpcy5pc1BpY2thYmxlPSExO2JyZWFrfX1zdGF0aWMgZ2V0IEJJTExCT0FSRE1PREVfTk9ORSgpe3JldHVybiBKLkJJTExCT0FSRE1PREVfTk9ORX1zdGF0aWMgZ2V0IEJJTExCT0FSRE1PREVfWCgpe3JldHVybiBKLkJJTExCT0FSRE1PREVfWH1zdGF0aWMgZ2V0IEJJTExCT0FSRE1PREVfWSgpe3JldHVybiBKLkJJTExCT0FSRE1PREVfWX1zdGF0aWMgZ2V0IEJJTExCT0FSRE1PREVfWigpe3JldHVybiBKLkJJTExCT0FSRE1PREVfWn1zdGF0aWMgZ2V0IEJJTExCT0FSRE1PREVfQUxMKCl7cmV0dXJuIEouQklMTEJPQVJETU9ERV9BTEx9c3RhdGljIGdldCBCSUxMQk9BUkRNT0RFX1VTRV9QT1NJVElPTigpe3JldHVybiBKLkJJTExCT0FSRE1PREVfVVNFX1BPU0lUSU9OfWdldCBmYWNldE5iKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5mYWNldE5ifWdldCBwYXJ0aXRpb25pbmdTdWJkaXZpc2lvbnMoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZmFjZXREYXRhLnBhcnRpdGlvbmluZ1N1YmRpdmlzaW9uc31zZXQgcGFydGl0aW9uaW5nU3ViZGl2aXNpb25zKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5wYXJ0aXRpb25pbmdTdWJkaXZpc2lvbnM9ZX1nZXQgcGFydGl0aW9uaW5nQkJveFJhdGlvKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5wYXJ0aXRpb25pbmdCQm94UmF0aW99c2V0IHBhcnRpdGlvbmluZ0JCb3hSYXRpbyhlKXt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9mYWNldERhdGEucGFydGl0aW9uaW5nQkJveFJhdGlvPWV9Z2V0IG11c3REZXB0aFNvcnRGYWNldHMoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZmFjZXREYXRhLmZhY2V0RGVwdGhTb3J0fXNldCBtdXN0RGVwdGhTb3J0RmFjZXRzKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5mYWNldERlcHRoU29ydD1lfWdldCBmYWNldERlcHRoU29ydEZyb20oKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZmFjZXREYXRhLmZhY2V0RGVwdGhTb3J0RnJvbX1zZXQgZmFjZXREZXB0aFNvcnRGcm9tKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5mYWNldERlcHRoU29ydEZyb209ZX1nZXQgY29sbGlzaW9uUmV0cnlDb3VudCgpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9jb2xsaXNpb25SZXRyeUNvdW50fXNldCBjb2xsaXNpb25SZXRyeUNvdW50KGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2NvbGxpc2lvblJldHJ5Q291bnQ9ZX1nZXQgaXNGYWNldERhdGFFbmFibGVkKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5mYWNldERhdGFFbmFibGVkfWdldCBtb3JwaFRhcmdldE1hbmFnZXIoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbW9ycGhUYXJnZXRNYW5hZ2VyfXNldCBtb3JwaFRhcmdldE1hbmFnZXIoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbW9ycGhUYXJnZXRNYW5hZ2VyIT09ZSYmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21vcnBoVGFyZ2V0TWFuYWdlcj1lLHRoaXMuX3N5bmNHZW9tZXRyeVdpdGhNb3JwaFRhcmdldE1hbmFnZXIoKSl9Z2V0IGJha2VkVmVydGV4QW5pbWF0aW9uTWFuYWdlcigpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9iYWtlZFZlcnRleEFuaW1hdGlvbk1hbmFnZXJ9c2V0IGJha2VkVmVydGV4QW5pbWF0aW9uTWFuYWdlcihlKXt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9iYWtlZFZlcnRleEFuaW1hdGlvbk1hbmFnZXIhPT1lJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fYmFrZWRWZXJ0ZXhBbmltYXRpb25NYW5hZ2VyPWUsdGhpcy5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCkpfV9zeW5jR2VvbWV0cnlXaXRoTW9ycGhUYXJnZXRNYW5hZ2VyKCl7fV91cGRhdGVOb25Vbmlmb3JtU2NhbGluZ1N0YXRlKGUpe3JldHVybiBzdXBlci5fdXBkYXRlTm9uVW5pZm9ybVNjYWxpbmdTdGF0ZShlKT8odGhpcy5fbWFya1N1Yk1lc2hlc0FzTWlzY0RpcnR5KCksITApOiExfXNldCBvbkNvbGxpZGUoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX29uQ29sbGlkZU9ic2VydmVyJiZ0aGlzLm9uQ29sbGlkZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9vbkNvbGxpZGVPYnNlcnZlciksdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX29uQ29sbGlkZU9ic2VydmVyPXRoaXMub25Db2xsaWRlT2JzZXJ2YWJsZS5hZGQoZSl9c2V0IG9uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2UoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX29uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2VPYnNlcnZlciYmdGhpcy5vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX29uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2VPYnNlcnZlciksdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX29uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2VPYnNlcnZlcj10aGlzLm9uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2VPYnNlcnZhYmxlLmFkZChlKX1nZXQgdmlzaWJpbGl0eSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl92aXNpYmlsaXR5fXNldCB2aXNpYmlsaXR5KGUpe2lmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3Zpc2liaWxpdHk9PT1lKXJldHVybjtjb25zdCB0PXRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3Zpc2liaWxpdHk7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fdmlzaWJpbGl0eT1lLCh0PT09MSYmZSE9PTF8fHQhPT0xJiZlPT09MSkmJnRoaXMuX21hcmtTdWJNZXNoZXNBc01pc2NEaXJ0eSgpfWdldCBwb2ludGVyT3ZlckRpc2FibGVNZXNoVGVzdGluZygpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9wb2ludGVyT3ZlckRpc2FibGVNZXNoVGVzdGluZ31zZXQgcG9pbnRlck92ZXJEaXNhYmxlTWVzaFRlc3RpbmcoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fcG9pbnRlck92ZXJEaXNhYmxlTWVzaFRlc3Rpbmc9ZX1nZXQgcmVuZGVyaW5nR3JvdXBJZCgpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9yZW5kZXJpbmdHcm91cElkfXNldCByZW5kZXJpbmdHcm91cElkKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3JlbmRlcmluZ0dyb3VwSWQ9ZX1nZXQgbWF0ZXJpYWwoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWx9c2V0IG1hdGVyaWFsKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21hdGVyaWFsIT09ZSYmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21hdGVyaWFsJiZ0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tYXRlcmlhbC5tZXNoTWFwJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWwubWVzaE1hcFt0aGlzLnVuaXF1ZUlkXT12b2lkIDApLHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21hdGVyaWFsPWUsZSYmZS5tZXNoTWFwJiYoZS5tZXNoTWFwW3RoaXMudW5pcXVlSWRdPXRoaXMpLHRoaXMub25NYXRlcmlhbENoYW5nZWRPYnNlcnZhYmxlLmhhc09ic2VydmVycygpJiZ0aGlzLm9uTWF0ZXJpYWxDaGFuZ2VkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5zdWJNZXNoZXMmJih0aGlzLnJlc2V0RHJhd0NhY2hlKCksdGhpcy5fdW5CaW5kRWZmZWN0KCkpKX1nZXRNYXRlcmlhbEZvclJlbmRlclBhc3MoZSl7dmFyIHQ7cmV0dXJuKHQ9dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWxGb3JSZW5kZXJQYXNzKT09PW51bGx8fHQ9PT12b2lkIDA/dm9pZCAwOnRbZV19c2V0TWF0ZXJpYWxGb3JSZW5kZXJQYXNzKGUsdCl7dGhpcy5yZXNldERyYXdDYWNoZShlKSx0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tYXRlcmlhbEZvclJlbmRlclBhc3N8fCh0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tYXRlcmlhbEZvclJlbmRlclBhc3M9W10pLHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21hdGVyaWFsRm9yUmVuZGVyUGFzc1tlXT10fWdldCByZWNlaXZlU2hhZG93cygpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9yZWNlaXZlU2hhZG93c31zZXQgcmVjZWl2ZVNoYWRvd3MoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fcmVjZWl2ZVNoYWRvd3MhPT1lJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fcmVjZWl2ZVNoYWRvd3M9ZSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNMaWdodERpcnR5KCkpfWdldCBoYXNWZXJ0ZXhBbHBoYSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9oYXNWZXJ0ZXhBbHBoYX1zZXQgaGFzVmVydGV4QWxwaGEoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5faGFzVmVydGV4QWxwaGEhPT1lJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5faGFzVmVydGV4QWxwaGE9ZSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNBdHRyaWJ1dGVzRGlydHkoKSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNNaXNjRGlydHkoKSl9Z2V0IHVzZVZlcnRleENvbG9ycygpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl91c2VWZXJ0ZXhDb2xvcnN9c2V0IHVzZVZlcnRleENvbG9ycyhlKXt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl91c2VWZXJ0ZXhDb2xvcnMhPT1lJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fdXNlVmVydGV4Q29sb3JzPWUsdGhpcy5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCkpfWdldCBjb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzfXNldCBjb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzIT09ZSYmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2NvbXB1dGVCb25lc1VzaW5nU2hhZGVycz1lLHRoaXMuX21hcmtTdWJNZXNoZXNBc0F0dHJpYnV0ZXNEaXJ0eSgpKX1nZXQgbnVtQm9uZUluZmx1ZW5jZXJzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX251bUJvbmVJbmZsdWVuY2Vyc31zZXQgbnVtQm9uZUluZmx1ZW5jZXJzKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX251bUJvbmVJbmZsdWVuY2VycyE9PWUmJih0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9udW1Cb25lSW5mbHVlbmNlcnM9ZSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNBdHRyaWJ1dGVzRGlydHkoKSl9Z2V0IGFwcGx5Rm9nKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2FwcGx5Rm9nfXNldCBhcHBseUZvZyhlKXt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hcHBseUZvZyE9PWUmJih0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hcHBseUZvZz1lLHRoaXMuX21hcmtTdWJNZXNoZXNBc01pc2NEaXJ0eSgpKX1nZXQgZW5hYmxlRGlzdGFudFBpY2tpbmcoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZW5hYmxlRGlzdGFudFBpY2tpbmd9c2V0IGVuYWJsZURpc3RhbnRQaWNraW5nKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2VuYWJsZURpc3RhbnRQaWNraW5nPWV9Z2V0IGxheWVyTWFzaygpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9sYXllck1hc2t9c2V0IGxheWVyTWFzayhlKXtlIT09dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbGF5ZXJNYXNrJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbGF5ZXJNYXNrPWUsdGhpcy5fcmVzeW5jTGlnaHRTb3VyY2VzKCkpfWdldCBjb2xsaXNpb25NYXNrKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9jb2xsaXNpb25NYXNrfXNldCBjb2xsaXNpb25NYXNrKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9jb2xsaXNpb25NYXNrPWlzTmFOKGUpPy0xOmV9Z2V0IGNvbGxpc2lvblJlc3BvbnNlKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9jb2xsaXNpb25SZXNwb25zZX1zZXQgY29sbGlzaW9uUmVzcG9uc2UoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX2NvbGxpc2lvblJlc3BvbnNlPWV9Z2V0IGNvbGxpc2lvbkdyb3VwKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9jb2xsaXNpb25Hcm91cH1zZXQgY29sbGlzaW9uR3JvdXAoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX2NvbGxpc2lvbkdyb3VwPWlzTmFOKGUpPy0xOmV9Z2V0IHN1cnJvdW5kaW5nTWVzaGVzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9zdXJyb3VuZGluZ01lc2hlc31zZXQgc3Vycm91bmRpbmdNZXNoZXMoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX3N1cnJvdW5kaW5nTWVzaGVzPWV9Z2V0IGxpZ2h0U291cmNlcygpe3JldHVybiB0aGlzLl9saWdodFNvdXJjZXN9Z2V0IF9wb3NpdGlvbnMoKXtyZXR1cm4gbnVsbH1zZXQgc2tlbGV0b24oZSl7Y29uc3QgdD10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9za2VsZXRvbjt0JiZ0Lm5lZWRJbml0aWFsU2tpbk1hdHJpeCYmdC5fdW5yZWdpc3Rlck1lc2hXaXRoUG9zZU1hdHJpeCh0aGlzKSxlJiZlLm5lZWRJbml0aWFsU2tpbk1hdHJpeCYmZS5fcmVnaXN0ZXJNZXNoV2l0aFBvc2VNYXRyaXgodGhpcyksdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fc2tlbGV0b249ZSx0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9za2VsZXRvbnx8KHRoaXMuX2JvbmVzVHJhbnNmb3JtTWF0cmljZXM9bnVsbCksdGhpcy5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCl9Z2V0IHNrZWxldG9uKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3NrZWxldG9ufV9idWlsZFVuaWZvcm1MYXlvdXQoKXt0aGlzLl91bmlmb3JtQnVmZmVyLmFkZFVuaWZvcm0oIndvcmxkIiwxNiksdGhpcy5fdW5pZm9ybUJ1ZmZlci5hZGRVbmlmb3JtKCJ2aXNpYmlsaXR5IiwxKSx0aGlzLl91bmlmb3JtQnVmZmVyLmNyZWF0ZSgpfXRyYW5zZmVyVG9FZmZlY3QoZSl7Y29uc3QgdD10aGlzLl91bmlmb3JtQnVmZmVyO3QudXBkYXRlTWF0cml4KCJ3b3JsZCIsZSksdC51cGRhdGVGbG9hdCgidmlzaWJpbGl0eSIsdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fdmlzaWJpbGl0eSksdC51cGRhdGUoKX1nZXRNZXNoVW5pZm9ybUJ1ZmZlcigpe3JldHVybiB0aGlzLl91bmlmb3JtQnVmZmVyfWdldENsYXNzTmFtZSgpe3JldHVybiJBYnN0cmFjdE1lc2gifXRvU3RyaW5nKGUpe2xldCB0PSJOYW1lOiAiK3RoaXMubmFtZSsiLCBpc0luc3RhbmNlOiAiKyh0aGlzLmdldENsYXNzTmFtZSgpIT09Ikluc3RhbmNlZE1lc2giPyJZRVMiOiJOTyIpO3QrPSIsICMgb2Ygc3VibWVzaGVzOiAiKyh0aGlzLnN1Yk1lc2hlcz90aGlzLnN1Yk1lc2hlcy5sZW5ndGg6MCk7Y29uc3QgaT10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9za2VsZXRvbjtyZXR1cm4gaSYmKHQrPSIsIHNrZWxldG9uOiAiK2kubmFtZSksZSYmKHQrPSIsIGJpbGxib2FyZCBtb2RlOiAiK1siTk9ORSIsIlgiLCJZIixudWxsLCJaIixudWxsLG51bGwsIkFMTCJdW3RoaXMuYmlsbGJvYXJkTW9kZV0sdCs9IiwgZnJlZXplIHdybGQgbWF0OiAiKyh0aGlzLl9pc1dvcmxkTWF0cml4RnJvemVufHx0aGlzLl93YWl0aW5nRGF0YS5mcmVlemVXb3JsZE1hdHJpeD8iWUVTIjoiTk8iKSksdH1fZ2V0RWZmZWN0aXZlUGFyZW50KCl7cmV0dXJuIHRoaXMuX21hc3Rlck1lc2gmJnRoaXMuYmlsbGJvYXJkTW9kZSE9PUouQklMTEJPQVJETU9ERV9OT05FP3RoaXMuX21hc3Rlck1lc2g6c3VwZXIuX2dldEVmZmVjdGl2ZVBhcmVudCgpfV9nZXRBY3Rpb25NYW5hZ2VyRm9yVHJpZ2dlcihlLHQ9ITApe2lmKHRoaXMuYWN0aW9uTWFuYWdlciYmKHR8fHRoaXMuYWN0aW9uTWFuYWdlci5pc1JlY3Vyc2l2ZSkpaWYoZSl7aWYodGhpcy5hY3Rpb25NYW5hZ2VyLmhhc1NwZWNpZmljVHJpZ2dlcihlKSlyZXR1cm4gdGhpcy5hY3Rpb25NYW5hZ2VyfWVsc2UgcmV0dXJuIHRoaXMuYWN0aW9uTWFuYWdlcjtyZXR1cm4gdGhpcy5wYXJlbnQ/dGhpcy5wYXJlbnQuX2dldEFjdGlvbk1hbmFnZXJGb3JUcmlnZ2VyKGUsITEpOm51bGx9X3JlYnVpbGQoZT0hMSl7aWYodGhpcy5vblJlYnVpbGRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSx0aGlzLl9vY2NsdXNpb25RdWVyeSE9PW51bGwmJih0aGlzLl9vY2NsdXNpb25RdWVyeT1udWxsKSwhIXRoaXMuc3ViTWVzaGVzKWZvcihjb25zdCB0IG9mIHRoaXMuc3ViTWVzaGVzKXQuX3JlYnVpbGQoKX1fcmVzeW5jTGlnaHRTb3VyY2VzKCl7dGhpcy5fbGlnaHRTb3VyY2VzLmxlbmd0aD0wO2Zvcihjb25zdCBlIG9mIHRoaXMuZ2V0U2NlbmUoKS5saWdodHMpZS5pc0VuYWJsZWQoKSYmZS5jYW5BZmZlY3RNZXNoKHRoaXMpJiZ0aGlzLl9saWdodFNvdXJjZXMucHVzaChlKTt0aGlzLl9tYXJrU3ViTWVzaGVzQXNMaWdodERpcnR5KCl9X3Jlc3luY0xpZ2h0U291cmNlKGUpe2NvbnN0IHQ9ZS5pc0VuYWJsZWQoKSYmZS5jYW5BZmZlY3RNZXNoKHRoaXMpLGk9dGhpcy5fbGlnaHRTb3VyY2VzLmluZGV4T2YoZSk7bGV0IHM9ITE7aWYoaT09PS0xKXtpZighdClyZXR1cm47dGhpcy5fbGlnaHRTb3VyY2VzLnB1c2goZSl9ZWxzZXtpZih0KXJldHVybjtzPSEwLHRoaXMuX2xpZ2h0U291cmNlcy5zcGxpY2UoaSwxKX10aGlzLl9tYXJrU3ViTWVzaGVzQXNMaWdodERpcnR5KHMpfV91bkJpbmRFZmZlY3QoKXtmb3IoY29uc3QgZSBvZiB0aGlzLnN1Yk1lc2hlcyllLnNldEVmZmVjdChudWxsKX1fcmVtb3ZlTGlnaHRTb3VyY2UoZSx0KXtjb25zdCBpPXRoaXMuX2xpZ2h0U291cmNlcy5pbmRleE9mKGUpO2khPT0tMSYmKHRoaXMuX2xpZ2h0U291cmNlcy5zcGxpY2UoaSwxKSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNMaWdodERpcnR5KHQpKX1fbWFya1N1Yk1lc2hlc0FzRGlydHkoZSl7aWYodGhpcy5zdWJNZXNoZXMpZm9yKGNvbnN0IHQgb2YgdGhpcy5zdWJNZXNoZXMpZm9yKGxldCBpPTA7aTx0Ll9kcmF3V3JhcHBlcnMubGVuZ3RoOysraSl7Y29uc3Qgcz10Ll9kcmF3V3JhcHBlcnNbaV07IXN8fCFzLmRlZmluZXN8fCFzLmRlZmluZXMubWFya0FsbEFzRGlydHl8fGUocy5kZWZpbmVzKX19X21hcmtTdWJNZXNoZXNBc0xpZ2h0RGlydHkoZT0hMSl7dGhpcy5fbWFya1N1Yk1lc2hlc0FzRGlydHkodD0+dC5tYXJrQXNMaWdodERpcnR5KGUpKX1fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCl7dGhpcy5fbWFya1N1Yk1lc2hlc0FzRGlydHkoZT0+ZS5tYXJrQXNBdHRyaWJ1dGVzRGlydHkoKSl9X21hcmtTdWJNZXNoZXNBc01pc2NEaXJ0eSgpe3RoaXMuX21hcmtTdWJNZXNoZXNBc0RpcnR5KGU9PmUubWFya0FzTWlzY0RpcnR5KCkpfW1hcmtBc0RpcnR5KGUpe3JldHVybiB0aGlzLl9jdXJyZW50UmVuZGVySWQ9TnVtYmVyLk1BWF9WQUxVRSx0aGlzLl9pc0RpcnR5PSEwLHRoaXN9cmVzZXREcmF3Q2FjaGUoZSl7aWYodGhpcy5zdWJNZXNoZXMpZm9yKGNvbnN0IHQgb2YgdGhpcy5zdWJNZXNoZXMpdC5yZXNldERyYXdDYWNoZShlKX1nZXQgaXNCbG9ja2VkKCl7cmV0dXJuITF9Z2V0TE9EKGUpe3JldHVybiB0aGlzfWdldFRvdGFsVmVydGljZXMoKXtyZXR1cm4gMH1nZXRUb3RhbEluZGljZXMoKXtyZXR1cm4gMH1nZXRJbmRpY2VzKCl7cmV0dXJuIG51bGx9Z2V0VmVydGljZXNEYXRhKGUpe3JldHVybiBudWxsfXNldFZlcnRpY2VzRGF0YShlLHQsaSxzKXtyZXR1cm4gdGhpc311cGRhdGVWZXJ0aWNlc0RhdGEoZSx0LGkscyl7cmV0dXJuIHRoaXN9c2V0SW5kaWNlcyhlLHQpe3JldHVybiB0aGlzfWlzVmVydGljZXNEYXRhUHJlc2VudChlKXtyZXR1cm4hMX1nZXRCb3VuZGluZ0luZm8oKXtyZXR1cm4gdGhpcy5fbWFzdGVyTWVzaD90aGlzLl9tYXN0ZXJNZXNoLmdldEJvdW5kaW5nSW5mbygpOih0aGlzLl9ib3VuZGluZ0luZm9Jc0RpcnR5JiYodGhpcy5fYm91bmRpbmdJbmZvSXNEaXJ0eT0hMSx0aGlzLl91cGRhdGVCb3VuZGluZ0luZm8oKSksdGhpcy5fYm91bmRpbmdJbmZvKX1zZXRCb3VuZGluZ0luZm8oZSl7cmV0dXJuIHRoaXMuX2JvdW5kaW5nSW5mbz1lLHRoaXN9Z2V0IGhhc0JvdW5kaW5nSW5mbygpe3JldHVybiB0aGlzLl9ib3VuZGluZ0luZm8hPT1udWxsfWJ1aWxkQm91bmRpbmdJbmZvKGUsdCxpKXtyZXR1cm4gdGhpcy5fYm91bmRpbmdJbmZvPW5ldyBkdChlLHQsaSksdGhpcy5fYm91bmRpbmdJbmZvfW5vcm1hbGl6ZVRvVW5pdEN1YmUoZT0hMCx0PSExLGkpe3JldHVybiBzdXBlci5ub3JtYWxpemVUb1VuaXRDdWJlKGUsdCxpKX1nZXQgdXNlQm9uZXMoKXtyZXR1cm4gdGhpcy5za2VsZXRvbiYmdGhpcy5nZXRTY2VuZSgpLnNrZWxldG9uc0VuYWJsZWQmJnRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTWF0cmljZXNJbmRpY2VzS2luZCkmJnRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTWF0cmljZXNXZWlnaHRzS2luZCl9X3ByZUFjdGl2YXRlKCl7fV9wcmVBY3RpdmF0ZUZvckludGVybWVkaWF0ZVJlbmRlcmluZyhlKXt9X2FjdGl2YXRlKGUsdCl7cmV0dXJuIHRoaXMuX3JlbmRlcklkPWUsITB9X3Bvc3RBY3RpdmF0ZSgpe31fZnJlZXplKCl7fV91bkZyZWV6ZSgpe31nZXRXb3JsZE1hdHJpeCgpe3JldHVybiB0aGlzLl9tYXN0ZXJNZXNoJiZ0aGlzLmJpbGxib2FyZE1vZGU9PT1KLkJJTExCT0FSRE1PREVfTk9ORT90aGlzLl9tYXN0ZXJNZXNoLmdldFdvcmxkTWF0cml4KCk6c3VwZXIuZ2V0V29ybGRNYXRyaXgoKX1fZ2V0V29ybGRNYXRyaXhEZXRlcm1pbmFudCgpe3JldHVybiB0aGlzLl9tYXN0ZXJNZXNoP3RoaXMuX21hc3Rlck1lc2guX2dldFdvcmxkTWF0cml4RGV0ZXJtaW5hbnQoKTpzdXBlci5fZ2V0V29ybGRNYXRyaXhEZXRlcm1pbmFudCgpfWdldCBpc0FuSW5zdGFuY2UoKXtyZXR1cm4hMX1nZXQgaGFzSW5zdGFuY2VzKCl7cmV0dXJuITF9Z2V0IGhhc1RoaW5JbnN0YW5jZXMoKXtyZXR1cm4hMX1tb3ZlUE9WKGUsdCxpKXtyZXR1cm4gdGhpcy5wb3NpdGlvbi5hZGRJblBsYWNlKHRoaXMuY2FsY01vdmVQT1YoZSx0LGkpKSx0aGlzfWNhbGNNb3ZlUE9WKGUsdCxpKXtjb25zdCBzPW5ldyB4Oyh0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj90aGlzLnJvdGF0aW9uUXVhdGVybmlvbjpaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsKHRoaXMucm90YXRpb24ueSx0aGlzLnJvdGF0aW9uLngsdGhpcy5yb3RhdGlvbi56KSkudG9Sb3RhdGlvbk1hdHJpeChzKTtjb25zdCBuPXAuWmVybygpLGE9dGhpcy5kZWZpbmVkRmFjaW5nRm9yd2FyZD8tMToxO3JldHVybiBwLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGUqYSx0LGkqYSxzLG4pLG59cm90YXRlUE9WKGUsdCxpKXtyZXR1cm4gdGhpcy5yb3RhdGlvbi5hZGRJblBsYWNlKHRoaXMuY2FsY1JvdGF0ZVBPVihlLHQsaSkpLHRoaXN9Y2FsY1JvdGF0ZVBPVihlLHQsaSl7Y29uc3Qgcz10aGlzLmRlZmluZWRGYWNpbmdGb3J3YXJkPzE6LTE7cmV0dXJuIG5ldyBwKGUqcyx0LGkqcyl9cmVmcmVzaEJvdW5kaW5nSW5mbyhlPSExLHQ9ITEpe3JldHVybiB0aGlzLl9ib3VuZGluZ0luZm8mJnRoaXMuX2JvdW5kaW5nSW5mby5pc0xvY2tlZD90aGlzOih0aGlzLl9yZWZyZXNoQm91bmRpbmdJbmZvKHRoaXMuX2dldFBvc2l0aW9uRGF0YShlLHQpLG51bGwpLHRoaXMpfV9yZWZyZXNoQm91bmRpbmdJbmZvKGUsdCl7aWYoZSl7Y29uc3QgaT15cihlLDAsdGhpcy5nZXRUb3RhbFZlcnRpY2VzKCksdCk7dGhpcy5fYm91bmRpbmdJbmZvP3RoaXMuX2JvdW5kaW5nSW5mby5yZUNvbnN0cnVjdChpLm1pbmltdW0saS5tYXhpbXVtKTp0aGlzLl9ib3VuZGluZ0luZm89bmV3IGR0KGkubWluaW11bSxpLm1heGltdW0pfWlmKHRoaXMuc3ViTWVzaGVzKWZvcihsZXQgaT0wO2k8dGhpcy5zdWJNZXNoZXMubGVuZ3RoO2krKyl0aGlzLnN1Yk1lc2hlc1tpXS5yZWZyZXNoQm91bmRpbmdJbmZvKGUpO3RoaXMuX3VwZGF0ZUJvdW5kaW5nSW5mbygpfV9nZXREYXRhKGU9ITEsdD0hMSxpLHM9Zy5Qb3NpdGlvbktpbmQpe2lmKGk9aT8/dGhpcy5nZXRWZXJ0aWNlc0RhdGEocykuc2xpY2UoKSxpJiZ0JiZ0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlcil7bGV0IHI9MCxuPTA7Zm9yKGxldCBhPTA7YTxpLmxlbmd0aDthKyspe2ZvcihsZXQgbz0wO288dGhpcy5tb3JwaFRhcmdldE1hbmFnZXIubnVtVGFyZ2V0cztvKyspe2NvbnN0IGg9dGhpcy5tb3JwaFRhcmdldE1hbmFnZXIuZ2V0VGFyZ2V0KG8pLGw9aC5pbmZsdWVuY2U7aWYobD4wKXtjb25zdCB1PWguZ2V0UG9zaXRpb25zKCk7dSYmKGlbYV0rPSh1W2FdLWlbYV0pKmwpfX1pZihyKysscz09PWcuUG9zaXRpb25LaW5kJiZ0aGlzLl9wb3NpdGlvbnMmJnI9PT0zKXtyPTA7Y29uc3Qgbz1uKjM7dGhpcy5fcG9zaXRpb25zW24rK10uY29weUZyb21GbG9hdHMoaVtvXSxpW28rMV0saVtvKzJdKX19fWlmKGkmJmUmJnRoaXMuc2tlbGV0b24pe2NvbnN0IHI9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kKSxuPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCk7aWYobiYmcil7Y29uc3QgYT10aGlzLm51bUJvbmVJbmZsdWVuY2Vycz40LG89YT90aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCk6bnVsbCxoPWE/dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc1dlaWdodHNFeHRyYUtpbmQpOm51bGwsbD10aGlzLnNrZWxldG9uLmdldFRyYW5zZm9ybU1hdHJpY2VzKHRoaXMpLHU9RC5WZWN0b3IzWzBdLGQ9RC5NYXRyaXhbMF0sZj1ELk1hdHJpeFsxXTtsZXQgXz0wO2ZvcihsZXQgRT0wO0U8aS5sZW5ndGg7RSs9MyxfKz00KXtkLnJlc2V0KCk7bGV0IG0sdjtmb3IobT0wO208NDttKyspdj1uW18rbV0sdj4wJiYoeC5Gcm9tRmxvYXQzMkFycmF5VG9SZWZTY2FsZWQobCxNYXRoLmZsb29yKHJbXyttXSoxNiksdixmKSxkLmFkZFRvU2VsZihmKSk7aWYoYSlmb3IobT0wO208NDttKyspdj1oW18rbV0sdj4wJiYoeC5Gcm9tRmxvYXQzMkFycmF5VG9SZWZTY2FsZWQobCxNYXRoLmZsb29yKG9bXyttXSoxNiksdixmKSxkLmFkZFRvU2VsZihmKSk7cz09PWcuTm9ybWFsS2luZD9wLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZihpW0VdLGlbRSsxXSxpW0UrMl0sZCx1KTpwLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGlbRV0saVtFKzFdLGlbRSsyXSxkLHUpLHUudG9BcnJheShpLEUpLHM9PT1nLlBvc2l0aW9uS2luZCYmdGhpcy5fcG9zaXRpb25zJiZ0aGlzLl9wb3NpdGlvbnNbRS8zXS5jb3B5RnJvbSh1KX19fXJldHVybiBpfWdldE5vcm1hbHNEYXRhKGU9ITEsdD0hMSl7cmV0dXJuIHRoaXMuX2dldERhdGEoZSx0LG51bGwsZy5Ob3JtYWxLaW5kKX1nZXRQb3NpdGlvbkRhdGEoZT0hMSx0PSExLGkpe3JldHVybiB0aGlzLl9nZXREYXRhKGUsdCxpLGcuUG9zaXRpb25LaW5kKX1fZ2V0UG9zaXRpb25EYXRhKGUsdCl7dmFyIGk7bGV0IHM9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQpO2lmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3Bvc2l0aW9ucyYmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3Bvc2l0aW9ucz1udWxsKSxzJiYoZSYmdGhpcy5za2VsZXRvbnx8dCYmdGhpcy5tb3JwaFRhcmdldE1hbmFnZXIpKXtpZihzPXMuc2xpY2UoKSx0aGlzLl9nZW5lcmF0ZVBvaW50c0FycmF5KCksdGhpcy5fcG9zaXRpb25zKXtjb25zdCByPXRoaXMuX3Bvc2l0aW9uczt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9wb3NpdGlvbnM9bmV3IEFycmF5KHIubGVuZ3RoKTtmb3IobGV0IG49MDtuPHIubGVuZ3RoO24rKyl0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9wb3NpdGlvbnNbbl09KChpPXJbbl0pPT09bnVsbHx8aT09PXZvaWQgMD92b2lkIDA6aS5jbG9uZSgpKXx8bmV3IHB9cmV0dXJuIHRoaXMuZ2V0UG9zaXRpb25EYXRhKGUsdCxzKX1yZXR1cm4gc31fdXBkYXRlQm91bmRpbmdJbmZvKCl7cmV0dXJuIHRoaXMuX2JvdW5kaW5nSW5mbz90aGlzLl9ib3VuZGluZ0luZm8udXBkYXRlKHRoaXMud29ybGRNYXRyaXhGcm9tQ2FjaGUpOnRoaXMuX2JvdW5kaW5nSW5mbz1uZXcgZHQocC5aZXJvKCkscC5aZXJvKCksdGhpcy53b3JsZE1hdHJpeEZyb21DYWNoZSksdGhpcy5fdXBkYXRlU3ViTWVzaGVzQm91bmRpbmdJbmZvKHRoaXMud29ybGRNYXRyaXhGcm9tQ2FjaGUpLHRoaXN9X3VwZGF0ZVN1Yk1lc2hlc0JvdW5kaW5nSW5mbyhlKXtpZighdGhpcy5zdWJNZXNoZXMpcmV0dXJuIHRoaXM7Y29uc3QgdD10aGlzLnN1Yk1lc2hlcy5sZW5ndGg7Zm9yKGxldCBpPTA7aTx0O2krKyl7Y29uc3Qgcz10aGlzLnN1Yk1lc2hlc1tpXTsodD4xfHwhcy5Jc0dsb2JhbCkmJnMudXBkYXRlQm91bmRpbmdJbmZvKGUpfXJldHVybiB0aGlzfV9hZnRlckNvbXB1dGVXb3JsZE1hdHJpeCgpe3RoaXMuZG9Ob3RTeW5jQm91bmRpbmdJbmZvfHwodGhpcy5fYm91bmRpbmdJbmZvSXNEaXJ0eT0hMCl9aXNJbkZydXN0dW0oZSl7cmV0dXJuIHRoaXMuZ2V0Qm91bmRpbmdJbmZvKCkuaXNJbkZydXN0dW0oZSx0aGlzLmN1bGxpbmdTdHJhdGVneSl9aXNDb21wbGV0ZWx5SW5GcnVzdHVtKGUpe3JldHVybiB0aGlzLmdldEJvdW5kaW5nSW5mbygpLmlzQ29tcGxldGVseUluRnJ1c3R1bShlKX1pbnRlcnNlY3RzTWVzaChlLHQ9ITEsaSl7Y29uc3Qgcz10aGlzLmdldEJvdW5kaW5nSW5mbygpLHI9ZS5nZXRCb3VuZGluZ0luZm8oKTtpZihzLmludGVyc2VjdHMocix0KSlyZXR1cm4hMDtpZihpKXtmb3IoY29uc3QgbiBvZiB0aGlzLmdldENoaWxkTWVzaGVzKCkpaWYobi5pbnRlcnNlY3RzTWVzaChlLHQsITApKXJldHVybiEwfXJldHVybiExfWludGVyc2VjdHNQb2ludChlKXtyZXR1cm4gdGhpcy5nZXRCb3VuZGluZ0luZm8oKS5pbnRlcnNlY3RzUG9pbnQoZSl9Z2V0IGNoZWNrQ29sbGlzaW9ucygpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY2hlY2tDb2xsaXNpb25zfXNldCBjaGVja0NvbGxpc2lvbnMoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX2NoZWNrQ29sbGlzaW9ucz1lfWdldCBjb2xsaWRlcigpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY29sbGlkZXJ9bW92ZVdpdGhDb2xsaXNpb25zKGUpe3RoaXMuZ2V0QWJzb2x1dGVQb3NpdGlvbigpLmFkZFRvUmVmKHRoaXMuZWxsaXBzb2lkT2Zmc2V0LHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9vbGRQb3NpdGlvbkZvckNvbGxpc2lvbnMpO2NvbnN0IGk9dGhpcy5nZXRTY2VuZSgpLmNvbGxpc2lvbkNvb3JkaW5hdG9yO3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY29sbGlkZXJ8fCh0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY29sbGlkZXI9aS5jcmVhdGVDb2xsaWRlcigpKSx0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY29sbGlkZXIuX3JhZGl1cz10aGlzLmVsbGlwc29pZCxpLmdldE5ld1Bvc2l0aW9uKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9vbGRQb3NpdGlvbkZvckNvbGxpc2lvbnMsZSx0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY29sbGlkZXIsdGhpcy5jb2xsaXNpb25SZXRyeUNvdW50LHRoaXMsdGhpcy5fb25Db2xsaXNpb25Qb3NpdGlvbkNoYW5nZSx0aGlzLnVuaXF1ZUlkKSx0aGlzfV9jb2xsaWRlRm9yU3ViTWVzaChlLHQsaSl7dmFyIHM7aWYodGhpcy5fZ2VuZXJhdGVQb2ludHNBcnJheSgpLCF0aGlzLl9wb3NpdGlvbnMpcmV0dXJuIHRoaXM7aWYoIWUuX2xhc3RDb2xsaWRlcldvcmxkVmVydGljZXN8fCFlLl9sYXN0Q29sbGlkZXJUcmFuc2Zvcm1NYXRyaXguZXF1YWxzKHQpKXtlLl9sYXN0Q29sbGlkZXJUcmFuc2Zvcm1NYXRyaXg9dC5jbG9uZSgpLGUuX2xhc3RDb2xsaWRlcldvcmxkVmVydGljZXM9W10sZS5fdHJpYW5nbGVQbGFuZXM9W107Y29uc3Qgcj1lLnZlcnRpY2VzU3RhcnQsbj1lLnZlcnRpY2VzU3RhcnQrZS52ZXJ0aWNlc0NvdW50O2ZvcihsZXQgYT1yO2E8bjthKyspZS5fbGFzdENvbGxpZGVyV29ybGRWZXJ0aWNlcy5wdXNoKHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXModGhpcy5fcG9zaXRpb25zW2FdLHQpKX1yZXR1cm4gaS5fY29sbGlkZShlLl90cmlhbmdsZVBsYW5lcyxlLl9sYXN0Q29sbGlkZXJXb3JsZFZlcnRpY2VzLHRoaXMuZ2V0SW5kaWNlcygpLGUuaW5kZXhTdGFydCxlLmluZGV4U3RhcnQrZS5pbmRleENvdW50LGUudmVydGljZXNTdGFydCwhIWUuZ2V0TWF0ZXJpYWwoKSx0aGlzLHRoaXMuX3Nob3VsZENvbnZlcnRSSFMoKSwoKHM9ZS5nZXRNYXRlcmlhbCgpKT09PW51bGx8fHM9PT12b2lkIDA/dm9pZCAwOnMuZmlsbE1vZGUpPT09NyksdGhpc31fcHJvY2Vzc0NvbGxpc2lvbnNGb3JTdWJNZXNoZXMoZSx0KXtjb25zdCBpPXRoaXMuX3NjZW5lLmdldENvbGxpZGluZ1N1Yk1lc2hDYW5kaWRhdGVzKHRoaXMsZSkscz1pLmxlbmd0aDtmb3IobGV0IHI9MDtyPHM7cisrKXtjb25zdCBuPWkuZGF0YVtyXTtzPjEmJiFuLl9jaGVja0NvbGxpc2lvbihlKXx8dGhpcy5fY29sbGlkZUZvclN1Yk1lc2gobix0LGUpfXJldHVybiB0aGlzfV9zaG91bGRDb252ZXJ0UkhTKCl7cmV0dXJuITF9X2NoZWNrQ29sbGlzaW9uKGUpe2lmKCF0aGlzLmdldEJvdW5kaW5nSW5mbygpLl9jaGVja0NvbGxpc2lvbihlKSlyZXR1cm4gdGhpcztjb25zdCB0PUQuTWF0cml4WzBdLGk9RC5NYXRyaXhbMV07cmV0dXJuIHguU2NhbGluZ1RvUmVmKDEvZS5fcmFkaXVzLngsMS9lLl9yYWRpdXMueSwxL2UuX3JhZGl1cy56LHQpLHRoaXMud29ybGRNYXRyaXhGcm9tQ2FjaGUubXVsdGlwbHlUb1JlZih0LGkpLHRoaXMuX3Byb2Nlc3NDb2xsaXNpb25zRm9yU3ViTWVzaGVzKGUsaSksdGhpc31fZ2VuZXJhdGVQb2ludHNBcnJheSgpe3JldHVybiExfWludGVyc2VjdHMoZSx0LGkscz0hMSxyLG49ITEpe2NvbnN0IGE9bmV3IFV0LG89dGhpcy5nZXRDbGFzc05hbWUoKT09PSJJbnN0YW5jZWRMaW5lc01lc2gifHx0aGlzLmdldENsYXNzTmFtZSgpPT09IkxpbmVzTWVzaCI/dGhpcy5pbnRlcnNlY3Rpb25UaHJlc2hvbGQ6MCxoPXRoaXMuZ2V0Qm91bmRpbmdJbmZvKCk7aWYoIXRoaXMuc3ViTWVzaGVzfHwhbiYmKCFlLmludGVyc2VjdHNTcGhlcmUoaC5ib3VuZGluZ1NwaGVyZSxvKXx8IWUuaW50ZXJzZWN0c0JveChoLmJvdW5kaW5nQm94LG8pKSlyZXR1cm4gYTtpZihzKXJldHVybiBhLmhpdD0hbixhLnBpY2tlZE1lc2g9bj9udWxsOnRoaXMsYS5kaXN0YW5jZT1uPzA6cC5EaXN0YW5jZShlLm9yaWdpbixoLmJvdW5kaW5nU3BoZXJlLmNlbnRlciksYS5zdWJNZXNoSWQ9MCxhO2lmKCF0aGlzLl9nZW5lcmF0ZVBvaW50c0FycmF5KCkpcmV0dXJuIGE7bGV0IGw9bnVsbDtjb25zdCB1PXRoaXMuX3NjZW5lLmdldEludGVyc2VjdGluZ1N1Yk1lc2hDYW5kaWRhdGVzKHRoaXMsZSksZD11Lmxlbmd0aDtsZXQgZj0hMTtmb3IobGV0IF89MDtfPGQ7XysrKXtjb25zdCBtPXUuZGF0YVtfXS5nZXRNYXRlcmlhbCgpO2lmKG0mJihtLmZpbGxNb2RlPT03fHxtLmZpbGxNb2RlPT0wfHxtLmZpbGxNb2RlPT0xfHxtLmZpbGxNb2RlPT0yfHxtLmZpbGxNb2RlPT00KSl7Zj0hMDticmVha319aWYoIWYpcmV0dXJuIGEuaGl0PSEwLGEucGlja2VkTWVzaD10aGlzLGEuZGlzdGFuY2U9cC5EaXN0YW5jZShlLm9yaWdpbixoLmJvdW5kaW5nU3BoZXJlLmNlbnRlciksYS5zdWJNZXNoSWQ9LTEsYTtmb3IobGV0IF89MDtfPGQ7XysrKXtjb25zdCBFPXUuZGF0YVtfXTtpZihkPjEmJiFFLmNhbkludGVyc2VjdHMoZSkpY29udGludWU7Y29uc3QgbT1FLmludGVyc2VjdHMoZSx0aGlzLl9wb3NpdGlvbnMsdGhpcy5nZXRJbmRpY2VzKCksdCxpKTtpZihtJiYodHx8IWx8fG0uZGlzdGFuY2U8bC5kaXN0YW5jZSkmJihsPW0sbC5zdWJNZXNoSWQ9Xyx0KSlicmVha31pZihsKXtjb25zdCBfPXI/P3RoaXMuZ2V0V29ybGRNYXRyaXgoKSxFPUQuVmVjdG9yM1swXSxtPUQuVmVjdG9yM1sxXTtwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYoZS5vcmlnaW4sXyxFKSxlLmRpcmVjdGlvbi5zY2FsZVRvUmVmKGwuZGlzdGFuY2UsbSk7Y29uc3QgUz1wLlRyYW5zZm9ybU5vcm1hbChtLF8pLmFkZEluUGxhY2UoRSk7cmV0dXJuIGEuaGl0PSEwLGEuZGlzdGFuY2U9cC5EaXN0YW5jZShFLFMpLGEucGlja2VkUG9pbnQ9UyxhLnBpY2tlZE1lc2g9dGhpcyxhLmJ1PWwuYnV8fDAsYS5idj1sLmJ2fHwwLGEuc3ViTWVzaEZhY2VJZD1sLmZhY2VJZCxhLmZhY2VJZD1sLmZhY2VJZCt1LmRhdGFbbC5zdWJNZXNoSWRdLmluZGV4U3RhcnQvKHRoaXMuZ2V0Q2xhc3NOYW1lKCkuaW5kZXhPZigiTGluZXNNZXNoIikhPT0tMT8yOjMpLGEuc3ViTWVzaElkPWwuc3ViTWVzaElkLGF9cmV0dXJuIGF9Y2xvbmUoZSx0LGkpe3JldHVybiBudWxsfXJlbGVhc2VTdWJNZXNoZXMoKXtpZih0aGlzLnN1Yk1lc2hlcylmb3IoO3RoaXMuc3ViTWVzaGVzLmxlbmd0aDspdGhpcy5zdWJNZXNoZXNbMF0uZGlzcG9zZSgpO2Vsc2UgdGhpcy5zdWJNZXNoZXM9bmV3IEFycmF5O3JldHVybiB0aGlzfWRpc3Bvc2UoZSx0PSExKXtsZXQgaTtmb3IodGhpcy5fc2NlbmUudXNlTWF0ZXJpYWxNZXNoTWFwJiZ0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tYXRlcmlhbCYmdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWwubWVzaE1hcCYmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21hdGVyaWFsLm1lc2hNYXBbdGhpcy51bmlxdWVJZF09dm9pZCAwKSx0aGlzLmdldFNjZW5lKCkuZnJlZUFjdGl2ZU1lc2hlcygpLHRoaXMuZ2V0U2NlbmUoKS5mcmVlUmVuZGVyaW5nR3JvdXBzKCksdGhpcy5hY3Rpb25NYW5hZ2VyIT09dm9pZCAwJiZ0aGlzLmFjdGlvbk1hbmFnZXIhPT1udWxsJiYodGhpcy5hY3Rpb25NYW5hZ2VyLmRpc3Bvc2UoKSx0aGlzLmFjdGlvbk1hbmFnZXI9bnVsbCksdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fc2tlbGV0b249bnVsbCx0aGlzLl90cmFuc2Zvcm1NYXRyaXhUZXh0dXJlJiYodGhpcy5fdHJhbnNmb3JtTWF0cml4VGV4dHVyZS5kaXNwb3NlKCksdGhpcy5fdHJhbnNmb3JtTWF0cml4VGV4dHVyZT1udWxsKSxpPTA7aTx0aGlzLl9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5sZW5ndGg7aSsrKXtjb25zdCBuPXRoaXMuX2ludGVyc2VjdGlvbnNJblByb2dyZXNzW2ldLGE9bi5faW50ZXJzZWN0aW9uc0luUHJvZ3Jlc3MuaW5kZXhPZih0aGlzKTtuLl9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5zcGxpY2UoYSwxKX10aGlzLl9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5sZW5ndGg9MCx0aGlzLmdldFNjZW5lKCkubGlnaHRzLmZvckVhY2gobj0+e2xldCBhPW4uaW5jbHVkZWRPbmx5TWVzaGVzLmluZGV4T2YodGhpcyk7YSE9PS0xJiZuLmluY2x1ZGVkT25seU1lc2hlcy5zcGxpY2UoYSwxKSxhPW4uZXhjbHVkZWRNZXNoZXMuaW5kZXhPZih0aGlzKSxhIT09LTEmJm4uZXhjbHVkZWRNZXNoZXMuc3BsaWNlKGEsMSk7Y29uc3Qgbz1uLmdldFNoYWRvd0dlbmVyYXRvcnMoKTtpZihvKXtjb25zdCBoPW8udmFsdWVzKCk7Zm9yKGxldCBsPWgubmV4dCgpO2wuZG9uZSE9PSEwO2w9aC5uZXh0KCkpe2NvbnN0IGQ9bC52YWx1ZS5nZXRTaGFkb3dNYXAoKTtkJiZkLnJlbmRlckxpc3QmJihhPWQucmVuZGVyTGlzdC5pbmRleE9mKHRoaXMpLGEhPT0tMSYmZC5yZW5kZXJMaXN0LnNwbGljZShhLDEpKX19fSksKHRoaXMuZ2V0Q2xhc3NOYW1lKCkhPT0iSW5zdGFuY2VkTWVzaCJ8fHRoaXMuZ2V0Q2xhc3NOYW1lKCkhPT0iSW5zdGFuY2VkTGluZXNNZXNoIikmJnRoaXMucmVsZWFzZVN1Yk1lc2hlcygpO2NvbnN0IHI9dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpO2lmKHRoaXMuX29jY2x1c2lvblF1ZXJ5IT09bnVsbCYmKHRoaXMuaXNPY2NsdXNpb25RdWVyeUluUHJvZ3Jlc3M9ITEsci5kZWxldGVRdWVyeSh0aGlzLl9vY2NsdXNpb25RdWVyeSksdGhpcy5fb2NjbHVzaW9uUXVlcnk9bnVsbCksci53aXBlQ2FjaGVzKCksdGhpcy5nZXRTY2VuZSgpLnJlbW92ZU1lc2godGhpcyksdGhpcy5fcGFyZW50Q29udGFpbmVyKXtjb25zdCBuPXRoaXMuX3BhcmVudENvbnRhaW5lci5tZXNoZXMuaW5kZXhPZih0aGlzKTtuPi0xJiZ0aGlzLl9wYXJlbnRDb250YWluZXIubWVzaGVzLnNwbGljZShuLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfWlmKHQmJnRoaXMubWF0ZXJpYWwmJih0aGlzLm1hdGVyaWFsLmdldENsYXNzTmFtZSgpPT09Ik11bHRpTWF0ZXJpYWwiP3RoaXMubWF0ZXJpYWwuZGlzcG9zZSghMSwhMCwhMCk6dGhpcy5tYXRlcmlhbC5kaXNwb3NlKCExLCEwKSksIWUpZm9yKGk9MDtpPHRoaXMuZ2V0U2NlbmUoKS5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO2krKyl0aGlzLmdldFNjZW5lKCkucGFydGljbGVTeXN0ZW1zW2ldLmVtaXR0ZXI9PT10aGlzJiYodGhpcy5nZXRTY2VuZSgpLnBhcnRpY2xlU3lzdGVtc1tpXS5kaXNwb3NlKCksaS0tKTt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9mYWNldERhdGEuZmFjZXREYXRhRW5hYmxlZCYmdGhpcy5kaXNhYmxlRmFjZXREYXRhKCksdGhpcy5fdW5pZm9ybUJ1ZmZlci5kaXNwb3NlKCksdGhpcy5vbkFmdGVyV29ybGRNYXRyaXhVcGRhdGVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNvbGxpZGVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25SZWJ1aWxkT2JzZXJ2YWJsZS5jbGVhcigpLHN1cGVyLmRpc3Bvc2UoZSx0KX1hZGRDaGlsZChlLHQ9ITEpe3JldHVybiBlLnNldFBhcmVudCh0aGlzLHQpLHRoaXN9cmVtb3ZlQ2hpbGQoZSx0PSExKXtyZXR1cm4gZS5zZXRQYXJlbnQobnVsbCx0KSx0aGlzfV9pbml0RmFjZXREYXRhKCl7Y29uc3QgZT10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9mYWNldERhdGE7ZS5mYWNldE5vcm1hbHN8fChlLmZhY2V0Tm9ybWFscz1uZXcgQXJyYXkpLGUuZmFjZXRQb3NpdGlvbnN8fChlLmZhY2V0UG9zaXRpb25zPW5ldyBBcnJheSksZS5mYWNldFBhcnRpdGlvbmluZ3x8KGUuZmFjZXRQYXJ0aXRpb25pbmc9bmV3IEFycmF5KSxlLmZhY2V0TmI9dGhpcy5nZXRJbmRpY2VzKCkubGVuZ3RoLzN8MCxlLnBhcnRpdGlvbmluZ1N1YmRpdmlzaW9ucz1lLnBhcnRpdGlvbmluZ1N1YmRpdmlzaW9ucz9lLnBhcnRpdGlvbmluZ1N1YmRpdmlzaW9uczoxMCxlLnBhcnRpdGlvbmluZ0JCb3hSYXRpbz1lLnBhcnRpdGlvbmluZ0JCb3hSYXRpbz9lLnBhcnRpdGlvbmluZ0JCb3hSYXRpbzoxLjAxO2ZvcihsZXQgdD0wO3Q8ZS5mYWNldE5iO3QrKyllLmZhY2V0Tm9ybWFsc1t0XT1wLlplcm8oKSxlLmZhY2V0UG9zaXRpb25zW3RdPXAuWmVybygpO3JldHVybiBlLmZhY2V0RGF0YUVuYWJsZWQ9ITAsdGhpc311cGRhdGVGYWNldERhdGEoKXtjb25zdCBlPXRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YTtlLmZhY2V0RGF0YUVuYWJsZWR8fHRoaXMuX2luaXRGYWNldERhdGEoKTtjb25zdCB0PXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kKSxpPXRoaXMuZ2V0SW5kaWNlcygpLHM9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kKSxyPXRoaXMuZ2V0Qm91bmRpbmdJbmZvKCk7aWYoZS5mYWNldERlcHRoU29ydCYmIWUuZmFjZXREZXB0aFNvcnRFbmFibGVkKXtpZihlLmZhY2V0RGVwdGhTb3J0RW5hYmxlZD0hMCxpIGluc3RhbmNlb2YgVWludDE2QXJyYXkpZS5kZXB0aFNvcnRlZEluZGljZXM9bmV3IFVpbnQxNkFycmF5KGkpO2Vsc2UgaWYoaSBpbnN0YW5jZW9mIFVpbnQzMkFycmF5KWUuZGVwdGhTb3J0ZWRJbmRpY2VzPW5ldyBVaW50MzJBcnJheShpKTtlbHNle2xldCBhPSExO2ZvcihsZXQgbz0wO288aS5sZW5ndGg7bysrKWlmKGlbb10+NjU1MzUpe2E9ITA7YnJlYWt9YT9lLmRlcHRoU29ydGVkSW5kaWNlcz1uZXcgVWludDMyQXJyYXkoaSk6ZS5kZXB0aFNvcnRlZEluZGljZXM9bmV3IFVpbnQxNkFycmF5KGkpfWlmKGUuZmFjZXREZXB0aFNvcnRGdW5jdGlvbj1mdW5jdGlvbihhLG8pe3JldHVybiBvLnNxRGlzdGFuY2UtYS5zcURpc3RhbmNlfSwhZS5mYWNldERlcHRoU29ydEZyb20pe2NvbnN0IGE9dGhpcy5nZXRTY2VuZSgpLmFjdGl2ZUNhbWVyYTtlLmZhY2V0RGVwdGhTb3J0RnJvbT1hP2EucG9zaXRpb246cC5aZXJvKCl9ZS5kZXB0aFNvcnRlZEZhY2V0cz1bXTtmb3IobGV0IGE9MDthPGUuZmFjZXROYjthKyspe2NvbnN0IG89e2luZDphKjMsc3FEaXN0YW5jZTowfTtlLmRlcHRoU29ydGVkRmFjZXRzLnB1c2gobyl9ZS5pbnZlcnRlZE1hdHJpeD14LklkZW50aXR5KCksZS5mYWNldERlcHRoU29ydE9yaWdpbj1wLlplcm8oKX1lLmJiU2l6ZS54PXIubWF4aW11bS54LXIubWluaW11bS54PnhlP3IubWF4aW11bS54LXIubWluaW11bS54OnhlLGUuYmJTaXplLnk9ci5tYXhpbXVtLnktci5taW5pbXVtLnk+eGU/ci5tYXhpbXVtLnktci5taW5pbXVtLnk6eGUsZS5iYlNpemUuej1yLm1heGltdW0uei1yLm1pbmltdW0uej54ZT9yLm1heGltdW0uei1yLm1pbmltdW0uejp4ZTtsZXQgbj1lLmJiU2l6ZS54PmUuYmJTaXplLnk/ZS5iYlNpemUueDplLmJiU2l6ZS55O2lmKG49bj5lLmJiU2l6ZS56P246ZS5iYlNpemUueixlLnN1YkRpdi5tYXg9ZS5wYXJ0aXRpb25pbmdTdWJkaXZpc2lvbnMsZS5zdWJEaXYuWD1NYXRoLmZsb29yKGUuc3ViRGl2Lm1heCplLmJiU2l6ZS54L24pLGUuc3ViRGl2Llk9TWF0aC5mbG9vcihlLnN1YkRpdi5tYXgqZS5iYlNpemUueS9uKSxlLnN1YkRpdi5aPU1hdGguZmxvb3IoZS5zdWJEaXYubWF4KmUuYmJTaXplLnovbiksZS5zdWJEaXYuWD1lLnN1YkRpdi5YPDE/MTplLnN1YkRpdi5YLGUuc3ViRGl2Llk9ZS5zdWJEaXYuWTwxPzE6ZS5zdWJEaXYuWSxlLnN1YkRpdi5aPWUuc3ViRGl2Llo8MT8xOmUuc3ViRGl2LlosZS5mYWNldFBhcmFtZXRlcnMuZmFjZXROb3JtYWxzPXRoaXMuZ2V0RmFjZXRMb2NhbE5vcm1hbHMoKSxlLmZhY2V0UGFyYW1ldGVycy5mYWNldFBvc2l0aW9ucz10aGlzLmdldEZhY2V0TG9jYWxQb3NpdGlvbnMoKSxlLmZhY2V0UGFyYW1ldGVycy5mYWNldFBhcnRpdGlvbmluZz10aGlzLmdldEZhY2V0TG9jYWxQYXJ0aXRpb25pbmcoKSxlLmZhY2V0UGFyYW1ldGVycy5iSW5mbz1yLGUuZmFjZXRQYXJhbWV0ZXJzLmJiU2l6ZT1lLmJiU2l6ZSxlLmZhY2V0UGFyYW1ldGVycy5zdWJEaXY9ZS5zdWJEaXYsZS5mYWNldFBhcmFtZXRlcnMucmF0aW89dGhpcy5wYXJ0aXRpb25pbmdCQm94UmF0aW8sZS5mYWNldFBhcmFtZXRlcnMuZGVwdGhTb3J0PWUuZmFjZXREZXB0aFNvcnQsZS5mYWNldERlcHRoU29ydCYmZS5mYWNldERlcHRoU29ydEVuYWJsZWQmJih0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCghMCksdGhpcy5fd29ybGRNYXRyaXguaW52ZXJ0VG9SZWYoZS5pbnZlcnRlZE1hdHJpeCkscC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGUuZmFjZXREZXB0aFNvcnRGcm9tLGUuaW52ZXJ0ZWRNYXRyaXgsZS5mYWNldERlcHRoU29ydE9yaWdpbiksZS5mYWNldFBhcmFtZXRlcnMuZGlzdGFuY2VUbz1lLmZhY2V0RGVwdGhTb3J0T3JpZ2luKSxlLmZhY2V0UGFyYW1ldGVycy5kZXB0aFNvcnRlZEZhY2V0cz1lLmRlcHRoU29ydGVkRmFjZXRzLHMmJmVlLkNvbXB1dGVOb3JtYWxzKHQsaSxzLGUuZmFjZXRQYXJhbWV0ZXJzKSxlLmZhY2V0RGVwdGhTb3J0JiZlLmZhY2V0RGVwdGhTb3J0RW5hYmxlZCl7ZS5kZXB0aFNvcnRlZEZhY2V0cy5zb3J0KGUuZmFjZXREZXB0aFNvcnRGdW5jdGlvbik7Y29uc3QgYT1lLmRlcHRoU29ydGVkSW5kaWNlcy5sZW5ndGgvM3wwO2ZvcihsZXQgbz0wO288YTtvKyspe2NvbnN0IGg9ZS5kZXB0aFNvcnRlZEZhY2V0c1tvXS5pbmQ7ZS5kZXB0aFNvcnRlZEluZGljZXNbbyozXT1pW2hdLGUuZGVwdGhTb3J0ZWRJbmRpY2VzW28qMysxXT1pW2grMV0sZS5kZXB0aFNvcnRlZEluZGljZXNbbyozKzJdPWlbaCsyXX10aGlzLnVwZGF0ZUluZGljZXMoZS5kZXB0aFNvcnRlZEluZGljZXMsdm9pZCAwLCEwKX1yZXR1cm4gdGhpc31nZXRGYWNldExvY2FsTm9ybWFscygpe2NvbnN0IGU9dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZmFjZXREYXRhO3JldHVybiBlLmZhY2V0Tm9ybWFsc3x8dGhpcy51cGRhdGVGYWNldERhdGEoKSxlLmZhY2V0Tm9ybWFsc31nZXRGYWNldExvY2FsUG9zaXRpb25zKCl7Y29uc3QgZT10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9mYWNldERhdGE7cmV0dXJuIGUuZmFjZXRQb3NpdGlvbnN8fHRoaXMudXBkYXRlRmFjZXREYXRhKCksZS5mYWNldFBvc2l0aW9uc31nZXRGYWNldExvY2FsUGFydGl0aW9uaW5nKCl7Y29uc3QgZT10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9mYWNldERhdGE7cmV0dXJuIGUuZmFjZXRQYXJ0aXRpb25pbmd8fHRoaXMudXBkYXRlRmFjZXREYXRhKCksZS5mYWNldFBhcnRpdGlvbmluZ31nZXRGYWNldFBvc2l0aW9uKGUpe2NvbnN0IHQ9cC5aZXJvKCk7cmV0dXJuIHRoaXMuZ2V0RmFjZXRQb3NpdGlvblRvUmVmKGUsdCksdH1nZXRGYWNldFBvc2l0aW9uVG9SZWYoZSx0KXtjb25zdCBpPXRoaXMuZ2V0RmFjZXRMb2NhbFBvc2l0aW9ucygpW2VdLHM9dGhpcy5nZXRXb3JsZE1hdHJpeCgpO3JldHVybiBwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYoaSxzLHQpLHRoaXN9Z2V0RmFjZXROb3JtYWwoZSl7Y29uc3QgdD1wLlplcm8oKTtyZXR1cm4gdGhpcy5nZXRGYWNldE5vcm1hbFRvUmVmKGUsdCksdH1nZXRGYWNldE5vcm1hbFRvUmVmKGUsdCl7Y29uc3QgaT10aGlzLmdldEZhY2V0TG9jYWxOb3JtYWxzKClbZV07cmV0dXJuIHAuVHJhbnNmb3JtTm9ybWFsVG9SZWYoaSx0aGlzLmdldFdvcmxkTWF0cml4KCksdCksdGhpc31nZXRGYWNldHNBdExvY2FsQ29vcmRpbmF0ZXMoZSx0LGkpe2NvbnN0IHM9dGhpcy5nZXRCb3VuZGluZ0luZm8oKSxyPXRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YSxuPU1hdGguZmxvb3IoKGUtcy5taW5pbXVtLngqci5wYXJ0aXRpb25pbmdCQm94UmF0aW8pKnIuc3ViRGl2Llgqci5wYXJ0aXRpb25pbmdCQm94UmF0aW8vci5iYlNpemUueCksYT1NYXRoLmZsb29yKCh0LXMubWluaW11bS55KnIucGFydGl0aW9uaW5nQkJveFJhdGlvKSpyLnN1YkRpdi5ZKnIucGFydGl0aW9uaW5nQkJveFJhdGlvL3IuYmJTaXplLnkpLG89TWF0aC5mbG9vcigoaS1zLm1pbmltdW0ueipyLnBhcnRpdGlvbmluZ0JCb3hSYXRpbykqci5zdWJEaXYuWipyLnBhcnRpdGlvbmluZ0JCb3hSYXRpby9yLmJiU2l6ZS56KTtyZXR1cm4gbjwwfHxuPnIuc3ViRGl2Lm1heHx8YTwwfHxhPnIuc3ViRGl2Lm1heHx8bzwwfHxvPnIuc3ViRGl2Lm1heD9udWxsOnIuZmFjZXRQYXJ0aXRpb25pbmdbbityLnN1YkRpdi5tYXgqYStyLnN1YkRpdi5tYXgqci5zdWJEaXYubWF4Km9dfWdldENsb3Nlc3RGYWNldEF0Q29vcmRpbmF0ZXMoZSx0LGkscyxyPSExLG49ITApe2NvbnN0IGE9dGhpcy5nZXRXb3JsZE1hdHJpeCgpLG89RC5NYXRyaXhbNV07YS5pbnZlcnRUb1JlZihvKTtjb25zdCBoPUQuVmVjdG9yM1s4XTtwLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGUsdCxpLG8saCk7Y29uc3QgbD10aGlzLmdldENsb3Nlc3RGYWNldEF0TG9jYWxDb29yZGluYXRlcyhoLngsaC55LGgueixzLHIsbik7cmV0dXJuIHMmJnAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNGcm9tRmxvYXRzVG9SZWYocy54LHMueSxzLnosYSxzKSxsfWdldENsb3Nlc3RGYWNldEF0TG9jYWxDb29yZGluYXRlcyhlLHQsaSxzLHI9ITEsbj0hMCl7bGV0IGE9bnVsbCxvPTAsaD0wLGw9MCx1PTAsZD0wLGY9MCxfPTAsRT0wO2NvbnN0IG09dGhpcy5nZXRGYWNldExvY2FsUG9zaXRpb25zKCksdj10aGlzLmdldEZhY2V0TG9jYWxOb3JtYWxzKCksUz10aGlzLmdldEZhY2V0c0F0TG9jYWxDb29yZGluYXRlcyhlLHQsaSk7aWYoIVMpcmV0dXJuIG51bGw7bGV0IHk9TnVtYmVyLk1BWF9WQUxVRSxBPXksQyxiLE07Zm9yKGxldCBMPTA7TDxTLmxlbmd0aDtMKyspQz1TW0xdLGI9dltDXSxNPW1bQ10sdT0oZS1NLngpKmIueCsodC1NLnkpKmIueSsoaS1NLnopKmIueiwoIXJ8fHImJm4mJnU+PTB8fHImJiFuJiZ1PD0wKSYmKHU9Yi54Kk0ueCtiLnkqTS55K2IueipNLnosZD0tKGIueCplK2IueSp0K2IueippLXUpLyhiLngqYi54K2IueSpiLnkrYi56KmIueiksZj1lK2IueCpkLF89dCtiLnkqZCxFPWkrYi56KmQsbz1mLWUsaD1fLXQsbD1FLWksQT1vKm8raCpoK2wqbCxBPHkmJih5PUEsYT1DLHMmJihzLng9ZixzLnk9XyxzLno9RSkpKTtyZXR1cm4gYX1nZXRGYWNldERhdGFQYXJhbWV0ZXJzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5mYWNldFBhcmFtZXRlcnN9ZGlzYWJsZUZhY2V0RGF0YSgpe2NvbnN0IGU9dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZmFjZXREYXRhO3JldHVybiBlLmZhY2V0RGF0YUVuYWJsZWQmJihlLmZhY2V0RGF0YUVuYWJsZWQ9ITEsZS5mYWNldFBvc2l0aW9ucz1uZXcgQXJyYXksZS5mYWNldE5vcm1hbHM9bmV3IEFycmF5LGUuZmFjZXRQYXJ0aXRpb25pbmc9bmV3IEFycmF5LGUuZmFjZXRQYXJhbWV0ZXJzPW51bGwsZS5kZXB0aFNvcnRlZEluZGljZXM9bmV3IFVpbnQzMkFycmF5KDApKSx0aGlzfXVwZGF0ZUluZGljZXMoZSx0LGk9ITEpe3JldHVybiB0aGlzfWNyZWF0ZU5vcm1hbHMoZSl7Y29uc3QgdD10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCksaT10aGlzLmdldEluZGljZXMoKTtsZXQgcztyZXR1cm4gdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Ob3JtYWxLaW5kKT9zPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCk6cz1bXSxlZS5Db21wdXRlTm9ybWFscyh0LGkscyx7dXNlUmlnaHRIYW5kZWRTeXN0ZW06dGhpcy5nZXRTY2VuZSgpLnVzZVJpZ2h0SGFuZGVkU3lzdGVtfSksdGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kLHMsZSksdGhpc31hbGlnbldpdGhOb3JtYWwoZSx0KXt0fHwodD1faS5ZKTtjb25zdCBpPUQuVmVjdG9yM1swXSxzPUQuVmVjdG9yM1sxXTtyZXR1cm4gcC5Dcm9zc1RvUmVmKHQsZSxzKSxwLkNyb3NzVG9SZWYoZSxzLGkpLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uP1ouUm90YXRpb25RdWF0ZXJuaW9uRnJvbUF4aXNUb1JlZihpLGUscyx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbik6cC5Sb3RhdGlvbkZyb21BeGlzVG9SZWYoaSxlLHMsdGhpcy5yb3RhdGlvbiksdGhpc31fY2hlY2tPY2NsdXNpb25RdWVyeSgpe3JldHVybiExfWRpc2FibGVFZGdlc1JlbmRlcmluZygpe3Rocm93ICQoIkVkZ2VzUmVuZGVyZXIiKX1lbmFibGVFZGdlc1JlbmRlcmluZyhlLHQsaSl7dGhyb3cgJCgiRWRnZXNSZW5kZXJlciIpfWdldENvbm5lY3RlZFBhcnRpY2xlU3lzdGVtcygpe3JldHVybiB0aGlzLl9zY2VuZS5wYXJ0aWNsZVN5c3RlbXMuZmlsdGVyKGU9PmUuZW1pdHRlcj09PXRoaXMpfX1vdC5PQ0NMVVNJT05fVFlQRV9OT05FPTAsb3QuT0NDTFVTSU9OX1RZUEVfT1BUSU1JU1RJQz0xLG90Lk9DQ0xVU0lPTl9UWVBFX1NUUklDVD0yLG90Lk9DQ0xVU0lPTl9BTEdPUklUSE1fVFlQRV9BQ0NVUkFURT0wLG90Lk9DQ0xVU0lPTl9BTEdPUklUSE1fVFlQRV9DT05TRVJWQVRJVkU9MSxvdC5DVUxMSU5HU1RSQVRFR1lfU1RBTkRBUkQ9MCxvdC5DVUxMSU5HU1RSQVRFR1lfQk9VTkRJTkdTUEhFUkVfT05MWT0xLG90LkNVTExJTkdTVFJBVEVHWV9PUFRJTUlTVElDX0lOQ0xVU0lPTj0yLG90LkNVTExJTkdTVFJBVEVHWV9PUFRJTUlTVElDX0lOQ0xVU0lPTl9USEVOX0JTUEhFUkVfT05MWT0zLGl0KCJCQUJZTE9OLkFic3RyYWN0TWVzaCIsb3QpO2Z1bmN0aW9uIHNzKGMpe2MuaW5kZXhPZigidkNsaXBQbGFuZSIpPT09LTEmJmMucHVzaCgidkNsaXBQbGFuZSIpLGMuaW5kZXhPZigidkNsaXBQbGFuZTIiKT09PS0xJiZjLnB1c2goInZDbGlwUGxhbmUyIiksYy5pbmRleE9mKCJ2Q2xpcFBsYW5lMyIpPT09LTEmJmMucHVzaCgidkNsaXBQbGFuZTMiKSxjLmluZGV4T2YoInZDbGlwUGxhbmU0Iik9PT0tMSYmYy5wdXNoKCJ2Q2xpcFBsYW5lNCIpLGMuaW5kZXhPZigidkNsaXBQbGFuZTUiKT09PS0xJiZjLnB1c2goInZDbGlwUGxhbmU1IiksYy5pbmRleE9mKCJ2Q2xpcFBsYW5lNiIpPT09LTEmJmMucHVzaCgidkNsaXBQbGFuZTYiKX1mdW5jdGlvbiBPcyhjLGUsdCl7dmFyIGkscyxyLG4sYSxvO2xldCBoPSExLGw9KGk9Yy5jbGlwUGxhbmUpIT09bnVsbCYmaSE9PXZvaWQgMD9pOmUuY2xpcFBsYW5lO3JldHVybiBoPWJpKGwsdCwiQ0xJUFBMQU5FIil8fGgsbD0ocz1jLmNsaXBQbGFuZTIpIT09bnVsbCYmcyE9PXZvaWQgMD9zOmUuY2xpcFBsYW5lMixoPWJpKGwsdCwiQ0xJUFBMQU5FMiIpfHxoLGw9KHI9Yy5jbGlwUGxhbmUzKSE9PW51bGwmJnIhPT12b2lkIDA/cjplLmNsaXBQbGFuZTMsaD1iaShsLHQsIkNMSVBQTEFORTMiKXx8aCxsPShuPWMuY2xpcFBsYW5lNCkhPT1udWxsJiZuIT09dm9pZCAwP246ZS5jbGlwUGxhbmU0LGg9YmkobCx0LCJDTElQUExBTkU0Iil8fGgsbD0oYT1jLmNsaXBQbGFuZTUpIT09bnVsbCYmYSE9PXZvaWQgMD9hOmUuY2xpcFBsYW5lNSxoPWJpKGwsdCwiQ0xJUFBMQU5FNSIpfHxoLGw9KG89Yy5jbGlwUGxhbmU2KSE9PW51bGwmJm8hPT12b2lkIDA/bzplLmNsaXBQbGFuZTYsaD1iaShsLHQsIkNMSVBQTEFORTYiKXx8aCxofWZ1bmN0aW9uIHJzKGMsZSx0KXt2YXIgaSxzLHIsbixhLG87bGV0IGg9KGk9ZS5jbGlwUGxhbmUpIT09bnVsbCYmaSE9PXZvaWQgMD9pOnQuY2xpcFBsYW5lO1RpKGMsInZDbGlwUGxhbmUiLGgpLGg9KHM9ZS5jbGlwUGxhbmUyKSE9PW51bGwmJnMhPT12b2lkIDA/czp0LmNsaXBQbGFuZTIsVGkoYywidkNsaXBQbGFuZTIiLGgpLGg9KHI9ZS5jbGlwUGxhbmUzKSE9PW51bGwmJnIhPT12b2lkIDA/cjp0LmNsaXBQbGFuZTMsVGkoYywidkNsaXBQbGFuZTMiLGgpLGg9KG49ZS5jbGlwUGxhbmU0KSE9PW51bGwmJm4hPT12b2lkIDA/bjp0LmNsaXBQbGFuZTQsVGkoYywidkNsaXBQbGFuZTQiLGgpLGg9KGE9ZS5jbGlwUGxhbmU1KSE9PW51bGwmJmEhPT12b2lkIDA/YTp0LmNsaXBQbGFuZTUsVGkoYywidkNsaXBQbGFuZTUiLGgpLGg9KG89ZS5jbGlwUGxhbmU2KSE9PW51bGwmJm8hPT12b2lkIDA/bzp0LmNsaXBQbGFuZTYsVGkoYywidkNsaXBQbGFuZTYiLGgpfWZ1bmN0aW9uIFRpKGMsZSx0KXt0JiZjLnNldEZsb2F0NChlLHQubm9ybWFsLngsdC5ub3JtYWwueSx0Lm5vcm1hbC56LHQuZCl9ZnVuY3Rpb24gYmkoYyxlLHQpe2xldCBpPSEwO2lmKGMpaWYoQXJyYXkuaXNBcnJheShlKSl7Y29uc3Qgcz0iI2RlZmluZSAiK3Q7aT1lLmluZGV4T2YocykhPT0tMSxpfHxlLnB1c2gocyl9ZWxzZSBpPWVbdF0sZVt0XT0hMDtyZXR1cm4haX1jbGFzcyBpZXtzdGF0aWMgQmluZFNjZW5lVW5pZm9ybUJ1ZmZlcihlLHQpe3QuYmluZFRvRWZmZWN0KGUsIlNjZW5lIil9c3RhdGljIFByZXBhcmVEZWZpbmVzRm9yTWVyZ2VkVVYoZSx0LGkpe3QuX25lZWRVVnM9ITAsdFtpXT0hMCxlLm9wdGltaXplVVZBbGxvY2F0aW9uJiZlLmdldFRleHR1cmVNYXRyaXgoKS5pc0lkZW50aXR5QXMzeDIoKT8odFtpKyJESVJFQ1RVViJdPWUuY29vcmRpbmF0ZXNJbmRleCsxLHRbIk1BSU5VViIrKGUuY29vcmRpbmF0ZXNJbmRleCsxKV09ITApOnRbaSsiRElSRUNUVVYiXT0wfXN0YXRpYyBCaW5kVGV4dHVyZU1hdHJpeChlLHQsaSl7Y29uc3Qgcz1lLmdldFRleHR1cmVNYXRyaXgoKTt0LnVwZGF0ZU1hdHJpeChpKyJNYXRyaXgiLHMpfXN0YXRpYyBHZXRGb2dTdGF0ZShlLHQpe3JldHVybiB0LmZvZ0VuYWJsZWQmJmUuYXBwbHlGb2cmJnQuZm9nTW9kZSE9PW5lLkZPR01PREVfTk9ORX1zdGF0aWMgUHJlcGFyZURlZmluZXNGb3JNaXNjKGUsdCxpLHMscixuLGEpe2EuX2FyZU1pc2NEaXJ0eSYmKGEuTE9HQVJJVEhNSUNERVBUSD1pLGEuUE9JTlRTSVpFPXMsYS5GT0c9ciYmdGhpcy5HZXRGb2dTdGF0ZShlLHQpLGEuTk9OVU5JRk9STVNDQUxJTkc9ZS5ub25Vbmlmb3JtU2NhbGluZyxhLkFMUEhBVEVTVD1uKX1zdGF0aWMgUHJlcGFyZURlZmluZXNGb3JDYW1lcmEoZSx0KXtsZXQgaT0hMTtpZihlLmFjdGl2ZUNhbWVyYSl7Y29uc3Qgcz10LkNBTUVSQV9PUlRIT0dSQVBISUM/MTowLHI9dC5DQU1FUkFfUEVSU1BFQ1RJVkU/MTowLG49ZS5hY3RpdmVDYW1lcmEubW9kZT09PWouT1JUSE9HUkFQSElDX0NBTUVSQT8xOjAsYT1lLmFjdGl2ZUNhbWVyYS5tb2RlPT09ai5QRVJTUEVDVElWRV9DQU1FUkE/MTowOyhzXm58fHJeYSkmJih0LkNBTUVSQV9PUlRIT0dSQVBISUM9bj09PTEsdC5DQU1FUkFfUEVSU1BFQ1RJVkU9YT09PTEsaT0hMCl9cmV0dXJuIGl9c3RhdGljIFByZXBhcmVEZWZpbmVzRm9yRnJhbWVCb3VuZFZhbHVlcyhlLHQsaSxzLHIsbj1udWxsLGE9ITEpe2xldCBvPWllLlByZXBhcmVEZWZpbmVzRm9yQ2FtZXJhKGUscyk7biE9PSExJiYobz1PcyhpLGUscykpLHMuREVQVEhQUkVQQVNTIT09IXQuZ2V0Q29sb3JXcml0ZSgpJiYocy5ERVBUSFBSRVBBU1M9IXMuREVQVEhQUkVQQVNTLG89ITApLHMuSU5TVEFOQ0VTIT09ciYmKHMuSU5TVEFOQ0VTPXIsbz0hMCkscy5USElOX0lOU1RBTkNFUyE9PWEmJihzLlRISU5fSU5TVEFOQ0VTPWEsbz0hMCksbyYmcy5tYXJrQXNVbnByb2Nlc3NlZCgpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0ZvckJvbmVzKGUsdCl7aWYoZS51c2VCb25lcyYmZS5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJmUuc2tlbGV0b24pe3QuTlVNX0JPTkVfSU5GTFVFTkNFUlM9ZS5udW1Cb25lSW5mbHVlbmNlcnM7Y29uc3QgaT10LkJPTkVURVhUVVJFIT09dm9pZCAwO2lmKGUuc2tlbGV0b24uaXNVc2luZ1RleHR1cmVGb3JNYXRyaWNlcyYmaSl0LkJPTkVURVhUVVJFPSEwO2Vsc2V7dC5Cb25lc1Blck1lc2g9ZS5za2VsZXRvbi5ib25lcy5sZW5ndGgrMSx0LkJPTkVURVhUVVJFPWk/ITE6dm9pZCAwO2NvbnN0IHM9ZS5nZXRTY2VuZSgpLnByZVBhc3NSZW5kZXJlcjtpZihzJiZzLmVuYWJsZWQpe2NvbnN0IHI9cy5leGNsdWRlZFNraW5uZWRNZXNoLmluZGV4T2YoZSk9PT0tMTt0LkJPTkVTX1ZFTE9DSVRZX0VOQUJMRUQ9cn19fWVsc2UgdC5OVU1fQk9ORV9JTkZMVUVOQ0VSUz0wLHQuQm9uZXNQZXJNZXNoPTAsdC5CT05FVEVYVFVSRSE9PXZvaWQgMCYmKHQuQk9ORVRFWFRVUkU9ITEpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0Zvck1vcnBoVGFyZ2V0cyhlLHQpe2NvbnN0IGk9ZS5tb3JwaFRhcmdldE1hbmFnZXI7aT8odC5NT1JQSFRBUkdFVFNfVVY9aS5zdXBwb3J0c1VWcyYmdC5VVjEsdC5NT1JQSFRBUkdFVFNfVEFOR0VOVD1pLnN1cHBvcnRzVGFuZ2VudHMmJnQuVEFOR0VOVCx0Lk1PUlBIVEFSR0VUU19OT1JNQUw9aS5zdXBwb3J0c05vcm1hbHMmJnQuTk9STUFMLHQuTU9SUEhUQVJHRVRTPWkubnVtSW5mbHVlbmNlcnM+MCx0Lk5VTV9NT1JQSF9JTkZMVUVOQ0VSUz1pLm51bUluZmx1ZW5jZXJzLHQuTU9SUEhUQVJHRVRTX1RFWFRVUkU9aS5pc1VzaW5nVGV4dHVyZUZvclRhcmdldHMpOih0Lk1PUlBIVEFSR0VUU19VVj0hMSx0Lk1PUlBIVEFSR0VUU19UQU5HRU5UPSExLHQuTU9SUEhUQVJHRVRTX05PUk1BTD0hMSx0Lk1PUlBIVEFSR0VUUz0hMSx0Lk5VTV9NT1JQSF9JTkZMVUVOQ0VSUz0wKX1zdGF0aWMgUHJlcGFyZURlZmluZXNGb3JCYWtlZFZlcnRleEFuaW1hdGlvbihlLHQpe2NvbnN0IGk9ZS5iYWtlZFZlcnRleEFuaW1hdGlvbk1hbmFnZXI7dC5CQUtFRF9WRVJURVhfQU5JTUFUSU9OX1RFWFRVUkU9ISEoaSYmaS5pc0VuYWJsZWQpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0ZvckF0dHJpYnV0ZXMoZSx0LGkscyxyPSExLG49ITAsYT0hMCl7aWYoIXQuX2FyZUF0dHJpYnV0ZXNEaXJ0eSYmdC5fbmVlZE5vcm1hbHM9PT10Ll9ub3JtYWxzJiZ0Ll9uZWVkVVZzPT09dC5fdXZzKXJldHVybiExO3QuX25vcm1hbHM9dC5fbmVlZE5vcm1hbHMsdC5fdXZzPXQuX25lZWRVVnMsdC5OT1JNQUw9dC5fbmVlZE5vcm1hbHMmJmUuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTm9ybWFsS2luZCksdC5fbmVlZE5vcm1hbHMmJmUuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuVGFuZ2VudEtpbmQpJiYodC5UQU5HRU5UPSEwKTtmb3IobGV0IG89MTtvPD02Oysrbyl0WyJVViIrb109dC5fbmVlZFVWcz9lLmlzVmVydGljZXNEYXRhUHJlc2VudChgdXYke289PT0xPyIiOm99YCk6ITE7aWYoaSl7Y29uc3Qgbz1lLnVzZVZlcnRleENvbG9ycyYmZS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Db2xvcktpbmQpO3QuVkVSVEVYQ09MT1I9byx0LlZFUlRFWEFMUEhBPWUuaGFzVmVydGV4QWxwaGEmJm8mJm59cmV0dXJuIGUuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuQ29sb3JJbnN0YW5jZUtpbmQpJiYoZS5oYXNJbnN0YW5jZXN8fGUuaGFzVGhpbkluc3RhbmNlcykmJih0LklOU1RBTkNFU0NPTE9SPSEwKSxzJiZ0aGlzLlByZXBhcmVEZWZpbmVzRm9yQm9uZXMoZSx0KSxyJiZ0aGlzLlByZXBhcmVEZWZpbmVzRm9yTW9ycGhUYXJnZXRzKGUsdCksYSYmdGhpcy5QcmVwYXJlRGVmaW5lc0ZvckJha2VkVmVydGV4QW5pbWF0aW9uKGUsdCksITB9c3RhdGljIFByZXBhcmVEZWZpbmVzRm9yTXVsdGl2aWV3KGUsdCl7aWYoZS5hY3RpdmVDYW1lcmEpe2NvbnN0IGk9dC5NVUxUSVZJRVc7dC5NVUxUSVZJRVc9ZS5hY3RpdmVDYW1lcmEub3V0cHV0UmVuZGVyVGFyZ2V0IT09bnVsbCYmZS5hY3RpdmVDYW1lcmEub3V0cHV0UmVuZGVyVGFyZ2V0LmdldFZpZXdDb3VudCgpPjEsdC5NVUxUSVZJRVchPWkmJnQubWFya0FzVW5wcm9jZXNzZWQoKX19c3RhdGljIFByZXBhcmVEZWZpbmVzRm9yT0lUKGUsdCxpKXtjb25zdCBzPXQuT1JERVJfSU5ERVBFTkRFTlRfVFJBTlNQQVJFTkNZLHI9dC5PUkRFUl9JTkRFUEVOREVOVF9UUkFOU1BBUkVOQ1lfMTZCSVRTO3QuT1JERVJfSU5ERVBFTkRFTlRfVFJBTlNQQVJFTkNZPWUudXNlT3JkZXJJbmRlcGVuZGVudFRyYW5zcGFyZW5jeSYmaSx0Lk9SREVSX0lOREVQRU5ERU5UX1RSQU5TUEFSRU5DWV8xNkJJVFM9IWUuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLnRleHR1cmVGbG9hdExpbmVhckZpbHRlcmluZywocyE9PXQuT1JERVJfSU5ERVBFTkRFTlRfVFJBTlNQQVJFTkNZfHxyIT09dC5PUkRFUl9JTkRFUEVOREVOVF9UUkFOU1BBUkVOQ1lfMTZCSVRTKSYmdC5tYXJrQXNVbnByb2Nlc3NlZCgpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0ZvclByZVBhc3MoZSx0LGkpe2NvbnN0IHM9dC5QUkVQQVNTO2lmKCF0Ll9hcmVQcmVQYXNzRGlydHkpcmV0dXJuO2NvbnN0IHI9W3t0eXBlOjEsZGVmaW5lOiJQUkVQQVNTX1BPU0lUSU9OIixpbmRleDoiUFJFUEFTU19QT1NJVElPTl9JTkRFWCJ9LHt0eXBlOjIsZGVmaW5lOiJQUkVQQVNTX1ZFTE9DSVRZIixpbmRleDoiUFJFUEFTU19WRUxPQ0lUWV9JTkRFWCJ9LHt0eXBlOjMsZGVmaW5lOiJQUkVQQVNTX1JFRkxFQ1RJVklUWSIsaW5kZXg6IlBSRVBBU1NfUkVGTEVDVElWSVRZX0lOREVYIn0se3R5cGU6MCxkZWZpbmU6IlBSRVBBU1NfSVJSQURJQU5DRSIsaW5kZXg6IlBSRVBBU1NfSVJSQURJQU5DRV9JTkRFWCJ9LHt0eXBlOjcsZGVmaW5lOiJQUkVQQVNTX0FMQkVET19TUVJUIixpbmRleDoiUFJFUEFTU19BTEJFRE9fU1FSVF9JTkRFWCJ9LHt0eXBlOjUsZGVmaW5lOiJQUkVQQVNTX0RFUFRIIixpbmRleDoiUFJFUEFTU19ERVBUSF9JTkRFWCJ9LHt0eXBlOjYsZGVmaW5lOiJQUkVQQVNTX05PUk1BTCIsaW5kZXg6IlBSRVBBU1NfTk9STUFMX0lOREVYIn1dO2lmKGUucHJlUGFzc1JlbmRlcmVyJiZlLnByZVBhc3NSZW5kZXJlci5lbmFibGVkJiZpKXt0LlBSRVBBU1M9ITAsdC5TQ0VORV9NUlRfQ09VTlQ9ZS5wcmVQYXNzUmVuZGVyZXIubXJ0Q291bnQ7Zm9yKGxldCBuPTA7bjxyLmxlbmd0aDtuKyspe2NvbnN0IGE9ZS5wcmVQYXNzUmVuZGVyZXIuZ2V0SW5kZXgocltuXS50eXBlKTthIT09LTE/KHRbcltuXS5kZWZpbmVdPSEwLHRbcltuXS5pbmRleF09YSk6dFtyW25dLmRlZmluZV09ITF9fWVsc2V7dC5QUkVQQVNTPSExO2ZvcihsZXQgbj0wO248ci5sZW5ndGg7bisrKXRbcltuXS5kZWZpbmVdPSExfXQuUFJFUEFTUyE9cyYmKHQubWFya0FzVW5wcm9jZXNzZWQoKSx0Lm1hcmtBc0ltYWdlUHJvY2Vzc2luZ0RpcnR5KCkpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0ZvckxpZ2h0KGUsdCxpLHMscixuLGEpe3ZhciBvO3N3aXRjaChhLm5lZWROb3JtYWxzPSEwLHJbIkxJR0hUIitzXT09PXZvaWQgMCYmKGEubmVlZFJlYnVpbGQ9ITApLHJbIkxJR0hUIitzXT0hMCxyWyJTUE9UTElHSFQiK3NdPSExLHJbIkhFTUlMSUdIVCIrc109ITEsclsiUE9JTlRMSUdIVCIrc109ITEsclsiRElSTElHSFQiK3NdPSExLGkucHJlcGFyZUxpZ2h0U3BlY2lmaWNEZWZpbmVzKHIscyksclsiTElHSFRfRkFMTE9GRl9QSFlTSUNBTCIrc109ITEsclsiTElHSFRfRkFMTE9GRl9HTFRGIitzXT0hMSxyWyJMSUdIVF9GQUxMT0ZGX1NUQU5EQVJEIitzXT0hMSxpLmZhbGxvZmZUeXBlKXtjYXNlIEVlLkZBTExPRkZfR0xURjpyWyJMSUdIVF9GQUxMT0ZGX0dMVEYiK3NdPSEwO2JyZWFrO2Nhc2UgRWUuRkFMTE9GRl9QSFlTSUNBTDpyWyJMSUdIVF9GQUxMT0ZGX1BIWVNJQ0FMIitzXT0hMDticmVhaztjYXNlIEVlLkZBTExPRkZfU1RBTkRBUkQ6clsiTElHSFRfRkFMTE9GRl9TVEFOREFSRCIrc109ITA7YnJlYWt9aWYobiYmIWkuc3BlY3VsYXIuZXF1YWxzRmxvYXRzKDAsMCwwKSYmKGEuc3BlY3VsYXJFbmFibGVkPSEwKSxyWyJTSEFET1ciK3NdPSExLHJbIlNIQURPV0NTTSIrc109ITEsclsiU0hBRE9XQ1NNREVCVUciK3NdPSExLHJbIlNIQURPV0NTTU5VTV9DQVNDQURFUyIrc109ITEsclsiU0hBRE9XQ1NNVVNFU0hBRE9XTUFYWiIrc109ITEsclsiU0hBRE9XQ1NNTk9CTEVORCIrc109ITEsclsiU0hBRE9XQ1NNX1JJR0hUSEFOREVEIitzXT0hMSxyWyJTSEFET1dQQ0YiK3NdPSExLHJbIlNIQURPV1BDU1MiK3NdPSExLHJbIlNIQURPV1BPSVNTT04iK3NdPSExLHJbIlNIQURPV0VTTSIrc109ITEsclsiU0hBRE9XQ0xPU0VFU00iK3NdPSExLHJbIlNIQURPV0NVQkUiK3NdPSExLHJbIlNIQURPV0xPV1FVQUxJVFkiK3NdPSExLHJbIlNIQURPV01FRElVTVFVQUxJVFkiK3NdPSExLHQmJnQucmVjZWl2ZVNoYWRvd3MmJmUuc2hhZG93c0VuYWJsZWQmJmkuc2hhZG93RW5hYmxlZCl7Y29uc3QgaD0obz1pLmdldFNoYWRvd0dlbmVyYXRvcihlLmFjdGl2ZUNhbWVyYSkpIT09bnVsbCYmbyE9PXZvaWQgMD9vOmkuZ2V0U2hhZG93R2VuZXJhdG9yKCk7aWYoaCl7Y29uc3QgbD1oLmdldFNoYWRvd01hcCgpO2wmJmwucmVuZGVyTGlzdCYmbC5yZW5kZXJMaXN0Lmxlbmd0aD4wJiYoYS5zaGFkb3dFbmFibGVkPSEwLGgucHJlcGFyZURlZmluZXMocixzKSl9fWkubGlnaHRtYXBNb2RlIT1FZS5MSUdIVE1BUF9ERUZBVUxUPyhhLmxpZ2h0bWFwTW9kZT0hMCxyWyJMSUdIVE1BUEVYQ0xVREVEIitzXT0hMCxyWyJMSUdIVE1BUE5PU1BFQ1VMQVIiK3NdPWkubGlnaHRtYXBNb2RlPT1FZS5MSUdIVE1BUF9TSEFET1dTT05MWSk6KHJbIkxJR0hUTUFQRVhDTFVERUQiK3NdPSExLHJbIkxJR0hUTUFQTk9TUEVDVUxBUiIrc109ITEpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0ZvckxpZ2h0cyhlLHQsaSxzLHI9NCxuPSExKXtpZighaS5fYXJlTGlnaHRzRGlydHkpcmV0dXJuIGkuX25lZWROb3JtYWxzO2xldCBhPTA7Y29uc3Qgbz17bmVlZE5vcm1hbHM6aS5fbmVlZE5vcm1hbHMsbmVlZFJlYnVpbGQ6ITEsbGlnaHRtYXBNb2RlOiExLHNoYWRvd0VuYWJsZWQ6ITEsc3BlY3VsYXJFbmFibGVkOiExfTtpZihlLmxpZ2h0c0VuYWJsZWQmJiFuKXtmb3IoY29uc3QgbCBvZiB0LmxpZ2h0U291cmNlcylpZih0aGlzLlByZXBhcmVEZWZpbmVzRm9yTGlnaHQoZSx0LGwsYSxpLHMsbyksYSsrLGE9PT1yKWJyZWFrfWkuU1BFQ1VMQVJURVJNPW8uc3BlY3VsYXJFbmFibGVkLGkuU0hBRE9XUz1vLnNoYWRvd0VuYWJsZWQ7Zm9yKGxldCBsPWE7bDxyO2wrKylpWyJMSUdIVCIrbF0hPT12b2lkIDAmJihpWyJMSUdIVCIrbF09ITEsaVsiSEVNSUxJR0hUIitsXT0hMSxpWyJQT0lOVExJR0hUIitsXT0hMSxpWyJESVJMSUdIVCIrbF09ITEsaVsiU1BPVExJR0hUIitsXT0hMSxpWyJTSEFET1ciK2xdPSExLGlbIlNIQURPV0NTTSIrbF09ITEsaVsiU0hBRE9XQ1NNREVCVUciK2xdPSExLGlbIlNIQURPV0NTTU5VTV9DQVNDQURFUyIrbF09ITEsaVsiU0hBRE9XQ1NNVVNFU0hBRE9XTUFYWiIrbF09ITEsaVsiU0hBRE9XQ1NNTk9CTEVORCIrbF09ITEsaVsiU0hBRE9XQ1NNX1JJR0hUSEFOREVEIitsXT0hMSxpWyJTSEFET1dQQ0YiK2xdPSExLGlbIlNIQURPV1BDU1MiK2xdPSExLGlbIlNIQURPV1BPSVNTT04iK2xdPSExLGlbIlNIQURPV0VTTSIrbF09ITEsaVsiU0hBRE9XQ0xPU0VFU00iK2xdPSExLGlbIlNIQURPV0NVQkUiK2xdPSExLGlbIlNIQURPV0xPV1FVQUxJVFkiK2xdPSExLGlbIlNIQURPV01FRElVTVFVQUxJVFkiK2xdPSExKTtjb25zdCBoPWUuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpO3JldHVybiBpLlNIQURPV0ZMT0FUPT09dm9pZCAwJiYoby5uZWVkUmVidWlsZD0hMCksaS5TSEFET1dGTE9BVD1vLnNoYWRvd0VuYWJsZWQmJihoLnRleHR1cmVGbG9hdFJlbmRlciYmaC50ZXh0dXJlRmxvYXRMaW5lYXJGaWx0ZXJpbmd8fGgudGV4dHVyZUhhbGZGbG9hdFJlbmRlciYmaC50ZXh0dXJlSGFsZkZsb2F0TGluZWFyRmlsdGVyaW5nKSxpLkxJR0hUTUFQRVhDTFVERUQ9by5saWdodG1hcE1vZGUsby5uZWVkUmVidWlsZCYmaS5yZWJ1aWxkKCksby5uZWVkTm9ybWFsc31zdGF0aWMgUHJlcGFyZVVuaWZvcm1zQW5kU2FtcGxlcnNGb3JMaWdodChlLHQsaSxzLHI9bnVsbCxuPSExKXtyJiZyLnB1c2goIkxpZ2h0IitlKSwhbiYmKHQucHVzaCgidkxpZ2h0RGF0YSIrZSwidkxpZ2h0RGlmZnVzZSIrZSwidkxpZ2h0U3BlY3VsYXIiK2UsInZMaWdodERpcmVjdGlvbiIrZSwidkxpZ2h0RmFsbG9mZiIrZSwidkxpZ2h0R3JvdW5kIitlLCJsaWdodE1hdHJpeCIrZSwic2hhZG93c0luZm8iK2UsImRlcHRoVmFsdWVzIitlKSxpLnB1c2goInNoYWRvd1NhbXBsZXIiK2UpLGkucHVzaCgiZGVwdGhTYW1wbGVyIitlKSx0LnB1c2goInZpZXdGcnVzdHVtWiIrZSwiY2FzY2FkZUJsZW5kRmFjdG9yIitlLCJsaWdodFNpemVVVkNvcnJlY3Rpb24iK2UsImRlcHRoQ29ycmVjdGlvbiIrZSwicGVudW1icmFEYXJrbmVzcyIrZSwiZnJ1c3R1bUxlbmd0aHMiK2UpLHMmJihpLnB1c2goInByb2plY3Rpb25MaWdodFNhbXBsZXIiK2UpLHQucHVzaCgidGV4dHVyZVByb2plY3Rpb25NYXRyaXgiK2UpKSl9c3RhdGljIFByZXBhcmVVbmlmb3Jtc0FuZFNhbXBsZXJzTGlzdChlLHQsaSxzPTQpe2xldCByLG49bnVsbDtpZihlLnVuaWZvcm1zTmFtZXMpe2NvbnN0IGE9ZTtyPWEudW5pZm9ybXNOYW1lcyxuPWEudW5pZm9ybUJ1ZmZlcnNOYW1lcyx0PWEuc2FtcGxlcnMsaT1hLmRlZmluZXMscz1hLm1heFNpbXVsdGFuZW91c0xpZ2h0c3x8MH1lbHNlIHI9ZSx0fHwodD1bXSk7Zm9yKGxldCBhPTA7YTxzJiZpWyJMSUdIVCIrYV07YSsrKXRoaXMuUHJlcGFyZVVuaWZvcm1zQW5kU2FtcGxlcnNGb3JMaWdodChhLHIsdCxpWyJQUk9KRUNURURMSUdIVFRFWFRVUkUiK2FdLG4pO2kuTlVNX01PUlBIX0lORkxVRU5DRVJTJiZyLnB1c2goIm1vcnBoVGFyZ2V0SW5mbHVlbmNlcyIpLGkuQkFLRURfVkVSVEVYX0FOSU1BVElPTl9URVhUVVJFJiYoci5wdXNoKCJiYWtlZFZlcnRleEFuaW1hdGlvblNldHRpbmdzIiksci5wdXNoKCJiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmVTaXplSW52ZXJ0ZWQiKSxyLnB1c2goImJha2VkVmVydGV4QW5pbWF0aW9uVGltZSIpLHQucHVzaCgiYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlIikpfXN0YXRpYyBIYW5kbGVGYWxsYmFja3NGb3JTaGFkb3dzKGUsdCxpPTQscz0wKXtsZXQgcj0wO2ZvcihsZXQgbj0wO248aSYmZVsiTElHSFQiK25dO24rKyluPjAmJihyPXMrbix0LmFkZEZhbGxiYWNrKHIsIkxJR0hUIituKSksZS5TSEFET1dTfHwoZVsiU0hBRE9XIituXSYmdC5hZGRGYWxsYmFjayhzLCJTSEFET1ciK24pLGVbIlNIQURPV1BDRiIrbl0mJnQuYWRkRmFsbGJhY2socywiU0hBRE9XUENGIituKSxlWyJTSEFET1dQQ1NTIituXSYmdC5hZGRGYWxsYmFjayhzLCJTSEFET1dQQ1NTIituKSxlWyJTSEFET1dQT0lTU09OIituXSYmdC5hZGRGYWxsYmFjayhzLCJTSEFET1dQT0lTU09OIituKSxlWyJTSEFET1dFU00iK25dJiZ0LmFkZEZhbGxiYWNrKHMsIlNIQURPV0VTTSIrbiksZVsiU0hBRE9XQ0xPU0VFU00iK25dJiZ0LmFkZEZhbGxiYWNrKHMsIlNIQURPV0NMT1NFRVNNIituKSk7cmV0dXJuIHIrK31zdGF0aWMgUHJlcGFyZUF0dHJpYnV0ZXNGb3JNb3JwaFRhcmdldHNJbmZsdWVuY2VycyhlLHQsaSl7dGhpcy5fVG1wTW9ycGhJbmZsdWVuY2Vycy5OVU1fTU9SUEhfSU5GTFVFTkNFUlM9aSx0aGlzLlByZXBhcmVBdHRyaWJ1dGVzRm9yTW9ycGhUYXJnZXRzKGUsdCx0aGlzLl9UbXBNb3JwaEluZmx1ZW5jZXJzKX1zdGF0aWMgUHJlcGFyZUF0dHJpYnV0ZXNGb3JNb3JwaFRhcmdldHMoZSx0LGkpe2NvbnN0IHM9aS5OVU1fTU9SUEhfSU5GTFVFTkNFUlM7aWYocz4wJiZmZS5MYXN0Q3JlYXRlZEVuZ2luZSl7Y29uc3Qgcj1mZS5MYXN0Q3JlYXRlZEVuZ2luZS5nZXRDYXBzKCkubWF4VmVydGV4QXR0cmlicyxuPXQubW9ycGhUYXJnZXRNYW5hZ2VyO2lmKG4hPW51bGwmJm4uaXNVc2luZ1RleHR1cmVGb3JUYXJnZXRzKXJldHVybjtjb25zdCBhPW4mJm4uc3VwcG9ydHNOb3JtYWxzJiZpLk5PUk1BTCxvPW4mJm4uc3VwcG9ydHNUYW5nZW50cyYmaS5UQU5HRU5ULGg9biYmbi5zdXBwb3J0c1VWcyYmaS5VVjE7Zm9yKGxldCBsPTA7bDxzO2wrKyllLnB1c2goZy5Qb3NpdGlvbktpbmQrbCksYSYmZS5wdXNoKGcuTm9ybWFsS2luZCtsKSxvJiZlLnB1c2goZy5UYW5nZW50S2luZCtsKSxoJiZlLnB1c2goZy5VVktpbmQrIl8iK2wpLGUubGVuZ3RoPnImJk8uRXJyb3IoIkNhbm5vdCBhZGQgbW9yZSB2ZXJ0ZXggYXR0cmlidXRlcyBmb3IgbWVzaCAiK3QubmFtZSl9fXN0YXRpYyBQcmVwYXJlQXR0cmlidXRlc0ZvckJha2VkVmVydGV4QW5pbWF0aW9uKGUsdCxpKXtpLkJBS0VEX1ZFUlRFWF9BTklNQVRJT05fVEVYVFVSRSYmaS5JTlNUQU5DRVMmJmUucHVzaCgiYmFrZWRWZXJ0ZXhBbmltYXRpb25TZXR0aW5nc0luc3RhbmNlZCIpfXN0YXRpYyBQcmVwYXJlQXR0cmlidXRlc0ZvckJvbmVzKGUsdCxpLHMpe2kuTlVNX0JPTkVfSU5GTFVFTkNFUlM+MCYmKHMuYWRkQ1BVU2tpbm5pbmdGYWxsYmFjaygwLHQpLGUucHVzaChnLk1hdHJpY2VzSW5kaWNlc0tpbmQpLGUucHVzaChnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpLGkuTlVNX0JPTkVfSU5GTFVFTkNFUlM+NCYmKGUucHVzaChnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCksZS5wdXNoKGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kKSkpfXN0YXRpYyBQcmVwYXJlQXR0cmlidXRlc0Zvckluc3RhbmNlcyhlLHQpeyh0LklOU1RBTkNFU3x8dC5USElOX0lOU1RBTkNFUykmJnRoaXMuUHVzaEF0dHJpYnV0ZXNGb3JJbnN0YW5jZXMoZSwhIXQuUFJFUEFTU19WRUxPQ0lUWSksdC5JTlNUQU5DRVNDT0xPUiYmZS5wdXNoKGcuQ29sb3JJbnN0YW5jZUtpbmQpfXN0YXRpYyBQdXNoQXR0cmlidXRlc0Zvckluc3RhbmNlcyhlLHQ9ITEpe2UucHVzaCgid29ybGQwIiksZS5wdXNoKCJ3b3JsZDEiKSxlLnB1c2goIndvcmxkMiIpLGUucHVzaCgid29ybGQzIiksdCYmKGUucHVzaCgicHJldmlvdXNXb3JsZDAiKSxlLnB1c2goInByZXZpb3VzV29ybGQxIiksZS5wdXNoKCJwcmV2aW91c1dvcmxkMiIpLGUucHVzaCgicHJldmlvdXNXb3JsZDMiKSl9c3RhdGljIEJpbmRMaWdodFByb3BlcnRpZXMoZSx0LGkpe2UudHJhbnNmZXJUb0VmZmVjdCh0LGkrIiIpfXN0YXRpYyBCaW5kTGlnaHQoZSx0LGkscyxyLG49ITApe2UuX2JpbmRMaWdodCh0LGkscyxyLG4pfXN0YXRpYyBCaW5kTGlnaHRzKGUsdCxpLHMscj00KXtjb25zdCBuPU1hdGgubWluKHQubGlnaHRTb3VyY2VzLmxlbmd0aCxyKTtmb3IobGV0IGE9MDthPG47YSsrKXtjb25zdCBvPXQubGlnaHRTb3VyY2VzW2FdO3RoaXMuQmluZExpZ2h0KG8sYSxlLGksdHlwZW9mIHM9PSJib29sZWFuIj9zOnMuU1BFQ1VMQVJURVJNLHQucmVjZWl2ZVNoYWRvd3MpfX1zdGF0aWMgQmluZEZvZ1BhcmFtZXRlcnMoZSx0LGkscz0hMSl7ZS5mb2dFbmFibGVkJiZ0LmFwcGx5Rm9nJiZlLmZvZ01vZGUhPT1uZS5GT0dNT0RFX05PTkUmJihpLnNldEZsb2F0NCgidkZvZ0luZm9zIixlLmZvZ01vZGUsZS5mb2dTdGFydCxlLmZvZ0VuZCxlLmZvZ0RlbnNpdHkpLHM/KGUuZm9nQ29sb3IudG9MaW5lYXJTcGFjZVRvUmVmKHRoaXMuX1RlbXBGb2dDb2xvciksaS5zZXRDb2xvcjMoInZGb2dDb2xvciIsdGhpcy5fVGVtcEZvZ0NvbG9yKSk6aS5zZXRDb2xvcjMoInZGb2dDb2xvciIsZS5mb2dDb2xvcikpfXN0YXRpYyBCaW5kQm9uZXNQYXJhbWV0ZXJzKGUsdCxpKXtpZighKCF0fHwhZSkmJihlLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycyYmdC5fYm9uZXNDb21wdXRhdGlvbkZvcmNlZFRvQ1BVJiYoZS5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnM9ITEpLGUudXNlQm9uZXMmJmUuY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzJiZlLnNrZWxldG9uKSl7Y29uc3Qgcz1lLnNrZWxldG9uO2lmKHMuaXNVc2luZ1RleHR1cmVGb3JNYXRyaWNlcyYmdC5nZXRVbmlmb3JtSW5kZXgoImJvbmVUZXh0dXJlV2lkdGgiKT4tMSl7Y29uc3Qgcj1zLmdldFRyYW5zZm9ybU1hdHJpeFRleHR1cmUoZSk7dC5zZXRUZXh0dXJlKCJib25lU2FtcGxlciIsciksdC5zZXRGbG9hdCgiYm9uZVRleHR1cmVXaWR0aCIsNCoocy5ib25lcy5sZW5ndGgrMSkpfWVsc2V7Y29uc3Qgcj1zLmdldFRyYW5zZm9ybU1hdHJpY2VzKGUpO3ImJih0LnNldE1hdHJpY2VzKCJtQm9uZXMiLHIpLGkmJmUuZ2V0U2NlbmUoKS5wcmVQYXNzUmVuZGVyZXImJmUuZ2V0U2NlbmUoKS5wcmVQYXNzUmVuZGVyZXIuZ2V0SW5kZXgoMikmJihpLnByZXZpb3VzQm9uZXNbZS51bmlxdWVJZF18fChpLnByZXZpb3VzQm9uZXNbZS51bmlxdWVJZF09ci5zbGljZSgpKSx0LnNldE1hdHJpY2VzKCJtUHJldmlvdXNCb25lcyIsaS5wcmV2aW91c0JvbmVzW2UudW5pcXVlSWRdKSxpZS5fQ29weUJvbmVzVHJhbnNmb3JtYXRpb25NYXRyaWNlcyhyLGkucHJldmlvdXNCb25lc1tlLnVuaXF1ZUlkXSkpKX19fXN0YXRpYyBfQ29weUJvbmVzVHJhbnNmb3JtYXRpb25NYXRyaWNlcyhlLHQpe3JldHVybiB0LnNldChlKSx0fXN0YXRpYyBCaW5kTW9ycGhUYXJnZXRQYXJhbWV0ZXJzKGUsdCl7Y29uc3QgaT1lLm1vcnBoVGFyZ2V0TWFuYWdlcjshZXx8IWl8fHQuc2V0RmxvYXRBcnJheSgibW9ycGhUYXJnZXRJbmZsdWVuY2VzIixpLmluZmx1ZW5jZXMpfXN0YXRpYyBCaW5kTG9nRGVwdGgoZSx0LGkpe2lmKCFlfHxlLkxPR0FSSVRITUlDREVQVEh8fGUuaW5kZXhPZiYmZS5pbmRleE9mKCJMT0dBUklUSE1JQ0RFUFRIIik+PTApe2NvbnN0IHM9aS5hY3RpdmVDYW1lcmE7cy5tb2RlPT09ai5PUlRIT0dSQVBISUNfQ0FNRVJBJiZPLkVycm9yKCJMb2dhcml0aG1pYyBkZXB0aCBpcyBub3QgY29tcGF0aWJsZSB3aXRoIG9ydGhvZ3JhcGhpYyBjYW1lcmFzISIsMjApLHQuc2V0RmxvYXQoImxvZ2FyaXRobWljRGVwdGhDb25zdGFudCIsMi8oTWF0aC5sb2cocy5tYXhaKzEpL01hdGguTE4yKSl9fX1pZS5fVG1wTW9ycGhJbmZsdWVuY2Vycz17TlVNX01PUlBIX0lORkxVRU5DRVJTOjB9LGllLl9UZW1wRm9nQ29sb3I9cmUuQmxhY2soKTtjbGFzcyBXdHtjb25zdHJ1Y3Rvcigpe3RoaXMucmVzZXQoKX1yZXNldCgpe3RoaXMuZW5hYmxlZD0hMSx0aGlzLm1hc2s9MjU1LHRoaXMuZnVuYz01MTksdGhpcy5mdW5jUmVmPTEsdGhpcy5mdW5jTWFzaz0yNTUsdGhpcy5vcFN0ZW5jaWxGYWlsPTc2ODAsdGhpcy5vcERlcHRoRmFpbD03NjgwLHRoaXMub3BTdGVuY2lsRGVwdGhQYXNzPTc2ODF9Z2V0IGZ1bmMoKXtyZXR1cm4gdGhpcy5fZnVuY31zZXQgZnVuYyhlKXt0aGlzLl9mdW5jPWV9Z2V0IGZ1bmNSZWYoKXtyZXR1cm4gdGhpcy5fZnVuY1JlZn1zZXQgZnVuY1JlZihlKXt0aGlzLl9mdW5jUmVmPWV9Z2V0IGZ1bmNNYXNrKCl7cmV0dXJuIHRoaXMuX2Z1bmNNYXNrfXNldCBmdW5jTWFzayhlKXt0aGlzLl9mdW5jTWFzaz1lfWdldCBvcFN0ZW5jaWxGYWlsKCl7cmV0dXJuIHRoaXMuX29wU3RlbmNpbEZhaWx9c2V0IG9wU3RlbmNpbEZhaWwoZSl7dGhpcy5fb3BTdGVuY2lsRmFpbD1lfWdldCBvcERlcHRoRmFpbCgpe3JldHVybiB0aGlzLl9vcERlcHRoRmFpbH1zZXQgb3BEZXB0aEZhaWwoZSl7dGhpcy5fb3BEZXB0aEZhaWw9ZX1nZXQgb3BTdGVuY2lsRGVwdGhQYXNzKCl7cmV0dXJuIHRoaXMuX29wU3RlbmNpbERlcHRoUGFzc31zZXQgb3BTdGVuY2lsRGVwdGhQYXNzKGUpe3RoaXMuX29wU3RlbmNpbERlcHRoUGFzcz1lfWdldCBtYXNrKCl7cmV0dXJuIHRoaXMuX21hc2t9c2V0IG1hc2soZSl7dGhpcy5fbWFzaz1lfWdldCBlbmFibGVkKCl7cmV0dXJuIHRoaXMuX2VuYWJsZWR9c2V0IGVuYWJsZWQoZSl7dGhpcy5fZW5hYmxlZD1lfWdldENsYXNzTmFtZSgpe3JldHVybiJNYXRlcmlhbFN0ZW5jaWxTdGF0ZSJ9Y29weVRvKGUpe2FlLkNsb25lKCgpPT5lLHRoaXMpfXNlcmlhbGl6ZSgpe3JldHVybiBhZS5TZXJpYWxpemUodGhpcyl9cGFyc2UoZSx0LGkpe2FlLlBhcnNlKCgpPT50aGlzLGUsdCxpKX19VChbUigpXSxXdC5wcm90b3R5cGUsImZ1bmMiLG51bGwpLFQoW1IoKV0sV3QucHJvdG90eXBlLCJmdW5jUmVmIixudWxsKSxUKFtSKCldLFd0LnByb3RvdHlwZSwiZnVuY01hc2siLG51bGwpLFQoW1IoKV0sV3QucHJvdG90eXBlLCJvcFN0ZW5jaWxGYWlsIixudWxsKSxUKFtSKCldLFd0LnByb3RvdHlwZSwib3BEZXB0aEZhaWwiLG51bGwpLFQoW1IoKV0sV3QucHJvdG90eXBlLCJvcFN0ZW5jaWxEZXB0aFBhc3MiLG51bGwpLFQoW1IoKV0sV3QucHJvdG90eXBlLCJtYXNrIixudWxsKSxUKFtSKCldLFd0LnByb3RvdHlwZSwiZW5hYmxlZCIsbnVsbCk7dmFyIFFlOyhmdW5jdGlvbihjKXtjW2MuQ3JlYXRlZD0xXT0iQ3JlYXRlZCIsY1tjLkRpc3Bvc2VkPTJdPSJEaXNwb3NlZCIsY1tjLkdldERlZmluZU5hbWVzPTRdPSJHZXREZWZpbmVOYW1lcyIsY1tjLlByZXBhcmVVbmlmb3JtQnVmZmVyPThdPSJQcmVwYXJlVW5pZm9ybUJ1ZmZlciIsY1tjLklzUmVhZHlGb3JTdWJNZXNoPTE2XT0iSXNSZWFkeUZvclN1Yk1lc2giLGNbYy5QcmVwYXJlRGVmaW5lcz0zMl09IlByZXBhcmVEZWZpbmVzIixjW2MuQmluZEZvclN1Yk1lc2g9NjRdPSJCaW5kRm9yU3ViTWVzaCIsY1tjLlByZXBhcmVFZmZlY3Q9MTI4XT0iUHJlcGFyZUVmZmVjdCIsY1tjLkdldEFuaW1hdGFibGVzPTI1Nl09IkdldEFuaW1hdGFibGVzIixjW2MuR2V0QWN0aXZlVGV4dHVyZXM9NTEyXT0iR2V0QWN0aXZlVGV4dHVyZXMiLGNbYy5IYXNUZXh0dXJlPTEwMjRdPSJIYXNUZXh0dXJlIixjW2MuRmlsbFJlbmRlclRhcmdldFRleHR1cmVzPTIwNDhdPSJGaWxsUmVuZGVyVGFyZ2V0VGV4dHVyZXMiLGNbYy5IYXNSZW5kZXJUYXJnZXRUZXh0dXJlcz00MDk2XT0iSGFzUmVuZGVyVGFyZ2V0VGV4dHVyZXMiLGNbYy5IYXJkQmluZEZvclN1Yk1lc2g9ODE5Ml09IkhhcmRCaW5kRm9yU3ViTWVzaCJ9KShRZXx8KFFlPXt9KSk7Y2xhc3MgUHtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5zaGFkb3dEZXB0aFdyYXBwZXI9bnVsbCx0aGlzLmFsbG93U2hhZGVySG90U3dhcHBpbmc9ITAsdGhpcy5tZXRhZGF0YT1udWxsLHRoaXMucmVzZXJ2ZWREYXRhU3RvcmU9bnVsbCx0aGlzLmNoZWNrUmVhZHlPbkV2ZXJ5Q2FsbD0hMSx0aGlzLmNoZWNrUmVhZHlPbmx5T25jZT0hMSx0aGlzLnN0YXRlPSIiLHRoaXMuX2FscGhhPTEsdGhpcy5fYmFja0ZhY2VDdWxsaW5nPSEwLHRoaXMuX2N1bGxCYWNrRmFjZXM9ITAsdGhpcy5fYmxvY2tEaXJ0eU1lY2hhbmlzbT0hMSx0aGlzLm9uQ29tcGlsZWQ9bnVsbCx0aGlzLm9uRXJyb3I9bnVsbCx0aGlzLmdldFJlbmRlclRhcmdldFRleHR1cmVzPW51bGwsdGhpcy5kb05vdFNlcmlhbGl6ZT0hMSx0aGlzLl9zdG9yZUVmZmVjdE9uU3ViTWVzaGVzPSExLHRoaXMuYW5pbWF0aW9ucz1udWxsLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlcj1udWxsLHRoaXMuX29uVW5CaW5kT2JzZXJ2YWJsZT1udWxsLHRoaXMuX29uQmluZE9ic2VydmVyPW51bGwsdGhpcy5fYWxwaGFNb2RlPTIsdGhpcy5fbmVlZERlcHRoUHJlUGFzcz0hMSx0aGlzLmRpc2FibGVEZXB0aFdyaXRlPSExLHRoaXMuZGlzYWJsZUNvbG9yV3JpdGU9ITEsdGhpcy5mb3JjZURlcHRoV3JpdGU9ITEsdGhpcy5kZXB0aEZ1bmN0aW9uPTAsdGhpcy5zZXBhcmF0ZUN1bGxpbmdQYXNzPSExLHRoaXMuX2ZvZ0VuYWJsZWQ9ITAsdGhpcy5wb2ludFNpemU9MSx0aGlzLnpPZmZzZXQ9MCx0aGlzLnpPZmZzZXRVbml0cz0wLHRoaXMuc3RlbmNpbD1uZXcgV3QsdGhpcy5fdXNlVUJPPSExLHRoaXMuX2ZpbGxNb2RlPVAuVHJpYW5nbGVGaWxsTW9kZSx0aGlzLl9jYWNoZWREZXB0aFdyaXRlU3RhdGU9ITEsdGhpcy5fY2FjaGVkQ29sb3JXcml0ZVN0YXRlPSExLHRoaXMuX2NhY2hlZERlcHRoRnVuY3Rpb25TdGF0ZT0wLHRoaXMuX2luZGV4SW5TY2VuZU1hdGVyaWFsQXJyYXk9LTEsdGhpcy5tZXNoTWFwPW51bGwsdGhpcy5fcGFyZW50Q29udGFpbmVyPW51bGwsdGhpcy5fdW5pZm9ybUJ1ZmZlckxheW91dEJ1aWx0PSExLHRoaXMuX2V2ZW50SW5mbz17fSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50R2VuZXJpYz0oKT0+e30sdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudElzUmVhZHlGb3JTdWJNZXNoPSgpPT57fSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50UHJlcGFyZURlZmluZXM9KCk9Pnt9LHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRQcmVwYXJlRGVmaW5lc0JlZm9yZUF0dHJpYnV0ZXM9KCk9Pnt9LHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRIYXJkQmluZEZvclN1Yk1lc2g9KCk9Pnt9LHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRCaW5kRm9yU3ViTWVzaD0oKT0+e30sdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudEhhc1JlbmRlclRhcmdldFRleHR1cmVzPSgpPT57fSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50RmlsbFJlbmRlclRhcmdldFRleHR1cmVzPSgpPT57fSx0aGlzLl9mb3JjZUFscGhhVGVzdD0hMSx0aGlzLl90cmFuc3BhcmVuY3lNb2RlPW51bGwsdGhpcy5uYW1lPWU7Y29uc3Qgcz10fHxmZS5MYXN0Q3JlYXRlZFNjZW5lO3MmJih0aGlzLl9zY2VuZT1zLHRoaXMuX2RpcnR5Q2FsbGJhY2tzPXt9LHRoaXMuX2RpcnR5Q2FsbGJhY2tzWzFdPXRoaXMuX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkuYmluZCh0aGlzKSx0aGlzLl9kaXJ0eUNhbGxiYWNrc1syXT10aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNMaWdodHNEaXJ0eS5iaW5kKHRoaXMpLHRoaXMuX2RpcnR5Q2FsbGJhY2tzWzRdPXRoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0ZyZXNuZWxEaXJ0eS5iaW5kKHRoaXMpLHRoaXMuX2RpcnR5Q2FsbGJhY2tzWzhdPXRoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0F0dHJpYnV0ZXNEaXJ0eS5iaW5kKHRoaXMpLHRoaXMuX2RpcnR5Q2FsbGJhY2tzWzE2XT10aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNNaXNjRGlydHkuYmluZCh0aGlzKSx0aGlzLl9kaXJ0eUNhbGxiYWNrc1szMl09dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzUHJlUGFzc0RpcnR5LmJpbmQodGhpcyksdGhpcy5fZGlydHlDYWxsYmFja3NbNjNdPXRoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0FsbERpcnR5LmJpbmQodGhpcyksdGhpcy5pZD1lfHxILlJhbmRvbUlkKCksdGhpcy51bmlxdWVJZD10aGlzLl9zY2VuZS5nZXRVbmlxdWVJZCgpLHRoaXMuX21hdGVyaWFsQ29udGV4dD10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5jcmVhdGVNYXRlcmlhbENvbnRleHQoKSx0aGlzLl9kcmF3V3JhcHBlcj1uZXcgbWkodGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksITEpLHRoaXMuX2RyYXdXcmFwcGVyLm1hdGVyaWFsQ29udGV4dD10aGlzLl9tYXRlcmlhbENvbnRleHQsdGhpcy5fc2NlbmUudXNlUmlnaHRIYW5kZWRTeXN0ZW0/dGhpcy5zaWRlT3JpZW50YXRpb249UC5DbG9ja1dpc2VTaWRlT3JpZW50YXRpb246dGhpcy5zaWRlT3JpZW50YXRpb249UC5Db3VudGVyQ2xvY2tXaXNlU2lkZU9yaWVudGF0aW9uLHRoaXMuX3VuaWZvcm1CdWZmZXI9bmV3IFYodGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksdm9pZCAwLHZvaWQgMCxlKSx0aGlzLl91c2VVQk89dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLnN1cHBvcnRzVW5pZm9ybUJ1ZmZlcnMsaXx8dGhpcy5fc2NlbmUuYWRkTWF0ZXJpYWwodGhpcyksdGhpcy5fc2NlbmUudXNlTWF0ZXJpYWxNZXNoTWFwJiYodGhpcy5tZXNoTWFwPXt9KSxQLk9uRXZlbnRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzLFFlLkNyZWF0ZWQpKX1nZXQgY2FuUmVuZGVyVG9NUlQoKXtyZXR1cm4hMX1zZXQgYWxwaGEoZSl7aWYodGhpcy5fYWxwaGE9PT1lKXJldHVybjtjb25zdCB0PXRoaXMuX2FscGhhO3RoaXMuX2FscGhhPWUsKHQ9PT0xfHxlPT09MSkmJnRoaXMubWFya0FzRGlydHkoUC5NaXNjRGlydHlGbGFnKX1nZXQgYWxwaGEoKXtyZXR1cm4gdGhpcy5fYWxwaGF9c2V0IGJhY2tGYWNlQ3VsbGluZyhlKXt0aGlzLl9iYWNrRmFjZUN1bGxpbmchPT1lJiYodGhpcy5fYmFja0ZhY2VDdWxsaW5nPWUsdGhpcy5tYXJrQXNEaXJ0eShQLlRleHR1cmVEaXJ0eUZsYWcpKX1nZXQgYmFja0ZhY2VDdWxsaW5nKCl7cmV0dXJuIHRoaXMuX2JhY2tGYWNlQ3VsbGluZ31zZXQgY3VsbEJhY2tGYWNlcyhlKXt0aGlzLl9jdWxsQmFja0ZhY2VzIT09ZSYmKHRoaXMuX2N1bGxCYWNrRmFjZXM9ZSx0aGlzLm1hcmtBc0RpcnR5KFAuVGV4dHVyZURpcnR5RmxhZykpfWdldCBjdWxsQmFja0ZhY2VzKCl7cmV0dXJuIHRoaXMuX2N1bGxCYWNrRmFjZXN9Z2V0IGJsb2NrRGlydHlNZWNoYW5pc20oKXtyZXR1cm4gdGhpcy5fYmxvY2tEaXJ0eU1lY2hhbmlzbX1zZXQgYmxvY2tEaXJ0eU1lY2hhbmlzbShlKXt0aGlzLl9ibG9ja0RpcnR5TWVjaGFuaXNtIT09ZSYmKHRoaXMuX2Jsb2NrRGlydHlNZWNoYW5pc209ZSxlfHx0aGlzLm1hcmtEaXJ0eSgpKX1hdG9taWNNYXRlcmlhbHNVcGRhdGUoZSl7dGhpcy5ibG9ja0RpcnR5TWVjaGFuaXNtPSEwO3RyeXtlKHRoaXMpfWZpbmFsbHl7dGhpcy5ibG9ja0RpcnR5TWVjaGFuaXNtPSExfX1nZXQgaGFzUmVuZGVyVGFyZ2V0VGV4dHVyZXMoKXtyZXR1cm4gdGhpcy5fZXZlbnRJbmZvLmhhc1JlbmRlclRhcmdldFRleHR1cmVzPSExLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRIYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyh0aGlzLl9ldmVudEluZm8pLHRoaXMuX2V2ZW50SW5mby5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlc31zZXQgb25EaXNwb3NlKGUpe3RoaXMuX29uRGlzcG9zZU9ic2VydmVyJiZ0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uRGlzcG9zZU9ic2VydmVyKSx0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlcj10aGlzLm9uRGlzcG9zZU9ic2VydmFibGUuYWRkKGUpfWdldCBvbkJpbmRPYnNlcnZhYmxlKCl7cmV0dXJuIHRoaXMuX29uQmluZE9ic2VydmFibGV8fCh0aGlzLl9vbkJpbmRPYnNlcnZhYmxlPW5ldyBGKSx0aGlzLl9vbkJpbmRPYnNlcnZhYmxlfXNldCBvbkJpbmQoZSl7dGhpcy5fb25CaW5kT2JzZXJ2ZXImJnRoaXMub25CaW5kT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25CaW5kT2JzZXJ2ZXIpLHRoaXMuX29uQmluZE9ic2VydmVyPXRoaXMub25CaW5kT2JzZXJ2YWJsZS5hZGQoZSl9Z2V0IG9uVW5CaW5kT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLl9vblVuQmluZE9ic2VydmFibGV8fCh0aGlzLl9vblVuQmluZE9ic2VydmFibGU9bmV3IEYpLHRoaXMuX29uVW5CaW5kT2JzZXJ2YWJsZX1nZXQgb25FZmZlY3RDcmVhdGVkT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLl9vbkVmZmVjdENyZWF0ZWRPYnNlcnZhYmxlfHwodGhpcy5fb25FZmZlY3RDcmVhdGVkT2JzZXJ2YWJsZT1uZXcgRiksdGhpcy5fb25FZmZlY3RDcmVhdGVkT2JzZXJ2YWJsZX1zZXQgYWxwaGFNb2RlKGUpe3RoaXMuX2FscGhhTW9kZSE9PWUmJih0aGlzLl9hbHBoYU1vZGU9ZSx0aGlzLm1hcmtBc0RpcnR5KFAuVGV4dHVyZURpcnR5RmxhZykpfWdldCBhbHBoYU1vZGUoKXtyZXR1cm4gdGhpcy5fYWxwaGFNb2RlfXNldCBuZWVkRGVwdGhQcmVQYXNzKGUpe3RoaXMuX25lZWREZXB0aFByZVBhc3MhPT1lJiYodGhpcy5fbmVlZERlcHRoUHJlUGFzcz1lLHRoaXMuX25lZWREZXB0aFByZVBhc3MmJih0aGlzLmNoZWNrUmVhZHlPbkV2ZXJ5Q2FsbD0hMCkpfWdldCBuZWVkRGVwdGhQcmVQYXNzKCl7cmV0dXJuIHRoaXMuX25lZWREZXB0aFByZVBhc3N9Z2V0IGlzUHJlUGFzc0NhcGFibGUoKXtyZXR1cm4hMX1zZXQgZm9nRW5hYmxlZChlKXt0aGlzLl9mb2dFbmFibGVkIT09ZSYmKHRoaXMuX2ZvZ0VuYWJsZWQ9ZSx0aGlzLm1hcmtBc0RpcnR5KFAuTWlzY0RpcnR5RmxhZykpfWdldCBmb2dFbmFibGVkKCl7cmV0dXJuIHRoaXMuX2ZvZ0VuYWJsZWR9Z2V0IHdpcmVmcmFtZSgpe3N3aXRjaCh0aGlzLl9maWxsTW9kZSl7Y2FzZSBQLldpcmVGcmFtZUZpbGxNb2RlOmNhc2UgUC5MaW5lTGlzdERyYXdNb2RlOmNhc2UgUC5MaW5lTG9vcERyYXdNb2RlOmNhc2UgUC5MaW5lU3RyaXBEcmF3TW9kZTpyZXR1cm4hMH1yZXR1cm4gdGhpcy5fc2NlbmUuZm9yY2VXaXJlZnJhbWV9c2V0IHdpcmVmcmFtZShlKXt0aGlzLmZpbGxNb2RlPWU/UC5XaXJlRnJhbWVGaWxsTW9kZTpQLlRyaWFuZ2xlRmlsbE1vZGV9Z2V0IHBvaW50c0Nsb3VkKCl7c3dpdGNoKHRoaXMuX2ZpbGxNb2RlKXtjYXNlIFAuUG9pbnRGaWxsTW9kZTpjYXNlIFAuUG9pbnRMaXN0RHJhd01vZGU6cmV0dXJuITB9cmV0dXJuIHRoaXMuX3NjZW5lLmZvcmNlUG9pbnRzQ2xvdWR9c2V0IHBvaW50c0Nsb3VkKGUpe3RoaXMuZmlsbE1vZGU9ZT9QLlBvaW50RmlsbE1vZGU6UC5UcmlhbmdsZUZpbGxNb2RlfWdldCBmaWxsTW9kZSgpe3JldHVybiB0aGlzLl9maWxsTW9kZX1zZXQgZmlsbE1vZGUoZSl7dGhpcy5fZmlsbE1vZGUhPT1lJiYodGhpcy5fZmlsbE1vZGU9ZSx0aGlzLm1hcmtBc0RpcnR5KFAuTWlzY0RpcnR5RmxhZykpfV9nZXREcmF3V3JhcHBlcigpe3JldHVybiB0aGlzLl9kcmF3V3JhcHBlcn1fc2V0RHJhd1dyYXBwZXIoZSl7dGhpcy5fZHJhd1dyYXBwZXI9ZX10b1N0cmluZyhlKXtyZXR1cm4iTmFtZTogIit0aGlzLm5hbWV9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIk1hdGVyaWFsIn1nZXQgX2lzTWF0ZXJpYWwoKXtyZXR1cm4hMH1nZXQgaXNGcm96ZW4oKXtyZXR1cm4gdGhpcy5jaGVja1JlYWR5T25seU9uY2V9ZnJlZXplKCl7dGhpcy5tYXJrRGlydHkoKSx0aGlzLmNoZWNrUmVhZHlPbmx5T25jZT0hMH11bmZyZWV6ZSgpe3RoaXMubWFya0RpcnR5KCksdGhpcy5jaGVja1JlYWR5T25seU9uY2U9ITF9aXNSZWFkeShlLHQpe3JldHVybiEwfWlzUmVhZHlGb3JTdWJNZXNoKGUsdCxpKXtjb25zdCBzPXQubWF0ZXJpYWxEZWZpbmVzO3JldHVybiBzPyh0aGlzLl9ldmVudEluZm8uaXNSZWFkeUZvclN1Yk1lc2g9ITAsdGhpcy5fZXZlbnRJbmZvLmRlZmluZXM9cyx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50SXNSZWFkeUZvclN1Yk1lc2godGhpcy5fZXZlbnRJbmZvKSx0aGlzLl9ldmVudEluZm8uaXNSZWFkeUZvclN1Yk1lc2gpOiExfWdldEVmZmVjdCgpe3JldHVybiB0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3R9Z2V0U2NlbmUoKXtyZXR1cm4gdGhpcy5fc2NlbmV9Z2V0IHRyYW5zcGFyZW5jeU1vZGUoKXtyZXR1cm4gdGhpcy5fdHJhbnNwYXJlbmN5TW9kZX1zZXQgdHJhbnNwYXJlbmN5TW9kZShlKXt0aGlzLl90cmFuc3BhcmVuY3lNb2RlIT09ZSYmKHRoaXMuX3RyYW5zcGFyZW5jeU1vZGU9ZSx0aGlzLl9mb3JjZUFscGhhVGVzdD1lPT09UC5NQVRFUklBTF9BTFBIQVRFU1RBTkRCTEVORCx0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0FuZE1pc2NEaXJ0eSgpKX1nZXQgX2Rpc2FibGVBbHBoYUJsZW5kaW5nKCl7cmV0dXJuIHRoaXMuX3RyYW5zcGFyZW5jeU1vZGU9PT1QLk1BVEVSSUFMX09QQVFVRXx8dGhpcy5fdHJhbnNwYXJlbmN5TW9kZT09PVAuTUFURVJJQUxfQUxQSEFURVNUfW5lZWRBbHBoYUJsZW5kaW5nKCl7cmV0dXJuIHRoaXMuX2Rpc2FibGVBbHBoYUJsZW5kaW5nPyExOnRoaXMuYWxwaGE8MX1uZWVkQWxwaGFCbGVuZGluZ0Zvck1lc2goZSl7cmV0dXJuIGUudmlzaWJpbGl0eTwxPyEwOnRoaXMuX2Rpc2FibGVBbHBoYUJsZW5kaW5nPyExOmUuaGFzVmVydGV4QWxwaGF8fHRoaXMubmVlZEFscGhhQmxlbmRpbmcoKX1uZWVkQWxwaGFUZXN0aW5nKCl7cmV0dXJuISF0aGlzLl9mb3JjZUFscGhhVGVzdH1fc2hvdWxkVHVybkFscGhhVGVzdE9uKGUpe3JldHVybiF0aGlzLm5lZWRBbHBoYUJsZW5kaW5nRm9yTWVzaChlKSYmdGhpcy5uZWVkQWxwaGFUZXN0aW5nKCl9Z2V0QWxwaGFUZXN0VGV4dHVyZSgpe3JldHVybiBudWxsfW1hcmtEaXJ0eShlPSExKXtjb25zdCB0PXRoaXMuZ2V0U2NlbmUoKS5tZXNoZXM7Zm9yKGNvbnN0IGkgb2YgdClpZihpLnN1Yk1lc2hlcylmb3IoY29uc3QgcyBvZiBpLnN1Yk1lc2hlcylzLmdldE1hdGVyaWFsKCk9PT10aGlzJiZzLmVmZmVjdCYmKHMuZWZmZWN0Ll93YXNQcmV2aW91c2x5UmVhZHk9ITEscy5lZmZlY3QuX3dhc1ByZXZpb3VzbHlVc2luZ0luc3RhbmNlcz1udWxsLHMuZWZmZWN0Ll9mb3JjZVJlYmluZE9uTmV4dENhbGw9ZSk7ZSYmdGhpcy5tYXJrQXNEaXJ0eShQLkFsbERpcnR5RmxhZyl9X3ByZUJpbmQoZSx0PW51bGwpe2NvbnN0IGk9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkscj0odD8/dGhpcy5zaWRlT3JpZW50YXRpb24pPT09UC5DbG9ja1dpc2VTaWRlT3JpZW50YXRpb247cmV0dXJuIGkuZW5hYmxlRWZmZWN0KGV8fHRoaXMuX2dldERyYXdXcmFwcGVyKCkpLGkuc2V0U3RhdGUodGhpcy5iYWNrRmFjZUN1bGxpbmcsdGhpcy56T2Zmc2V0LCExLHIsdGhpcy5fc2NlbmUuX21pcnJvcmVkQ2FtZXJhUG9zaXRpb24/IXRoaXMuY3VsbEJhY2tGYWNlczp0aGlzLmN1bGxCYWNrRmFjZXMsdGhpcy5zdGVuY2lsLHRoaXMuek9mZnNldFVuaXRzKSxyfWJpbmQoZSx0KXt9YnVpbGRVbmlmb3JtTGF5b3V0KCl7Y29uc3QgZT10aGlzLl91bmlmb3JtQnVmZmVyO3RoaXMuX2V2ZW50SW5mby51Ym89ZSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50R2VuZXJpYyhRZS5QcmVwYXJlVW5pZm9ybUJ1ZmZlcix0aGlzLl9ldmVudEluZm8pLGUuY3JlYXRlKCksdGhpcy5fdW5pZm9ybUJ1ZmZlckxheW91dEJ1aWx0PSEwfWJpbmRGb3JTdWJNZXNoKGUsdCxpKXtjb25zdCBzPWkuZWZmZWN0O3MmJih0aGlzLl9ldmVudEluZm8uc3ViTWVzaD1pLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRCaW5kRm9yU3ViTWVzaCh0aGlzLl9ldmVudEluZm8pLHMuX2ZvcmNlUmViaW5kT25OZXh0Q2FsbD0hMSl9YmluZE9ubHlXb3JsZE1hdHJpeChlKXt9YmluZFZpZXcoZSl7dGhpcy5fdXNlVUJPP3RoaXMuX25lZWRUb0JpbmRTY2VuZVVibz0hMDplLnNldE1hdHJpeCgidmlldyIsdGhpcy5nZXRTY2VuZSgpLmdldFZpZXdNYXRyaXgoKSl9YmluZFZpZXdQcm9qZWN0aW9uKGUpe3RoaXMuX3VzZVVCTz90aGlzLl9uZWVkVG9CaW5kU2NlbmVVYm89ITA6KGUuc2V0TWF0cml4KCJ2aWV3UHJvamVjdGlvbiIsdGhpcy5nZXRTY2VuZSgpLmdldFRyYW5zZm9ybU1hdHJpeCgpKSxlLnNldE1hdHJpeCgicHJvamVjdGlvbiIsdGhpcy5nZXRTY2VuZSgpLmdldFByb2plY3Rpb25NYXRyaXgoKSkpfWJpbmRFeWVQb3NpdGlvbihlLHQpe3RoaXMuX3VzZVVCTz90aGlzLl9uZWVkVG9CaW5kU2NlbmVVYm89ITA6dGhpcy5fc2NlbmUuYmluZEV5ZVBvc2l0aW9uKGUsdCl9X2FmdGVyQmluZChlLHQ9bnVsbCl7aWYodGhpcy5fc2NlbmUuX2NhY2hlZE1hdGVyaWFsPXRoaXMsdGhpcy5fbmVlZFRvQmluZFNjZW5lVWJvJiZ0JiYodGhpcy5fbmVlZFRvQmluZFNjZW5lVWJvPSExLGllLkJpbmRTY2VuZVVuaWZvcm1CdWZmZXIodCx0aGlzLmdldFNjZW5lKCkuZ2V0U2NlbmVVbmlmb3JtQnVmZmVyKCkpLHRoaXMuX3NjZW5lLmZpbmFsaXplU2NlbmVVYm8oKSksZT90aGlzLl9zY2VuZS5fY2FjaGVkVmlzaWJpbGl0eT1lLnZpc2liaWxpdHk6dGhpcy5fc2NlbmUuX2NhY2hlZFZpc2liaWxpdHk9MSx0aGlzLl9vbkJpbmRPYnNlcnZhYmxlJiZlJiZ0aGlzLl9vbkJpbmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0aGlzLmRpc2FibGVEZXB0aFdyaXRlKXtjb25zdCBpPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3RoaXMuX2NhY2hlZERlcHRoV3JpdGVTdGF0ZT1pLmdldERlcHRoV3JpdGUoKSxpLnNldERlcHRoV3JpdGUoITEpfWlmKHRoaXMuZGlzYWJsZUNvbG9yV3JpdGUpe2NvbnN0IGk9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7dGhpcy5fY2FjaGVkQ29sb3JXcml0ZVN0YXRlPWkuZ2V0Q29sb3JXcml0ZSgpLGkuc2V0Q29sb3JXcml0ZSghMSl9aWYodGhpcy5kZXB0aEZ1bmN0aW9uIT09MCl7Y29uc3QgaT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKTt0aGlzLl9jYWNoZWREZXB0aEZ1bmN0aW9uU3RhdGU9aS5nZXREZXB0aEZ1bmN0aW9uKCl8fDAsaS5zZXREZXB0aEZ1bmN0aW9uKHRoaXMuZGVwdGhGdW5jdGlvbil9fXVuYmluZCgpe3RoaXMuX29uVW5CaW5kT2JzZXJ2YWJsZSYmdGhpcy5fb25VbkJpbmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSx0aGlzLmRlcHRoRnVuY3Rpb24hPT0wJiZ0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5zZXREZXB0aEZ1bmN0aW9uKHRoaXMuX2NhY2hlZERlcHRoRnVuY3Rpb25TdGF0ZSksdGhpcy5kaXNhYmxlRGVwdGhXcml0ZSYmdGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkuc2V0RGVwdGhXcml0ZSh0aGlzLl9jYWNoZWREZXB0aFdyaXRlU3RhdGUpLHRoaXMuZGlzYWJsZUNvbG9yV3JpdGUmJnRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLnNldENvbG9yV3JpdGUodGhpcy5fY2FjaGVkQ29sb3JXcml0ZVN0YXRlKX1nZXRBbmltYXRhYmxlcygpe3JldHVybiB0aGlzLl9ldmVudEluZm8uYW5pbWF0YWJsZXM9W10sdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudEdlbmVyaWMoUWUuR2V0QW5pbWF0YWJsZXMsdGhpcy5fZXZlbnRJbmZvKSx0aGlzLl9ldmVudEluZm8uYW5pbWF0YWJsZXN9Z2V0QWN0aXZlVGV4dHVyZXMoKXtyZXR1cm4gdGhpcy5fZXZlbnRJbmZvLmFjdGl2ZVRleHR1cmVzPVtdLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRHZW5lcmljKFFlLkdldEFjdGl2ZVRleHR1cmVzLHRoaXMuX2V2ZW50SW5mbyksdGhpcy5fZXZlbnRJbmZvLmFjdGl2ZVRleHR1cmVzfWhhc1RleHR1cmUoZSl7cmV0dXJuIHRoaXMuX2V2ZW50SW5mby5oYXNUZXh0dXJlPSExLHRoaXMuX2V2ZW50SW5mby50ZXh0dXJlPWUsdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudEdlbmVyaWMoUWUuSGFzVGV4dHVyZSx0aGlzLl9ldmVudEluZm8pLHRoaXMuX2V2ZW50SW5mby5oYXNUZXh0dXJlfWNsb25lKGUpe3JldHVybiBudWxsfWdldEJpbmRlZE1lc2hlcygpe2lmKHRoaXMubWVzaE1hcCl7Y29uc3QgZT1uZXcgQXJyYXk7Zm9yKGNvbnN0IHQgaW4gdGhpcy5tZXNoTWFwKXtjb25zdCBpPXRoaXMubWVzaE1hcFt0XTtpJiZlLnB1c2goaSl9cmV0dXJuIGV9ZWxzZSByZXR1cm4gdGhpcy5fc2NlbmUubWVzaGVzLmZpbHRlcih0PT50Lm1hdGVyaWFsPT09dGhpcyl9Zm9yY2VDb21waWxhdGlvbihlLHQsaSxzKXtjb25zdCByPXtjbGlwUGxhbmU6ITEsdXNlSW5zdGFuY2VzOiExLC4uLml9LG49dGhpcy5nZXRTY2VuZSgpLGE9dGhpcy5hbGxvd1NoYWRlckhvdFN3YXBwaW5nO3RoaXMuYWxsb3dTaGFkZXJIb3RTd2FwcGluZz0hMTtjb25zdCBvPSgpPT57aWYoIXRoaXMuX3NjZW5lfHwhdGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkpcmV0dXJuO2NvbnN0IGg9bi5jbGlwUGxhbmU7aWYoci5jbGlwUGxhbmUmJihuLmNsaXBQbGFuZT1uZXcgeHQoMCwwLDAsMSkpLHRoaXMuX3N0b3JlRWZmZWN0T25TdWJNZXNoZXMpe2xldCBsPSEwLHU9bnVsbDtpZihlLnN1Yk1lc2hlcyl7Y29uc3QgZD1uZXcgdnQoMCwwLDAsMCwwLGUsdm9pZCAwLCExLCExKTtkLm1hdGVyaWFsRGVmaW5lcyYmKGQubWF0ZXJpYWxEZWZpbmVzLl9yZW5kZXJJZD0tMSksdGhpcy5pc1JlYWR5Rm9yU3ViTWVzaChlLGQsci51c2VJbnN0YW5jZXMpfHwoZC5lZmZlY3QmJmQuZWZmZWN0LmdldENvbXBpbGF0aW9uRXJyb3IoKSYmZC5lZmZlY3QuYWxsRmFsbGJhY2tzUHJvY2Vzc2VkKCk/dT1kLmVmZmVjdC5nZXRDb21waWxhdGlvbkVycm9yKCk6KGw9ITEsc2V0VGltZW91dChvLDE2KSkpfWwmJih0aGlzLmFsbG93U2hhZGVySG90U3dhcHBpbmc9YSx1JiZzJiZzKHUpLHQmJnQodGhpcykpfWVsc2UgdGhpcy5pc1JlYWR5KCk/KHRoaXMuYWxsb3dTaGFkZXJIb3RTd2FwcGluZz1hLHQmJnQodGhpcykpOnNldFRpbWVvdXQobywxNik7ci5jbGlwUGxhbmUmJihuLmNsaXBQbGFuZT1oKX07bygpfWZvcmNlQ29tcGlsYXRpb25Bc3luYyhlLHQpe3JldHVybiBuZXcgUHJvbWlzZSgoaSxzKT0+e3RoaXMuZm9yY2VDb21waWxhdGlvbihlLCgpPT57aSgpfSx0LHI9PntzKHIpfSl9KX1tYXJrQXNEaXJ0eShlKXt0aGlzLmdldFNjZW5lKCkuYmxvY2tNYXRlcmlhbERpcnR5TWVjaGFuaXNtfHx0aGlzLl9ibG9ja0RpcnR5TWVjaGFuaXNtfHwoUC5fRGlydHlDYWxsYmFja0FycmF5Lmxlbmd0aD0wLGUmUC5UZXh0dXJlRGlydHlGbGFnJiZQLl9EaXJ0eUNhbGxiYWNrQXJyYXkucHVzaChQLl9UZXh0dXJlRGlydHlDYWxsQmFjayksZSZQLkxpZ2h0RGlydHlGbGFnJiZQLl9EaXJ0eUNhbGxiYWNrQXJyYXkucHVzaChQLl9MaWdodHNEaXJ0eUNhbGxCYWNrKSxlJlAuRnJlc25lbERpcnR5RmxhZyYmUC5fRGlydHlDYWxsYmFja0FycmF5LnB1c2goUC5fRnJlc25lbERpcnR5Q2FsbEJhY2spLGUmUC5BdHRyaWJ1dGVzRGlydHlGbGFnJiZQLl9EaXJ0eUNhbGxiYWNrQXJyYXkucHVzaChQLl9BdHRyaWJ1dGVEaXJ0eUNhbGxCYWNrKSxlJlAuTWlzY0RpcnR5RmxhZyYmUC5fRGlydHlDYWxsYmFja0FycmF5LnB1c2goUC5fTWlzY0RpcnR5Q2FsbEJhY2spLGUmUC5QcmVQYXNzRGlydHlGbGFnJiZQLl9EaXJ0eUNhbGxiYWNrQXJyYXkucHVzaChQLl9QcmVQYXNzRGlydHlDYWxsQmFjayksUC5fRGlydHlDYWxsYmFja0FycmF5Lmxlbmd0aCYmdGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzRGlydHkoUC5fUnVuRGlydHlDYWxsQmFja3MpLHRoaXMuZ2V0U2NlbmUoKS5yZXNldENhY2hlZE1hdGVyaWFsKCkpfXJlc2V0RHJhd0NhY2hlKCl7Y29uc3QgZT10aGlzLmdldFNjZW5lKCkubWVzaGVzO2Zvcihjb25zdCB0IG9mIGUpaWYodC5zdWJNZXNoZXMpZm9yKGNvbnN0IGkgb2YgdC5zdWJNZXNoZXMpaS5nZXRNYXRlcmlhbCgpPT09dGhpcyYmaS5yZXNldERyYXdDYWNoZSgpfV9tYXJrQWxsU3ViTWVzaGVzQXNEaXJ0eShlKXtpZih0aGlzLmdldFNjZW5lKCkuYmxvY2tNYXRlcmlhbERpcnR5TWVjaGFuaXNtfHx0aGlzLl9ibG9ja0RpcnR5TWVjaGFuaXNtKXJldHVybjtjb25zdCB0PXRoaXMuZ2V0U2NlbmUoKS5tZXNoZXM7Zm9yKGNvbnN0IGkgb2YgdClpZihpLnN1Yk1lc2hlcyl7Zm9yKGNvbnN0IHMgb2YgaS5zdWJNZXNoZXMpaWYocy5nZXRNYXRlcmlhbCghMSk9PT10aGlzKWZvcihjb25zdCByIG9mIHMuX2RyYXdXcmFwcGVycykhcnx8IXIuZGVmaW5lc3x8IXIuZGVmaW5lcy5tYXJrQWxsQXNEaXJ0eXx8dGhpcy5fbWF0ZXJpYWxDb250ZXh0PT09ci5tYXRlcmlhbENvbnRleHQmJmUoci5kZWZpbmVzKX19X21hcmtTY2VuZVByZVBhc3NEaXJ0eSgpe2lmKHRoaXMuZ2V0U2NlbmUoKS5ibG9ja01hdGVyaWFsRGlydHlNZWNoYW5pc218fHRoaXMuX2Jsb2NrRGlydHlNZWNoYW5pc20pcmV0dXJuO2NvbnN0IGU9dGhpcy5nZXRTY2VuZSgpLmVuYWJsZVByZVBhc3NSZW5kZXJlcigpO2UmJmUubWFya0FzRGlydHkoKX1fbWFya0FsbFN1Yk1lc2hlc0FzQWxsRGlydHkoKXt0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNEaXJ0eShQLl9BbGxEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzSW1hZ2VQcm9jZXNzaW5nRGlydHkoKXt0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNEaXJ0eShQLl9JbWFnZVByb2Nlc3NpbmdEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSgpe3RoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0RpcnR5KFAuX1RleHR1cmVEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzRnJlc25lbERpcnR5KCl7dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzRGlydHkoUC5fRnJlc25lbERpcnR5Q2FsbEJhY2spfV9tYXJrQWxsU3ViTWVzaGVzQXNGcmVzbmVsQW5kTWlzY0RpcnR5KCl7dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzRGlydHkoUC5fRnJlc25lbEFuZE1pc2NEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzTGlnaHRzRGlydHkoKXt0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNEaXJ0eShQLl9MaWdodHNEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCl7dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzRGlydHkoUC5fQXR0cmlidXRlRGlydHlDYWxsQmFjayl9X21hcmtBbGxTdWJNZXNoZXNBc01pc2NEaXJ0eSgpe3RoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0RpcnR5KFAuX01pc2NEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzUHJlUGFzc0RpcnR5KCl7dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzRGlydHkoUC5fTWlzY0RpcnR5Q2FsbEJhY2spfV9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0FuZE1pc2NEaXJ0eSgpe3RoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0RpcnR5KFAuX1RleHR1cmVBbmRNaXNjRGlydHlDYWxsQmFjayl9c2V0UHJlUGFzc1JlbmRlcmVyKGUpe3JldHVybiExfWRpc3Bvc2UoZSx0LGkpe2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpO2lmKHMuc3RvcEFuaW1hdGlvbih0aGlzKSxzLmZyZWVQcm9jZXNzZWRNYXRlcmlhbHMoKSxzLnJlbW92ZU1hdGVyaWFsKHRoaXMpLHRoaXMuX2V2ZW50SW5mby5mb3JjZURpc3Bvc2VUZXh0dXJlcz10LHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRHZW5lcmljKFFlLkRpc3Bvc2VkLHRoaXMuX2V2ZW50SW5mbyksdGhpcy5fcGFyZW50Q29udGFpbmVyKXtjb25zdCByPXRoaXMuX3BhcmVudENvbnRhaW5lci5tYXRlcmlhbHMuaW5kZXhPZih0aGlzKTtyPi0xJiZ0aGlzLl9wYXJlbnRDb250YWluZXIubWF0ZXJpYWxzLnNwbGljZShyLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfWlmKGkhPT0hMClpZih0aGlzLm1lc2hNYXApZm9yKGNvbnN0IHIgaW4gdGhpcy5tZXNoTWFwKXtjb25zdCBuPXRoaXMubWVzaE1hcFtyXTtuJiYobi5tYXRlcmlhbD1udWxsLHRoaXMucmVsZWFzZVZlcnRleEFycmF5T2JqZWN0KG4sZSkpfWVsc2V7Y29uc3Qgcj1zLm1lc2hlcztmb3IoY29uc3QgbiBvZiByKW4ubWF0ZXJpYWw9PT10aGlzJiYhbi5zb3VyY2VNZXNoJiYobi5tYXRlcmlhbD1udWxsLHRoaXMucmVsZWFzZVZlcnRleEFycmF5T2JqZWN0KG4sZSkpfXRoaXMuX3VuaWZvcm1CdWZmZXIuZGlzcG9zZSgpLGUmJnRoaXMuX2RyYXdXcmFwcGVyLmVmZmVjdCYmKHRoaXMuX3N0b3JlRWZmZWN0T25TdWJNZXNoZXN8fHRoaXMuX2RyYXdXcmFwcGVyLmVmZmVjdC5kaXNwb3NlKCksdGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0PW51bGwpLHRoaXMubWV0YWRhdGE9bnVsbCx0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX29uQmluZE9ic2VydmFibGUmJnRoaXMuX29uQmluZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9vblVuQmluZE9ic2VydmFibGUmJnRoaXMuX29uVW5CaW5kT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX29uRWZmZWN0Q3JlYXRlZE9ic2VydmFibGUmJnRoaXMuX29uRWZmZWN0Q3JlYXRlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9ldmVudEluZm8mJih0aGlzLl9ldmVudEluZm89e30pfXJlbGVhc2VWZXJ0ZXhBcnJheU9iamVjdChlLHQpe2lmKGUuZ2VvbWV0cnkpe2NvbnN0IGk9ZS5nZW9tZXRyeTtpZih0aGlzLl9zdG9yZUVmZmVjdE9uU3ViTWVzaGVzKWZvcihjb25zdCBzIG9mIGUuc3ViTWVzaGVzKWkuX3JlbGVhc2VWZXJ0ZXhBcnJheU9iamVjdChzLmVmZmVjdCksdCYmcy5lZmZlY3QmJnMuZWZmZWN0LmRpc3Bvc2UoKTtlbHNlIGkuX3JlbGVhc2VWZXJ0ZXhBcnJheU9iamVjdCh0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3QpfX1zZXJpYWxpemUoKXtjb25zdCBlPWFlLlNlcmlhbGl6ZSh0aGlzKTtyZXR1cm4gZS5zdGVuY2lsPXRoaXMuc3RlbmNpbC5zZXJpYWxpemUoKSxlLnVuaXF1ZUlkPXRoaXMudW5pcXVlSWQsZX1zdGF0aWMgUGFyc2UoZSx0LGkpe2lmKCFlLmN1c3RvbVR5cGUpZS5jdXN0b21UeXBlPSJCQUJZTE9OLlN0YW5kYXJkTWF0ZXJpYWwiO2Vsc2UgaWYoZS5jdXN0b21UeXBlPT09IkJBQllMT04uUEJSTWF0ZXJpYWwiJiZlLm92ZXJsb2FkZWRBbGJlZG8mJihlLmN1c3RvbVR5cGU9IkJBQllMT04uTGVnYWN5UEJSTWF0ZXJpYWwiLCFCQUJZTE9OLkxlZ2FjeVBCUk1hdGVyaWFsKSlyZXR1cm4gTy5FcnJvcigiWW91ciBzY2VuZSBpcyB0cnlpbmcgdG8gbG9hZCBhIGxlZ2FjeSB2ZXJzaW9uIG9mIHRoZSBQQlJNYXRlcmlhbCwgcGxlYXNlLCBpbmNsdWRlIGl0IGZyb20gdGhlIG1hdGVyaWFscyBsaWJyYXJ5LiIpLG51bGw7Y29uc3Qgcj1ILkluc3RhbnRpYXRlKGUuY3VzdG9tVHlwZSkuUGFyc2UoZSx0LGkpO3JldHVybiByLl9sb2FkZWRVbmlxdWVJZD1lLnVuaXF1ZUlkLHJ9fVAuVHJpYW5nbGVGaWxsTW9kZT0wLFAuV2lyZUZyYW1lRmlsbE1vZGU9MSxQLlBvaW50RmlsbE1vZGU9MixQLlBvaW50TGlzdERyYXdNb2RlPTMsUC5MaW5lTGlzdERyYXdNb2RlPTQsUC5MaW5lTG9vcERyYXdNb2RlPTUsUC5MaW5lU3RyaXBEcmF3TW9kZT02LFAuVHJpYW5nbGVTdHJpcERyYXdNb2RlPTcsUC5UcmlhbmdsZUZhbkRyYXdNb2RlPTgsUC5DbG9ja1dpc2VTaWRlT3JpZW50YXRpb249MCxQLkNvdW50ZXJDbG9ja1dpc2VTaWRlT3JpZW50YXRpb249MSxQLlRleHR1cmVEaXJ0eUZsYWc9MSxQLkxpZ2h0RGlydHlGbGFnPTIsUC5GcmVzbmVsRGlydHlGbGFnPTQsUC5BdHRyaWJ1dGVzRGlydHlGbGFnPTgsUC5NaXNjRGlydHlGbGFnPTE2LFAuUHJlUGFzc0RpcnR5RmxhZz0zMixQLkFsbERpcnR5RmxhZz02MyxQLk1BVEVSSUFMX09QQVFVRT0wLFAuTUFURVJJQUxfQUxQSEFURVNUPTEsUC5NQVRFUklBTF9BTFBIQUJMRU5EPTIsUC5NQVRFUklBTF9BTFBIQVRFU1RBTkRCTEVORD0zLFAuTUFURVJJQUxfTk9STUFMQkxFTkRNRVRIT0RfV0hJVEVPVVQ9MCxQLk1BVEVSSUFMX05PUk1BTEJMRU5ETUVUSE9EX1JOTT0xLFAuT25FdmVudE9ic2VydmFibGU9bmV3IEYsUC5fQWxsRGlydHlDYWxsQmFjaz1jPT5jLm1hcmtBbGxBc0RpcnR5KCksUC5fSW1hZ2VQcm9jZXNzaW5nRGlydHlDYWxsQmFjaz1jPT5jLm1hcmtBc0ltYWdlUHJvY2Vzc2luZ0RpcnR5KCksUC5fVGV4dHVyZURpcnR5Q2FsbEJhY2s9Yz0+Yy5tYXJrQXNUZXh0dXJlc0RpcnR5KCksUC5fRnJlc25lbERpcnR5Q2FsbEJhY2s9Yz0+Yy5tYXJrQXNGcmVzbmVsRGlydHkoKSxQLl9NaXNjRGlydHlDYWxsQmFjaz1jPT5jLm1hcmtBc01pc2NEaXJ0eSgpLFAuX1ByZVBhc3NEaXJ0eUNhbGxCYWNrPWM9PmMubWFya0FzUHJlUGFzc0RpcnR5KCksUC5fTGlnaHRzRGlydHlDYWxsQmFjaz1jPT5jLm1hcmtBc0xpZ2h0RGlydHkoKSxQLl9BdHRyaWJ1dGVEaXJ0eUNhbGxCYWNrPWM9PmMubWFya0FzQXR0cmlidXRlc0RpcnR5KCksUC5fRnJlc25lbEFuZE1pc2NEaXJ0eUNhbGxCYWNrPWM9PntQLl9GcmVzbmVsRGlydHlDYWxsQmFjayhjKSxQLl9NaXNjRGlydHlDYWxsQmFjayhjKX0sUC5fVGV4dHVyZUFuZE1pc2NEaXJ0eUNhbGxCYWNrPWM9PntQLl9UZXh0dXJlRGlydHlDYWxsQmFjayhjKSxQLl9NaXNjRGlydHlDYWxsQmFjayhjKX0sUC5fRGlydHlDYWxsYmFja0FycmF5PVtdLFAuX1J1bkRpcnR5Q2FsbEJhY2tzPWM9Pntmb3IoY29uc3QgZSBvZiBQLl9EaXJ0eUNhbGxiYWNrQXJyYXkpZShjKX0sVChbUigpXSxQLnByb3RvdHlwZSwiaWQiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwidW5pcXVlSWQiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwibmFtZSIsdm9pZCAwKSxUKFtSKCldLFAucHJvdG90eXBlLCJtZXRhZGF0YSIsdm9pZCAwKSxUKFtSKCldLFAucHJvdG90eXBlLCJjaGVja1JlYWR5T25FdmVyeUNhbGwiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiY2hlY2tSZWFkeU9ubHlPbmNlIix2b2lkIDApLFQoW1IoKV0sUC5wcm90b3R5cGUsInN0YXRlIix2b2lkIDApLFQoW1IoImFscGhhIildLFAucHJvdG90eXBlLCJfYWxwaGEiLHZvaWQgMCksVChbUigiYmFja0ZhY2VDdWxsaW5nIildLFAucHJvdG90eXBlLCJfYmFja0ZhY2VDdWxsaW5nIix2b2lkIDApLFQoW1IoImN1bGxCYWNrRmFjZXMiKV0sUC5wcm90b3R5cGUsIl9jdWxsQmFja0ZhY2VzIix2b2lkIDApLFQoW1IoKV0sUC5wcm90b3R5cGUsInNpZGVPcmllbnRhdGlvbiIsdm9pZCAwKSxUKFtSKCJhbHBoYU1vZGUiKV0sUC5wcm90b3R5cGUsIl9hbHBoYU1vZGUiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiX25lZWREZXB0aFByZVBhc3MiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiZGlzYWJsZURlcHRoV3JpdGUiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiZGlzYWJsZUNvbG9yV3JpdGUiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiZm9yY2VEZXB0aFdyaXRlIix2b2lkIDApLFQoW1IoKV0sUC5wcm90b3R5cGUsImRlcHRoRnVuY3Rpb24iLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwic2VwYXJhdGVDdWxsaW5nUGFzcyIsdm9pZCAwKSxUKFtSKCJmb2dFbmFibGVkIildLFAucHJvdG90eXBlLCJfZm9nRW5hYmxlZCIsdm9pZCAwKSxUKFtSKCldLFAucHJvdG90eXBlLCJwb2ludFNpemUiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiek9mZnNldCIsdm9pZCAwKSxUKFtSKCldLFAucHJvdG90eXBlLCJ6T2Zmc2V0VW5pdHMiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwicG9pbnRzQ2xvdWQiLG51bGwpLFQoW1IoKV0sUC5wcm90b3R5cGUsImZpbGxNb2RlIixudWxsKSxUKFtSKCldLFAucHJvdG90eXBlLCJ0cmFuc3BhcmVuY3lNb2RlIixudWxsKTtjbGFzcyBTaSBleHRlbmRzIFB7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLHQsITApLHRoaXMuX3dhaXRpbmdTdWJNYXRlcmlhbHNVbmlxdWVJZHM9W10sdGhpcy5nZXRTY2VuZSgpLm11bHRpTWF0ZXJpYWxzLnB1c2godGhpcyksdGhpcy5zdWJNYXRlcmlhbHM9bmV3IEFycmF5LHRoaXMuX3N0b3JlRWZmZWN0T25TdWJNZXNoZXM9ITB9Z2V0IHN1Yk1hdGVyaWFscygpe3JldHVybiB0aGlzLl9zdWJNYXRlcmlhbHN9c2V0IHN1Yk1hdGVyaWFscyhlKXt0aGlzLl9zdWJNYXRlcmlhbHM9ZSx0aGlzLl9ob29rQXJyYXkoZSl9Z2V0Q2hpbGRyZW4oKXtyZXR1cm4gdGhpcy5zdWJNYXRlcmlhbHN9X2hvb2tBcnJheShlKXtjb25zdCB0PWUucHVzaDtlLnB1c2g9KC4uLnMpPT57Y29uc3Qgcj10LmFwcGx5KGUscyk7cmV0dXJuIHRoaXMuX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkoKSxyfTtjb25zdCBpPWUuc3BsaWNlO2Uuc3BsaWNlPShzLHIpPT57Y29uc3Qgbj1pLmFwcGx5KGUsW3Mscl0pO3JldHVybiB0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5KCksbn19Z2V0U3ViTWF0ZXJpYWwoZSl7cmV0dXJuIGU8MHx8ZT49dGhpcy5zdWJNYXRlcmlhbHMubGVuZ3RoP3RoaXMuZ2V0U2NlbmUoKS5kZWZhdWx0TWF0ZXJpYWw6dGhpcy5zdWJNYXRlcmlhbHNbZV19Z2V0QWN0aXZlVGV4dHVyZXMoKXtyZXR1cm4gc3VwZXIuZ2V0QWN0aXZlVGV4dHVyZXMoKS5jb25jYXQoLi4udGhpcy5zdWJNYXRlcmlhbHMubWFwKGU9PmU/ZS5nZXRBY3RpdmVUZXh0dXJlcygpOltdKSl9aGFzVGV4dHVyZShlKXt2YXIgdDtpZihzdXBlci5oYXNUZXh0dXJlKGUpKXJldHVybiEwO2ZvcihsZXQgaT0wO2k8dGhpcy5zdWJNYXRlcmlhbHMubGVuZ3RoO2krKylpZighKCh0PXRoaXMuc3ViTWF0ZXJpYWxzW2ldKT09PW51bGx8fHQ9PT12b2lkIDApJiZ0Lmhhc1RleHR1cmUoZSkpcmV0dXJuITA7cmV0dXJuITF9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIk11bHRpTWF0ZXJpYWwifWlzUmVhZHlGb3JTdWJNZXNoKGUsdCxpKXtmb3IobGV0IHM9MDtzPHRoaXMuc3ViTWF0ZXJpYWxzLmxlbmd0aDtzKyspe2NvbnN0IHI9dGhpcy5zdWJNYXRlcmlhbHNbc107aWYocil7aWYoci5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcyl7aWYoIXIuaXNSZWFkeUZvclN1Yk1lc2goZSx0LGkpKXJldHVybiExO2NvbnRpbnVlfWlmKCFyLmlzUmVhZHkoZSkpcmV0dXJuITF9fXJldHVybiEwfWNsb25lKGUsdCl7Y29uc3QgaT1uZXcgU2koZSx0aGlzLmdldFNjZW5lKCkpO2ZvcihsZXQgcz0wO3M8dGhpcy5zdWJNYXRlcmlhbHMubGVuZ3RoO3MrKyl7bGV0IHI9bnVsbDtjb25zdCBuPXRoaXMuc3ViTWF0ZXJpYWxzW3NdO3QmJm4/cj1uLmNsb25lKGUrIi0iK24ubmFtZSk6cj10aGlzLnN1Yk1hdGVyaWFsc1tzXSxpLnN1Yk1hdGVyaWFscy5wdXNoKHIpfXJldHVybiBpfXNlcmlhbGl6ZSgpe2NvbnN0IGU9e307ZS5uYW1lPXRoaXMubmFtZSxlLmlkPXRoaXMuaWQsZS51bmlxdWVJZD10aGlzLnVuaXF1ZUlkLGdlJiYoZS50YWdzPWdlLkdldFRhZ3ModGhpcykpLGUubWF0ZXJpYWxzVW5pcXVlSWRzPVtdLGUubWF0ZXJpYWxzPVtdO2ZvcihsZXQgdD0wO3Q8dGhpcy5zdWJNYXRlcmlhbHMubGVuZ3RoO3QrKyl7Y29uc3QgaT10aGlzLnN1Yk1hdGVyaWFsc1t0XTtpPyhlLm1hdGVyaWFsc1VuaXF1ZUlkcy5wdXNoKGkudW5pcXVlSWQpLGUubWF0ZXJpYWxzLnB1c2goaS5pZCkpOihlLm1hdGVyaWFsc1VuaXF1ZUlkcy5wdXNoKG51bGwpLGUubWF0ZXJpYWxzLnB1c2gobnVsbCkpfXJldHVybiBlfWRpc3Bvc2UoZSx0LGkpe2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpO2lmKCFzKXJldHVybjtpZihpKWZvcihsZXQgbj0wO248dGhpcy5zdWJNYXRlcmlhbHMubGVuZ3RoO24rKyl7Y29uc3QgYT10aGlzLnN1Yk1hdGVyaWFsc1tuXTthJiZhLmRpc3Bvc2UoZSx0KX1jb25zdCByPXMubXVsdGlNYXRlcmlhbHMuaW5kZXhPZih0aGlzKTtyPj0wJiZzLm11bHRpTWF0ZXJpYWxzLnNwbGljZShyLDEpLHN1cGVyLmRpc3Bvc2UoZSx0KX1zdGF0aWMgUGFyc2VNdWx0aU1hdGVyaWFsKGUsdCl7Y29uc3QgaT1uZXcgU2koZS5uYW1lLHQpO3JldHVybiBpLmlkPWUuaWQsaS5fbG9hZGVkVW5pcXVlSWQ9ZS51bmlxdWVJZCxnZSYmZ2UuQWRkVGFnc1RvKGksZS50YWdzKSxlLm1hdGVyaWFsc1VuaXF1ZUlkcz9pLl93YWl0aW5nU3ViTWF0ZXJpYWxzVW5pcXVlSWRzPWUubWF0ZXJpYWxzVW5pcXVlSWRzOmUubWF0ZXJpYWxzLmZvckVhY2gocz0+aS5zdWJNYXRlcmlhbHMucHVzaCh0LmdldExhc3RNYXRlcmlhbEJ5SWQocykpKSxpfX1pdCgiQkFCWUxPTi5NdWx0aU1hdGVyaWFsIixTaSk7Y2xhc3MgV257Y29uc3RydWN0b3IoZSx0KXt0aGlzLmRpc3RhbmNlT3JTY3JlZW5Db3ZlcmFnZT1lLHRoaXMubWVzaD10fX1jbGFzcyB6bntjb25zdHJ1Y3Rvcigpe3RoaXMudmlzaWJsZUluc3RhbmNlcz17fSx0aGlzLmJhdGNoQ2FjaGU9bmV3IElyLHRoaXMuYmF0Y2hDYWNoZVJlcGxhY2VtZW50TW9kZUluRnJvemVuTW9kZT1uZXcgSXIsdGhpcy5pbnN0YW5jZXNCdWZmZXJTaXplPTMyKjE2KjR9fWNsYXNzIElye2NvbnN0cnVjdG9yKCl7dGhpcy5tdXN0UmV0dXJuPSExLHRoaXMudmlzaWJsZUluc3RhbmNlcz1uZXcgQXJyYXksdGhpcy5yZW5kZXJTZWxmPW5ldyBBcnJheSx0aGlzLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nPW5ldyBBcnJheX19Y2xhc3MgR257Y29uc3RydWN0b3IoKXt0aGlzLmluc3RhbmNlc0NvdW50PTAsdGhpcy5tYXRyaXhCdWZmZXI9bnVsbCx0aGlzLnByZXZpb3VzTWF0cml4QnVmZmVyPW51bGwsdGhpcy5tYXRyaXhCdWZmZXJTaXplPTMyKjE2LHRoaXMubWF0cml4RGF0YT1udWxsLHRoaXMuYm91bmRpbmdWZWN0b3JzPVtdLHRoaXMud29ybGRNYXRyaWNlcz1udWxsfX1jbGFzcyBYbntjb25zdHJ1Y3Rvcigpe3RoaXMuX2FyZU5vcm1hbHNGcm96ZW49ITEsdGhpcy5fc291cmNlPW51bGwsdGhpcy5tZXNoTWFwPW51bGwsdGhpcy5fcHJlQWN0aXZhdGVJZD0tMSx0aGlzLl9MT0RMZXZlbHM9bmV3IEFycmF5LHRoaXMuX3VzZUxPRFNjcmVlbkNvdmVyYWdlPSExLHRoaXMuX2VmZmVjdGl2ZU1hdGVyaWFsPW51bGwsdGhpcy5fZm9yY2VkSW5zdGFuY2VDb3VudD0wfX1jbGFzcyBXIGV4dGVuZHMgb3R7Y29uc3RydWN0b3IoZSx0PW51bGwsaT1udWxsLHM9bnVsbCxyLG49ITApe2lmKHN1cGVyKGUsdCksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm89bmV3IFhuLHRoaXMuZGVsYXlMb2FkU3RhdGU9MCx0aGlzLmluc3RhbmNlcz1uZXcgQXJyYXksdGhpcy5fY3JlYXRpb25EYXRhU3RvcmFnZT1udWxsLHRoaXMuX2dlb21ldHJ5PW51bGwsdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZT1uZXcgem4sdGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2U9bmV3IEduLHRoaXMuX3Nob3VsZEdlbmVyYXRlRmxhdFNoYWRpbmc9ITEsdGhpcy5fb3JpZ2luYWxCdWlsZGVyU2lkZU9yaWVudGF0aW9uPVcuREVGQVVMVFNJREUsdGhpcy5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uPW51bGwsdGhpcy5pZ25vcmVDYW1lcmFNYXhaPSExLHQ9dGhpcy5nZXRTY2VuZSgpLHRoaXMuX29uQmVmb3JlRHJhdz0oYSxvLGgpPT57YSYmaCYmKHRoaXMuX3VuaWZvcm1CdWZmZXI/dGhpcy50cmFuc2ZlclRvRWZmZWN0KG8pOmguYmluZE9ubHlXb3JsZE1hdHJpeChvKSl9LHMpe2lmKHMuX2dlb21ldHJ5JiZzLl9nZW9tZXRyeS5hcHBseVRvTWVzaCh0aGlzKSx2cy5EZWVwQ29weShzLHRoaXMsWyJuYW1lIiwibWF0ZXJpYWwiLCJza2VsZXRvbiIsImluc3RhbmNlcyIsInBhcmVudCIsInVuaXF1ZUlkIiwic291cmNlIiwibWV0YWRhdGEiLCJtb3JwaFRhcmdldE1hbmFnZXIiLCJoYXNJbnN0YW5jZXMiLCJ3b3JsZE1hdHJpeEluc3RhbmNlZEJ1ZmZlciIsInByZXZpb3VzV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXIiLCJoYXNMT0RMZXZlbHMiLCJnZW9tZXRyeSIsImlzQmxvY2tlZCIsImFyZU5vcm1hbHNGcm96ZW4iLCJmYWNldE5iIiwiaXNGYWNldERhdGFFbmFibGVkIiwibGlnaHRTb3VyY2VzIiwidXNlQm9uZXMiLCJpc0FuSW5zdGFuY2UiLCJjb2xsaWRlciIsImVkZ2VzUmVuZGVyZXIiLCJmb3J3YXJkIiwidXAiLCJyaWdodCIsImFic29sdXRlUG9zaXRpb24iLCJhYnNvbHV0ZVNjYWxpbmciLCJhYnNvbHV0ZVJvdGF0aW9uUXVhdGVybmlvbiIsImlzV29ybGRNYXRyaXhGcm96ZW4iLCJub25Vbmlmb3JtU2NhbGluZyIsImJlaGF2aW9ycyIsIndvcmxkTWF0cml4RnJvbUNhY2hlIiwiaGFzVGhpbkluc3RhbmNlcyIsImNsb25lTWVzaE1hcCIsImhhc0JvdW5kaW5nSW5mbyJdLFsiX3Bvc2VNYXRyaXgiXSksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZT1zLHQudXNlQ2xvbmVkTWVzaE1hcCYmKHMuX2ludGVybmFsTWVzaERhdGFJbmZvLm1lc2hNYXB8fChzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5tZXNoTWFwPXt9KSxzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5tZXNoTWFwW3RoaXMudW5pcXVlSWRdPXRoaXMpLHRoaXMuX29yaWdpbmFsQnVpbGRlclNpZGVPcmllbnRhdGlvbj1zLl9vcmlnaW5hbEJ1aWxkZXJTaWRlT3JpZW50YXRpb24sdGhpcy5fY3JlYXRpb25EYXRhU3RvcmFnZT1zLl9jcmVhdGlvbkRhdGFTdG9yYWdlLHMuX3Jhbmdlcyl7Y29uc3QgYT1zLl9yYW5nZXM7Zm9yKGNvbnN0IG8gaW4gYSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSxvKSYmYVtvXSYmdGhpcy5jcmVhdGVBbmltYXRpb25SYW5nZShvLGFbb10uZnJvbSxhW29dLnRvKX1pZihzLm1ldGFkYXRhJiZzLm1ldGFkYXRhLmNsb25lP3RoaXMubWV0YWRhdGE9cy5tZXRhZGF0YS5jbG9uZSgpOnRoaXMubWV0YWRhdGE9cy5tZXRhZGF0YSxnZSYmZ2UuSGFzVGFncyhzKSYmZ2UuQWRkVGFnc1RvKHRoaXMsZ2UuR2V0VGFncyhzLCEwKSksdGhpcy5zZXRFbmFibGVkKHMuaXNFbmFibGVkKCExKSksdGhpcy5wYXJlbnQ9cy5wYXJlbnQsdGhpcy5zZXRQaXZvdE1hdHJpeChzLmdldFBpdm90TWF0cml4KCkpLHRoaXMuaWQ9ZSsiLiIrcy5pZCx0aGlzLm1hdGVyaWFsPXMubWF0ZXJpYWwsIXIpe2NvbnN0IGE9cy5nZXREZXNjZW5kYW50cyghMCk7Zm9yKGxldCBvPTA7bzxhLmxlbmd0aDtvKyspe2NvbnN0IGg9YVtvXTtoLmNsb25lJiZoLmNsb25lKGUrIi4iK2gubmFtZSx0aGlzKX19aWYocy5tb3JwaFRhcmdldE1hbmFnZXImJih0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlcj1zLm1vcnBoVGFyZ2V0TWFuYWdlciksdC5nZXRQaHlzaWNzRW5naW5lKXtjb25zdCBhPXQuZ2V0UGh5c2ljc0VuZ2luZSgpO2lmKG4mJmEmJmEuZ2V0UGx1Z2luVmVyc2lvbigpPT09MSl7Y29uc3Qgbz1hLmdldEltcG9zdG9yRm9yUGh5c2ljc09iamVjdChzKTtvJiYodGhpcy5waHlzaWNzSW1wb3N0b3I9by5jbG9uZSh0aGlzKSl9fWZvcihsZXQgYT0wO2E8dC5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO2ErKyl7Y29uc3Qgbz10LnBhcnRpY2xlU3lzdGVtc1thXTtvLmVtaXR0ZXI9PT1zJiZvLmNsb25lKG8ubmFtZSx0aGlzKX10aGlzLnNrZWxldG9uPXMuc2tlbGV0b24sdGhpcy5yZWZyZXNoQm91bmRpbmdJbmZvKCEwLCEwKSx0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCghMCl9aSE9PW51bGwmJih0aGlzLnBhcmVudD1pKSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nPXRoaXMuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLmluc3RhbmNlZEFycmF5cyx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25NZXNoUmVhZHlPYnNlcnZlckFkZGVkPWE9PnthLnVucmVnaXN0ZXJPbk5leHRDYWxsPSEwLHRoaXMuaXNSZWFkeSghMCk/dGhpcy5vbk1lc2hSZWFkeU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpOnRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9jaGVja1JlYWRpbmVzc09ic2VydmVyfHwodGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2NoZWNrUmVhZGluZXNzT2JzZXJ2ZXI9dGhpcy5fc2NlbmUub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmFkZCgoKT0+e3RoaXMuaXNSZWFkeSghMCkmJih0aGlzLl9zY2VuZS5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9jaGVja1JlYWRpbmVzc09ic2VydmVyKSx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fY2hlY2tSZWFkaW5lc3NPYnNlcnZlcj1udWxsLHRoaXMub25NZXNoUmVhZHlPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSl9KSl9LHRoaXMub25NZXNoUmVhZHlPYnNlcnZhYmxlPW5ldyBGKHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbk1lc2hSZWFkeU9ic2VydmVyQWRkZWQpLHMmJnMub25DbG9uZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1zdGF0aWMgX0dldERlZmF1bHRTaWRlT3JpZW50YXRpb24oZSl7cmV0dXJuIGV8fFcuRlJPTlRTSURFfWdldCB1c2VMT0RTY3JlZW5Db3ZlcmFnZSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fdXNlTE9EU2NyZWVuQ292ZXJhZ2V9c2V0IHVzZUxPRFNjcmVlbkNvdmVyYWdlKGUpe3RoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl91c2VMT0RTY3JlZW5Db3ZlcmFnZT1lLHRoaXMuX3NvcnRMT0RMZXZlbHMoKX1nZXQgY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2NvbXB1dGVCb25lc1VzaW5nU2hhZGVyc31zZXQgY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2NvbXB1dGVCb25lc1VzaW5nU2hhZGVycyE9PWUmJihlJiZ0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fc291cmNlUG9zaXRpb25zJiYodGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZVBvc2l0aW9ucywhMCksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZU5vcm1hbHMmJnRoaXMuc2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fc291cmNlTm9ybWFscywhMCksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZVBvc2l0aW9ucz1udWxsLHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9zb3VyY2VOb3JtYWxzPW51bGwpLHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2NvbXB1dGVCb25lc1VzaW5nU2hhZGVycz1lLHRoaXMuX21hcmtTdWJNZXNoZXNBc0F0dHJpYnV0ZXNEaXJ0eSgpKX1nZXQgb25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkJlZm9yZVJlbmRlck9ic2VydmFibGV8fCh0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlPW5ldyBGKSx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlfWdldCBvbkJlZm9yZUJpbmRPYnNlcnZhYmxlKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkJlZm9yZUJpbmRPYnNlcnZhYmxlfHwodGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmVmb3JlQmluZE9ic2VydmFibGU9bmV3IEYpLHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkJlZm9yZUJpbmRPYnNlcnZhYmxlfWdldCBvbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25BZnRlclJlbmRlck9ic2VydmFibGV8fCh0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25BZnRlclJlbmRlck9ic2VydmFibGU9bmV3IEYpLHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZX1nZXQgb25CZXR3ZWVuUGFzc09ic2VydmFibGUoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmV0d2VlblBhc3NPYnNlcnZhYmxlfHwodGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmV0d2VlblBhc3NPYnNlcnZhYmxlPW5ldyBGKSx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZXR3ZWVuUGFzc09ic2VydmFibGV9Z2V0IG9uQmVmb3JlRHJhd09ic2VydmFibGUoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmVmb3JlRHJhd09ic2VydmFibGV8fCh0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZWZvcmVEcmF3T2JzZXJ2YWJsZT1uZXcgRiksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmVmb3JlRHJhd09ic2VydmFibGV9c2V0IG9uQmVmb3JlRHJhdyhlKXt0aGlzLl9vbkJlZm9yZURyYXdPYnNlcnZlciYmdGhpcy5vbkJlZm9yZURyYXdPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkJlZm9yZURyYXdPYnNlcnZlciksdGhpcy5fb25CZWZvcmVEcmF3T2JzZXJ2ZXI9dGhpcy5vbkJlZm9yZURyYXdPYnNlcnZhYmxlLmFkZChlKX1nZXQgaGFzSW5zdGFuY2VzKCl7cmV0dXJuIHRoaXMuaW5zdGFuY2VzLmxlbmd0aD4wfWdldCBoYXNUaGluSW5zdGFuY2VzKCl7dmFyIGU7cmV0dXJuKChlPXRoaXMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0NvdW50KSE9PW51bGwmJmUhPT12b2lkIDA/ZTowKT4wfWdldCBmb3JjZWRJbnN0YW5jZUNvdW50KCl7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9mb3JjZWRJbnN0YW5jZUNvdW50fXNldCBmb3JjZWRJbnN0YW5jZUNvdW50KGUpe3RoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9mb3JjZWRJbnN0YW5jZUNvdW50PWV9Z2V0IHNvdXJjZSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fc291cmNlfWdldCBjbG9uZU1lc2hNYXAoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8ubWVzaE1hcH1nZXQgaXNVbkluZGV4ZWQoKXtyZXR1cm4gdGhpcy5fdW5JbmRleGVkfXNldCBpc1VuSW5kZXhlZChlKXt0aGlzLl91bkluZGV4ZWQhPT1lJiYodGhpcy5fdW5JbmRleGVkPWUsdGhpcy5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCkpfWdldCB3b3JsZE1hdHJpeEluc3RhbmNlZEJ1ZmZlcigpe3JldHVybiB0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0RhdGF9Z2V0IHByZXZpb3VzV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXIoKXtyZXR1cm4gdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pbnN0YW5jZXNQcmV2aW91c0RhdGF9Z2V0IG1hbnVhbFVwZGF0ZU9mV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXIoKXtyZXR1cm4gdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5tYW51YWxVcGRhdGV9c2V0IG1hbnVhbFVwZGF0ZU9mV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXIoZSl7dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5tYW51YWxVcGRhdGU9ZX1nZXQgbWFudWFsVXBkYXRlT2ZQcmV2aW91c1dvcmxkTWF0cml4SW5zdGFuY2VkQnVmZmVyKCl7cmV0dXJuIHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UucHJldmlvdXNNYW51YWxVcGRhdGV9c2V0IG1hbnVhbFVwZGF0ZU9mUHJldmlvdXNXb3JsZE1hdHJpeEluc3RhbmNlZEJ1ZmZlcihlKXt0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzTWFudWFsVXBkYXRlPWV9Z2V0IGZvcmNlV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXJVcGRhdGUoKXtyZXR1cm4gdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5mb3JjZU1hdHJpeFVwZGF0ZXN9c2V0IGZvcmNlV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXJVcGRhdGUoZSl7dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5mb3JjZU1hdHJpeFVwZGF0ZXM9ZX1pbnN0YW50aWF0ZUhpZXJhcmNoeShlPW51bGwsdCxpKXtjb25zdCBzPXRoaXMuZ2V0VG90YWxWZXJ0aWNlcygpPT09MHx8dCYmdC5kb05vdEluc3RhbnRpYXRlJiYodC5kb05vdEluc3RhbnRpYXRlPT09ITB8fHQuZG9Ob3RJbnN0YW50aWF0ZSh0aGlzKSk/dGhpcy5jbG9uZSgiQ2xvbmUgb2YgIisodGhpcy5uYW1lfHx0aGlzLmlkKSxlfHx0aGlzLnBhcmVudCwhMCk6dGhpcy5jcmVhdGVJbnN0YW5jZSgiaW5zdGFuY2Ugb2YgIisodGhpcy5uYW1lfHx0aGlzLmlkKSk7cy5wYXJlbnQ9ZXx8dGhpcy5wYXJlbnQscy5wb3NpdGlvbj10aGlzLnBvc2l0aW9uLmNsb25lKCkscy5zY2FsaW5nPXRoaXMuc2NhbGluZy5jbG9uZSgpLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uP3Mucm90YXRpb25RdWF0ZXJuaW9uPXRoaXMucm90YXRpb25RdWF0ZXJuaW9uLmNsb25lKCk6cy5yb3RhdGlvbj10aGlzLnJvdGF0aW9uLmNsb25lKCksaSYmaSh0aGlzLHMpO2Zvcihjb25zdCByIG9mIHRoaXMuZ2V0Q2hpbGRUcmFuc2Zvcm1Ob2RlcyghMCkpci5nZXRDbGFzc05hbWUoKT09PSJJbnN0YW5jZWRNZXNoIiYmcy5nZXRDbGFzc05hbWUoKT09PSJNZXNoIj9yLmluc3RhbnRpYXRlSGllcmFyY2h5KHMse2RvTm90SW5zdGFudGlhdGU6dCYmdC5kb05vdEluc3RhbnRpYXRlfHwhMSxuZXdTb3VyY2VkTWVzaDpzfSxpKTpyLmluc3RhbnRpYXRlSGllcmFyY2h5KHMsdCxpKTtyZXR1cm4gc31nZXRDbGFzc05hbWUoKXtyZXR1cm4iTWVzaCJ9Z2V0IF9pc01lc2goKXtyZXR1cm4hMH10b1N0cmluZyhlKXtsZXQgdD1zdXBlci50b1N0cmluZyhlKTtpZih0Kz0iLCBuIHZlcnRpY2VzOiAiK3RoaXMuZ2V0VG90YWxWZXJ0aWNlcygpLHQrPSIsIHBhcmVudDogIisodGhpcy5fd2FpdGluZ1BhcmVudElkP3RoaXMuX3dhaXRpbmdQYXJlbnRJZDp0aGlzLnBhcmVudD90aGlzLnBhcmVudC5uYW1lOiJOT05FIiksdGhpcy5hbmltYXRpb25zKWZvcihsZXQgaT0wO2k8dGhpcy5hbmltYXRpb25zLmxlbmd0aDtpKyspdCs9IiwgYW5pbWF0aW9uWzBdOiAiK3RoaXMuYW5pbWF0aW9uc1tpXS50b1N0cmluZyhlKTtpZihlKWlmKHRoaXMuX2dlb21ldHJ5KXtjb25zdCBpPXRoaXMuZ2V0SW5kaWNlcygpLHM9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQpO3MmJmkmJih0Kz0iLCBmbGF0IHNoYWRpbmc6ICIrKHMubGVuZ3RoLzM9PT1pLmxlbmd0aD8iWUVTIjoiTk8iKSl9ZWxzZSB0Kz0iLCBmbGF0IHNoYWRpbmc6IFVOS05PV04iO3JldHVybiB0fV91bkJpbmRFZmZlY3QoKXtzdXBlci5fdW5CaW5kRWZmZWN0KCk7Zm9yKGNvbnN0IGUgb2YgdGhpcy5pbnN0YW5jZXMpZS5fdW5CaW5kRWZmZWN0KCl9Z2V0IGhhc0xPRExldmVscygpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fTE9ETGV2ZWxzLmxlbmd0aD4wfWdldExPRExldmVscygpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fTE9ETGV2ZWxzfV9zb3J0TE9ETGV2ZWxzKCl7Y29uc3QgZT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fdXNlTE9EU2NyZWVuQ292ZXJhZ2U/LTE6MTt0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fTE9ETGV2ZWxzLnNvcnQoKHQsaSk9PnQuZGlzdGFuY2VPclNjcmVlbkNvdmVyYWdlPGkuZGlzdGFuY2VPclNjcmVlbkNvdmVyYWdlP2U6dC5kaXN0YW5jZU9yU2NyZWVuQ292ZXJhZ2U+aS5kaXN0YW5jZU9yU2NyZWVuQ292ZXJhZ2U/LWU6MCl9YWRkTE9ETGV2ZWwoZSx0KXtpZih0JiZ0Ll9tYXN0ZXJNZXNoKXJldHVybiBPLldhcm4oIllvdSBjYW5ub3QgdXNlIGEgbWVzaCBhcyBMT0QgbGV2ZWwgdHdpY2UiKSx0aGlzO2NvbnN0IGk9bmV3IFduKGUsdCk7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9MT0RMZXZlbHMucHVzaChpKSx0JiYodC5fbWFzdGVyTWVzaD10aGlzKSx0aGlzLl9zb3J0TE9ETGV2ZWxzKCksdGhpc31nZXRMT0RMZXZlbEF0RGlzdGFuY2UoZSl7Y29uc3QgdD10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mbztmb3IobGV0IGk9MDtpPHQuX0xPRExldmVscy5sZW5ndGg7aSsrKXtjb25zdCBzPXQuX0xPRExldmVsc1tpXTtpZihzLmRpc3RhbmNlT3JTY3JlZW5Db3ZlcmFnZT09PWUpcmV0dXJuIHMubWVzaH1yZXR1cm4gbnVsbH1yZW1vdmVMT0RMZXZlbChlKXtjb25zdCB0PXRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvO2ZvcihsZXQgaT0wO2k8dC5fTE9ETGV2ZWxzLmxlbmd0aDtpKyspdC5fTE9ETGV2ZWxzW2ldLm1lc2g9PT1lJiYodC5fTE9ETGV2ZWxzLnNwbGljZShpLDEpLGUmJihlLl9tYXN0ZXJNZXNoPW51bGwpKTtyZXR1cm4gdGhpcy5fc29ydExPRExldmVscygpLHRoaXN9Z2V0TE9EKGUsdCl7Y29uc3QgaT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mbztpZighaS5fTE9ETGV2ZWxzfHxpLl9MT0RMZXZlbHMubGVuZ3RoPT09MClyZXR1cm4gdGhpcztjb25zdCBzPXR8fHRoaXMuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdTcGhlcmUscj1lLm1vZGU9PT1qLk9SVEhPR1JBUEhJQ19DQU1FUkE/ZS5taW5aOnMuY2VudGVyV29ybGQuc3VidHJhY3QoZS5nbG9iYWxQb3NpdGlvbikubGVuZ3RoKCk7bGV0IG49cixhPTE7aWYoaS5fdXNlTE9EU2NyZWVuQ292ZXJhZ2Upe2NvbnN0IG89ZS5zY3JlZW5BcmVhO2xldCBoPXMucmFkaXVzV29ybGQqZS5taW5aL3I7aD1oKmgqTWF0aC5QSSxuPWgvbyxhPS0xfWlmKGEqaS5fTE9ETGV2ZWxzW2kuX0xPRExldmVscy5sZW5ndGgtMV0uZGlzdGFuY2VPclNjcmVlbkNvdmVyYWdlPmEqbilyZXR1cm4gdGhpcy5vbkxPRExldmVsU2VsZWN0aW9uJiZ0aGlzLm9uTE9ETGV2ZWxTZWxlY3Rpb24obix0aGlzLHRoaXMpLHRoaXM7Zm9yKGxldCBvPTA7bzxpLl9MT0RMZXZlbHMubGVuZ3RoO28rKyl7Y29uc3QgaD1pLl9MT0RMZXZlbHNbb107aWYoYSpoLmRpc3RhbmNlT3JTY3JlZW5Db3ZlcmFnZTxhKm4pe2lmKGgubWVzaCl7aWYoaC5tZXNoLmRlbGF5TG9hZFN0YXRlPT09NClyZXR1cm4gaC5tZXNoLl9jaGVja0RlbGF5U3RhdGUoKSx0aGlzO2lmKGgubWVzaC5kZWxheUxvYWRTdGF0ZT09PTIpcmV0dXJuIHRoaXM7aC5tZXNoLl9wcmVBY3RpdmF0ZSgpLGgubWVzaC5fdXBkYXRlU3ViTWVzaGVzQm91bmRpbmdJbmZvKHRoaXMud29ybGRNYXRyaXhGcm9tQ2FjaGUpfXJldHVybiB0aGlzLm9uTE9ETGV2ZWxTZWxlY3Rpb24mJnRoaXMub25MT0RMZXZlbFNlbGVjdGlvbihuLHRoaXMsaC5tZXNoKSxoLm1lc2h9fXJldHVybiB0aGlzLm9uTE9ETGV2ZWxTZWxlY3Rpb24mJnRoaXMub25MT0RMZXZlbFNlbGVjdGlvbihuLHRoaXMsdGhpcyksdGhpc31nZXQgZ2VvbWV0cnkoKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnl9Z2V0VG90YWxWZXJ0aWNlcygpe3JldHVybiB0aGlzLl9nZW9tZXRyeT09PW51bGx8fHRoaXMuX2dlb21ldHJ5PT09dm9pZCAwPzA6dGhpcy5fZ2VvbWV0cnkuZ2V0VG90YWxWZXJ0aWNlcygpfWdldFZlcnRpY2VzRGF0YShlLHQsaSl7dmFyIHMscjtpZighdGhpcy5fZ2VvbWV0cnkpcmV0dXJuIG51bGw7bGV0IG49KHI9KHM9dGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlKT09PW51bGx8fHM9PT12b2lkIDA/dm9pZCAwOnMudmVydGV4QnVmZmVyc1tlXSk9PT1udWxsfHxyPT09dm9pZCAwP3ZvaWQgMDpyLmdldEZsb2F0RGF0YSh0aGlzLl9nZW9tZXRyeS5nZXRUb3RhbFZlcnRpY2VzKCksaXx8dCYmdGhpcy5fZ2VvbWV0cnkubWVzaGVzLmxlbmd0aCE9PTEpO3JldHVybiBufHwobj10aGlzLl9nZW9tZXRyeS5nZXRWZXJ0aWNlc0RhdGEoZSx0LGkpKSxufWdldFZlcnRleEJ1ZmZlcihlKXt2YXIgdCxpO3JldHVybiB0aGlzLl9nZW9tZXRyeT8oaT0odD10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UpPT09bnVsbHx8dD09PXZvaWQgMD92b2lkIDA6dC52ZXJ0ZXhCdWZmZXJzW2VdKSE9PW51bGwmJmkhPT12b2lkIDA/aTp0aGlzLl9nZW9tZXRyeS5nZXRWZXJ0ZXhCdWZmZXIoZSk6bnVsbH1pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZSl7dmFyIHQ7cmV0dXJuIHRoaXMuX2dlb21ldHJ5PygodD10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UpPT09bnVsbHx8dD09PXZvaWQgMD92b2lkIDA6dC52ZXJ0ZXhCdWZmZXJzW2VdKSE9PXZvaWQgMHx8dGhpcy5fZ2VvbWV0cnkuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUpOnRoaXMuX2RlbGF5SW5mbz90aGlzLl9kZWxheUluZm8uaW5kZXhPZihlKSE9PS0xOiExfWlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGUpe3ZhciB0LGk7cmV0dXJuIHRoaXMuX2dlb21ldHJ5PygoaT0odD10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UpPT09bnVsbHx8dD09PXZvaWQgMD92b2lkIDA6dC52ZXJ0ZXhCdWZmZXJzW2VdKT09PW51bGx8fGk9PT12b2lkIDA/dm9pZCAwOmkuaXNVcGRhdGFibGUoKSl8fHRoaXMuX2dlb21ldHJ5LmlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGUpOnRoaXMuX2RlbGF5SW5mbz90aGlzLl9kZWxheUluZm8uaW5kZXhPZihlKSE9PS0xOiExfWdldFZlcnRpY2VzRGF0YUtpbmRzKCl7aWYoIXRoaXMuX2dlb21ldHJ5KXtjb25zdCB0PW5ldyBBcnJheTtyZXR1cm4gdGhpcy5fZGVsYXlJbmZvJiZ0aGlzLl9kZWxheUluZm8uZm9yRWFjaChmdW5jdGlvbihpKXt0LnB1c2goaSl9KSx0fWNvbnN0IGU9dGhpcy5fZ2VvbWV0cnkuZ2V0VmVydGljZXNEYXRhS2luZHMoKTtpZih0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UpZm9yKGNvbnN0IHQgaW4gdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnMpZS5wdXNoKHQpO3JldHVybiBlfWdldFRvdGFsSW5kaWNlcygpe3JldHVybiB0aGlzLl9nZW9tZXRyeT90aGlzLl9nZW9tZXRyeS5nZXRUb3RhbEluZGljZXMoKTowfWdldEluZGljZXMoZSx0KXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/dGhpcy5fZ2VvbWV0cnkuZ2V0SW5kaWNlcyhlLHQpOltdfWdldCBpc0Jsb2NrZWQoKXtyZXR1cm4gdGhpcy5fbWFzdGVyTWVzaCE9PW51bGwmJnRoaXMuX21hc3Rlck1lc2ghPT12b2lkIDB9aXNSZWFkeShlPSExLHQ9ITEpe3ZhciBpLHMscixuLGEsbztpZih0aGlzLmRlbGF5TG9hZFN0YXRlPT09Mnx8IXN1cGVyLmlzUmVhZHkoZSkpcmV0dXJuITE7aWYoIXRoaXMuc3ViTWVzaGVzfHx0aGlzLnN1Yk1lc2hlcy5sZW5ndGg9PT0wfHwhZSlyZXR1cm4hMDtjb25zdCBoPXRoaXMuZ2V0RW5naW5lKCksbD10aGlzLmdldFNjZW5lKCksdT10fHxoLmdldENhcHMoKS5pbnN0YW5jZWRBcnJheXMmJih0aGlzLmluc3RhbmNlcy5sZW5ndGg+MHx8dGhpcy5oYXNUaGluSW5zdGFuY2VzKTt0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCgpO2NvbnN0IGQ9dGhpcy5tYXRlcmlhbHx8bC5kZWZhdWx0TWF0ZXJpYWw7aWYoZCl7aWYoZC5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcylmb3IoY29uc3QgXyBvZiB0aGlzLnN1Yk1lc2hlcyl7Y29uc3QgRT1fLmdldE1hdGVyaWFsKCk7aWYoRSl7aWYoRS5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcyl7aWYoIUUuaXNSZWFkeUZvclN1Yk1lc2godGhpcyxfLHUpKXJldHVybiExfWVsc2UgaWYoIUUuaXNSZWFkeSh0aGlzLHUpKXJldHVybiExfX1lbHNlIGlmKCFkLmlzUmVhZHkodGhpcyx1KSlyZXR1cm4hMX1jb25zdCBmPWguY3VycmVudFJlbmRlclBhc3NJZDtmb3IoY29uc3QgXyBvZiB0aGlzLmxpZ2h0U291cmNlcyl7Y29uc3QgRT1fLmdldFNoYWRvd0dlbmVyYXRvcnMoKTtpZighRSljb250aW51ZTtjb25zdCBtPUUudmFsdWVzKCk7Zm9yKGxldCB2PW0ubmV4dCgpO3YuZG9uZSE9PSEwO3Y9bS5uZXh0KCkpe2NvbnN0IFM9di52YWx1ZTtpZihTJiYoISghKChpPVMuZ2V0U2hhZG93TWFwKCkpPT09bnVsbHx8aT09PXZvaWQgMCkmJmkucmVuZGVyTGlzdCl8fCEoKHM9Uy5nZXRTaGFkb3dNYXAoKSk9PT1udWxsfHxzPT09dm9pZCAwKSYmcy5yZW5kZXJMaXN0JiYoKG49KHI9Uy5nZXRTaGFkb3dNYXAoKSk9PT1udWxsfHxyPT09dm9pZCAwP3ZvaWQgMDpyLnJlbmRlckxpc3QpPT09bnVsbHx8bj09PXZvaWQgMD92b2lkIDA6bi5pbmRleE9mKHRoaXMpKSE9PS0xKSl7Uy5nZXRTaGFkb3dNYXAoKSYmKGguY3VycmVudFJlbmRlclBhc3NJZD1TLmdldFNoYWRvd01hcCgpLnJlbmRlclBhc3NJZCk7Zm9yKGNvbnN0IHkgb2YgdGhpcy5zdWJNZXNoZXMpaWYoIVMuaXNSZWFkeSh5LHUsKG89KGE9eS5nZXRNYXRlcmlhbCgpKT09PW51bGx8fGE9PT12b2lkIDA/dm9pZCAwOmEubmVlZEFscGhhQmxlbmRpbmdGb3JNZXNoKHRoaXMpKSE9PW51bGwmJm8hPT12b2lkIDA/bzohMSkpcmV0dXJuIGguY3VycmVudFJlbmRlclBhc3NJZD1mLCExO2guY3VycmVudFJlbmRlclBhc3NJZD1mfX19Zm9yKGNvbnN0IF8gb2YgdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX0xPRExldmVscylpZihfLm1lc2gmJiFfLm1lc2guaXNSZWFkeSh1KSlyZXR1cm4hMTtyZXR1cm4hMH1nZXQgYXJlTm9ybWFsc0Zyb3plbigpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fYXJlTm9ybWFsc0Zyb3plbn1mcmVlemVOb3JtYWxzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9hcmVOb3JtYWxzRnJvemVuPSEwLHRoaXN9dW5mcmVlemVOb3JtYWxzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9hcmVOb3JtYWxzRnJvemVuPSExLHRoaXN9c2V0IG92ZXJyaWRlbkluc3RhbmNlQ291bnQoZSl7dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5vdmVycmlkZW5JbnN0YW5jZUNvdW50PWV9X3ByZUFjdGl2YXRlKCl7Y29uc3QgZT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mbyx0PXRoaXMuZ2V0U2NlbmUoKS5nZXRSZW5kZXJJZCgpO3JldHVybiBlLl9wcmVBY3RpdmF0ZUlkPT09dD90aGlzOihlLl9wcmVBY3RpdmF0ZUlkPXQsdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS52aXNpYmxlSW5zdGFuY2VzPW51bGwsdGhpcyl9X3ByZUFjdGl2YXRlRm9ySW50ZXJtZWRpYXRlUmVuZGVyaW5nKGUpe3JldHVybiB0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXMmJih0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXMuaW50ZXJtZWRpYXRlRGVmYXVsdFJlbmRlcklkPWUpLHRoaXN9X3JlZ2lzdGVySW5zdGFuY2VGb3JSZW5kZXJJZChlLHQpe3JldHVybiB0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXN8fCh0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXM9e2RlZmF1bHRSZW5kZXJJZDp0LHNlbGZEZWZhdWx0UmVuZGVySWQ6dGhpcy5fcmVuZGVySWR9KSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXNbdF18fCh0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzUmVuZGVySWQhPT12b2lkIDAmJnRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UuaXNGcm96ZW4mJih0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXNbdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5wcmV2aW91c1JlbmRlcklkXT1udWxsKSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzUmVuZGVySWQ9dCx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXNbdF09bmV3IEFycmF5KSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXNbdF0ucHVzaChlKSx0aGlzfV9hZnRlckNvbXB1dGVXb3JsZE1hdHJpeCgpe3N1cGVyLl9hZnRlckNvbXB1dGVXb3JsZE1hdHJpeCgpLHRoaXMuaGFzVGhpbkluc3RhbmNlcyYmKHRoaXMuZG9Ob3RTeW5jQm91bmRpbmdJbmZvfHx0aGlzLnRoaW5JbnN0YW5jZVJlZnJlc2hCb3VuZGluZ0luZm8oITEpKX1fcG9zdEFjdGl2YXRlKCl7dGhpcy5lZGdlc1NoYXJlV2l0aEluc3RhbmNlcyYmdGhpcy5lZGdlc1JlbmRlcmVyJiZ0aGlzLmVkZ2VzUmVuZGVyZXIuaXNFbmFibGVkJiZ0aGlzLl9yZW5kZXJpbmdHcm91cCYmKHRoaXMuX3JlbmRlcmluZ0dyb3VwLl9lZGdlc1JlbmRlcmVycy5wdXNoTm9EdXBsaWNhdGUodGhpcy5lZGdlc1JlbmRlcmVyKSx0aGlzLmVkZ2VzUmVuZGVyZXIuY3VzdG9tSW5zdGFuY2VzLnB1c2godGhpcy5nZXRXb3JsZE1hdHJpeCgpKSl9cmVmcmVzaEJvdW5kaW5nSW5mbyhlPSExLHQ9ITEpe2lmKHRoaXMuaGFzQm91bmRpbmdJbmZvJiZ0aGlzLmdldEJvdW5kaW5nSW5mbygpLmlzTG9ja2VkKXJldHVybiB0aGlzO2NvbnN0IGk9dGhpcy5nZW9tZXRyeT90aGlzLmdlb21ldHJ5LmJvdW5kaW5nQmlhczpudWxsO3JldHVybiB0aGlzLl9yZWZyZXNoQm91bmRpbmdJbmZvKHRoaXMuX2dldFBvc2l0aW9uRGF0YShlLHQpLGkpLHRoaXN9X2NyZWF0ZUdsb2JhbFN1Yk1lc2goZSl7Y29uc3QgdD10aGlzLmdldFRvdGFsVmVydGljZXMoKTtpZighdHx8IXRoaXMuZ2V0SW5kaWNlcygpKXJldHVybiBudWxsO2lmKHRoaXMuc3ViTWVzaGVzJiZ0aGlzLnN1Yk1lc2hlcy5sZW5ndGg+MCl7Y29uc3QgaT10aGlzLmdldEluZGljZXMoKTtpZighaSlyZXR1cm4gbnVsbDtjb25zdCBzPWkubGVuZ3RoO2xldCByPSExO2lmKGUpcj0hMDtlbHNlIGZvcihjb25zdCBuIG9mIHRoaXMuc3ViTWVzaGVzKXtpZihuLmluZGV4U3RhcnQrbi5pbmRleENvdW50PnMpe3I9ITA7YnJlYWt9aWYobi52ZXJ0aWNlc1N0YXJ0K24udmVydGljZXNDb3VudD50KXtyPSEwO2JyZWFrfX1pZighcilyZXR1cm4gdGhpcy5zdWJNZXNoZXNbMF19cmV0dXJuIHRoaXMucmVsZWFzZVN1Yk1lc2hlcygpLG5ldyB2dCgwLDAsdCwwLHRoaXMuZ2V0VG90YWxJbmRpY2VzKCksdGhpcyl9c3ViZGl2aWRlKGUpe2lmKGU8MSlyZXR1cm47Y29uc3QgdD10aGlzLmdldFRvdGFsSW5kaWNlcygpO2xldCBpPXQvZXwwLHM9MDtmb3IoO2klMyE9PTA7KWkrKzt0aGlzLnJlbGVhc2VTdWJNZXNoZXMoKTtmb3IobGV0IHI9MDtyPGUmJiEocz49dCk7cisrKXZ0LkNyZWF0ZUZyb21JbmRpY2VzKDAscyxyPT09ZS0xP3QtczppLHRoaXMpLHMrPWk7dGhpcy5zeW5jaHJvbml6ZUluc3RhbmNlcygpfXNldFZlcnRpY2VzRGF0YShlLHQsaT0hMSxzKXtpZih0aGlzLl9nZW9tZXRyeSl0aGlzLl9nZW9tZXRyeS5zZXRWZXJ0aWNlc0RhdGEoZSx0LGkscyk7ZWxzZXtjb25zdCByPW5ldyBlZTtyLnNldCh0LGUpO2NvbnN0IG49dGhpcy5nZXRTY2VuZSgpO25ldyBhdChhdC5SYW5kb21JZCgpLG4scixpLHRoaXMpfXJldHVybiB0aGlzfXJlbW92ZVZlcnRpY2VzRGF0YShlKXt0aGlzLl9nZW9tZXRyeSYmdGhpcy5fZ2VvbWV0cnkucmVtb3ZlVmVydGljZXNEYXRhKGUpfW1hcmtWZXJ0aWNlc0RhdGFBc1VwZGF0YWJsZShlLHQ9ITApe2NvbnN0IGk9dGhpcy5nZXRWZXJ0ZXhCdWZmZXIoZSk7IWl8fGkuaXNVcGRhdGFibGUoKT09PXR8fHRoaXMuc2V0VmVydGljZXNEYXRhKGUsdGhpcy5nZXRWZXJ0aWNlc0RhdGEoZSksdCl9c2V0VmVydGljZXNCdWZmZXIoZSx0PSEwKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnl8fCh0aGlzLl9nZW9tZXRyeT1hdC5DcmVhdGVHZW9tZXRyeUZvck1lc2godGhpcykpLHRoaXMuX2dlb21ldHJ5LnNldFZlcnRpY2VzQnVmZmVyKGUsbnVsbCx0KSx0aGlzfXVwZGF0ZVZlcnRpY2VzRGF0YShlLHQsaSxzKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/KHM/KHRoaXMubWFrZUdlb21ldHJ5VW5pcXVlKCksdGhpcy51cGRhdGVWZXJ0aWNlc0RhdGEoZSx0LGksITEpKTp0aGlzLl9nZW9tZXRyeS51cGRhdGVWZXJ0aWNlc0RhdGEoZSx0LGkpLHRoaXMpOnRoaXN9dXBkYXRlTWVzaFBvc2l0aW9ucyhlLHQ9ITApe2NvbnN0IGk9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQpO2lmKCFpKXJldHVybiB0aGlzO2lmKGUoaSksdGhpcy51cGRhdGVWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsaSwhMSwhMSksdCl7Y29uc3Qgcz10aGlzLmdldEluZGljZXMoKSxyPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCk7aWYoIXIpcmV0dXJuIHRoaXM7ZWUuQ29tcHV0ZU5vcm1hbHMoaSxzLHIpLHRoaXMudXBkYXRlVmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCxyLCExLCExKX1yZXR1cm4gdGhpc31tYWtlR2VvbWV0cnlVbmlxdWUoKXtpZighdGhpcy5fZ2VvbWV0cnkpcmV0dXJuIHRoaXM7aWYodGhpcy5fZ2VvbWV0cnkubWVzaGVzLmxlbmd0aD09PTEpcmV0dXJuIHRoaXM7Y29uc3QgZT10aGlzLl9nZW9tZXRyeSx0PXRoaXMuX2dlb21ldHJ5LmNvcHkoYXQuUmFuZG9tSWQoKSk7cmV0dXJuIGUucmVsZWFzZUZvck1lc2godGhpcywhMCksdC5hcHBseVRvTWVzaCh0aGlzKSx0aGlzfXNldEluZGljZXMoZSx0PW51bGwsaT0hMSl7aWYodGhpcy5fZ2VvbWV0cnkpdGhpcy5fZ2VvbWV0cnkuc2V0SW5kaWNlcyhlLHQsaSk7ZWxzZXtjb25zdCBzPW5ldyBlZTtzLmluZGljZXM9ZTtjb25zdCByPXRoaXMuZ2V0U2NlbmUoKTtuZXcgYXQoYXQuUmFuZG9tSWQoKSxyLHMsaSx0aGlzKX1yZXR1cm4gdGhpc311cGRhdGVJbmRpY2VzKGUsdCxpPSExKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/KHRoaXMuX2dlb21ldHJ5LnVwZGF0ZUluZGljZXMoZSx0LGkpLHRoaXMpOnRoaXN9dG9MZWZ0SGFuZGVkKCl7cmV0dXJuIHRoaXMuX2dlb21ldHJ5Pyh0aGlzLl9nZW9tZXRyeS50b0xlZnRIYW5kZWQoKSx0aGlzKTp0aGlzfV9iaW5kKGUsdCxpKXtpZighdGhpcy5fZ2VvbWV0cnkpcmV0dXJuIHRoaXM7Y29uc3Qgcz10aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCk7dGhpcy5tb3JwaFRhcmdldE1hbmFnZXImJnRoaXMubW9ycGhUYXJnZXRNYW5hZ2VyLmlzVXNpbmdUZXh0dXJlRm9yVGFyZ2V0cyYmdGhpcy5tb3JwaFRhcmdldE1hbmFnZXIuX2JpbmQodCk7bGV0IHI7aWYodGhpcy5fdW5JbmRleGVkKXI9bnVsbDtlbHNlIHN3aXRjaChpKXtjYXNlIFAuUG9pbnRGaWxsTW9kZTpyPW51bGw7YnJlYWs7Y2FzZSBQLldpcmVGcmFtZUZpbGxNb2RlOnI9ZS5fZ2V0TGluZXNJbmRleEJ1ZmZlcih0aGlzLmdldEluZGljZXMoKSxzKTticmVhaztkZWZhdWx0OmNhc2UgUC5UcmlhbmdsZUZpbGxNb2RlOnI9dGhpcy5fZ2VvbWV0cnkuZ2V0SW5kZXhCdWZmZXIoKTticmVha31yZXR1cm4hdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlfHx0aGlzLmhhc1RoaW5JbnN0YW5jZXM/dGhpcy5fZ2VvbWV0cnkuX2JpbmQodCxyKTp0aGlzLl9nZW9tZXRyeS5fYmluZCh0LHIsdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnMsdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEFycmF5T2JqZWN0cyksdGhpc31fZHJhdyhlLHQsaSl7aWYoIXRoaXMuX2dlb21ldHJ5fHwhdGhpcy5fZ2VvbWV0cnkuZ2V0VmVydGV4QnVmZmVycygpfHwhdGhpcy5fdW5JbmRleGVkJiYhdGhpcy5fZ2VvbWV0cnkuZ2V0SW5kZXhCdWZmZXIoKSlyZXR1cm4gdGhpczt0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZWZvcmVEcmF3T2JzZXJ2YWJsZSYmdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmVmb3JlRHJhd09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2NvbnN0IHI9dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpO3JldHVybiB0aGlzLl91bkluZGV4ZWR8fHQ9PVAuUG9pbnRGaWxsTW9kZT9yLmRyYXdBcnJheXNUeXBlKHQsZS52ZXJ0aWNlc1N0YXJ0LGUudmVydGljZXNDb3VudCx0aGlzLmZvcmNlZEluc3RhbmNlQ291bnR8fGkpOnQ9PVAuV2lyZUZyYW1lRmlsbE1vZGU/ci5kcmF3RWxlbWVudHNUeXBlKHQsMCxlLl9saW5lc0luZGV4Q291bnQsdGhpcy5mb3JjZWRJbnN0YW5jZUNvdW50fHxpKTpyLmRyYXdFbGVtZW50c1R5cGUodCxlLmluZGV4U3RhcnQsZS5pbmRleENvdW50LHRoaXMuZm9yY2VkSW5zdGFuY2VDb3VudHx8aSksdGhpc31yZWdpc3RlckJlZm9yZVJlbmRlcihlKXtyZXR1cm4gdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGUpLHRoaXN9dW5yZWdpc3RlckJlZm9yZVJlbmRlcihlKXtyZXR1cm4gdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlQ2FsbGJhY2soZSksdGhpc31yZWdpc3RlckFmdGVyUmVuZGVyKGUpe3JldHVybiB0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLmFkZChlKSx0aGlzfXVucmVnaXN0ZXJBZnRlclJlbmRlcihlKXtyZXR1cm4gdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmVDYWxsYmFjayhlKSx0aGlzfV9nZXRJbnN0YW5jZXNSZW5kZXJMaXN0KGUsdD0hMSl7aWYodGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pc0Zyb3plbil7aWYodClyZXR1cm4gdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5iYXRjaENhY2hlUmVwbGFjZW1lbnRNb2RlSW5Gcm96ZW5Nb2RlLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nW2VdPSExLHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UuYmF0Y2hDYWNoZVJlcGxhY2VtZW50TW9kZUluRnJvemVuTW9kZS5yZW5kZXJTZWxmW2VdPSEwLHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UuYmF0Y2hDYWNoZVJlcGxhY2VtZW50TW9kZUluRnJvemVuTW9kZTtpZih0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzQmF0Y2gpcmV0dXJuIHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UucHJldmlvdXNCYXRjaH1jb25zdCBpPXRoaXMuZ2V0U2NlbmUoKSxzPWkuX2lzSW5JbnRlcm1lZGlhdGVSZW5kZXJpbmcoKSxyPXM/dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fb25seUZvckluc3RhbmNlc0ludGVybWVkaWF0ZTp0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9vbmx5Rm9ySW5zdGFuY2VzLG49dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5iYXRjaENhY2hlO2lmKG4ubXVzdFJldHVybj0hMSxuLnJlbmRlclNlbGZbZV09dHx8IXImJnRoaXMuaXNFbmFibGVkKCkmJnRoaXMuaXNWaXNpYmxlLG4udmlzaWJsZUluc3RhbmNlc1tlXT1udWxsLHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UudmlzaWJsZUluc3RhbmNlcyYmIXQpe2NvbnN0IGE9dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS52aXNpYmxlSW5zdGFuY2VzLG89aS5nZXRSZW5kZXJJZCgpLGg9cz9hLmludGVybWVkaWF0ZURlZmF1bHRSZW5kZXJJZDphLmRlZmF1bHRSZW5kZXJJZDtuLnZpc2libGVJbnN0YW5jZXNbZV09YVtvXSwhbi52aXNpYmxlSW5zdGFuY2VzW2VdJiZoJiYobi52aXNpYmxlSW5zdGFuY2VzW2VdPWFbaF0pfXJldHVybiBuLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nW2VdPSF0JiZ0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nJiZuLnZpc2libGVJbnN0YW5jZXNbZV0hPT1udWxsJiZuLnZpc2libGVJbnN0YW5jZXNbZV0hPT12b2lkIDAsdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5wcmV2aW91c0JhdGNoPW4sbn1fcmVuZGVyV2l0aEluc3RhbmNlcyhlLHQsaSxzLHIpe3ZhciBuO2NvbnN0IGE9aS52aXNpYmxlSW5zdGFuY2VzW2UuX2lkXSxvPWE/YS5sZW5ndGg6MCxoPXRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UsbD1oLmluc3RhbmNlc0J1ZmZlclNpemU7bGV0IHU9aC5pbnN0YW5jZXNCdWZmZXIsZD1oLmluc3RhbmNlc1ByZXZpb3VzQnVmZmVyO2NvbnN0IF89KG8rMSkqMTYqNDtmb3IoO2guaW5zdGFuY2VzQnVmZmVyU2l6ZTxfOyloLmluc3RhbmNlc0J1ZmZlclNpemUqPTI7KCFoLmluc3RhbmNlc0RhdGF8fGwhPWguaW5zdGFuY2VzQnVmZmVyU2l6ZSkmJihoLmluc3RhbmNlc0RhdGE9bmV3IEZsb2F0MzJBcnJheShoLmluc3RhbmNlc0J1ZmZlclNpemUvNCkpLCh0aGlzLl9zY2VuZS5uZWVkc1ByZXZpb3VzV29ybGRNYXRyaWNlcyYmIWguaW5zdGFuY2VzUHJldmlvdXNEYXRhfHxsIT1oLmluc3RhbmNlc0J1ZmZlclNpemUpJiYoaC5pbnN0YW5jZXNQcmV2aW91c0RhdGE9bmV3IEZsb2F0MzJBcnJheShoLmluc3RhbmNlc0J1ZmZlclNpemUvNCkpO2xldCBFPTAsbT0wO2NvbnN0IHY9aS5yZW5kZXJTZWxmW2UuX2lkXSxTPSF1fHxsIT09aC5pbnN0YW5jZXNCdWZmZXJTaXplfHx0aGlzLl9zY2VuZS5uZWVkc1ByZXZpb3VzV29ybGRNYXRyaWNlcyYmIWguaW5zdGFuY2VzUHJldmlvdXNCdWZmZXI7aWYoIXRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UubWFudWFsVXBkYXRlJiYoIWguaXNGcm96ZW58fFMpKXtjb25zdCB5PXRoaXMuZ2V0V29ybGRNYXRyaXgoKTtpZih2JiYodGhpcy5fc2NlbmUubmVlZHNQcmV2aW91c1dvcmxkTWF0cmljZXMmJihoLm1hc3Rlck1lc2hQcmV2aW91c1dvcmxkTWF0cml4PyhoLm1hc3Rlck1lc2hQcmV2aW91c1dvcmxkTWF0cml4LmNvcHlUb0FycmF5KGguaW5zdGFuY2VzUHJldmlvdXNEYXRhLEUpLGgubWFzdGVyTWVzaFByZXZpb3VzV29ybGRNYXRyaXguY29weUZyb20oeSkpOihoLm1hc3Rlck1lc2hQcmV2aW91c1dvcmxkTWF0cml4PXkuY2xvbmUoKSxoLm1hc3Rlck1lc2hQcmV2aW91c1dvcmxkTWF0cml4LmNvcHlUb0FycmF5KGguaW5zdGFuY2VzUHJldmlvdXNEYXRhLEUpKSkseS5jb3B5VG9BcnJheShoLmluc3RhbmNlc0RhdGEsRSksRSs9MTYsbSsrKSxhKXtpZihXLklOU1RBTkNFRE1FU0hfU09SVF9UUkFOU1BBUkVOVCYmdGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhJiYoISgobj1lLmdldE1hdGVyaWFsKCkpPT09bnVsbHx8bj09PXZvaWQgMCkmJm4ubmVlZEFscGhhQmxlbmRpbmdGb3JNZXNoKGUuZ2V0UmVuZGVyaW5nTWVzaCgpKSkpe2NvbnN0IEE9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLmdsb2JhbFBvc2l0aW9uO2ZvcihsZXQgQz0wO0M8YS5sZW5ndGg7QysrKXtjb25zdCBiPWFbQ107Yi5fZGlzdGFuY2VUb0NhbWVyYT1wLkRpc3RhbmNlKGIuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdTcGhlcmUuY2VudGVyV29ybGQsQSl9YS5zb3J0KChDLGIpPT5DLl9kaXN0YW5jZVRvQ2FtZXJhPmIuX2Rpc3RhbmNlVG9DYW1lcmE/LTE6Qy5fZGlzdGFuY2VUb0NhbWVyYTxiLl9kaXN0YW5jZVRvQ2FtZXJhPzE6MCl9Zm9yKGxldCBBPTA7QTxhLmxlbmd0aDtBKyspe2NvbnN0IEM9YVtBXSxiPUMuZ2V0V29ybGRNYXRyaXgoKTtiLmNvcHlUb0FycmF5KGguaW5zdGFuY2VzRGF0YSxFKSx0aGlzLl9zY2VuZS5uZWVkc1ByZXZpb3VzV29ybGRNYXRyaWNlcyYmKEMuX3ByZXZpb3VzV29ybGRNYXRyaXg/KEMuX3ByZXZpb3VzV29ybGRNYXRyaXguY29weVRvQXJyYXkoaC5pbnN0YW5jZXNQcmV2aW91c0RhdGEsRSksQy5fcHJldmlvdXNXb3JsZE1hdHJpeC5jb3B5RnJvbShiKSk6KEMuX3ByZXZpb3VzV29ybGRNYXRyaXg9Yi5jbG9uZSgpLEMuX3ByZXZpb3VzV29ybGRNYXRyaXguY29weVRvQXJyYXkoaC5pbnN0YW5jZXNQcmV2aW91c0RhdGEsRSkpKSxFKz0xNixtKyt9fX1lbHNlIG09KHY/MTowKStvO3JldHVybiBTPyh1JiZ1LmRpc3Bvc2UoKSxkJiZkLmRpc3Bvc2UoKSx1PW5ldyAkaShyLGguaW5zdGFuY2VzRGF0YSwhMCwxNiwhMSwhMCksaC5pbnN0YW5jZXNCdWZmZXI9dSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2V8fCh0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2U9e2RhdGE6e30sdmVydGV4QnVmZmVyczp7fSxzdHJpZGVzOnt9LHNpemVzOnt9LHZlcnRleEFycmF5T2JqZWN0czp0aGlzLmdldEVuZ2luZSgpLmdldENhcHMoKS52ZXJ0ZXhBcnJheU9iamVjdD97fTp2b2lkIDB9KSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycy53b3JsZDA9dS5jcmVhdGVWZXJ0ZXhCdWZmZXIoIndvcmxkMCIsMCw0KSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycy53b3JsZDE9dS5jcmVhdGVWZXJ0ZXhCdWZmZXIoIndvcmxkMSIsNCw0KSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycy53b3JsZDI9dS5jcmVhdGVWZXJ0ZXhCdWZmZXIoIndvcmxkMiIsOCw0KSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycy53b3JsZDM9dS5jcmVhdGVWZXJ0ZXhCdWZmZXIoIndvcmxkMyIsMTIsNCksdGhpcy5fc2NlbmUubmVlZHNQcmV2aW91c1dvcmxkTWF0cmljZXMmJihkPW5ldyAkaShyLGguaW5zdGFuY2VzUHJldmlvdXNEYXRhLCEwLDE2LCExLCEwKSxoLmluc3RhbmNlc1ByZXZpb3VzQnVmZmVyPWQsdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnMucHJldmlvdXNXb3JsZDA9ZC5jcmVhdGVWZXJ0ZXhCdWZmZXIoInByZXZpb3VzV29ybGQwIiwwLDQpLHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS52ZXJ0ZXhCdWZmZXJzLnByZXZpb3VzV29ybGQxPWQuY3JlYXRlVmVydGV4QnVmZmVyKCJwcmV2aW91c1dvcmxkMSIsNCw0KSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycy5wcmV2aW91c1dvcmxkMj1kLmNyZWF0ZVZlcnRleEJ1ZmZlcigicHJldmlvdXNXb3JsZDIiLDgsNCksdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnMucHJldmlvdXNXb3JsZDM9ZC5jcmVhdGVWZXJ0ZXhCdWZmZXIoInByZXZpb3VzV29ybGQzIiwxMiw0KSksdGhpcy5faW52YWxpZGF0ZUluc3RhbmNlVmVydGV4QXJyYXlPYmplY3QoKSk6KCF0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmlzRnJvemVufHx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmZvcmNlTWF0cml4VXBkYXRlcykmJih1LnVwZGF0ZURpcmVjdGx5KGguaW5zdGFuY2VzRGF0YSwwLG0pLHRoaXMuX3NjZW5lLm5lZWRzUHJldmlvdXNXb3JsZE1hdHJpY2VzJiYoIXRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UubWFudWFsVXBkYXRlfHx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzTWFudWFsVXBkYXRlKSYmZC51cGRhdGVEaXJlY3RseShoLmluc3RhbmNlc1ByZXZpb3VzRGF0YSwwLG0pKSx0aGlzLl9wcm9jZXNzSW5zdGFuY2VkQnVmZmVycyhhLHYpLHRoaXMuZ2V0U2NlbmUoKS5fYWN0aXZlSW5kaWNlcy5hZGRDb3VudChlLmluZGV4Q291bnQqbSwhMSksci5fY3VycmVudERyYXdDb250ZXh0JiYoci5fY3VycmVudERyYXdDb250ZXh0LnVzZUluc3RhbmNpbmc9ITApLHRoaXMuX2JpbmQoZSxzLHQpLHRoaXMuX2RyYXcoZSx0LG0pLHRoaXMuX3NjZW5lLm5lZWRzUHJldmlvdXNXb3JsZE1hdHJpY2VzJiYhUyYmdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5tYW51YWxVcGRhdGUmJighdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pc0Zyb3plbnx8dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5mb3JjZU1hdHJpeFVwZGF0ZXMpJiYhdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5wcmV2aW91c01hbnVhbFVwZGF0ZSYmZC51cGRhdGVEaXJlY3RseShoLmluc3RhbmNlc0RhdGEsMCxtKSxyLnVuYmluZEluc3RhbmNlQXR0cmlidXRlcygpLHRoaXN9X3JlbmRlcldpdGhUaGluSW5zdGFuY2VzKGUsdCxpLHMpe3ZhciByLG47Y29uc3QgYT0obj0ocj10aGlzLl90aGluSW5zdGFuY2VEYXRhU3RvcmFnZSk9PT1udWxsfHxyPT09dm9pZCAwP3ZvaWQgMDpyLmluc3RhbmNlc0NvdW50KSE9PW51bGwmJm4hPT12b2lkIDA/bjowO3RoaXMuZ2V0U2NlbmUoKS5fYWN0aXZlSW5kaWNlcy5hZGRDb3VudChlLmluZGV4Q291bnQqYSwhMSkscy5fY3VycmVudERyYXdDb250ZXh0JiYocy5fY3VycmVudERyYXdDb250ZXh0LnVzZUluc3RhbmNpbmc9ITApLHRoaXMuX2JpbmQoZSxpLHQpLHRoaXMuX2RyYXcoZSx0LGEpLHRoaXMuX3NjZW5lLm5lZWRzUHJldmlvdXNXb3JsZE1hdHJpY2VzJiYhdGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UucHJldmlvdXNNYXRyaXhEYXRhJiZ0aGlzLl90aGluSW5zdGFuY2VEYXRhU3RvcmFnZS5tYXRyaXhEYXRhJiYodGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UucHJldmlvdXNNYXRyaXhCdWZmZXI/dGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UucHJldmlvdXNNYXRyaXhCdWZmZXIudXBkYXRlRGlyZWN0bHkodGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UubWF0cml4RGF0YSwwLGEpOnRoaXMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzTWF0cml4QnVmZmVyPXRoaXMuX3RoaW5JbnN0YW5jZUNyZWF0ZU1hdHJpeEJ1ZmZlcigicHJldmlvdXNXb3JsZCIsdGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UubWF0cml4RGF0YSwhMSkpLHMudW5iaW5kSW5zdGFuY2VBdHRyaWJ1dGVzKCl9X3Byb2Nlc3NJbnN0YW5jZWRCdWZmZXJzKGUsdCl7fV9wcm9jZXNzUmVuZGVyaW5nKGUsdCxpLHMscixuLGEsbyl7Y29uc3QgaD10aGlzLmdldFNjZW5lKCksbD1oLmdldEVuZ2luZSgpO2lmKG4mJnQuZ2V0UmVuZGVyaW5nTWVzaCgpLmhhc1RoaW5JbnN0YW5jZXMpcmV0dXJuIHRoaXMuX3JlbmRlcldpdGhUaGluSW5zdGFuY2VzKHQscyxpLGwpLHRoaXM7aWYobil0aGlzLl9yZW5kZXJXaXRoSW5zdGFuY2VzKHQscyxyLGksbCk7ZWxzZXtsLl9jdXJyZW50RHJhd0NvbnRleHQmJihsLl9jdXJyZW50RHJhd0NvbnRleHQudXNlSW5zdGFuY2luZz0hMSk7bGV0IHU9MDtyLnJlbmRlclNlbGZbdC5faWRdJiYoYSYmYSghMSxlLmdldFdvcmxkTWF0cml4KCksbyksdSsrLHRoaXMuX2RyYXcodCxzLHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2Uub3ZlcnJpZGVuSW5zdGFuY2VDb3VudCkpO2NvbnN0IGQ9ci52aXNpYmxlSW5zdGFuY2VzW3QuX2lkXTtpZihkKXtjb25zdCBmPWQubGVuZ3RoO3UrPWY7Zm9yKGxldCBfPTA7XzxmO18rKyl7Y29uc3QgbT1kW19dLmdldFdvcmxkTWF0cml4KCk7YSYmYSghMCxtLG8pLHRoaXMuX2RyYXcodCxzKX19aC5fYWN0aXZlSW5kaWNlcy5hZGRDb3VudCh0LmluZGV4Q291bnQqdSwhMSl9cmV0dXJuIHRoaXN9X3JlYnVpbGQoZT0hMSl7aWYodGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pbnN0YW5jZXNCdWZmZXImJihlJiZ0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0J1ZmZlci5kaXNwb3NlKCksdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pbnN0YW5jZXNCdWZmZXI9bnVsbCksdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlKXtmb3IoY29uc3QgdCBpbiB0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycyl7Y29uc3QgaT10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVyc1t0XTtpJiYoZSYmaS5kaXNwb3NlKCksdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnNbdF09bnVsbCl9dGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEFycmF5T2JqZWN0cyYmKHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS52ZXJ0ZXhBcnJheU9iamVjdHM9e30pfXRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbD1udWxsLHN1cGVyLl9yZWJ1aWxkKGUpfV9mcmVlemUoKXtpZih0aGlzLnN1Yk1lc2hlcyl7Zm9yKGxldCBlPTA7ZTx0aGlzLnN1Yk1lc2hlcy5sZW5ndGg7ZSsrKXRoaXMuX2dldEluc3RhbmNlc1JlbmRlckxpc3QoZSk7dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsPW51bGwsdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pc0Zyb3plbj0hMH19X3VuRnJlZXplKCl7dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pc0Zyb3plbj0hMSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzQmF0Y2g9bnVsbH1yZW5kZXIoZSx0LGkpe3ZhciBzLHIsbjtjb25zdCBhPXRoaXMuZ2V0U2NlbmUoKTtpZih0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9pc0FjdGl2ZUludGVybWVkaWF0ZT90aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9pc0FjdGl2ZUludGVybWVkaWF0ZT0hMTp0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9pc0FjdGl2ZT0hMSx0aGlzLl9jaGVja09jY2x1c2lvblF1ZXJ5KCkmJiF0aGlzLl9vY2NsdXNpb25EYXRhU3RvcmFnZS5mb3JjZVJlbmRlcmluZ1doZW5PY2NsdWRlZClyZXR1cm4gdGhpcztjb25zdCBvPXRoaXMuX2dldEluc3RhbmNlc1JlbmRlckxpc3QoZS5faWQsISFpKTtpZihvLm11c3RSZXR1cm4pcmV0dXJuIHRoaXM7aWYoIXRoaXMuX2dlb21ldHJ5fHwhdGhpcy5fZ2VvbWV0cnkuZ2V0VmVydGV4QnVmZmVycygpfHwhdGhpcy5fdW5JbmRleGVkJiYhdGhpcy5fZ2VvbWV0cnkuZ2V0SW5kZXhCdWZmZXIoKSlyZXR1cm4gdGhpcztjb25zdCBoPWEuZ2V0RW5naW5lKCk7bGV0IGw9MCx1PW51bGw7dGhpcy5pZ25vcmVDYW1lcmFNYXhaJiZhLmFjdGl2ZUNhbWVyYSYmIWEuX2lzSW5JbnRlcm1lZGlhdGVSZW5kZXJpbmcoKSYmKGw9YS5hY3RpdmVDYW1lcmEubWF4Wix1PWEuYWN0aXZlQ2FtZXJhLGEuYWN0aXZlQ2FtZXJhLm1heFo9MCxhLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCghMCkpLHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkJlZm9yZVJlbmRlck9ic2VydmFibGUmJnRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkJlZm9yZVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2NvbnN0IGQ9ZS5nZXRSZW5kZXJpbmdNZXNoKCksZj1vLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nW2UuX2lkXXx8ZC5oYXNUaGluSW5zdGFuY2VzfHwhIXRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZSYmIWUuZ2V0TWVzaCgpLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hY3RBc1JlZ3VsYXJNZXNoLF89dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZSxFPWUuZ2V0TWF0ZXJpYWwoKTtpZighRSlyZXR1cm4gdSYmKHUubWF4Wj1sLGEudXBkYXRlVHJhbnNmb3JtTWF0cml4KCEwKSksdGhpcztpZighXy5pc0Zyb3plbnx8IXRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbHx8dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsIT09RSl7aWYoRS5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcyl7aWYoIUUuaXNSZWFkeUZvclN1Yk1lc2godGhpcyxlLGYpKXJldHVybiB1JiYodS5tYXhaPWwsYS51cGRhdGVUcmFuc2Zvcm1NYXRyaXgoITApKSx0aGlzfWVsc2UgaWYoIUUuaXNSZWFkeSh0aGlzLGYpKXJldHVybiB1JiYodS5tYXhaPWwsYS51cGRhdGVUcmFuc2Zvcm1NYXRyaXgoITApKSx0aGlzO3RoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbD1FfWVsc2UgaWYoRS5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcyYmISghKChzPWUuZWZmZWN0KT09PW51bGx8fHM9PT12b2lkIDApJiZzLl93YXNQcmV2aW91c2x5UmVhZHkpfHwhRS5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcyYmISghKChyPUUuZ2V0RWZmZWN0KCkpPT09bnVsbHx8cj09PXZvaWQgMCkmJnIuX3dhc1ByZXZpb3VzbHlSZWFkeSkpcmV0dXJuIHUmJih1Lm1heFo9bCxhLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCghMCkpLHRoaXM7dCYmaC5zZXRBbHBoYU1vZGUodGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsLmFscGhhTW9kZSk7bGV0IG07dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsLl9zdG9yZUVmZmVjdE9uU3ViTWVzaGVzP209ZS5fZHJhd1dyYXBwZXI6bT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fZWZmZWN0aXZlTWF0ZXJpYWwuX2dldERyYXdXcmFwcGVyKCk7Y29uc3Qgdj0obj1tPT1udWxsP3ZvaWQgMDptLmVmZmVjdCkhPT1udWxsJiZuIT09dm9pZCAwP246bnVsbDtmb3IoY29uc3QgTCBvZiBhLl9iZWZvcmVSZW5kZXJpbmdNZXNoU3RhZ2UpTC5hY3Rpb24odGhpcyxlLG8sdik7aWYoIW18fCF2KXJldHVybiB1JiYodS5tYXhaPWwsYS51cGRhdGVUcmFuc2Zvcm1NYXRyaXgoITApKSx0aGlzO2NvbnN0IFM9aXx8dGhpcztsZXQgeTtpZighXy5pc0Zyb3plbiYmKHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbC5iYWNrRmFjZUN1bGxpbmd8fHRoaXMub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbiE9PW51bGwpKXtjb25zdCBMPVMuX2dldFdvcmxkTWF0cml4RGV0ZXJtaW5hbnQoKTt5PXRoaXMub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbix5PT1udWxsJiYoeT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fZWZmZWN0aXZlTWF0ZXJpYWwuc2lkZU9yaWVudGF0aW9uKSxMPDAmJih5PXk9PT1QLkNsb2NrV2lzZVNpZGVPcmllbnRhdGlvbj9QLkNvdW50ZXJDbG9ja1dpc2VTaWRlT3JpZW50YXRpb246UC5DbG9ja1dpc2VTaWRlT3JpZW50YXRpb24pLF8uc2lkZU9yaWVudGF0aW9uPXl9ZWxzZSB5PV8uc2lkZU9yaWVudGF0aW9uO2NvbnN0IEE9dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsLl9wcmVCaW5kKG0seSk7dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsLmZvcmNlRGVwdGhXcml0ZSYmaC5zZXREZXB0aFdyaXRlKCEwKTtjb25zdCBDPWEuZm9yY2VQb2ludHNDbG91ZD9QLlBvaW50RmlsbE1vZGU6YS5mb3JjZVdpcmVmcmFtZT9QLldpcmVGcmFtZUZpbGxNb2RlOnRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbC5maWxsTW9kZTt0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZWZvcmVCaW5kT2JzZXJ2YWJsZSYmdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmVmb3JlQmluZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLGZ8fHRoaXMuX2JpbmQoZSx2LEMpO2NvbnN0IGI9dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsLE09Uy5nZXRXb3JsZE1hdHJpeCgpO2IuX3N0b3JlRWZmZWN0T25TdWJNZXNoZXM/Yi5iaW5kRm9yU3ViTWVzaChNLHRoaXMsZSk6Yi5iaW5kKE0sdGhpcyksIWIuYmFja0ZhY2VDdWxsaW5nJiZiLnNlcGFyYXRlQ3VsbGluZ1Bhc3MmJihoLnNldFN0YXRlKCEwLGIuek9mZnNldCwhMSwhQSxiLmN1bGxCYWNrRmFjZXMsYi5zdGVuY2lsLGIuek9mZnNldFVuaXRzKSx0aGlzLl9wcm9jZXNzUmVuZGVyaW5nKHRoaXMsZSx2LEMsbyxmLHRoaXMuX29uQmVmb3JlRHJhdyx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fZWZmZWN0aXZlTWF0ZXJpYWwpLGguc2V0U3RhdGUoITAsYi56T2Zmc2V0LCExLEEsYi5jdWxsQmFja0ZhY2VzLGIuc3RlbmNpbCxiLnpPZmZzZXRVbml0cyksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmV0d2VlblBhc3NPYnNlcnZhYmxlJiZ0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZXR3ZWVuUGFzc09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpKSx0aGlzLl9wcm9jZXNzUmVuZGVyaW5nKHRoaXMsZSx2LEMsbyxmLHRoaXMuX29uQmVmb3JlRHJhdyx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fZWZmZWN0aXZlTWF0ZXJpYWwpLHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbC51bmJpbmQoKTtmb3IoY29uc3QgTCBvZiBhLl9hZnRlclJlbmRlcmluZ01lc2hTdGFnZSlMLmFjdGlvbih0aGlzLGUsbyx2KTtyZXR1cm4gdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlJiZ0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25BZnRlclJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHUmJih1Lm1heFo9bCxhLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCghMCkpLGEucGVyZm9ybWFuY2VQcmlvcml0eT09PUN0LkFnZ3Jlc3NpdmUmJiFfLmlzRnJvemVuJiZ0aGlzLl9mcmVlemUoKSx0aGlzfWNsZWFuTWF0cml4V2VpZ2h0cygpe3RoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTWF0cmljZXNXZWlnaHRzS2luZCkmJih0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCk/dGhpcy5fbm9ybWFsaXplU2tpbldlaWdodHNBbmRFeHRyYSgpOnRoaXMuX25vcm1hbGl6ZVNraW5Gb3VyV2VpZ2h0cygpKX1fbm9ybWFsaXplU2tpbkZvdXJXZWlnaHRzKCl7Y29uc3QgZT10aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpLHQ9ZS5sZW5ndGg7Zm9yKGxldCBpPTA7aTx0O2krPTQpe2NvbnN0IHM9ZVtpXStlW2krMV0rZVtpKzJdK2VbaSszXTtpZihzPT09MCllW2ldPTE7ZWxzZXtjb25zdCByPTEvcztlW2ldKj1yLGVbaSsxXSo9cixlW2krMl0qPXIsZVtpKzNdKj1yfX10aGlzLnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQsZSl9X25vcm1hbGl6ZVNraW5XZWlnaHRzQW5kRXh0cmEoKXtjb25zdCBlPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kKSx0PXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCksaT10Lmxlbmd0aDtmb3IobGV0IHM9MDtzPGk7cys9NCl7bGV0IHI9dFtzXSt0W3MrMV0rdFtzKzJdK3RbcyszXTtpZihyKz1lW3NdK2VbcysxXStlW3MrMl0rZVtzKzNdLHI9PT0wKXRbc109MTtlbHNle2NvbnN0IG49MS9yO3Rbc10qPW4sdFtzKzFdKj1uLHRbcysyXSo9bix0W3MrM10qPW4sZVtzXSo9bixlW3MrMV0qPW4sZVtzKzJdKj1uLGVbcyszXSo9bn19dGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc1dlaWdodHNLaW5kLHQpLHRoaXMuc2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCxlKX12YWxpZGF0ZVNraW5uaW5nKCl7Y29uc3QgZT10aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCksdD10aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpO2lmKHQ9PT1udWxsfHx0aGlzLnNrZWxldG9uPT1udWxsKXJldHVybntza2lubmVkOiExLHZhbGlkOiEwLHJlcG9ydDoibm90IHNraW5uZWQifTtjb25zdCBpPXQubGVuZ3RoO2xldCBzPTAscj0wLG49MCxhPTA7Y29uc3Qgbz1lPT09bnVsbD80OjgsaD1uZXcgQXJyYXk7Zm9yKGxldCBtPTA7bTw9bzttKyspaFttXT0wO2NvbnN0IGw9LjAwMTtmb3IobGV0IG09MDttPGk7bSs9NCl7bGV0IHY9dFttXSxTPXYseT1TPT09MD8wOjE7Zm9yKGxldCBBPTE7QTxvO0ErKyl7Y29uc3QgQz1BPDQ/dFttK0FdOmVbbStBLTRdO0M+diYmcysrLEMhPT0wJiZ5KyssUys9Qyx2PUN9aWYoaFt5XSsrLHk+biYmKG49eSksUz09PTApcisrO2Vsc2V7Y29uc3QgQT0xL1M7bGV0IEM9MDtmb3IobGV0IGI9MDtiPG87YisrKWI8ND9DKz1NYXRoLmFicyh0W20rYl0tdFttK2JdKkEpOkMrPU1hdGguYWJzKGVbbStiLTRdLWVbbStiLTRdKkEpO0M+bCYmYSsrfX1jb25zdCB1PXRoaXMuc2tlbGV0b24uYm9uZXMubGVuZ3RoLGQ9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kKSxmPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kKTtsZXQgXz0wO2ZvcihsZXQgbT0wO208aTttKz00KWZvcihsZXQgdj0wO3Y8bzt2Kyspe2NvbnN0IFM9djw0P2RbbSt2XTpmW20rdi00XTsoUz49dXx8UzwwKSYmXysrfWNvbnN0IEU9Ik51bWJlciBvZiBXZWlnaHRzID0gIitpLzQrYApNYXhpbXVtIGluZmx1ZW5jZXMgPSBgK24rYApNaXNzaW5nIFdlaWdodHMgPSBgK3IrYApOb3QgU29ydGVkID0gYCtzK2AKTm90IE5vcm1hbGl6ZWQgPSBgK2ErYApXZWlnaHRDb3VudHMgPSBbYCtoK2BdCk51bWJlciBvZiBib25lcyA9IGArdStgCkJhZCBCb25lIEluZGljZXMgPSBgK187cmV0dXJue3NraW5uZWQ6ITAsdmFsaWQ6cj09PTAmJmE9PT0wJiZfPT09MCxyZXBvcnQ6RX19X2NoZWNrRGVsYXlTdGF0ZSgpe2NvbnN0IGU9dGhpcy5nZXRTY2VuZSgpO3JldHVybiB0aGlzLl9nZW9tZXRyeT90aGlzLl9nZW9tZXRyeS5sb2FkKGUpOnRoaXMuZGVsYXlMb2FkU3RhdGU9PT00JiYodGhpcy5kZWxheUxvYWRTdGF0ZT0yLHRoaXMuX3F1ZXVlTG9hZChlKSksdGhpc31fcXVldWVMb2FkKGUpe2UuYWRkUGVuZGluZ0RhdGEodGhpcyk7Y29uc3QgdD10aGlzLmRlbGF5TG9hZGluZ0ZpbGUuaW5kZXhPZigiLmJhYnlsb25iaW5hcnltZXNoZGF0YSIpIT09LTE7cmV0dXJuIEguTG9hZEZpbGUodGhpcy5kZWxheUxvYWRpbmdGaWxlLGk9PntpIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI/dGhpcy5fZGVsYXlMb2FkaW5nRnVuY3Rpb24oaSx0aGlzKTp0aGlzLl9kZWxheUxvYWRpbmdGdW5jdGlvbihKU09OLnBhcnNlKGkpLHRoaXMpLHRoaXMuaW5zdGFuY2VzLmZvckVhY2gocz0+e3MucmVmcmVzaEJvdW5kaW5nSW5mbygpLHMuX3N5bmNTdWJNZXNoZXMoKX0pLHRoaXMuZGVsYXlMb2FkU3RhdGU9MSxlLnJlbW92ZVBlbmRpbmdEYXRhKHRoaXMpfSwoKT0+e30sZS5vZmZsaW5lUHJvdmlkZXIsdCksdGhpc31pc0luRnJ1c3R1bShlKXtyZXR1cm4gdGhpcy5kZWxheUxvYWRTdGF0ZT09PTJ8fCFzdXBlci5pc0luRnJ1c3R1bShlKT8hMToodGhpcy5fY2hlY2tEZWxheVN0YXRlKCksITApfXNldE1hdGVyaWFsQnlJZChlKXtjb25zdCB0PXRoaXMuZ2V0U2NlbmUoKS5tYXRlcmlhbHM7bGV0IGk7Zm9yKGk9dC5sZW5ndGgtMTtpPi0xO2ktLSlpZih0W2ldLmlkPT09ZSlyZXR1cm4gdGhpcy5tYXRlcmlhbD10W2ldLHRoaXM7Y29uc3Qgcz10aGlzLmdldFNjZW5lKCkubXVsdGlNYXRlcmlhbHM7Zm9yKGk9cy5sZW5ndGgtMTtpPi0xO2ktLSlpZihzW2ldLmlkPT09ZSlyZXR1cm4gdGhpcy5tYXRlcmlhbD1zW2ldLHRoaXM7cmV0dXJuIHRoaXN9Z2V0QW5pbWF0YWJsZXMoKXtjb25zdCBlPW5ldyBBcnJheTtyZXR1cm4gdGhpcy5tYXRlcmlhbCYmZS5wdXNoKHRoaXMubWF0ZXJpYWwpLHRoaXMuc2tlbGV0b24mJmUucHVzaCh0aGlzLnNrZWxldG9uKSxlfWJha2VUcmFuc2Zvcm1JbnRvVmVydGljZXMoZSl7aWYoIXRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuUG9zaXRpb25LaW5kKSlyZXR1cm4gdGhpcztjb25zdCB0PXRoaXMuc3ViTWVzaGVzLnNwbGljZSgwKTt0aGlzLl9yZXNldFBvaW50c0FycmF5Q2FjaGUoKTtsZXQgaT10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCk7Y29uc3Qgcz1wLlplcm8oKTtsZXQgcjtmb3Iocj0wO3I8aS5sZW5ndGg7cis9MylwLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGlbcl0saVtyKzFdLGlbcisyXSxlLHMpLnRvQXJyYXkoaSxyKTtpZih0aGlzLnNldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCxpLHRoaXMuZ2V0VmVydGV4QnVmZmVyKGcuUG9zaXRpb25LaW5kKS5pc1VwZGF0YWJsZSgpKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk5vcm1hbEtpbmQpKXtmb3IoaT10aGlzLmdldFZlcnRpY2VzRGF0YShnLk5vcm1hbEtpbmQpLHI9MDtyPGkubGVuZ3RoO3IrPTMpcC5UcmFuc2Zvcm1Ob3JtYWxGcm9tRmxvYXRzVG9SZWYoaVtyXSxpW3IrMV0saVtyKzJdLGUscykubm9ybWFsaXplKCkudG9BcnJheShpLHIpO3RoaXMuc2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCxpLHRoaXMuZ2V0VmVydGV4QnVmZmVyKGcuTm9ybWFsS2luZCkuaXNVcGRhdGFibGUoKSl9cmV0dXJuIGUuZGV0ZXJtaW5hbnQoKTwwJiZ0aGlzLmZsaXBGYWNlcygpLHRoaXMucmVsZWFzZVN1Yk1lc2hlcygpLHRoaXMuc3ViTWVzaGVzPXQsdGhpc31iYWtlQ3VycmVudFRyYW5zZm9ybUludG9WZXJ0aWNlcyhlPSEwKXtyZXR1cm4gdGhpcy5iYWtlVHJhbnNmb3JtSW50b1ZlcnRpY2VzKHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSksdGhpcy5yZXNldExvY2FsTWF0cml4KGUpLHRoaXN9Z2V0IF9wb3NpdGlvbnMoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fcG9zaXRpb25zP3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3Bvc2l0aW9uczp0aGlzLl9nZW9tZXRyeT90aGlzLl9nZW9tZXRyeS5fcG9zaXRpb25zOm51bGx9X3Jlc2V0UG9pbnRzQXJyYXlDYWNoZSgpe3JldHVybiB0aGlzLl9nZW9tZXRyeSYmdGhpcy5fZ2VvbWV0cnkuX3Jlc2V0UG9pbnRzQXJyYXlDYWNoZSgpLHRoaXN9X2dlbmVyYXRlUG9pbnRzQXJyYXkoKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/dGhpcy5fZ2VvbWV0cnkuX2dlbmVyYXRlUG9pbnRzQXJyYXkoKTohMX1jbG9uZShlPSIiLHQ9bnVsbCxpLHM9ITApe3JldHVybiBuZXcgVyhlLHRoaXMuZ2V0U2NlbmUoKSx0LHRoaXMsaSxzKX1kaXNwb3NlKGUsdD0hMSl7dGhpcy5tb3JwaFRhcmdldE1hbmFnZXI9bnVsbCx0aGlzLl9nZW9tZXRyeSYmdGhpcy5fZ2VvbWV0cnkucmVsZWFzZUZvck1lc2godGhpcywhMCk7Y29uc3QgaT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mbztpZihpLl9vbkJlZm9yZURyYXdPYnNlcnZhYmxlJiZpLl9vbkJlZm9yZURyYXdPYnNlcnZhYmxlLmNsZWFyKCksaS5fb25CZWZvcmVCaW5kT2JzZXJ2YWJsZSYmaS5fb25CZWZvcmVCaW5kT2JzZXJ2YWJsZS5jbGVhcigpLGkuX29uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZSYmaS5fb25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmNsZWFyKCksaS5fb25BZnRlclJlbmRlck9ic2VydmFibGUmJmkuX29uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLmNsZWFyKCksaS5fb25CZXR3ZWVuUGFzc09ic2VydmFibGUmJmkuX29uQmV0d2VlblBhc3NPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5fc2NlbmUudXNlQ2xvbmVkTWVzaE1hcCl7aWYoaS5tZXNoTWFwKWZvcihjb25zdCBzIGluIGkubWVzaE1hcCl7Y29uc3Qgcj1pLm1lc2hNYXBbc107ciYmKHIuX2ludGVybmFsTWVzaERhdGFJbmZvLl9zb3VyY2U9bnVsbCxpLm1lc2hNYXBbc109dm9pZCAwKX1pLl9zb3VyY2UmJmkuX3NvdXJjZS5faW50ZXJuYWxNZXNoRGF0YUluZm8ubWVzaE1hcCYmKGkuX3NvdXJjZS5faW50ZXJuYWxNZXNoRGF0YUluZm8ubWVzaE1hcFt0aGlzLnVuaXF1ZUlkXT12b2lkIDApfWVsc2V7Y29uc3Qgcz10aGlzLmdldFNjZW5lKCkubWVzaGVzO2Zvcihjb25zdCByIG9mIHMpe2NvbnN0IG49cjtuLl9pbnRlcm5hbE1lc2hEYXRhSW5mbyYmbi5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZSYmbi5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZT09PXRoaXMmJihuLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fc291cmNlPW51bGwpfX1pLl9zb3VyY2U9bnVsbCx0aGlzLl9kaXNwb3NlSW5zdGFuY2VTcGVjaWZpY0RhdGEoKSx0aGlzLl9kaXNwb3NlVGhpbkluc3RhbmNlU3BlY2lmaWNEYXRhKCksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2NoZWNrUmVhZGluZXNzT2JzZXJ2ZXImJnRoaXMuX3NjZW5lLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2NoZWNrUmVhZGluZXNzT2JzZXJ2ZXIpLHN1cGVyLmRpc3Bvc2UoZSx0KX1fZGlzcG9zZUluc3RhbmNlU3BlY2lmaWNEYXRhKCl7fV9kaXNwb3NlVGhpbkluc3RhbmNlU3BlY2lmaWNEYXRhKCl7fV9pbnZhbGlkYXRlSW5zdGFuY2VWZXJ0ZXhBcnJheU9iamVjdCgpe31hcHBseURpc3BsYWNlbWVudE1hcChlLHQsaSxzLHIsbixhPSExKXtjb25zdCBvPXRoaXMuZ2V0U2NlbmUoKSxoPWw9Pntjb25zdCB1PWwud2lkdGgsZD1sLmhlaWdodCxfPXRoaXMuZ2V0RW5naW5lKCkuY3JlYXRlQ2FudmFzKHUsZCkuZ2V0Q29udGV4dCgiMmQiKTtfLmRyYXdJbWFnZShsLDAsMCk7Y29uc3QgRT1fLmdldEltYWdlRGF0YSgwLDAsdSxkKS5kYXRhO3RoaXMuYXBwbHlEaXNwbGFjZW1lbnRNYXBGcm9tQnVmZmVyKEUsdSxkLHQsaSxyLG4sYSkscyYmcyh0aGlzKX07cmV0dXJuIEguTG9hZEltYWdlKGUsaCwoKT0+e30sby5vZmZsaW5lUHJvdmlkZXIpLHRoaXN9YXBwbHlEaXNwbGFjZW1lbnRNYXBGcm9tQnVmZmVyKGUsdCxpLHMscixuLGEsbz0hMSl7aWYoIXRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuUG9zaXRpb25LaW5kKXx8IXRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTm9ybWFsS2luZCl8fCF0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWS2luZCkpcmV0dXJuIE8uV2FybigiQ2Fubm90IGNhbGwgYXBwbHlEaXNwbGFjZW1lbnRNYXA6IEdpdmVuIG1lc2ggaXMgbm90IGNvbXBsZXRlLiBQb3NpdGlvbiwgTm9ybWFsIG9yIFVWIGFyZSBtaXNzaW5nIiksdGhpcztjb25zdCBoPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kLCEwLCEwKSxsPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCksdT10aGlzLmdldFZlcnRpY2VzRGF0YShnLlVWS2luZCk7bGV0IGQ9cC5aZXJvKCk7Y29uc3QgZj1wLlplcm8oKSxfPXZlLlplcm8oKTtuPW58fHZlLlplcm8oKSxhPWF8fG5ldyB2ZSgxLDEpO2ZvcihsZXQgRT0wO0U8aC5sZW5ndGg7RSs9Myl7cC5Gcm9tQXJyYXlUb1JlZihoLEUsZCkscC5Gcm9tQXJyYXlUb1JlZihsLEUsZiksdmUuRnJvbUFycmF5VG9SZWYodSxFLzMqMixfKTtjb25zdCBtPU1hdGguYWJzKF8ueCphLngrbi54JTEpKih0LTEpJXR8MCx2PU1hdGguYWJzKF8ueSphLnkrbi55JTEpKihpLTEpJWl8MCxTPShtK3YqdCkqNCx5PWVbU10vMjU1LEE9ZVtTKzFdLzI1NSxDPWVbUysyXS8yNTUsYj15Ki4zK0EqLjU5K0MqLjExO2Yubm9ybWFsaXplKCksZi5zY2FsZUluUGxhY2Uocysoci1zKSpiKSxkPWQuYWRkKGYpLGQudG9BcnJheShoLEUpfXJldHVybiBlZS5Db21wdXRlTm9ybWFscyhoLHRoaXMuZ2V0SW5kaWNlcygpLGwpLG8/KHRoaXMuc2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kLGgpLHRoaXMuc2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCxsKSx0aGlzLnNldFZlcnRpY2VzRGF0YShnLlVWS2luZCx1KSk6KHRoaXMudXBkYXRlVmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kLGgpLHRoaXMudXBkYXRlVmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCxsKSksdGhpc31jb252ZXJ0VG9GbGF0U2hhZGVkTWVzaCgpe2NvbnN0IGU9dGhpcy5nZXRWZXJ0aWNlc0RhdGFLaW5kcygpLHQ9e30saT17fSxzPXt9O2xldCByPSExLG4sYTtmb3Iobj0wO248ZS5sZW5ndGg7bisrKXthPWVbbl07Y29uc3QgbT10aGlzLmdldFZlcnRleEJ1ZmZlcihhKSx2PW0uZ2V0RGF0YSgpO2lmKCEoKHYgaW5zdGFuY2VvZiBBcnJheXx8diBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSkmJnYubGVuZ3RoPT09MCkpe2lmKGE9PT1nLk5vcm1hbEtpbmQpe3I9bS5pc1VwZGF0YWJsZSgpLGUuc3BsaWNlKG4sMSksbi0tO2NvbnRpbnVlfXRbYV09bSxpW2FdPXRoaXMuZ2V0VmVydGljZXNEYXRhKGEpLHNbYV09W119fWNvbnN0IG89dGhpcy5zdWJNZXNoZXMuc2xpY2UoMCksaD10aGlzLmdldEluZGljZXMoKSxsPXRoaXMuZ2V0VG90YWxJbmRpY2VzKCk7bGV0IHU7Zm9yKHU9MDt1PGw7dSsrKXtjb25zdCBtPWhbdV07Zm9yKG49MDtuPGUubGVuZ3RoO24rKyl7aWYoYT1lW25dLCF0W2FdKWNvbnRpbnVlO2NvbnN0IHY9dFthXS5nZXRTdHJpZGVTaXplKCk7Zm9yKGxldCBTPTA7Uzx2O1MrKylzW2FdLnB1c2goaVthXVttKnYrU10pfX1jb25zdCBkPVtdLGY9c1tnLlBvc2l0aW9uS2luZF0sXz10aGlzLmdldFNjZW5lKCkudXNlUmlnaHRIYW5kZWRTeXN0ZW07bGV0IEU7Zm9yKF8/RT10aGlzLm92ZXJyaWRlTWF0ZXJpYWxTaWRlT3JpZW50YXRpb249PT0xOkU9dGhpcy5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uPT09MCx1PTA7dTxsO3UrPTMpe2hbdV09dSxoW3UrMV09dSsxLGhbdSsyXT11KzI7Y29uc3QgbT1wLkZyb21BcnJheShmLHUqMyksdj1wLkZyb21BcnJheShmLCh1KzEpKjMpLFM9cC5Gcm9tQXJyYXkoZiwodSsyKSozKSx5PW0uc3VidHJhY3QodiksQT1TLnN1YnRyYWN0KHYpLEM9cC5Ob3JtYWxpemUocC5Dcm9zcyh5LEEpKTtFJiZDLnNjYWxlSW5QbGFjZSgtMSk7Zm9yKGxldCBiPTA7YjwzO2IrKylkLnB1c2goQy54KSxkLnB1c2goQy55KSxkLnB1c2goQy56KX1mb3IodGhpcy5zZXRJbmRpY2VzKGgpLHRoaXMuc2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCxkLHIpLG49MDtuPGUubGVuZ3RoO24rKylhPWVbbl0sc1thXSYmdGhpcy5zZXRWZXJ0aWNlc0RhdGEoYSxzW2FdLHRbYV0uaXNVcGRhdGFibGUoKSk7dGhpcy5yZWxlYXNlU3ViTWVzaGVzKCk7Zm9yKGxldCBtPTA7bTxvLmxlbmd0aDttKyspe2NvbnN0IHY9b1ttXTt2dC5BZGRUb01lc2godi5tYXRlcmlhbEluZGV4LHYuaW5kZXhTdGFydCx2LmluZGV4Q291bnQsdi5pbmRleFN0YXJ0LHYuaW5kZXhDb3VudCx0aGlzKX1yZXR1cm4gdGhpcy5zeW5jaHJvbml6ZUluc3RhbmNlcygpLHRoaXN9Y29udmVydFRvVW5JbmRleGVkTWVzaCgpe2NvbnN0IGU9dGhpcy5nZXRWZXJ0aWNlc0RhdGFLaW5kcygpLHQ9e30saT17fSxzPXt9O2xldCByLG47Zm9yKHI9MDtyPGUubGVuZ3RoO3IrKyl7bj1lW3JdO2NvbnN0IHU9dGhpcy5nZXRWZXJ0ZXhCdWZmZXIobik7dFtuXT11LGlbbl09dFtuXS5nZXREYXRhKCksc1tuXT1bXX1jb25zdCBhPXRoaXMuc3ViTWVzaGVzLnNsaWNlKDApLG89dGhpcy5nZXRJbmRpY2VzKCksaD10aGlzLmdldFRvdGFsSW5kaWNlcygpO2xldCBsO2ZvcihsPTA7bDxoO2wrKyl7Y29uc3QgdT1vW2xdO2ZvcihyPTA7cjxlLmxlbmd0aDtyKyspe249ZVtyXTtjb25zdCBkPXRbbl0uZ2V0U3RyaWRlU2l6ZSgpO2ZvcihsZXQgZj0wO2Y8ZDtmKyspc1tuXS5wdXNoKGlbbl1bdSpkK2ZdKX19Zm9yKGw9MDtsPGg7bCs9MylvW2xdPWwsb1tsKzFdPWwrMSxvW2wrMl09bCsyO2Zvcih0aGlzLnNldEluZGljZXMobykscj0wO3I8ZS5sZW5ndGg7cisrKW49ZVtyXSx0aGlzLnNldFZlcnRpY2VzRGF0YShuLHNbbl0sdFtuXS5pc1VwZGF0YWJsZSgpLHRbbl0uZ2V0U3RyaWRlU2l6ZSgpKTt0aGlzLnJlbGVhc2VTdWJNZXNoZXMoKTtmb3IobGV0IHU9MDt1PGEubGVuZ3RoO3UrKyl7Y29uc3QgZD1hW3VdO3Z0LkFkZFRvTWVzaChkLm1hdGVyaWFsSW5kZXgsZC5pbmRleFN0YXJ0LGQuaW5kZXhDb3VudCxkLmluZGV4U3RhcnQsZC5pbmRleENvdW50LHRoaXMpfXJldHVybiB0aGlzLl91bkluZGV4ZWQ9ITAsdGhpcy5zeW5jaHJvbml6ZUluc3RhbmNlcygpLHRoaXN9ZmxpcEZhY2VzKGU9ITEpe2NvbnN0IHQ9ZWUuRXh0cmFjdEZyb21NZXNoKHRoaXMpO2xldCBpO2lmKGUmJnRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTm9ybWFsS2luZCkmJnQubm9ybWFscylmb3IoaT0wO2k8dC5ub3JtYWxzLmxlbmd0aDtpKyspdC5ub3JtYWxzW2ldKj0tMTtpZih0LmluZGljZXMpe2xldCBzO2ZvcihpPTA7aTx0LmluZGljZXMubGVuZ3RoO2krPTMpcz10LmluZGljZXNbaSsxXSx0LmluZGljZXNbaSsxXT10LmluZGljZXNbaSsyXSx0LmluZGljZXNbaSsyXT1zfXJldHVybiB0LmFwcGx5VG9NZXNoKHRoaXMsdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlBvc2l0aW9uS2luZCkpLHRoaXN9aW5jcmVhc2VWZXJ0aWNlcyhlPTEpe2NvbnN0IHQ9ZWUuRXh0cmFjdEZyb21NZXNoKHRoaXMpLGk9dC5pbmRpY2VzJiYhQXJyYXkuaXNBcnJheSh0LmluZGljZXMpJiZBcnJheS5mcm9tP0FycmF5LmZyb20odC5pbmRpY2VzKTp0LmluZGljZXMscz10LnBvc2l0aW9ucyYmIUFycmF5LmlzQXJyYXkodC5wb3NpdGlvbnMpJiZBcnJheS5mcm9tP0FycmF5LmZyb20odC5wb3NpdGlvbnMpOnQucG9zaXRpb25zLHI9dC51dnMmJiFBcnJheS5pc0FycmF5KHQudXZzKSYmQXJyYXkuZnJvbT9BcnJheS5mcm9tKHQudXZzKTp0LnV2cyxuPXQubm9ybWFscyYmIUFycmF5LmlzQXJyYXkodC5ub3JtYWxzKSYmQXJyYXkuZnJvbT9BcnJheS5mcm9tKHQubm9ybWFscyk6dC5ub3JtYWxzO2lmKCFpfHwhcylPLldhcm4oIkNvdWxkbid0IGluY3JlYXNlIG51bWJlciBvZiB2ZXJ0aWNlcyA6IFZlcnRleERhdGEgbXVzdCBjb250YWluIGF0IGxlYXN0IGluZGljZXMgYW5kIHBvc2l0aW9ucyIpO2Vsc2V7dC5pbmRpY2VzPWksdC5wb3NpdGlvbnM9cyxyJiYodC51dnM9ciksbiYmKHQubm9ybWFscz1uKTtjb25zdCBhPWUrMSxvPW5ldyBBcnJheTtmb3IobGV0IEM9MDtDPGErMTtDKyspb1tDXT1uZXcgQXJyYXk7bGV0IGgsbDtjb25zdCB1PW5ldyBwKDAsMCwwKSxkPW5ldyBwKDAsMCwwKSxmPW5ldyB2ZSgwLDApLF89bmV3IEFycmF5LEU9bmV3IEFycmF5LG09bmV3IEFycmF5O2xldCB2LFM9cy5sZW5ndGgseTtyJiYoeT1yLmxlbmd0aCk7bGV0IEE7biYmKEE9bi5sZW5ndGgpO2ZvcihsZXQgQz0wO0M8aS5sZW5ndGg7Qys9Myl7RVswXT1pW0NdLEVbMV09aVtDKzFdLEVbMl09aVtDKzJdO2ZvcihsZXQgYj0wO2I8MztiKyspaWYoaD1FW2JdLGw9RVsoYisxKSUzXSxtW2hdPT09dm9pZCAwJiZtW2xdPT09dm9pZCAwPyhtW2hdPW5ldyBBcnJheSxtW2xdPW5ldyBBcnJheSk6KG1baF09PT12b2lkIDAmJihtW2hdPW5ldyBBcnJheSksbVtsXT09PXZvaWQgMCYmKG1bbF09bmV3IEFycmF5KSksbVtoXVtsXT09PXZvaWQgMCYmbVtsXVtoXT09PXZvaWQgMCl7bVtoXVtsXT1bXSx1Lng9KHNbMypsXS1zWzMqaF0pL2EsdS55PShzWzMqbCsxXS1zWzMqaCsxXSkvYSx1Lno9KHNbMypsKzJdLXNbMypoKzJdKS9hLG4mJihkLng9KG5bMypsXS1uWzMqaF0pL2EsZC55PShuWzMqbCsxXS1uWzMqaCsxXSkvYSxkLno9KG5bMypsKzJdLW5bMypoKzJdKS9hKSxyJiYoZi54PShyWzIqbF0tclsyKmhdKS9hLGYueT0oclsyKmwrMV0tclsyKmgrMV0pL2EpLG1baF1bbF0ucHVzaChoKTtmb3IobGV0IE09MTtNPGE7TSsrKW1baF1bbF0ucHVzaChzLmxlbmd0aC8zKSxzW1MrK109c1szKmhdK00qdS54LHNbUysrXT1zWzMqaCsxXStNKnUueSxzW1MrK109c1szKmgrMl0rTSp1LnosbiYmKG5bQSsrXT1uWzMqaF0rTSpkLngsbltBKytdPW5bMypoKzFdK00qZC55LG5bQSsrXT1uWzMqaCsyXStNKmQueiksciYmKHJbeSsrXT1yWzIqaF0rTSpmLngsclt5KytdPXJbMipoKzFdK00qZi55KTttW2hdW2xdLnB1c2gobCksbVtsXVtoXT1uZXcgQXJyYXksdj1tW2hdW2xdLmxlbmd0aDtmb3IobGV0IE09MDtNPHY7TSsrKW1bbF1baF1bTV09bVtoXVtsXVt2LTEtTV19b1swXVswXT1pW0NdLG9bMV1bMF09bVtpW0NdXVtpW0MrMV1dWzFdLG9bMV1bMV09bVtpW0NdXVtpW0MrMl1dWzFdO2ZvcihsZXQgYj0yO2I8YTtiKyspe29bYl1bMF09bVtpW0NdXVtpW0MrMV1dW2JdLG9bYl1bYl09bVtpW0NdXVtpW0MrMl1dW2JdLHUueD0oc1szKm9bYl1bYl1dLXNbMypvW2JdWzBdXSkvYix1Lnk9KHNbMypvW2JdW2JdKzFdLXNbMypvW2JdWzBdKzFdKS9iLHUuej0oc1szKm9bYl1bYl0rMl0tc1szKm9bYl1bMF0rMl0pL2IsbiYmKGQueD0oblszKm9bYl1bYl1dLW5bMypvW2JdWzBdXSkvYixkLnk9KG5bMypvW2JdW2JdKzFdLW5bMypvW2JdWzBdKzFdKS9iLGQuej0oblszKm9bYl1bYl0rMl0tblszKm9bYl1bMF0rMl0pL2IpLHImJihmLng9KHJbMipvW2JdW2JdXS1yWzIqb1tiXVswXV0pL2IsZi55PShyWzIqb1tiXVtiXSsxXS1yWzIqb1tiXVswXSsxXSkvYik7Zm9yKGxldCBNPTE7TTxiO00rKylvW2JdW01dPXMubGVuZ3RoLzMsc1tTKytdPXNbMypvW2JdWzBdXStNKnUueCxzW1MrK109c1szKm9bYl1bMF0rMV0rTSp1Lnksc1tTKytdPXNbMypvW2JdWzBdKzJdK00qdS56LG4mJihuW0ErK109blszKm9bYl1bMF1dK00qZC54LG5bQSsrXT1uWzMqb1tiXVswXSsxXStNKmQueSxuW0ErK109blszKm9bYl1bMF0rMl0rTSpkLnopLHImJihyW3krK109clsyKm9bYl1bMF1dK00qZi54LHJbeSsrXT1yWzIqb1tiXVswXSsxXStNKmYueSl9b1thXT1tW2lbQysxXV1baVtDKzJdXSxfLnB1c2gob1swXVswXSxvWzFdWzBdLG9bMV1bMV0pO2ZvcihsZXQgYj0xO2I8YTtiKyspe2xldCBNO2ZvcihNPTA7TTxiO00rKylfLnB1c2gob1tiXVtNXSxvW2IrMV1bTV0sb1tiKzFdW00rMV0pLF8ucHVzaChvW2JdW01dLG9bYisxXVtNKzFdLG9bYl1bTSsxXSk7Xy5wdXNoKG9bYl1bTV0sb1tiKzFdW01dLG9bYisxXVtNKzFdKX19dC5pbmRpY2VzPV8sdC5hcHBseVRvTWVzaCh0aGlzLHRoaXMuaXNWZXJ0ZXhCdWZmZXJVcGRhdGFibGUoZy5Qb3NpdGlvbktpbmQpKX19Zm9yY2VTaGFyZWRWZXJ0aWNlcygpe2NvbnN0IGU9ZWUuRXh0cmFjdEZyb21NZXNoKHRoaXMpLHQ9ZS51dnMsaT1lLmluZGljZXMscz1lLnBvc2l0aW9ucyxyPWUuY29sb3JzLG49ZS5tYXRyaWNlc0luZGljZXMsYT1lLm1hdHJpY2VzV2VpZ2h0cyxvPWUubWF0cmljZXNJbmRpY2VzRXh0cmEsaD1lLm1hdHJpY2VzV2VpZ2h0c0V4dHJhO2lmKGk9PT12b2lkIDB8fHM9PT12b2lkIDB8fGk9PT1udWxsfHxzPT09bnVsbClPLldhcm4oIlZlcnRleERhdGEgY29udGFpbnMgZW1wdHkgZW50cmllcyIpO2Vsc2V7Y29uc3QgbD1uZXcgQXJyYXksdT1uZXcgQXJyYXksZD1uZXcgQXJyYXksZj1uZXcgQXJyYXksXz1uZXcgQXJyYXksRT1uZXcgQXJyYXksbT1uZXcgQXJyYXksdj1uZXcgQXJyYXk7bGV0IFM9bmV3IEFycmF5LHk9MDtjb25zdCBBPXt9O2xldCBDLGI7Zm9yKGxldCBMPTA7TDxpLmxlbmd0aDtMKz0zKXtiPVtpW0xdLGlbTCsxXSxpW0wrMl1dLFM9bmV3IEFycmF5O2ZvcihsZXQgaz0wO2s8MztrKyspe1Nba109IiI7Zm9yKGxldCB3PTA7dzwzO3crKylNYXRoLmFicyhzWzMqYltrXSt3XSk8MWUtOCYmKHNbMypiW2tdK3ddPTApLFNba10rPXNbMypiW2tdK3ddKyJ8In1pZighKFNbMF09PVNbMV18fFNbMF09PVNbMl18fFNbMV09PVNbMl0pKWZvcihsZXQgaz0wO2s8MztrKyspe2lmKEM9QVtTW2tdXSxDPT09dm9pZCAwKXtBW1Nba11dPXksQz15Kys7Zm9yKGxldCB3PTA7dzwzO3crKylsLnB1c2goc1szKmJba10rd10pO2lmKHIhPW51bGwpZm9yKGxldCB3PTA7dzw0O3crKylmLnB1c2gocls0KmJba10rd10pO2lmKHQhPW51bGwpZm9yKGxldCB3PTA7dzwyO3crKylkLnB1c2godFsyKmJba10rd10pO2lmKG4hPW51bGwpZm9yKGxldCB3PTA7dzw0O3crKylfLnB1c2gobls0KmJba10rd10pO2lmKGEhPW51bGwpZm9yKGxldCB3PTA7dzw0O3crKylFLnB1c2goYVs0KmJba10rd10pO2lmKG8hPW51bGwpZm9yKGxldCB3PTA7dzw0O3crKyltLnB1c2gob1s0KmJba10rd10pO2lmKGghPW51bGwpZm9yKGxldCB3PTA7dzw0O3crKyl2LnB1c2goaFs0KmJba10rd10pfXUucHVzaChDKX19Y29uc3QgTT1uZXcgQXJyYXk7ZWUuQ29tcHV0ZU5vcm1hbHMobCx1LE0pLGUucG9zaXRpb25zPWwsZS5pbmRpY2VzPXUsZS5ub3JtYWxzPU0sdCE9bnVsbCYmKGUudXZzPWQpLHIhPW51bGwmJihlLmNvbG9ycz1mKSxuIT1udWxsJiYoZS5tYXRyaWNlc0luZGljZXM9XyksYSE9bnVsbCYmKGUubWF0cmljZXNXZWlnaHRzPUUpLG8hPW51bGwmJihlLm1hdHJpY2VzSW5kaWNlc0V4dHJhPW0pLGEhPW51bGwmJihlLm1hdHJpY2VzV2VpZ2h0c0V4dHJhPXYpLGUuYXBwbHlUb01lc2godGhpcyx0aGlzLmlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGcuUG9zaXRpb25LaW5kKSl9fXN0YXRpYyBfaW5zdGFuY2VkTWVzaEZhY3RvcnkoZSx0KXt0aHJvdyAkKCJJbnN0YW5jZWRNZXNoIil9c3RhdGljIF9QaHlzaWNzSW1wb3N0b3JQYXJzZXIoZSx0LGkpe3Rocm93ICQoIlBoeXNpY3NJbXBvc3RvciIpfWNyZWF0ZUluc3RhbmNlKGUpe3JldHVybiBXLl9pbnN0YW5jZWRNZXNoRmFjdG9yeShlLHRoaXMpfXN5bmNocm9uaXplSW5zdGFuY2VzKCl7Zm9yKGxldCBlPTA7ZTx0aGlzLmluc3RhbmNlcy5sZW5ndGg7ZSsrKXRoaXMuaW5zdGFuY2VzW2VdLl9zeW5jU3ViTWVzaGVzKCk7cmV0dXJuIHRoaXN9b3B0aW1pemVJbmRpY2VzKGUpe2NvbnN0IHQ9dGhpcy5nZXRJbmRpY2VzKCksaT10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCk7aWYoIWl8fCF0KXJldHVybiB0aGlzO2NvbnN0IHM9bmV3IEFycmF5O2ZvcihsZXQgbj0wO248aS5sZW5ndGg7bj1uKzMpcy5wdXNoKHAuRnJvbUFycmF5KGksbikpO2NvbnN0IHI9bmV3IEFycmF5O3JldHVybiBZaS5TeW5jQXN5bmNGb3JMb29wKHMubGVuZ3RoLDQwLG49Pntjb25zdCBhPXMubGVuZ3RoLTEtbixvPXNbYV07Zm9yKGxldCBoPTA7aDxhOysraCl7Y29uc3QgbD1zW2hdO2lmKG8uZXF1YWxzKGwpKXtyW2FdPWg7YnJlYWt9fX0sKCk9Pntmb3IobGV0IGE9MDthPHQubGVuZ3RoOysrYSl0W2FdPXJbdFthXV18fHRbYV07Y29uc3Qgbj10aGlzLnN1Yk1lc2hlcy5zbGljZSgwKTt0aGlzLnNldEluZGljZXModCksdGhpcy5zdWJNZXNoZXM9bixlJiZlKHRoaXMpfSksdGhpc31zZXJpYWxpemUoZT17fSl7ZS5uYW1lPXRoaXMubmFtZSxlLmlkPXRoaXMuaWQsZS51bmlxdWVJZD10aGlzLnVuaXF1ZUlkLGUudHlwZT10aGlzLmdldENsYXNzTmFtZSgpLGdlJiZnZS5IYXNUYWdzKHRoaXMpJiYoZS50YWdzPWdlLkdldFRhZ3ModGhpcykpLGUucG9zaXRpb249dGhpcy5wb3NpdGlvbi5hc0FycmF5KCksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24/ZS5yb3RhdGlvblF1YXRlcm5pb249dGhpcy5yb3RhdGlvblF1YXRlcm5pb24uYXNBcnJheSgpOnRoaXMucm90YXRpb24mJihlLnJvdGF0aW9uPXRoaXMucm90YXRpb24uYXNBcnJheSgpKSxlLnNjYWxpbmc9dGhpcy5zY2FsaW5nLmFzQXJyYXkoKSx0aGlzLl9wb3N0TXVsdGlwbHlQaXZvdE1hdHJpeD9lLnBpdm90TWF0cml4PXRoaXMuZ2V0UGl2b3RNYXRyaXgoKS5hc0FycmF5KCk6ZS5sb2NhbE1hdHJpeD10aGlzLmdldFBpdm90TWF0cml4KCkuYXNBcnJheSgpLGUuaXNFbmFibGVkPXRoaXMuaXNFbmFibGVkKCExKSxlLmlzVmlzaWJsZT10aGlzLmlzVmlzaWJsZSxlLmluZmluaXRlRGlzdGFuY2U9dGhpcy5pbmZpbml0ZURpc3RhbmNlLGUucGlja2FibGU9dGhpcy5pc1BpY2thYmxlLGUucmVjZWl2ZVNoYWRvd3M9dGhpcy5yZWNlaXZlU2hhZG93cyxlLmJpbGxib2FyZE1vZGU9dGhpcy5iaWxsYm9hcmRNb2RlLGUudmlzaWJpbGl0eT10aGlzLnZpc2liaWxpdHksZS5jaGVja0NvbGxpc2lvbnM9dGhpcy5jaGVja0NvbGxpc2lvbnMsZS5pc0Jsb2NrZXI9dGhpcy5pc0Jsb2NrZXIsZS5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uPXRoaXMub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbix0aGlzLnBhcmVudCYmdGhpcy5wYXJlbnQuX3NlcmlhbGl6ZUFzUGFyZW50KGUpLGUuaXNVbkluZGV4ZWQ9dGhpcy5pc1VuSW5kZXhlZDtjb25zdCB0PXRoaXMuX2dlb21ldHJ5O2lmKHQmJnRoaXMuc3ViTWVzaGVzKXtlLmdlb21ldHJ5VW5pcXVlSWQ9dC51bmlxdWVJZCxlLmdlb21ldHJ5SWQ9dC5pZCxlLnN1Yk1lc2hlcz1bXTtmb3IobGV0IGk9MDtpPHRoaXMuc3ViTWVzaGVzLmxlbmd0aDtpKyspe2NvbnN0IHM9dGhpcy5zdWJNZXNoZXNbaV07ZS5zdWJNZXNoZXMucHVzaCh7bWF0ZXJpYWxJbmRleDpzLm1hdGVyaWFsSW5kZXgsdmVydGljZXNTdGFydDpzLnZlcnRpY2VzU3RhcnQsdmVydGljZXNDb3VudDpzLnZlcnRpY2VzQ291bnQsaW5kZXhTdGFydDpzLmluZGV4U3RhcnQsaW5kZXhDb3VudDpzLmluZGV4Q291bnR9KX19aWYodGhpcy5tYXRlcmlhbD90aGlzLm1hdGVyaWFsLmRvTm90U2VyaWFsaXplfHwoZS5tYXRlcmlhbFVuaXF1ZUlkPXRoaXMubWF0ZXJpYWwudW5pcXVlSWQsZS5tYXRlcmlhbElkPXRoaXMubWF0ZXJpYWwuaWQpOih0aGlzLm1hdGVyaWFsPW51bGwsZS5tYXRlcmlhbFVuaXF1ZUlkPXRoaXMuX3NjZW5lLmRlZmF1bHRNYXRlcmlhbC51bmlxdWVJZCxlLm1hdGVyaWFsSWQ9dGhpcy5fc2NlbmUuZGVmYXVsdE1hdGVyaWFsLmlkKSx0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlciYmKGUubW9ycGhUYXJnZXRNYW5hZ2VySWQ9dGhpcy5tb3JwaFRhcmdldE1hbmFnZXIudW5pcXVlSWQpLHRoaXMuc2tlbGV0b24mJihlLnNrZWxldG9uSWQ9dGhpcy5za2VsZXRvbi5pZCxlLm51bUJvbmVJbmZsdWVuY2Vycz10aGlzLm51bUJvbmVJbmZsdWVuY2VycyksdGhpcy5nZXRTY2VuZSgpLl9nZXRDb21wb25lbnQocS5OQU1FX1BIWVNJQ1NFTkdJTkUpKXtjb25zdCBpPXRoaXMuZ2V0UGh5c2ljc0ltcG9zdG9yKCk7aSYmKGUucGh5c2ljc01hc3M9aS5nZXRQYXJhbSgibWFzcyIpLGUucGh5c2ljc0ZyaWN0aW9uPWkuZ2V0UGFyYW0oImZyaWN0aW9uIiksZS5waHlzaWNzUmVzdGl0dXRpb249aS5nZXRQYXJhbSgibWFzcyIpLGUucGh5c2ljc0ltcG9zdG9yPWkudHlwZSl9dGhpcy5tZXRhZGF0YSYmKGUubWV0YWRhdGE9dGhpcy5tZXRhZGF0YSksZS5pbnN0YW5jZXM9W107Zm9yKGxldCBpPTA7aTx0aGlzLmluc3RhbmNlcy5sZW5ndGg7aSsrKXtjb25zdCBzPXRoaXMuaW5zdGFuY2VzW2ldO2lmKHMuZG9Ob3RTZXJpYWxpemUpY29udGludWU7Y29uc3Qgcj17bmFtZTpzLm5hbWUsaWQ6cy5pZCxpc0VuYWJsZWQ6cy5pc0VuYWJsZWQoITEpLGlzVmlzaWJsZTpzLmlzVmlzaWJsZSxpc1BpY2thYmxlOnMuaXNQaWNrYWJsZSxjaGVja0NvbGxpc2lvbnM6cy5jaGVja0NvbGxpc2lvbnMscG9zaXRpb246cy5wb3NpdGlvbi5hc0FycmF5KCksc2NhbGluZzpzLnNjYWxpbmcuYXNBcnJheSgpfTtpZihzLnBhcmVudCYmcy5wYXJlbnQuX3NlcmlhbGl6ZUFzUGFyZW50KHIpLHMucm90YXRpb25RdWF0ZXJuaW9uP3Iucm90YXRpb25RdWF0ZXJuaW9uPXMucm90YXRpb25RdWF0ZXJuaW9uLmFzQXJyYXkoKTpzLnJvdGF0aW9uJiYoci5yb3RhdGlvbj1zLnJvdGF0aW9uLmFzQXJyYXkoKSksdGhpcy5nZXRTY2VuZSgpLl9nZXRDb21wb25lbnQocS5OQU1FX1BIWVNJQ1NFTkdJTkUpKXtjb25zdCBuPXMuZ2V0UGh5c2ljc0ltcG9zdG9yKCk7biYmKHIucGh5c2ljc01hc3M9bi5nZXRQYXJhbSgibWFzcyIpLHIucGh5c2ljc0ZyaWN0aW9uPW4uZ2V0UGFyYW0oImZyaWN0aW9uIiksci5waHlzaWNzUmVzdGl0dXRpb249bi5nZXRQYXJhbSgibWFzcyIpLHIucGh5c2ljc0ltcG9zdG9yPW4udHlwZSl9cy5tZXRhZGF0YSYmKHIubWV0YWRhdGE9cy5tZXRhZGF0YSksZS5pbnN0YW5jZXMucHVzaChyKSxhZS5BcHBlbmRTZXJpYWxpemVkQW5pbWF0aW9ucyhzLHIpLHIucmFuZ2VzPXMuc2VyaWFsaXplQW5pbWF0aW9uUmFuZ2VzKCl9aWYodGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UuaW5zdGFuY2VzQ291bnQmJnRoaXMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLm1hdHJpeERhdGEmJihlLnRoaW5JbnN0YW5jZXM9e2luc3RhbmNlc0NvdW50OnRoaXMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0NvdW50LG1hdHJpeERhdGE6QXJyYXkuZnJvbSh0aGlzLl90aGluSW5zdGFuY2VEYXRhU3RvcmFnZS5tYXRyaXhEYXRhKSxtYXRyaXhCdWZmZXJTaXplOnRoaXMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLm1hdHJpeEJ1ZmZlclNpemUsZW5hYmxlUGlja2luZzp0aGlzLnRoaW5JbnN0YW5jZUVuYWJsZVBpY2tpbmd9LHRoaXMuX3VzZXJUaGluSW5zdGFuY2VCdWZmZXJzU3RvcmFnZSkpe2NvbnN0IGk9e2RhdGE6e30sc2l6ZXM6e30sc3RyaWRlczp7fX07Zm9yKGNvbnN0IHMgaW4gdGhpcy5fdXNlclRoaW5JbnN0YW5jZUJ1ZmZlcnNTdG9yYWdlLmRhdGEpaS5kYXRhW3NdPUFycmF5LmZyb20odGhpcy5fdXNlclRoaW5JbnN0YW5jZUJ1ZmZlcnNTdG9yYWdlLmRhdGFbc10pLGkuc2l6ZXNbc109dGhpcy5fdXNlclRoaW5JbnN0YW5jZUJ1ZmZlcnNTdG9yYWdlLnNpemVzW3NdLGkuc3RyaWRlc1tzXT10aGlzLl91c2VyVGhpbkluc3RhbmNlQnVmZmVyc1N0b3JhZ2Uuc3RyaWRlc1tzXTtlLnRoaW5JbnN0YW5jZXMudXNlclRoaW5JbnN0YW5jZT1pfXJldHVybiBhZS5BcHBlbmRTZXJpYWxpemVkQW5pbWF0aW9ucyh0aGlzLGUpLGUucmFuZ2VzPXRoaXMuc2VyaWFsaXplQW5pbWF0aW9uUmFuZ2VzKCksZS5sYXllck1hc2s9dGhpcy5sYXllck1hc2ssZS5hbHBoYUluZGV4PXRoaXMuYWxwaGFJbmRleCxlLmhhc1ZlcnRleEFscGhhPXRoaXMuaGFzVmVydGV4QWxwaGEsZS5vdmVybGF5QWxwaGE9dGhpcy5vdmVybGF5QWxwaGEsZS5vdmVybGF5Q29sb3I9dGhpcy5vdmVybGF5Q29sb3IuYXNBcnJheSgpLGUucmVuZGVyT3ZlcmxheT10aGlzLnJlbmRlck92ZXJsYXksZS5hcHBseUZvZz10aGlzLmFwcGx5Rm9nLHRoaXMuYWN0aW9uTWFuYWdlciYmKGUuYWN0aW9ucz10aGlzLmFjdGlvbk1hbmFnZXIuc2VyaWFsaXplKHRoaXMubmFtZSkpLGV9X3N5bmNHZW9tZXRyeVdpdGhNb3JwaFRhcmdldE1hbmFnZXIoKXtpZighdGhpcy5nZW9tZXRyeSlyZXR1cm47dGhpcy5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCk7Y29uc3QgZT10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tb3JwaFRhcmdldE1hbmFnZXI7aWYoZSYmZS52ZXJ0ZXhDb3VudCl7aWYoZS52ZXJ0ZXhDb3VudCE9PXRoaXMuZ2V0VG90YWxWZXJ0aWNlcygpKXtPLkVycm9yKCJNZXNoIGlzIGluY29tcGF0aWJsZSB3aXRoIG1vcnBoIHRhcmdldHMuIFRhcmdldHMgYW5kIG1lc2ggbXVzdCBhbGwgaGF2ZSB0aGUgc2FtZSB2ZXJ0aWNlcyBjb3VudC4iKSx0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlcj1udWxsO3JldHVybn1pZihlLmlzVXNpbmdUZXh0dXJlRm9yVGFyZ2V0cylyZXR1cm47Zm9yKGxldCB0PTA7dDxlLm51bUluZmx1ZW5jZXJzO3QrKyl7Y29uc3QgaT1lLmdldEFjdGl2ZVRhcmdldCh0KSxzPWkuZ2V0UG9zaXRpb25zKCk7aWYoIXMpe08uRXJyb3IoIkludmFsaWQgbW9ycGggdGFyZ2V0LiBUYXJnZXQgbXVzdCBoYXZlIHBvc2l0aW9ucy4iKTtyZXR1cm59dGhpcy5nZW9tZXRyeS5zZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQrdCxzLCExLDMpO2NvbnN0IHI9aS5nZXROb3JtYWxzKCk7ciYmdGhpcy5nZW9tZXRyeS5zZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kK3QsciwhMSwzKTtjb25zdCBuPWkuZ2V0VGFuZ2VudHMoKTtuJiZ0aGlzLmdlb21ldHJ5LnNldFZlcnRpY2VzRGF0YShnLlRhbmdlbnRLaW5kK3QsbiwhMSwzKTtjb25zdCBhPWkuZ2V0VVZzKCk7YSYmdGhpcy5nZW9tZXRyeS5zZXRWZXJ0aWNlc0RhdGEoZy5VVktpbmQrIl8iK3QsYSwhMSwyKX19ZWxzZXtsZXQgdD0wO2Zvcig7dGhpcy5nZW9tZXRyeS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Qb3NpdGlvbktpbmQrdCk7KXRoaXMuZ2VvbWV0cnkucmVtb3ZlVmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kK3QpLHRoaXMuZ2VvbWV0cnkuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTm9ybWFsS2luZCt0KSYmdGhpcy5nZW9tZXRyeS5yZW1vdmVWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kK3QpLHRoaXMuZ2VvbWV0cnkuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuVGFuZ2VudEtpbmQrdCkmJnRoaXMuZ2VvbWV0cnkucmVtb3ZlVmVydGljZXNEYXRhKGcuVGFuZ2VudEtpbmQrdCksdGhpcy5nZW9tZXRyeS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5VVktpbmQrdCkmJnRoaXMuZ2VvbWV0cnkucmVtb3ZlVmVydGljZXNEYXRhKGcuVVZLaW5kKyJfIit0KSx0Kyt9fXN0YXRpYyBQYXJzZShlLHQsaSl7bGV0IHM7aWYoZS50eXBlJiZlLnR5cGU9PT0iTGluZXNNZXNoIj9zPVcuX0xpbmVzTWVzaFBhcnNlcihlLHQpOmUudHlwZSYmZS50eXBlPT09Ikdyb3VuZE1lc2giP3M9Vy5fR3JvdW5kTWVzaFBhcnNlcihlLHQpOmUudHlwZSYmZS50eXBlPT09IkdvbGRiZXJnTWVzaCI/cz1XLl9Hb2xkYmVyZ01lc2hQYXJzZXIoZSx0KTpzPW5ldyBXKGUubmFtZSx0KSxzLmlkPWUuaWQscy5fd2FpdGluZ1BhcnNlZFVuaXF1ZUlkPWUudW5pcXVlSWQsZ2UmJmdlLkFkZFRhZ3NUbyhzLGUudGFncykscy5wb3NpdGlvbj1wLkZyb21BcnJheShlLnBvc2l0aW9uKSxlLm1ldGFkYXRhIT09dm9pZCAwJiYocy5tZXRhZGF0YT1lLm1ldGFkYXRhKSxlLnJvdGF0aW9uUXVhdGVybmlvbj9zLnJvdGF0aW9uUXVhdGVybmlvbj1aLkZyb21BcnJheShlLnJvdGF0aW9uUXVhdGVybmlvbik6ZS5yb3RhdGlvbiYmKHMucm90YXRpb249cC5Gcm9tQXJyYXkoZS5yb3RhdGlvbikpLHMuc2NhbGluZz1wLkZyb21BcnJheShlLnNjYWxpbmcpLGUubG9jYWxNYXRyaXg/cy5zZXRQcmVUcmFuc2Zvcm1NYXRyaXgoeC5Gcm9tQXJyYXkoZS5sb2NhbE1hdHJpeCkpOmUucGl2b3RNYXRyaXgmJnMuc2V0UGl2b3RNYXRyaXgoeC5Gcm9tQXJyYXkoZS5waXZvdE1hdHJpeCkpLHMuc2V0RW5hYmxlZChlLmlzRW5hYmxlZCkscy5pc1Zpc2libGU9ZS5pc1Zpc2libGUscy5pbmZpbml0ZURpc3RhbmNlPWUuaW5maW5pdGVEaXN0YW5jZSxzLnNob3dCb3VuZGluZ0JveD1lLnNob3dCb3VuZGluZ0JveCxzLnNob3dTdWJNZXNoZXNCb3VuZGluZ0JveD1lLnNob3dTdWJNZXNoZXNCb3VuZGluZ0JveCxlLmFwcGx5Rm9nIT09dm9pZCAwJiYocy5hcHBseUZvZz1lLmFwcGx5Rm9nKSxlLnBpY2thYmxlIT09dm9pZCAwJiYocy5pc1BpY2thYmxlPWUucGlja2FibGUpLGUuYWxwaGFJbmRleCE9PXZvaWQgMCYmKHMuYWxwaGFJbmRleD1lLmFscGhhSW5kZXgpLHMucmVjZWl2ZVNoYWRvd3M9ZS5yZWNlaXZlU2hhZG93cyxlLmJpbGxib2FyZE1vZGUhPT12b2lkIDAmJihzLmJpbGxib2FyZE1vZGU9ZS5iaWxsYm9hcmRNb2RlKSxlLnZpc2liaWxpdHkhPT12b2lkIDAmJihzLnZpc2liaWxpdHk9ZS52aXNpYmlsaXR5KSxzLmNoZWNrQ29sbGlzaW9ucz1lLmNoZWNrQ29sbGlzaW9ucyxzLm92ZXJyaWRlTWF0ZXJpYWxTaWRlT3JpZW50YXRpb249ZS5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uLGUuaXNCbG9ja2VyIT09dm9pZCAwJiYocy5pc0Jsb2NrZXI9ZS5pc0Jsb2NrZXIpLHMuX3Nob3VsZEdlbmVyYXRlRmxhdFNoYWRpbmc9ZS51c2VGbGF0U2hhZGluZyxlLmZyZWV6ZVdvcmxkTWF0cml4JiYocy5fd2FpdGluZ0RhdGEuZnJlZXplV29ybGRNYXRyaXg9ZS5mcmVlemVXb3JsZE1hdHJpeCksZS5wYXJlbnRJZCE9PXZvaWQgMCYmKHMuX3dhaXRpbmdQYXJlbnRJZD1lLnBhcmVudElkKSxlLnBhcmVudEluc3RhbmNlSW5kZXghPT12b2lkIDAmJihzLl93YWl0aW5nUGFyZW50SW5zdGFuY2VJbmRleD1lLnBhcmVudEluc3RhbmNlSW5kZXgpLGUuYWN0aW9ucyE9PXZvaWQgMCYmKHMuX3dhaXRpbmdEYXRhLmFjdGlvbnM9ZS5hY3Rpb25zKSxlLm92ZXJsYXlBbHBoYSE9PXZvaWQgMCYmKHMub3ZlcmxheUFscGhhPWUub3ZlcmxheUFscGhhKSxlLm92ZXJsYXlDb2xvciE9PXZvaWQgMCYmKHMub3ZlcmxheUNvbG9yPXJlLkZyb21BcnJheShlLm92ZXJsYXlDb2xvcikpLGUucmVuZGVyT3ZlcmxheSE9PXZvaWQgMCYmKHMucmVuZGVyT3ZlcmxheT1lLnJlbmRlck92ZXJsYXkpLHMuaXNVbkluZGV4ZWQ9ISFlLmlzVW5JbmRleGVkLHMuaGFzVmVydGV4QWxwaGE9ZS5oYXNWZXJ0ZXhBbHBoYSxlLmRlbGF5TG9hZGluZ0ZpbGU/KHMuZGVsYXlMb2FkU3RhdGU9NCxzLmRlbGF5TG9hZGluZ0ZpbGU9aStlLmRlbGF5TG9hZGluZ0ZpbGUscy5idWlsZEJvdW5kaW5nSW5mbyhwLkZyb21BcnJheShlLmJvdW5kaW5nQm94TWluaW11bSkscC5Gcm9tQXJyYXkoZS5ib3VuZGluZ0JveE1heGltdW0pKSxlLl9iaW5hcnlJbmZvJiYocy5fYmluYXJ5SW5mbz1lLl9iaW5hcnlJbmZvKSxzLl9kZWxheUluZm89W10sZS5oYXNVVnMmJnMuX2RlbGF5SW5mby5wdXNoKGcuVVZLaW5kKSxlLmhhc1VWczImJnMuX2RlbGF5SW5mby5wdXNoKGcuVVYyS2luZCksZS5oYXNVVnMzJiZzLl9kZWxheUluZm8ucHVzaChnLlVWM0tpbmQpLGUuaGFzVVZzNCYmcy5fZGVsYXlJbmZvLnB1c2goZy5VVjRLaW5kKSxlLmhhc1VWczUmJnMuX2RlbGF5SW5mby5wdXNoKGcuVVY1S2luZCksZS5oYXNVVnM2JiZzLl9kZWxheUluZm8ucHVzaChnLlVWNktpbmQpLGUuaGFzQ29sb3JzJiZzLl9kZWxheUluZm8ucHVzaChnLkNvbG9yS2luZCksZS5oYXNNYXRyaWNlc0luZGljZXMmJnMuX2RlbGF5SW5mby5wdXNoKGcuTWF0cmljZXNJbmRpY2VzS2luZCksZS5oYXNNYXRyaWNlc1dlaWdodHMmJnMuX2RlbGF5SW5mby5wdXNoKGcuTWF0cmljZXNXZWlnaHRzS2luZCkscy5fZGVsYXlMb2FkaW5nRnVuY3Rpb249YXQuX0ltcG9ydEdlb21ldHJ5LE9lLkZvcmNlRnVsbFNjZW5lTG9hZGluZ0ZvckluY3JlbWVudGFsJiZzLl9jaGVja0RlbGF5U3RhdGUoKSk6YXQuX0ltcG9ydEdlb21ldHJ5KGUscyksZS5tYXRlcmlhbFVuaXF1ZUlkP3MuX3dhaXRpbmdNYXRlcmlhbElkPWUubWF0ZXJpYWxVbmlxdWVJZDplLm1hdGVyaWFsSWQmJihzLl93YWl0aW5nTWF0ZXJpYWxJZD1lLm1hdGVyaWFsSWQpLGUubW9ycGhUYXJnZXRNYW5hZ2VySWQ+LTEmJihzLm1vcnBoVGFyZ2V0TWFuYWdlcj10LmdldE1vcnBoVGFyZ2V0TWFuYWdlckJ5SWQoZS5tb3JwaFRhcmdldE1hbmFnZXJJZCkpLGUuc2tlbGV0b25JZCE9PXZvaWQgMCYmZS5za2VsZXRvbklkIT09bnVsbCYmKHMuc2tlbGV0b249dC5nZXRMYXN0U2tlbGV0b25CeUlkKGUuc2tlbGV0b25JZCksZS5udW1Cb25lSW5mbHVlbmNlcnMmJihzLm51bUJvbmVJbmZsdWVuY2Vycz1lLm51bUJvbmVJbmZsdWVuY2VycykpLGUuYW5pbWF0aW9ucyl7Zm9yKGxldCByPTA7cjxlLmFuaW1hdGlvbnMubGVuZ3RoO3IrKyl7Y29uc3Qgbj1lLmFuaW1hdGlvbnNbcl0sYT1yaSgiQkFCWUxPTi5BbmltYXRpb24iKTthJiZzLmFuaW1hdGlvbnMucHVzaChhLlBhcnNlKG4pKX16ZS5QYXJzZUFuaW1hdGlvblJhbmdlcyhzLGUsdCl9aWYoZS5hdXRvQW5pbWF0ZSYmdC5iZWdpbkFuaW1hdGlvbihzLGUuYXV0b0FuaW1hdGVGcm9tLGUuYXV0b0FuaW1hdGVUbyxlLmF1dG9BbmltYXRlTG9vcCxlLmF1dG9BbmltYXRlU3BlZWR8fDEpLGUubGF5ZXJNYXNrJiYhaXNOYU4oZS5sYXllck1hc2spP3MubGF5ZXJNYXNrPU1hdGguYWJzKHBhcnNlSW50KGUubGF5ZXJNYXNrKSk6cy5sYXllck1hc2s9MjY4NDM1NDU1LGUucGh5c2ljc0ltcG9zdG9yJiZXLl9QaHlzaWNzSW1wb3N0b3JQYXJzZXIodCxzLGUpLGUubG9kTWVzaElkcyYmKHMuX3dhaXRpbmdEYXRhLmxvZHM9e2lkczplLmxvZE1lc2hJZHMsZGlzdGFuY2VzOmUubG9kRGlzdGFuY2VzP2UubG9kRGlzdGFuY2VzOm51bGwsY292ZXJhZ2VzOmUubG9kQ292ZXJhZ2VzP2UubG9kQ292ZXJhZ2VzOm51bGx9KSxlLmluc3RhbmNlcylmb3IobGV0IHI9MDtyPGUuaW5zdGFuY2VzLmxlbmd0aDtyKyspe2NvbnN0IG49ZS5pbnN0YW5jZXNbcl0sYT1zLmNyZWF0ZUluc3RhbmNlKG4ubmFtZSk7aWYobi5pZCYmKGEuaWQ9bi5pZCksZ2UmJihuLnRhZ3M/Z2UuQWRkVGFnc1RvKGEsbi50YWdzKTpnZS5BZGRUYWdzVG8oYSxlLnRhZ3MpKSxhLnBvc2l0aW9uPXAuRnJvbUFycmF5KG4ucG9zaXRpb24pLG4ubWV0YWRhdGEhPT12b2lkIDAmJihhLm1ldGFkYXRhPW4ubWV0YWRhdGEpLG4ucGFyZW50SWQhPT12b2lkIDAmJihhLl93YWl0aW5nUGFyZW50SWQ9bi5wYXJlbnRJZCksbi5wYXJlbnRJbnN0YW5jZUluZGV4IT09dm9pZCAwJiYoYS5fd2FpdGluZ1BhcmVudEluc3RhbmNlSW5kZXg9bi5wYXJlbnRJbnN0YW5jZUluZGV4KSxuLmlzRW5hYmxlZCE9PXZvaWQgMCYmbi5pc0VuYWJsZWQhPT1udWxsJiZhLnNldEVuYWJsZWQobi5pc0VuYWJsZWQpLG4uaXNWaXNpYmxlIT09dm9pZCAwJiZuLmlzVmlzaWJsZSE9PW51bGwmJihhLmlzVmlzaWJsZT1uLmlzVmlzaWJsZSksbi5pc1BpY2thYmxlIT09dm9pZCAwJiZuLmlzUGlja2FibGUhPT1udWxsJiYoYS5pc1BpY2thYmxlPW4uaXNQaWNrYWJsZSksbi5yb3RhdGlvblF1YXRlcm5pb24/YS5yb3RhdGlvblF1YXRlcm5pb249Wi5Gcm9tQXJyYXkobi5yb3RhdGlvblF1YXRlcm5pb24pOm4ucm90YXRpb24mJihhLnJvdGF0aW9uPXAuRnJvbUFycmF5KG4ucm90YXRpb24pKSxhLnNjYWxpbmc9cC5Gcm9tQXJyYXkobi5zY2FsaW5nKSxuLmNoZWNrQ29sbGlzaW9ucyE9bnVsbCYmbi5jaGVja0NvbGxpc2lvbnMhPW51bGwmJihhLmNoZWNrQ29sbGlzaW9ucz1uLmNoZWNrQ29sbGlzaW9ucyksbi5waWNrYWJsZSE9bnVsbCYmbi5waWNrYWJsZSE9bnVsbCYmKGEuaXNQaWNrYWJsZT1uLnBpY2thYmxlKSxuLnNob3dCb3VuZGluZ0JveCE9bnVsbCYmbi5zaG93Qm91bmRpbmdCb3ghPW51bGwmJihhLnNob3dCb3VuZGluZ0JveD1uLnNob3dCb3VuZGluZ0JveCksbi5zaG93U3ViTWVzaGVzQm91bmRpbmdCb3ghPW51bGwmJm4uc2hvd1N1Yk1lc2hlc0JvdW5kaW5nQm94IT1udWxsJiYoYS5zaG93U3ViTWVzaGVzQm91bmRpbmdCb3g9bi5zaG93U3ViTWVzaGVzQm91bmRpbmdCb3gpLG4uYWxwaGFJbmRleCE9bnVsbCYmbi5zaG93U3ViTWVzaGVzQm91bmRpbmdCb3ghPW51bGwmJihhLmFscGhhSW5kZXg9bi5hbHBoYUluZGV4KSxuLnBoeXNpY3NJbXBvc3RvciYmVy5fUGh5c2ljc0ltcG9zdG9yUGFyc2VyKHQsYSxuKSxuLmFuaW1hdGlvbnMpe2ZvcihsZXQgbz0wO288bi5hbmltYXRpb25zLmxlbmd0aDtvKyspe2NvbnN0IGg9bi5hbmltYXRpb25zW29dLGw9cmkoIkJBQllMT04uQW5pbWF0aW9uIik7bCYmYS5hbmltYXRpb25zLnB1c2gobC5QYXJzZShoKSl9emUuUGFyc2VBbmltYXRpb25SYW5nZXMoYSxuLHQpLG4uYXV0b0FuaW1hdGUmJnQuYmVnaW5BbmltYXRpb24oYSxuLmF1dG9BbmltYXRlRnJvbSxuLmF1dG9BbmltYXRlVG8sbi5hdXRvQW5pbWF0ZUxvb3Asbi5hdXRvQW5pbWF0ZVNwZWVkfHwxKX19aWYoZS50aGluSW5zdGFuY2VzKXtjb25zdCByPWUudGhpbkluc3RhbmNlcztpZihzLnRoaW5JbnN0YW5jZUVuYWJsZVBpY2tpbmc9ISFyLmVuYWJsZVBpY2tpbmcsci5tYXRyaXhEYXRhPyhzLnRoaW5JbnN0YW5jZVNldEJ1ZmZlcigibWF0cml4IixuZXcgRmxvYXQzMkFycmF5KHIubWF0cml4RGF0YSksMTYsITEpLHMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLm1hdHJpeEJ1ZmZlclNpemU9ci5tYXRyaXhCdWZmZXJTaXplLHMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0NvdW50PXIuaW5zdGFuY2VzQ291bnQpOnMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLm1hdHJpeEJ1ZmZlclNpemU9ci5tYXRyaXhCdWZmZXJTaXplLGUudGhpbkluc3RhbmNlcy51c2VyVGhpbkluc3RhbmNlKXtjb25zdCBuPWUudGhpbkluc3RhbmNlcy51c2VyVGhpbkluc3RhbmNlO2Zvcihjb25zdCBhIGluIG4uZGF0YSlzLnRoaW5JbnN0YW5jZVNldEJ1ZmZlcihhLG5ldyBGbG9hdDMyQXJyYXkobi5kYXRhW2FdKSxuLnN0cmlkZXNbYV0sITEpLHMuX3VzZXJUaGluSW5zdGFuY2VCdWZmZXJzU3RvcmFnZS5zaXplc1thXT1uLnNpemVzW2FdfX1yZXR1cm4gc31zZXRQb3NpdGlvbnNGb3JDUFVTa2lubmluZygpe2NvbnN0IGU9dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm87aWYoIWUuX3NvdXJjZVBvc2l0aW9ucyl7Y29uc3QgdD10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCk7aWYoIXQpcmV0dXJuIGUuX3NvdXJjZVBvc2l0aW9ucztlLl9zb3VyY2VQb3NpdGlvbnM9bmV3IEZsb2F0MzJBcnJheSh0KSx0aGlzLmlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGcuUG9zaXRpb25LaW5kKXx8dGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsdCwhMCl9cmV0dXJuIGUuX3NvdXJjZVBvc2l0aW9uc31zZXROb3JtYWxzRm9yQ1BVU2tpbm5pbmcoKXtjb25zdCBlPXRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvO2lmKCFlLl9zb3VyY2VOb3JtYWxzKXtjb25zdCB0PXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCk7aWYoIXQpcmV0dXJuIGUuX3NvdXJjZU5vcm1hbHM7ZS5fc291cmNlTm9ybWFscz1uZXcgRmxvYXQzMkFycmF5KHQpLHRoaXMuaXNWZXJ0ZXhCdWZmZXJVcGRhdGFibGUoZy5Ob3JtYWxLaW5kKXx8dGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kLHQsITApfXJldHVybiBlLl9zb3VyY2VOb3JtYWxzfWFwcGx5U2tlbGV0b24oZSl7aWYoIXRoaXMuZ2VvbWV0cnkpcmV0dXJuIHRoaXM7aWYodGhpcy5nZW9tZXRyeS5fc29mdHdhcmVTa2lubmluZ0ZyYW1lSWQ9PXRoaXMuZ2V0U2NlbmUoKS5nZXRGcmFtZUlkKCkpcmV0dXJuIHRoaXM7aWYodGhpcy5nZW9tZXRyeS5fc29mdHdhcmVTa2lubmluZ0ZyYW1lSWQ9dGhpcy5nZXRTY2VuZSgpLmdldEZyYW1lSWQoKSwhdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Qb3NpdGlvbktpbmQpKXJldHVybiB0aGlzO2lmKCF0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk1hdHJpY2VzSW5kaWNlc0tpbmQpKXJldHVybiB0aGlzO2lmKCF0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpKXJldHVybiB0aGlzO2NvbnN0IHQ9dGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Ob3JtYWxLaW5kKSxpPXRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvO2lmKCFpLl9zb3VyY2VQb3NpdGlvbnMpe2NvbnN0IHY9dGhpcy5zdWJNZXNoZXMuc2xpY2UoKTt0aGlzLnNldFBvc2l0aW9uc0ZvckNQVVNraW5uaW5nKCksdGhpcy5zdWJNZXNoZXM9dn10JiYhaS5fc291cmNlTm9ybWFscyYmdGhpcy5zZXROb3JtYWxzRm9yQ1BVU2tpbm5pbmcoKTtsZXQgcz10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCk7aWYoIXMpcmV0dXJuIHRoaXM7cyBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheXx8KHM9bmV3IEZsb2F0MzJBcnJheShzKSk7bGV0IHI9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kKTtpZih0KXtpZighcilyZXR1cm4gdGhpcztyIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5fHwocj1uZXcgRmxvYXQzMkFycmF5KHIpKX1jb25zdCBuPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzS2luZCksYT10aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpO2lmKCFhfHwhbilyZXR1cm4gdGhpcztjb25zdCBvPXRoaXMubnVtQm9uZUluZmx1ZW5jZXJzPjQsaD1vP3RoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kKTpudWxsLGw9bz90aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCk6bnVsbCx1PWUuZ2V0VHJhbnNmb3JtTWF0cmljZXModGhpcyksZD1wLlplcm8oKSxmPW5ldyB4LF89bmV3IHg7bGV0IEU9MCxtO2ZvcihsZXQgdj0wO3Y8cy5sZW5ndGg7dis9MyxFKz00KXtsZXQgUztmb3IobT0wO208NDttKyspUz1hW0UrbV0sUz4wJiYoeC5Gcm9tRmxvYXQzMkFycmF5VG9SZWZTY2FsZWQodSxNYXRoLmZsb29yKG5bRSttXSoxNiksUyxfKSxmLmFkZFRvU2VsZihfKSk7aWYobylmb3IobT0wO208NDttKyspUz1sW0UrbV0sUz4wJiYoeC5Gcm9tRmxvYXQzMkFycmF5VG9SZWZTY2FsZWQodSxNYXRoLmZsb29yKGhbRSttXSoxNiksUyxfKSxmLmFkZFRvU2VsZihfKSk7cC5UcmFuc2Zvcm1Db29yZGluYXRlc0Zyb21GbG9hdHNUb1JlZihpLl9zb3VyY2VQb3NpdGlvbnNbdl0saS5fc291cmNlUG9zaXRpb25zW3YrMV0saS5fc291cmNlUG9zaXRpb25zW3YrMl0sZixkKSxkLnRvQXJyYXkocyx2KSx0JiYocC5UcmFuc2Zvcm1Ob3JtYWxGcm9tRmxvYXRzVG9SZWYoaS5fc291cmNlTm9ybWFsc1t2XSxpLl9zb3VyY2VOb3JtYWxzW3YrMV0saS5fc291cmNlTm9ybWFsc1t2KzJdLGYsZCksZC50b0FycmF5KHIsdikpLGYucmVzZXQoKX1yZXR1cm4gdGhpcy51cGRhdGVWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQscyksdCYmdGhpcy51cGRhdGVWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kLHIpLHRoaXN9c3RhdGljIE1pbk1heChlKXtsZXQgdD1udWxsLGk9bnVsbDtyZXR1cm4gZS5mb3JFYWNoKGZ1bmN0aW9uKHMpe2NvbnN0IG49cy5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ0JveDshdHx8IWk/KHQ9bi5taW5pbXVtV29ybGQsaT1uLm1heGltdW1Xb3JsZCk6KHQubWluaW1pemVJblBsYWNlKG4ubWluaW11bVdvcmxkKSxpLm1heGltaXplSW5QbGFjZShuLm1heGltdW1Xb3JsZCkpfSksIXR8fCFpP3ttaW46cC5aZXJvKCksbWF4OnAuWmVybygpfTp7bWluOnQsbWF4Oml9fXN0YXRpYyBDZW50ZXIoZSl7Y29uc3QgdD1lIGluc3RhbmNlb2YgQXJyYXk/Vy5NaW5NYXgoZSk6ZTtyZXR1cm4gcC5DZW50ZXIodC5taW4sdC5tYXgpfXN0YXRpYyBNZXJnZU1lc2hlcyhlLHQ9ITAsaSxzLHIsbil7cmV0dXJuIFBzKFcuX01lcmdlTWVzaGVzQ29yb3V0aW5lKGUsdCxpLHMscixuLCExKSl9c3RhdGljIE1lcmdlTWVzaGVzQXN5bmMoZSx0PSEwLGkscyxyLG4pe3JldHVybiBPbihXLl9NZXJnZU1lc2hlc0Nvcm91dGluZShlLHQsaSxzLHIsbiwhMCksd24oKSl9c3RhdGljKl9NZXJnZU1lc2hlc0Nvcm91dGluZShlLHQ9ITAsaSxzLHIsbixhKXtpZihlPWUuZmlsdGVyKEJvb2xlYW4pLGUubGVuZ3RoPT09MClyZXR1cm4gbnVsbDtsZXQgbztpZighaSl7bGV0IE09MDtmb3Iobz0wO288ZS5sZW5ndGg7bysrKWlmKE0rPWVbb10uZ2V0VG90YWxWZXJ0aWNlcygpLE0+PTY1NTM2KXJldHVybiBPLldhcm4oIkNhbm5vdCBtZXJnZSBtZXNoZXMgYmVjYXVzZSByZXN1bHRpbmcgbWVzaCB3aWxsIGhhdmUgbW9yZSB0aGFuIDY1NTM2IHZlcnRpY2VzLiBQbGVhc2UgdXNlIGFsbG93MzJCaXRzSW5kaWNlcyA9IHRydWUgdG8gdXNlIDMyIGJpdHMgaW5kaWNlcyIpLG51bGx9biYmKHI9ITEpO2NvbnN0IGg9bmV3IEFycmF5LGw9bmV3IEFycmF5LHU9bmV3IEFycmF5LGQ9ZVswXS5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uO2ZvcihvPTA7bzxlLmxlbmd0aDtvKyspe2NvbnN0IE09ZVtvXTtpZihNLmlzQW5JbnN0YW5jZSlyZXR1cm4gTy5XYXJuKCJDYW5ub3QgbWVyZ2UgaW5zdGFuY2UgbWVzaGVzLiIpLG51bGw7aWYoZCE9PU0ub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbilyZXR1cm4gTy5XYXJuKCJDYW5ub3QgbWVyZ2UgbWVzaGVzIHdpdGggZGlmZmVyZW50IG92ZXJyaWRlTWF0ZXJpYWxTaWRlT3JpZW50YXRpb24gdmFsdWVzLiIpLG51bGw7aWYociYmdS5wdXNoKE0uZ2V0VG90YWxJbmRpY2VzKCkpLG4paWYoTS5tYXRlcmlhbCl7Y29uc3QgTD1NLm1hdGVyaWFsO2lmKEwgaW5zdGFuY2VvZiBTaSl7Zm9yKGxldCBrPTA7azxMLnN1Yk1hdGVyaWFscy5sZW5ndGg7aysrKWguaW5kZXhPZihMLnN1Yk1hdGVyaWFsc1trXSk8MCYmaC5wdXNoKEwuc3ViTWF0ZXJpYWxzW2tdKTtmb3IobGV0IGs9MDtrPE0uc3ViTWVzaGVzLmxlbmd0aDtrKyspbC5wdXNoKGguaW5kZXhPZihMLnN1Yk1hdGVyaWFsc1tNLnN1Yk1lc2hlc1trXS5tYXRlcmlhbEluZGV4XSkpLHUucHVzaChNLnN1Yk1lc2hlc1trXS5pbmRleENvdW50KX1lbHNle2guaW5kZXhPZihMKTwwJiZoLnB1c2goTCk7Zm9yKGxldCBrPTA7azxNLnN1Yk1lc2hlcy5sZW5ndGg7aysrKWwucHVzaChoLmluZGV4T2YoTCkpLHUucHVzaChNLnN1Yk1lc2hlc1trXS5pbmRleENvdW50KX19ZWxzZSBmb3IobGV0IEw9MDtMPE0uc3ViTWVzaGVzLmxlbmd0aDtMKyspbC5wdXNoKDApLHUucHVzaChNLnN1Yk1lc2hlc1tMXS5pbmRleENvdW50KX1jb25zdCBmPWVbMF0sXz1NPT57Y29uc3QgTD1NLmNvbXB1dGVXb3JsZE1hdHJpeCghMCk7cmV0dXJuW2VlLkV4dHJhY3RGcm9tTWVzaChNLCExLCExKSxMXX0sW0UsbV09XyhmKTthJiYoeWllbGQpO2NvbnN0IHY9bmV3IEFycmF5KGUubGVuZ3RoLTEpO2ZvcihsZXQgTT0xO008ZS5sZW5ndGg7TSsrKXZbTS0xXT1fKGVbTV0pLGEmJih5aWVsZCk7Y29uc3QgUz1FLl9tZXJnZUNvcm91dGluZShtLHYsaSxhLCF0KTtsZXQgeT1TLm5leHQoKTtmb3IoOyF5LmRvbmU7KWEmJih5aWVsZCkseT1TLm5leHQoKTtjb25zdCBBPXkudmFsdWU7c3x8KHM9bmV3IFcoZi5uYW1lKyJfbWVyZ2VkIixmLmdldFNjZW5lKCkpKTtjb25zdCBDPUEuX2FwcGx5VG9Db3JvdXRpbmUocyx2b2lkIDAsYSk7bGV0IGI9Qy5uZXh0KCk7Zm9yKDshYi5kb25lOylhJiYoeWllbGQpLGI9Qy5uZXh0KCk7aWYocy5jaGVja0NvbGxpc2lvbnM9Zi5jaGVja0NvbGxpc2lvbnMscy5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uPWYub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbix0KWZvcihvPTA7bzxlLmxlbmd0aDtvKyspZVtvXS5kaXNwb3NlKCk7aWYocnx8bil7cy5yZWxlYXNlU3ViTWVzaGVzKCksbz0wO2xldCBNPTA7Zm9yKDtvPHUubGVuZ3RoOyl2dC5DcmVhdGVGcm9tSW5kaWNlcygwLE0sdVtvXSxzLHZvaWQgMCwhMSksTSs9dVtvXSxvKys7Zm9yKGNvbnN0IEwgb2Ygcy5zdWJNZXNoZXMpTC5yZWZyZXNoQm91bmRpbmdJbmZvKCk7cy5jb21wdXRlV29ybGRNYXRyaXgoITApfWlmKG4pe2NvbnN0IE09bmV3IFNpKGYubmFtZSsiX21lcmdlZCIsZi5nZXRTY2VuZSgpKTtNLnN1Yk1hdGVyaWFscz1oO2ZvcihsZXQgTD0wO0w8cy5zdWJNZXNoZXMubGVuZ3RoO0wrKylzLnN1Yk1lc2hlc1tMXS5tYXRlcmlhbEluZGV4PWxbTF07cy5tYXRlcmlhbD1NfWVsc2Ugcy5tYXRlcmlhbD1mLm1hdGVyaWFsO3JldHVybiBzfWFkZEluc3RhbmNlKGUpe2UuX2luZGV4SW5Tb3VyY2VNZXNoSW5zdGFuY2VBcnJheT10aGlzLmluc3RhbmNlcy5sZW5ndGgsdGhpcy5pbnN0YW5jZXMucHVzaChlKX1yZW1vdmVJbnN0YW5jZShlKXtjb25zdCB0PWUuX2luZGV4SW5Tb3VyY2VNZXNoSW5zdGFuY2VBcnJheTtpZih0IT0tMSl7aWYodCE9PXRoaXMuaW5zdGFuY2VzLmxlbmd0aC0xKXtjb25zdCBpPXRoaXMuaW5zdGFuY2VzW3RoaXMuaW5zdGFuY2VzLmxlbmd0aC0xXTt0aGlzLmluc3RhbmNlc1t0XT1pLGkuX2luZGV4SW5Tb3VyY2VNZXNoSW5zdGFuY2VBcnJheT10fWUuX2luZGV4SW5Tb3VyY2VNZXNoSW5zdGFuY2VBcnJheT0tMSx0aGlzLmluc3RhbmNlcy5wb3AoKX19X3Nob3VsZENvbnZlcnRSSFMoKXtyZXR1cm4gdGhpcy5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uPT09UC5Db3VudGVyQ2xvY2tXaXNlU2lkZU9yaWVudGF0aW9ufX1XLkZST05UU0lERT1lZS5GUk9OVFNJREUsVy5CQUNLU0lERT1lZS5CQUNLU0lERSxXLkRPVUJMRVNJREU9ZWUuRE9VQkxFU0lERSxXLkRFRkFVTFRTSURFPWVlLkRFRkFVTFRTSURFLFcuTk9fQ0FQPTAsVy5DQVBfU1RBUlQ9MSxXLkNBUF9FTkQ9MixXLkNBUF9BTEw9MyxXLk5PX0ZMSVA9MCxXLkZMSVBfVElMRT0xLFcuUk9UQVRFX1RJTEU9MixXLkZMSVBfUk9XPTMsVy5ST1RBVEVfUk9XPTQsVy5GTElQX05fUk9UQVRFX1RJTEU9NSxXLkZMSVBfTl9ST1RBVEVfUk9XPTYsVy5DRU5URVI9MCxXLkxFRlQ9MSxXLlJJR0hUPTIsVy5UT1A9MyxXLkJPVFRPTT00LFcuSU5TVEFOQ0VETUVTSF9TT1JUX1RSQU5TUEFSRU5UPSExLFcuX0dyb3VuZE1lc2hQYXJzZXI9KGMsZSk9Pnt0aHJvdyAkKCJHcm91bmRNZXNoIil9LFcuX0dvbGRiZXJnTWVzaFBhcnNlcj0oYyxlKT0+e3Rocm93ICQoIkdvbGRiZXJnTWVzaCIpfSxXLl9MaW5lc01lc2hQYXJzZXI9KGMsZSk9Pnt0aHJvdyAkKCJMaW5lc01lc2giKX0saXQoIkJBQllMT04uTWVzaCIsVyksVy5wcm90b3R5cGUuc2V0TWF0ZXJpYWxCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLnNldE1hdGVyaWFsQnlJZChjKX0sVy5DcmVhdGVEaXNjPVcuQ3JlYXRlRGlzY3x8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVCb3g9Vy5DcmVhdGVCb3h8fCgoKT0+e3Rocm93IG5ldyBFcnJvcigiSW1wb3J0IE1lc2hCdWlsZGVyIHRvIHBvcHVsYXRlIHRoaXMgZnVuY3Rpb24iKX0pLFcuQ3JlYXRlU3BoZXJlPVcuQ3JlYXRlU3BoZXJlfHwoKCk9Pnt0aHJvdyBuZXcgRXJyb3IoIkltcG9ydCBNZXNoQnVpbGRlciB0byBwb3B1bGF0ZSB0aGlzIGZ1bmN0aW9uIil9KSxXLkNyZWF0ZUN5bGluZGVyPVcuQ3JlYXRlQ3lsaW5kZXJ8fCgoKT0+e3Rocm93IG5ldyBFcnJvcigiSW1wb3J0IE1lc2hCdWlsZGVyIHRvIHBvcHVsYXRlIHRoaXMgZnVuY3Rpb24iKX0pLFcuQ3JlYXRlVG9ydXNLbm90PVcuQ3JlYXRlVG9ydXNLbm90fHwoKCk9Pnt0aHJvdyBuZXcgRXJyb3IoIkltcG9ydCBNZXNoQnVpbGRlciB0byBwb3B1bGF0ZSB0aGlzIGZ1bmN0aW9uIil9KSxXLkNyZWF0ZVRvcnVzPVcuQ3JlYXRlVG9ydXN8fCgoKT0+e3Rocm93IG5ldyBFcnJvcigiSW1wb3J0IE1lc2hCdWlsZGVyIHRvIHBvcHVsYXRlIHRoaXMgZnVuY3Rpb24iKX0pLFcuQ3JlYXRlUGxhbmU9Vy5DcmVhdGVQbGFuZXx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVHcm91bmQ9Vy5DcmVhdGVHcm91bmR8fCgoKT0+e3Rocm93IG5ldyBFcnJvcigiSW1wb3J0IE1lc2hCdWlsZGVyIHRvIHBvcHVsYXRlIHRoaXMgZnVuY3Rpb24iKX0pLFcuQ3JlYXRlVGlsZWRHcm91bmQ9Vy5DcmVhdGVUaWxlZEdyb3VuZHx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVHcm91bmRGcm9tSGVpZ2h0TWFwPVcuQ3JlYXRlR3JvdW5kRnJvbUhlaWdodE1hcHx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVUdWJlPVcuQ3JlYXRlVHViZXx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVQb2x5aGVkcm9uPVcuQ3JlYXRlUG9seWhlZHJvbnx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVJY29TcGhlcmU9Vy5DcmVhdGVJY29TcGhlcmV8fCgoKT0+e3Rocm93IG5ldyBFcnJvcigiSW1wb3J0IE1lc2hCdWlsZGVyIHRvIHBvcHVsYXRlIHRoaXMgZnVuY3Rpb24iKX0pLFcuQ3JlYXRlRGVjYWw9Vy5DcmVhdGVEZWNhbHx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVDYXBzdWxlPVcuQ3JlYXRlQ2Fwc3VsZXx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5FeHRlbmRUb0dvbGRiZXJnPVcuRXh0ZW5kVG9Hb2xkYmVyZ3x8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSk7Y2xhc3MgenR7Y29uc3RydWN0b3IoZT0wKXt0aGlzLnByaW9yaXR5PWV9Z2V0RGVzY3JpcHRpb24oKXtyZXR1cm4iIn1hcHBseShlLHQpe3JldHVybiEwfX1jbGFzcyBMcyBleHRlbmRzIHp0e2NvbnN0cnVjdG9yKGU9MCx0PTEwMjQsaT0uNSl7c3VwZXIoZSksdGhpcy5wcmlvcml0eT1lLHRoaXMubWF4aW11bVNpemU9dCx0aGlzLnN0ZXA9aX1nZXREZXNjcmlwdGlvbigpe3JldHVybiJSZWR1Y2luZyByZW5kZXIgdGFyZ2V0IHRleHR1cmUgc2l6ZSB0byAiK3RoaXMubWF4aW11bVNpemV9YXBwbHkoZSx0KXtsZXQgaT0hMDtmb3IobGV0IHM9MDtzPGUudGV4dHVyZXMubGVuZ3RoO3MrKyl7Y29uc3Qgcj1lLnRleHR1cmVzW3NdO2lmKCFyLmNhblJlc2NhbGV8fHIuZ2V0Q29udGV4dCljb250aW51ZTtjb25zdCBuPXIuZ2V0U2l6ZSgpO01hdGgubWF4KG4ud2lkdGgsbi5oZWlnaHQpPnRoaXMubWF4aW11bVNpemUmJihyLnNjYWxlKHRoaXMuc3RlcCksaT0hMSl9cmV0dXJuIGl9fWNsYXNzIFByIGV4dGVuZHMgenR7Y29uc3RydWN0b3IoZT0wLHQ9MixpPS4yNSl7c3VwZXIoZSksdGhpcy5wcmlvcml0eT1lLHRoaXMubWF4aW11bVNjYWxlPXQsdGhpcy5zdGVwPWksdGhpcy5fY3VycmVudFNjYWxlPS0xLHRoaXMuX2RpcmVjdGlvbk9mZnNldD0xfWdldERlc2NyaXB0aW9uKCl7cmV0dXJuIlNldHRpbmcgaGFyZHdhcmUgc2NhbGluZyBsZXZlbCB0byAiK3RoaXMuX2N1cnJlbnRTY2FsZX1hcHBseShlLHQpe3JldHVybiB0aGlzLl9jdXJyZW50U2NhbGU9PT0tMSYmKHRoaXMuX2N1cnJlbnRTY2FsZT1lLmdldEVuZ2luZSgpLmdldEhhcmR3YXJlU2NhbGluZ0xldmVsKCksdGhpcy5fY3VycmVudFNjYWxlPnRoaXMubWF4aW11bVNjYWxlJiYodGhpcy5fZGlyZWN0aW9uT2Zmc2V0PS0xKSksdGhpcy5fY3VycmVudFNjYWxlKz10aGlzLl9kaXJlY3Rpb25PZmZzZXQqdGhpcy5zdGVwLGUuZ2V0RW5naW5lKCkuc2V0SGFyZHdhcmVTY2FsaW5nTGV2ZWwodGhpcy5fY3VycmVudFNjYWxlKSx0aGlzLl9kaXJlY3Rpb25PZmZzZXQ9PT0xP3RoaXMuX2N1cnJlbnRTY2FsZT49dGhpcy5tYXhpbXVtU2NhbGU6dGhpcy5fY3VycmVudFNjYWxlPD10aGlzLm1heGltdW1TY2FsZX19Y2xhc3MgTnMgZXh0ZW5kcyB6dHtnZXREZXNjcmlwdGlvbigpe3JldHVybiJUdXJuaW5nIHNoYWRvd3Mgb24vb2ZmIn1hcHBseShlLHQpe3JldHVybiBlLnNoYWRvd3NFbmFibGVkPXQuaXNJbkltcHJvdmVtZW50TW9kZSwhMH19Y2xhc3MgQnMgZXh0ZW5kcyB6dHtnZXREZXNjcmlwdGlvbigpe3JldHVybiJUdXJuaW5nIHBvc3QtcHJvY2Vzc2VzIG9uL29mZiJ9YXBwbHkoZSx0KXtyZXR1cm4gZS5wb3N0UHJvY2Vzc2VzRW5hYmxlZD10LmlzSW5JbXByb3ZlbWVudE1vZGUsITB9fWNsYXNzIFVzIGV4dGVuZHMgenR7Z2V0RGVzY3JpcHRpb24oKXtyZXR1cm4iVHVybmluZyBsZW5zIGZsYXJlcyBvbi9vZmYifWFwcGx5KGUsdCl7cmV0dXJuIGUubGVuc0ZsYXJlc0VuYWJsZWQ9dC5pc0luSW1wcm92ZW1lbnRNb2RlLCEwfX1jbGFzcyBIbiBleHRlbmRzIHp0e2dldERlc2NyaXB0aW9uKCl7cmV0dXJuIHRoaXMub25HZXREZXNjcmlwdGlvbj90aGlzLm9uR2V0RGVzY3JpcHRpb24oKToiUnVubmluZyB1c2VyIGRlZmluZWQgY2FsbGJhY2sifWFwcGx5KGUsdCl7cmV0dXJuIHRoaXMub25BcHBseT90aGlzLm9uQXBwbHkoZSx0KTohMH19Y2xhc3Mga3MgZXh0ZW5kcyB6dHtnZXREZXNjcmlwdGlvbigpe3JldHVybiJUdXJuaW5nIHBhcnRpY2xlcyBvbi9vZmYifWFwcGx5KGUsdCl7cmV0dXJuIGUucGFydGljbGVzRW5hYmxlZD10LmlzSW5JbXByb3ZlbWVudE1vZGUsITB9fWNsYXNzIERyIGV4dGVuZHMgenR7Z2V0RGVzY3JpcHRpb24oKXtyZXR1cm4iVHVybmluZyByZW5kZXIgdGFyZ2V0cyBvZmYifWFwcGx5KGUsdCl7cmV0dXJuIGUucmVuZGVyVGFyZ2V0c0VuYWJsZWQ9dC5pc0luSW1wcm92ZW1lbnRNb2RlLCEwfX1jbGFzcyBRdCBleHRlbmRzIHp0e2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLl9jYW5CZU1lcmdlZD1lPT57aWYoIShlIGluc3RhbmNlb2YgVykpcmV0dXJuITE7Y29uc3QgdD1lO3JldHVybiEodC5pc0Rpc3Bvc2VkKCl8fCF0LmlzVmlzaWJsZXx8IXQuaXNFbmFibGVkKCl8fHQuaW5zdGFuY2VzLmxlbmd0aD4wfHx0LnNrZWxldG9ufHx0Lmhhc0xPRExldmVscyl9fXN0YXRpYyBnZXQgVXBkYXRlU2VsZWN0aW9uVHJlZSgpe3JldHVybiBRdC5fVXBkYXRlU2VsZWN0aW9uVHJlZX1zdGF0aWMgc2V0IFVwZGF0ZVNlbGVjdGlvblRyZWUoZSl7UXQuX1VwZGF0ZVNlbGVjdGlvblRyZWU9ZX1nZXREZXNjcmlwdGlvbigpe3JldHVybiJNZXJnaW5nIHNpbWlsYXIgbWVzaGVzIHRvZ2V0aGVyIn1hcHBseShlLHQsaSl7Y29uc3Qgcz1lLm1lc2hlcy5zbGljZSgwKTtsZXQgcj1zLmxlbmd0aDtmb3IobGV0IGE9MDthPHI7YSsrKXtjb25zdCBvPW5ldyBBcnJheSxoPXNbYV07aWYodGhpcy5fY2FuQmVNZXJnZWQoaCkpe28ucHVzaChoKTtmb3IobGV0IGw9YSsxO2w8cjtsKyspe2NvbnN0IHU9c1tsXTt0aGlzLl9jYW5CZU1lcmdlZCh1KSYmdS5tYXRlcmlhbD09PWgubWF0ZXJpYWwmJnUuY2hlY2tDb2xsaXNpb25zPT09aC5jaGVja0NvbGxpc2lvbnMmJihvLnB1c2godSksci0tLHMuc3BsaWNlKGwsMSksbC0tKX1vLmxlbmd0aDwyfHxXLk1lcmdlTWVzaGVzKG8sdm9pZCAwLCEwKX19Y29uc3Qgbj1lO3JldHVybiBuLmNyZWF0ZU9yVXBkYXRlU2VsZWN0aW9uT2N0cmVlJiYoaSE9bnVsbD9pJiZuLmNyZWF0ZU9yVXBkYXRlU2VsZWN0aW9uT2N0cmVlKCk6UXQuVXBkYXRlU2VsZWN0aW9uVHJlZSYmbi5jcmVhdGVPclVwZGF0ZVNlbGVjdGlvbk9jdHJlZSgpKSwhMH19UXQuX1VwZGF0ZVNlbGVjdGlvblRyZWU9ITE7Y2xhc3MgZ2l7Y29uc3RydWN0b3IoZT02MCx0PTJlMyl7dGhpcy50YXJnZXRGcmFtZVJhdGU9ZSx0aGlzLnRyYWNrZXJEdXJhdGlvbj10LHRoaXMub3B0aW1pemF0aW9ucz1uZXcgQXJyYXl9YWRkT3B0aW1pemF0aW9uKGUpe3JldHVybiB0aGlzLm9wdGltaXphdGlvbnMucHVzaChlKSx0aGlzfWFkZEN1c3RvbU9wdGltaXphdGlvbihlLHQsaT0wKXtjb25zdCBzPW5ldyBIbihpKTtyZXR1cm4gcy5vbkFwcGx5PWUscy5vbkdldERlc2NyaXB0aW9uPXQsdGhpcy5vcHRpbWl6YXRpb25zLnB1c2gocyksdGhpc31zdGF0aWMgTG93RGVncmFkYXRpb25BbGxvd2VkKGUpe2NvbnN0IHQ9bmV3IGdpKGUpO2xldCBpPTA7cmV0dXJuIHQuYWRkT3B0aW1pemF0aW9uKG5ldyBRdChpKSksdC5hZGRPcHRpbWl6YXRpb24obmV3IE5zKGkpKSx0LmFkZE9wdGltaXphdGlvbihuZXcgVXMoaSkpLGkrKyx0LmFkZE9wdGltaXphdGlvbihuZXcgQnMoaSkpLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBrcyhpKSksaSsrLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBMcyhpLDEwMjQpKSx0fXN0YXRpYyBNb2RlcmF0ZURlZ3JhZGF0aW9uQWxsb3dlZChlKXtjb25zdCB0PW5ldyBnaShlKTtsZXQgaT0wO3JldHVybiB0LmFkZE9wdGltaXphdGlvbihuZXcgUXQoaSkpLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBOcyhpKSksdC5hZGRPcHRpbWl6YXRpb24obmV3IFVzKGkpKSxpKyssdC5hZGRPcHRpbWl6YXRpb24obmV3IEJzKGkpKSx0LmFkZE9wdGltaXphdGlvbihuZXcga3MoaSkpLGkrKyx0LmFkZE9wdGltaXphdGlvbihuZXcgTHMoaSw1MTIpKSxpKyssdC5hZGRPcHRpbWl6YXRpb24obmV3IERyKGkpKSxpKyssdC5hZGRPcHRpbWl6YXRpb24obmV3IFByKGksMikpLHR9c3RhdGljIEhpZ2hEZWdyYWRhdGlvbkFsbG93ZWQoZSl7Y29uc3QgdD1uZXcgZ2koZSk7bGV0IGk9MDtyZXR1cm4gdC5hZGRPcHRpbWl6YXRpb24obmV3IFF0KGkpKSx0LmFkZE9wdGltaXphdGlvbihuZXcgTnMoaSkpLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBVcyhpKSksaSsrLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBCcyhpKSksdC5hZGRPcHRpbWl6YXRpb24obmV3IGtzKGkpKSxpKyssdC5hZGRPcHRpbWl6YXRpb24obmV3IExzKGksMjU2KSksaSsrLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBEcihpKSksaSsrLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBQcihpLDQpKSx0fX1jbGFzcyBWc3tjb25zdHJ1Y3RvcihlLHQsaT0hMCxzPSExKXtpZih0aGlzLl9pc1J1bm5pbmc9ITEsdGhpcy5fY3VycmVudFByaW9yaXR5TGV2ZWw9MCx0aGlzLl90YXJnZXRGcmFtZVJhdGU9NjAsdGhpcy5fdHJhY2tlckR1cmF0aW9uPTJlMyx0aGlzLl9jdXJyZW50RnJhbWVSYXRlPTAsdGhpcy5faW1wcm92ZW1lbnRNb2RlPSExLHRoaXMub25TdWNjZXNzT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTmV3T3B0aW1pemF0aW9uQXBwbGllZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkZhaWx1cmVPYnNlcnZhYmxlPW5ldyBGLHQ/dGhpcy5fb3B0aW9ucz10OnRoaXMuX29wdGlvbnM9bmV3IGdpLHRoaXMuX29wdGlvbnMudGFyZ2V0RnJhbWVSYXRlJiYodGhpcy5fdGFyZ2V0RnJhbWVSYXRlPXRoaXMuX29wdGlvbnMudGFyZ2V0RnJhbWVSYXRlKSx0aGlzLl9vcHRpb25zLnRyYWNrZXJEdXJhdGlvbiYmKHRoaXMuX3RyYWNrZXJEdXJhdGlvbj10aGlzLl9vcHRpb25zLnRyYWNrZXJEdXJhdGlvbiksaSl7bGV0IHI9MDtmb3IoY29uc3QgbiBvZiB0aGlzLl9vcHRpb25zLm9wdGltaXphdGlvbnMpbi5wcmlvcml0eT1yKyt9dGhpcy5faW1wcm92ZW1lbnRNb2RlPXMsdGhpcy5fc2NlbmU9ZXx8ZmUuTGFzdENyZWF0ZWRTY2VuZSx0aGlzLl9zY2VuZURpc3Bvc2VPYnNlcnZlcj10aGlzLl9zY2VuZS5vbkRpc3Bvc2VPYnNlcnZhYmxlLmFkZCgoKT0+e3RoaXMuX3NjZW5lRGlzcG9zZU9ic2VydmVyPW51bGwsdGhpcy5kaXNwb3NlKCl9KX1nZXQgaXNJbkltcHJvdmVtZW50TW9kZSgpe3JldHVybiB0aGlzLl9pbXByb3ZlbWVudE1vZGV9c2V0IGlzSW5JbXByb3ZlbWVudE1vZGUoZSl7dGhpcy5faW1wcm92ZW1lbnRNb2RlPWV9Z2V0IGN1cnJlbnRQcmlvcml0eUxldmVsKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRQcmlvcml0eUxldmVsfWdldCBjdXJyZW50RnJhbWVSYXRlKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRGcmFtZVJhdGV9Z2V0IHRhcmdldEZyYW1lUmF0ZSgpe3JldHVybiB0aGlzLl90YXJnZXRGcmFtZVJhdGV9c2V0IHRhcmdldEZyYW1lUmF0ZShlKXt0aGlzLl90YXJnZXRGcmFtZVJhdGU9ZX1nZXQgdHJhY2tlckR1cmF0aW9uKCl7cmV0dXJuIHRoaXMuX3RyYWNrZXJEdXJhdGlvbn1zZXQgdHJhY2tlckR1cmF0aW9uKGUpe3RoaXMuX3RyYWNrZXJEdXJhdGlvbj1lfWdldCBvcHRpbWl6YXRpb25zKCl7cmV0dXJuIHRoaXMuX29wdGlvbnMub3B0aW1pemF0aW9uc31zdG9wKCl7dGhpcy5faXNSdW5uaW5nPSExfXJlc2V0KCl7dGhpcy5fY3VycmVudFByaW9yaXR5TGV2ZWw9MH1zdGFydCgpe3RoaXMuX2lzUnVubmluZ3x8KHRoaXMuX2lzUnVubmluZz0hMCx0aGlzLl9zY2VuZS5leGVjdXRlV2hlblJlYWR5KCgpPT57c2V0VGltZW91dCgoKT0+e3RoaXMuX2NoZWNrQ3VycmVudFN0YXRlKCl9LHRoaXMuX3RyYWNrZXJEdXJhdGlvbil9KSl9X2NoZWNrQ3VycmVudFN0YXRlKCl7aWYoIXRoaXMuX2lzUnVubmluZylyZXR1cm47Y29uc3QgZT10aGlzLl9zY2VuZSx0PXRoaXMuX29wdGlvbnM7aWYodGhpcy5fY3VycmVudEZyYW1lUmF0ZT1NYXRoLnJvdW5kKGUuZ2V0RW5naW5lKCkuZ2V0RnBzKCkpLHRoaXMuX2ltcHJvdmVtZW50TW9kZSYmdGhpcy5fY3VycmVudEZyYW1lUmF0ZTw9dGhpcy5fdGFyZ2V0RnJhbWVSYXRlfHwhdGhpcy5faW1wcm92ZW1lbnRNb2RlJiZ0aGlzLl9jdXJyZW50RnJhbWVSYXRlPj10aGlzLl90YXJnZXRGcmFtZVJhdGUpe3RoaXMuX2lzUnVubmluZz0hMSx0aGlzLm9uU3VjY2Vzc09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO3JldHVybn1sZXQgaT0hMCxzPSEwO2ZvcihsZXQgcj0wO3I8dC5vcHRpbWl6YXRpb25zLmxlbmd0aDtyKyspe2NvbnN0IG49dC5vcHRpbWl6YXRpb25zW3JdO24ucHJpb3JpdHk9PT10aGlzLl9jdXJyZW50UHJpb3JpdHlMZXZlbCYmKHM9ITEsaT1pJiZuLmFwcGx5KGUsdGhpcyksdGhpcy5vbk5ld09wdGltaXphdGlvbkFwcGxpZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhuKSl9aWYocyl7dGhpcy5faXNSdW5uaW5nPSExLHRoaXMub25GYWlsdXJlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyk7cmV0dXJufWkmJnRoaXMuX2N1cnJlbnRQcmlvcml0eUxldmVsKyssZS5leGVjdXRlV2hlblJlYWR5KCgpPT57c2V0VGltZW91dCgoKT0+e3RoaXMuX2NoZWNrQ3VycmVudFN0YXRlKCl9LHRoaXMuX3RyYWNrZXJEdXJhdGlvbil9KX1kaXNwb3NlKCl7dGhpcy5zdG9wKCksdGhpcy5vblN1Y2Nlc3NPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkZhaWx1cmVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbk5ld09wdGltaXphdGlvbkFwcGxpZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5fc2NlbmVEaXNwb3NlT2JzZXJ2ZXImJnRoaXMuX3NjZW5lLm9uRGlzcG9zZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX3NjZW5lRGlzcG9zZU9ic2VydmVyKX1zdGF0aWMgT3B0aW1pemVBc3luYyhlLHQsaSxzKXtjb25zdCByPW5ldyBWcyhlLHR8fGdpLk1vZGVyYXRlRGVncmFkYXRpb25BbGxvd2VkKCksITEpO3JldHVybiBpJiZyLm9uU3VjY2Vzc09ic2VydmFibGUuYWRkKCgpPT57aSgpfSkscyYmci5vbkZhaWx1cmVPYnNlcnZhYmxlLmFkZCgoKT0+e3MoKX0pLHIuc3RhcnQoKSxyfX1mdW5jdGlvbiBLbihjKXtjb25zdHtlbmdpbmU6ZX09Yyx0PW5ldyBuZShlKTt0LmNsZWFyQ29sb3I9bmV3IG1lKDAsMCwwLDApLHQucG9pbnRlck1vdmVQcmVkaWNhdGU9KCk9PiExLHQucG9pbnRlckRvd25QcmVkaWNhdGU9KCk9PiExLHQucG9pbnRlclVwUHJlZGljYXRlPSgpPT4hMSx0LmNsZWFyQ2FjaGVkVmVydGV4RGF0YSgpLHQudGhlbWVEYXRhPXt9O2NvbnN0IGk9Z2kuTG93RGVncmFkYXRpb25BbGxvd2VkKCk7cmV0dXJuIGkub3B0aW1pemF0aW9ucz1pLm9wdGltaXphdGlvbnMuc3BsaWNlKDEpLGkudGFyZ2V0RnJhbWVSYXRlPTYwLFZzLk9wdGltaXplQXN5bmModCxpKSx0fWNsYXNzIEdlIGV4dGVuZHMgantjb25zdHJ1Y3RvcihlLHQsaSxzPSEwKXtzdXBlcihlLHQsaSxzKSx0aGlzLl90bXBVcFZlY3Rvcj1wLlplcm8oKSx0aGlzLl90bXBUYXJnZXRWZWN0b3I9cC5aZXJvKCksdGhpcy5jYW1lcmFEaXJlY3Rpb249bmV3IHAoMCwwLDApLHRoaXMuY2FtZXJhUm90YXRpb249bmV3IHZlKDAsMCksdGhpcy5pZ25vcmVQYXJlbnRTY2FsaW5nPSExLHRoaXMudXBkYXRlVXBWZWN0b3JGcm9tUm90YXRpb249ITEsdGhpcy5fdG1wUXVhdGVybmlvbj1uZXcgWix0aGlzLnJvdGF0aW9uPW5ldyBwKDAsMCwwKSx0aGlzLnNwZWVkPTIsdGhpcy5ub1JvdGF0aW9uQ29uc3RyYWludD0hMSx0aGlzLmludmVydFJvdGF0aW9uPSExLHRoaXMuaW52ZXJzZVJvdGF0aW9uU3BlZWQ9LjIsdGhpcy5sb2NrZWRUYXJnZXQ9bnVsbCx0aGlzLl9jdXJyZW50VGFyZ2V0PXAuWmVybygpLHRoaXMuX2luaXRpYWxGb2NhbERpc3RhbmNlPTEsdGhpcy5fdmlld01hdHJpeD14Llplcm8oKSx0aGlzLl9jYW1NYXRyaXg9eC5aZXJvKCksdGhpcy5fY2FtZXJhVHJhbnNmb3JtTWF0cml4PXguWmVybygpLHRoaXMuX2NhbWVyYVJvdGF0aW9uTWF0cml4PXguWmVybygpLHRoaXMuX3JlZmVyZW5jZVBvaW50PW5ldyBwKDAsMCwxKSx0aGlzLl90cmFuc2Zvcm1lZFJlZmVyZW5jZVBvaW50PXAuWmVybygpLHRoaXMuX2RlZmF1bHRVcD1wLlVwKCksdGhpcy5fY2FjaGVkUm90YXRpb25aPTAsdGhpcy5fY2FjaGVkUXVhdGVybmlvblJvdGF0aW9uWj0wfWdldEZyb250UG9zaXRpb24oZSl7dGhpcy5nZXRXb3JsZE1hdHJpeCgpO2NvbnN0IHQ9dGhpcy5nZXRUYXJnZXQoKS5zdWJ0cmFjdCh0aGlzLnBvc2l0aW9uKTtyZXR1cm4gdC5ub3JtYWxpemUoKSx0LnNjYWxlSW5QbGFjZShlKSx0aGlzLmdsb2JhbFBvc2l0aW9uLmFkZCh0KX1fZ2V0TG9ja2VkVGFyZ2V0UG9zaXRpb24oKXtyZXR1cm4gdGhpcy5sb2NrZWRUYXJnZXQ/KHRoaXMubG9ja2VkVGFyZ2V0LmFic29sdXRlUG9zaXRpb24mJnRoaXMubG9ja2VkVGFyZ2V0LmNvbXB1dGVXb3JsZE1hdHJpeCgpLHRoaXMubG9ja2VkVGFyZ2V0LmFic29sdXRlUG9zaXRpb258fHRoaXMubG9ja2VkVGFyZ2V0KTpudWxsfXN0b3JlU3RhdGUoKXtyZXR1cm4gdGhpcy5fc3RvcmVkUG9zaXRpb249dGhpcy5wb3NpdGlvbi5jbG9uZSgpLHRoaXMuX3N0b3JlZFJvdGF0aW9uPXRoaXMucm90YXRpb24uY2xvbmUoKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbiYmKHRoaXMuX3N0b3JlZFJvdGF0aW9uUXVhdGVybmlvbj10aGlzLnJvdGF0aW9uUXVhdGVybmlvbi5jbG9uZSgpKSxzdXBlci5zdG9yZVN0YXRlKCl9X3Jlc3RvcmVTdGF0ZVZhbHVlcygpe3JldHVybiBzdXBlci5fcmVzdG9yZVN0YXRlVmFsdWVzKCk/KHRoaXMucG9zaXRpb249dGhpcy5fc3RvcmVkUG9zaXRpb24uY2xvbmUoKSx0aGlzLnJvdGF0aW9uPXRoaXMuX3N0b3JlZFJvdGF0aW9uLmNsb25lKCksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24mJih0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj10aGlzLl9zdG9yZWRSb3RhdGlvblF1YXRlcm5pb24uY2xvbmUoKSksdGhpcy5jYW1lcmFEaXJlY3Rpb24uY29weUZyb21GbG9hdHMoMCwwLDApLHRoaXMuY2FtZXJhUm90YXRpb24uY29weUZyb21GbG9hdHMoMCwwKSwhMCk6ITF9X2luaXRDYWNoZSgpe3N1cGVyLl9pbml0Q2FjaGUoKSx0aGlzLl9jYWNoZS5sb2NrZWRUYXJnZXQ9bmV3IHAoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLHRoaXMuX2NhY2hlLnJvdGF0aW9uPW5ldyBwKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSx0aGlzLl9jYWNoZS5yb3RhdGlvblF1YXRlcm5pb249bmV3IFooTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSl9X3VwZGF0ZUNhY2hlKGUpe2V8fHN1cGVyLl91cGRhdGVDYWNoZSgpO2NvbnN0IHQ9dGhpcy5fZ2V0TG9ja2VkVGFyZ2V0UG9zaXRpb24oKTt0P3RoaXMuX2NhY2hlLmxvY2tlZFRhcmdldD90aGlzLl9jYWNoZS5sb2NrZWRUYXJnZXQuY29weUZyb20odCk6dGhpcy5fY2FjaGUubG9ja2VkVGFyZ2V0PXQuY2xvbmUoKTp0aGlzLl9jYWNoZS5sb2NrZWRUYXJnZXQ9bnVsbCx0aGlzLl9jYWNoZS5yb3RhdGlvbi5jb3B5RnJvbSh0aGlzLnJvdGF0aW9uKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbiYmdGhpcy5fY2FjaGUucm90YXRpb25RdWF0ZXJuaW9uLmNvcHlGcm9tKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uKX1faXNTeW5jaHJvbml6ZWRWaWV3TWF0cml4KCl7aWYoIXN1cGVyLl9pc1N5bmNocm9uaXplZFZpZXdNYXRyaXgoKSlyZXR1cm4hMTtjb25zdCBlPXRoaXMuX2dldExvY2tlZFRhcmdldFBvc2l0aW9uKCk7cmV0dXJuKHRoaXMuX2NhY2hlLmxvY2tlZFRhcmdldD90aGlzLl9jYWNoZS5sb2NrZWRUYXJnZXQuZXF1YWxzKGUpOiFlKSYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uP3RoaXMucm90YXRpb25RdWF0ZXJuaW9uLmVxdWFscyh0aGlzLl9jYWNoZS5yb3RhdGlvblF1YXRlcm5pb24pOnRoaXMuX2NhY2hlLnJvdGF0aW9uLmVxdWFscyh0aGlzLnJvdGF0aW9uKSl9X2NvbXB1dGVMb2NhbENhbWVyYVNwZWVkKCl7Y29uc3QgZT10aGlzLmdldEVuZ2luZSgpO3JldHVybiB0aGlzLnNwZWVkKk1hdGguc3FydChlLmdldERlbHRhVGltZSgpLyhlLmdldEZwcygpKjEwMCkpfXNldFRhcmdldChlKXt0aGlzLnVwVmVjdG9yLm5vcm1hbGl6ZSgpLHRoaXMuX2luaXRpYWxGb2NhbERpc3RhbmNlPWUuc3VidHJhY3QodGhpcy5wb3NpdGlvbikubGVuZ3RoKCksdGhpcy5wb3NpdGlvbi56PT09ZS56JiYodGhpcy5wb3NpdGlvbi56Kz14ZSksdGhpcy5fcmVmZXJlbmNlUG9pbnQubm9ybWFsaXplKCkuc2NhbGVJblBsYWNlKHRoaXMuX2luaXRpYWxGb2NhbERpc3RhbmNlKSx4Lkxvb2tBdExIVG9SZWYodGhpcy5wb3NpdGlvbixlLHRoaXMuX2RlZmF1bHRVcCx0aGlzLl9jYW1NYXRyaXgpLHRoaXMuX2NhbU1hdHJpeC5pbnZlcnQoKSx0aGlzLnJvdGF0aW9uLng9TWF0aC5hdGFuKHRoaXMuX2NhbU1hdHJpeC5tWzZdL3RoaXMuX2NhbU1hdHJpeC5tWzEwXSk7Y29uc3QgdD1lLnN1YnRyYWN0KHRoaXMucG9zaXRpb24pO3QueD49MD90aGlzLnJvdGF0aW9uLnk9LU1hdGguYXRhbih0LnovdC54KStNYXRoLlBJLzI6dGhpcy5yb3RhdGlvbi55PS1NYXRoLmF0YW4odC56L3QueCktTWF0aC5QSS8yLHRoaXMucm90YXRpb24uej0wLGlzTmFOKHRoaXMucm90YXRpb24ueCkmJih0aGlzLnJvdGF0aW9uLng9MCksaXNOYU4odGhpcy5yb3RhdGlvbi55KSYmKHRoaXMucm90YXRpb24ueT0wKSxpc05hTih0aGlzLnJvdGF0aW9uLnopJiYodGhpcy5yb3RhdGlvbi56PTApLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uJiZaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodGhpcy5yb3RhdGlvbi55LHRoaXMucm90YXRpb24ueCx0aGlzLnJvdGF0aW9uLnosdGhpcy5yb3RhdGlvblF1YXRlcm5pb24pfWdldCB0YXJnZXQoKXtyZXR1cm4gdGhpcy5nZXRUYXJnZXQoKX1zZXQgdGFyZ2V0KGUpe3RoaXMuc2V0VGFyZ2V0KGUpfWdldFRhcmdldCgpe3JldHVybiB0aGlzLl9jdXJyZW50VGFyZ2V0fV9kZWNpZGVJZk5lZWRzVG9Nb3ZlKCl7cmV0dXJuIE1hdGguYWJzKHRoaXMuY2FtZXJhRGlyZWN0aW9uLngpPjB8fE1hdGguYWJzKHRoaXMuY2FtZXJhRGlyZWN0aW9uLnkpPjB8fE1hdGguYWJzKHRoaXMuY2FtZXJhRGlyZWN0aW9uLnopPjB9X3VwZGF0ZVBvc2l0aW9uKCl7aWYodGhpcy5wYXJlbnQpe3RoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCkuaW52ZXJ0VG9SZWYoRC5NYXRyaXhbMF0pLHAuVHJhbnNmb3JtTm9ybWFsVG9SZWYodGhpcy5jYW1lcmFEaXJlY3Rpb24sRC5NYXRyaXhbMF0sRC5WZWN0b3IzWzBdKSx0aGlzLnBvc2l0aW9uLmFkZEluUGxhY2UoRC5WZWN0b3IzWzBdKTtyZXR1cm59dGhpcy5wb3NpdGlvbi5hZGRJblBsYWNlKHRoaXMuY2FtZXJhRGlyZWN0aW9uKX1fY2hlY2tJbnB1dHMoKXtjb25zdCBlPXRoaXMuaW52ZXJ0Um90YXRpb24/LXRoaXMuaW52ZXJzZVJvdGF0aW9uU3BlZWQ6MSx0PXRoaXMuX2RlY2lkZUlmTmVlZHNUb01vdmUoKSxpPU1hdGguYWJzKHRoaXMuY2FtZXJhUm90YXRpb24ueCk+MHx8TWF0aC5hYnModGhpcy5jYW1lcmFSb3RhdGlvbi55KT4wO3QmJnRoaXMuX3VwZGF0ZVBvc2l0aW9uKCksaSYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uJiZ0aGlzLnJvdGF0aW9uUXVhdGVybmlvbi50b0V1bGVyQW5nbGVzVG9SZWYodGhpcy5yb3RhdGlvbiksdGhpcy5yb3RhdGlvbi54Kz10aGlzLmNhbWVyYVJvdGF0aW9uLngqZSx0aGlzLnJvdGF0aW9uLnkrPXRoaXMuY2FtZXJhUm90YXRpb24ueSplLHRoaXMubm9Sb3RhdGlvbkNvbnN0cmFpbnR8fCh0aGlzLnJvdGF0aW9uLng+MS41NzA3OTYmJih0aGlzLnJvdGF0aW9uLng9MS41NzA3OTYpLHRoaXMucm90YXRpb24ueDwtMS41NzA3OTYmJih0aGlzLnJvdGF0aW9uLng9LTEuNTcwNzk2KSksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24mJnRoaXMucm90YXRpb24ubGVuZ3RoU3F1YXJlZCgpJiZaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodGhpcy5yb3RhdGlvbi55LHRoaXMucm90YXRpb24ueCx0aGlzLnJvdGF0aW9uLnosdGhpcy5yb3RhdGlvblF1YXRlcm5pb24pKSx0JiYoTWF0aC5hYnModGhpcy5jYW1lcmFEaXJlY3Rpb24ueCk8dGhpcy5zcGVlZCp4ZSYmKHRoaXMuY2FtZXJhRGlyZWN0aW9uLng9MCksTWF0aC5hYnModGhpcy5jYW1lcmFEaXJlY3Rpb24ueSk8dGhpcy5zcGVlZCp4ZSYmKHRoaXMuY2FtZXJhRGlyZWN0aW9uLnk9MCksTWF0aC5hYnModGhpcy5jYW1lcmFEaXJlY3Rpb24ueik8dGhpcy5zcGVlZCp4ZSYmKHRoaXMuY2FtZXJhRGlyZWN0aW9uLno9MCksdGhpcy5jYW1lcmFEaXJlY3Rpb24uc2NhbGVJblBsYWNlKHRoaXMuaW5lcnRpYSkpLGkmJihNYXRoLmFicyh0aGlzLmNhbWVyYVJvdGF0aW9uLngpPHRoaXMuc3BlZWQqeGUmJih0aGlzLmNhbWVyYVJvdGF0aW9uLng9MCksTWF0aC5hYnModGhpcy5jYW1lcmFSb3RhdGlvbi55KTx0aGlzLnNwZWVkKnhlJiYodGhpcy5jYW1lcmFSb3RhdGlvbi55PTApLHRoaXMuY2FtZXJhUm90YXRpb24uc2NhbGVJblBsYWNlKHRoaXMuaW5lcnRpYSkpLHN1cGVyLl9jaGVja0lucHV0cygpfV91cGRhdGVDYW1lcmFSb3RhdGlvbk1hdHJpeCgpe3RoaXMucm90YXRpb25RdWF0ZXJuaW9uP3RoaXMucm90YXRpb25RdWF0ZXJuaW9uLnRvUm90YXRpb25NYXRyaXgodGhpcy5fY2FtZXJhUm90YXRpb25NYXRyaXgpOnguUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZih0aGlzLnJvdGF0aW9uLnksdGhpcy5yb3RhdGlvbi54LHRoaXMucm90YXRpb24ueix0aGlzLl9jYW1lcmFSb3RhdGlvbk1hdHJpeCl9X3JvdGF0ZVVwVmVjdG9yV2l0aENhbWVyYVJvdGF0aW9uTWF0cml4KCl7cmV0dXJuIHAuVHJhbnNmb3JtTm9ybWFsVG9SZWYodGhpcy5fZGVmYXVsdFVwLHRoaXMuX2NhbWVyYVJvdGF0aW9uTWF0cml4LHRoaXMudXBWZWN0b3IpLHRoaXN9X2dldFZpZXdNYXRyaXgoKXtyZXR1cm4gdGhpcy5sb2NrZWRUYXJnZXQmJnRoaXMuc2V0VGFyZ2V0KHRoaXMuX2dldExvY2tlZFRhcmdldFBvc2l0aW9uKCkpLHRoaXMuX3VwZGF0ZUNhbWVyYVJvdGF0aW9uTWF0cml4KCksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24mJnRoaXMuX2NhY2hlZFF1YXRlcm5pb25Sb3RhdGlvblohPXRoaXMucm90YXRpb25RdWF0ZXJuaW9uLno/KHRoaXMuX3JvdGF0ZVVwVmVjdG9yV2l0aENhbWVyYVJvdGF0aW9uTWF0cml4KCksdGhpcy5fY2FjaGVkUXVhdGVybmlvblJvdGF0aW9uWj10aGlzLnJvdGF0aW9uUXVhdGVybmlvbi56KTp0aGlzLl9jYWNoZWRSb3RhdGlvblohPT10aGlzLnJvdGF0aW9uLnomJih0aGlzLl9yb3RhdGVVcFZlY3RvcldpdGhDYW1lcmFSb3RhdGlvbk1hdHJpeCgpLHRoaXMuX2NhY2hlZFJvdGF0aW9uWj10aGlzLnJvdGF0aW9uLnopLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZih0aGlzLl9yZWZlcmVuY2VQb2ludCx0aGlzLl9jYW1lcmFSb3RhdGlvbk1hdHJpeCx0aGlzLl90cmFuc2Zvcm1lZFJlZmVyZW5jZVBvaW50KSx0aGlzLnBvc2l0aW9uLmFkZFRvUmVmKHRoaXMuX3RyYW5zZm9ybWVkUmVmZXJlbmNlUG9pbnQsdGhpcy5fY3VycmVudFRhcmdldCksdGhpcy51cGRhdGVVcFZlY3RvckZyb21Sb3RhdGlvbiYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uP19pLlkucm90YXRlQnlRdWF0ZXJuaW9uVG9SZWYodGhpcy5yb3RhdGlvblF1YXRlcm5pb24sdGhpcy51cFZlY3Rvcik6KFouRnJvbUV1bGVyVmVjdG9yVG9SZWYodGhpcy5yb3RhdGlvbix0aGlzLl90bXBRdWF0ZXJuaW9uKSxfaS5ZLnJvdGF0ZUJ5UXVhdGVybmlvblRvUmVmKHRoaXMuX3RtcFF1YXRlcm5pb24sdGhpcy51cFZlY3RvcikpKSx0aGlzLl9jb21wdXRlVmlld01hdHJpeCh0aGlzLnBvc2l0aW9uLHRoaXMuX2N1cnJlbnRUYXJnZXQsdGhpcy51cFZlY3RvciksdGhpcy5fdmlld01hdHJpeH1fY29tcHV0ZVZpZXdNYXRyaXgoZSx0LGkpe2lmKHRoaXMuaWdub3JlUGFyZW50U2NhbGluZyl7aWYodGhpcy5wYXJlbnQpe2NvbnN0IHM9dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKTtwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYoZSxzLHRoaXMuX2dsb2JhbFBvc2l0aW9uKSxwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodCxzLHRoaXMuX3RtcFRhcmdldFZlY3RvcikscC5UcmFuc2Zvcm1Ob3JtYWxUb1JlZihpLHMsdGhpcy5fdG1wVXBWZWN0b3IpLHRoaXMuX21hcmtTeW5jZWRXaXRoUGFyZW50KCl9ZWxzZSB0aGlzLl9nbG9iYWxQb3NpdGlvbi5jb3B5RnJvbShlKSx0aGlzLl90bXBUYXJnZXRWZWN0b3IuY29weUZyb20odCksdGhpcy5fdG1wVXBWZWN0b3IuY29weUZyb20oaSk7dGhpcy5nZXRTY2VuZSgpLnVzZVJpZ2h0SGFuZGVkU3lzdGVtP3guTG9va0F0UkhUb1JlZih0aGlzLl9nbG9iYWxQb3NpdGlvbix0aGlzLl90bXBUYXJnZXRWZWN0b3IsdGhpcy5fdG1wVXBWZWN0b3IsdGhpcy5fdmlld01hdHJpeCk6eC5Mb29rQXRMSFRvUmVmKHRoaXMuX2dsb2JhbFBvc2l0aW9uLHRoaXMuX3RtcFRhcmdldFZlY3Rvcix0aGlzLl90bXBVcFZlY3Rvcix0aGlzLl92aWV3TWF0cml4KTtyZXR1cm59aWYodGhpcy5nZXRTY2VuZSgpLnVzZVJpZ2h0SGFuZGVkU3lzdGVtP3guTG9va0F0UkhUb1JlZihlLHQsaSx0aGlzLl92aWV3TWF0cml4KTp4Lkxvb2tBdExIVG9SZWYoZSx0LGksdGhpcy5fdmlld01hdHJpeCksdGhpcy5wYXJlbnQpe2NvbnN0IHM9dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKTt0aGlzLl92aWV3TWF0cml4LmludmVydCgpLHRoaXMuX3ZpZXdNYXRyaXgubXVsdGlwbHlUb1JlZihzLHRoaXMuX3ZpZXdNYXRyaXgpLHRoaXMuX3ZpZXdNYXRyaXguZ2V0VHJhbnNsYXRpb25Ub1JlZih0aGlzLl9nbG9iYWxQb3NpdGlvbiksdGhpcy5fdmlld01hdHJpeC5pbnZlcnQoKSx0aGlzLl9tYXJrU3luY2VkV2l0aFBhcmVudCgpfWVsc2UgdGhpcy5fZ2xvYmFsUG9zaXRpb24uY29weUZyb20oZSl9Y3JlYXRlUmlnQ2FtZXJhKGUsdCl7aWYodGhpcy5jYW1lcmFSaWdNb2RlIT09ai5SSUdfTU9ERV9OT05FKXtjb25zdCBpPW5ldyBHZShlLHRoaXMucG9zaXRpb24uY2xvbmUoKSx0aGlzLmdldFNjZW5lKCkpO3JldHVybiBpLmlzUmlnQ2FtZXJhPSEwLGkucmlnUGFyZW50PXRoaXMsKHRoaXMuY2FtZXJhUmlnTW9kZT09PWouUklHX01PREVfVlJ8fHRoaXMuY2FtZXJhUmlnTW9kZT09PWouUklHX01PREVfV0VCVlIpJiYodGhpcy5yb3RhdGlvblF1YXRlcm5pb258fCh0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj1uZXcgWiksaS5fY2FtZXJhUmlnUGFyYW1zPXt9LGkucm90YXRpb25RdWF0ZXJuaW9uPW5ldyBaKSxpLm1vZGU9dGhpcy5tb2RlLGkub3J0aG9MZWZ0PXRoaXMub3J0aG9MZWZ0LGkub3J0aG9SaWdodD10aGlzLm9ydGhvUmlnaHQsaS5vcnRob1RvcD10aGlzLm9ydGhvVG9wLGkub3J0aG9Cb3R0b209dGhpcy5vcnRob0JvdHRvbSxpfXJldHVybiBudWxsfV91cGRhdGVSaWdDYW1lcmFzKCl7Y29uc3QgZT10aGlzLl9yaWdDYW1lcmFzWzBdLHQ9dGhpcy5fcmlnQ2FtZXJhc1sxXTtzd2l0Y2godGhpcy5jb21wdXRlV29ybGRNYXRyaXgoKSx0aGlzLmNhbWVyYVJpZ01vZGUpe2Nhc2Ugai5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfQU5BR0xZUEg6Y2FzZSBqLlJJR19NT0RFX1NURVJFT1NDT1BJQ19TSURFQllTSURFX1BBUkFMTEVMOmNhc2Ugai5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9DUk9TU0VZRUQ6Y2FzZSBqLlJJR19NT0RFX1NURVJFT1NDT1BJQ19PVkVSVU5ERVI6Y2FzZSBqLlJJR19NT0RFX1NURVJFT1NDT1BJQ19JTlRFUkxBQ0VEOntjb25zdCBpPXRoaXMuY2FtZXJhUmlnTW9kZT09PWouUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfQ1JPU1NFWUVEPzE6LTEscz10aGlzLmNhbWVyYVJpZ01vZGU9PT1qLlJJR19NT0RFX1NURVJFT1NDT1BJQ19TSURFQllTSURFX0NST1NTRVlFRD8tMToxO3RoaXMuX2dldFJpZ0NhbVBvc2l0aW9uQW5kVGFyZ2V0KHRoaXMuX2NhbWVyYVJpZ1BhcmFtcy5zdGVyZW9IYWxmQW5nbGUqaSxlKSx0aGlzLl9nZXRSaWdDYW1Qb3NpdGlvbkFuZFRhcmdldCh0aGlzLl9jYW1lcmFSaWdQYXJhbXMuc3RlcmVvSGFsZkFuZ2xlKnMsdCk7YnJlYWt9Y2FzZSBqLlJJR19NT0RFX1ZSOmUucm90YXRpb25RdWF0ZXJuaW9uPyhlLnJvdGF0aW9uUXVhdGVybmlvbi5jb3B5RnJvbSh0aGlzLnJvdGF0aW9uUXVhdGVybmlvbiksdC5yb3RhdGlvblF1YXRlcm5pb24uY29weUZyb20odGhpcy5yb3RhdGlvblF1YXRlcm5pb24pKTooZS5yb3RhdGlvbi5jb3B5RnJvbSh0aGlzLnJvdGF0aW9uKSx0LnJvdGF0aW9uLmNvcHlGcm9tKHRoaXMucm90YXRpb24pKSxlLnBvc2l0aW9uLmNvcHlGcm9tKHRoaXMucG9zaXRpb24pLHQucG9zaXRpb24uY29weUZyb20odGhpcy5wb3NpdGlvbik7YnJlYWt9c3VwZXIuX3VwZGF0ZVJpZ0NhbWVyYXMoKX1fZ2V0UmlnQ2FtUG9zaXRpb25BbmRUYXJnZXQoZSx0KXt0aGlzLmdldFRhcmdldCgpLnN1YnRyYWN0VG9SZWYodGhpcy5wb3NpdGlvbixHZS5fVGFyZ2V0Rm9jYWxQb2ludCksR2UuX1RhcmdldEZvY2FsUG9pbnQubm9ybWFsaXplKCkuc2NhbGVJblBsYWNlKHRoaXMuX2luaXRpYWxGb2NhbERpc3RhbmNlKTtjb25zdCBzPUdlLl9UYXJnZXRGb2NhbFBvaW50LmFkZEluUGxhY2UodGhpcy5wb3NpdGlvbik7eC5UcmFuc2xhdGlvblRvUmVmKC1zLngsLXMueSwtcy56LEdlLl9UYXJnZXRUcmFuc2Zvcm1NYXRyaXgpLEdlLl9UYXJnZXRUcmFuc2Zvcm1NYXRyaXgubXVsdGlwbHlUb1JlZih4LlJvdGF0aW9uQXhpcyh0LnVwVmVjdG9yLGUpLEdlLl9SaWdDYW1UcmFuc2Zvcm1NYXRyaXgpLHguVHJhbnNsYXRpb25Ub1JlZihzLngscy55LHMueixHZS5fVGFyZ2V0VHJhbnNmb3JtTWF0cml4KSxHZS5fUmlnQ2FtVHJhbnNmb3JtTWF0cml4Lm11bHRpcGx5VG9SZWYoR2UuX1RhcmdldFRyYW5zZm9ybU1hdHJpeCxHZS5fUmlnQ2FtVHJhbnNmb3JtTWF0cml4KSxwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodGhpcy5wb3NpdGlvbixHZS5fUmlnQ2FtVHJhbnNmb3JtTWF0cml4LHQucG9zaXRpb24pLHQuc2V0VGFyZ2V0KHMpfWdldENsYXNzTmFtZSgpe3JldHVybiJUYXJnZXRDYW1lcmEifX1HZS5fUmlnQ2FtVHJhbnNmb3JtTWF0cml4PW5ldyB4LEdlLl9UYXJnZXRUcmFuc2Zvcm1NYXRyaXg9bmV3IHgsR2UuX1RhcmdldEZvY2FsUG9pbnQ9bmV3IHAsVChbQnQoKV0sR2UucHJvdG90eXBlLCJyb3RhdGlvbiIsdm9pZCAwKSxUKFtSKCldLEdlLnByb3RvdHlwZSwic3BlZWQiLHZvaWQgMCksVChbTW4oImxvY2tlZFRhcmdldElkIildLEdlLnByb3RvdHlwZSwibG9ja2VkVGFyZ2V0Iix2b2lkIDApO2Z1bmN0aW9uIFluKGMpe2NvbnN0e3NjZW5lOmV9PWM7bGV0IHQ7Y29uc3QgaT0zNi41O3JldHVybiB0PW5ldyBHZSgiVGFyZ2V0Q2FtZXJhMSIsbmV3IHAoMCxpLDApLGUpLHQuZm92PS4yNSx0Lm1pblo9NSx0Lm1heFo9aSsxLHQuc2V0VGFyZ2V0KHAuWmVybygpKSx0fWNsYXNzIGhlIGV4dGVuZHMgemV7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLHQpLHRoaXMuZGlmZnVzZT1uZXcgcmUoMSwxLDEpLHRoaXMuc3BlY3VsYXI9bmV3IHJlKDEsMSwxKSx0aGlzLmZhbGxvZmZUeXBlPWhlLkZBTExPRkZfREVGQVVMVCx0aGlzLmludGVuc2l0eT0xLHRoaXMuX3JhbmdlPU51bWJlci5NQVhfVkFMVUUsdGhpcy5faW52ZXJzZVNxdWFyZWRSYW5nZT0wLHRoaXMuX3Bob3RvbWV0cmljU2NhbGU9MSx0aGlzLl9pbnRlbnNpdHlNb2RlPWhlLklOVEVOU0lUWU1PREVfQVVUT01BVElDLHRoaXMuX3JhZGl1cz0xZS01LHRoaXMucmVuZGVyUHJpb3JpdHk9MCx0aGlzLl9zaGFkb3dFbmFibGVkPSEwLHRoaXMuX2V4Y2x1ZGVXaXRoTGF5ZXJNYXNrPTAsdGhpcy5faW5jbHVkZU9ubHlXaXRoTGF5ZXJNYXNrPTAsdGhpcy5fbGlnaHRtYXBNb2RlPTAsdGhpcy5fc2hhZG93R2VuZXJhdG9ycz1udWxsLHRoaXMuX2V4Y2x1ZGVkTWVzaGVzSWRzPW5ldyBBcnJheSx0aGlzLl9pbmNsdWRlZE9ubHlNZXNoZXNJZHM9bmV3IEFycmF5LHRoaXMuX2lzTGlnaHQ9ITAsdGhpcy5nZXRTY2VuZSgpLmFkZExpZ2h0KHRoaXMpLHRoaXMuX3VuaWZvcm1CdWZmZXI9bmV3IFYodGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLHZvaWQgMCx2b2lkIDAsZSksdGhpcy5fYnVpbGRVbmlmb3JtTGF5b3V0KCksdGhpcy5pbmNsdWRlZE9ubHlNZXNoZXM9bmV3IEFycmF5LHRoaXMuZXhjbHVkZWRNZXNoZXM9bmV3IEFycmF5LHRoaXMuX3Jlc3luY01lc2hlcygpfWdldCByYW5nZSgpe3JldHVybiB0aGlzLl9yYW5nZX1zZXQgcmFuZ2UoZSl7dGhpcy5fcmFuZ2U9ZSx0aGlzLl9pbnZlcnNlU3F1YXJlZFJhbmdlPTEvKHRoaXMucmFuZ2UqdGhpcy5yYW5nZSl9Z2V0IGludGVuc2l0eU1vZGUoKXtyZXR1cm4gdGhpcy5faW50ZW5zaXR5TW9kZX1zZXQgaW50ZW5zaXR5TW9kZShlKXt0aGlzLl9pbnRlbnNpdHlNb2RlPWUsdGhpcy5fY29tcHV0ZVBob3RvbWV0cmljU2NhbGUoKX1nZXQgcmFkaXVzKCl7cmV0dXJuIHRoaXMuX3JhZGl1c31zZXQgcmFkaXVzKGUpe3RoaXMuX3JhZGl1cz1lLHRoaXMuX2NvbXB1dGVQaG90b21ldHJpY1NjYWxlKCl9Z2V0IHNoYWRvd0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5fc2hhZG93RW5hYmxlZH1zZXQgc2hhZG93RW5hYmxlZChlKXt0aGlzLl9zaGFkb3dFbmFibGVkIT09ZSYmKHRoaXMuX3NoYWRvd0VuYWJsZWQ9ZSx0aGlzLl9tYXJrTWVzaGVzQXNMaWdodERpcnR5KCkpfWdldCBpbmNsdWRlZE9ubHlNZXNoZXMoKXtyZXR1cm4gdGhpcy5faW5jbHVkZWRPbmx5TWVzaGVzfXNldCBpbmNsdWRlZE9ubHlNZXNoZXMoZSl7dGhpcy5faW5jbHVkZWRPbmx5TWVzaGVzPWUsdGhpcy5faG9va0FycmF5Rm9ySW5jbHVkZWRPbmx5KGUpfWdldCBleGNsdWRlZE1lc2hlcygpe3JldHVybiB0aGlzLl9leGNsdWRlZE1lc2hlc31zZXQgZXhjbHVkZWRNZXNoZXMoZSl7dGhpcy5fZXhjbHVkZWRNZXNoZXM9ZSx0aGlzLl9ob29rQXJyYXlGb3JFeGNsdWRlZChlKX1nZXQgZXhjbHVkZVdpdGhMYXllck1hc2soKXtyZXR1cm4gdGhpcy5fZXhjbHVkZVdpdGhMYXllck1hc2t9c2V0IGV4Y2x1ZGVXaXRoTGF5ZXJNYXNrKGUpe3RoaXMuX2V4Y2x1ZGVXaXRoTGF5ZXJNYXNrPWUsdGhpcy5fcmVzeW5jTWVzaGVzKCl9Z2V0IGluY2x1ZGVPbmx5V2l0aExheWVyTWFzaygpe3JldHVybiB0aGlzLl9pbmNsdWRlT25seVdpdGhMYXllck1hc2t9c2V0IGluY2x1ZGVPbmx5V2l0aExheWVyTWFzayhlKXt0aGlzLl9pbmNsdWRlT25seVdpdGhMYXllck1hc2s9ZSx0aGlzLl9yZXN5bmNNZXNoZXMoKX1nZXQgbGlnaHRtYXBNb2RlKCl7cmV0dXJuIHRoaXMuX2xpZ2h0bWFwTW9kZX1zZXQgbGlnaHRtYXBNb2RlKGUpe3RoaXMuX2xpZ2h0bWFwTW9kZSE9PWUmJih0aGlzLl9saWdodG1hcE1vZGU9ZSx0aGlzLl9tYXJrTWVzaGVzQXNMaWdodERpcnR5KCkpfXRyYW5zZmVyVGV4dHVyZXNUb0VmZmVjdChlLHQpe3JldHVybiB0aGlzfV9iaW5kTGlnaHQoZSx0LGkscyxyPSEwKXt2YXIgbjtjb25zdCBhPWUudG9TdHJpbmcoKTtsZXQgbz0hMTtpZih0aGlzLl91bmlmb3JtQnVmZmVyLmJpbmRUb0VmZmVjdChpLCJMaWdodCIrYSksdGhpcy5fcmVuZGVySWQhPT10LmdldFJlbmRlcklkKCl8fHRoaXMuX2xhc3RVc2VTcGVjdWxhciE9PXN8fCF0aGlzLl91bmlmb3JtQnVmZmVyLnVzZVVibyl7dGhpcy5fcmVuZGVySWQ9dC5nZXRSZW5kZXJJZCgpLHRoaXMuX2xhc3RVc2VTcGVjdWxhcj1zO2NvbnN0IGg9dGhpcy5nZXRTY2FsZWRJbnRlbnNpdHkoKTt0aGlzLnRyYW5zZmVyVG9FZmZlY3QoaSxhKSx0aGlzLmRpZmZ1c2Uuc2NhbGVUb1JlZihoLEVpLkNvbG9yM1swXSksdGhpcy5fdW5pZm9ybUJ1ZmZlci51cGRhdGVDb2xvcjQoInZMaWdodERpZmZ1c2UiLEVpLkNvbG9yM1swXSx0aGlzLnJhbmdlLGEpLHMmJih0aGlzLnNwZWN1bGFyLnNjYWxlVG9SZWYoaCxFaS5Db2xvcjNbMV0pLHRoaXMuX3VuaWZvcm1CdWZmZXIudXBkYXRlQ29sb3I0KCJ2TGlnaHRTcGVjdWxhciIsRWkuQ29sb3IzWzFdLHRoaXMucmFkaXVzLGEpKSxvPSEwfWlmKHRoaXMudHJhbnNmZXJUZXh0dXJlc1RvRWZmZWN0KGksYSksdC5zaGFkb3dzRW5hYmxlZCYmdGhpcy5zaGFkb3dFbmFibGVkJiZyKXtjb25zdCBoPShuPXRoaXMuZ2V0U2hhZG93R2VuZXJhdG9yKHQuYWN0aXZlQ2FtZXJhKSkhPT1udWxsJiZuIT09dm9pZCAwP246dGhpcy5nZXRTaGFkb3dHZW5lcmF0b3IoKTtoJiYoaC5iaW5kU2hhZG93TGlnaHQoYSxpKSxvPSEwKX1vP3RoaXMuX3VuaWZvcm1CdWZmZXIudXBkYXRlKCk6dGhpcy5fdW5pZm9ybUJ1ZmZlci5iaW5kVW5pZm9ybUJ1ZmZlcigpfWdldENsYXNzTmFtZSgpe3JldHVybiJMaWdodCJ9dG9TdHJpbmcoZSl7bGV0IHQ9Ik5hbWU6ICIrdGhpcy5uYW1lO2lmKHQrPSIsIHR5cGU6ICIrWyJQb2ludCIsIkRpcmVjdGlvbmFsIiwiU3BvdCIsIkhlbWlzcGhlcmljIl1bdGhpcy5nZXRUeXBlSUQoKV0sdGhpcy5hbmltYXRpb25zKWZvcihsZXQgaT0wO2k8dGhpcy5hbmltYXRpb25zLmxlbmd0aDtpKyspdCs9IiwgYW5pbWF0aW9uWzBdOiAiK3RoaXMuYW5pbWF0aW9uc1tpXS50b1N0cmluZyhlKTtyZXR1cm4gdH1fc3luY1BhcmVudEVuYWJsZWRTdGF0ZSgpe3N1cGVyLl9zeW5jUGFyZW50RW5hYmxlZFN0YXRlKCksdGhpcy5pc0Rpc3Bvc2VkKCl8fHRoaXMuX3Jlc3luY01lc2hlcygpfXNldEVuYWJsZWQoZSl7c3VwZXIuc2V0RW5hYmxlZChlKSx0aGlzLl9yZXN5bmNNZXNoZXMoKX1nZXRTaGFkb3dHZW5lcmF0b3IoZT1udWxsKXt2YXIgdDtyZXR1cm4gdGhpcy5fc2hhZG93R2VuZXJhdG9ycz09PW51bGw/bnVsbDoodD10aGlzLl9zaGFkb3dHZW5lcmF0b3JzLmdldChlKSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6bnVsbH1nZXRTaGFkb3dHZW5lcmF0b3JzKCl7cmV0dXJuIHRoaXMuX3NoYWRvd0dlbmVyYXRvcnN9Z2V0QWJzb2x1dGVQb3NpdGlvbigpe3JldHVybiBwLlplcm8oKX1jYW5BZmZlY3RNZXNoKGUpe3JldHVybiBlPyEodGhpcy5pbmNsdWRlZE9ubHlNZXNoZXMmJnRoaXMuaW5jbHVkZWRPbmx5TWVzaGVzLmxlbmd0aD4wJiZ0aGlzLmluY2x1ZGVkT25seU1lc2hlcy5pbmRleE9mKGUpPT09LTF8fHRoaXMuZXhjbHVkZWRNZXNoZXMmJnRoaXMuZXhjbHVkZWRNZXNoZXMubGVuZ3RoPjAmJnRoaXMuZXhjbHVkZWRNZXNoZXMuaW5kZXhPZihlKSE9PS0xfHx0aGlzLmluY2x1ZGVPbmx5V2l0aExheWVyTWFzayE9PTAmJiEodGhpcy5pbmNsdWRlT25seVdpdGhMYXllck1hc2smZS5sYXllck1hc2spfHx0aGlzLmV4Y2x1ZGVXaXRoTGF5ZXJNYXNrIT09MCYmdGhpcy5leGNsdWRlV2l0aExheWVyTWFzayZlLmxheWVyTWFzayk6ITB9ZGlzcG9zZShlLHQ9ITEpe2lmKHRoaXMuX3NoYWRvd0dlbmVyYXRvcnMpe2NvbnN0IGk9dGhpcy5fc2hhZG93R2VuZXJhdG9ycy52YWx1ZXMoKTtmb3IobGV0IHM9aS5uZXh0KCk7cy5kb25lIT09ITA7cz1pLm5leHQoKSlzLnZhbHVlLmRpc3Bvc2UoKTt0aGlzLl9zaGFkb3dHZW5lcmF0b3JzPW51bGx9aWYodGhpcy5nZXRTY2VuZSgpLnN0b3BBbmltYXRpb24odGhpcyksdGhpcy5fcGFyZW50Q29udGFpbmVyKXtjb25zdCBpPXRoaXMuX3BhcmVudENvbnRhaW5lci5saWdodHMuaW5kZXhPZih0aGlzKTtpPi0xJiZ0aGlzLl9wYXJlbnRDb250YWluZXIubGlnaHRzLnNwbGljZShpLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfWZvcihjb25zdCBpIG9mIHRoaXMuZ2V0U2NlbmUoKS5tZXNoZXMpaS5fcmVtb3ZlTGlnaHRTb3VyY2UodGhpcywhMCk7dGhpcy5fdW5pZm9ybUJ1ZmZlci5kaXNwb3NlKCksdGhpcy5nZXRTY2VuZSgpLnJlbW92ZUxpZ2h0KHRoaXMpLHN1cGVyLmRpc3Bvc2UoZSx0KX1nZXRUeXBlSUQoKXtyZXR1cm4gMH1nZXRTY2FsZWRJbnRlbnNpdHkoKXtyZXR1cm4gdGhpcy5fcGhvdG9tZXRyaWNTY2FsZSp0aGlzLmludGVuc2l0eX1jbG9uZShlLHQ9bnVsbCl7Y29uc3QgaT1oZS5HZXRDb25zdHJ1Y3RvckZyb21OYW1lKHRoaXMuZ2V0VHlwZUlEKCksZSx0aGlzLmdldFNjZW5lKCkpO2lmKCFpKXJldHVybiBudWxsO2NvbnN0IHM9YWUuQ2xvbmUoaSx0aGlzKTtyZXR1cm4gZSYmKHMubmFtZT1lKSx0JiYocy5wYXJlbnQ9dCkscy5zZXRFbmFibGVkKHRoaXMuaXNFbmFibGVkKCkpLHRoaXMub25DbG9uZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhzKSxzfXNlcmlhbGl6ZSgpe2NvbnN0IGU9YWUuU2VyaWFsaXplKHRoaXMpO3JldHVybiBlLnVuaXF1ZUlkPXRoaXMudW5pcXVlSWQsZS50eXBlPXRoaXMuZ2V0VHlwZUlEKCksdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50Ll9zZXJpYWxpemVBc1BhcmVudChlKSx0aGlzLmV4Y2x1ZGVkTWVzaGVzLmxlbmd0aD4wJiYoZS5leGNsdWRlZE1lc2hlc0lkcz1bXSx0aGlzLmV4Y2x1ZGVkTWVzaGVzLmZvckVhY2godD0+e2UuZXhjbHVkZWRNZXNoZXNJZHMucHVzaCh0LmlkKX0pKSx0aGlzLmluY2x1ZGVkT25seU1lc2hlcy5sZW5ndGg+MCYmKGUuaW5jbHVkZWRPbmx5TWVzaGVzSWRzPVtdLHRoaXMuaW5jbHVkZWRPbmx5TWVzaGVzLmZvckVhY2godD0+e2UuaW5jbHVkZWRPbmx5TWVzaGVzSWRzLnB1c2godC5pZCl9KSksYWUuQXBwZW5kU2VyaWFsaXplZEFuaW1hdGlvbnModGhpcyxlKSxlLnJhbmdlcz10aGlzLnNlcmlhbGl6ZUFuaW1hdGlvblJhbmdlcygpLGUuaXNFbmFibGVkPXRoaXMuaXNFbmFibGVkKCksZX1zdGF0aWMgR2V0Q29uc3RydWN0b3JGcm9tTmFtZShlLHQsaSl7Y29uc3Qgcz16ZS5Db25zdHJ1Y3QoIkxpZ2h0X1R5cGVfIitlLHQsaSk7cmV0dXJuIHN8fG51bGx9c3RhdGljIFBhcnNlKGUsdCl7Y29uc3QgaT1oZS5HZXRDb25zdHJ1Y3RvckZyb21OYW1lKGUudHlwZSxlLm5hbWUsdCk7aWYoIWkpcmV0dXJuIG51bGw7Y29uc3Qgcz1hZS5QYXJzZShpLGUsdCk7aWYoZS5leGNsdWRlZE1lc2hlc0lkcyYmKHMuX2V4Y2x1ZGVkTWVzaGVzSWRzPWUuZXhjbHVkZWRNZXNoZXNJZHMpLGUuaW5jbHVkZWRPbmx5TWVzaGVzSWRzJiYocy5faW5jbHVkZWRPbmx5TWVzaGVzSWRzPWUuaW5jbHVkZWRPbmx5TWVzaGVzSWRzKSxlLnBhcmVudElkIT09dm9pZCAwJiYocy5fd2FpdGluZ1BhcmVudElkPWUucGFyZW50SWQpLGUucGFyZW50SW5zdGFuY2VJbmRleCE9PXZvaWQgMCYmKHMuX3dhaXRpbmdQYXJlbnRJbnN0YW5jZUluZGV4PWUucGFyZW50SW5zdGFuY2VJbmRleCksZS5mYWxsb2ZmVHlwZSE9PXZvaWQgMCYmKHMuZmFsbG9mZlR5cGU9ZS5mYWxsb2ZmVHlwZSksZS5saWdodG1hcE1vZGUhPT12b2lkIDAmJihzLmxpZ2h0bWFwTW9kZT1lLmxpZ2h0bWFwTW9kZSksZS5hbmltYXRpb25zKXtmb3IobGV0IHI9MDtyPGUuYW5pbWF0aW9ucy5sZW5ndGg7cisrKXtjb25zdCBuPWUuYW5pbWF0aW9uc1tyXSxhPXJpKCJCQUJZTE9OLkFuaW1hdGlvbiIpO2EmJnMuYW5pbWF0aW9ucy5wdXNoKGEuUGFyc2UobikpfXplLlBhcnNlQW5pbWF0aW9uUmFuZ2VzKHMsZSx0KX1yZXR1cm4gZS5hdXRvQW5pbWF0ZSYmdC5iZWdpbkFuaW1hdGlvbihzLGUuYXV0b0FuaW1hdGVGcm9tLGUuYXV0b0FuaW1hdGVUbyxlLmF1dG9BbmltYXRlTG9vcCxlLmF1dG9BbmltYXRlU3BlZWR8fDEpLGUuaXNFbmFibGVkIT09dm9pZCAwJiZzLnNldEVuYWJsZWQoZS5pc0VuYWJsZWQpLHN9X2hvb2tBcnJheUZvckV4Y2x1ZGVkKGUpe2NvbnN0IHQ9ZS5wdXNoO2UucHVzaD0oLi4ucyk9Pntjb25zdCByPXQuYXBwbHkoZSxzKTtmb3IoY29uc3QgbiBvZiBzKW4uX3Jlc3luY0xpZ2h0U291cmNlKHRoaXMpO3JldHVybiByfTtjb25zdCBpPWUuc3BsaWNlO2Uuc3BsaWNlPShzLHIpPT57Y29uc3Qgbj1pLmFwcGx5KGUsW3Mscl0pO2Zvcihjb25zdCBhIG9mIG4pYS5fcmVzeW5jTGlnaHRTb3VyY2UodGhpcyk7cmV0dXJuIG59O2Zvcihjb25zdCBzIG9mIGUpcy5fcmVzeW5jTGlnaHRTb3VyY2UodGhpcyl9X2hvb2tBcnJheUZvckluY2x1ZGVkT25seShlKXtjb25zdCB0PWUucHVzaDtlLnB1c2g9KC4uLnMpPT57Y29uc3Qgcj10LmFwcGx5KGUscyk7cmV0dXJuIHRoaXMuX3Jlc3luY01lc2hlcygpLHJ9O2NvbnN0IGk9ZS5zcGxpY2U7ZS5zcGxpY2U9KHMscik9Pntjb25zdCBuPWkuYXBwbHkoZSxbcyxyXSk7cmV0dXJuIHRoaXMuX3Jlc3luY01lc2hlcygpLG59LHRoaXMuX3Jlc3luY01lc2hlcygpfV9yZXN5bmNNZXNoZXMoKXtmb3IoY29uc3QgZSBvZiB0aGlzLmdldFNjZW5lKCkubWVzaGVzKWUuX3Jlc3luY0xpZ2h0U291cmNlKHRoaXMpfV9tYXJrTWVzaGVzQXNMaWdodERpcnR5KCl7Zm9yKGNvbnN0IGUgb2YgdGhpcy5nZXRTY2VuZSgpLm1lc2hlcyllLmxpZ2h0U291cmNlcy5pbmRleE9mKHRoaXMpIT09LTEmJmUuX21hcmtTdWJNZXNoZXNBc0xpZ2h0RGlydHkoKX1fY29tcHV0ZVBob3RvbWV0cmljU2NhbGUoKXt0aGlzLl9waG90b21ldHJpY1NjYWxlPXRoaXMuX2dldFBob3RvbWV0cmljU2NhbGUoKSx0aGlzLmdldFNjZW5lKCkucmVzZXRDYWNoZWRNYXRlcmlhbCgpfV9nZXRQaG90b21ldHJpY1NjYWxlKCl7bGV0IGU9MDtjb25zdCB0PXRoaXMuZ2V0VHlwZUlEKCk7bGV0IGk9dGhpcy5pbnRlbnNpdHlNb2RlO3N3aXRjaChpPT09aGUuSU5URU5TSVRZTU9ERV9BVVRPTUFUSUMmJih0PT09aGUuTElHSFRUWVBFSURfRElSRUNUSU9OQUxMSUdIVD9pPWhlLklOVEVOU0lUWU1PREVfSUxMVU1JTkFOQ0U6aT1oZS5JTlRFTlNJVFlNT0RFX0xVTUlOT1VTSU5URU5TSVRZKSx0KXtjYXNlIGhlLkxJR0hUVFlQRUlEX1BPSU5UTElHSFQ6Y2FzZSBoZS5MSUdIVFRZUEVJRF9TUE9UTElHSFQ6c3dpdGNoKGkpe2Nhc2UgaGUuSU5URU5TSVRZTU9ERV9MVU1JTk9VU1BPV0VSOmU9MS8oNCpNYXRoLlBJKTticmVhaztjYXNlIGhlLklOVEVOU0lUWU1PREVfTFVNSU5PVVNJTlRFTlNJVFk6ZT0xO2JyZWFrO2Nhc2UgaGUuSU5URU5TSVRZTU9ERV9MVU1JTkFOQ0U6ZT10aGlzLnJhZGl1cyp0aGlzLnJhZGl1czticmVha31icmVhaztjYXNlIGhlLkxJR0hUVFlQRUlEX0RJUkVDVElPTkFMTElHSFQ6c3dpdGNoKGkpe2Nhc2UgaGUuSU5URU5TSVRZTU9ERV9JTExVTUlOQU5DRTplPTE7YnJlYWs7Y2FzZSBoZS5JTlRFTlNJVFlNT0RFX0xVTUlOQU5DRTp7bGV0IHM9dGhpcy5yYWRpdXM7cz1NYXRoLm1heChzLC4wMDEpLGU9MipNYXRoLlBJKigxLU1hdGguY29zKHMpKTticmVha319YnJlYWs7Y2FzZSBoZS5MSUdIVFRZUEVJRF9IRU1JU1BIRVJJQ0xJR0hUOmU9MTticmVha31yZXR1cm4gZX1fcmVvcmRlckxpZ2h0c0luU2NlbmUoKXtjb25zdCBlPXRoaXMuZ2V0U2NlbmUoKTt0aGlzLl9yZW5kZXJQcmlvcml0eSE9MCYmKGUucmVxdWlyZUxpZ2h0U29ydGluZz0hMCksdGhpcy5nZXRTY2VuZSgpLnNvcnRMaWdodHNCeVByaW9yaXR5KCl9fWhlLkZBTExPRkZfREVGQVVMVD1FZS5GQUxMT0ZGX0RFRkFVTFQsaGUuRkFMTE9GRl9QSFlTSUNBTD1FZS5GQUxMT0ZGX1BIWVNJQ0FMLGhlLkZBTExPRkZfR0xURj1FZS5GQUxMT0ZGX0dMVEYsaGUuRkFMTE9GRl9TVEFOREFSRD1FZS5GQUxMT0ZGX1NUQU5EQVJELGhlLkxJR0hUTUFQX0RFRkFVTFQ9RWUuTElHSFRNQVBfREVGQVVMVCxoZS5MSUdIVE1BUF9TUEVDVUxBUj1FZS5MSUdIVE1BUF9TUEVDVUxBUixoZS5MSUdIVE1BUF9TSEFET1dTT05MWT1FZS5MSUdIVE1BUF9TSEFET1dTT05MWSxoZS5JTlRFTlNJVFlNT0RFX0FVVE9NQVRJQz1FZS5JTlRFTlNJVFlNT0RFX0FVVE9NQVRJQyxoZS5JTlRFTlNJVFlNT0RFX0xVTUlOT1VTUE9XRVI9RWUuSU5URU5TSVRZTU9ERV9MVU1JTk9VU1BPV0VSLGhlLklOVEVOU0lUWU1PREVfTFVNSU5PVVNJTlRFTlNJVFk9RWUuSU5URU5TSVRZTU9ERV9MVU1JTk9VU0lOVEVOU0lUWSxoZS5JTlRFTlNJVFlNT0RFX0lMTFVNSU5BTkNFPUVlLklOVEVOU0lUWU1PREVfSUxMVU1JTkFOQ0UsaGUuSU5URU5TSVRZTU9ERV9MVU1JTkFOQ0U9RWUuSU5URU5TSVRZTU9ERV9MVU1JTkFOQ0UsaGUuTElHSFRUWVBFSURfUE9JTlRMSUdIVD1FZS5MSUdIVFRZUEVJRF9QT0lOVExJR0hULGhlLkxJR0hUVFlQRUlEX0RJUkVDVElPTkFMTElHSFQ9RWUuTElHSFRUWVBFSURfRElSRUNUSU9OQUxMSUdIVCxoZS5MSUdIVFRZUEVJRF9TUE9UTElHSFQ9RWUuTElHSFRUWVBFSURfU1BPVExJR0hULGhlLkxJR0hUVFlQRUlEX0hFTUlTUEhFUklDTElHSFQ9RWUuTElHSFRUWVBFSURfSEVNSVNQSEVSSUNMSUdIVCxUKFtjaSgpXSxoZS5wcm90b3R5cGUsImRpZmZ1c2UiLHZvaWQgMCksVChbY2koKV0saGUucHJvdG90eXBlLCJzcGVjdWxhciIsdm9pZCAwKSxUKFtSKCldLGhlLnByb3RvdHlwZSwiZmFsbG9mZlR5cGUiLHZvaWQgMCksVChbUigpXSxoZS5wcm90b3R5cGUsImludGVuc2l0eSIsdm9pZCAwKSxUKFtSKCldLGhlLnByb3RvdHlwZSwicmFuZ2UiLG51bGwpLFQoW1IoKV0saGUucHJvdG90eXBlLCJpbnRlbnNpdHlNb2RlIixudWxsKSxUKFtSKCldLGhlLnByb3RvdHlwZSwicmFkaXVzIixudWxsKSxUKFtSKCldLGhlLnByb3RvdHlwZSwiX3JlbmRlclByaW9yaXR5Iix2b2lkIDApLFQoW2JlKCJfcmVvcmRlckxpZ2h0c0luU2NlbmUiKV0saGUucHJvdG90eXBlLCJyZW5kZXJQcmlvcml0eSIsdm9pZCAwKSxUKFtSKCJzaGFkb3dFbmFibGVkIildLGhlLnByb3RvdHlwZSwiX3NoYWRvd0VuYWJsZWQiLHZvaWQgMCksVChbUigiZXhjbHVkZVdpdGhMYXllck1hc2siKV0saGUucHJvdG90eXBlLCJfZXhjbHVkZVdpdGhMYXllck1hc2siLHZvaWQgMCksVChbUigiaW5jbHVkZU9ubHlXaXRoTGF5ZXJNYXNrIildLGhlLnByb3RvdHlwZSwiX2luY2x1ZGVPbmx5V2l0aExheWVyTWFzayIsdm9pZCAwKSxUKFtSKCJsaWdodG1hcE1vZGUiKV0saGUucHJvdG90eXBlLCJfbGlnaHRtYXBNb2RlIix2b2lkIDApO2NsYXNzIFVpIGV4dGVuZHMgaGV7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMuX25lZWRQcm9qZWN0aW9uTWF0cml4Q29tcHV0ZT0hMH1fc2V0UG9zaXRpb24oZSl7dGhpcy5fcG9zaXRpb249ZX1nZXQgcG9zaXRpb24oKXtyZXR1cm4gdGhpcy5fcG9zaXRpb259c2V0IHBvc2l0aW9uKGUpe3RoaXMuX3NldFBvc2l0aW9uKGUpfV9zZXREaXJlY3Rpb24oZSl7dGhpcy5fZGlyZWN0aW9uPWV9Z2V0IGRpcmVjdGlvbigpe3JldHVybiB0aGlzLl9kaXJlY3Rpb259c2V0IGRpcmVjdGlvbihlKXt0aGlzLl9zZXREaXJlY3Rpb24oZSl9Z2V0IHNoYWRvd01pblooKXtyZXR1cm4gdGhpcy5fc2hhZG93TWluWn1zZXQgc2hhZG93TWluWihlKXt0aGlzLl9zaGFkb3dNaW5aPWUsdGhpcy5mb3JjZVByb2plY3Rpb25NYXRyaXhDb21wdXRlKCl9Z2V0IHNoYWRvd01heFooKXtyZXR1cm4gdGhpcy5fc2hhZG93TWF4Wn1zZXQgc2hhZG93TWF4WihlKXt0aGlzLl9zaGFkb3dNYXhaPWUsdGhpcy5mb3JjZVByb2plY3Rpb25NYXRyaXhDb21wdXRlKCl9Y29tcHV0ZVRyYW5zZm9ybWVkSW5mb3JtYXRpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4Pyh0aGlzLnRyYW5zZm9ybWVkUG9zaXRpb258fCh0aGlzLnRyYW5zZm9ybWVkUG9zaXRpb249cC5aZXJvKCkpLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZih0aGlzLnBvc2l0aW9uLHRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCksdGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uKSx0aGlzLmRpcmVjdGlvbiYmKHRoaXMudHJhbnNmb3JtZWREaXJlY3Rpb258fCh0aGlzLnRyYW5zZm9ybWVkRGlyZWN0aW9uPXAuWmVybygpKSxwLlRyYW5zZm9ybU5vcm1hbFRvUmVmKHRoaXMuZGlyZWN0aW9uLHRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCksdGhpcy50cmFuc2Zvcm1lZERpcmVjdGlvbikpLCEwKTohMX1nZXREZXB0aFNjYWxlKCl7cmV0dXJuIDUwfWdldFNoYWRvd0RpcmVjdGlvbihlKXtyZXR1cm4gdGhpcy50cmFuc2Zvcm1lZERpcmVjdGlvbj90aGlzLnRyYW5zZm9ybWVkRGlyZWN0aW9uOnRoaXMuZGlyZWN0aW9ufWdldEFic29sdXRlUG9zaXRpb24oKXtyZXR1cm4gdGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uP3RoaXMudHJhbnNmb3JtZWRQb3NpdGlvbjp0aGlzLnBvc2l0aW9ufXNldERpcmVjdGlvblRvVGFyZ2V0KGUpe3JldHVybiB0aGlzLmRpcmVjdGlvbj1wLk5vcm1hbGl6ZShlLnN1YnRyYWN0KHRoaXMucG9zaXRpb24pKSx0aGlzLmRpcmVjdGlvbn1nZXRSb3RhdGlvbigpe3RoaXMuZGlyZWN0aW9uLm5vcm1hbGl6ZSgpO2NvbnN0IGU9cC5Dcm9zcyh0aGlzLmRpcmVjdGlvbixfaS5ZKSx0PXAuQ3Jvc3MoZSx0aGlzLmRpcmVjdGlvbik7cmV0dXJuIHAuUm90YXRpb25Gcm9tQXhpcyhlLHQsdGhpcy5kaXJlY3Rpb24pfW5lZWRDdWJlKCl7cmV0dXJuITF9bmVlZFByb2plY3Rpb25NYXRyaXhDb21wdXRlKCl7cmV0dXJuIHRoaXMuX25lZWRQcm9qZWN0aW9uTWF0cml4Q29tcHV0ZX1mb3JjZVByb2plY3Rpb25NYXRyaXhDb21wdXRlKCl7dGhpcy5fbmVlZFByb2plY3Rpb25NYXRyaXhDb21wdXRlPSEwfV9pbml0Q2FjaGUoKXtzdXBlci5faW5pdENhY2hlKCksdGhpcy5fY2FjaGUucG9zaXRpb249cC5aZXJvKCl9X2lzU3luY2hyb25pemVkKCl7cmV0dXJuISF0aGlzLl9jYWNoZS5wb3NpdGlvbi5lcXVhbHModGhpcy5wb3NpdGlvbil9Y29tcHV0ZVdvcmxkTWF0cml4KGUpe3JldHVybiFlJiZ0aGlzLmlzU3luY2hyb25pemVkKCk/KHRoaXMuX2N1cnJlbnRSZW5kZXJJZD10aGlzLmdldFNjZW5lKCkuZ2V0UmVuZGVySWQoKSx0aGlzLl93b3JsZE1hdHJpeCk6KHRoaXMuX3VwZGF0ZUNhY2hlKCksdGhpcy5fY2FjaGUucG9zaXRpb24uY29weUZyb20odGhpcy5wb3NpdGlvbiksdGhpcy5fd29ybGRNYXRyaXh8fCh0aGlzLl93b3JsZE1hdHJpeD14LklkZW50aXR5KCkpLHguVHJhbnNsYXRpb25Ub1JlZih0aGlzLnBvc2l0aW9uLngsdGhpcy5wb3NpdGlvbi55LHRoaXMucG9zaXRpb24ueix0aGlzLl93b3JsZE1hdHJpeCksdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4JiYodGhpcy5fd29ybGRNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLnBhcmVudC5nZXRXb3JsZE1hdHJpeCgpLHRoaXMuX3dvcmxkTWF0cml4KSx0aGlzLl9tYXJrU3luY2VkV2l0aFBhcmVudCgpKSx0aGlzLl93b3JsZE1hdHJpeERldGVybWluYW50SXNEaXJ0eT0hMCx0aGlzLl93b3JsZE1hdHJpeCl9Z2V0RGVwdGhNaW5aKGUpe3JldHVybiB0aGlzLnNoYWRvd01pblohPT12b2lkIDA/dGhpcy5zaGFkb3dNaW5aOmUubWluWn1nZXREZXB0aE1heFooZSl7cmV0dXJuIHRoaXMuc2hhZG93TWF4WiE9PXZvaWQgMD90aGlzLnNoYWRvd01heFo6ZS5tYXhafXNldFNoYWRvd1Byb2plY3Rpb25NYXRyaXgoZSx0LGkpe3JldHVybiB0aGlzLmN1c3RvbVByb2plY3Rpb25NYXRyaXhCdWlsZGVyP3RoaXMuY3VzdG9tUHJvamVjdGlvbk1hdHJpeEJ1aWxkZXIodCxpLGUpOnRoaXMuX3NldERlZmF1bHRTaGFkb3dQcm9qZWN0aW9uTWF0cml4KGUsdCxpKSx0aGlzfV9zeW5jUGFyZW50RW5hYmxlZFN0YXRlKCl7c3VwZXIuX3N5bmNQYXJlbnRFbmFibGVkU3RhdGUoKSwoIXRoaXMucGFyZW50fHwhdGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgpJiYodGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uPW51bGwsdGhpcy50cmFuc2Zvcm1lZERpcmVjdGlvbj1udWxsKX19VChbQnQoKV0sVWkucHJvdG90eXBlLCJwb3NpdGlvbiIsbnVsbCksVChbQnQoKV0sVWkucHJvdG90eXBlLCJkaXJlY3Rpb24iLG51bGwpLFQoW1IoKV0sVWkucHJvdG90eXBlLCJzaGFkb3dNaW5aIixudWxsKSxUKFtSKCldLFVpLnByb3RvdHlwZSwic2hhZG93TWF4WiIsbnVsbCksemUuQWRkTm9kZUNvbnN0cnVjdG9yKCJMaWdodF9UeXBlXzEiLChjLGUpPT4oKT0+bmV3IEl0KGMscC5aZXJvKCksZSkpO2NsYXNzIEl0IGV4dGVuZHMgVWl7Y29uc3RydWN0b3IoZSx0LGkpe3N1cGVyKGUsaSksdGhpcy5fc2hhZG93RnJ1c3R1bVNpemU9MCx0aGlzLl9zaGFkb3dPcnRob1NjYWxlPS4xLHRoaXMuYXV0b1VwZGF0ZUV4dGVuZHM9ITAsdGhpcy5hdXRvQ2FsY1NoYWRvd1pCb3VuZHM9ITEsdGhpcy5fb3J0aG9MZWZ0PU51bWJlci5NQVhfVkFMVUUsdGhpcy5fb3J0aG9SaWdodD1OdW1iZXIuTUlOX1ZBTFVFLHRoaXMuX29ydGhvVG9wPU51bWJlci5NSU5fVkFMVUUsdGhpcy5fb3J0aG9Cb3R0b209TnVtYmVyLk1BWF9WQUxVRSx0aGlzLnBvc2l0aW9uPXQuc2NhbGUoLTEpLHRoaXMuZGlyZWN0aW9uPXR9Z2V0IHNoYWRvd0ZydXN0dW1TaXplKCl7cmV0dXJuIHRoaXMuX3NoYWRvd0ZydXN0dW1TaXplfXNldCBzaGFkb3dGcnVzdHVtU2l6ZShlKXt0aGlzLl9zaGFkb3dGcnVzdHVtU2l6ZT1lLHRoaXMuZm9yY2VQcm9qZWN0aW9uTWF0cml4Q29tcHV0ZSgpfWdldCBzaGFkb3dPcnRob1NjYWxlKCl7cmV0dXJuIHRoaXMuX3NoYWRvd09ydGhvU2NhbGV9c2V0IHNoYWRvd09ydGhvU2NhbGUoZSl7dGhpcy5fc2hhZG93T3J0aG9TY2FsZT1lLHRoaXMuZm9yY2VQcm9qZWN0aW9uTWF0cml4Q29tcHV0ZSgpfWdldCBvcnRob0xlZnQoKXtyZXR1cm4gdGhpcy5fb3J0aG9MZWZ0fXNldCBvcnRob0xlZnQoZSl7dGhpcy5fb3J0aG9MZWZ0PWV9Z2V0IG9ydGhvUmlnaHQoKXtyZXR1cm4gdGhpcy5fb3J0aG9SaWdodH1zZXQgb3J0aG9SaWdodChlKXt0aGlzLl9vcnRob1JpZ2h0PWV9Z2V0IG9ydGhvVG9wKCl7cmV0dXJuIHRoaXMuX29ydGhvVG9wfXNldCBvcnRob1RvcChlKXt0aGlzLl9vcnRob1RvcD1lfWdldCBvcnRob0JvdHRvbSgpe3JldHVybiB0aGlzLl9vcnRob0JvdHRvbX1zZXQgb3J0aG9Cb3R0b20oZSl7dGhpcy5fb3J0aG9Cb3R0b209ZX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iRGlyZWN0aW9uYWxMaWdodCJ9Z2V0VHlwZUlEKCl7cmV0dXJuIGhlLkxJR0hUVFlQRUlEX0RJUkVDVElPTkFMTElHSFR9X3NldERlZmF1bHRTaGFkb3dQcm9qZWN0aW9uTWF0cml4KGUsdCxpKXt0aGlzLnNoYWRvd0ZydXN0dW1TaXplPjA/dGhpcy5fc2V0RGVmYXVsdEZpeGVkRnJ1c3R1bVNoYWRvd1Byb2plY3Rpb25NYXRyaXgoZSk6dGhpcy5fc2V0RGVmYXVsdEF1dG9FeHRlbmRTaGFkb3dQcm9qZWN0aW9uTWF0cml4KGUsdCxpKX1fc2V0RGVmYXVsdEZpeGVkRnJ1c3R1bVNoYWRvd1Byb2plY3Rpb25NYXRyaXgoZSl7Y29uc3QgdD10aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhO3QmJnguT3J0aG9MSFRvUmVmKHRoaXMuc2hhZG93RnJ1c3R1bVNpemUsdGhpcy5zaGFkb3dGcnVzdHVtU2l6ZSx0aGlzLnNoYWRvd01pblohPT12b2lkIDA/dGhpcy5zaGFkb3dNaW5aOnQubWluWix0aGlzLnNoYWRvd01heFohPT12b2lkIDA/dGhpcy5zaGFkb3dNYXhaOnQubWF4WixlLHRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5pc05EQ0hhbGZaUmFuZ2UpfV9zZXREZWZhdWx0QXV0b0V4dGVuZFNoYWRvd1Byb2plY3Rpb25NYXRyaXgoZSx0LGkpe2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpLmFjdGl2ZUNhbWVyYTtpZighcylyZXR1cm47aWYodGhpcy5hdXRvVXBkYXRlRXh0ZW5kc3x8dGhpcy5fb3J0aG9MZWZ0PT09TnVtYmVyLk1BWF9WQUxVRSl7Y29uc3QgbD1wLlplcm8oKTt0aGlzLl9vcnRob0xlZnQ9TnVtYmVyLk1BWF9WQUxVRSx0aGlzLl9vcnRob1JpZ2h0PU51bWJlci5NSU5fVkFMVUUsdGhpcy5fb3J0aG9Ub3A9TnVtYmVyLk1JTl9WQUxVRSx0aGlzLl9vcnRob0JvdHRvbT1OdW1iZXIuTUFYX1ZBTFVFO2xldCB1PU51bWJlci5NQVhfVkFMVUUsZD1OdW1iZXIuTUlOX1ZBTFVFO2ZvcihsZXQgZj0wO2Y8aS5sZW5ndGg7ZisrKXtjb25zdCBfPWlbZl07aWYoIV8pY29udGludWU7Y29uc3QgbT1fLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nQm94O2ZvcihsZXQgdj0wO3Y8bS52ZWN0b3JzV29ybGQubGVuZ3RoO3YrKylwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYobS52ZWN0b3JzV29ybGRbdl0sdCxsKSxsLng8dGhpcy5fb3J0aG9MZWZ0JiYodGhpcy5fb3J0aG9MZWZ0PWwueCksbC55PHRoaXMuX29ydGhvQm90dG9tJiYodGhpcy5fb3J0aG9Cb3R0b209bC55KSxsLng+dGhpcy5fb3J0aG9SaWdodCYmKHRoaXMuX29ydGhvUmlnaHQ9bC54KSxsLnk+dGhpcy5fb3J0aG9Ub3AmJih0aGlzLl9vcnRob1RvcD1sLnkpLHRoaXMuYXV0b0NhbGNTaGFkb3daQm91bmRzJiYobC56PHUmJih1PWwueiksbC56PmQmJihkPWwueikpfXRoaXMuYXV0b0NhbGNTaGFkb3daQm91bmRzJiYodGhpcy5fc2hhZG93TWluWj11LHRoaXMuX3NoYWRvd01heFo9ZCl9Y29uc3Qgcj10aGlzLl9vcnRob1JpZ2h0LXRoaXMuX29ydGhvTGVmdCxuPXRoaXMuX29ydGhvVG9wLXRoaXMuX29ydGhvQm90dG9tLGE9dGhpcy5zaGFkb3dNaW5aIT09dm9pZCAwP3RoaXMuc2hhZG93TWluWjpzLm1pblosbz10aGlzLnNoYWRvd01heFohPT12b2lkIDA/dGhpcy5zaGFkb3dNYXhaOnMubWF4WixoPXRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS51c2VSZXZlcnNlRGVwdGhCdWZmZXI7eC5PcnRob09mZkNlbnRlckxIVG9SZWYodGhpcy5fb3J0aG9MZWZ0LXIqdGhpcy5zaGFkb3dPcnRob1NjYWxlLHRoaXMuX29ydGhvUmlnaHQrcip0aGlzLnNoYWRvd09ydGhvU2NhbGUsdGhpcy5fb3J0aG9Cb3R0b20tbip0aGlzLnNoYWRvd09ydGhvU2NhbGUsdGhpcy5fb3J0aG9Ub3Arbip0aGlzLnNoYWRvd09ydGhvU2NhbGUsaD9vOmEsaD9hOm8sZSx0aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkuaXNORENIYWxmWlJhbmdlKX1fYnVpbGRVbmlmb3JtTGF5b3V0KCl7dGhpcy5fdW5pZm9ybUJ1ZmZlci5hZGRVbmlmb3JtKCJ2TGlnaHREYXRhIiw0KSx0aGlzLl91bmlmb3JtQnVmZmVyLmFkZFVuaWZvcm0oInZMaWdodERpZmZ1c2UiLDQpLHRoaXMuX3VuaWZvcm1CdWZmZXIuYWRkVW5pZm9ybSgidkxpZ2h0U3BlY3VsYXIiLDQpLHRoaXMuX3VuaWZvcm1CdWZmZXIuYWRkVW5pZm9ybSgic2hhZG93c0luZm8iLDMpLHRoaXMuX3VuaWZvcm1CdWZmZXIuYWRkVW5pZm9ybSgiZGVwdGhWYWx1ZXMiLDIpLHRoaXMuX3VuaWZvcm1CdWZmZXIuY3JlYXRlKCl9dHJhbnNmZXJUb0VmZmVjdChlLHQpe3JldHVybiB0aGlzLmNvbXB1dGVUcmFuc2Zvcm1lZEluZm9ybWF0aW9uKCk/KHRoaXMuX3VuaWZvcm1CdWZmZXIudXBkYXRlRmxvYXQ0KCJ2TGlnaHREYXRhIix0aGlzLnRyYW5zZm9ybWVkRGlyZWN0aW9uLngsdGhpcy50cmFuc2Zvcm1lZERpcmVjdGlvbi55LHRoaXMudHJhbnNmb3JtZWREaXJlY3Rpb24ueiwxLHQpLHRoaXMpOih0aGlzLl91bmlmb3JtQnVmZmVyLnVwZGF0ZUZsb2F0NCgidkxpZ2h0RGF0YSIsdGhpcy5kaXJlY3Rpb24ueCx0aGlzLmRpcmVjdGlvbi55LHRoaXMuZGlyZWN0aW9uLnosMSx0KSx0aGlzKX10cmFuc2ZlclRvTm9kZU1hdGVyaWFsRWZmZWN0KGUsdCl7cmV0dXJuIHRoaXMuY29tcHV0ZVRyYW5zZm9ybWVkSW5mb3JtYXRpb24oKT8oZS5zZXRGbG9hdDModCx0aGlzLnRyYW5zZm9ybWVkRGlyZWN0aW9uLngsdGhpcy50cmFuc2Zvcm1lZERpcmVjdGlvbi55LHRoaXMudHJhbnNmb3JtZWREaXJlY3Rpb24ueiksdGhpcyk6KGUuc2V0RmxvYXQzKHQsdGhpcy5kaXJlY3Rpb24ueCx0aGlzLmRpcmVjdGlvbi55LHRoaXMuZGlyZWN0aW9uLnopLHRoaXMpfWdldERlcHRoTWluWihlKXtjb25zdCB0PXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3JldHVybiF0LnVzZVJldmVyc2VEZXB0aEJ1ZmZlciYmdC5pc05EQ0hhbGZaUmFuZ2U/MDoxfWdldERlcHRoTWF4WihlKXtjb25zdCB0PXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3JldHVybiB0LnVzZVJldmVyc2VEZXB0aEJ1ZmZlciYmdC5pc05EQ0hhbGZaUmFuZ2U/MDoxfXByZXBhcmVMaWdodFNwZWNpZmljRGVmaW5lcyhlLHQpe2VbIkRJUkxJR0hUIit0XT0hMH19VChbUigpXSxJdC5wcm90b3R5cGUsInNoYWRvd0ZydXN0dW1TaXplIixudWxsKSxUKFtSKCldLEl0LnByb3RvdHlwZSwic2hhZG93T3J0aG9TY2FsZSIsbnVsbCksVChbUigpXSxJdC5wcm90b3R5cGUsImF1dG9VcGRhdGVFeHRlbmRzIix2b2lkIDApLFQoW1IoKV0sSXQucHJvdG90eXBlLCJhdXRvQ2FsY1NoYWRvd1pCb3VuZHMiLHZvaWQgMCksVChbUigib3J0aG9MZWZ0IildLEl0LnByb3RvdHlwZSwiX29ydGhvTGVmdCIsdm9pZCAwKSxUKFtSKCJvcnRob1JpZ2h0IildLEl0LnByb3RvdHlwZSwiX29ydGhvUmlnaHQiLHZvaWQgMCksVChbUigib3J0aG9Ub3AiKV0sSXQucHJvdG90eXBlLCJfb3J0aG9Ub3AiLHZvaWQgMCksVChbUigib3J0aG9Cb3R0b20iKV0sSXQucHJvdG90eXBlLCJfb3J0aG9Cb3R0b20iLHZvaWQgMCksemUuQWRkTm9kZUNvbnN0cnVjdG9yKCJMaWdodF9UeXBlXzMiLChjLGUpPT4oKT0+bmV3IG5zKGMscC5aZXJvKCksZSkpO2NsYXNzIG5zIGV4dGVuZHMgaGV7Y29uc3RydWN0b3IoZSx0LGkpe3N1cGVyKGUsaSksdGhpcy5ncm91bmRDb2xvcj1uZXcgcmUoMCwwLDApLHRoaXMuZGlyZWN0aW9uPXR8fHAuVXAoKX1fYnVpbGRVbmlmb3JtTGF5b3V0KCl7dGhpcy5fdW5pZm9ybUJ1ZmZlci5hZGRVbmlmb3JtKCJ2TGlnaHREYXRhIiw0KSx0aGlzLl91bmlmb3JtQnVmZmVyLmFkZFVuaWZvcm0oInZMaWdodERpZmZ1c2UiLDQpLHRoaXMuX3VuaWZvcm1CdWZmZXIuYWRkVW5pZm9ybSgidkxpZ2h0U3BlY3VsYXIiLDQpLHRoaXMuX3VuaWZvcm1CdWZmZXIuYWRkVW5pZm9ybSgidkxpZ2h0R3JvdW5kIiwzKSx0aGlzLl91bmlmb3JtQnVmZmVyLmFkZFVuaWZvcm0oInNoYWRvd3NJbmZvIiwzKSx0aGlzLl91bmlmb3JtQnVmZmVyLmFkZFVuaWZvcm0oImRlcHRoVmFsdWVzIiwyKSx0aGlzLl91bmlmb3JtQnVmZmVyLmNyZWF0ZSgpfWdldENsYXNzTmFtZSgpe3JldHVybiJIZW1pc3BoZXJpY0xpZ2h0In1zZXREaXJlY3Rpb25Ub1RhcmdldChlKXtyZXR1cm4gdGhpcy5kaXJlY3Rpb249cC5Ob3JtYWxpemUoZS5zdWJ0cmFjdChwLlplcm8oKSkpLHRoaXMuZGlyZWN0aW9ufWdldFNoYWRvd0dlbmVyYXRvcigpe3JldHVybiBudWxsfXRyYW5zZmVyVG9FZmZlY3QoZSx0KXtjb25zdCBpPXAuTm9ybWFsaXplKHRoaXMuZGlyZWN0aW9uKTtyZXR1cm4gdGhpcy5fdW5pZm9ybUJ1ZmZlci51cGRhdGVGbG9hdDQoInZMaWdodERhdGEiLGkueCxpLnksaS56LDAsdCksdGhpcy5fdW5pZm9ybUJ1ZmZlci51cGRhdGVDb2xvcjMoInZMaWdodEdyb3VuZCIsdGhpcy5ncm91bmRDb2xvci5zY2FsZSh0aGlzLmludGVuc2l0eSksdCksdGhpc310cmFuc2ZlclRvTm9kZU1hdGVyaWFsRWZmZWN0KGUsdCl7Y29uc3QgaT1wLk5vcm1hbGl6ZSh0aGlzLmRpcmVjdGlvbik7cmV0dXJuIGUuc2V0RmxvYXQzKHQsaS54LGkueSxpLnopLHRoaXN9Y29tcHV0ZVdvcmxkTWF0cml4KCl7cmV0dXJuIHRoaXMuX3dvcmxkTWF0cml4fHwodGhpcy5fd29ybGRNYXRyaXg9eC5JZGVudGl0eSgpKSx0aGlzLl93b3JsZE1hdHJpeH1nZXRUeXBlSUQoKXtyZXR1cm4gaGUuTElHSFRUWVBFSURfSEVNSVNQSEVSSUNMSUdIVH1wcmVwYXJlTGlnaHRTcGVjaWZpY0RlZmluZXMoZSx0KXtlWyJIRU1JTElHSFQiK3RdPSEwfX1UKFtjaSgpXSxucy5wcm90b3R5cGUsImdyb3VuZENvbG9yIix2b2lkIDApLFQoW0J0KCldLG5zLnByb3RvdHlwZSwiZGlyZWN0aW9uIix2b2lkIDApO2NsYXNzIEd0e2NvbnN0cnVjdG9yKGUsdCl7dGhpcy53aWR0aD1lLHRoaXMuaGVpZ2h0PXR9dG9TdHJpbmcoKXtyZXR1cm5ge1c6ICR7dGhpcy53aWR0aH0sIEg6ICR7dGhpcy5oZWlnaHR9fWB9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIlNpemUifWdldEhhc2hDb2RlKCl7bGV0IGU9dGhpcy53aWR0aHwwO3JldHVybiBlPWUqMzk3Xih0aGlzLmhlaWdodHwwKSxlfWNvcHlGcm9tKGUpe3RoaXMud2lkdGg9ZS53aWR0aCx0aGlzLmhlaWdodD1lLmhlaWdodH1jb3B5RnJvbUZsb2F0cyhlLHQpe3JldHVybiB0aGlzLndpZHRoPWUsdGhpcy5oZWlnaHQ9dCx0aGlzfXNldChlLHQpe3JldHVybiB0aGlzLmNvcHlGcm9tRmxvYXRzKGUsdCl9bXVsdGlwbHlCeUZsb2F0cyhlLHQpe3JldHVybiBuZXcgR3QodGhpcy53aWR0aCplLHRoaXMuaGVpZ2h0KnQpfWNsb25lKCl7cmV0dXJuIG5ldyBHdCh0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KX1lcXVhbHMoZSl7cmV0dXJuIGU/dGhpcy53aWR0aD09PWUud2lkdGgmJnRoaXMuaGVpZ2h0PT09ZS5oZWlnaHQ6ITF9Z2V0IHN1cmZhY2UoKXtyZXR1cm4gdGhpcy53aWR0aCp0aGlzLmhlaWdodH1zdGF0aWMgWmVybygpe3JldHVybiBuZXcgR3QoMCwwKX1hZGQoZSl7cmV0dXJuIG5ldyBHdCh0aGlzLndpZHRoK2Uud2lkdGgsdGhpcy5oZWlnaHQrZS5oZWlnaHQpfXN1YnRyYWN0KGUpe3JldHVybiBuZXcgR3QodGhpcy53aWR0aC1lLndpZHRoLHRoaXMuaGVpZ2h0LWUuaGVpZ2h0KX1zdGF0aWMgTGVycChlLHQsaSl7Y29uc3Qgcz1lLndpZHRoKyh0LndpZHRoLWUud2lkdGgpKmkscj1lLmhlaWdodCsodC5oZWlnaHQtZS5oZWlnaHQpKmk7cmV0dXJuIG5ldyBHdChzLHIpfX1jbGFzcyBabntjb25zdHJ1Y3RvcihlKXt0aGlzLl93cmFwVT0xLHRoaXMuX3dyYXBWPTEsdGhpcy53cmFwUj0xLHRoaXMuYW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbD00LHRoaXMuZGVsYXlMb2FkU3RhdGU9MCx0aGlzLl90ZXh0dXJlPW51bGwsdGhpcy5fZW5naW5lPW51bGwsdGhpcy5fY2FjaGVkU2l6ZT1HdC5aZXJvKCksdGhpcy5fY2FjaGVkQmFzZVNpemU9R3QuWmVybygpLHRoaXMuX2luaXRpYWxTYW1wbGluZ01vZGU9Mix0aGlzLl90ZXh0dXJlPWUsdGhpcy5fdGV4dHVyZSYmKHRoaXMuX2VuZ2luZT10aGlzLl90ZXh0dXJlLmdldEVuZ2luZSgpKX1nZXQgd3JhcFUoKXtyZXR1cm4gdGhpcy5fd3JhcFV9c2V0IHdyYXBVKGUpe3RoaXMuX3dyYXBVPWV9Z2V0IHdyYXBWKCl7cmV0dXJuIHRoaXMuX3dyYXBWfXNldCB3cmFwVihlKXt0aGlzLl93cmFwVj1lfWdldCBjb29yZGluYXRlc01vZGUoKXtyZXR1cm4gMH1nZXQgaXNDdWJlKCl7cmV0dXJuIHRoaXMuX3RleHR1cmU/dGhpcy5fdGV4dHVyZS5pc0N1YmU6ITF9c2V0IGlzQ3ViZShlKXt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5pc0N1YmU9ZSl9Z2V0IGlzM0QoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLmlzM0Q6ITF9c2V0IGlzM0QoZSl7dGhpcy5fdGV4dHVyZSYmKHRoaXMuX3RleHR1cmUuaXMzRD1lKX1nZXQgaXMyREFycmF5KCl7cmV0dXJuIHRoaXMuX3RleHR1cmU/dGhpcy5fdGV4dHVyZS5pczJEQXJyYXk6ITF9c2V0IGlzMkRBcnJheShlKXt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5pczJEQXJyYXk9ZSl9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIlRoaW5UZXh0dXJlIn1pc1JlYWR5KCl7cmV0dXJuIHRoaXMuZGVsYXlMb2FkU3RhdGU9PT00Pyh0aGlzLmRlbGF5TG9hZCgpLCExKTp0aGlzLl90ZXh0dXJlP3RoaXMuX3RleHR1cmUuaXNSZWFkeTohMX1kZWxheUxvYWQoKXt9Z2V0SW50ZXJuYWxUZXh0dXJlKCl7cmV0dXJuIHRoaXMuX3RleHR1cmV9Z2V0U2l6ZSgpe2lmKHRoaXMuX3RleHR1cmUpe2lmKHRoaXMuX3RleHR1cmUud2lkdGgpcmV0dXJuIHRoaXMuX2NhY2hlZFNpemUud2lkdGg9dGhpcy5fdGV4dHVyZS53aWR0aCx0aGlzLl9jYWNoZWRTaXplLmhlaWdodD10aGlzLl90ZXh0dXJlLmhlaWdodCx0aGlzLl9jYWNoZWRTaXplO2lmKHRoaXMuX3RleHR1cmUuX3NpemUpcmV0dXJuIHRoaXMuX2NhY2hlZFNpemUud2lkdGg9dGhpcy5fdGV4dHVyZS5fc2l6ZSx0aGlzLl9jYWNoZWRTaXplLmhlaWdodD10aGlzLl90ZXh0dXJlLl9zaXplLHRoaXMuX2NhY2hlZFNpemV9cmV0dXJuIHRoaXMuX2NhY2hlZFNpemV9Z2V0QmFzZVNpemUoKXtyZXR1cm4hdGhpcy5pc1JlYWR5KCl8fCF0aGlzLl90ZXh0dXJlPyh0aGlzLl9jYWNoZWRCYXNlU2l6ZS53aWR0aD0wLHRoaXMuX2NhY2hlZEJhc2VTaXplLmhlaWdodD0wLHRoaXMuX2NhY2hlZEJhc2VTaXplKTp0aGlzLl90ZXh0dXJlLl9zaXplPyh0aGlzLl9jYWNoZWRCYXNlU2l6ZS53aWR0aD10aGlzLl90ZXh0dXJlLl9zaXplLHRoaXMuX2NhY2hlZEJhc2VTaXplLmhlaWdodD10aGlzLl90ZXh0dXJlLl9zaXplLHRoaXMuX2NhY2hlZEJhc2VTaXplKToodGhpcy5fY2FjaGVkQmFzZVNpemUud2lkdGg9dGhpcy5fdGV4dHVyZS5iYXNlV2lkdGgsdGhpcy5fY2FjaGVkQmFzZVNpemUuaGVpZ2h0PXRoaXMuX3RleHR1cmUuYmFzZUhlaWdodCx0aGlzLl9jYWNoZWRCYXNlU2l6ZSl9Z2V0IHNhbXBsaW5nTW9kZSgpe3JldHVybiB0aGlzLl90ZXh0dXJlP3RoaXMuX3RleHR1cmUuc2FtcGxpbmdNb2RlOnRoaXMuX2luaXRpYWxTYW1wbGluZ01vZGV9dXBkYXRlU2FtcGxpbmdNb2RlKGUpe3RoaXMuX3RleHR1cmUmJnRoaXMuX2VuZ2luZSYmdGhpcy5fZW5naW5lLnVwZGF0ZVRleHR1cmVTYW1wbGluZ01vZGUoZSx0aGlzLl90ZXh0dXJlKX1yZWxlYXNlSW50ZXJuYWxUZXh0dXJlKCl7dGhpcy5fdGV4dHVyZSYmKHRoaXMuX3RleHR1cmUuZGlzcG9zZSgpLHRoaXMuX3RleHR1cmU9bnVsbCl9ZGlzcG9zZSgpe3RoaXMuX3RleHR1cmUmJih0aGlzLnJlbGVhc2VJbnRlcm5hbFRleHR1cmUoKSx0aGlzLl9lbmdpbmU9bnVsbCl9fWNsYXNzIFJlIGV4dGVuZHMgWm57Y29uc3RydWN0b3IoZSx0PW51bGwpe3N1cGVyKG51bGwpLHRoaXMubWV0YWRhdGE9bnVsbCx0aGlzLnJlc2VydmVkRGF0YVN0b3JlPW51bGwsdGhpcy5faGFzQWxwaGE9ITEsdGhpcy5fZ2V0QWxwaGFGcm9tUkdCPSExLHRoaXMubGV2ZWw9MSx0aGlzLl9jb29yZGluYXRlc0luZGV4PTAsdGhpcy5vcHRpbWl6ZVVWQWxsb2NhdGlvbj0hMCx0aGlzLl9jb29yZGluYXRlc01vZGU9MCx0aGlzLndyYXBSPTEsdGhpcy5hbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsPVJlLkRFRkFVTFRfQU5JU09UUk9QSUNfRklMVEVSSU5HX0xFVkVMLHRoaXMuX2lzQ3ViZT0hMSx0aGlzLl9nYW1tYVNwYWNlPSEwLHRoaXMuaW52ZXJ0Wj0hMSx0aGlzLmxvZExldmVsSW5BbHBoYT0hMSx0aGlzLmlzUmVuZGVyVGFyZ2V0PSExLHRoaXMuX3ByZWZpbHRlcmVkPSExLHRoaXMuX2ZvcmNlU2VyaWFsaXplPSExLHRoaXMuYW5pbWF0aW9ucz1uZXcgQXJyYXksdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX29uRGlzcG9zZU9ic2VydmVyPW51bGwsdGhpcy5fc2NlbmU9bnVsbCx0aGlzLl91aWQ9bnVsbCx0aGlzLl9wYXJlbnRDb250YWluZXI9bnVsbCx0aGlzLl9sb2FkaW5nRXJyb3I9ITEsZT9SZS5fSXNTY2VuZShlKT90aGlzLl9zY2VuZT1lOnRoaXMuX2VuZ2luZT1lOnRoaXMuX3NjZW5lPWZlLkxhc3RDcmVhdGVkU2NlbmUsdGhpcy5fc2NlbmUmJih0aGlzLnVuaXF1ZUlkPXRoaXMuX3NjZW5lLmdldFVuaXF1ZUlkKCksdGhpcy5fc2NlbmUuYWRkVGV4dHVyZSh0aGlzKSx0aGlzLl9lbmdpbmU9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkpLHRoaXMuX3RleHR1cmU9dCx0aGlzLl91aWQ9bnVsbH1zZXQgaGFzQWxwaGEoZSl7dGhpcy5faGFzQWxwaGEhPT1lJiYodGhpcy5faGFzQWxwaGE9ZSx0aGlzLl9zY2VuZSYmdGhpcy5fc2NlbmUubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSx0PT50Lmhhc1RleHR1cmUodGhpcykpKX1nZXQgaGFzQWxwaGEoKXtyZXR1cm4gdGhpcy5faGFzQWxwaGF9c2V0IGdldEFscGhhRnJvbVJHQihlKXt0aGlzLl9nZXRBbHBoYUZyb21SR0IhPT1lJiYodGhpcy5fZ2V0QWxwaGFGcm9tUkdCPWUsdGhpcy5fc2NlbmUmJnRoaXMuX3NjZW5lLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEsdD0+dC5oYXNUZXh0dXJlKHRoaXMpKSl9Z2V0IGdldEFscGhhRnJvbVJHQigpe3JldHVybiB0aGlzLl9nZXRBbHBoYUZyb21SR0J9c2V0IGNvb3JkaW5hdGVzSW5kZXgoZSl7dGhpcy5fY29vcmRpbmF0ZXNJbmRleCE9PWUmJih0aGlzLl9jb29yZGluYXRlc0luZGV4PWUsdGhpcy5fc2NlbmUmJnRoaXMuX3NjZW5lLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEsdD0+dC5oYXNUZXh0dXJlKHRoaXMpKSl9Z2V0IGNvb3JkaW5hdGVzSW5kZXgoKXtyZXR1cm4gdGhpcy5fY29vcmRpbmF0ZXNJbmRleH1zZXQgY29vcmRpbmF0ZXNNb2RlKGUpe3RoaXMuX2Nvb3JkaW5hdGVzTW9kZSE9PWUmJih0aGlzLl9jb29yZGluYXRlc01vZGU9ZSx0aGlzLl9zY2VuZSYmdGhpcy5fc2NlbmUubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSx0PT50Lmhhc1RleHR1cmUodGhpcykpKX1nZXQgY29vcmRpbmF0ZXNNb2RlKCl7cmV0dXJuIHRoaXMuX2Nvb3JkaW5hdGVzTW9kZX1nZXQgd3JhcFUoKXtyZXR1cm4gdGhpcy5fd3JhcFV9c2V0IHdyYXBVKGUpe3RoaXMuX3dyYXBVPWV9Z2V0IHdyYXBWKCl7cmV0dXJuIHRoaXMuX3dyYXBWfXNldCB3cmFwVihlKXt0aGlzLl93cmFwVj1lfWdldCBpc0N1YmUoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLmlzQ3ViZTp0aGlzLl9pc0N1YmV9c2V0IGlzQ3ViZShlKXt0aGlzLl90ZXh0dXJlP3RoaXMuX3RleHR1cmUuaXNDdWJlPWU6dGhpcy5faXNDdWJlPWV9Z2V0IGlzM0QoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLmlzM0Q6ITF9c2V0IGlzM0QoZSl7dGhpcy5fdGV4dHVyZSYmKHRoaXMuX3RleHR1cmUuaXMzRD1lKX1nZXQgaXMyREFycmF5KCl7cmV0dXJuIHRoaXMuX3RleHR1cmU/dGhpcy5fdGV4dHVyZS5pczJEQXJyYXk6ITF9c2V0IGlzMkRBcnJheShlKXt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5pczJEQXJyYXk9ZSl9Z2V0IGdhbW1hU3BhY2UoKXtpZih0aGlzLl90ZXh0dXJlKXRoaXMuX3RleHR1cmUuX2dhbW1hU3BhY2U9PT1udWxsJiYodGhpcy5fdGV4dHVyZS5fZ2FtbWFTcGFjZT10aGlzLl9nYW1tYVNwYWNlKTtlbHNlIHJldHVybiB0aGlzLl9nYW1tYVNwYWNlO3JldHVybiB0aGlzLl90ZXh0dXJlLl9nYW1tYVNwYWNlJiYhdGhpcy5fdGV4dHVyZS5fdXNlU1JHQkJ1ZmZlcn1zZXQgZ2FtbWFTcGFjZShlKXtpZih0aGlzLl90ZXh0dXJlKXtpZih0aGlzLl90ZXh0dXJlLl9nYW1tYVNwYWNlPT09ZSlyZXR1cm47dGhpcy5fdGV4dHVyZS5fZ2FtbWFTcGFjZT1lfWVsc2V7aWYodGhpcy5fZ2FtbWFTcGFjZT09PWUpcmV0dXJuO3RoaXMuX2dhbW1hU3BhY2U9ZX10aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5KCl9Z2V0IGlzUkdCRCgpe3JldHVybiB0aGlzLl90ZXh0dXJlIT1udWxsJiZ0aGlzLl90ZXh0dXJlLl9pc1JHQkR9c2V0IGlzUkdCRChlKXt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5faXNSR0JEPWUpfWdldCBub01pcG1hcCgpe3JldHVybiExfWdldCBsb2RHZW5lcmF0aW9uT2Zmc2V0KCl7cmV0dXJuIHRoaXMuX3RleHR1cmU/dGhpcy5fdGV4dHVyZS5fbG9kR2VuZXJhdGlvbk9mZnNldDowfXNldCBsb2RHZW5lcmF0aW9uT2Zmc2V0KGUpe3RoaXMuX3RleHR1cmUmJih0aGlzLl90ZXh0dXJlLl9sb2RHZW5lcmF0aW9uT2Zmc2V0PWUpfWdldCBsb2RHZW5lcmF0aW9uU2NhbGUoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLl9sb2RHZW5lcmF0aW9uU2NhbGU6MH1zZXQgbG9kR2VuZXJhdGlvblNjYWxlKGUpe3RoaXMuX3RleHR1cmUmJih0aGlzLl90ZXh0dXJlLl9sb2RHZW5lcmF0aW9uU2NhbGU9ZSl9Z2V0IGxpbmVhclNwZWN1bGFyTE9EKCl7cmV0dXJuIHRoaXMuX3RleHR1cmU/dGhpcy5fdGV4dHVyZS5fbGluZWFyU3BlY3VsYXJMT0Q6ITF9c2V0IGxpbmVhclNwZWN1bGFyTE9EKGUpe3RoaXMuX3RleHR1cmUmJih0aGlzLl90ZXh0dXJlLl9saW5lYXJTcGVjdWxhckxPRD1lKX1nZXQgaXJyYWRpYW5jZVRleHR1cmUoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLl9pcnJhZGlhbmNlVGV4dHVyZTpudWxsfXNldCBpcnJhZGlhbmNlVGV4dHVyZShlKXt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5faXJyYWRpYW5jZVRleHR1cmU9ZSl9Z2V0IHVpZCgpe3JldHVybiB0aGlzLl91aWR8fCh0aGlzLl91aWQ9bHIoKSksdGhpcy5fdWlkfXRvU3RyaW5nKCl7cmV0dXJuIHRoaXMubmFtZX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iQmFzZVRleHR1cmUifXNldCBvbkRpc3Bvc2UoZSl7dGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXImJnRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXIpLHRoaXMuX29uRGlzcG9zZU9ic2VydmVyPXRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5hZGQoZSl9Z2V0IGlzQmxvY2tpbmcoKXtyZXR1cm4hMH1nZXQgbG9hZGluZ0Vycm9yKCl7cmV0dXJuIHRoaXMuX2xvYWRpbmdFcnJvcn1nZXQgZXJyb3JPYmplY3QoKXtyZXR1cm4gdGhpcy5fZXJyb3JPYmplY3R9Z2V0U2NlbmUoKXtyZXR1cm4gdGhpcy5fc2NlbmV9X2dldEVuZ2luZSgpe3JldHVybiB0aGlzLl9lbmdpbmV9Y2hlY2tUcmFuc2Zvcm1zQXJlSWRlbnRpY2FsKGUpe3JldHVybiBlIT09bnVsbH1nZXRUZXh0dXJlTWF0cml4KCl7cmV0dXJuIHguSWRlbnRpdHlSZWFkT25seX1nZXRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeCgpe3JldHVybiB4LklkZW50aXR5UmVhZE9ubHl9aXNSZWFkeU9yTm90QmxvY2tpbmcoKXtyZXR1cm4hdGhpcy5pc0Jsb2NraW5nfHx0aGlzLmlzUmVhZHkoKXx8dGhpcy5sb2FkaW5nRXJyb3J9c2NhbGUoZSl7fWdldCBjYW5SZXNjYWxlKCl7cmV0dXJuITF9X2dldEZyb21DYWNoZShlLHQsaSxzLHIsbil7Y29uc3QgYT10aGlzLl9nZXRFbmdpbmUoKTtpZighYSlyZXR1cm4gbnVsbDtjb25zdCBvPWEuX2dldFVzZVNSR0JCdWZmZXIoISFyLHQpLGg9YS5nZXRMb2FkZWRUZXh0dXJlc0NhY2hlKCk7Zm9yKGxldCBsPTA7bDxoLmxlbmd0aDtsKyspe2NvbnN0IHU9aFtsXTtpZigocj09PXZvaWQgMHx8bz09PXUuX3VzZVNSR0JCdWZmZXIpJiYocz09PXZvaWQgMHx8cz09PXUuaW52ZXJ0WSkmJnUudXJsPT09ZSYmdS5nZW5lcmF0ZU1pcE1hcHM9PT0hdCYmKCFpfHxpPT09dS5zYW1wbGluZ01vZGUpJiYobj09PXZvaWQgMHx8bj09PXUuaXNDdWJlKSlyZXR1cm4gdS5pbmNyZW1lbnRSZWZlcmVuY2VzKCksdX1yZXR1cm4gbnVsbH1fcmVidWlsZCgpe31jbG9uZSgpe3JldHVybiBudWxsfWdldCB0ZXh0dXJlVHlwZSgpe3JldHVybiB0aGlzLl90ZXh0dXJlJiZ0aGlzLl90ZXh0dXJlLnR5cGUhPT12b2lkIDA/dGhpcy5fdGV4dHVyZS50eXBlOjB9Z2V0IHRleHR1cmVGb3JtYXQoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZSYmdGhpcy5fdGV4dHVyZS5mb3JtYXQhPT12b2lkIDA/dGhpcy5fdGV4dHVyZS5mb3JtYXQ6NX1fbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSgpe2NvbnN0IGU9dGhpcy5nZXRTY2VuZSgpO2UmJmUubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSl9cmVhZFBpeGVscyhlPTAsdD0wLGk9bnVsbCxzPSEwLHI9ITEsbj0wLGE9MCxvPU51bWJlci5NQVhfVkFMVUUsaD1OdW1iZXIuTUFYX1ZBTFVFKXtpZighdGhpcy5fdGV4dHVyZSlyZXR1cm4gbnVsbDtjb25zdCBsPXRoaXMuX2dldEVuZ2luZSgpO2lmKCFsKXJldHVybiBudWxsO2NvbnN0IHU9dGhpcy5nZXRTaXplKCk7bGV0IGQ9dS53aWR0aCxmPXUuaGVpZ2h0O3QhPT0wJiYoZD1kL01hdGgucG93KDIsdCksZj1mL01hdGgucG93KDIsdCksZD1NYXRoLnJvdW5kKGQpLGY9TWF0aC5yb3VuZChmKSksbz1NYXRoLm1pbihkLG8pLGg9TWF0aC5taW4oZixoKTt0cnl7cmV0dXJuIHRoaXMuX3RleHR1cmUuaXNDdWJlP2wuX3JlYWRUZXh0dXJlUGl4ZWxzKHRoaXMuX3RleHR1cmUsbyxoLGUsdCxpLHMscixuLGEpOmwuX3JlYWRUZXh0dXJlUGl4ZWxzKHRoaXMuX3RleHR1cmUsbyxoLC0xLHQsaSxzLHIsbixhKX1jYXRjaHtyZXR1cm4gbnVsbH19X3JlYWRQaXhlbHNTeW5jKGU9MCx0PTAsaT1udWxsLHM9ITAscj0hMSl7aWYoIXRoaXMuX3RleHR1cmUpcmV0dXJuIG51bGw7Y29uc3Qgbj10aGlzLmdldFNpemUoKTtsZXQgYT1uLndpZHRoLG89bi5oZWlnaHQ7Y29uc3QgaD10aGlzLl9nZXRFbmdpbmUoKTtpZighaClyZXR1cm4gbnVsbDt0IT0wJiYoYT1hL01hdGgucG93KDIsdCksbz1vL01hdGgucG93KDIsdCksYT1NYXRoLnJvdW5kKGEpLG89TWF0aC5yb3VuZChvKSk7dHJ5e3JldHVybiB0aGlzLl90ZXh0dXJlLmlzQ3ViZT9oLl9yZWFkVGV4dHVyZVBpeGVsc1N5bmModGhpcy5fdGV4dHVyZSxhLG8sZSx0LGkscyxyKTpoLl9yZWFkVGV4dHVyZVBpeGVsc1N5bmModGhpcy5fdGV4dHVyZSxhLG8sLTEsdCxpLHMscil9Y2F0Y2h7cmV0dXJuIG51bGx9fWdldCBfbG9kVGV4dHVyZUhpZ2goKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLl9sb2RUZXh0dXJlSGlnaDpudWxsfWdldCBfbG9kVGV4dHVyZU1pZCgpe3JldHVybiB0aGlzLl90ZXh0dXJlP3RoaXMuX3RleHR1cmUuX2xvZFRleHR1cmVNaWQ6bnVsbH1nZXQgX2xvZFRleHR1cmVMb3coKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLl9sb2RUZXh0dXJlTG93Om51bGx9ZGlzcG9zZSgpe2lmKHRoaXMuX3NjZW5lKXt0aGlzLl9zY2VuZS5zdG9wQW5pbWF0aW9uJiZ0aGlzLl9zY2VuZS5zdG9wQW5pbWF0aW9uKHRoaXMpLHRoaXMuX3NjZW5lLnJlbW92ZVBlbmRpbmdEYXRhKHRoaXMpO2NvbnN0IGU9dGhpcy5fc2NlbmUudGV4dHVyZXMuaW5kZXhPZih0aGlzKTtpZihlPj0wJiZ0aGlzLl9zY2VuZS50ZXh0dXJlcy5zcGxpY2UoZSwxKSx0aGlzLl9zY2VuZS5vblRleHR1cmVSZW1vdmVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5fc2NlbmU9bnVsbCx0aGlzLl9wYXJlbnRDb250YWluZXIpe2NvbnN0IHQ9dGhpcy5fcGFyZW50Q29udGFpbmVyLnRleHR1cmVzLmluZGV4T2YodGhpcyk7dD4tMSYmdGhpcy5fcGFyZW50Q29udGFpbmVyLnRleHR1cmVzLnNwbGljZSh0LDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfX10aGlzLm9uRGlzcG9zZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMubWV0YWRhdGE9bnVsbCxzdXBlci5kaXNwb3NlKCl9c2VyaWFsaXplKGU9ITEpe2lmKCF0aGlzLm5hbWUmJiFlKXJldHVybiBudWxsO2NvbnN0IHQ9YWUuU2VyaWFsaXplKHRoaXMpO3JldHVybiBhZS5BcHBlbmRTZXJpYWxpemVkQW5pbWF0aW9ucyh0aGlzLHQpLHR9c3RhdGljIFdoZW5BbGxSZWFkeShlLHQpe2xldCBpPWUubGVuZ3RoO2lmKGk9PT0wKXt0KCk7cmV0dXJufWZvcihsZXQgcz0wO3M8ZS5sZW5ndGg7cysrKXtjb25zdCByPWVbc107aWYoci5pc1JlYWR5KCkpLS1pPT09MCYmdCgpO2Vsc2V7Y29uc3Qgbj1yLm9uTG9hZE9ic2VydmFibGU7bj9uLmFkZE9uY2UoKCk9PnstLWk9PT0wJiZ0KCl9KTotLWk9PT0wJiZ0KCl9fX1zdGF0aWMgX0lzU2NlbmUoZSl7cmV0dXJuIGUuZ2V0Q2xhc3NOYW1lKCk9PT0iU2NlbmUifX1SZS5ERUZBVUxUX0FOSVNPVFJPUElDX0ZJTFRFUklOR19MRVZFTD00LFQoW1IoKV0sUmUucHJvdG90eXBlLCJ1bmlxdWVJZCIsdm9pZCAwKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibmFtZSIsdm9pZCAwKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibWV0YWRhdGEiLHZvaWQgMCksVChbUigiaGFzQWxwaGEiKV0sUmUucHJvdG90eXBlLCJfaGFzQWxwaGEiLHZvaWQgMCksVChbUigiZ2V0QWxwaGFGcm9tUkdCIildLFJlLnByb3RvdHlwZSwiX2dldEFscGhhRnJvbVJHQiIsdm9pZCAwKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibGV2ZWwiLHZvaWQgMCksVChbUigiY29vcmRpbmF0ZXNJbmRleCIpXSxSZS5wcm90b3R5cGUsIl9jb29yZGluYXRlc0luZGV4Iix2b2lkIDApLFQoW1IoKV0sUmUucHJvdG90eXBlLCJvcHRpbWl6ZVVWQWxsb2NhdGlvbiIsdm9pZCAwKSxUKFtSKCJjb29yZGluYXRlc01vZGUiKV0sUmUucHJvdG90eXBlLCJfY29vcmRpbmF0ZXNNb2RlIix2b2lkIDApLFQoW1IoKV0sUmUucHJvdG90eXBlLCJ3cmFwVSIsbnVsbCksVChbUigpXSxSZS5wcm90b3R5cGUsIndyYXBWIixudWxsKSxUKFtSKCldLFJlLnByb3RvdHlwZSwid3JhcFIiLHZvaWQgMCksVChbUigpXSxSZS5wcm90b3R5cGUsImFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWwiLHZvaWQgMCksVChbUigpXSxSZS5wcm90b3R5cGUsImlzQ3ViZSIsbnVsbCksVChbUigpXSxSZS5wcm90b3R5cGUsImlzM0QiLG51bGwpLFQoW1IoKV0sUmUucHJvdG90eXBlLCJpczJEQXJyYXkiLG51bGwpLFQoW1IoKV0sUmUucHJvdG90eXBlLCJnYW1tYVNwYWNlIixudWxsKSxUKFtSKCldLFJlLnByb3RvdHlwZSwiaW52ZXJ0WiIsdm9pZCAwKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibG9kTGV2ZWxJbkFscGhhIix2b2lkIDApLFQoW1IoKV0sUmUucHJvdG90eXBlLCJsb2RHZW5lcmF0aW9uT2Zmc2V0IixudWxsKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibG9kR2VuZXJhdGlvblNjYWxlIixudWxsKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibGluZWFyU3BlY3VsYXJMT0QiLG51bGwpLFQoW210KCldLFJlLnByb3RvdHlwZSwiaXJyYWRpYW5jZVRleHR1cmUiLG51bGwpLFQoW1IoKV0sUmUucHJvdG90eXBlLCJpc1JlbmRlclRhcmdldCIsdm9pZCAwKTtmdW5jdGlvbiBGcihjLGUsdD0hMSl7Y29uc3QgaT1lLndpZHRoLHM9ZS5oZWlnaHQ7aWYoYyBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSl7bGV0IGg9Yy5ieXRlTGVuZ3RoL2MuQllURVNfUEVSX0VMRU1FTlQ7Y29uc3QgbD1uZXcgVWludDhBcnJheShoKTtmb3IoOy0taD49MDspe2xldCB1PWNbaF07dTwwP3U9MDp1PjEmJih1PTEpLGxbaF09dSoyNTV9Yz1sfWNvbnN0IHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7ci53aWR0aD1pLHIuaGVpZ2h0PXM7Y29uc3Qgbj1yLmdldENvbnRleHQoIjJkIik7aWYoIW4pcmV0dXJuIG51bGw7Y29uc3QgYT1uLmNyZWF0ZUltYWdlRGF0YShpLHMpO2lmKGEuZGF0YS5zZXQoYyksbi5wdXRJbWFnZURhdGEoYSwwLDApLHQpe2NvbnN0IGg9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7aC53aWR0aD1pLGguaGVpZ2h0PXM7Y29uc3QgbD1oLmdldENvbnRleHQoIjJkIik7cmV0dXJuIGw/KGwudHJhbnNsYXRlKDAscyksbC5zY2FsZSgxLC0xKSxsLmRyYXdJbWFnZShyLDAsMCksaC50b0RhdGFVUkwoImltYWdlL3BuZyIpKTpudWxsfXJldHVybiByLnRvRGF0YVVSTCgiaW1hZ2UvcG5nIil9ZnVuY3Rpb24gcW4oYyxlPTAsdD0wKXtjb25zdCBpPWMuZ2V0SW50ZXJuYWxUZXh0dXJlKCk7aWYoIWkpcmV0dXJuIG51bGw7Y29uc3Qgcz1jLl9yZWFkUGl4ZWxzU3luYyhlLHQpO3JldHVybiBzP0ZyKHMsYy5nZXRTaXplKCksaS5pbnZlcnRZKTpudWxsfWFzeW5jIGZ1bmN0aW9uIGpuKGMsZT0wLHQ9MCl7Y29uc3QgaT1jLmdldEludGVybmFsVGV4dHVyZSgpO2lmKCFpKXJldHVybiBudWxsO2NvbnN0IHM9YXdhaXQgYy5yZWFkUGl4ZWxzKGUsdCk7cmV0dXJuIHM/RnIocyxjLmdldFNpemUoKSxpLmludmVydFkpOm51bGx9Y2xhc3MgTiBleHRlbmRzIFJle2NvbnN0cnVjdG9yKGUsdCxpLHMscj1OLlRSSUxJTkVBUl9TQU1QTElOR01PREUsbj1udWxsLGE9bnVsbCxvPW51bGwsaD0hMSxsLHUsZCxmLF8pe3ZhciBFLG0sdixTLHksQSxDLGIsTTtzdXBlcih0KSx0aGlzLnVybD1udWxsLHRoaXMudU9mZnNldD0wLHRoaXMudk9mZnNldD0wLHRoaXMudVNjYWxlPTEsdGhpcy52U2NhbGU9MSx0aGlzLnVBbmc9MCx0aGlzLnZBbmc9MCx0aGlzLndBbmc9MCx0aGlzLnVSb3RhdGlvbkNlbnRlcj0uNSx0aGlzLnZSb3RhdGlvbkNlbnRlcj0uNSx0aGlzLndSb3RhdGlvbkNlbnRlcj0uNSx0aGlzLmhvbW9nZW5lb3VzUm90YXRpb25JblVWVHJhbnNmb3JtPSExLHRoaXMuaW5zcGVjdGFibGVDdXN0b21Qcm9wZXJ0aWVzPW51bGwsdGhpcy5fbm9NaXBtYXA9ITEsdGhpcy5faW52ZXJ0WT0hMSx0aGlzLl9yb3dHZW5lcmF0aW9uTWF0cml4PW51bGwsdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeD1udWxsLHRoaXMuX3Byb2plY3Rpb25Nb2RlTWF0cml4PW51bGwsdGhpcy5fdDA9bnVsbCx0aGlzLl90MT1udWxsLHRoaXMuX3QyPW51bGwsdGhpcy5fY2FjaGVkVU9mZnNldD0tMSx0aGlzLl9jYWNoZWRWT2Zmc2V0PS0xLHRoaXMuX2NhY2hlZFVTY2FsZT0wLHRoaXMuX2NhY2hlZFZTY2FsZT0wLHRoaXMuX2NhY2hlZFVBbmc9LTEsdGhpcy5fY2FjaGVkVkFuZz0tMSx0aGlzLl9jYWNoZWRXQW5nPS0xLHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25Qcm9qZWN0aW9uTWF0cml4SWQ9LTEsdGhpcy5fY2FjaGVkVVJvdGF0aW9uQ2VudGVyPS0xLHRoaXMuX2NhY2hlZFZSb3RhdGlvbkNlbnRlcj0tMSx0aGlzLl9jYWNoZWRXUm90YXRpb25DZW50ZXI9LTEsdGhpcy5fY2FjaGVkSG9tb2dlbmVvdXNSb3RhdGlvbkluVVZUcmFuc2Zvcm09ITEsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXg9bnVsbCx0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVU9mZnNldD0tMSx0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVk9mZnNldD0tMSx0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVVNjYWxlPTAsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblZTY2FsZT0wLHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25Db29yZGluYXRlc01vZGU9LTEsdGhpcy5fYnVmZmVyPW51bGwsdGhpcy5fZGVsZXRlQnVmZmVyPSExLHRoaXMuX2Zvcm1hdD1udWxsLHRoaXMuX2RlbGF5ZWRPbkxvYWQ9bnVsbCx0aGlzLl9kZWxheWVkT25FcnJvcj1udWxsLHRoaXMub25Mb2FkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9pc0Jsb2NraW5nPSEwLHRoaXMubmFtZT1lfHwiIix0aGlzLnVybD1lO2xldCBMLGs9ITEsdz1udWxsO3R5cGVvZiBpPT0ib2JqZWN0IiYmaSE9PW51bGw/KEw9KEU9aS5ub01pcG1hcCkhPT1udWxsJiZFIT09dm9pZCAwP0U6ITEscz0obT1pLmludmVydFkpIT09bnVsbCYmbSE9PXZvaWQgMD9tOiFmdC5Vc2VPcGVuR0xPcmllbnRhdGlvbkZvclVWLHI9KHY9aS5zYW1wbGluZ01vZGUpIT09bnVsbCYmdiE9PXZvaWQgMD92Ok4uVFJJTElORUFSX1NBTVBMSU5HTU9ERSxuPShTPWkub25Mb2FkKSE9PW51bGwmJlMhPT12b2lkIDA/UzpudWxsLGE9KHk9aS5vbkVycm9yKSE9PW51bGwmJnkhPT12b2lkIDA/eTpudWxsLG89KEE9aS5idWZmZXIpIT09bnVsbCYmQSE9PXZvaWQgMD9BOm51bGwsaD0oQz1pLmRlbGV0ZUJ1ZmZlcikhPT1udWxsJiZDIT09dm9pZCAwP0M6ITEsbD1pLmZvcm1hdCx1PWkubWltZVR5cGUsZD1pLmxvYWRlck9wdGlvbnMsZj1pLmNyZWF0aW9uRmxhZ3Msaz0oYj1pLnVzZVNSR0JCdWZmZXIpIT09bnVsbCYmYiE9PXZvaWQgMD9iOiExLHc9KE09aS5pbnRlcm5hbFRleHR1cmUpIT09bnVsbCYmTSE9PXZvaWQgMD9NOm51bGwpOkw9ISFpLHRoaXMuX25vTWlwbWFwPUwsdGhpcy5faW52ZXJ0WT1zPT09dm9pZCAwPyFmdC5Vc2VPcGVuR0xPcmllbnRhdGlvbkZvclVWOnMsdGhpcy5faW5pdGlhbFNhbXBsaW5nTW9kZT1yLHRoaXMuX2J1ZmZlcj1vLHRoaXMuX2RlbGV0ZUJ1ZmZlcj1oLHRoaXMuX21pbWVUeXBlPXUsdGhpcy5fbG9hZGVyT3B0aW9ucz1kLHRoaXMuX2NyZWF0aW9uRmxhZ3M9Zix0aGlzLl91c2VTUkdCQnVmZmVyPWssdGhpcy5fZm9yY2VkRXh0ZW5zaW9uPV8sbCYmKHRoaXMuX2Zvcm1hdD1sKTtjb25zdCBkZT10aGlzLmdldFNjZW5lKCksY2U9dGhpcy5fZ2V0RW5naW5lKCk7aWYoIWNlKXJldHVybjtjZS5vbkJlZm9yZVRleHR1cmVJbml0T2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyk7Y29uc3Qgc2U9KCk9Pnt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5faW52ZXJ0VlNjYWxlJiYodGhpcy52U2NhbGUqPS0xLHRoaXMudk9mZnNldCs9MSksdGhpcy5fdGV4dHVyZS5fY2FjaGVkV3JhcFUhPT1udWxsJiYodGhpcy53cmFwVT10aGlzLl90ZXh0dXJlLl9jYWNoZWRXcmFwVSx0aGlzLl90ZXh0dXJlLl9jYWNoZWRXcmFwVT1udWxsKSx0aGlzLl90ZXh0dXJlLl9jYWNoZWRXcmFwViE9PW51bGwmJih0aGlzLndyYXBWPXRoaXMuX3RleHR1cmUuX2NhY2hlZFdyYXBWLHRoaXMuX3RleHR1cmUuX2NhY2hlZFdyYXBWPW51bGwpLHRoaXMuX3RleHR1cmUuX2NhY2hlZFdyYXBSIT09bnVsbCYmKHRoaXMud3JhcFI9dGhpcy5fdGV4dHVyZS5fY2FjaGVkV3JhcFIsdGhpcy5fdGV4dHVyZS5fY2FjaGVkV3JhcFI9bnVsbCkpLHRoaXMub25Mb2FkT2JzZXJ2YWJsZS5oYXNPYnNlcnZlcnMoKSYmdGhpcy5vbkxvYWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSxuJiZuKCksIXRoaXMuaXNCbG9ja2luZyYmZGUmJmRlLnJlc2V0Q2FjaGVkTWF0ZXJpYWwoKX0sdGU9KEZlLHdlKT0+e3RoaXMuX2xvYWRpbmdFcnJvcj0hMCx0aGlzLl9lcnJvck9iamVjdD17bWVzc2FnZTpGZSxleGNlcHRpb246d2V9LGEmJmEoRmUsd2UpLE4uT25UZXh0dXJlTG9hZEVycm9yT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyl9O2lmKCF0aGlzLnVybCYmIXcpe3RoaXMuX2RlbGF5ZWRPbkxvYWQ9c2UsdGhpcy5fZGVsYXllZE9uRXJyb3I9dGU7cmV0dXJufWlmKHRoaXMuX3RleHR1cmU9dz8/dGhpcy5fZ2V0RnJvbUNhY2hlKHRoaXMudXJsLEwscix0aGlzLl9pbnZlcnRZLGspLHRoaXMuX3RleHR1cmUpaWYodGhpcy5fdGV4dHVyZS5pc1JlYWR5KVhpLlNldEltbWVkaWF0ZSgoKT0+c2UoKSk7ZWxzZXtjb25zdCBGZT10aGlzLl90ZXh0dXJlLm9uTG9hZGVkT2JzZXJ2YWJsZS5hZGQoc2UpO3RoaXMuX3RleHR1cmUub25FcnJvck9ic2VydmFibGUuYWRkKHdlPT57dmFyIEhlO3RlKHdlLm1lc3NhZ2Usd2UuZXhjZXB0aW9uKSwoSGU9dGhpcy5fdGV4dHVyZSk9PT1udWxsfHxIZT09PXZvaWQgMHx8SGUub25Mb2FkZWRPYnNlcnZhYmxlLnJlbW92ZShGZSl9KX1lbHNlIGlmKCFkZXx8IWRlLnVzZURlbGF5ZWRUZXh0dXJlTG9hZGluZyl7dHJ5e3RoaXMuX3RleHR1cmU9Y2UuY3JlYXRlVGV4dHVyZSh0aGlzLnVybCxMLHRoaXMuX2ludmVydFksZGUscixzZSx0ZSx0aGlzLl9idWZmZXIsdm9pZCAwLHRoaXMuX2Zvcm1hdCx0aGlzLl9mb3JjZWRFeHRlbnNpb24sdSxkLGYsayl9Y2F0Y2goRmUpe3Rocm93IHRlKCJlcnJvciBsb2FkaW5nIixGZSksRmV9aCYmKHRoaXMuX2J1ZmZlcj1udWxsKX1lbHNlIHRoaXMuZGVsYXlMb2FkU3RhdGU9NCx0aGlzLl9kZWxheWVkT25Mb2FkPXNlLHRoaXMuX2RlbGF5ZWRPbkVycm9yPXRlfWdldCBub01pcG1hcCgpe3JldHVybiB0aGlzLl9ub01pcG1hcH1nZXQgbWltZVR5cGUoKXtyZXR1cm4gdGhpcy5fbWltZVR5cGV9c2V0IGlzQmxvY2tpbmcoZSl7dGhpcy5faXNCbG9ja2luZz1lfWdldCBpc0Jsb2NraW5nKCl7cmV0dXJuIHRoaXMuX2lzQmxvY2tpbmd9Z2V0IGludmVydFkoKXtyZXR1cm4gdGhpcy5faW52ZXJ0WX11cGRhdGVVUkwoZSx0PW51bGwsaSxzKXt0aGlzLnVybCYmKHRoaXMucmVsZWFzZUludGVybmFsVGV4dHVyZSgpLHRoaXMuZ2V0U2NlbmUoKS5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSksKCF0aGlzLm5hbWV8fHRoaXMubmFtZS5zdGFydHNXaXRoKCJkYXRhOiIpKSYmKHRoaXMubmFtZT1lKSx0aGlzLnVybD1lLHRoaXMuX2J1ZmZlcj10LHRoaXMuX2ZvcmNlZEV4dGVuc2lvbj1zLHRoaXMuZGVsYXlMb2FkU3RhdGU9NCxpJiYodGhpcy5fZGVsYXllZE9uTG9hZD1pKSx0aGlzLmRlbGF5TG9hZCgpfWRlbGF5TG9hZCgpe2lmKHRoaXMuZGVsYXlMb2FkU3RhdGUhPT00KXJldHVybjtjb25zdCBlPXRoaXMuZ2V0U2NlbmUoKTtlJiYodGhpcy5kZWxheUxvYWRTdGF0ZT0xLHRoaXMuX3RleHR1cmU9dGhpcy5fZ2V0RnJvbUNhY2hlKHRoaXMudXJsLHRoaXMuX25vTWlwbWFwLHRoaXMuc2FtcGxpbmdNb2RlLHRoaXMuX2ludmVydFksdGhpcy5fdXNlU1JHQkJ1ZmZlciksdGhpcy5fdGV4dHVyZT90aGlzLl9kZWxheWVkT25Mb2FkJiYodGhpcy5fdGV4dHVyZS5pc1JlYWR5P1hpLlNldEltbWVkaWF0ZSh0aGlzLl9kZWxheWVkT25Mb2FkKTp0aGlzLl90ZXh0dXJlLm9uTG9hZGVkT2JzZXJ2YWJsZS5hZGQodGhpcy5fZGVsYXllZE9uTG9hZCkpOih0aGlzLl90ZXh0dXJlPWUuZ2V0RW5naW5lKCkuY3JlYXRlVGV4dHVyZSh0aGlzLnVybCx0aGlzLl9ub01pcG1hcCx0aGlzLl9pbnZlcnRZLGUsdGhpcy5zYW1wbGluZ01vZGUsdGhpcy5fZGVsYXllZE9uTG9hZCx0aGlzLl9kZWxheWVkT25FcnJvcix0aGlzLl9idWZmZXIsbnVsbCx0aGlzLl9mb3JtYXQsdGhpcy5fZm9yY2VkRXh0ZW5zaW9uLHRoaXMuX21pbWVUeXBlLHRoaXMuX2xvYWRlck9wdGlvbnMsdGhpcy5fY3JlYXRpb25GbGFncyx0aGlzLl91c2VTUkdCQnVmZmVyKSx0aGlzLl9kZWxldGVCdWZmZXImJih0aGlzLl9idWZmZXI9bnVsbCkpLHRoaXMuX2RlbGF5ZWRPbkxvYWQ9bnVsbCx0aGlzLl9kZWxheWVkT25FcnJvcj1udWxsKX1fcHJlcGFyZVJvd0ZvclRleHR1cmVHZW5lcmF0aW9uKGUsdCxpLHMpe2UqPXRoaXMuX2NhY2hlZFVTY2FsZSx0Kj10aGlzLl9jYWNoZWRWU2NhbGUsZS09dGhpcy51Um90YXRpb25DZW50ZXIqdGhpcy5fY2FjaGVkVVNjYWxlLHQtPXRoaXMudlJvdGF0aW9uQ2VudGVyKnRoaXMuX2NhY2hlZFZTY2FsZSxpLT10aGlzLndSb3RhdGlvbkNlbnRlcixwLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGUsdCxpLHRoaXMuX3Jvd0dlbmVyYXRpb25NYXRyaXgscykscy54Kz10aGlzLnVSb3RhdGlvbkNlbnRlcip0aGlzLl9jYWNoZWRVU2NhbGUrdGhpcy5fY2FjaGVkVU9mZnNldCxzLnkrPXRoaXMudlJvdGF0aW9uQ2VudGVyKnRoaXMuX2NhY2hlZFZTY2FsZSt0aGlzLl9jYWNoZWRWT2Zmc2V0LHMueis9dGhpcy53Um90YXRpb25DZW50ZXJ9Y2hlY2tUcmFuc2Zvcm1zQXJlSWRlbnRpY2FsKGUpe3JldHVybiBlIT09bnVsbCYmdGhpcy51T2Zmc2V0PT09ZS51T2Zmc2V0JiZ0aGlzLnZPZmZzZXQ9PT1lLnZPZmZzZXQmJnRoaXMudVNjYWxlPT09ZS51U2NhbGUmJnRoaXMudlNjYWxlPT09ZS52U2NhbGUmJnRoaXMudUFuZz09PWUudUFuZyYmdGhpcy52QW5nPT09ZS52QW5nJiZ0aGlzLndBbmc9PT1lLndBbmd9Z2V0VGV4dHVyZU1hdHJpeChlPTEpe2lmKHRoaXMudU9mZnNldD09PXRoaXMuX2NhY2hlZFVPZmZzZXQmJnRoaXMudk9mZnNldD09PXRoaXMuX2NhY2hlZFZPZmZzZXQmJnRoaXMudVNjYWxlKmU9PT10aGlzLl9jYWNoZWRVU2NhbGUmJnRoaXMudlNjYWxlPT09dGhpcy5fY2FjaGVkVlNjYWxlJiZ0aGlzLnVBbmc9PT10aGlzLl9jYWNoZWRVQW5nJiZ0aGlzLnZBbmc9PT10aGlzLl9jYWNoZWRWQW5nJiZ0aGlzLndBbmc9PT10aGlzLl9jYWNoZWRXQW5nJiZ0aGlzLnVSb3RhdGlvbkNlbnRlcj09PXRoaXMuX2NhY2hlZFVSb3RhdGlvbkNlbnRlciYmdGhpcy52Um90YXRpb25DZW50ZXI9PT10aGlzLl9jYWNoZWRWUm90YXRpb25DZW50ZXImJnRoaXMud1JvdGF0aW9uQ2VudGVyPT09dGhpcy5fY2FjaGVkV1JvdGF0aW9uQ2VudGVyJiZ0aGlzLmhvbW9nZW5lb3VzUm90YXRpb25JblVWVHJhbnNmb3JtPT09dGhpcy5fY2FjaGVkSG9tb2dlbmVvdXNSb3RhdGlvbkluVVZUcmFuc2Zvcm0pcmV0dXJuIHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXg7dGhpcy5fY2FjaGVkVU9mZnNldD10aGlzLnVPZmZzZXQsdGhpcy5fY2FjaGVkVk9mZnNldD10aGlzLnZPZmZzZXQsdGhpcy5fY2FjaGVkVVNjYWxlPXRoaXMudVNjYWxlKmUsdGhpcy5fY2FjaGVkVlNjYWxlPXRoaXMudlNjYWxlLHRoaXMuX2NhY2hlZFVBbmc9dGhpcy51QW5nLHRoaXMuX2NhY2hlZFZBbmc9dGhpcy52QW5nLHRoaXMuX2NhY2hlZFdBbmc9dGhpcy53QW5nLHRoaXMuX2NhY2hlZFVSb3RhdGlvbkNlbnRlcj10aGlzLnVSb3RhdGlvbkNlbnRlcix0aGlzLl9jYWNoZWRWUm90YXRpb25DZW50ZXI9dGhpcy52Um90YXRpb25DZW50ZXIsdGhpcy5fY2FjaGVkV1JvdGF0aW9uQ2VudGVyPXRoaXMud1JvdGF0aW9uQ2VudGVyLHRoaXMuX2NhY2hlZEhvbW9nZW5lb3VzUm90YXRpb25JblVWVHJhbnNmb3JtPXRoaXMuaG9tb2dlbmVvdXNSb3RhdGlvbkluVVZUcmFuc2Zvcm0sKCF0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4fHwhdGhpcy5fcm93R2VuZXJhdGlvbk1hdHJpeCkmJih0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4PXguWmVybygpLHRoaXMuX3Jvd0dlbmVyYXRpb25NYXRyaXg9bmV3IHgsdGhpcy5fdDA9cC5aZXJvKCksdGhpcy5fdDE9cC5aZXJvKCksdGhpcy5fdDI9cC5aZXJvKCkpLHguUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZih0aGlzLnZBbmcsdGhpcy51QW5nLHRoaXMud0FuZyx0aGlzLl9yb3dHZW5lcmF0aW9uTWF0cml4KSx0aGlzLmhvbW9nZW5lb3VzUm90YXRpb25JblVWVHJhbnNmb3JtPyh4LlRyYW5zbGF0aW9uVG9SZWYoLXRoaXMuX2NhY2hlZFVSb3RhdGlvbkNlbnRlciwtdGhpcy5fY2FjaGVkVlJvdGF0aW9uQ2VudGVyLC10aGlzLl9jYWNoZWRXUm90YXRpb25DZW50ZXIsRC5NYXRyaXhbMF0pLHguVHJhbnNsYXRpb25Ub1JlZih0aGlzLl9jYWNoZWRVUm90YXRpb25DZW50ZXIsdGhpcy5fY2FjaGVkVlJvdGF0aW9uQ2VudGVyLHRoaXMuX2NhY2hlZFdSb3RhdGlvbkNlbnRlcixELk1hdHJpeFsxXSkseC5TY2FsaW5nVG9SZWYodGhpcy5fY2FjaGVkVVNjYWxlLHRoaXMuX2NhY2hlZFZTY2FsZSwwLEQuTWF0cml4WzJdKSx4LlRyYW5zbGF0aW9uVG9SZWYodGhpcy5fY2FjaGVkVU9mZnNldCx0aGlzLl9jYWNoZWRWT2Zmc2V0LDAsRC5NYXRyaXhbM10pLEQuTWF0cml4WzBdLm11bHRpcGx5VG9SZWYodGhpcy5fcm93R2VuZXJhdGlvbk1hdHJpeCx0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4KSx0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4Lm11bHRpcGx5VG9SZWYoRC5NYXRyaXhbMV0sdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeCksdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeC5tdWx0aXBseVRvUmVmKEQuTWF0cml4WzJdLHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgpLHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubXVsdGlwbHlUb1JlZihELk1hdHJpeFszXSx0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4KSx0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4LnNldFJvd0Zyb21GbG9hdHMoMix0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4Lm1bMTJdLHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubVsxM10sdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeC5tWzE0XSwxKSk6KHRoaXMuX3ByZXBhcmVSb3dGb3JUZXh0dXJlR2VuZXJhdGlvbigwLDAsMCx0aGlzLl90MCksdGhpcy5fcHJlcGFyZVJvd0ZvclRleHR1cmVHZW5lcmF0aW9uKDEsMCwwLHRoaXMuX3QxKSx0aGlzLl9wcmVwYXJlUm93Rm9yVGV4dHVyZUdlbmVyYXRpb24oMCwxLDAsdGhpcy5fdDIpLHRoaXMuX3QxLnN1YnRyYWN0SW5QbGFjZSh0aGlzLl90MCksdGhpcy5fdDIuc3VidHJhY3RJblBsYWNlKHRoaXMuX3QwKSx4LkZyb21WYWx1ZXNUb1JlZih0aGlzLl90MS54LHRoaXMuX3QxLnksdGhpcy5fdDEueiwwLHRoaXMuX3QyLngsdGhpcy5fdDIueSx0aGlzLl90Mi56LDAsdGhpcy5fdDAueCx0aGlzLl90MC55LHRoaXMuX3QwLnosMCwwLDAsMCwxLHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgpKTtjb25zdCB0PXRoaXMuZ2V0U2NlbmUoKTtyZXR1cm4gdD8odGhpcy5vcHRpbWl6ZVVWQWxsb2NhdGlvbiYmdC5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxLGk9PmkuaGFzVGV4dHVyZSh0aGlzKSksdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeCk6dGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeH1nZXRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeCgpe2NvbnN0IGU9dGhpcy5nZXRTY2VuZSgpO2lmKCFlKXJldHVybiB0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeDtpZih0aGlzLnVPZmZzZXQ9PT10aGlzLl9jYWNoZWRSZWZsZWN0aW9uVU9mZnNldCYmdGhpcy52T2Zmc2V0PT09dGhpcy5fY2FjaGVkUmVmbGVjdGlvblZPZmZzZXQmJnRoaXMudVNjYWxlPT09dGhpcy5fY2FjaGVkUmVmbGVjdGlvblVTY2FsZSYmdGhpcy52U2NhbGU9PT10aGlzLl9jYWNoZWRSZWZsZWN0aW9uVlNjYWxlJiZ0aGlzLmNvb3JkaW5hdGVzTW9kZT09PXRoaXMuX2NhY2hlZFJlZmxlY3Rpb25Db29yZGluYXRlc01vZGUpaWYodGhpcy5jb29yZGluYXRlc01vZGU9PT1OLlBST0pFQ1RJT05fTU9ERSl7aWYodGhpcy5fY2FjaGVkUmVmbGVjdGlvblByb2plY3Rpb25NYXRyaXhJZD09PWUuZ2V0UHJvamVjdGlvbk1hdHJpeCgpLnVwZGF0ZUZsYWcpcmV0dXJuIHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4fWVsc2UgcmV0dXJuIHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4O3RoaXMuX2NhY2hlZFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4fHwodGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXg9eC5aZXJvKCkpLHRoaXMuX3Byb2plY3Rpb25Nb2RlTWF0cml4fHwodGhpcy5fcHJvamVjdGlvbk1vZGVNYXRyaXg9eC5aZXJvKCkpO2NvbnN0IHQ9dGhpcy5fY2FjaGVkUmVmbGVjdGlvbkNvb3JkaW5hdGVzTW9kZSE9PXRoaXMuY29vcmRpbmF0ZXNNb2RlO3N3aXRjaCh0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVU9mZnNldD10aGlzLnVPZmZzZXQsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblZPZmZzZXQ9dGhpcy52T2Zmc2V0LHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25VU2NhbGU9dGhpcy51U2NhbGUsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblZTY2FsZT10aGlzLnZTY2FsZSx0aGlzLl9jYWNoZWRSZWZsZWN0aW9uQ29vcmRpbmF0ZXNNb2RlPXRoaXMuY29vcmRpbmF0ZXNNb2RlLHRoaXMuY29vcmRpbmF0ZXNNb2RlKXtjYXNlIE4uUExBTkFSX01PREU6e3guSWRlbnRpdHlUb1JlZih0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeCksdGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXhbMF09dGhpcy51U2NhbGUsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXhbNV09dGhpcy52U2NhbGUsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXhbMTJdPXRoaXMudU9mZnNldCx0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeFsxM109dGhpcy52T2Zmc2V0O2JyZWFrfWNhc2UgTi5QUk9KRUNUSU9OX01PREU6e3guRnJvbVZhbHVlc1RvUmVmKC41LDAsMCwwLDAsLS41LDAsMCwwLDAsMCwwLC41LC41LDEsMSx0aGlzLl9wcm9qZWN0aW9uTW9kZU1hdHJpeCk7Y29uc3QgaT1lLmdldFByb2plY3Rpb25NYXRyaXgoKTt0aGlzLl9jYWNoZWRSZWZsZWN0aW9uUHJvamVjdGlvbk1hdHJpeElkPWkudXBkYXRlRmxhZyxpLm11bHRpcGx5VG9SZWYodGhpcy5fcHJvamVjdGlvbk1vZGVNYXRyaXgsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXgpO2JyZWFrfWRlZmF1bHQ6eC5JZGVudGl0eVRvUmVmKHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4KTticmVha31yZXR1cm4gdCYmZS5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxLGk9PmkuZ2V0QWN0aXZlVGV4dHVyZXMoKS5pbmRleE9mKHRoaXMpIT09LTEpLHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4fWNsb25lKCl7Y29uc3QgZT17bm9NaXBtYXA6dGhpcy5fbm9NaXBtYXAsaW52ZXJ0WTp0aGlzLl9pbnZlcnRZLHNhbXBsaW5nTW9kZTp0aGlzLnNhbXBsaW5nTW9kZSxvbkxvYWQ6dm9pZCAwLG9uRXJyb3I6dm9pZCAwLGJ1ZmZlcjp0aGlzLl90ZXh0dXJlP3RoaXMuX3RleHR1cmUuX2J1ZmZlcjp2b2lkIDAsZGVsZXRlQnVmZmVyOnRoaXMuX2RlbGV0ZUJ1ZmZlcixmb3JtYXQ6dGhpcy50ZXh0dXJlRm9ybWF0LG1pbWVUeXBlOnRoaXMubWltZVR5cGUsbG9hZGVyT3B0aW9uczp0aGlzLl9sb2FkZXJPcHRpb25zLGNyZWF0aW9uRmxhZ3M6dGhpcy5fY3JlYXRpb25GbGFncyx1c2VTUkdCQnVmZmVyOnRoaXMuX3VzZVNSR0JCdWZmZXJ9O3JldHVybiBhZS5DbG9uZSgoKT0+bmV3IE4odGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLnVybDpudWxsLHRoaXMuZ2V0U2NlbmUoKSxlKSx0aGlzKX1zZXJpYWxpemUoKXt2YXIgZSx0O2NvbnN0IGk9dGhpcy5uYW1lO04uU2VyaWFsaXplQnVmZmVyc3x8dGhpcy5uYW1lLnN0YXJ0c1dpdGgoImRhdGE6IikmJih0aGlzLm5hbWU9IiIpLHRoaXMubmFtZS5zdGFydHNXaXRoKCJkYXRhOiIpJiZ0aGlzLnVybD09PXRoaXMubmFtZSYmKHRoaXMudXJsPSIiKTtjb25zdCBzPXN1cGVyLnNlcmlhbGl6ZShOLl9TZXJpYWxpemVJbnRlcm5hbFRleHR1cmVVbmlxdWVJZCk7cmV0dXJuIHM/KChOLlNlcmlhbGl6ZUJ1ZmZlcnN8fE4uRm9yY2VTZXJpYWxpemVCdWZmZXJzKSYmKHR5cGVvZiB0aGlzLl9idWZmZXI9PSJzdHJpbmciJiZ0aGlzLl9idWZmZXIuc3Vic3RyKDAsNSk9PT0iZGF0YToiPyhzLmJhc2U2NFN0cmluZz10aGlzLl9idWZmZXIscy5uYW1lPXMubmFtZS5yZXBsYWNlKCJkYXRhOiIsIiIpKTp0aGlzLnVybCYmdGhpcy51cmwuc3RhcnRzV2l0aCgiZGF0YToiKSYmdGhpcy5fYnVmZmVyIGluc3RhbmNlb2YgVWludDhBcnJheT9zLmJhc2U2NFN0cmluZz0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LCIrc3IodGhpcy5fYnVmZmVyKTooTi5Gb3JjZVNlcmlhbGl6ZUJ1ZmZlcnN8fHRoaXMudXJsJiZ0aGlzLnVybC5zdGFydHNXaXRoKCJibG9iOiIpfHx0aGlzLl9mb3JjZVNlcmlhbGl6ZSkmJihzLmJhc2U2NFN0cmluZz0hdGhpcy5fZW5naW5lfHx0aGlzLl9lbmdpbmUuX2ZlYXR1cmVzLnN1cHBvcnRTeW5jVGV4dHVyZVJlYWQ/cW4odGhpcyk6am4odGhpcykpKSxzLmludmVydFk9dGhpcy5faW52ZXJ0WSxzLnNhbXBsaW5nTW9kZT10aGlzLnNhbXBsaW5nTW9kZSxzLl9jcmVhdGlvbkZsYWdzPXRoaXMuX2NyZWF0aW9uRmxhZ3Mscy5fdXNlU1JHQkJ1ZmZlcj10aGlzLl91c2VTUkdCQnVmZmVyLE4uX1NlcmlhbGl6ZUludGVybmFsVGV4dHVyZVVuaXF1ZUlkJiYocy5pbnRlcm5hbFRleHR1cmVVbmlxdWVJZD0odD0oZT10aGlzLl90ZXh0dXJlKT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUudW5pcXVlSWQpIT09bnVsbCYmdCE9PXZvaWQgMD90OnZvaWQgMCksdGhpcy5uYW1lPWkscyk6bnVsbH1nZXRDbGFzc05hbWUoKXtyZXR1cm4iVGV4dHVyZSJ9ZGlzcG9zZSgpe3N1cGVyLmRpc3Bvc2UoKSx0aGlzLm9uTG9hZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9kZWxheWVkT25Mb2FkPW51bGwsdGhpcy5fZGVsYXllZE9uRXJyb3I9bnVsbCx0aGlzLl9idWZmZXI9bnVsbH1zdGF0aWMgUGFyc2UoZSx0LGkpe2lmKGUuY3VzdG9tVHlwZSl7Y29uc3QgaD1MaS5JbnN0YW50aWF0ZShlLmN1c3RvbVR5cGUpLlBhcnNlKGUsdCxpKTtyZXR1cm4gZS5zYW1wbGluZ01vZGUmJmgudXBkYXRlU2FtcGxpbmdNb2RlJiZoLl9zYW1wbGluZ01vZGUmJmguX3NhbXBsaW5nTW9kZSE9PWUuc2FtcGxpbmdNb2RlJiZoLnVwZGF0ZVNhbXBsaW5nTW9kZShlLnNhbXBsaW5nTW9kZSksaH1pZihlLmlzQ3ViZSYmIWUuaXNSZW5kZXJUYXJnZXQpcmV0dXJuIE4uX0N1YmVUZXh0dXJlUGFyc2VyKGUsdCxpKTtjb25zdCBzPWUuaW50ZXJuYWxUZXh0dXJlVW5pcXVlSWQhPT12b2lkIDA7aWYoIWUubmFtZSYmIWUuaXNSZW5kZXJUYXJnZXQmJiFzKXJldHVybiBudWxsO2xldCByO2lmKHMpe2NvbnN0IG89dC5nZXRFbmdpbmUoKS5nZXRMb2FkZWRUZXh0dXJlc0NhY2hlKCk7Zm9yKGNvbnN0IGggb2YgbylpZihoLnVuaXF1ZUlkPT09ZS5pbnRlcm5hbFRleHR1cmVVbmlxdWVJZCl7cj1oO2JyZWFrfX1jb25zdCBuPW89Pnt2YXIgaDtpZihvJiZvLl90ZXh0dXJlJiYoby5fdGV4dHVyZS5fY2FjaGVkV3JhcFU9bnVsbCxvLl90ZXh0dXJlLl9jYWNoZWRXcmFwVj1udWxsLG8uX3RleHR1cmUuX2NhY2hlZFdyYXBSPW51bGwpLGUuc2FtcGxpbmdNb2RlKXtjb25zdCBsPWUuc2FtcGxpbmdNb2RlO28mJm8uc2FtcGxpbmdNb2RlIT09bCYmby51cGRhdGVTYW1wbGluZ01vZGUobCl9aWYobyYmZS5hbmltYXRpb25zKWZvcihsZXQgbD0wO2w8ZS5hbmltYXRpb25zLmxlbmd0aDtsKyspe2NvbnN0IHU9ZS5hbmltYXRpb25zW2xdLGQ9cmkoIkJBQllMT04uQW5pbWF0aW9uIik7ZCYmby5hbmltYXRpb25zLnB1c2goZC5QYXJzZSh1KSl9cyYmIXImJigoaD1vPT1udWxsP3ZvaWQgMDpvLl90ZXh0dXJlKT09PW51bGx8fGg9PT12b2lkIDB8fGguX3NldFVuaXF1ZUlkKGUuaW50ZXJuYWxUZXh0dXJlVW5pcXVlSWQpKX07cmV0dXJuIGFlLlBhcnNlKCgpPT57dmFyIG8saCxsO2xldCB1PSEwO2lmKGUubm9NaXBtYXAmJih1PSExKSxlLm1pcnJvclBsYW5lKXtjb25zdCBkPU4uX0NyZWF0ZU1pcnJvcihlLm5hbWUsZS5yZW5kZXJUYXJnZXRTaXplLHQsdSk7cmV0dXJuIGQuX3dhaXRpbmdSZW5kZXJMaXN0PWUucmVuZGVyTGlzdCxkLm1pcnJvclBsYW5lPXh0LkZyb21BcnJheShlLm1pcnJvclBsYW5lKSxuKGQpLGR9ZWxzZSBpZihlLmlzUmVuZGVyVGFyZ2V0KXtsZXQgZD1udWxsO2lmKGUuaXNDdWJlKXtpZih0LnJlZmxlY3Rpb25Qcm9iZXMpZm9yKGxldCBmPTA7Zjx0LnJlZmxlY3Rpb25Qcm9iZXMubGVuZ3RoO2YrKyl7Y29uc3QgXz10LnJlZmxlY3Rpb25Qcm9iZXNbZl07aWYoXy5uYW1lPT09ZS5uYW1lKXJldHVybiBfLmN1YmVUZXh0dXJlfX1lbHNlIGQ9Ti5fQ3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZShlLm5hbWUsZS5yZW5kZXJUYXJnZXRTaXplLHQsdSwobz1lLl9jcmVhdGlvbkZsYWdzKSE9PW51bGwmJm8hPT12b2lkIDA/bzowKSxkLl93YWl0aW5nUmVuZGVyTGlzdD1lLnJlbmRlckxpc3Q7cmV0dXJuIG4oZCksZH1lbHNle2xldCBkO2lmKGUuYmFzZTY0U3RyaW5nJiYhcilkPU4uQ3JlYXRlRnJvbUJhc2U2NFN0cmluZyhlLmJhc2U2NFN0cmluZyxlLmJhc2U2NFN0cmluZyx0LCF1LGUuaW52ZXJ0WSxlLnNhbXBsaW5nTW9kZSwoKT0+e24oZCl9LChoPWUuX2NyZWF0aW9uRmxhZ3MpIT09bnVsbCYmaCE9PXZvaWQgMD9oOjAsKGw9ZS5fdXNlU1JHQkJ1ZmZlcikhPT1udWxsJiZsIT09dm9pZCAwP2w6ITEpLGQubmFtZT1lLm5hbWU7ZWxzZXtsZXQgZjtlLm5hbWUmJmUubmFtZS5pbmRleE9mKCI6Ly8iKT4wP2Y9ZS5uYW1lOmY9aStlLm5hbWUsZS51cmwmJihlLnVybC5zdGFydHNXaXRoKCJkYXRhOiIpfHxOLlVzZVNlcmlhbGl6ZWRVcmxJZkFueSkmJihmPWUudXJsKTtjb25zdCBfPXtub01pcG1hcDohdSxpbnZlcnRZOmUuaW52ZXJ0WSxzYW1wbGluZ01vZGU6ZS5zYW1wbGluZ01vZGUsb25Mb2FkOigpPT57bihkKX0saW50ZXJuYWxUZXh0dXJlOnJ9O2Q9bmV3IE4oZix0LF8pfXJldHVybiBkfX0sZSx0KX1zdGF0aWMgQ3JlYXRlRnJvbUJhc2U2NFN0cmluZyhlLHQsaSxzLHIsbj1OLlRSSUxJTkVBUl9TQU1QTElOR01PREUsYT1udWxsLG89bnVsbCxoPTUsbCl7cmV0dXJuIG5ldyBOKCJkYXRhOiIrdCxpLHMscixuLGEsbyxlLCExLGgsdm9pZCAwLHZvaWQgMCxsKX1zdGF0aWMgTG9hZEZyb21EYXRhU3RyaW5nKGUsdCxpLHM9ITEscixuPSEwLGE9Ti5UUklMSU5FQVJfU0FNUExJTkdNT0RFLG89bnVsbCxoPW51bGwsbD01LHUpe3JldHVybiBlLnN1YnN0cigwLDUpIT09ImRhdGE6IiYmKGU9ImRhdGE6IitlKSxuZXcgTihlLGkscixuLGEsbyxoLHQscyxsLHZvaWQgMCx2b2lkIDAsdSl9fU4uU2VyaWFsaXplQnVmZmVycz0hMCxOLkZvcmNlU2VyaWFsaXplQnVmZmVycz0hMSxOLk9uVGV4dHVyZUxvYWRFcnJvck9ic2VydmFibGU9bmV3IEYsTi5fU2VyaWFsaXplSW50ZXJuYWxUZXh0dXJlVW5pcXVlSWQ9ITEsTi5fQ3ViZVRleHR1cmVQYXJzZXI9KGMsZSx0KT0+e3Rocm93ICQoIkN1YmVUZXh0dXJlIil9LE4uX0NyZWF0ZU1pcnJvcj0oYyxlLHQsaSk9Pnt0aHJvdyAkKCJNaXJyb3JUZXh0dXJlIil9LE4uX0NyZWF0ZVJlbmRlclRhcmdldFRleHR1cmU9KGMsZSx0LGkscyk9Pnt0aHJvdyAkKCJSZW5kZXJUYXJnZXRUZXh0dXJlIil9LE4uTkVBUkVTVF9TQU1QTElOR01PREU9MSxOLk5FQVJFU1RfTkVBUkVTVF9NSVBMSU5FQVI9OCxOLkJJTElORUFSX1NBTVBMSU5HTU9ERT0yLE4uTElORUFSX0xJTkVBUl9NSVBORUFSRVNUPTExLE4uVFJJTElORUFSX1NBTVBMSU5HTU9ERT0zLE4uTElORUFSX0xJTkVBUl9NSVBMSU5FQVI9MyxOLk5FQVJFU1RfTkVBUkVTVF9NSVBORUFSRVNUPTQsTi5ORUFSRVNUX0xJTkVBUl9NSVBORUFSRVNUPTUsTi5ORUFSRVNUX0xJTkVBUl9NSVBMSU5FQVI9NixOLk5FQVJFU1RfTElORUFSPTcsTi5ORUFSRVNUX05FQVJFU1Q9MSxOLkxJTkVBUl9ORUFSRVNUX01JUE5FQVJFU1Q9OSxOLkxJTkVBUl9ORUFSRVNUX01JUExJTkVBUj0xMCxOLkxJTkVBUl9MSU5FQVI9MixOLkxJTkVBUl9ORUFSRVNUPTEyLE4uRVhQTElDSVRfTU9ERT0wLE4uU1BIRVJJQ0FMX01PREU9MSxOLlBMQU5BUl9NT0RFPTIsTi5DVUJJQ19NT0RFPTMsTi5QUk9KRUNUSU9OX01PREU9NCxOLlNLWUJPWF9NT0RFPTUsTi5JTlZDVUJJQ19NT0RFPTYsTi5FUVVJUkVDVEFOR1VMQVJfTU9ERT03LE4uRklYRURfRVFVSVJFQ1RBTkdVTEFSX01PREU9OCxOLkZJWEVEX0VRVUlSRUNUQU5HVUxBUl9NSVJST1JFRF9NT0RFPTksTi5DTEFNUF9BRERSRVNTTU9ERT0wLE4uV1JBUF9BRERSRVNTTU9ERT0xLE4uTUlSUk9SX0FERFJFU1NNT0RFPTIsTi5Vc2VTZXJpYWxpemVkVXJsSWZBbnk9ITEsVChbUigpXSxOLnByb3RvdHlwZSwidXJsIix2b2lkIDApLFQoW1IoKV0sTi5wcm90b3R5cGUsInVPZmZzZXQiLHZvaWQgMCksVChbUigpXSxOLnByb3RvdHlwZSwidk9mZnNldCIsdm9pZCAwKSxUKFtSKCldLE4ucHJvdG90eXBlLCJ1U2NhbGUiLHZvaWQgMCksVChbUigpXSxOLnByb3RvdHlwZSwidlNjYWxlIix2b2lkIDApLFQoW1IoKV0sTi5wcm90b3R5cGUsInVBbmciLHZvaWQgMCksVChbUigpXSxOLnByb3RvdHlwZSwidkFuZyIsdm9pZCAwKSxUKFtSKCldLE4ucHJvdG90eXBlLCJ3QW5nIix2b2lkIDApLFQoW1IoKV0sTi5wcm90b3R5cGUsInVSb3RhdGlvbkNlbnRlciIsdm9pZCAwKSxUKFtSKCldLE4ucHJvdG90eXBlLCJ2Um90YXRpb25DZW50ZXIiLHZvaWQgMCksVChbUigpXSxOLnByb3RvdHlwZSwid1JvdGF0aW9uQ2VudGVyIix2b2lkIDApLFQoW1IoKV0sTi5wcm90b3R5cGUsImhvbW9nZW5lb3VzUm90YXRpb25JblVWVHJhbnNmb3JtIix2b2lkIDApLFQoW1IoKV0sTi5wcm90b3R5cGUsImlzQmxvY2tpbmciLG51bGwpLGl0KCJCQUJZTE9OLlRleHR1cmUiLE4pLGFlLl9UZXh0dXJlUGFyc2VyPU4uUGFyc2U7Y2xhc3MgJG57Y29uc3RydWN0b3IoZSx0LGkscyl7dGhpcy5fdGV4dHVyZXM9bnVsbCx0aGlzLl9zYW1wbGVzPTEsdGhpcy5fYXR0YWNobWVudHM9bnVsbCx0aGlzLl9nZW5lcmF0ZVN0ZW5jaWxCdWZmZXI9ITEsdGhpcy5fZ2VuZXJhdGVEZXB0aEJ1ZmZlcj0hMSx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlV2l0aFN0ZW5jaWw9ITEsdGhpcy5faXNNdWx0aT1lLHRoaXMuX2lzQ3ViZT10LHRoaXMuX3NpemU9aSx0aGlzLl9lbmdpbmU9cyx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlPW51bGx9Z2V0IGRlcHRoU3RlbmNpbFRleHR1cmUoKXtyZXR1cm4gdGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZX1nZXQgZGVwdGhTdGVuY2lsVGV4dHVyZVdpdGhTdGVuY2lsKCl7cmV0dXJuIHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmVXaXRoU3RlbmNpbH1nZXQgaXNDdWJlKCl7cmV0dXJuIHRoaXMuX2lzQ3ViZX1nZXQgaXNNdWx0aSgpe3JldHVybiB0aGlzLl9pc011bHRpfWdldCBpczJEQXJyYXkoKXtyZXR1cm4gdGhpcy5sYXllcnM+MH1nZXQgc2l6ZSgpe3JldHVybiB0aGlzLndpZHRofWdldCB3aWR0aCgpe3JldHVybiB0aGlzLl9zaXplLndpZHRofHx0aGlzLl9zaXplfWdldCBoZWlnaHQoKXtyZXR1cm4gdGhpcy5fc2l6ZS5oZWlnaHR8fHRoaXMuX3NpemV9Z2V0IGxheWVycygpe3JldHVybiB0aGlzLl9zaXplLmxheWVyc3x8MH1nZXQgdGV4dHVyZSgpe3ZhciBlLHQ7cmV0dXJuKHQ9KGU9dGhpcy5fdGV4dHVyZXMpPT09bnVsbHx8ZT09PXZvaWQgMD92b2lkIDA6ZVswXSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6bnVsbH1nZXQgdGV4dHVyZXMoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZXN9Z2V0IHNhbXBsZXMoKXtyZXR1cm4gdGhpcy5fc2FtcGxlc31zZXRTYW1wbGVzKGUsdD0hMCxpPSExKXtpZih0aGlzLnNhbXBsZXM9PT1lJiYhaSlyZXR1cm4gZTtjb25zdCBzPXRoaXMuX2lzTXVsdGk/dGhpcy5fZW5naW5lLnVwZGF0ZU11bHRpcGxlUmVuZGVyVGFyZ2V0VGV4dHVyZVNhbXBsZUNvdW50KHRoaXMsZSx0KTp0aGlzLl9lbmdpbmUudXBkYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZVNhbXBsZUNvdW50KHRoaXMsZSk7cmV0dXJuIHRoaXMuX3NhbXBsZXM9ZSxzfXNldFRleHR1cmVzKGUpe0FycmF5LmlzQXJyYXkoZSk/dGhpcy5fdGV4dHVyZXM9ZTplP3RoaXMuX3RleHR1cmVzPVtlXTp0aGlzLl90ZXh0dXJlcz1udWxsfXNldFRleHR1cmUoZSx0PTAsaT0hMCl7dGhpcy5fdGV4dHVyZXN8fCh0aGlzLl90ZXh0dXJlcz1bXSksdGhpcy5fdGV4dHVyZXNbdF0mJmkmJnRoaXMuX3RleHR1cmVzW3RdLmRpc3Bvc2UoKSx0aGlzLl90ZXh0dXJlc1t0XT1lfWNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmUoZT0wLHQ9ITAsaT0hMSxzPTEscj0xNCl7dmFyIG47cmV0dXJuKG49dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZSk9PT1udWxsfHxuPT09dm9pZCAwfHxuLmRpc3Bvc2UoKSx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlV2l0aFN0ZW5jaWw9aSx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlPXRoaXMuX2VuZ2luZS5jcmVhdGVEZXB0aFN0ZW5jaWxUZXh0dXJlKHRoaXMuX3NpemUse2JpbGluZWFyRmlsdGVyaW5nOnQsY29tcGFyaXNvbkZ1bmN0aW9uOmUsZ2VuZXJhdGVTdGVuY2lsOmksaXNDdWJlOnRoaXMuX2lzQ3ViZSxzYW1wbGVzOnMsZGVwdGhUZXh0dXJlRm9ybWF0OnJ9LHRoaXMpLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmV9X3NoYXJlRGVwdGgoZSl7dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZSYmKGUuX2RlcHRoU3RlbmNpbFRleHR1cmUmJmUuX2RlcHRoU3RlbmNpbFRleHR1cmUuZGlzcG9zZSgpLGUuX2RlcHRoU3RlbmNpbFRleHR1cmU9dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZSx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlLmluY3JlbWVudFJlZmVyZW5jZXMoKSl9X3N3YXBBbmREaWUoZSl7dGhpcy50ZXh0dXJlJiZ0aGlzLnRleHR1cmUuX3N3YXBBbmREaWUoZSksdGhpcy5fdGV4dHVyZXM9bnVsbCx0aGlzLmRpc3Bvc2UoITApfV9jbG9uZVJlbmRlclRhcmdldFdyYXBwZXIoKXt2YXIgZSx0LGkscyxyLG47bGV0IGE9bnVsbDtpZih0aGlzLl9pc011bHRpKXtjb25zdCBvPXRoaXMudGV4dHVyZXM7aWYobyYmby5sZW5ndGg+MCl7bGV0IGg9ITEsbD1vLmxlbmd0aDtjb25zdCB1PW9bby5sZW5ndGgtMV0uX3NvdXJjZTsodT09PU5lLkRlcHRofHx1PT09TmUuRGVwdGhTdGVuY2lsKSYmKGg9ITAsbC0tKTtjb25zdCBkPVtdLGY9W107Zm9yKGxldCBtPTA7bTxsOysrbSl7Y29uc3Qgdj1vW21dO2QucHVzaCh2LnNhbXBsaW5nTW9kZSksZi5wdXNoKHYudHlwZSl9Y29uc3QgXz17c2FtcGxpbmdNb2RlczpkLGdlbmVyYXRlTWlwTWFwczpvWzBdLmdlbmVyYXRlTWlwTWFwcyxnZW5lcmF0ZURlcHRoQnVmZmVyOnRoaXMuX2dlbmVyYXRlRGVwdGhCdWZmZXIsZ2VuZXJhdGVTdGVuY2lsQnVmZmVyOnRoaXMuX2dlbmVyYXRlU3RlbmNpbEJ1ZmZlcixnZW5lcmF0ZURlcHRoVGV4dHVyZTpoLHR5cGVzOmYsdGV4dHVyZUNvdW50Omx9LEU9e3dpZHRoOnRoaXMud2lkdGgsaGVpZ2h0OnRoaXMuaGVpZ2h0fTthPXRoaXMuX2VuZ2luZS5jcmVhdGVNdWx0aXBsZVJlbmRlclRhcmdldChFLF8pfX1lbHNle2NvbnN0IG89e307aWYoby5nZW5lcmF0ZURlcHRoQnVmZmVyPXRoaXMuX2dlbmVyYXRlRGVwdGhCdWZmZXIsby5nZW5lcmF0ZU1pcE1hcHM9KHQ9KGU9dGhpcy50ZXh0dXJlKT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUuZ2VuZXJhdGVNaXBNYXBzKSE9PW51bGwmJnQhPT12b2lkIDA/dDohMSxvLmdlbmVyYXRlU3RlbmNpbEJ1ZmZlcj10aGlzLl9nZW5lcmF0ZVN0ZW5jaWxCdWZmZXIsby5zYW1wbGluZ01vZGU9KGk9dGhpcy50ZXh0dXJlKT09PW51bGx8fGk9PT12b2lkIDA/dm9pZCAwOmkuc2FtcGxpbmdNb2RlLG8udHlwZT0ocz10aGlzLnRleHR1cmUpPT09bnVsbHx8cz09PXZvaWQgMD92b2lkIDA6cy50eXBlLG8uZm9ybWF0PShyPXRoaXMudGV4dHVyZSk9PT1udWxsfHxyPT09dm9pZCAwP3ZvaWQgMDpyLmZvcm1hdCx0aGlzLmlzQ3ViZSlhPXRoaXMuX2VuZ2luZS5jcmVhdGVSZW5kZXJUYXJnZXRDdWJlVGV4dHVyZSh0aGlzLndpZHRoLG8pO2Vsc2V7Y29uc3QgaD17d2lkdGg6dGhpcy53aWR0aCxoZWlnaHQ6dGhpcy5oZWlnaHQsbGF5ZXJzOnRoaXMuaXMyREFycmF5PyhuPXRoaXMudGV4dHVyZSk9PT1udWxsfHxuPT09dm9pZCAwP3ZvaWQgMDpuLmRlcHRoOnZvaWQgMH07YT10aGlzLl9lbmdpbmUuY3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZShoLG8pfWEudGV4dHVyZS5pc1JlYWR5PSEwfXJldHVybiBhfV9zd2FwUmVuZGVyVGFyZ2V0V3JhcHBlcihlKXtpZih0aGlzLl90ZXh0dXJlcyYmZS5fdGV4dHVyZXMpZm9yKGxldCB0PTA7dDx0aGlzLl90ZXh0dXJlcy5sZW5ndGg7Kyt0KXRoaXMuX3RleHR1cmVzW3RdLl9zd2FwQW5kRGllKGUuX3RleHR1cmVzW3RdLCExKSxlLl90ZXh0dXJlc1t0XS5pc1JlYWR5PSEwO3RoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmUmJmUuX2RlcHRoU3RlbmNpbFRleHR1cmUmJih0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlLl9zd2FwQW5kRGllKGUuX2RlcHRoU3RlbmNpbFRleHR1cmUpLGUuX2RlcHRoU3RlbmNpbFRleHR1cmUuaXNSZWFkeT0hMCksdGhpcy5fdGV4dHVyZXM9bnVsbCx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlPW51bGx9X3JlYnVpbGQoKXtjb25zdCBlPXRoaXMuX2Nsb25lUmVuZGVyVGFyZ2V0V3JhcHBlcigpO2lmKGUpe2lmKHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmUpe2NvbnN0IHQ9dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZS5zYW1wbGluZ01vZGUsaT10PT09Mnx8dD09PTN8fHQ9PT0xMTtlLmNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmUodGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZS5fY29tcGFyaXNvbkZ1bmN0aW9uLGksdGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZVdpdGhTdGVuY2lsLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmUuc2FtcGxlcyl9dGhpcy5zYW1wbGVzPjEmJmUuc2V0U2FtcGxlcyh0aGlzLnNhbXBsZXMpLGUuX3N3YXBSZW5kZXJUYXJnZXRXcmFwcGVyKHRoaXMpLGUuZGlzcG9zZSgpfX1yZWxlYXNlVGV4dHVyZXMoKXt2YXIgZSx0O2lmKHRoaXMuX3RleHR1cmVzKWZvcihsZXQgaT0wOyh0PWk8KChlPXRoaXMuX3RleHR1cmVzKT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUubGVuZ3RoKSkhPT1udWxsJiZ0IT09dm9pZCAwJiZ0OysraSl0aGlzLl90ZXh0dXJlc1tpXS5kaXNwb3NlKCk7dGhpcy5fdGV4dHVyZXM9bnVsbH1kaXNwb3NlKGU9ITEpe3ZhciB0O2V8fCgodD10aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlKT09PW51bGx8fHQ9PT12b2lkIDB8fHQuZGlzcG9zZSgpLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmU9bnVsbCx0aGlzLnJlbGVhc2VUZXh0dXJlcygpKSx0aGlzLl9lbmdpbmUuX3JlbGVhc2VSZW5kZXJUYXJnZXRXcmFwcGVyKHRoaXMpfX1jbGFzcyBRbiBleHRlbmRzICRue2NvbnN0cnVjdG9yKGUsdCxpLHMscil7c3VwZXIoZSx0LGkscyksdGhpcy5fZnJhbWVidWZmZXI9bnVsbCx0aGlzLl9kZXB0aFN0ZW5jaWxCdWZmZXI9bnVsbCx0aGlzLl9NU0FBRnJhbWVidWZmZXI9bnVsbCx0aGlzLl9jb2xvclRleHR1cmVBcnJheT1udWxsLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmVBcnJheT1udWxsLHRoaXMuX2NvbnRleHQ9cn1fY2xvbmVSZW5kZXJUYXJnZXRXcmFwcGVyKCl7bGV0IGU9bnVsbDtyZXR1cm4gdGhpcy5fY29sb3JUZXh0dXJlQXJyYXkmJnRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmVBcnJheT8oZT10aGlzLl9lbmdpbmUuY3JlYXRlTXVsdGl2aWV3UmVuZGVyVGFyZ2V0VGV4dHVyZSh0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KSxlLnRleHR1cmUuaXNSZWFkeT0hMCk6ZT1zdXBlci5fY2xvbmVSZW5kZXJUYXJnZXRXcmFwcGVyKCksZX1fc3dhcFJlbmRlclRhcmdldFdyYXBwZXIoZSl7c3VwZXIuX3N3YXBSZW5kZXJUYXJnZXRXcmFwcGVyKGUpLGUuX2ZyYW1lYnVmZmVyPXRoaXMuX2ZyYW1lYnVmZmVyLGUuX2RlcHRoU3RlbmNpbEJ1ZmZlcj10aGlzLl9kZXB0aFN0ZW5jaWxCdWZmZXIsZS5fTVNBQUZyYW1lYnVmZmVyPXRoaXMuX01TQUFGcmFtZWJ1ZmZlcixlLl9jb2xvclRleHR1cmVBcnJheT10aGlzLl9jb2xvclRleHR1cmVBcnJheSxlLl9kZXB0aFN0ZW5jaWxUZXh0dXJlQXJyYXk9dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZUFycmF5LHRoaXMuX2ZyYW1lYnVmZmVyPXRoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlcj10aGlzLl9NU0FBRnJhbWVidWZmZXI9dGhpcy5fY29sb3JUZXh0dXJlQXJyYXk9dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZUFycmF5PW51bGx9X3NoYXJlRGVwdGgoZSl7c3VwZXIuX3NoYXJlRGVwdGgoZSk7Y29uc3QgdD10aGlzLl9jb250ZXh0LGk9dGhpcy5fZGVwdGhTdGVuY2lsQnVmZmVyLHM9ZS5fTVNBQUZyYW1lYnVmZmVyfHxlLl9mcmFtZWJ1ZmZlcjtlLl9kZXB0aFN0ZW5jaWxCdWZmZXImJnQuZGVsZXRlUmVuZGVyYnVmZmVyKGUuX2RlcHRoU3RlbmNpbEJ1ZmZlciksZS5fZGVwdGhTdGVuY2lsQnVmZmVyPXRoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlcix0aGlzLl9lbmdpbmUuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIocyksdC5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcih0LkZSQU1FQlVGRkVSLHQuREVQVEhfQVRUQUNITUVOVCx0LlJFTkRFUkJVRkZFUixpKSx0aGlzLl9lbmdpbmUuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIobnVsbCl9X2JpbmRUZXh0dXJlUmVuZGVyVGFyZ2V0KGUsdD0wLGk9LTEscz0wKXtpZighZS5faGFyZHdhcmVUZXh0dXJlKXJldHVybjtjb25zdCByPXRoaXMuX2NvbnRleHQsbj10aGlzLl9mcmFtZWJ1ZmZlcixhPXRoaXMuX2VuZ2luZS5fY3VycmVudEZyYW1lYnVmZmVyO3RoaXMuX2VuZ2luZS5fYmluZFVuYm91bmRGcmFtZWJ1ZmZlcihuKTtjb25zdCBvPXJbdGhpcy5fZW5naW5lLndlYkdMVmVyc2lvbj4xPyJDT0xPUl9BVFRBQ0hNRU5UIit0OiJDT0xPUl9BVFRBQ0hNRU5UIit0KyJfV0VCR0wiXSxoPWkhPT0tMT9yLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWCtpOnIuVEVYVFVSRV8yRDtyLmZyYW1lYnVmZmVyVGV4dHVyZTJEKHIuRlJBTUVCVUZGRVIsbyxoLGUuX2hhcmR3YXJlVGV4dHVyZS51bmRlcmx5aW5nUmVzb3VyY2UscyksdGhpcy5fZW5naW5lLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKGEpfXNldFRleHR1cmUoZSx0PTAsaT0hMCl7c3VwZXIuc2V0VGV4dHVyZShlLHQsaSksdGhpcy5fYmluZFRleHR1cmVSZW5kZXJUYXJnZXQoZSx0KX1kaXNwb3NlKGU9ITEpe2NvbnN0IHQ9dGhpcy5fY29udGV4dDtlfHwodGhpcy5fY29sb3JUZXh0dXJlQXJyYXkmJih0aGlzLl9jb250ZXh0LmRlbGV0ZVRleHR1cmUodGhpcy5fY29sb3JUZXh0dXJlQXJyYXkpLHRoaXMuX2NvbG9yVGV4dHVyZUFycmF5PW51bGwpLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmVBcnJheSYmKHRoaXMuX2NvbnRleHQuZGVsZXRlVGV4dHVyZSh0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlQXJyYXkpLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmVBcnJheT1udWxsKSksdGhpcy5fZnJhbWVidWZmZXImJih0LmRlbGV0ZUZyYW1lYnVmZmVyKHRoaXMuX2ZyYW1lYnVmZmVyKSx0aGlzLl9mcmFtZWJ1ZmZlcj1udWxsKSx0aGlzLl9kZXB0aFN0ZW5jaWxCdWZmZXImJih0LmRlbGV0ZVJlbmRlcmJ1ZmZlcih0aGlzLl9kZXB0aFN0ZW5jaWxCdWZmZXIpLHRoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlcj1udWxsKSx0aGlzLl9NU0FBRnJhbWVidWZmZXImJih0LmRlbGV0ZUZyYW1lYnVmZmVyKHRoaXMuX01TQUFGcmFtZWJ1ZmZlciksdGhpcy5fTVNBQUZyYW1lYnVmZmVyPW51bGwpLHN1cGVyLmRpc3Bvc2UoZSl9fW9lLnByb3RvdHlwZS5fY3JlYXRlSGFyZHdhcmVSZW5kZXJUYXJnZXRXcmFwcGVyPWZ1bmN0aW9uKGMsZSx0KXtjb25zdCBpPW5ldyBRbihjLGUsdCx0aGlzLHRoaXMuX2dsKTtyZXR1cm4gdGhpcy5fcmVuZGVyVGFyZ2V0V3JhcHBlckNhY2hlLnB1c2goaSksaX0sb2UucHJvdG90eXBlLmNyZWF0ZVJlbmRlclRhcmdldFRleHR1cmU9ZnVuY3Rpb24oYyxlKXt2YXIgdCxpO2NvbnN0IHM9dGhpcy5fY3JlYXRlSGFyZHdhcmVSZW5kZXJUYXJnZXRXcmFwcGVyKCExLCExLGMpO2xldCByPSEwLG49ITEsYT0hMSxvLGg9MTtlIT09dm9pZCAwJiZ0eXBlb2YgZT09Im9iamVjdCImJihyPSh0PWUuZ2VuZXJhdGVEZXB0aEJ1ZmZlcikhPT1udWxsJiZ0IT09dm9pZCAwP3Q6ITAsbj0hIWUuZ2VuZXJhdGVTdGVuY2lsQnVmZmVyLGE9ISFlLm5vQ29sb3JBdHRhY2htZW50LG89ZS5jb2xvckF0dGFjaG1lbnQsaD0oaT1lLnNhbXBsZXMpIT09bnVsbCYmaSE9PXZvaWQgMD9pOjEpO2NvbnN0IGw9b3x8KGE/bnVsbDp0aGlzLl9jcmVhdGVJbnRlcm5hbFRleHR1cmUoYyxlLCEwLE5lLlJlbmRlclRhcmdldCkpLHU9Yy53aWR0aHx8YyxkPWMuaGVpZ2h0fHxjLGY9dGhpcy5fY3VycmVudEZyYW1lYnVmZmVyLF89dGhpcy5fZ2wsRT1fLmNyZWF0ZUZyYW1lYnVmZmVyKCk7cmV0dXJuIHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIoRSkscy5fZGVwdGhTdGVuY2lsQnVmZmVyPXRoaXMuX3NldHVwRnJhbWVidWZmZXJEZXB0aEF0dGFjaG1lbnRzKG4scix1LGQpLGwmJiFsLmlzMkRBcnJheSYmXy5mcmFtZWJ1ZmZlclRleHR1cmUyRChfLkZSQU1FQlVGRkVSLF8uQ09MT1JfQVRUQUNITUVOVDAsXy5URVhUVVJFXzJELGwuX2hhcmR3YXJlVGV4dHVyZS51bmRlcmx5aW5nUmVzb3VyY2UsMCksdGhpcy5fYmluZFVuYm91bmRGcmFtZWJ1ZmZlcihmKSxzLl9mcmFtZWJ1ZmZlcj1FLHMuX2dlbmVyYXRlRGVwdGhCdWZmZXI9cixzLl9nZW5lcmF0ZVN0ZW5jaWxCdWZmZXI9bixzLnNldFRleHR1cmVzKGwpLHRoaXMudXBkYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZVNhbXBsZUNvdW50KHMsaCksc30sb2UucHJvdG90eXBlLmNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmU9ZnVuY3Rpb24oYyxlLHQpe2lmKGUuaXNDdWJlKXtjb25zdCBpPWMud2lkdGh8fGM7cmV0dXJuIHRoaXMuX2NyZWF0ZURlcHRoU3RlbmNpbEN1YmVUZXh0dXJlKGksZSx0KX1lbHNlIHJldHVybiB0aGlzLl9jcmVhdGVEZXB0aFN0ZW5jaWxUZXh0dXJlKGMsZSx0KX0sb2UucHJvdG90eXBlLl9jcmVhdGVEZXB0aFN0ZW5jaWxUZXh0dXJlPWZ1bmN0aW9uKGMsZSx0KXtjb25zdCBpPXRoaXMuX2dsLHM9Yy5sYXllcnN8fDAscj1zIT09MD9pLlRFWFRVUkVfMkRfQVJSQVk6aS5URVhUVVJFXzJELG49bmV3IE90KHRoaXMsTmUuRGVwdGhTdGVuY2lsKTtpZighdGhpcy5fY2Fwcy5kZXB0aFRleHR1cmVFeHRlbnNpb24pcmV0dXJuIE8uRXJyb3IoIkRlcHRoIHRleHR1cmUgaXMgbm90IHN1cHBvcnRlZCBieSB5b3VyIGJyb3dzZXIgb3IgaGFyZHdhcmUuIiksbjtjb25zdCBhPXtiaWxpbmVhckZpbHRlcmluZzohMSxjb21wYXJpc29uRnVuY3Rpb246MCxnZW5lcmF0ZVN0ZW5jaWw6ITEsLi4uZX07aWYodGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShyLG4sITApLHRoaXMuX3NldHVwRGVwdGhTdGVuY2lsVGV4dHVyZShuLGMsYS5nZW5lcmF0ZVN0ZW5jaWwsYS5jb21wYXJpc29uRnVuY3Rpb249PT0wPyExOmEuYmlsaW5lYXJGaWx0ZXJpbmcsYS5jb21wYXJpc29uRnVuY3Rpb24sYS5zYW1wbGVzKSxhLmRlcHRoVGV4dHVyZUZvcm1hdCE9PXZvaWQgMCl7aWYoYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xNSYmYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xNiYmYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xNyYmYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xMyYmYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xNCYmYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xOClyZXR1cm4gTy5FcnJvcigiRGVwdGggdGV4dHVyZSBmb3JtYXQgaXMgbm90IHN1cHBvcnRlZC4iKSxuO24uZm9ybWF0PWEuZGVwdGhUZXh0dXJlRm9ybWF0fWVsc2Ugbi5mb3JtYXQ9YS5nZW5lcmF0ZVN0ZW5jaWw/MTM6MTY7Y29uc3Qgbz1uLmZvcm1hdD09PTE3fHxuLmZvcm1hdD09PTEzfHxuLmZvcm1hdD09PTE4O3QuX2RlcHRoU3RlbmNpbFRleHR1cmU9bix0Ll9kZXB0aFN0ZW5jaWxUZXh0dXJlV2l0aFN0ZW5jaWw9bztsZXQgaD1pLlVOU0lHTkVEX0lOVDtuLmZvcm1hdD09PTE1P2g9aS5VTlNJR05FRF9TSE9SVDpuLmZvcm1hdD09PTE3fHxuLmZvcm1hdD09PTEzP2g9aS5VTlNJR05FRF9JTlRfMjRfODpuLmZvcm1hdD09PTE0P2g9aS5GTE9BVDpuLmZvcm1hdD09PTE4JiYoaD1pLkZMT0FUXzMyX1VOU0lHTkVEX0lOVF8yNF84X1JFVik7Y29uc3QgbD1vP2kuREVQVEhfU1RFTkNJTDppLkRFUFRIX0NPTVBPTkVOVDtsZXQgdT1sO3RoaXMud2ViR0xWZXJzaW9uPjEmJihuLmZvcm1hdD09PTE1P3U9aS5ERVBUSF9DT01QT05FTlQxNjpuLmZvcm1hdD09PTE2P3U9aS5ERVBUSF9DT01QT05FTlQyNDpuLmZvcm1hdD09PTE3fHxuLmZvcm1hdD09PTEzP3U9aS5ERVBUSDI0X1NURU5DSUw4Om4uZm9ybWF0PT09MTQ/dT1pLkRFUFRIX0NPTVBPTkVOVDMyRjpuLmZvcm1hdD09PTE4JiYodT1pLkRFUFRIMzJGX1NURU5DSUw4KSksbi5pczJEQXJyYXk/aS50ZXhJbWFnZTNEKHIsMCx1LG4ud2lkdGgsbi5oZWlnaHQscywwLGwsaCxudWxsKTppLnRleEltYWdlMkQociwwLHUsbi53aWR0aCxuLmhlaWdodCwwLGwsaCxudWxsKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHIsbnVsbCksdGhpcy5faW50ZXJuYWxUZXh0dXJlc0NhY2hlLnB1c2gobik7Y29uc3QgZD10O2lmKGQuX2RlcHRoU3RlbmNpbEJ1ZmZlcil7Y29uc3QgZj10aGlzLl9jdXJyZW50RnJhbWVidWZmZXI7dGhpcy5fYmluZFVuYm91bmRGcmFtZWJ1ZmZlcihkLl9mcmFtZWJ1ZmZlciksaS5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcihpLkZSQU1FQlVGRkVSLGkuREVQVEhfU1RFTkNJTF9BVFRBQ0hNRU5ULGkuUkVOREVSQlVGRkVSLG51bGwpLGkuZnJhbWVidWZmZXJSZW5kZXJidWZmZXIoaS5GUkFNRUJVRkZFUixpLkRFUFRIX0FUVEFDSE1FTlQsaS5SRU5ERVJCVUZGRVIsbnVsbCksaS5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcihpLkZSQU1FQlVGRkVSLGkuU1RFTkNJTF9BVFRBQ0hNRU5ULGkuUkVOREVSQlVGRkVSLG51bGwpLHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIoZiksaS5kZWxldGVSZW5kZXJidWZmZXIoZC5fZGVwdGhTdGVuY2lsQnVmZmVyKSxkLl9kZXB0aFN0ZW5jaWxCdWZmZXI9bnVsbH1yZXR1cm4gbn0sb2UucHJvdG90eXBlLnVwZGF0ZVJlbmRlclRhcmdldFRleHR1cmVTYW1wbGVDb3VudD1mdW5jdGlvbihjLGUpe2lmKHRoaXMud2ViR0xWZXJzaW9uPDJ8fCFjfHwhYy50ZXh0dXJlKXJldHVybiAxO2lmKGMuc2FtcGxlcz09PWUpcmV0dXJuIGU7Y29uc3QgdD10aGlzLl9nbDtlPU1hdGgubWluKGUsdGhpcy5nZXRDYXBzKCkubWF4TVNBQVNhbXBsZXMpLGMuX2RlcHRoU3RlbmNpbEJ1ZmZlciYmKHQuZGVsZXRlUmVuZGVyYnVmZmVyKGMuX2RlcHRoU3RlbmNpbEJ1ZmZlciksYy5fZGVwdGhTdGVuY2lsQnVmZmVyPW51bGwpLGMuX01TQUFGcmFtZWJ1ZmZlciYmKHQuZGVsZXRlRnJhbWVidWZmZXIoYy5fTVNBQUZyYW1lYnVmZmVyKSxjLl9NU0FBRnJhbWVidWZmZXI9bnVsbCk7Y29uc3QgaT1jLnRleHR1cmUuX2hhcmR3YXJlVGV4dHVyZTtpZihpLl9NU0FBUmVuZGVyQnVmZmVyJiYodC5kZWxldGVSZW5kZXJidWZmZXIoaS5fTVNBQVJlbmRlckJ1ZmZlciksaS5fTVNBQVJlbmRlckJ1ZmZlcj1udWxsKSxlPjEmJnQucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlKXtjb25zdCBzPXQuY3JlYXRlRnJhbWVidWZmZXIoKTtpZighcyl0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBjcmVhdGUgbXVsdGkgc2FtcGxlZCBmcmFtZWJ1ZmZlciIpO2MuX01TQUFGcmFtZWJ1ZmZlcj1zLHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIoYy5fTVNBQUZyYW1lYnVmZmVyKTtjb25zdCByPXRoaXMuX2NyZWF0ZVJlbmRlckJ1ZmZlcihjLnRleHR1cmUud2lkdGgsYy50ZXh0dXJlLmhlaWdodCxlLC0xLHRoaXMuX2dldFJHQkFNdWx0aVNhbXBsZUJ1ZmZlckZvcm1hdChjLnRleHR1cmUudHlwZSksdC5DT0xPUl9BVFRBQ0hNRU5UMCwhMSk7aWYoIXIpdGhyb3cgbmV3IEVycm9yKCJVbmFibGUgdG8gY3JlYXRlIG11bHRpIHNhbXBsZWQgZnJhbWVidWZmZXIiKTtpLl9NU0FBUmVuZGVyQnVmZmVyPXJ9ZWxzZSB0aGlzLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKGMuX2ZyYW1lYnVmZmVyKTtyZXR1cm4gYy50ZXh0dXJlLnNhbXBsZXM9ZSxjLl9zYW1wbGVzPWUsYy5fZGVwdGhTdGVuY2lsQnVmZmVyPXRoaXMuX3NldHVwRnJhbWVidWZmZXJEZXB0aEF0dGFjaG1lbnRzKGMuX2dlbmVyYXRlU3RlbmNpbEJ1ZmZlcixjLl9nZW5lcmF0ZURlcHRoQnVmZmVyLGMudGV4dHVyZS53aWR0aCxjLnRleHR1cmUuaGVpZ2h0LGUpLHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIobnVsbCksZX0sb2UucHJvdG90eXBlLmNyZWF0ZVJlbmRlclRhcmdldEN1YmVUZXh0dXJlPWZ1bmN0aW9uKGMsZSl7Y29uc3QgdD10aGlzLl9jcmVhdGVIYXJkd2FyZVJlbmRlclRhcmdldFdyYXBwZXIoITEsITAsYyksaT17Z2VuZXJhdGVNaXBNYXBzOiEwLGdlbmVyYXRlRGVwdGhCdWZmZXI6ITAsZ2VuZXJhdGVTdGVuY2lsQnVmZmVyOiExLHR5cGU6MCxzYW1wbGluZ01vZGU6Myxmb3JtYXQ6NSwuLi5lfTtpLmdlbmVyYXRlU3RlbmNpbEJ1ZmZlcj1pLmdlbmVyYXRlRGVwdGhCdWZmZXImJmkuZ2VuZXJhdGVTdGVuY2lsQnVmZmVyLChpLnR5cGU9PT0xJiYhdGhpcy5fY2Fwcy50ZXh0dXJlRmxvYXRMaW5lYXJGaWx0ZXJpbmd8fGkudHlwZT09PTImJiF0aGlzLl9jYXBzLnRleHR1cmVIYWxmRmxvYXRMaW5lYXJGaWx0ZXJpbmcpJiYoaS5zYW1wbGluZ01vZGU9MSk7Y29uc3Qgcz10aGlzLl9nbCxyPW5ldyBPdCh0aGlzLE5lLlJlbmRlclRhcmdldCk7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShzLlRFWFRVUkVfQ1VCRV9NQVAsciwhMCk7Y29uc3Qgbj10aGlzLl9nZXRTYW1wbGluZ1BhcmFtZXRlcnMoaS5zYW1wbGluZ01vZGUsaS5nZW5lcmF0ZU1pcE1hcHMpO2kudHlwZT09PTEmJiF0aGlzLl9jYXBzLnRleHR1cmVGbG9hdCYmKGkudHlwZT0wLE8uV2FybigiRmxvYXQgdGV4dHVyZXMgYXJlIG5vdCBzdXBwb3J0ZWQuIEN1YmUgcmVuZGVyIHRhcmdldCBmb3JjZWQgdG8gVEVYVFVSRVRZUEVfVU5FU0lHTkVEX0JZVEUgdHlwZSIpKSxzLnRleFBhcmFtZXRlcmkocy5URVhUVVJFX0NVQkVfTUFQLHMuVEVYVFVSRV9NQUdfRklMVEVSLG4ubWFnKSxzLnRleFBhcmFtZXRlcmkocy5URVhUVVJFX0NVQkVfTUFQLHMuVEVYVFVSRV9NSU5fRklMVEVSLG4ubWluKSxzLnRleFBhcmFtZXRlcmkocy5URVhUVVJFX0NVQkVfTUFQLHMuVEVYVFVSRV9XUkFQX1Mscy5DTEFNUF9UT19FREdFKSxzLnRleFBhcmFtZXRlcmkocy5URVhUVVJFX0NVQkVfTUFQLHMuVEVYVFVSRV9XUkFQX1Qscy5DTEFNUF9UT19FREdFKTtmb3IobGV0IG89MDtvPDY7bysrKXMudGV4SW1hZ2UyRChzLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWCtvLDAsdGhpcy5fZ2V0UkdCQUJ1ZmZlckludGVybmFsU2l6ZWRGb3JtYXQoaS50eXBlLGkuZm9ybWF0KSxjLGMsMCx0aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChpLmZvcm1hdCksdGhpcy5fZ2V0V2ViR0xUZXh0dXJlVHlwZShpLnR5cGUpLG51bGwpO2NvbnN0IGE9cy5jcmVhdGVGcmFtZWJ1ZmZlcigpO3JldHVybiB0aGlzLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKGEpLHQuX2RlcHRoU3RlbmNpbEJ1ZmZlcj10aGlzLl9zZXR1cEZyYW1lYnVmZmVyRGVwdGhBdHRhY2htZW50cyhpLmdlbmVyYXRlU3RlbmNpbEJ1ZmZlcixpLmdlbmVyYXRlRGVwdGhCdWZmZXIsYyxjKSxpLmdlbmVyYXRlTWlwTWFwcyYmcy5nZW5lcmF0ZU1pcG1hcChzLlRFWFRVUkVfQ1VCRV9NQVApLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkocy5URVhUVVJFX0NVQkVfTUFQLG51bGwpLHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIobnVsbCksdC5fZnJhbWVidWZmZXI9YSx0Ll9nZW5lcmF0ZURlcHRoQnVmZmVyPWkuZ2VuZXJhdGVEZXB0aEJ1ZmZlcix0Ll9nZW5lcmF0ZVN0ZW5jaWxCdWZmZXI9aS5nZW5lcmF0ZVN0ZW5jaWxCdWZmZXIsci53aWR0aD1jLHIuaGVpZ2h0PWMsci5pc1JlYWR5PSEwLHIuaXNDdWJlPSEwLHIuc2FtcGxlcz0xLHIuZ2VuZXJhdGVNaXBNYXBzPWkuZ2VuZXJhdGVNaXBNYXBzLHIuc2FtcGxpbmdNb2RlPWkuc2FtcGxpbmdNb2RlLHIudHlwZT1pLnR5cGUsci5mb3JtYXQ9aS5mb3JtYXQsdGhpcy5faW50ZXJuYWxUZXh0dXJlc0NhY2hlLnB1c2gociksdC5zZXRUZXh0dXJlcyhyKSx0fTtjb25zdCBKbj0icG9zdHByb2Nlc3NWZXJ0ZXhTaGFkZXIiLGVhPWBhdHRyaWJ1dGUgdmVjMiBwb3NpdGlvbjsKdW5pZm9ybSB2ZWMyIHNjYWxlOwp2YXJ5aW5nIHZlYzIgdlVWOwpjb25zdCB2ZWMyIG1hZGQ9dmVjMigwLjUsMC41KTsKI2RlZmluZSBDVVNUT01fVkVSVEVYX0RFRklOSVRJT05TCnZvaWQgbWFpbih2b2lkKSB7CiNkZWZpbmUgQ1VTVE9NX1ZFUlRFWF9NQUlOX0JFR0lOCnZVVj0ocG9zaXRpb24qbWFkZCttYWRkKSpzY2FsZTsKZ2xfUG9zaXRpb249dmVjNChwb3NpdGlvbiwwLjAsMS4wKTsKI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fRU5ECn1gO1UuU2hhZGVyc1N0b3JlW0puXT1lYTtjb25zdCBXcz17cG9zaXRpb25zOlsxLDEsLTEsMSwtMSwtMSwxLC0xXSxpbmRpY2VzOlswLDEsMiwwLDIsM119O2NsYXNzIHRhe2NvbnN0cnVjdG9yKGUsdD1Xcyl7dmFyIGksczt0aGlzLl9mdWxsc2NyZWVuVmlld3BvcnQ9bmV3IEJpKDAsMCwxLDEpO2NvbnN0IHI9KGk9dC5wb3NpdGlvbnMpIT09bnVsbCYmaSE9PXZvaWQgMD9pOldzLnBvc2l0aW9ucyxuPShzPXQuaW5kaWNlcykhPT1udWxsJiZzIT09dm9pZCAwP3M6V3MuaW5kaWNlczt0aGlzLmVuZ2luZT1lLHRoaXMuX3ZlcnRleEJ1ZmZlcnM9e1tnLlBvc2l0aW9uS2luZF06bmV3IGcoZSxyLGcuUG9zaXRpb25LaW5kLCExLCExLDIpfSx0aGlzLl9pbmRleEJ1ZmZlcj1lLmNyZWF0ZUluZGV4QnVmZmVyKG4pLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXI9ZS5vbkNvbnRleHRSZXN0b3JlZE9ic2VydmFibGUuYWRkKCgpPT57dGhpcy5faW5kZXhCdWZmZXI9ZS5jcmVhdGVJbmRleEJ1ZmZlcihuKTtmb3IoY29uc3QgYSBpbiB0aGlzLl92ZXJ0ZXhCdWZmZXJzKXRoaXMuX3ZlcnRleEJ1ZmZlcnNbYV0uX3JlYnVpbGQoKX0pfXNldFZpZXdwb3J0KGU9dGhpcy5fZnVsbHNjcmVlblZpZXdwb3J0KXt0aGlzLmVuZ2luZS5zZXRWaWV3cG9ydChlKX1iaW5kQnVmZmVycyhlKXt0aGlzLmVuZ2luZS5iaW5kQnVmZmVycyh0aGlzLl92ZXJ0ZXhCdWZmZXJzLHRoaXMuX2luZGV4QnVmZmVyLGUpfWFwcGx5RWZmZWN0V3JhcHBlcihlKXt0aGlzLmVuZ2luZS5zZXRTdGF0ZSghMCksdGhpcy5lbmdpbmUuZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhUZXN0PSExLHRoaXMuZW5naW5lLnN0ZW5jaWxTdGF0ZS5zdGVuY2lsVGVzdD0hMSx0aGlzLmVuZ2luZS5lbmFibGVFZmZlY3QoZS5fZHJhd1dyYXBwZXIpLHRoaXMuYmluZEJ1ZmZlcnMoZS5lZmZlY3QpLGUub25BcHBseU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHt9KX1yZXN0b3JlU3RhdGVzKCl7dGhpcy5lbmdpbmUuZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhUZXN0PSEwLHRoaXMuZW5naW5lLnN0ZW5jaWxTdGF0ZS5zdGVuY2lsVGVzdD0hMH1kcmF3KCl7dGhpcy5lbmdpbmUuZHJhd0VsZW1lbnRzVHlwZSgwLDAsNil9X2lzUmVuZGVyVGFyZ2V0VGV4dHVyZShlKXtyZXR1cm4gZS5yZW5kZXJUYXJnZXQhPT12b2lkIDB9cmVuZGVyKGUsdD1udWxsKXtpZighZS5lZmZlY3QuaXNSZWFkeSgpKXJldHVybjt0aGlzLnNldFZpZXdwb3J0KCk7Y29uc3QgaT10PT09bnVsbD9udWxsOnRoaXMuX2lzUmVuZGVyVGFyZ2V0VGV4dHVyZSh0KT90LnJlbmRlclRhcmdldDp0O2kmJnRoaXMuZW5naW5lLmJpbmRGcmFtZWJ1ZmZlcihpKSx0aGlzLmFwcGx5RWZmZWN0V3JhcHBlcihlKSx0aGlzLmRyYXcoKSxpJiZ0aGlzLmVuZ2luZS51bkJpbmRGcmFtZWJ1ZmZlcihpKSx0aGlzLnJlc3RvcmVTdGF0ZXMoKX1kaXNwb3NlKCl7Y29uc3QgZT10aGlzLl92ZXJ0ZXhCdWZmZXJzW2cuUG9zaXRpb25LaW5kXTtlJiYoZS5kaXNwb3NlKCksZGVsZXRlIHRoaXMuX3ZlcnRleEJ1ZmZlcnNbZy5Qb3NpdGlvbktpbmRdKSx0aGlzLl9pbmRleEJ1ZmZlciYmdGhpcy5lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5faW5kZXhCdWZmZXIpLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXImJih0aGlzLmVuZ2luZS5vbkNvbnRleHRSZXN0b3JlZE9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXIpLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXI9bnVsbCl9fWNsYXNzIGlhe2NvbnN0cnVjdG9yKGUpe3RoaXMub25BcHBseU9ic2VydmFibGU9bmV3IEY7bGV0IHQ7Y29uc3QgaT1lLnVuaWZvcm1OYW1lc3x8W107ZS52ZXJ0ZXhTaGFkZXI/dD17ZnJhZ21lbnRTb3VyY2U6ZS5mcmFnbWVudFNoYWRlcix2ZXJ0ZXhTb3VyY2U6ZS52ZXJ0ZXhTaGFkZXIsc3BlY3Rvck5hbWU6ZS5uYW1lfHwiZWZmZWN0V3JhcHBlciJ9OihpLnB1c2goInNjYWxlIiksdD17ZnJhZ21lbnRTb3VyY2U6ZS5mcmFnbWVudFNoYWRlcix2ZXJ0ZXg6InBvc3Rwcm9jZXNzIixzcGVjdG9yTmFtZTplLm5hbWV8fCJlZmZlY3RXcmFwcGVyIn0sdGhpcy5vbkFwcGx5T2JzZXJ2YWJsZS5hZGQoKCk9Pnt0aGlzLmVmZmVjdC5zZXRGbG9hdDIoInNjYWxlIiwxLDEpfSkpO2NvbnN0IHM9ZS5kZWZpbmVzP2UuZGVmaW5lcy5qb2luKGAKYCk6IiI7dGhpcy5fZHJhd1dyYXBwZXI9bmV3IG1pKGUuZW5naW5lKSxlLnVzZVNoYWRlclN0b3JlPyh0LmZyYWdtZW50PXQuZnJhZ21lbnRTb3VyY2UsdC52ZXJ0ZXh8fCh0LnZlcnRleD10LnZlcnRleFNvdXJjZSksZGVsZXRlIHQuZnJhZ21lbnRTb3VyY2UsZGVsZXRlIHQudmVydGV4U291cmNlLHRoaXMuZWZmZWN0PWUuZW5naW5lLmNyZWF0ZUVmZmVjdCh0LGUuYXR0cmlidXRlTmFtZXN8fFsicG9zaXRpb24iXSxpLGUuc2FtcGxlck5hbWVzLHMsdm9pZCAwLGUub25Db21waWxlZCx2b2lkIDAsdm9pZCAwLGUuc2hhZGVyTGFuZ3VhZ2UpKToodGhpcy5lZmZlY3Q9bmV3IFBlKHQsZS5hdHRyaWJ1dGVOYW1lc3x8WyJwb3NpdGlvbiJdLGksZS5zYW1wbGVyTmFtZXMsZS5lbmdpbmUscyx2b2lkIDAsZS5vbkNvbXBpbGVkLHZvaWQgMCx2b2lkIDAsdm9pZCAwLGUuc2hhZGVyTGFuZ3VhZ2UpLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXI9ZS5lbmdpbmUub25Db250ZXh0UmVzdG9yZWRPYnNlcnZhYmxlLmFkZCgoKT0+e3RoaXMuZWZmZWN0Ll9waXBlbGluZUNvbnRleHQ9bnVsbCx0aGlzLmVmZmVjdC5fd2FzUHJldmlvdXNseVJlYWR5PSExLHRoaXMuZWZmZWN0Ll9wcmVwYXJlRWZmZWN0KCl9KSl9Z2V0IGVmZmVjdCgpe3JldHVybiB0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3R9c2V0IGVmZmVjdChlKXt0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3Q9ZX1kaXNwb3NlKCl7dGhpcy5fb25Db250ZXh0UmVzdG9yZWRPYnNlcnZlciYmKHRoaXMuZWZmZWN0LmdldEVuZ2luZSgpLm9uQ29udGV4dFJlc3RvcmVkT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25Db250ZXh0UmVzdG9yZWRPYnNlcnZlciksdGhpcy5fb25Db250ZXh0UmVzdG9yZWRPYnNlcnZlcj1udWxsKSx0aGlzLmVmZmVjdC5kaXNwb3NlKCl9fWNvbnN0IHdyPSJwYXNzUGl4ZWxTaGFkZXIiLE9yPWB2YXJ5aW5nIHZlYzIgdlVWOwp1bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjsKI2RlZmluZSBDVVNUT01fRlJBR01FTlRfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpIAp7CmdsX0ZyYWdDb2xvcj10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWKTsKfWA7VS5TaGFkZXJzU3RvcmVbd3JdPU9yO2NvbnN0IExyPXtuYW1lOndyLHNoYWRlcjpPcn07Y2xhc3MgdHR7c3RhdGljIF9DcmVhdGVEdW1wUmVuZGVyZXIoKXtpZighdHQuX0R1bXBUb29sc0VuZ2luZSl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKSx0PW5ldyBvZShlLCExLHtwcmVzZXJ2ZURyYXdpbmdCdWZmZXI6ITAsZGVwdGg6ITEsc3RlbmNpbDohMSxhbHBoYTohMCxwcmVtdWx0aXBsaWVkQWxwaGE6ITEsYW50aWFsaWFzOiExLGZhaWxJZk1ham9yUGVyZm9ybWFuY2VDYXZlYXQ6ITF9KTt0LmdldENhcHMoKS5wYXJhbGxlbFNoYWRlckNvbXBpbGU9dm9pZCAwO2NvbnN0IGk9bmV3IHRhKHQpLHM9bmV3IGlhKHtlbmdpbmU6dCxuYW1lOkxyLm5hbWUsZnJhZ21lbnRTaGFkZXI6THIuc2hhZGVyLHNhbXBsZXJOYW1lczpbInRleHR1cmVTYW1wbGVyIl19KTt0dC5fRHVtcFRvb2xzRW5naW5lPXtjYW52YXM6ZSxlbmdpbmU6dCxyZW5kZXJlcjppLHdyYXBwZXI6c319cmV0dXJuIHR0Ll9EdW1wVG9vbHNFbmdpbmV9c3RhdGljIGFzeW5jIER1bXBGcmFtZWJ1ZmZlcihlLHQsaSxzLHI9ImltYWdlL3BuZyIsbil7Y29uc3QgYT1hd2FpdCBpLnJlYWRQaXhlbHMoMCwwLGUsdCksbz1uZXcgVWludDhBcnJheShhLmJ1ZmZlcik7dHQuRHVtcERhdGEoZSx0LG8scyxyLG4sITApfXN0YXRpYyBEdW1wRGF0YUFzeW5jKGUsdCxpLHM9ImltYWdlL3BuZyIscixuPSExLGE9ITEsbyl7cmV0dXJuIG5ldyBQcm9taXNlKGg9Pnt0dC5EdW1wRGF0YShlLHQsaSxsPT5oKGwpLHMscixuLGEsbyl9KX1zdGF0aWMgRHVtcERhdGEoZSx0LGkscyxyPSJpbWFnZS9wbmciLG4sYT0hMSxvPSExLGgpe2NvbnN0IGw9dHQuX0NyZWF0ZUR1bXBSZW5kZXJlcigpO2lmKGwuZW5naW5lLnNldFNpemUoZSx0LCEwKSxpIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5KXtjb25zdCBkPW5ldyBVaW50OEFycmF5KGkubGVuZ3RoKTtsZXQgZj1pLmxlbmd0aDtmb3IoO2YtLTspe2NvbnN0IF89aVtmXTtkW2ZdPV88MD8wOl8+MT8xOk1hdGgucm91bmQoXyoyNTUpfWk9ZH1jb25zdCB1PWwuZW5naW5lLmNyZWF0ZVJhd1RleHR1cmUoaSxlLHQsNSwhMSwhYSwxKTtsLnJlbmRlcmVyLnNldFZpZXdwb3J0KCksbC5yZW5kZXJlci5hcHBseUVmZmVjdFdyYXBwZXIobC53cmFwcGVyKSxsLndyYXBwZXIuZWZmZWN0Ll9iaW5kVGV4dHVyZSgidGV4dHVyZVNhbXBsZXIiLHUpLGwucmVuZGVyZXIuZHJhdygpLG8/SC5Ub0Jsb2IobC5jYW52YXMsZD0+e2NvbnN0IGY9bmV3IEZpbGVSZWFkZXI7Zi5vbmxvYWQ9Xz0+e2NvbnN0IEU9Xy50YXJnZXQucmVzdWx0O3MmJnMoRSl9LGYucmVhZEFzQXJyYXlCdWZmZXIoZCl9LHIsaCk6SC5FbmNvZGVTY3JlZW5zaG90Q2FudmFzRGF0YShsLmNhbnZhcyxzLHIsbixoKSx1LmRpc3Bvc2UoKX1zdGF0aWMgRGlzcG9zZSgpe3R0Ll9EdW1wVG9vbHNFbmdpbmUmJih0dC5fRHVtcFRvb2xzRW5naW5lLndyYXBwZXIuZGlzcG9zZSgpLHR0Ll9EdW1wVG9vbHNFbmdpbmUucmVuZGVyZXIuZGlzcG9zZSgpLHR0Ll9EdW1wVG9vbHNFbmdpbmUuZW5naW5lLmRpc3Bvc2UoKSksdHQuX0R1bXBUb29sc0VuZ2luZT1udWxsfX0oKCk9PntILkR1bXBEYXRhPXR0LkR1bXBEYXRhLEguRHVtcERhdGFBc3luYz10dC5EdW1wRGF0YUFzeW5jLEguRHVtcEZyYW1lYnVmZmVyPXR0LkR1bXBGcmFtZWJ1ZmZlcn0pKCk7Y2xhc3MgX3QgZXh0ZW5kcyBOe2NvbnN0cnVjdG9yKGUsdCxpLHM9ITEscj0hMCxuPTAsYT0hMSxvPU4uVFJJTElORUFSX1NBTVBMSU5HTU9ERSxoPSEwLGw9ITEsdT0hMSxkPTUsZj0hMSxfLEUsbT0hMSx2PSExKXt2YXIgUyx5LEEsQyxiLE07bGV0IEw7aWYodHlwZW9mIHM9PSJvYmplY3QiKXtjb25zdCB3PXM7cz0hIXcuZ2VuZXJhdGVNaXBNYXBzLHI9KFM9dy5kb05vdENoYW5nZUFzcGVjdFJhdGlvKSE9PW51bGwmJlMhPT12b2lkIDA/UzohMCxuPSh5PXcudHlwZSkhPT1udWxsJiZ5IT09dm9pZCAwP3k6MCxhPSEhdy5pc0N1YmUsbz0oQT13LnNhbXBsaW5nTW9kZSkhPT1udWxsJiZBIT09dm9pZCAwP0E6Ti5UUklMSU5FQVJfU0FNUExJTkdNT0RFLGg9KEM9dy5nZW5lcmF0ZURlcHRoQnVmZmVyKSE9PW51bGwmJkMhPT12b2lkIDA/QzohMCxsPSEhdy5nZW5lcmF0ZVN0ZW5jaWxCdWZmZXIsdT0hIXcuaXNNdWx0aSxkPShiPXcuZm9ybWF0KSE9PW51bGwmJmIhPT12b2lkIDA/Yjo1LGY9ISF3LmRlbGF5QWxsb2NhdGlvbixfPXcuc2FtcGxlcyxFPXcuY3JlYXRpb25GbGFncyxtPSEhdy5ub0NvbG9yQXR0YWNobWVudCx2PSEhdy51c2VTUkdCQnVmZmVyLEw9dy5jb2xvckF0dGFjaG1lbnR9aWYoc3VwZXIobnVsbCxpLCFzLHZvaWQgMCxvLHZvaWQgMCx2b2lkIDAsdm9pZCAwLHZvaWQgMCxkKSx0aGlzLl91bk9ic2VydmVSZW5kZXJMaXN0PW51bGwsdGhpcy5fcmVuZGVyTGlzdEhhc0NoYW5nZWQ9KHcsZGUpPT57dmFyIGNlO2NvbnN0IHNlPXRoaXMuX3JlbmRlckxpc3Q/dGhpcy5fcmVuZGVyTGlzdC5sZW5ndGg6MDsoZGU9PT0wJiZzZT4wfHxzZT09PTApJiYoKGNlPXRoaXMuZ2V0U2NlbmUoKSk9PT1udWxsfHxjZT09PXZvaWQgMHx8Y2UubWVzaGVzLmZvckVhY2godGU9Pnt0ZS5fbWFya1N1Yk1lc2hlc0FzTGlnaHREaXJ0eSgpfSkpfSx0aGlzLnJlbmRlclBhcnRpY2xlcz0hMCx0aGlzLnJlbmRlclNwcml0ZXM9ITEsdGhpcy5mb3JjZUxheWVyTWFza0NoZWNrPSExLHRoaXMuaWdub3JlQ2FtZXJhVmlld3BvcnQ9ITEsdGhpcy5vbkJlZm9yZUJpbmRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BZnRlclVuYmluZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQ2xlYXJPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25SZXNpemVPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX2NsZWFyZWQ9ITEsdGhpcy5za2lwSW5pdGlhbENsZWFyPSExLHRoaXMuX2N1cnJlbnRSZWZyZXNoSWQ9LTEsdGhpcy5fcmVmcmVzaFJhdGU9MSx0aGlzLl9zYW1wbGVzPTEsdGhpcy5fY2FuUmVzY2FsZT0hMCx0aGlzLl9yZW5kZXJUYXJnZXQ9bnVsbCx0aGlzLmJvdW5kaW5nQm94UG9zaXRpb249cC5aZXJvKCksaT10aGlzLmdldFNjZW5lKCksIWkpcmV0dXJuO2NvbnN0IGs9dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpO3RoaXMuX2Nvb3JkaW5hdGVzTW9kZT1OLlBST0pFQ1RJT05fTU9ERSx0aGlzLnJlbmRlckxpc3Q9bmV3IEFycmF5LHRoaXMubmFtZT1lLHRoaXMuaXNSZW5kZXJUYXJnZXQ9ITAsdGhpcy5faW5pdGlhbFNpemVQYXJhbWV0ZXI9dCx0aGlzLl9yZW5kZXJQYXNzSWRzPVtdLHRoaXMuX2lzQ3ViZURhdGE9YSx0aGlzLl9wcm9jZXNzU2l6ZVBhcmFtZXRlcih0KSx0aGlzLnJlbmRlclBhc3NJZD10aGlzLl9yZW5kZXJQYXNzSWRzWzBdLHRoaXMuX3Jlc2l6ZU9ic2VydmVyPWsub25SZXNpemVPYnNlcnZhYmxlLmFkZCgoKT0+e30pLHRoaXMuX2dlbmVyYXRlTWlwTWFwcz0hIXMsdGhpcy5fZG9Ob3RDaGFuZ2VBc3BlY3RSYXRpbz1yLHRoaXMuX3JlbmRlcmluZ01hbmFnZXI9bmV3IFdlKGkpLHRoaXMuX3JlbmRlcmluZ01hbmFnZXIuX3VzZVNjZW5lQXV0b0NsZWFyU2V0dXA9ITAsIXUmJih0aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zPXtnZW5lcmF0ZU1pcE1hcHM6cyx0eXBlOm4sZm9ybWF0OihNPXRoaXMuX2Zvcm1hdCkhPT1udWxsJiZNIT09dm9pZCAwP006dm9pZCAwLHNhbXBsaW5nTW9kZTp0aGlzLnNhbXBsaW5nTW9kZSxnZW5lcmF0ZURlcHRoQnVmZmVyOmgsZ2VuZXJhdGVTdGVuY2lsQnVmZmVyOmwsc2FtcGxlczpfLGNyZWF0aW9uRmxhZ3M6RSxub0NvbG9yQXR0YWNobWVudDptLHVzZVNSR0JCdWZmZXI6dixjb2xvckF0dGFjaG1lbnQ6TH0sdGhpcy5zYW1wbGluZ01vZGU9PT1OLk5FQVJFU1RfU0FNUExJTkdNT0RFJiYodGhpcy53cmFwVT1OLkNMQU1QX0FERFJFU1NNT0RFLHRoaXMud3JhcFY9Ti5DTEFNUF9BRERSRVNTTU9ERSksZnx8KGE/KHRoaXMuX3JlbmRlclRhcmdldD1pLmdldEVuZ2luZSgpLmNyZWF0ZVJlbmRlclRhcmdldEN1YmVUZXh0dXJlKHRoaXMuZ2V0UmVuZGVyU2l6ZSgpLHRoaXMuX3JlbmRlclRhcmdldE9wdGlvbnMpLHRoaXMuY29vcmRpbmF0ZXNNb2RlPU4uSU5WQ1VCSUNfTU9ERSx0aGlzLl90ZXh0dXJlTWF0cml4PXguSWRlbnRpdHkoKSk6dGhpcy5fcmVuZGVyVGFyZ2V0PWkuZ2V0RW5naW5lKCkuY3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZSh0aGlzLl9zaXplLHRoaXMuX3JlbmRlclRhcmdldE9wdGlvbnMpLHRoaXMuX3RleHR1cmU9dGhpcy5fcmVuZGVyVGFyZ2V0LnRleHR1cmUsXyE9PXZvaWQgMCYmKHRoaXMuc2FtcGxlcz1fKSkpfWdldCByZW5kZXJMaXN0KCl7cmV0dXJuIHRoaXMuX3JlbmRlckxpc3R9c2V0IHJlbmRlckxpc3QoZSl7dGhpcy5fdW5PYnNlcnZlUmVuZGVyTGlzdCYmKHRoaXMuX3VuT2JzZXJ2ZVJlbmRlckxpc3QoKSx0aGlzLl91bk9ic2VydmVSZW5kZXJMaXN0PW51bGwpLGUmJih0aGlzLl91bk9ic2VydmVSZW5kZXJMaXN0PSRzKGUsdGhpcy5fcmVuZGVyTGlzdEhhc0NoYW5nZWQpKSx0aGlzLl9yZW5kZXJMaXN0PWV9Z2V0IHBvc3RQcm9jZXNzZXMoKXtyZXR1cm4gdGhpcy5fcG9zdFByb2Nlc3Nlc31nZXQgX3ByZVBhc3NFbmFibGVkKCl7cmV0dXJuISF0aGlzLl9wcmVQYXNzUmVuZGVyVGFyZ2V0JiZ0aGlzLl9wcmVQYXNzUmVuZGVyVGFyZ2V0LmVuYWJsZWR9c2V0IG9uQWZ0ZXJVbmJpbmQoZSl7dGhpcy5fb25BZnRlclVuYmluZE9ic2VydmVyJiZ0aGlzLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkFmdGVyVW5iaW5kT2JzZXJ2ZXIpLHRoaXMuX29uQWZ0ZXJVbmJpbmRPYnNlcnZlcj10aGlzLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLmFkZChlKX1zZXQgb25CZWZvcmVSZW5kZXIoZSl7dGhpcy5fb25CZWZvcmVSZW5kZXJPYnNlcnZlciYmdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQmVmb3JlUmVuZGVyT2JzZXJ2ZXIpLHRoaXMuX29uQmVmb3JlUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGUpfXNldCBvbkFmdGVyUmVuZGVyKGUpe3RoaXMuX29uQWZ0ZXJSZW5kZXJPYnNlcnZlciYmdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25BZnRlclJlbmRlck9ic2VydmVyKSx0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5hZGQoZSl9c2V0IG9uQ2xlYXIoZSl7dGhpcy5fb25DbGVhck9ic2VydmVyJiZ0aGlzLm9uQ2xlYXJPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkNsZWFyT2JzZXJ2ZXIpLHRoaXMuX29uQ2xlYXJPYnNlcnZlcj10aGlzLm9uQ2xlYXJPYnNlcnZhYmxlLmFkZChlKX1nZXQgcmVuZGVyUGFzc0lkcygpe3JldHVybiB0aGlzLl9yZW5kZXJQYXNzSWRzfWdldCBjdXJyZW50UmVmcmVzaElkKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRSZWZyZXNoSWR9c2V0TWF0ZXJpYWxGb3JSZW5kZXJpbmcoZSx0KXtsZXQgaTtBcnJheS5pc0FycmF5KGUpP2k9ZTppPVtlXTtmb3IobGV0IHM9MDtzPGkubGVuZ3RoOysrcylmb3IobGV0IHI9MDtyPHRoaXMuX3JlbmRlclBhc3NJZHMubGVuZ3RoOysrcilpW3NdLnNldE1hdGVyaWFsRm9yUmVuZGVyUGFzcyh0aGlzLl9yZW5kZXJQYXNzSWRzW3JdLHQhPT12b2lkIDA/QXJyYXkuaXNBcnJheSh0KT90W3JdOnQ6dm9pZCAwKX1nZXQgcmVuZGVyVGFyZ2V0T3B0aW9ucygpe3JldHVybiB0aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zfWdldCByZW5kZXJUYXJnZXQoKXtyZXR1cm4gdGhpcy5fcmVuZGVyVGFyZ2V0fV9vblJhdGlvUmVzY2FsZSgpe3RoaXMuX3NpemVSYXRpbyYmdGhpcy5yZXNpemUodGhpcy5faW5pdGlhbFNpemVQYXJhbWV0ZXIpfXNldCBib3VuZGluZ0JveFNpemUoZSl7aWYodGhpcy5fYm91bmRpbmdCb3hTaXplJiZ0aGlzLl9ib3VuZGluZ0JveFNpemUuZXF1YWxzKGUpKXJldHVybjt0aGlzLl9ib3VuZGluZ0JveFNpemU9ZTtjb25zdCB0PXRoaXMuZ2V0U2NlbmUoKTt0JiZ0Lm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpfWdldCBib3VuZGluZ0JveFNpemUoKXtyZXR1cm4gdGhpcy5fYm91bmRpbmdCb3hTaXplfWdldCBkZXB0aFN0ZW5jaWxUZXh0dXJlKCl7dmFyIGUsdDtyZXR1cm4odD0oZT10aGlzLl9yZW5kZXJUYXJnZXQpPT09bnVsbHx8ZT09PXZvaWQgMD92b2lkIDA6ZS5fZGVwdGhTdGVuY2lsVGV4dHVyZSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6bnVsbH1jcmVhdGVEZXB0aFN0ZW5jaWxUZXh0dXJlKGU9MCx0PSEwLGk9ITEscz0xLHI9MTQpe3ZhciBuOyhuPXRoaXMuX3JlbmRlclRhcmdldCk9PT1udWxsfHxuPT09dm9pZCAwfHxuLmNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmUoZSx0LGkscyxyKX1fcmVsZWFzZVJlbmRlclBhc3NJZCgpe2lmKHRoaXMuX3NjZW5lKXtjb25zdCBlPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO2ZvcihsZXQgdD0wO3Q8dGhpcy5fcmVuZGVyUGFzc0lkcy5sZW5ndGg7Kyt0KWUucmVsZWFzZVJlbmRlclBhc3NJZCh0aGlzLl9yZW5kZXJQYXNzSWRzW3RdKX10aGlzLl9yZW5kZXJQYXNzSWRzPVtdfV9jcmVhdGVSZW5kZXJQYXNzSWQoKXt0aGlzLl9yZWxlYXNlUmVuZGVyUGFzc0lkKCk7Y29uc3QgZT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSx0PXRoaXMuX2lzQ3ViZURhdGE/Njp0aGlzLmdldFJlbmRlckxheWVycygpfHwxO2ZvcihsZXQgaT0wO2k8dDsrK2kpdGhpcy5fcmVuZGVyUGFzc0lkc1tpXT1lLmNyZWF0ZVJlbmRlclBhc3NJZChgUmVuZGVyVGFyZ2V0VGV4dHVyZSAtICR7dGhpcy5uYW1lfSMke2l9YCl9X3Byb2Nlc3NTaXplUGFyYW1ldGVyKGUpe2lmKGUucmF0aW8pe3RoaXMuX3NpemVSYXRpbz1lLnJhdGlvO2NvbnN0IHQ9dGhpcy5fZ2V0RW5naW5lKCk7dGhpcy5fc2l6ZT17d2lkdGg6dGhpcy5fYmVzdFJlZmxlY3Rpb25SZW5kZXJUYXJnZXREaW1lbnNpb24odC5nZXRSZW5kZXJXaWR0aCgpLHRoaXMuX3NpemVSYXRpbyksaGVpZ2h0OnRoaXMuX2Jlc3RSZWZsZWN0aW9uUmVuZGVyVGFyZ2V0RGltZW5zaW9uKHQuZ2V0UmVuZGVySGVpZ2h0KCksdGhpcy5fc2l6ZVJhdGlvKX19ZWxzZSB0aGlzLl9zaXplPWU7dGhpcy5fY3JlYXRlUmVuZGVyUGFzc0lkKCl9Z2V0IHNhbXBsZXMoKXt2YXIgZSx0O3JldHVybih0PShlPXRoaXMuX3JlbmRlclRhcmdldCk9PT1udWxsfHxlPT09dm9pZCAwP3ZvaWQgMDplLnNhbXBsZXMpIT09bnVsbCYmdCE9PXZvaWQgMD90OnRoaXMuX3NhbXBsZXN9c2V0IHNhbXBsZXMoZSl7dGhpcy5fcmVuZGVyVGFyZ2V0JiYodGhpcy5fc2FtcGxlcz10aGlzLl9yZW5kZXJUYXJnZXQuc2V0U2FtcGxlcyhlKSl9cmVzZXRSZWZyZXNoQ291bnRlcigpe3RoaXMuX2N1cnJlbnRSZWZyZXNoSWQ9LTF9Z2V0IHJlZnJlc2hSYXRlKCl7cmV0dXJuIHRoaXMuX3JlZnJlc2hSYXRlfXNldCByZWZyZXNoUmF0ZShlKXt0aGlzLl9yZWZyZXNoUmF0ZT1lLHRoaXMucmVzZXRSZWZyZXNoQ291bnRlcigpfWFkZFBvc3RQcm9jZXNzKGUpe2lmKCF0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIpe2NvbnN0IHQ9dGhpcy5nZXRTY2VuZSgpO2lmKCF0KXJldHVybjt0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXI9bmV3IFFpKHQpLHRoaXMuX3Bvc3RQcm9jZXNzZXM9bmV3IEFycmF5fXRoaXMuX3Bvc3RQcm9jZXNzZXMucHVzaChlKSx0aGlzLl9wb3N0UHJvY2Vzc2VzWzBdLmF1dG9DbGVhcj0hMX1jbGVhclBvc3RQcm9jZXNzZXMoZT0hMSl7aWYodGhpcy5fcG9zdFByb2Nlc3Nlcyl7aWYoZSlmb3IoY29uc3QgdCBvZiB0aGlzLl9wb3N0UHJvY2Vzc2VzKXQuZGlzcG9zZSgpO3RoaXMuX3Bvc3RQcm9jZXNzZXM9W119fXJlbW92ZVBvc3RQcm9jZXNzKGUpe2lmKCF0aGlzLl9wb3N0UHJvY2Vzc2VzKXJldHVybjtjb25zdCB0PXRoaXMuX3Bvc3RQcm9jZXNzZXMuaW5kZXhPZihlKTt0IT09LTEmJih0aGlzLl9wb3N0UHJvY2Vzc2VzLnNwbGljZSh0LDEpLHRoaXMuX3Bvc3RQcm9jZXNzZXMubGVuZ3RoPjAmJih0aGlzLl9wb3N0UHJvY2Vzc2VzWzBdLmF1dG9DbGVhcj0hMSkpfV9zaG91bGRSZW5kZXIoKXtyZXR1cm4gdGhpcy5fY3VycmVudFJlZnJlc2hJZD09PS0xPyh0aGlzLl9jdXJyZW50UmVmcmVzaElkPTEsITApOnRoaXMucmVmcmVzaFJhdGU9PT10aGlzLl9jdXJyZW50UmVmcmVzaElkPyh0aGlzLl9jdXJyZW50UmVmcmVzaElkPTEsITApOih0aGlzLl9jdXJyZW50UmVmcmVzaElkKyssITEpfWdldFJlbmRlclNpemUoKXtyZXR1cm4gdGhpcy5nZXRSZW5kZXJXaWR0aCgpfWdldFJlbmRlcldpZHRoKCl7cmV0dXJuIHRoaXMuX3NpemUud2lkdGg/dGhpcy5fc2l6ZS53aWR0aDp0aGlzLl9zaXplfWdldFJlbmRlckhlaWdodCgpe3JldHVybiB0aGlzLl9zaXplLndpZHRoP3RoaXMuX3NpemUuaGVpZ2h0OnRoaXMuX3NpemV9Z2V0UmVuZGVyTGF5ZXJzKCl7Y29uc3QgZT10aGlzLl9zaXplLmxheWVycztyZXR1cm4gZXx8MH1kaXNhYmxlUmVzY2FsaW5nKCl7dGhpcy5fY2FuUmVzY2FsZT0hMX1nZXQgY2FuUmVzY2FsZSgpe3JldHVybiB0aGlzLl9jYW5SZXNjYWxlfXNjYWxlKGUpe2NvbnN0IHQ9TWF0aC5tYXgoMSx0aGlzLmdldFJlbmRlclNpemUoKSplKTt0aGlzLnJlc2l6ZSh0KX1nZXRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeCgpe3JldHVybiB0aGlzLmlzQ3ViZT90aGlzLl90ZXh0dXJlTWF0cml4OnN1cGVyLmdldFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4KCl9cmVzaXplKGUpe3ZhciB0O2NvbnN0IGk9dGhpcy5pc0N1YmU7KHQ9dGhpcy5fcmVuZGVyVGFyZ2V0KT09PW51bGx8fHQ9PT12b2lkIDB8fHQuZGlzcG9zZSgpLHRoaXMuX3JlbmRlclRhcmdldD1udWxsO2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpO3MmJih0aGlzLl9wcm9jZXNzU2l6ZVBhcmFtZXRlcihlKSxpP3RoaXMuX3JlbmRlclRhcmdldD1zLmdldEVuZ2luZSgpLmNyZWF0ZVJlbmRlclRhcmdldEN1YmVUZXh0dXJlKHRoaXMuZ2V0UmVuZGVyU2l6ZSgpLHRoaXMuX3JlbmRlclRhcmdldE9wdGlvbnMpOnRoaXMuX3JlbmRlclRhcmdldD1zLmdldEVuZ2luZSgpLmNyZWF0ZVJlbmRlclRhcmdldFRleHR1cmUodGhpcy5fc2l6ZSx0aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zKSx0aGlzLl90ZXh0dXJlPXRoaXMuX3JlbmRlclRhcmdldC50ZXh0dXJlLHRoaXMuX3JlbmRlclRhcmdldE9wdGlvbnMuc2FtcGxlcyE9PXZvaWQgMCYmKHRoaXMuc2FtcGxlcz10aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zLnNhbXBsZXMpLHRoaXMub25SZXNpemVPYnNlcnZhYmxlLmhhc09ic2VydmVycygpJiZ0aGlzLm9uUmVzaXplT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcykpfXJlbmRlcihlPSExLHQ9ITEpe3RoaXMuX3JlbmRlcihlLHQpfWlzUmVhZHlGb3JSZW5kZXJpbmcoKXtyZXR1cm4gdGhpcy5fcmVuZGVyKCExLCExLCEwKX1fcmVuZGVyKGU9ITEsdD0hMSxpPSExKXt2YXIgcztjb25zdCByPXRoaXMuZ2V0U2NlbmUoKTtpZighcilyZXR1cm4gaTtjb25zdCBuPXIuZ2V0RW5naW5lKCk7aWYodGhpcy51c2VDYW1lcmFQb3N0UHJvY2Vzc2VzIT09dm9pZCAwJiYoZT10aGlzLnVzZUNhbWVyYVBvc3RQcm9jZXNzZXMpLHRoaXMuX3dhaXRpbmdSZW5kZXJMaXN0KXt0aGlzLnJlbmRlckxpc3Q9W107Zm9yKGxldCB1PTA7dTx0aGlzLl93YWl0aW5nUmVuZGVyTGlzdC5sZW5ndGg7dSsrKXtjb25zdCBkPXRoaXMuX3dhaXRpbmdSZW5kZXJMaXN0W3VdLGY9ci5nZXRNZXNoQnlJZChkKTtmJiZ0aGlzLnJlbmRlckxpc3QucHVzaChmKX10aGlzLl93YWl0aW5nUmVuZGVyTGlzdD12b2lkIDB9aWYodGhpcy5yZW5kZXJMaXN0UHJlZGljYXRlKXt0aGlzLnJlbmRlckxpc3Q/dGhpcy5yZW5kZXJMaXN0Lmxlbmd0aD0wOnRoaXMucmVuZGVyTGlzdD1bXTtjb25zdCB1PXRoaXMuZ2V0U2NlbmUoKTtpZighdSlyZXR1cm4gaTtjb25zdCBkPXUubWVzaGVzO2ZvcihsZXQgZj0wO2Y8ZC5sZW5ndGg7ZisrKXtjb25zdCBfPWRbZl07dGhpcy5yZW5kZXJMaXN0UHJlZGljYXRlKF8pJiZ0aGlzLnJlbmRlckxpc3QucHVzaChfKX19Y29uc3QgYT1uLmN1cnJlbnRSZW5kZXJQYXNzSWQ7dGhpcy5vbkJlZm9yZUJpbmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKTtjb25zdCBvPShzPXRoaXMuYWN0aXZlQ2FtZXJhKSE9PW51bGwmJnMhPT12b2lkIDA/czpyLmFjdGl2ZUNhbWVyYSxoPXIuYWN0aXZlQ2FtZXJhO28mJihvIT09ci5hY3RpdmVDYW1lcmEmJihyLnNldFRyYW5zZm9ybU1hdHJpeChvLmdldFZpZXdNYXRyaXgoKSxvLmdldFByb2plY3Rpb25NYXRyaXgoITApKSxyLmFjdGl2ZUNhbWVyYT1vKSxuLnNldFZpZXdwb3J0KG8udmlld3BvcnQsdGhpcy5nZXRSZW5kZXJXaWR0aCgpLHRoaXMuZ2V0UmVuZGVySGVpZ2h0KCkpKSx0aGlzLl9kZWZhdWx0UmVuZGVyTGlzdFByZXBhcmVkPSExO2xldCBsPWk7aWYoaSl7ci5nZXRWaWV3TWF0cml4KCl8fHIudXBkYXRlVHJhbnNmb3JtTWF0cml4KCk7Y29uc3QgdT10aGlzLmlzMkRBcnJheT90aGlzLmdldFJlbmRlckxheWVycygpOnRoaXMuaXNDdWJlPzY6MTtmb3IobGV0IGQ9MDtkPHUmJmw7ZCsrKXtsZXQgZj1udWxsO2NvbnN0IF89dGhpcy5yZW5kZXJMaXN0P3RoaXMucmVuZGVyTGlzdDpyLmdldEFjdGl2ZU1lc2hlcygpLmRhdGEsRT10aGlzLnJlbmRlckxpc3Q/dGhpcy5yZW5kZXJMaXN0Lmxlbmd0aDpyLmdldEFjdGl2ZU1lc2hlcygpLmxlbmd0aDtuLmN1cnJlbnRSZW5kZXJQYXNzSWQ9dGhpcy5fcmVuZGVyUGFzc0lkc1tkXSx0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZCksdGhpcy5nZXRDdXN0b21SZW5kZXJMaXN0JiYoZj10aGlzLmdldEN1c3RvbVJlbmRlckxpc3QoZCxfLEUpKSxmfHwoZj1fKSx0aGlzLl9kb05vdENoYW5nZUFzcGVjdFJhdGlvfHxyLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCghMCk7Zm9yKGxldCBtPTA7bTxmLmxlbmd0aCYmbDsrK20pe2NvbnN0IHY9ZlttXTtpZighKCF2LmlzRW5hYmxlZCgpfHx2LmlzQmxvY2tlZHx8IXYuaXNWaXNpYmxlfHwhdi5zdWJNZXNoZXMpKXtpZih0aGlzLmN1c3RvbUlzUmVhZHlGdW5jdGlvbil7aWYoIXRoaXMuY3VzdG9tSXNSZWFkeUZ1bmN0aW9uKHYsdGhpcy5yZWZyZXNoUmF0ZSxpKSl7bD0hMTtjb250aW51ZX19ZWxzZSBpZighdi5pc1JlYWR5KCEwKSl7bD0hMTtjb250aW51ZX19fXRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGQpLCh0aGlzLmlzMkRBcnJheXx8dGhpcy5pc0N1YmUpJiYoci5pbmNyZW1lbnRSZW5kZXJJZCgpLHIucmVzZXRDYWNoZWRNYXRlcmlhbCgpKX19ZWxzZSBpZih0aGlzLmlzMkRBcnJheSlmb3IobGV0IHU9MDt1PHRoaXMuZ2V0UmVuZGVyTGF5ZXJzKCk7dSsrKXRoaXMuX3JlbmRlclRvVGFyZ2V0KDAsZSx0LHUsbyksci5pbmNyZW1lbnRSZW5kZXJJZCgpLHIucmVzZXRDYWNoZWRNYXRlcmlhbCgpO2Vsc2UgaWYodGhpcy5pc0N1YmUpZm9yKGxldCB1PTA7dTw2O3UrKyl0aGlzLl9yZW5kZXJUb1RhcmdldCh1LGUsdCx2b2lkIDAsbyksci5pbmNyZW1lbnRSZW5kZXJJZCgpLHIucmVzZXRDYWNoZWRNYXRlcmlhbCgpO2Vsc2UgdGhpcy5fcmVuZGVyVG9UYXJnZXQoMCxlLHQsdm9pZCAwLG8pO3JldHVybiB0aGlzLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSxuLmN1cnJlbnRSZW5kZXJQYXNzSWQ9YSxoJiYoci5hY3RpdmVDYW1lcmE9aCwoci5nZXRFbmdpbmUoKS5zY2VuZXMubGVuZ3RoPjF8fHRoaXMuYWN0aXZlQ2FtZXJhJiZ0aGlzLmFjdGl2ZUNhbWVyYSE9PXIuYWN0aXZlQ2FtZXJhKSYmci5zZXRUcmFuc2Zvcm1NYXRyaXgoci5hY3RpdmVDYW1lcmEuZ2V0Vmlld01hdHJpeCgpLHIuYWN0aXZlQ2FtZXJhLmdldFByb2plY3Rpb25NYXRyaXgoITApKSxuLnNldFZpZXdwb3J0KHIuYWN0aXZlQ2FtZXJhLnZpZXdwb3J0KSksci5yZXNldENhY2hlZE1hdGVyaWFsKCksbH1fYmVzdFJlZmxlY3Rpb25SZW5kZXJUYXJnZXREaW1lbnNpb24oZSx0KXtjb25zdCBzPWUqdCxyPUkuTmVhcmVzdFBPVChzKzEyOCoxMjgvKDEyOCtzKSk7cmV0dXJuIE1hdGgubWluKEkuRmxvb3JQT1QoZSkscil9X3ByZXBhcmVSZW5kZXJpbmdNYW5hZ2VyKGUsdCxpLHMpe2NvbnN0IHI9dGhpcy5nZXRTY2VuZSgpO2lmKCFyKXJldHVybjt0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnJlc2V0KCk7Y29uc3Qgbj1yLmdldFJlbmRlcklkKCk7Zm9yKGxldCBhPTA7YTx0O2ErKyl7Y29uc3Qgbz1lW2FdO2lmKG8mJiFvLmlzQmxvY2tlZCl7aWYodGhpcy5jdXN0b21Jc1JlYWR5RnVuY3Rpb24pe2lmKCF0aGlzLmN1c3RvbUlzUmVhZHlGdW5jdGlvbihvLHRoaXMucmVmcmVzaFJhdGUsITEpKXt0aGlzLnJlc2V0UmVmcmVzaENvdW50ZXIoKTtjb250aW51ZX19ZWxzZSBpZighby5pc1JlYWR5KHRoaXMucmVmcmVzaFJhdGU9PT0wKSl7dGhpcy5yZXNldFJlZnJlc2hDb3VudGVyKCk7Y29udGludWV9aWYoIW8uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2N1cnJlbnRMT0RJc1VwVG9EYXRlJiZyLmFjdGl2ZUNhbWVyYSYmKG8uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2N1cnJlbnRMT0Q9ci5jdXN0b21MT0RTZWxlY3Rvcj9yLmN1c3RvbUxPRFNlbGVjdG9yKG8sdGhpcy5hY3RpdmVDYW1lcmF8fHIuYWN0aXZlQ2FtZXJhKTpvLmdldExPRCh0aGlzLmFjdGl2ZUNhbWVyYXx8ci5hY3RpdmVDYW1lcmEpLG8uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2N1cnJlbnRMT0RJc1VwVG9EYXRlPSEwKSwhby5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fY3VycmVudExPRCljb250aW51ZTtsZXQgaD1vLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9jdXJyZW50TE9EO2guX3ByZUFjdGl2YXRlRm9ySW50ZXJtZWRpYXRlUmVuZGVyaW5nKG4pO2xldCBsO2lmKHMmJmk/bD0oby5sYXllck1hc2smaS5sYXllck1hc2spPT09MDpsPSExLG8uaXNFbmFibGVkKCkmJm8uaXNWaXNpYmxlJiZvLnN1Yk1lc2hlcyYmIWwmJihoIT09byYmaC5fYWN0aXZhdGUobiwhMCksby5fYWN0aXZhdGUobiwhMCkmJm8uc3ViTWVzaGVzLmxlbmd0aCkpe28uaXNBbkluc3RhbmNlP28uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2FjdEFzUmVndWxhck1lc2gmJihoPW8pOmguX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX29ubHlGb3JJbnN0YW5jZXNJbnRlcm1lZGlhdGU9ITEsaC5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5faXNBY3RpdmVJbnRlcm1lZGlhdGU9ITA7Zm9yKGxldCB1PTA7dTxoLnN1Yk1lc2hlcy5sZW5ndGg7dSsrKXtjb25zdCBkPWguc3ViTWVzaGVzW3VdO3RoaXMuX3JlbmRlcmluZ01hbmFnZXIuZGlzcGF0Y2goZCxoKX19fX1mb3IobGV0IGE9MDthPHIucGFydGljbGVTeXN0ZW1zLmxlbmd0aDthKyspe2NvbnN0IG89ci5wYXJ0aWNsZVN5c3RlbXNbYV0saD1vLmVtaXR0ZXI7IW8uaXNTdGFydGVkKCl8fCFofHwhaC5wb3NpdGlvbnx8IWguaXNFbmFibGVkKCl8fGUuaW5kZXhPZihoKT49MCYmdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5kaXNwYXRjaFBhcnRpY2xlcyhvKX19X2JpbmRGcmFtZUJ1ZmZlcihlPTAsdD0wKXtjb25zdCBpPXRoaXMuZ2V0U2NlbmUoKTtpZighaSlyZXR1cm47Y29uc3Qgcz1pLmdldEVuZ2luZSgpO3RoaXMuX3JlbmRlclRhcmdldCYmcy5iaW5kRnJhbWVidWZmZXIodGhpcy5fcmVuZGVyVGFyZ2V0LHRoaXMuaXNDdWJlP2U6dm9pZCAwLHZvaWQgMCx2b2lkIDAsdGhpcy5pZ25vcmVDYW1lcmFWaWV3cG9ydCwwLHQpfV91bmJpbmRGcmFtZUJ1ZmZlcihlLHQpe3RoaXMuX3JlbmRlclRhcmdldCYmZS51bkJpbmRGcmFtZWJ1ZmZlcih0aGlzLl9yZW5kZXJUYXJnZXQsdGhpcy5pc0N1YmUsKCk9Pnt0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0KX0pfV9wcmVwYXJlRnJhbWUoZSx0LGkscyl7dGhpcy5fcG9zdFByb2Nlc3NNYW5hZ2VyP3RoaXMuX3ByZVBhc3NFbmFibGVkfHx0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIuX3ByZXBhcmVGcmFtZSh0aGlzLl90ZXh0dXJlLHRoaXMuX3Bvc3RQcm9jZXNzZXMpOighc3x8IWUucG9zdFByb2Nlc3NNYW5hZ2VyLl9wcmVwYXJlRnJhbWUodGhpcy5fdGV4dHVyZSkpJiZ0aGlzLl9iaW5kRnJhbWVCdWZmZXIodCxpKX1fcmVuZGVyVG9UYXJnZXQoZSx0LGkscz0wLHI9bnVsbCl7dmFyIG4sYSxvLGgsbCx1O2NvbnN0IGQ9dGhpcy5nZXRTY2VuZSgpO2lmKCFkKXJldHVybjtjb25zdCBmPWQuZ2V0RW5naW5lKCk7aWYoKG49Zi5fZGVidWdQdXNoR3JvdXApPT09bnVsbHx8bj09PXZvaWQgMHx8bi5jYWxsKGYsYHJlbmRlciB0byBmYWNlICMke2V9IGxheWVyICMke3N9YCwxKSx0aGlzLl9wcmVwYXJlRnJhbWUoZCxlLHMsdCksdGhpcy5pczJEQXJyYXk/KGYuY3VycmVudFJlbmRlclBhc3NJZD10aGlzLl9yZW5kZXJQYXNzSWRzW3NdLHRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhzKSk6KGYuY3VycmVudFJlbmRlclBhc3NJZD10aGlzLl9yZW5kZXJQYXNzSWRzW2VdLHRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSksZi5zbmFwc2hvdFJlbmRlcmluZyYmZi5zbmFwc2hvdFJlbmRlcmluZ01vZGU9PT0xKXRoaXMub25DbGVhck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCk/dGhpcy5vbkNsZWFyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZik6dGhpcy5za2lwSW5pdGlhbENsZWFyfHxmLmNsZWFyKHRoaXMuY2xlYXJDb2xvcnx8ZC5jbGVhckNvbG9yLCEwLCEwLCEwKTtlbHNle2xldCBFPW51bGw7Y29uc3QgbT10aGlzLnJlbmRlckxpc3Q/dGhpcy5yZW5kZXJMaXN0OmQuZ2V0QWN0aXZlTWVzaGVzKCkuZGF0YSx2PXRoaXMucmVuZGVyTGlzdD90aGlzLnJlbmRlckxpc3QubGVuZ3RoOmQuZ2V0QWN0aXZlTWVzaGVzKCkubGVuZ3RoO3RoaXMuZ2V0Q3VzdG9tUmVuZGVyTGlzdCYmKEU9dGhpcy5nZXRDdXN0b21SZW5kZXJMaXN0KHRoaXMuaXMyREFycmF5P3M6ZSxtLHYpKSxFP3RoaXMuX3ByZXBhcmVSZW5kZXJpbmdNYW5hZ2VyKEUsRS5sZW5ndGgscix0aGlzLmZvcmNlTGF5ZXJNYXNrQ2hlY2spOih0aGlzLl9kZWZhdWx0UmVuZGVyTGlzdFByZXBhcmVkfHwodGhpcy5fcHJlcGFyZVJlbmRlcmluZ01hbmFnZXIobSx2LHIsIXRoaXMucmVuZGVyTGlzdHx8dGhpcy5mb3JjZUxheWVyTWFza0NoZWNrKSx0aGlzLl9kZWZhdWx0UmVuZGVyTGlzdFByZXBhcmVkPSEwKSxFPW0pO2Zvcihjb25zdCB5IG9mIGQuX2JlZm9yZVJlbmRlclRhcmdldENsZWFyU3RhZ2UpeS5hY3Rpb24odGhpcyxlLHMpO3RoaXMub25DbGVhck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCk/dGhpcy5vbkNsZWFyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZik6dGhpcy5za2lwSW5pdGlhbENsZWFyfHxmLmNsZWFyKHRoaXMuY2xlYXJDb2xvcnx8ZC5jbGVhckNvbG9yLCEwLCEwLCEwKSx0aGlzLl9kb05vdENoYW5nZUFzcGVjdFJhdGlvfHxkLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCghMCk7Zm9yKGNvbnN0IHkgb2YgZC5fYmVmb3JlUmVuZGVyVGFyZ2V0RHJhd1N0YWdlKXkuYWN0aW9uKHRoaXMsZSxzKTt0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnJlbmRlcih0aGlzLmN1c3RvbVJlbmRlckZ1bmN0aW9uLEUsdGhpcy5yZW5kZXJQYXJ0aWNsZXMsdGhpcy5yZW5kZXJTcHJpdGVzKTtmb3IoY29uc3QgeSBvZiBkLl9hZnRlclJlbmRlclRhcmdldERyYXdTdGFnZSl5LmFjdGlvbih0aGlzLGUscyk7Y29uc3QgUz0obz0oYT10aGlzLl90ZXh0dXJlKT09PW51bGx8fGE9PT12b2lkIDA/dm9pZCAwOmEuZ2VuZXJhdGVNaXBNYXBzKSE9PW51bGwmJm8hPT12b2lkIDA/bzohMTt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5nZW5lcmF0ZU1pcE1hcHM9ITEpLHRoaXMuX3Bvc3RQcm9jZXNzTWFuYWdlcj90aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIuX2ZpbmFsaXplRnJhbWUoITEsKGg9dGhpcy5fcmVuZGVyVGFyZ2V0KSE9PW51bGwmJmghPT12b2lkIDA/aDp2b2lkIDAsZSx0aGlzLl9wb3N0UHJvY2Vzc2VzLHRoaXMuaWdub3JlQ2FtZXJhVmlld3BvcnQpOnQmJmQucG9zdFByb2Nlc3NNYW5hZ2VyLl9maW5hbGl6ZUZyYW1lKCExLChsPXRoaXMuX3JlbmRlclRhcmdldCkhPT1udWxsJiZsIT09dm9pZCAwP2w6dm9pZCAwLGUpO2Zvcihjb25zdCB5IG9mIGQuX2FmdGVyUmVuZGVyVGFyZ2V0UG9zdFByb2Nlc3NTdGFnZSl5LmFjdGlvbih0aGlzLGUscyk7dGhpcy5fdGV4dHVyZSYmKHRoaXMuX3RleHR1cmUuZ2VuZXJhdGVNaXBNYXBzPVMpLHRoaXMuX2RvTm90Q2hhbmdlQXNwZWN0UmF0aW98fGQudXBkYXRlVHJhbnNmb3JtTWF0cml4KCEwKSxpJiZ0dC5EdW1wRnJhbWVidWZmZXIodGhpcy5nZXRSZW5kZXJXaWR0aCgpLHRoaXMuZ2V0UmVuZGVySGVpZ2h0KCksZil9dGhpcy5fdW5iaW5kRnJhbWVCdWZmZXIoZixlKSx0aGlzLl90ZXh0dXJlJiZ0aGlzLmlzQ3ViZSYmZT09PTUmJmYuZ2VuZXJhdGVNaXBNYXBzRm9yQ3ViZW1hcCh0aGlzLl90ZXh0dXJlKSwodT1mLl9kZWJ1Z1BvcEdyb3VwKT09PW51bGx8fHU9PT12b2lkIDB8fHUuY2FsbChmLDEpfXNldFJlbmRlcmluZ09yZGVyKGUsdD1udWxsLGk9bnVsbCxzPW51bGwpe3RoaXMuX3JlbmRlcmluZ01hbmFnZXIuc2V0UmVuZGVyaW5nT3JkZXIoZSx0LGkscyl9c2V0UmVuZGVyaW5nQXV0b0NsZWFyRGVwdGhTdGVuY2lsKGUsdCl7dGhpcy5fcmVuZGVyaW5nTWFuYWdlci5zZXRSZW5kZXJpbmdBdXRvQ2xlYXJEZXB0aFN0ZW5jaWwoZSx0KSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLl91c2VTY2VuZUF1dG9DbGVhclNldHVwPSExfWNsb25lKCl7Y29uc3QgZT10aGlzLmdldFNpemUoKSx0PW5ldyBfdCh0aGlzLm5hbWUsZSx0aGlzLmdldFNjZW5lKCksdGhpcy5fcmVuZGVyVGFyZ2V0T3B0aW9ucy5nZW5lcmF0ZU1pcE1hcHMsdGhpcy5fZG9Ob3RDaGFuZ2VBc3BlY3RSYXRpbyx0aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zLnR5cGUsdGhpcy5pc0N1YmUsdGhpcy5fcmVuZGVyVGFyZ2V0T3B0aW9ucy5zYW1wbGluZ01vZGUsdGhpcy5fcmVuZGVyVGFyZ2V0T3B0aW9ucy5nZW5lcmF0ZURlcHRoQnVmZmVyLHRoaXMuX3JlbmRlclRhcmdldE9wdGlvbnMuZ2VuZXJhdGVTdGVuY2lsQnVmZmVyLHZvaWQgMCx0aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zLmZvcm1hdCx2b2lkIDAsdGhpcy5fcmVuZGVyVGFyZ2V0T3B0aW9ucy5zYW1wbGVzKTtyZXR1cm4gdC5oYXNBbHBoYT10aGlzLmhhc0FscGhhLHQubGV2ZWw9dGhpcy5sZXZlbCx0LmNvb3JkaW5hdGVzTW9kZT10aGlzLmNvb3JkaW5hdGVzTW9kZSx0aGlzLnJlbmRlckxpc3QmJih0LnJlbmRlckxpc3Q9dGhpcy5yZW5kZXJMaXN0LnNsaWNlKDApKSx0fXNlcmlhbGl6ZSgpe2lmKCF0aGlzLm5hbWUpcmV0dXJuIG51bGw7Y29uc3QgZT1zdXBlci5zZXJpYWxpemUoKTtpZihlLnJlbmRlclRhcmdldFNpemU9dGhpcy5nZXRSZW5kZXJTaXplKCksZS5yZW5kZXJMaXN0PVtdLHRoaXMucmVuZGVyTGlzdClmb3IobGV0IHQ9MDt0PHRoaXMucmVuZGVyTGlzdC5sZW5ndGg7dCsrKWUucmVuZGVyTGlzdC5wdXNoKHRoaXMucmVuZGVyTGlzdFt0XS5pZCk7cmV0dXJuIGV9ZGlzcG9zZUZyYW1lYnVmZmVyT2JqZWN0cygpe3ZhciBlOyhlPXRoaXMuX3JlbmRlclRhcmdldCk9PT1udWxsfHxlPT09dm9pZCAwfHxlLmRpc3Bvc2UoITApfXJlbGVhc2VJbnRlcm5hbFRleHR1cmUoKXt2YXIgZTsoZT10aGlzLl9yZW5kZXJUYXJnZXQpPT09bnVsbHx8ZT09PXZvaWQgMHx8ZS5yZWxlYXNlVGV4dHVyZXMoKSx0aGlzLl90ZXh0dXJlPW51bGx9ZGlzcG9zZSgpe3ZhciBlO3RoaXMub25SZXNpemVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNsZWFyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkJlZm9yZUJpbmRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXImJih0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIuZGlzcG9zZSgpLHRoaXMuX3Bvc3RQcm9jZXNzTWFuYWdlcj1udWxsKSx0aGlzLl9wcmVQYXNzUmVuZGVyVGFyZ2V0JiZ0aGlzLl9wcmVQYXNzUmVuZGVyVGFyZ2V0LmRpc3Bvc2UoKSx0aGlzLl9yZWxlYXNlUmVuZGVyUGFzc0lkKCksdGhpcy5jbGVhclBvc3RQcm9jZXNzZXMoITApLHRoaXMuX3Jlc2l6ZU9ic2VydmVyJiYodGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLm9uUmVzaXplT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fcmVzaXplT2JzZXJ2ZXIpLHRoaXMuX3Jlc2l6ZU9ic2VydmVyPW51bGwpLHRoaXMucmVuZGVyTGlzdD1udWxsO2NvbnN0IHQ9dGhpcy5nZXRTY2VuZSgpO2lmKCF0KXJldHVybjtsZXQgaT10LmN1c3RvbVJlbmRlclRhcmdldHMuaW5kZXhPZih0aGlzKTtpPj0wJiZ0LmN1c3RvbVJlbmRlclRhcmdldHMuc3BsaWNlKGksMSk7Zm9yKGNvbnN0IHMgb2YgdC5jYW1lcmFzKWk9cy5jdXN0b21SZW5kZXJUYXJnZXRzLmluZGV4T2YodGhpcyksaT49MCYmcy5jdXN0b21SZW5kZXJUYXJnZXRzLnNwbGljZShpLDEpOyhlPXRoaXMuX3JlbmRlclRhcmdldCk9PT1udWxsfHxlPT09dm9pZCAwfHxlLmRpc3Bvc2UoKSx0aGlzLl9yZW5kZXJUYXJnZXQ9bnVsbCx0aGlzLl90ZXh0dXJlPW51bGwsc3VwZXIuZGlzcG9zZSgpfV9yZWJ1aWxkKCl7dGhpcy5yZWZyZXNoUmF0ZT09PV90LlJFRlJFU0hSQVRFX1JFTkRFUl9PTkNFJiYodGhpcy5yZWZyZXNoUmF0ZT1fdC5SRUZSRVNIUkFURV9SRU5ERVJfT05DRSksdGhpcy5fcG9zdFByb2Nlc3NNYW5hZ2VyJiZ0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIuX3JlYnVpbGQoKX1mcmVlUmVuZGVyaW5nR3JvdXBzKCl7dGhpcy5fcmVuZGVyaW5nTWFuYWdlciYmdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5mcmVlUmVuZGVyaW5nR3JvdXBzKCl9Z2V0Vmlld0NvdW50KCl7cmV0dXJuIDF9fV90LlJFRlJFU0hSQVRFX1JFTkRFUl9PTkNFPTAsX3QuUkVGUkVTSFJBVEVfUkVOREVSX09ORVZFUllGUkFNRT0xLF90LlJFRlJFU0hSQVRFX1JFTkRFUl9PTkVWRVJZVFdPRlJBTUVTPTIsTi5fQ3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZT0oYyxlLHQsaSxzKT0+bmV3IF90KGMsZSx0LGkpO2NsYXNzIE1le2NvbnN0cnVjdG9yKGUsdCxpLHMscixuLGE9MSxvLGgsbD1udWxsLHU9MCxkPSJwb3N0cHJvY2VzcyIsZixfPSExLEU9NSxtPVplLkdMU0wpe3RoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsLHRoaXMud2lkdGg9LTEsdGhpcy5oZWlnaHQ9LTEsdGhpcy5ub2RlTWF0ZXJpYWxTb3VyY2U9bnVsbCx0aGlzLl9vdXRwdXRUZXh0dXJlPW51bGwsdGhpcy5hdXRvQ2xlYXI9ITAsdGhpcy5hbHBoYU1vZGU9MCx0aGlzLmFuaW1hdGlvbnM9bmV3IEFycmF5LHRoaXMuZW5hYmxlUGl4ZWxQZXJmZWN0TW9kZT0hMSx0aGlzLmZvcmNlRnVsbHNjcmVlblZpZXdwb3J0PSEwLHRoaXMuc2NhbGVNb2RlPTEsdGhpcy5hbHdheXNGb3JjZVBPVD0hMSx0aGlzLl9zYW1wbGVzPTEsdGhpcy5hZGFwdFNjYWxlVG9DdXJyZW50Vmlld3BvcnQ9ITEsdGhpcy5fcmV1c2FibGU9ITEsdGhpcy5fcmVuZGVySWQ9MCx0aGlzLmV4dGVybmFsVGV4dHVyZVNhbXBsZXJCaW5kaW5nPSExLHRoaXMuX3RleHR1cmVzPW5ldyAkZSgyKSx0aGlzLl90ZXh0dXJlQ2FjaGU9W10sdGhpcy5fY3VycmVudFJlbmRlclRleHR1cmVJbmQ9MCx0aGlzLl9zY2FsZVJhdGlvPW5ldyB2ZSgxLDEpLHRoaXMuX3RleGVsU2l6ZT12ZS5aZXJvKCksdGhpcy5vbkFjdGl2YXRlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uU2l6ZUNoYW5nZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BcHBseU9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm5hbWU9ZSxuIT1udWxsPyh0aGlzLl9jYW1lcmE9bix0aGlzLl9zY2VuZT1uLmdldFNjZW5lKCksbi5hdHRhY2hQb3N0UHJvY2Vzcyh0aGlzKSx0aGlzLl9lbmdpbmU9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksdGhpcy5fc2NlbmUucG9zdFByb2Nlc3Nlcy5wdXNoKHRoaXMpLHRoaXMudW5pcXVlSWQ9dGhpcy5fc2NlbmUuZ2V0VW5pcXVlSWQoKSk6byYmKHRoaXMuX2VuZ2luZT1vLHRoaXMuX2VuZ2luZS5wb3N0UHJvY2Vzc2VzLnB1c2godGhpcykpLHRoaXMuX29wdGlvbnM9cix0aGlzLnJlbmRlclRhcmdldFNhbXBsaW5nTW9kZT1hfHwxLHRoaXMuX3JldXNhYmxlPWh8fCExLHRoaXMuX3RleHR1cmVUeXBlPXUsdGhpcy5fdGV4dHVyZUZvcm1hdD1FLHRoaXMuX3NoYWRlckxhbmd1YWdlPW0sdGhpcy5fc2FtcGxlcnM9c3x8W10sdGhpcy5fc2FtcGxlcnMucHVzaCgidGV4dHVyZVNhbXBsZXIiKSx0aGlzLl9mcmFnbWVudFVybD10LHRoaXMuX3ZlcnRleFVybD1kLHRoaXMuX3BhcmFtZXRlcnM9aXx8W10sdGhpcy5fcGFyYW1ldGVycy5wdXNoKCJzY2FsZSIpLHRoaXMuX2luZGV4UGFyYW1ldGVycz1mLHRoaXMuX2RyYXdXcmFwcGVyPW5ldyBtaSh0aGlzLl9lbmdpbmUpLF98fHRoaXMudXBkYXRlRWZmZWN0KGwpfXN0YXRpYyBSZWdpc3RlclNoYWRlckNvZGVQcm9jZXNzaW5nKGUsdCl7aWYoIXQpe2RlbGV0ZSBNZS5fQ3VzdG9tU2hhZGVyQ29kZVByb2Nlc3NpbmdbZT8/IiJdO3JldHVybn1NZS5fQ3VzdG9tU2hhZGVyQ29kZVByb2Nlc3NpbmdbZT8/IiJdPXR9c3RhdGljIF9HZXRTaGFkZXJDb2RlUHJvY2Vzc2luZyhlKXt2YXIgdDtyZXR1cm4odD1NZS5fQ3VzdG9tU2hhZGVyQ29kZVByb2Nlc3NpbmdbZV0pIT09bnVsbCYmdCE9PXZvaWQgMD90Ok1lLl9DdXN0b21TaGFkZXJDb2RlUHJvY2Vzc2luZ1siIl19Z2V0IHNhbXBsZXMoKXtyZXR1cm4gdGhpcy5fc2FtcGxlc31zZXQgc2FtcGxlcyhlKXt0aGlzLl9zYW1wbGVzPU1hdGgubWluKGUsdGhpcy5fZW5naW5lLmdldENhcHMoKS5tYXhNU0FBU2FtcGxlcyksdGhpcy5fdGV4dHVyZXMuZm9yRWFjaCh0PT57dC5zZXRTYW1wbGVzKHRoaXMuX3NhbXBsZXMpfSl9Z2V0RWZmZWN0TmFtZSgpe3JldHVybiB0aGlzLl9mcmFnbWVudFVybH1zZXQgb25BY3RpdmF0ZShlKXt0aGlzLl9vbkFjdGl2YXRlT2JzZXJ2ZXImJnRoaXMub25BY3RpdmF0ZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQWN0aXZhdGVPYnNlcnZlciksZSYmKHRoaXMuX29uQWN0aXZhdGVPYnNlcnZlcj10aGlzLm9uQWN0aXZhdGVPYnNlcnZhYmxlLmFkZChlKSl9c2V0IG9uU2l6ZUNoYW5nZWQoZSl7dGhpcy5fb25TaXplQ2hhbmdlZE9ic2VydmVyJiZ0aGlzLm9uU2l6ZUNoYW5nZWRPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vblNpemVDaGFuZ2VkT2JzZXJ2ZXIpLHRoaXMuX29uU2l6ZUNoYW5nZWRPYnNlcnZlcj10aGlzLm9uU2l6ZUNoYW5nZWRPYnNlcnZhYmxlLmFkZChlKX1zZXQgb25BcHBseShlKXt0aGlzLl9vbkFwcGx5T2JzZXJ2ZXImJnRoaXMub25BcHBseU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQXBwbHlPYnNlcnZlciksdGhpcy5fb25BcHBseU9ic2VydmVyPXRoaXMub25BcHBseU9ic2VydmFibGUuYWRkKGUpfXNldCBvbkJlZm9yZVJlbmRlcihlKXt0aGlzLl9vbkJlZm9yZVJlbmRlck9ic2VydmVyJiZ0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25CZWZvcmVSZW5kZXJPYnNlcnZlciksdGhpcy5fb25CZWZvcmVSZW5kZXJPYnNlcnZlcj10aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5hZGQoZSl9c2V0IG9uQWZ0ZXJSZW5kZXIoZSl7dGhpcy5fb25BZnRlclJlbmRlck9ic2VydmVyJiZ0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXIpLHRoaXMuX29uQWZ0ZXJSZW5kZXJPYnNlcnZlcj10aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLmFkZChlKX1nZXQgaW5wdXRUZXh0dXJlKCl7cmV0dXJuIHRoaXMuX3RleHR1cmVzLmRhdGFbdGhpcy5fY3VycmVudFJlbmRlclRleHR1cmVJbmRdfXNldCBpbnB1dFRleHR1cmUoZSl7dGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZT1lfXJlc3RvcmVEZWZhdWx0SW5wdXRUZXh0dXJlKCl7dGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZSYmKHRoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmU9bnVsbCx0aGlzLm1hcmtUZXh0dXJlRGlydHkoKSl9Z2V0Q2FtZXJhKCl7cmV0dXJuIHRoaXMuX2NhbWVyYX1nZXQgdGV4ZWxTaXplKCl7cmV0dXJuIHRoaXMuX3NoYXJlT3V0cHV0V2l0aFBvc3RQcm9jZXNzP3RoaXMuX3NoYXJlT3V0cHV0V2l0aFBvc3RQcm9jZXNzLnRleGVsU2l6ZToodGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZSYmdGhpcy5fdGV4ZWxTaXplLmNvcHlGcm9tRmxvYXRzKDEvdGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZS53aWR0aCwxL3RoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmUuaGVpZ2h0KSx0aGlzLl90ZXhlbFNpemUpfWdldENsYXNzTmFtZSgpe3JldHVybiJQb3N0UHJvY2VzcyJ9Z2V0RW5naW5lKCl7cmV0dXJuIHRoaXMuX2VuZ2luZX1nZXRFZmZlY3QoKXtyZXR1cm4gdGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0fXNoYXJlT3V0cHV0V2l0aChlKXtyZXR1cm4gdGhpcy5fZGlzcG9zZVRleHR1cmVzKCksdGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3M9ZSx0aGlzfXVzZU93bk91dHB1dCgpe3RoaXMuX3RleHR1cmVzLmxlbmd0aD09MCYmKHRoaXMuX3RleHR1cmVzPW5ldyAkZSgyKSksdGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3M9bnVsbH11cGRhdGVFZmZlY3QoZT1udWxsLHQ9bnVsbCxpPW51bGwscyxyLG4sYSxvKXt2YXIgaCxsO2NvbnN0IHU9TWUuX0dldFNoYWRlckNvZGVQcm9jZXNzaW5nKHRoaXMubmFtZSk7aWYodSE9bnVsbCYmdS5kZWZpbmVDdXN0b21CaW5kaW5ncyl7Y29uc3QgZD0oaD10PT1udWxsP3ZvaWQgMDp0LnNsaWNlKCkpIT09bnVsbCYmaCE9PXZvaWQgMD9oOltdO2QucHVzaCguLi50aGlzLl9wYXJhbWV0ZXJzKTtjb25zdCBmPShsPWk9PW51bGw/dm9pZCAwOmkuc2xpY2UoKSkhPT1udWxsJiZsIT09dm9pZCAwP2w6W107Zi5wdXNoKC4uLnRoaXMuX3NhbXBsZXJzKSxlPXUuZGVmaW5lQ3VzdG9tQmluZGluZ3ModGhpcy5uYW1lLGUsZCxmKSx0PWQsaT1mfXRoaXMuX3Bvc3RQcm9jZXNzRGVmaW5lcz1lLHRoaXMuX2RyYXdXcmFwcGVyLmVmZmVjdD10aGlzLl9lbmdpbmUuY3JlYXRlRWZmZWN0KHt2ZXJ0ZXg6YT8/dGhpcy5fdmVydGV4VXJsLGZyYWdtZW50Om8/P3RoaXMuX2ZyYWdtZW50VXJsfSx7YXR0cmlidXRlczpbInBvc2l0aW9uIl0sdW5pZm9ybXNOYW1lczp0fHx0aGlzLl9wYXJhbWV0ZXJzLHVuaWZvcm1CdWZmZXJzTmFtZXM6W10sc2FtcGxlcnM6aXx8dGhpcy5fc2FtcGxlcnMsZGVmaW5lczplIT09bnVsbD9lOiIiLGZhbGxiYWNrczpudWxsLG9uQ29tcGlsZWQ6cj8/bnVsbCxvbkVycm9yOm4/P251bGwsaW5kZXhQYXJhbWV0ZXJzOnN8fHRoaXMuX2luZGV4UGFyYW1ldGVycyxwcm9jZXNzQ29kZUFmdGVySW5jbHVkZXM6dSE9bnVsbCYmdS5wcm9jZXNzQ29kZUFmdGVySW5jbHVkZXM/KGQsZik9PnUucHJvY2Vzc0NvZGVBZnRlckluY2x1ZGVzKHRoaXMubmFtZSxkLGYpOm51bGwscHJvY2Vzc0ZpbmFsQ29kZTp1IT1udWxsJiZ1LnByb2Nlc3NGaW5hbENvZGU/KGQsZik9PnUucHJvY2Vzc0ZpbmFsQ29kZSh0aGlzLm5hbWUsZCxmKTpudWxsLHNoYWRlckxhbmd1YWdlOnRoaXMuX3NoYWRlckxhbmd1YWdlfSx0aGlzLl9lbmdpbmUpfWlzUmV1c2FibGUoKXtyZXR1cm4gdGhpcy5fcmV1c2FibGV9bWFya1RleHR1cmVEaXJ0eSgpe3RoaXMud2lkdGg9LTF9X2NyZWF0ZVJlbmRlclRhcmdldFRleHR1cmUoZSx0LGk9MCl7Zm9yKGxldCByPTA7cjx0aGlzLl90ZXh0dXJlQ2FjaGUubGVuZ3RoO3IrKylpZih0aGlzLl90ZXh0dXJlQ2FjaGVbcl0udGV4dHVyZS53aWR0aD09PWUud2lkdGgmJnRoaXMuX3RleHR1cmVDYWNoZVtyXS50ZXh0dXJlLmhlaWdodD09PWUuaGVpZ2h0JiZ0aGlzLl90ZXh0dXJlQ2FjaGVbcl0ucG9zdFByb2Nlc3NDaGFubmVsPT09aSYmdGhpcy5fdGV4dHVyZUNhY2hlW3JdLnRleHR1cmUuX2dlbmVyYXRlRGVwdGhCdWZmZXI9PT10LmdlbmVyYXRlRGVwdGhCdWZmZXImJnRoaXMuX3RleHR1cmVDYWNoZVtyXS50ZXh0dXJlLnNhbXBsZXM9PT10LnNhbXBsZXMpcmV0dXJuIHRoaXMuX3RleHR1cmVDYWNoZVtyXS50ZXh0dXJlO2NvbnN0IHM9dGhpcy5fZW5naW5lLmNyZWF0ZVJlbmRlclRhcmdldFRleHR1cmUoZSx0KTtyZXR1cm4gdGhpcy5fdGV4dHVyZUNhY2hlLnB1c2goe3RleHR1cmU6cyxwb3N0UHJvY2Vzc0NoYW5uZWw6aSxsYXN0VXNlZFJlbmRlcklkOi0xfSksc31fZmx1c2hUZXh0dXJlQ2FjaGUoKXtjb25zdCBlPXRoaXMuX3JlbmRlcklkO2ZvcihsZXQgdD10aGlzLl90ZXh0dXJlQ2FjaGUubGVuZ3RoLTE7dD49MDt0LS0paWYoZS10aGlzLl90ZXh0dXJlQ2FjaGVbdF0ubGFzdFVzZWRSZW5kZXJJZD4xMDApe2xldCBpPSExO2ZvcihsZXQgcz0wO3M8dGhpcy5fdGV4dHVyZXMubGVuZ3RoO3MrKylpZih0aGlzLl90ZXh0dXJlcy5kYXRhW3NdPT09dGhpcy5fdGV4dHVyZUNhY2hlW3RdLnRleHR1cmUpe2k9ITA7YnJlYWt9aXx8KHRoaXMuX3RleHR1cmVDYWNoZVt0XS50ZXh0dXJlLmRpc3Bvc2UoKSx0aGlzLl90ZXh0dXJlQ2FjaGUuc3BsaWNlKHQsMSkpfX1fcmVzaXplKGUsdCxpLHMscil7dGhpcy5fdGV4dHVyZXMubGVuZ3RoPjAmJnRoaXMuX3RleHR1cmVzLnJlc2V0KCksdGhpcy53aWR0aD1lLHRoaXMuaGVpZ2h0PXQ7bGV0IG49bnVsbDtmb3IobGV0IGg9MDtoPGkuX3Bvc3RQcm9jZXNzZXMubGVuZ3RoO2grKylpZihpLl9wb3N0UHJvY2Vzc2VzW2hdIT09bnVsbCl7bj1pLl9wb3N0UHJvY2Vzc2VzW2hdO2JyZWFrfWNvbnN0IGE9e3dpZHRoOnRoaXMud2lkdGgsaGVpZ2h0OnRoaXMuaGVpZ2h0fSxvPXtnZW5lcmF0ZU1pcE1hcHM6cyxnZW5lcmF0ZURlcHRoQnVmZmVyOnJ8fG49PT10aGlzLGdlbmVyYXRlU3RlbmNpbEJ1ZmZlcjoocnx8bj09PXRoaXMpJiZ0aGlzLl9lbmdpbmUuaXNTdGVuY2lsRW5hYmxlLHNhbXBsaW5nTW9kZTp0aGlzLnJlbmRlclRhcmdldFNhbXBsaW5nTW9kZSx0eXBlOnRoaXMuX3RleHR1cmVUeXBlLGZvcm1hdDp0aGlzLl90ZXh0dXJlRm9ybWF0LHNhbXBsZXM6dGhpcy5fc2FtcGxlc307dGhpcy5fdGV4dHVyZXMucHVzaCh0aGlzLl9jcmVhdGVSZW5kZXJUYXJnZXRUZXh0dXJlKGEsbywwKSksdGhpcy5fcmV1c2FibGUmJnRoaXMuX3RleHR1cmVzLnB1c2godGhpcy5fY3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZShhLG8sMSkpLHRoaXMuX3RleGVsU2l6ZS5jb3B5RnJvbUZsb2F0cygxL3RoaXMud2lkdGgsMS90aGlzLmhlaWdodCksdGhpcy5vblNpemVDaGFuZ2VkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyl9YWN0aXZhdGUoZSx0PW51bGwsaSl7dmFyIHMscjtlPWV8fHRoaXMuX2NhbWVyYTtjb25zdCBuPWUuZ2V0U2NlbmUoKSxhPW4uZ2V0RW5naW5lKCksbz1hLmdldENhcHMoKS5tYXhUZXh0dXJlU2l6ZTtsZXQgaD0odD90LndpZHRoOnRoaXMuX2VuZ2luZS5nZXRSZW5kZXJXaWR0aCghMCkpKnRoaXMuX29wdGlvbnN8MDtjb25zdCBsPSh0P3QuaGVpZ2h0OnRoaXMuX2VuZ2luZS5nZXRSZW5kZXJIZWlnaHQoITApKSp0aGlzLl9vcHRpb25zfDAsdT1lLnBhcmVudDt1JiYodS5sZWZ0Q2FtZXJhPT1lfHx1LnJpZ2h0Q2FtZXJhPT1lKSYmKGgvPTIpO2xldCBkPXRoaXMuX29wdGlvbnMud2lkdGh8fGgsZj10aGlzLl9vcHRpb25zLmhlaWdodHx8bDtjb25zdCBfPXRoaXMucmVuZGVyVGFyZ2V0U2FtcGxpbmdNb2RlIT09NyYmdGhpcy5yZW5kZXJUYXJnZXRTYW1wbGluZ01vZGUhPT0xJiZ0aGlzLnJlbmRlclRhcmdldFNhbXBsaW5nTW9kZSE9PTI7aWYoIXRoaXMuX3NoYXJlT3V0cHV0V2l0aFBvc3RQcm9jZXNzJiYhdGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZSl7aWYodGhpcy5hZGFwdFNjYWxlVG9DdXJyZW50Vmlld3BvcnQpe2NvbnN0IG09YS5jdXJyZW50Vmlld3BvcnQ7bSYmKGQqPW0ud2lkdGgsZio9bS5oZWlnaHQpfShffHx0aGlzLmFsd2F5c0ZvcmNlUE9UKSYmKHRoaXMuX29wdGlvbnMud2lkdGh8fChkPWEubmVlZFBPVFRleHR1cmVzP0kuR2V0RXhwb25lbnRPZlR3byhkLG8sdGhpcy5zY2FsZU1vZGUpOmQpLHRoaXMuX29wdGlvbnMuaGVpZ2h0fHwoZj1hLm5lZWRQT1RUZXh0dXJlcz9JLkdldEV4cG9uZW50T2ZUd28oZixvLHRoaXMuc2NhbGVNb2RlKTpmKSksKHRoaXMud2lkdGghPT1kfHx0aGlzLmhlaWdodCE9PWYpJiZ0aGlzLl9yZXNpemUoZCxmLGUsXyxpKSx0aGlzLl90ZXh0dXJlcy5mb3JFYWNoKG09PnttLnNhbXBsZXMhPT10aGlzLnNhbXBsZXMmJnRoaXMuX2VuZ2luZS51cGRhdGVSZW5kZXJUYXJnZXRUZXh0dXJlU2FtcGxlQ291bnQobSx0aGlzLnNhbXBsZXMpfSksdGhpcy5fZmx1c2hUZXh0dXJlQ2FjaGUoKSx0aGlzLl9yZW5kZXJJZCsrfWxldCBFO2lmKHRoaXMuX3NoYXJlT3V0cHV0V2l0aFBvc3RQcm9jZXNzKUU9dGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3MuaW5wdXRUZXh0dXJlO2Vsc2UgaWYodGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZSlFPXRoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmUsdGhpcy53aWR0aD10aGlzLl9mb3JjZWRPdXRwdXRUZXh0dXJlLndpZHRoLHRoaXMuaGVpZ2h0PXRoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmUuaGVpZ2h0O2Vsc2V7RT10aGlzLmlucHV0VGV4dHVyZTtsZXQgbTtmb3IobGV0IHY9MDt2PHRoaXMuX3RleHR1cmVDYWNoZS5sZW5ndGg7disrKWlmKHRoaXMuX3RleHR1cmVDYWNoZVt2XS50ZXh0dXJlPT09RSl7bT10aGlzLl90ZXh0dXJlQ2FjaGVbdl07YnJlYWt9bSYmKG0ubGFzdFVzZWRSZW5kZXJJZD10aGlzLl9yZW5kZXJJZCl9cmV0dXJuIHRoaXMuZW5hYmxlUGl4ZWxQZXJmZWN0TW9kZT8odGhpcy5fc2NhbGVSYXRpby5jb3B5RnJvbUZsb2F0cyhoL2QsbC9mKSx0aGlzLl9lbmdpbmUuYmluZEZyYW1lYnVmZmVyKEUsMCxoLGwsdGhpcy5mb3JjZUZ1bGxzY3JlZW5WaWV3cG9ydCkpOih0aGlzLl9zY2FsZVJhdGlvLmNvcHlGcm9tRmxvYXRzKDEsMSksdGhpcy5fZW5naW5lLmJpbmRGcmFtZWJ1ZmZlcihFLDAsdm9pZCAwLHZvaWQgMCx0aGlzLmZvcmNlRnVsbHNjcmVlblZpZXdwb3J0KSksKHI9KHM9dGhpcy5fZW5naW5lKS5fZGVidWdJbnNlcnRNYXJrZXIpPT09bnVsbHx8cj09PXZvaWQgMHx8ci5jYWxsKHMsYHBvc3QgcHJvY2VzcyAke3RoaXMubmFtZX0gaW5wdXRgKSx0aGlzLm9uQWN0aXZhdGVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0aGlzLmF1dG9DbGVhciYmdGhpcy5hbHBoYU1vZGU9PT0wJiZ0aGlzLl9lbmdpbmUuY2xlYXIodGhpcy5jbGVhckNvbG9yP3RoaXMuY2xlYXJDb2xvcjpuLmNsZWFyQ29sb3Isbi5fYWxsb3dQb3N0UHJvY2Vzc0NsZWFyQ29sb3IsITAsITApLHRoaXMuX3JldXNhYmxlJiYodGhpcy5fY3VycmVudFJlbmRlclRleHR1cmVJbmQ9KHRoaXMuX2N1cnJlbnRSZW5kZXJUZXh0dXJlSW5kKzEpJTIpLEV9Z2V0IGlzU3VwcG9ydGVkKCl7cmV0dXJuIHRoaXMuX2RyYXdXcmFwcGVyLmVmZmVjdC5pc1N1cHBvcnRlZH1nZXQgYXNwZWN0UmF0aW8oKXtyZXR1cm4gdGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3M/dGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3MuYXNwZWN0UmF0aW86dGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZT90aGlzLl9mb3JjZWRPdXRwdXRUZXh0dXJlLndpZHRoL3RoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmUuaGVpZ2h0OnRoaXMud2lkdGgvdGhpcy5oZWlnaHR9aXNSZWFkeSgpe3ZhciBlLHQ7cmV0dXJuKHQ9KGU9dGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0KT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUuaXNSZWFkeSgpKSE9PW51bGwmJnQhPT12b2lkIDA/dDohMX1hcHBseSgpe3ZhciBlLHQsaTtpZighKCEoKGU9dGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0KT09PW51bGx8fGU9PT12b2lkIDApJiZlLmlzUmVhZHkoKSkpcmV0dXJuIG51bGw7dGhpcy5fZW5naW5lLmVuYWJsZUVmZmVjdCh0aGlzLl9kcmF3V3JhcHBlciksdGhpcy5fZW5naW5lLnNldFN0YXRlKCExKSx0aGlzLl9lbmdpbmUuc2V0RGVwdGhCdWZmZXIoITEpLHRoaXMuX2VuZ2luZS5zZXREZXB0aFdyaXRlKCExKSx0aGlzLl9lbmdpbmUuc2V0QWxwaGFNb2RlKHRoaXMuYWxwaGFNb2RlKSx0aGlzLmFscGhhQ29uc3RhbnRzJiZ0aGlzLmdldEVuZ2luZSgpLnNldEFscGhhQ29uc3RhbnRzKHRoaXMuYWxwaGFDb25zdGFudHMucix0aGlzLmFscGhhQ29uc3RhbnRzLmcsdGhpcy5hbHBoYUNvbnN0YW50cy5iLHRoaXMuYWxwaGFDb25zdGFudHMuYSk7bGV0IHM7cmV0dXJuIHRoaXMuX3NoYXJlT3V0cHV0V2l0aFBvc3RQcm9jZXNzP3M9dGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3MuaW5wdXRUZXh0dXJlOnRoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmU/cz10aGlzLl9mb3JjZWRPdXRwdXRUZXh0dXJlOnM9dGhpcy5pbnB1dFRleHR1cmUsdGhpcy5leHRlcm5hbFRleHR1cmVTYW1wbGVyQmluZGluZ3x8dGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0Ll9iaW5kVGV4dHVyZSgidGV4dHVyZVNhbXBsZXIiLHM9PW51bGw/dm9pZCAwOnMudGV4dHVyZSksdGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0LnNldFZlY3RvcjIoInNjYWxlIix0aGlzLl9zY2FsZVJhdGlvKSx0aGlzLm9uQXBwbHlPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3QpLChpPSh0PU1lLl9HZXRTaGFkZXJDb2RlUHJvY2Vzc2luZyh0aGlzLm5hbWUpKT09PW51bGx8fHQ9PT12b2lkIDA/dm9pZCAwOnQuYmluZEN1c3RvbUJpbmRpbmdzKT09PW51bGx8fGk9PT12b2lkIDB8fGkuY2FsbCh0LHRoaXMubmFtZSx0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3QpLHRoaXMuX2RyYXdXcmFwcGVyLmVmZmVjdH1fZGlzcG9zZVRleHR1cmVzKCl7aWYodGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3N8fHRoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmUpe3RoaXMuX2Rpc3Bvc2VUZXh0dXJlQ2FjaGUoKTtyZXR1cm59dGhpcy5fZGlzcG9zZVRleHR1cmVDYWNoZSgpLHRoaXMuX3RleHR1cmVzLmRpc3Bvc2UoKX1fZGlzcG9zZVRleHR1cmVDYWNoZSgpe2ZvcihsZXQgZT10aGlzLl90ZXh0dXJlQ2FjaGUubGVuZ3RoLTE7ZT49MDtlLS0pdGhpcy5fdGV4dHVyZUNhY2hlW2VdLnRleHR1cmUuZGlzcG9zZSgpO3RoaXMuX3RleHR1cmVDYWNoZS5sZW5ndGg9MH1zZXRQcmVQYXNzUmVuZGVyZXIoZSl7cmV0dXJuIHRoaXMuX3ByZVBhc3NFZmZlY3RDb25maWd1cmF0aW9uPyh0aGlzLl9wcmVQYXNzRWZmZWN0Q29uZmlndXJhdGlvbj1lLmFkZEVmZmVjdENvbmZpZ3VyYXRpb24odGhpcy5fcHJlUGFzc0VmZmVjdENvbmZpZ3VyYXRpb24pLHRoaXMuX3ByZVBhc3NFZmZlY3RDb25maWd1cmF0aW9uLmVuYWJsZWQ9ITAsITApOiExfWRpc3Bvc2UoZSl7ZT1lfHx0aGlzLl9jYW1lcmEsdGhpcy5fZGlzcG9zZVRleHR1cmVzKCk7bGV0IHQ7aWYodGhpcy5fc2NlbmUmJih0PXRoaXMuX3NjZW5lLnBvc3RQcm9jZXNzZXMuaW5kZXhPZih0aGlzKSx0IT09LTEmJnRoaXMuX3NjZW5lLnBvc3RQcm9jZXNzZXMuc3BsaWNlKHQsMSkpLHRoaXMuX3BhcmVudENvbnRhaW5lcil7Y29uc3QgaT10aGlzLl9wYXJlbnRDb250YWluZXIucG9zdFByb2Nlc3Nlcy5pbmRleE9mKHRoaXMpO2k+LTEmJnRoaXMuX3BhcmVudENvbnRhaW5lci5wb3N0UHJvY2Vzc2VzLnNwbGljZShpLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfWlmKHQ9dGhpcy5fZW5naW5lLnBvc3RQcm9jZXNzZXMuaW5kZXhPZih0aGlzKSx0IT09LTEmJnRoaXMuX2VuZ2luZS5wb3N0UHJvY2Vzc2VzLnNwbGljZSh0LDEpLCEhZSl7aWYoZS5kZXRhY2hQb3N0UHJvY2Vzcyh0aGlzKSx0PWUuX3Bvc3RQcm9jZXNzZXMuaW5kZXhPZih0aGlzKSx0PT09MCYmZS5fcG9zdFByb2Nlc3Nlcy5sZW5ndGg+MCl7Y29uc3QgaT10aGlzLl9jYW1lcmEuX2dldEZpcnN0UG9zdFByb2Nlc3MoKTtpJiZpLm1hcmtUZXh0dXJlRGlydHkoKX10aGlzLm9uQWN0aXZhdGVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BcHBseU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25TaXplQ2hhbmdlZE9ic2VydmFibGUuY2xlYXIoKX19c2VyaWFsaXplKCl7Y29uc3QgZT1hZS5TZXJpYWxpemUodGhpcyksdD10aGlzLmdldENhbWVyYSgpfHx0aGlzLl9zY2VuZSYmdGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhO3JldHVybiBlLmN1c3RvbVR5cGU9IkJBQllMT04uIit0aGlzLmdldENsYXNzTmFtZSgpLGUuY2FtZXJhSWQ9dD90LmlkOm51bGwsZS5yZXVzYWJsZT10aGlzLl9yZXVzYWJsZSxlLnRleHR1cmVUeXBlPXRoaXMuX3RleHR1cmVUeXBlLGUuZnJhZ21lbnRVcmw9dGhpcy5fZnJhZ21lbnRVcmwsZS5wYXJhbWV0ZXJzPXRoaXMuX3BhcmFtZXRlcnMsZS5zYW1wbGVycz10aGlzLl9zYW1wbGVycyxlLm9wdGlvbnM9dGhpcy5fb3B0aW9ucyxlLmRlZmluZXM9dGhpcy5fcG9zdFByb2Nlc3NEZWZpbmVzLGUudGV4dHVyZUZvcm1hdD10aGlzLl90ZXh0dXJlRm9ybWF0LGUudmVydGV4VXJsPXRoaXMuX3ZlcnRleFVybCxlLmluZGV4UGFyYW1ldGVycz10aGlzLl9pbmRleFBhcmFtZXRlcnMsZX1jbG9uZSgpe2NvbnN0IGU9dGhpcy5zZXJpYWxpemUoKTtlLl9lbmdpbmU9dGhpcy5fZW5naW5lLGUuY2FtZXJhSWQ9bnVsbDtjb25zdCB0PU1lLlBhcnNlKGUsdGhpcy5fc2NlbmUsIiIpO3JldHVybiB0Pyh0Lm9uQWN0aXZhdGVPYnNlcnZhYmxlPXRoaXMub25BY3RpdmF0ZU9ic2VydmFibGUuY2xvbmUoKSx0Lm9uU2l6ZUNoYW5nZWRPYnNlcnZhYmxlPXRoaXMub25TaXplQ2hhbmdlZE9ic2VydmFibGUuY2xvbmUoKSx0Lm9uQXBwbHlPYnNlcnZhYmxlPXRoaXMub25BcHBseU9ic2VydmFibGUuY2xvbmUoKSx0Lm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZT10aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5jbG9uZSgpLHQub25BZnRlclJlbmRlck9ic2VydmFibGU9dGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5jbG9uZSgpLHQuX3ByZVBhc3NFZmZlY3RDb25maWd1cmF0aW9uPXRoaXMuX3ByZVBhc3NFZmZlY3RDb25maWd1cmF0aW9uLHQpOm51bGx9c3RhdGljIFBhcnNlKGUsdCxpKXtjb25zdCBzPXJpKGUuY3VzdG9tVHlwZSk7aWYoIXN8fCFzLl9QYXJzZSlyZXR1cm4gbnVsbDtjb25zdCByPXQ/dC5nZXRDYW1lcmFCeUlkKGUuY2FtZXJhSWQpOm51bGw7cmV0dXJuIHMuX1BhcnNlKGUscix0LGkpfXN0YXRpYyBfUGFyc2UoZSx0LGkscyl7cmV0dXJuIGFlLlBhcnNlKCgpPT5uZXcgTWUoZS5uYW1lLGUuZnJhZ21lbnRVcmwsZS5wYXJhbWV0ZXJzLGUuc2FtcGxlcnMsZS5vcHRpb25zLHQsZS5yZW5kZXJUYXJnZXRTYW1wbGluZ01vZGUsZS5fZW5naW5lLGUucmV1c2FibGUsZS5kZWZpbmVzLGUudGV4dHVyZVR5cGUsZS52ZXJ0ZXhVcmwsZS5pbmRleFBhcmFtZXRlcnMsITEsZS50ZXh0dXJlRm9ybWF0KSxlLGkscyl9fU1lLl9DdXN0b21TaGFkZXJDb2RlUHJvY2Vzc2luZz17fSxUKFtSKCldLE1lLnByb3RvdHlwZSwidW5pcXVlSWQiLHZvaWQgMCksVChbUigpXSxNZS5wcm90b3R5cGUsIm5hbWUiLHZvaWQgMCksVChbUigpXSxNZS5wcm90b3R5cGUsIndpZHRoIix2b2lkIDApLFQoW1IoKV0sTWUucHJvdG90eXBlLCJoZWlnaHQiLHZvaWQgMCksVChbUigpXSxNZS5wcm90b3R5cGUsInJlbmRlclRhcmdldFNhbXBsaW5nTW9kZSIsdm9pZCAwKSxUKFtkcigpXSxNZS5wcm90b3R5cGUsImNsZWFyQ29sb3IiLHZvaWQgMCksVChbUigpXSxNZS5wcm90b3R5cGUsImF1dG9DbGVhciIsdm9pZCAwKSxUKFtSKCldLE1lLnByb3RvdHlwZSwiYWxwaGFNb2RlIix2b2lkIDApLFQoW1IoKV0sTWUucHJvdG90eXBlLCJhbHBoYUNvbnN0YW50cyIsdm9pZCAwKSxUKFtSKCldLE1lLnByb3RvdHlwZSwiZW5hYmxlUGl4ZWxQZXJmZWN0TW9kZSIsdm9pZCAwKSxUKFtSKCldLE1lLnByb3RvdHlwZSwiZm9yY2VGdWxsc2NyZWVuVmlld3BvcnQiLHZvaWQgMCksVChbUigpXSxNZS5wcm90b3R5cGUsInNjYWxlTW9kZSIsdm9pZCAwKSxUKFtSKCldLE1lLnByb3RvdHlwZSwiYWx3YXlzRm9yY2VQT1QiLHZvaWQgMCksVChbUigic2FtcGxlcyIpXSxNZS5wcm90b3R5cGUsIl9zYW1wbGVzIix2b2lkIDApLFQoW1IoKV0sTWUucHJvdG90eXBlLCJhZGFwdFNjYWxlVG9DdXJyZW50Vmlld3BvcnQiLHZvaWQgMCksaXQoIkJBQllMT04uUG9zdFByb2Nlc3MiLE1lKTtjb25zdCBzYT0ia2VybmVsQmx1clZhcnlpbmdEZWNsYXJhdGlvbiIscmE9InZhcnlpbmcgdmVjMiBzYW1wbGVDb29yZHtYfTsiO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbc2FdPXJhO2NvbnN0IG5hPSJwYWNraW5nRnVuY3Rpb25zIixhYT1gdmVjNCBwYWNrKGZsb2F0IGRlcHRoKQp7CmNvbnN0IHZlYzQgYml0X3NoaWZ0PXZlYzQoMjU1LjAqMjU1LjAqMjU1LjAsMjU1LjAqMjU1LjAsMjU1LjAsMS4wKTsKY29uc3QgdmVjNCBiaXRfbWFzaz12ZWM0KDAuMCwxLjAvMjU1LjAsMS4wLzI1NS4wLDEuMC8yNTUuMCk7CnZlYzQgcmVzPWZyYWN0KGRlcHRoKmJpdF9zaGlmdCk7CnJlcy09cmVzLnh4eXoqYml0X21hc2s7CnJldHVybiByZXM7Cn0KZmxvYXQgdW5wYWNrKHZlYzQgY29sb3IpCnsKY29uc3QgdmVjNCBiaXRfc2hpZnQ9dmVjNCgxLjAvKDI1NS4wKjI1NS4wKjI1NS4wKSwxLjAvKDI1NS4wKjI1NS4wKSwxLjAvMjU1LjAsMS4wKTsKcmV0dXJuIGRvdChjb2xvcixiaXRfc2hpZnQpOwp9YDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW25hXT1hYTtjb25zdCBvYT0ia2VybmVsQmx1ckZyYWdtZW50IixoYT1gI2lmZGVmIERPRgpmYWN0b3I9c2FtcGxlQ29DKHNhbXBsZUNvb3Jke1h9KTsgCmNvbXB1dGVkV2VpZ2h0PUtFUk5FTF9XRUlHSFR7WH0qZmFjdG9yOwpzdW1PZldlaWdodHMrPWNvbXB1dGVkV2VpZ2h0OwojZWxzZQpjb21wdXRlZFdlaWdodD1LRVJORUxfV0VJR0hUe1h9OwojZW5kaWYKI2lmZGVmIFBBQ0tFREZMT0FUCmJsZW5kKz11bnBhY2sodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHNhbXBsZUNvb3Jke1h9KSkqY29tcHV0ZWRXZWlnaHQ7CiNlbHNlCmJsZW5kKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsc2FtcGxlQ29vcmR7WH0pKmNvbXB1dGVkV2VpZ2h0OwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW29hXT1oYTtjb25zdCBsYT0ia2VybmVsQmx1ckZyYWdtZW50MiIsY2E9YCNpZmRlZiBET0YKZmFjdG9yPXNhbXBsZUNvQyhzYW1wbGVDZW50ZXIrZGVsdGEqS0VSTkVMX0RFUF9PRkZTRVR7WH0pOwpjb21wdXRlZFdlaWdodD1LRVJORUxfREVQX1dFSUdIVHtYfSpmYWN0b3I7CnN1bU9mV2VpZ2h0cys9Y29tcHV0ZWRXZWlnaHQ7CiNlbHNlCmNvbXB1dGVkV2VpZ2h0PUtFUk5FTF9ERVBfV0VJR0hUe1h9OwojZW5kaWYKI2lmZGVmIFBBQ0tFREZMT0FUCmJsZW5kKz11bnBhY2sodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHNhbXBsZUNlbnRlcitkZWx0YSpLRVJORUxfREVQX09GRlNFVHtYfSkpKmNvbXB1dGVkV2VpZ2h0OwojZWxzZQpibGVuZCs9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHNhbXBsZUNlbnRlcitkZWx0YSpLRVJORUxfREVQX09GRlNFVHtYfSkqY29tcHV0ZWRXZWlnaHQ7CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbbGFdPWNhO2NvbnN0IHVhPSJrZXJuZWxCbHVyUGl4ZWxTaGFkZXIiLGRhPWB1bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjsKdW5pZm9ybSB2ZWMyIGRlbHRhOwp2YXJ5aW5nIHZlYzIgc2FtcGxlQ2VudGVyOwojaWZkZWYgRE9GCnVuaWZvcm0gc2FtcGxlcjJEIGNpcmNsZU9mQ29uZnVzaW9uU2FtcGxlcjsKZmxvYXQgc2FtcGxlQ29DKGluIHZlYzIgb2Zmc2V0KSB7CmZsb2F0IGNvYz10ZXh0dXJlMkQoY2lyY2xlT2ZDb25mdXNpb25TYW1wbGVyLG9mZnNldCkucjsKcmV0dXJuIGNvYzsgCn0KI2VuZGlmCiNpbmNsdWRlPGtlcm5lbEJsdXJWYXJ5aW5nRGVjbGFyYXRpb24+WzAuLnZhcnlpbmdDb3VudF0KI2lmZGVmIFBBQ0tFREZMT0FUCiNpbmNsdWRlPHBhY2tpbmdGdW5jdGlvbnM+CiNlbmRpZgojZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9ERUZJTklUSU9OUwp2b2lkIG1haW4odm9pZCkKewpmbG9hdCBjb21wdXRlZFdlaWdodD0wLjA7CiNpZmRlZiBQQUNLRURGTE9BVApmbG9hdCBibGVuZD0wLjsKI2Vsc2UKdmVjNCBibGVuZD12ZWM0KDAuKTsKI2VuZGlmCiNpZmRlZiBET0YKZmxvYXQgc3VtT2ZXZWlnaHRzPUNFTlRFUl9XRUlHSFQ7IApmbG9hdCBmYWN0b3I9MC4wOwojaWZkZWYgUEFDS0VERkxPQVQKYmxlbmQrPXVucGFjayh0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsc2FtcGxlQ2VudGVyKSkqQ0VOVEVSX1dFSUdIVDsKI2Vsc2UKYmxlbmQrPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcixzYW1wbGVDZW50ZXIpKkNFTlRFUl9XRUlHSFQ7CiNlbmRpZgojZW5kaWYKI2luY2x1ZGU8a2VybmVsQmx1ckZyYWdtZW50PlswLi52YXJ5aW5nQ291bnRdCiNpbmNsdWRlPGtlcm5lbEJsdXJGcmFnbWVudDI+WzAuLmRlcENvdW50XQojaWZkZWYgUEFDS0VERkxPQVQKZ2xfRnJhZ0NvbG9yPXBhY2soYmxlbmQpOwojZWxzZQpnbF9GcmFnQ29sb3I9YmxlbmQ7CiNlbmRpZgojaWZkZWYgRE9GCmdsX0ZyYWdDb2xvci89c3VtT2ZXZWlnaHRzOwojZW5kaWYKfWA7VS5TaGFkZXJzU3RvcmVbdWFdPWRhO2NvbnN0IGZhPSJrZXJuZWxCbHVyVmVydGV4IixfYT0ic2FtcGxlQ29vcmR7WH09c2FtcGxlQ2VudGVyK2RlbHRhKktFUk5FTF9PRkZTRVR7WH07IjtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2ZhXT1fYTtjb25zdCBnYT0ia2VybmVsQmx1clZlcnRleFNoYWRlciIscGE9YGF0dHJpYnV0ZSB2ZWMyIHBvc2l0aW9uOwp1bmlmb3JtIHZlYzIgZGVsdGE7CnZhcnlpbmcgdmVjMiBzYW1wbGVDZW50ZXI7CiNpbmNsdWRlPGtlcm5lbEJsdXJWYXJ5aW5nRGVjbGFyYXRpb24+WzAuLnZhcnlpbmdDb3VudF0KY29uc3QgdmVjMiBtYWRkPXZlYzIoMC41LDAuNSk7CiNkZWZpbmUgQ1VTVE9NX1ZFUlRFWF9ERUZJTklUSU9OUwp2b2lkIG1haW4odm9pZCkgewojZGVmaW5lIENVU1RPTV9WRVJURVhfTUFJTl9CRUdJTgpzYW1wbGVDZW50ZXI9KHBvc2l0aW9uKm1hZGQrbWFkZCk7CiNpbmNsdWRlPGtlcm5lbEJsdXJWZXJ0ZXg+WzAuLnZhcnlpbmdDb3VudF0KZ2xfUG9zaXRpb249dmVjNChwb3NpdGlvbiwwLjAsMS4wKTsKI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fRU5ECn1gO1UuU2hhZGVyc1N0b3JlW2dhXT1wYTtjbGFzcyBKdCBleHRlbmRzIE1le2NvbnN0cnVjdG9yKGUsdCxpLHMscixuPU4uQklMSU5FQVJfU0FNUExJTkdNT0RFLGEsbyxoPTAsbD0iIix1PSExLGQ9NSl7c3VwZXIoZSwia2VybmVsQmx1ciIsWyJkZWx0YSIsImRpcmVjdGlvbiJdLFsiY2lyY2xlT2ZDb25mdXNpb25TYW1wbGVyIl0scyxyLG4sYSxvLG51bGwsaCwia2VybmVsQmx1ciIse3ZhcnlpbmdDb3VudDowLGRlcENvdW50OjB9LCEwLGQpLHRoaXMuX2Jsb2NrQ29tcGlsYXRpb249dSx0aGlzLl9wYWNrZWRGbG9hdD0hMSx0aGlzLl9zdGF0aWNEZWZpbmVzPSIiLHRoaXMuX3N0YXRpY0RlZmluZXM9bCx0aGlzLmRpcmVjdGlvbj10LHRoaXMub25BcHBseU9ic2VydmFibGUuYWRkKGY9Pnt0aGlzLl9vdXRwdXRUZXh0dXJlP2Yuc2V0RmxvYXQyKCJkZWx0YSIsMS90aGlzLl9vdXRwdXRUZXh0dXJlLndpZHRoKnRoaXMuZGlyZWN0aW9uLngsMS90aGlzLl9vdXRwdXRUZXh0dXJlLmhlaWdodCp0aGlzLmRpcmVjdGlvbi55KTpmLnNldEZsb2F0MigiZGVsdGEiLDEvdGhpcy53aWR0aCp0aGlzLmRpcmVjdGlvbi54LDEvdGhpcy5oZWlnaHQqdGhpcy5kaXJlY3Rpb24ueSl9KSx0aGlzLmtlcm5lbD1pfXNldCBrZXJuZWwoZSl7dGhpcy5faWRlYWxLZXJuZWwhPT1lJiYoZT1NYXRoLm1heChlLDEpLHRoaXMuX2lkZWFsS2VybmVsPWUsdGhpcy5fa2VybmVsPXRoaXMuX25lYXJlc3RCZXN0S2VybmVsKGUpLHRoaXMuX2Jsb2NrQ29tcGlsYXRpb258fHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IGtlcm5lbCgpe3JldHVybiB0aGlzLl9pZGVhbEtlcm5lbH1zZXQgcGFja2VkRmxvYXQoZSl7dGhpcy5fcGFja2VkRmxvYXQhPT1lJiYodGhpcy5fcGFja2VkRmxvYXQ9ZSx0aGlzLl9ibG9ja0NvbXBpbGF0aW9ufHx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBwYWNrZWRGbG9hdCgpe3JldHVybiB0aGlzLl9wYWNrZWRGbG9hdH1nZXRDbGFzc05hbWUoKXtyZXR1cm4iQmx1clBvc3RQcm9jZXNzIn11cGRhdGVFZmZlY3QoZT1udWxsLHQ9bnVsbCxpPW51bGwscyxyLG4pe3RoaXMuX3VwZGF0ZVBhcmFtZXRlcnMocixuKX1fdXBkYXRlUGFyYW1ldGVycyhlLHQpe2NvbnN0IGk9dGhpcy5fa2VybmVsLHM9KGktMSkvMjtsZXQgcj1bXSxuPVtdLGE9MDtmb3IobGV0IG09MDttPGk7bSsrKXtjb25zdCB2PW0vKGktMSksUz10aGlzLl9nYXVzc2lhbldlaWdodCh2KjItMSk7clttXT1tLXMsblttXT1TLGErPVN9Zm9yKGxldCBtPTA7bTxuLmxlbmd0aDttKyspblttXS89YTtjb25zdCBvPVtdLGg9W10sbD1bXTtmb3IobGV0IG09MDttPD1zO20rPTIpe2NvbnN0IHY9TWF0aC5taW4obSsxLE1hdGguZmxvb3IocykpO2lmKG09PT12KWwucHVzaCh7bzpyW21dLHc6blttXX0pO2Vsc2V7Y29uc3QgeT12PT09cyxBPW5bbV0rblt2XSooeT8uNToxKSxDPXJbbV0rMS8oMStuW21dL25bdl0pO0M9PT0wPyhsLnB1c2goe286clttXSx3Om5bbV19KSxsLnB1c2goe286clttKzFdLHc6blttKzFdfSkpOihsLnB1c2goe286Qyx3OkF9KSxsLnB1c2goe286LUMsdzpBfSkpfX1mb3IobGV0IG09MDttPGwubGVuZ3RoO20rKyloW21dPWxbbV0ubyxvW21dPWxbbV0udztyPWgsbj1vO2NvbnN0IHU9dGhpcy5nZXRFbmdpbmUoKS5nZXRDYXBzKCkubWF4VmFyeWluZ1ZlY3RvcnMsZD1NYXRoLm1heCh1LDApLTE7bGV0IGY9TWF0aC5taW4oci5sZW5ndGgsZCksXz0iIjtfKz10aGlzLl9zdGF0aWNEZWZpbmVzLHRoaXMuX3N0YXRpY0RlZmluZXMuaW5kZXhPZigiRE9GIikhPS0xJiYoXys9YCNkZWZpbmUgQ0VOVEVSX1dFSUdIVCAke3RoaXMuX2dsc2xGbG9hdChuW2YtMV0pfVxyCmAsZi0tKTtmb3IobGV0IG09MDttPGY7bSsrKV8rPWAjZGVmaW5lIEtFUk5FTF9PRkZTRVQke219ICR7dGhpcy5fZ2xzbEZsb2F0KHJbbV0pfVxyCmAsXys9YCNkZWZpbmUgS0VSTkVMX1dFSUdIVCR7bX0gJHt0aGlzLl9nbHNsRmxvYXQoblttXSl9XHIKYDtsZXQgRT0wO2ZvcihsZXQgbT1kO208ci5sZW5ndGg7bSsrKV8rPWAjZGVmaW5lIEtFUk5FTF9ERVBfT0ZGU0VUJHtFfSAke3RoaXMuX2dsc2xGbG9hdChyW21dKX1ccgpgLF8rPWAjZGVmaW5lIEtFUk5FTF9ERVBfV0VJR0hUJHtFfSAke3RoaXMuX2dsc2xGbG9hdChuW21dKX1ccgpgLEUrKzt0aGlzLnBhY2tlZEZsb2F0JiYoXys9IiNkZWZpbmUgUEFDS0VERkxPQVQgMSIpLHRoaXMuX2Jsb2NrQ29tcGlsYXRpb249ITEsc3VwZXIudXBkYXRlRWZmZWN0KF8sbnVsbCxudWxsLHt2YXJ5aW5nQ291bnQ6ZixkZXBDb3VudDpFfSxlLHQpfV9uZWFyZXN0QmVzdEtlcm5lbChlKXtjb25zdCB0PU1hdGgucm91bmQoZSk7Zm9yKGNvbnN0IGkgb2ZbdCx0LTEsdCsxLHQtMix0KzJdKWlmKGklMiE9PTAmJk1hdGguZmxvb3IoaS8yKSUyPT09MCYmaT4wKXJldHVybiBNYXRoLm1heChpLDMpO3JldHVybiBNYXRoLm1heCh0LDMpfV9nYXVzc2lhbldlaWdodChlKXtjb25zdCB0PS4zMzMzMzMzMzMzMzMzMzMzLGk9TWF0aC5zcXJ0KDIqTWF0aC5QSSkqdCxzPS0oZSplLygyKnQqdCkpO3JldHVybiAxL2kqTWF0aC5leHAocyl9X2dsc2xGbG9hdChlLHQ9OCl7cmV0dXJuIGUudG9GaXhlZCh0KS5yZXBsYWNlKC8wKyQvLCIiKX1zdGF0aWMgX1BhcnNlKGUsdCxpLHMpe3JldHVybiBhZS5QYXJzZSgoKT0+bmV3IEp0KGUubmFtZSxlLmRpcmVjdGlvbixlLmtlcm5lbCxlLm9wdGlvbnMsdCxlLnJlbmRlclRhcmdldFNhbXBsaW5nTW9kZSxpLmdldEVuZ2luZSgpLGUucmV1c2FibGUsZS50ZXh0dXJlVHlwZSx2b2lkIDAsITEpLGUsaSxzKX19VChbUigia2VybmVsIildLEp0LnByb3RvdHlwZSwiX2tlcm5lbCIsdm9pZCAwKSxUKFtSKCJwYWNrZWRGbG9hdCIpXSxKdC5wcm90b3R5cGUsIl9wYWNrZWRGbG9hdCIsdm9pZCAwKSxUKFt4bigpXSxKdC5wcm90b3R5cGUsImRpcmVjdGlvbiIsdm9pZCAwKSxpdCgiQkFCWUxPTi5CbHVyUG9zdFByb2Nlc3MiLEp0KTtjbGFzcyB6c3tjb25zdHJ1Y3Rvcigpe3RoaXMuX2RlZmluZXM9e30sdGhpcy5fY3VycmVudFJhbms9MzIsdGhpcy5fbWF4UmFuaz0tMSx0aGlzLl9tZXNoPW51bGx9dW5CaW5kTWVzaCgpe3RoaXMuX21lc2g9bnVsbH1hZGRGYWxsYmFjayhlLHQpe3RoaXMuX2RlZmluZXNbZV18fChlPHRoaXMuX2N1cnJlbnRSYW5rJiYodGhpcy5fY3VycmVudFJhbms9ZSksZT50aGlzLl9tYXhSYW5rJiYodGhpcy5fbWF4UmFuaz1lKSx0aGlzLl9kZWZpbmVzW2VdPW5ldyBBcnJheSksdGhpcy5fZGVmaW5lc1tlXS5wdXNoKHQpfWFkZENQVVNraW5uaW5nRmFsbGJhY2soZSx0KXt0aGlzLl9tZXNoPXQsZTx0aGlzLl9jdXJyZW50UmFuayYmKHRoaXMuX2N1cnJlbnRSYW5rPWUpLGU+dGhpcy5fbWF4UmFuayYmKHRoaXMuX21heFJhbms9ZSl9Z2V0IGhhc01vcmVGYWxsYmFja3MoKXtyZXR1cm4gdGhpcy5fY3VycmVudFJhbms8PXRoaXMuX21heFJhbmt9cmVkdWNlKGUsdCl7aWYodGhpcy5fbWVzaCYmdGhpcy5fbWVzaC5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJnRoaXMuX21lc2gubnVtQm9uZUluZmx1ZW5jZXJzPjApe3RoaXMuX21lc2guY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzPSExLGU9ZS5yZXBsYWNlKCIjZGVmaW5lIE5VTV9CT05FX0lORkxVRU5DRVJTICIrdGhpcy5fbWVzaC5udW1Cb25lSW5mbHVlbmNlcnMsIiNkZWZpbmUgTlVNX0JPTkVfSU5GTFVFTkNFUlMgMCIpLHQuX2JvbmVzQ29tcHV0YXRpb25Gb3JjZWRUb0NQVT0hMDtjb25zdCBpPXRoaXMuX21lc2guZ2V0U2NlbmUoKTtmb3IobGV0IHM9MDtzPGkubWVzaGVzLmxlbmd0aDtzKyspe2NvbnN0IHI9aS5tZXNoZXNbc107aWYoIXIubWF0ZXJpYWwpeyF0aGlzLl9tZXNoLm1hdGVyaWFsJiZyLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycyYmci5udW1Cb25lSW5mbHVlbmNlcnM+MCYmKHIuY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzPSExKTtjb250aW51ZX1pZighKCFyLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVyc3x8ci5udW1Cb25lSW5mbHVlbmNlcnM9PT0wKSl7aWYoci5tYXRlcmlhbC5nZXRFZmZlY3QoKT09PXQpci5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnM9ITE7ZWxzZSBpZihyLnN1Yk1lc2hlcyl7Zm9yKGNvbnN0IG4gb2Ygci5zdWJNZXNoZXMpaWYobi5lZmZlY3Q9PT10KXtyLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycz0hMTticmVha319fX19ZWxzZXtjb25zdCBpPXRoaXMuX2RlZmluZXNbdGhpcy5fY3VycmVudFJhbmtdO2lmKGkpZm9yKGxldCBzPTA7czxpLmxlbmd0aDtzKyspZT1lLnJlcGxhY2UoIiNkZWZpbmUgIitpW3NdLCIiKTt0aGlzLl9jdXJyZW50UmFuaysrfXJldHVybiBlfX1jb25zdCBtYT0iYmF5ZXJEaXRoZXJGdW5jdGlvbnMiLEVhPWBmbG9hdCBiYXllckRpdGhlcjIodmVjMiBfUCkgewpyZXR1cm4gbW9kKDIuMCpfUC55K19QLngrMS4wLDQuMCk7Cn0KZmxvYXQgYmF5ZXJEaXRoZXI0KHZlYzIgX1ApIHsKdmVjMiBQMT1tb2QoX1AsMi4wKTsgCnZlYzIgUDI9Zmxvb3IoMC41Km1vZChfUCw0LjApKTsgCnJldHVybiA0LjAqYmF5ZXJEaXRoZXIyKFAxKStiYXllckRpdGhlcjIoUDIpOwp9CmZsb2F0IGJheWVyRGl0aGVyOCh2ZWMyIF9QKSB7CnZlYzIgUDE9bW9kKF9QLDIuMCk7IAp2ZWMyIFAyPWZsb29yKDAuNSAqbW9kKF9QLDQuMCkpOyAKdmVjMiBQND1mbG9vcigwLjI1Km1vZChfUCw4LjApKTsgCnJldHVybiA0LjAqKDQuMCpiYXllckRpdGhlcjIoUDEpK2JheWVyRGl0aGVyMihQMikpK2JheWVyRGl0aGVyMihQNCk7Cn0KYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW21hXT1FYTtjb25zdCB2YT0ic2hhZG93TWFwRnJhZ21lbnRFeHRyYURlY2xhcmF0aW9uIixUYT1gI2lmIFNNX0ZMT0FUPT0wCiNpbmNsdWRlPHBhY2tpbmdGdW5jdGlvbnM+CiNlbmRpZgojaWYgU01fU09GVFRSQU5TUEFSRU5UU0hBRE9XPT0xCiNpbmNsdWRlPGJheWVyRGl0aGVyRnVuY3Rpb25zPgp1bmlmb3JtIGZsb2F0IHNvZnRUcmFuc3BhcmVudFNoYWRvd1NNOwojZW5kaWYKdmFyeWluZyBmbG9hdCB2RGVwdGhNZXRyaWNTTTsKI2lmIFNNX1VTRURJU1RBTkNFPT0xCnVuaWZvcm0gdmVjMyBsaWdodERhdGFTTTsKdmFyeWluZyB2ZWMzIHZQb3NpdGlvbldTTTsKI2VuZGlmCnVuaWZvcm0gdmVjMyBiaWFzQW5kU2NhbGVTTTsKdW5pZm9ybSB2ZWMyIGRlcHRoVmFsdWVzU007CiNpZiBkZWZpbmVkKFNNX0RFUFRIQ0xBTVApICYmIFNNX0RFUFRIQ0xBTVA9PTEKdmFyeWluZyBmbG9hdCB6U007CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbdmFdPVRhO2NvbnN0IGJhPSJjbGlwUGxhbmVGcmFnbWVudERlY2xhcmF0aW9uIixTYT1gI2lmZGVmIENMSVBQTEFORQp2YXJ5aW5nIGZsb2F0IGZDbGlwRGlzdGFuY2U7CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FMgp2YXJ5aW5nIGZsb2F0IGZDbGlwRGlzdGFuY2UyOwojZW5kaWYKI2lmZGVmIENMSVBQTEFORTMKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlMzsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkU0CnZhcnlpbmcgZmxvYXQgZkNsaXBEaXN0YW5jZTQ7CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FNQp2YXJ5aW5nIGZsb2F0IGZDbGlwRGlzdGFuY2U1OwojZW5kaWYKI2lmZGVmIENMSVBQTEFORTYKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlNjsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtiYV09U2E7Y29uc3QgeGE9ImNsaXBQbGFuZUZyYWdtZW50IixNYT1gI2lmIGRlZmluZWQoQ0xJUFBMQU5FKSB8fCBkZWZpbmVkKENMSVBQTEFORTIpIHx8IGRlZmluZWQoQ0xJUFBMQU5FMykgfHwgZGVmaW5lZChDTElQUExBTkU0KSB8fCBkZWZpbmVkKENMSVBQTEFORTUpIHx8IGRlZmluZWQoQ0xJUFBMQU5FNikKaWYgKGZhbHNlKSB7fQojZW5kaWYKI2lmZGVmIENMSVBQTEFORQplbHNlIGlmIChmQ2xpcERpc3RhbmNlPjAuMCkKewpkaXNjYXJkOwp9CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FMgplbHNlIGlmIChmQ2xpcERpc3RhbmNlMj4wLjApCnsKZGlzY2FyZDsKfQojZW5kaWYKI2lmZGVmIENMSVBQTEFORTMKZWxzZSBpZiAoZkNsaXBEaXN0YW5jZTM+MC4wKQp7CmRpc2NhcmQ7Cn0KI2VuZGlmCiNpZmRlZiBDTElQUExBTkU0CmVsc2UgaWYgKGZDbGlwRGlzdGFuY2U0PjAuMCkKewpkaXNjYXJkOwp9CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FNQplbHNlIGlmIChmQ2xpcERpc3RhbmNlNT4wLjApCnsKZGlzY2FyZDsKfQojZW5kaWYKI2lmZGVmIENMSVBQTEFORTYKZWxzZSBpZiAoZkNsaXBEaXN0YW5jZTY+MC4wKQp7CmRpc2NhcmQ7Cn0KI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVt4YV09TWE7Y29uc3QgQWE9InNoYWRvd01hcEZyYWdtZW50IixSYT1gZmxvYXQgZGVwdGhTTT12RGVwdGhNZXRyaWNTTTsKI2lmIGRlZmluZWQoU01fREVQVEhDTEFNUCkgJiYgU01fREVQVEhDTEFNUD09MQojaWYgU01fVVNFRElTVEFOQ0U9PTEKZGVwdGhTTT0obGVuZ3RoKHZQb3NpdGlvbldTTS1saWdodERhdGFTTSkrZGVwdGhWYWx1ZXNTTS54KS9kZXB0aFZhbHVlc1NNLnkrYmlhc0FuZFNjYWxlU00ueDsKI2Vsc2UKI2lmZGVmIFVTRV9SRVZFUlNFX0RFUFRIQlVGRkVSCmRlcHRoU009KC16U00rZGVwdGhWYWx1ZXNTTS54KS9kZXB0aFZhbHVlc1NNLnkrYmlhc0FuZFNjYWxlU00ueDsKI2Vsc2UKZGVwdGhTTT0oelNNK2RlcHRoVmFsdWVzU00ueCkvZGVwdGhWYWx1ZXNTTS55K2JpYXNBbmRTY2FsZVNNLng7CiNlbmRpZgojZW5kaWYKI2lmZGVmIFVTRV9SRVZFUlNFX0RFUFRIQlVGRkVSCmdsX0ZyYWdEZXB0aD1jbGFtcCgxLjAtZGVwdGhTTSwwLjAsMS4wKTsKI2Vsc2UKZ2xfRnJhZ0RlcHRoPWNsYW1wKGRlcHRoU00sMC4wLDEuMCk7IAojZW5kaWYKI2VsaWYgU01fVVNFRElTVEFOQ0U9PTEKZGVwdGhTTT0obGVuZ3RoKHZQb3NpdGlvbldTTS1saWdodERhdGFTTSkrZGVwdGhWYWx1ZXNTTS54KS9kZXB0aFZhbHVlc1NNLnkrYmlhc0FuZFNjYWxlU00ueDsKI2VuZGlmCiNpZiBTTV9FU009PTEKZGVwdGhTTT1jbGFtcChleHAoLW1pbig4Ny4sYmlhc0FuZFNjYWxlU00ueipkZXB0aFNNKSksMC4sMS4pOwojZW5kaWYKI2lmIFNNX0ZMT0FUPT0xCmdsX0ZyYWdDb2xvcj12ZWM0KGRlcHRoU00sMS4wLDEuMCwxLjApOwojZWxzZQpnbF9GcmFnQ29sb3I9cGFjayhkZXB0aFNNKTsKI2VuZGlmCnJldHVybjtgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbQWFdPVJhO2NvbnN0IHlhPSJzaGFkb3dNYXBQaXhlbFNoYWRlciIsQ2E9YCNpbmNsdWRlPHNoYWRvd01hcEZyYWdtZW50RXh0cmFEZWNsYXJhdGlvbj4KI2lmZGVmIEFMUEhBVEVYVFVSRQp2YXJ5aW5nIHZlYzIgdlVWOwp1bmlmb3JtIHNhbXBsZXIyRCBkaWZmdXNlU2FtcGxlcjsKI2VuZGlmCiNpbmNsdWRlPGNsaXBQbGFuZUZyYWdtZW50RGVjbGFyYXRpb24+CiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0RFRklOSVRJT05TCnZvaWQgbWFpbih2b2lkKQp7CiNpbmNsdWRlPGNsaXBQbGFuZUZyYWdtZW50PgojaWZkZWYgQUxQSEFURVhUVVJFCmZsb2F0IGFscGhhRnJvbUFscGhhVGV4dHVyZT10ZXh0dXJlMkQoZGlmZnVzZVNhbXBsZXIsdlVWKS5hOwojaWZkZWYgQUxQSEFURVNUVkFMVUUKaWYgKGFscGhhRnJvbUFscGhhVGV4dHVyZTxBTFBIQVRFU1RWQUxVRSkKZGlzY2FyZDsKI2VuZGlmCiNlbmRpZgojaWYgU01fU09GVFRSQU5TUEFSRU5UU0hBRE9XPT0xCiNpZmRlZiBBTFBIQVRFWFRVUkUKaWYgKChiYXllckRpdGhlcjgoZmxvb3IobW9kKGdsX0ZyYWdDb29yZC54eSw4LjApKSkpLzY0LjA+PXNvZnRUcmFuc3BhcmVudFNoYWRvd1NNKmFscGhhRnJvbUFscGhhVGV4dHVyZSkgZGlzY2FyZDsKI2Vsc2UKaWYgKChiYXllckRpdGhlcjgoZmxvb3IobW9kKGdsX0ZyYWdDb29yZC54eSw4LjApKSkpLzY0LjA+PXNvZnRUcmFuc3BhcmVudFNoYWRvd1NNKSBkaXNjYXJkOwojZW5kaWYKI2VuZGlmCiNpbmNsdWRlPHNoYWRvd01hcEZyYWdtZW50Pgp9YDtVLlNoYWRlcnNTdG9yZVt5YV09Q2E7Y29uc3QgSWE9ImJvbmVzRGVjbGFyYXRpb24iLFBhPWAjaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MAphdHRyaWJ1dGUgdmVjNCBtYXRyaWNlc0luZGljZXM7CmF0dHJpYnV0ZSB2ZWM0IG1hdHJpY2VzV2VpZ2h0czsKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjQKYXR0cmlidXRlIHZlYzQgbWF0cmljZXNJbmRpY2VzRXh0cmE7CmF0dHJpYnV0ZSB2ZWM0IG1hdHJpY2VzV2VpZ2h0c0V4dHJhOwojZW5kaWYKI2lmbmRlZiBCQUtFRF9WRVJURVhfQU5JTUFUSU9OX1RFWFRVUkUKI2lmZGVmIEJPTkVURVhUVVJFCnVuaWZvcm0gc2FtcGxlcjJEIGJvbmVTYW1wbGVyOwp1bmlmb3JtIGZsb2F0IGJvbmVUZXh0dXJlV2lkdGg7CiNlbHNlCnVuaWZvcm0gbWF0NCBtQm9uZXNbQm9uZXNQZXJNZXNoXTsKI2lmZGVmIEJPTkVTX1ZFTE9DSVRZX0VOQUJMRUQKdW5pZm9ybSBtYXQ0IG1QcmV2aW91c0JvbmVzW0JvbmVzUGVyTWVzaF07CiNlbmRpZgojZW5kaWYKI2lmZGVmIEJPTkVURVhUVVJFCiNkZWZpbmUgaW5saW5lCm1hdDQgcmVhZE1hdHJpeEZyb21SYXdTYW1wbGVyKHNhbXBsZXIyRCBzbXAsZmxvYXQgaW5kZXgpCnsKZmxvYXQgb2Zmc2V0PWluZGV4ICo0LjA7CmZsb2F0IGR4PTEuMC9ib25lVGV4dHVyZVdpZHRoOwp2ZWM0IG0wPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzAuNSksMC4pKTsKdmVjNCBtMT10ZXh0dXJlMkQoc21wLHZlYzIoZHgqKG9mZnNldCsxLjUpLDAuKSk7CnZlYzQgbTI9dGV4dHVyZTJEKHNtcCx2ZWMyKGR4KihvZmZzZXQrMi41KSwwLikpOwp2ZWM0IG0zPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzMuNSksMC4pKTsKcmV0dXJuIG1hdDQobTAsbTEsbTIsbTMpOwp9CiNlbmRpZgojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtJYV09UGE7Y29uc3QgRGE9ImJha2VkVmVydGV4QW5pbWF0aW9uRGVjbGFyYXRpb24iLEZhPWAjaWZkZWYgQkFLRURfVkVSVEVYX0FOSU1BVElPTl9URVhUVVJFCnVuaWZvcm0gZmxvYXQgYmFrZWRWZXJ0ZXhBbmltYXRpb25UaW1lOwp1bmlmb3JtIHZlYzIgYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlU2l6ZUludmVydGVkOwp1bmlmb3JtIHZlYzQgYmFrZWRWZXJ0ZXhBbmltYXRpb25TZXR0aW5nczsKdW5pZm9ybSBzYW1wbGVyMkQgYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlOwojaWZkZWYgSU5TVEFOQ0VTCmF0dHJpYnV0ZSB2ZWM0IGJha2VkVmVydGV4QW5pbWF0aW9uU2V0dGluZ3NJbnN0YW5jZWQ7CiNlbmRpZgojZGVmaW5lIGlubGluZQptYXQ0IHJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChzYW1wbGVyMkQgc21wLGZsb2F0IGluZGV4LGZsb2F0IGZyYW1lKQp7CmZsb2F0IG9mZnNldD1pbmRleCo0LjA7CmZsb2F0IGZyYW1lVVY9KGZyYW1lKzAuNSkqYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlU2l6ZUludmVydGVkLnk7CmZsb2F0IGR4PWJha2VkVmVydGV4QW5pbWF0aW9uVGV4dHVyZVNpemVJbnZlcnRlZC54Owp2ZWM0IG0wPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzAuNSksZnJhbWVVVikpOwp2ZWM0IG0xPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzEuNSksZnJhbWVVVikpOwp2ZWM0IG0yPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzIuNSksZnJhbWVVVikpOwp2ZWM0IG0zPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzMuNSksZnJhbWVVVikpOwpyZXR1cm4gbWF0NChtMCxtMSxtMixtMyk7Cn0KI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtEYV09RmE7Y29uc3Qgd2E9Im1vcnBoVGFyZ2V0c1ZlcnRleEdsb2JhbERlY2xhcmF0aW9uIixPYT1gI2lmZGVmIE1PUlBIVEFSR0VUUwp1bmlmb3JtIGZsb2F0IG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1tOVU1fTU9SUEhfSU5GTFVFTkNFUlNdOwojaWZkZWYgTU9SUEhUQVJHRVRTX1RFWFRVUkUgCnByZWNpc2lvbiBtZWRpdW1wIHNhbXBsZXIyREFycmF5OyAKdW5pZm9ybSBmbG9hdCBtb3JwaFRhcmdldFRleHR1cmVJbmRpY2VzW05VTV9NT1JQSF9JTkZMVUVOQ0VSU107CnVuaWZvcm0gdmVjMyBtb3JwaFRhcmdldFRleHR1cmVJbmZvOwp1bmlmb3JtIHNhbXBsZXIyREFycmF5IG1vcnBoVGFyZ2V0czsKdmVjMyByZWFkVmVjdG9yM0Zyb21SYXdTYW1wbGVyKGludCB0YXJnZXRJbmRleCxmbG9hdCB2ZXJ0ZXhJbmRleCkKeyAKZmxvYXQgeT1mbG9vcih2ZXJ0ZXhJbmRleC9tb3JwaFRhcmdldFRleHR1cmVJbmZvLnkpOwpmbG9hdCB4PXZlcnRleEluZGV4LXkqbW9ycGhUYXJnZXRUZXh0dXJlSW5mby55Owp2ZWMzIHRleHR1cmVVVj12ZWMzKCh4KzAuNSkvbW9ycGhUYXJnZXRUZXh0dXJlSW5mby55LCh5KzAuNSkvbW9ycGhUYXJnZXRUZXh0dXJlSW5mby56LG1vcnBoVGFyZ2V0VGV4dHVyZUluZGljZXNbdGFyZ2V0SW5kZXhdKTsKcmV0dXJuIHRleHR1cmUobW9ycGhUYXJnZXRzLHRleHR1cmVVVikueHl6Owp9CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3dhXT1PYTtjb25zdCBMYT0ibW9ycGhUYXJnZXRzVmVydGV4RGVjbGFyYXRpb24iLE5hPWAjaWZkZWYgTU9SUEhUQVJHRVRTCiNpZm5kZWYgTU9SUEhUQVJHRVRTX1RFWFRVUkUKYXR0cmlidXRlIHZlYzMgcG9zaXRpb257WH07CiNpZmRlZiBNT1JQSFRBUkdFVFNfTk9STUFMCmF0dHJpYnV0ZSB2ZWMzIG5vcm1hbHtYfTsKI2VuZGlmCiNpZmRlZiBNT1JQSFRBUkdFVFNfVEFOR0VOVAphdHRyaWJ1dGUgdmVjMyB0YW5nZW50e1h9OwojZW5kaWYKI2lmZGVmIE1PUlBIVEFSR0VUU19VVgphdHRyaWJ1dGUgdmVjMiB1dl97WH07CiNlbmRpZgojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtMYV09TmE7Y29uc3QgQmE9ImhlbHBlckZ1bmN0aW9ucyIsVWE9YGNvbnN0IGZsb2F0IFBJPTMuMTQxNTkyNjUzNTg5NzkzMjM4NDYyNjQzMzgzMjc5NTsKY29uc3QgZmxvYXQgSEFMRl9NSU49NS45NjA0NjQ0OGUtMDg7IApjb25zdCBmbG9hdCBMaW5lYXJFbmNvZGVQb3dlckFwcHJveD0yLjI7CmNvbnN0IGZsb2F0IEdhbW1hRW5jb2RlUG93ZXJBcHByb3g9MS4wL0xpbmVhckVuY29kZVBvd2VyQXBwcm94Owpjb25zdCB2ZWMzIEx1bWluYW5jZUVuY29kZUFwcHJveD12ZWMzKDAuMjEyNiwwLjcxNTIsMC4wNzIyKTsKY29uc3QgZmxvYXQgRXBzaWxvbj0wLjAwMDAwMDE7CiNkZWZpbmUgc2F0dXJhdGUoeCkgY2xhbXAoeCwwLjAsMS4wKQojZGVmaW5lIGFic0Vwcyh4KSBhYnMoeCkrRXBzaWxvbgojZGVmaW5lIG1heEVwcyh4KSBtYXgoeCxFcHNpbG9uKQojZGVmaW5lIHNhdHVyYXRlRXBzKHgpIGNsYW1wKHgsRXBzaWxvbiwxLjApCm1hdDMgdHJhbnNwb3NlTWF0MyhtYXQzIGluTWF0cml4KSB7CnZlYzMgaTA9aW5NYXRyaXhbMF07CnZlYzMgaTE9aW5NYXRyaXhbMV07CnZlYzMgaTI9aW5NYXRyaXhbMl07Cm1hdDMgb3V0TWF0cml4PW1hdDMoCnZlYzMoaTAueCxpMS54LGkyLngpLAp2ZWMzKGkwLnksaTEueSxpMi55KSwKdmVjMyhpMC56LGkxLnosaTIueikKKTsKcmV0dXJuIG91dE1hdHJpeDsKfQptYXQzIGludmVyc2VNYXQzKG1hdDMgaW5NYXRyaXgpIHsKZmxvYXQgYTAwPWluTWF0cml4WzBdWzBdLGEwMT1pbk1hdHJpeFswXVsxXSxhMDI9aW5NYXRyaXhbMF1bMl07CmZsb2F0IGExMD1pbk1hdHJpeFsxXVswXSxhMTE9aW5NYXRyaXhbMV1bMV0sYTEyPWluTWF0cml4WzFdWzJdOwpmbG9hdCBhMjA9aW5NYXRyaXhbMl1bMF0sYTIxPWluTWF0cml4WzJdWzFdLGEyMj1pbk1hdHJpeFsyXVsyXTsKZmxvYXQgYjAxPWEyMiphMTEtYTEyKmEyMTsKZmxvYXQgYjExPS1hMjIqYTEwK2ExMiphMjA7CmZsb2F0IGIyMT1hMjEqYTEwLWExMSphMjA7CmZsb2F0IGRldD1hMDAqYjAxK2EwMSpiMTErYTAyKmIyMTsKcmV0dXJuIG1hdDMoYjAxLCgtYTIyKmEwMSthMDIqYTIxKSwoYTEyKmEwMS1hMDIqYTExKSwKYjExLChhMjIqYTAwLWEwMiphMjApLCgtYTEyKmEwMCthMDIqYTEwKSwKYjIxLCgtYTIxKmEwMCthMDEqYTIwKSwoYTExKmEwMC1hMDEqYTEwKSkvZGV0Owp9CiNpZiBVU0VfRVhBQ1RfU1JHQl9DT05WRVJTSU9OUwp2ZWMzIHRvTGluZWFyU3BhY2VFeGFjdCh2ZWMzIGNvbG9yKQp7CnZlYzMgbmVhclplcm9TZWN0aW9uPTAuMDc3Mzk5MzgwOCpjb2xvcjsKdmVjMyByZW1haW5pbmdTZWN0aW9uPXBvdygwLjk0Nzg2NzI5OSooY29sb3IrdmVjMygwLjA1NSkpLHZlYzMoMi40KSk7CiNpZiBkZWZpbmVkKFdFQkdMMikgfHwgZGVmaW5lZChXRUJHUFUpIHx8IGRlZmluZWQoTkFUSVZFKQpyZXR1cm4gbWl4KHJlbWFpbmluZ1NlY3Rpb24sbmVhclplcm9TZWN0aW9uLGxlc3NUaGFuRXF1YWwoY29sb3IsdmVjMygwLjA0MDQ1KSkpOwojZWxzZQpyZXR1cm4KdmVjMygKY29sb3Iucjw9MC4wNDA0NSA/IG5lYXJaZXJvU2VjdGlvbi5yIDogcmVtYWluaW5nU2VjdGlvbi5yLApjb2xvci5nPD0wLjA0MDQ1ID8gbmVhclplcm9TZWN0aW9uLmcgOiByZW1haW5pbmdTZWN0aW9uLmcsCmNvbG9yLmI8PTAuMDQwNDUgPyBuZWFyWmVyb1NlY3Rpb24uYiA6IHJlbWFpbmluZ1NlY3Rpb24uYik7CiNlbmRpZgp9CnZlYzMgdG9HYW1tYVNwYWNlRXhhY3QodmVjMyBjb2xvcikKewp2ZWMzIG5lYXJaZXJvU2VjdGlvbj0xMi45Mipjb2xvcjsKdmVjMyByZW1haW5pbmdTZWN0aW9uPTEuMDU1KnBvdyhjb2xvcix2ZWMzKDAuNDE2NjYpKS12ZWMzKDAuMDU1KTsKI2lmIGRlZmluZWQoV0VCR0wyKSB8fCBkZWZpbmVkKFdFQkdQVSkgfHwgZGVmaW5lZChOQVRJVkUpCnJldHVybiBtaXgocmVtYWluaW5nU2VjdGlvbixuZWFyWmVyb1NlY3Rpb24sbGVzc1RoYW5FcXVhbChjb2xvcix2ZWMzKDAuMDAzMTMwOCkpKTsKI2Vsc2UKcmV0dXJuCnZlYzMoCmNvbG9yLnI8PTAuMDAzMTMwOCA/IG5lYXJaZXJvU2VjdGlvbi5yIDogcmVtYWluaW5nU2VjdGlvbi5yLApjb2xvci5nPD0wLjAwMzEzMDggPyBuZWFyWmVyb1NlY3Rpb24uZyA6IHJlbWFpbmluZ1NlY3Rpb24uZywKY29sb3IuYjw9MC4wMDMxMzA4ID8gbmVhclplcm9TZWN0aW9uLmIgOiByZW1haW5pbmdTZWN0aW9uLmIpOwojZW5kaWYKfQojZW5kaWYKZmxvYXQgdG9MaW5lYXJTcGFjZShmbG9hdCBjb2xvcikKewojaWYgVVNFX0VYQUNUX1NSR0JfQ09OVkVSU0lPTlMKZmxvYXQgbmVhclplcm9TZWN0aW9uPTAuMDc3Mzk5MzgwOCpjb2xvcjsKZmxvYXQgcmVtYWluaW5nU2VjdGlvbj1wb3coMC45NDc4NjcyOTkqKGNvbG9yKzAuMDU1KSwyLjQpOwpyZXR1cm4gY29sb3I8PTAuMDQwNDUgPyBuZWFyWmVyb1NlY3Rpb24gOiByZW1haW5pbmdTZWN0aW9uOwojZWxzZQpyZXR1cm4gcG93KGNvbG9yLExpbmVhckVuY29kZVBvd2VyQXBwcm94KTsKI2VuZGlmCn0KdmVjMyB0b0xpbmVhclNwYWNlKHZlYzMgY29sb3IpCnsKI2lmIFVTRV9FWEFDVF9TUkdCX0NPTlZFUlNJT05TCnJldHVybiB0b0xpbmVhclNwYWNlRXhhY3QoY29sb3IpOwojZWxzZQpyZXR1cm4gcG93KGNvbG9yLHZlYzMoTGluZWFyRW5jb2RlUG93ZXJBcHByb3gpKTsKI2VuZGlmCn0KdmVjNCB0b0xpbmVhclNwYWNlKHZlYzQgY29sb3IpCnsKI2lmIFVTRV9FWEFDVF9TUkdCX0NPTlZFUlNJT05TCnJldHVybiB2ZWM0KHRvTGluZWFyU3BhY2VFeGFjdChjb2xvci5yZ2IpLGNvbG9yLmEpOwojZWxzZQpyZXR1cm4gdmVjNChwb3coY29sb3IucmdiLHZlYzMoTGluZWFyRW5jb2RlUG93ZXJBcHByb3gpKSxjb2xvci5hKTsKI2VuZGlmCn0KZmxvYXQgdG9HYW1tYVNwYWNlKGZsb2F0IGNvbG9yKQp7CiNpZiBVU0VfRVhBQ1RfU1JHQl9DT05WRVJTSU9OUwpmbG9hdCBuZWFyWmVyb1NlY3Rpb249MTIuOTIqY29sb3I7CmZsb2F0IHJlbWFpbmluZ1NlY3Rpb249MS4wNTUqcG93KGNvbG9yLDAuNDE2NjYpLTAuMDU1OwpyZXR1cm4gY29sb3I8PTAuMDAzMTMwOCA/IG5lYXJaZXJvU2VjdGlvbiA6IHJlbWFpbmluZ1NlY3Rpb247CiNlbHNlCnJldHVybiBwb3coY29sb3IsR2FtbWFFbmNvZGVQb3dlckFwcHJveCk7CiNlbmRpZgp9CnZlYzMgdG9HYW1tYVNwYWNlKHZlYzMgY29sb3IpCnsKI2lmIFVTRV9FWEFDVF9TUkdCX0NPTlZFUlNJT05TCnJldHVybiB0b0dhbW1hU3BhY2VFeGFjdChjb2xvcik7CiNlbHNlCnJldHVybiBwb3coY29sb3IsdmVjMyhHYW1tYUVuY29kZVBvd2VyQXBwcm94KSk7CiNlbmRpZgp9CnZlYzQgdG9HYW1tYVNwYWNlKHZlYzQgY29sb3IpCnsKI2lmIFVTRV9FWEFDVF9TUkdCX0NPTlZFUlNJT05TCnJldHVybiB2ZWM0KHRvR2FtbWFTcGFjZUV4YWN0KGNvbG9yLnJnYiksY29sb3IuYSk7CiNlbHNlCnJldHVybiB2ZWM0KHBvdyhjb2xvci5yZ2IsdmVjMyhHYW1tYUVuY29kZVBvd2VyQXBwcm94KSksY29sb3IuYSk7CiNlbmRpZgp9CmZsb2F0IHNxdWFyZShmbG9hdCB2YWx1ZSkKewpyZXR1cm4gdmFsdWUqdmFsdWU7Cn0KdmVjMyBzcXVhcmUodmVjMyB2YWx1ZSkKewpyZXR1cm4gdmFsdWUqdmFsdWU7Cn0KZmxvYXQgcG93NShmbG9hdCB2YWx1ZSkgewpmbG9hdCBzcT12YWx1ZSp2YWx1ZTsKcmV0dXJuIHNxKnNxKnZhbHVlOwp9CmZsb2F0IGdldEx1bWluYW5jZSh2ZWMzIGNvbG9yKQp7CnJldHVybiBjbGFtcChkb3QoY29sb3IsTHVtaW5hbmNlRW5jb2RlQXBwcm94KSwwLiwxLik7Cn0KZmxvYXQgZ2V0UmFuZCh2ZWMyIHNlZWQpIHsKcmV0dXJuIGZyYWN0KHNpbihkb3Qoc2VlZC54eSAsdmVjMigxMi45ODk4LDc4LjIzMykpKSo0Mzc1OC41NDUzKTsKfQpmbG9hdCBkaXRoZXIodmVjMiBzZWVkLGZsb2F0IHZhcmlhbmNlQW1vdW50KSB7CmZsb2F0IHJhbmQ9Z2V0UmFuZChzZWVkKTsKZmxvYXQgbm9ybVZhcmlhbmNlPXZhcmlhbmNlQW1vdW50LzI1NS4wOwpmbG9hdCBkaXRoZXI9bWl4KC1ub3JtVmFyaWFuY2Usbm9ybVZhcmlhbmNlLHJhbmQpOwpyZXR1cm4gZGl0aGVyOwp9CmNvbnN0IGZsb2F0IHJnYmRNYXhSYW5nZT0yNTUuMDsKdmVjNCB0b1JHQkQodmVjMyBjb2xvcikgewpmbG9hdCBtYXhSR0I9bWF4RXBzKG1heChjb2xvci5yLG1heChjb2xvci5nLGNvbG9yLmIpKSk7CmZsb2F0IEQgPW1heChyZ2JkTWF4UmFuZ2UvbWF4UkdCLDEuKTsKRCA9Y2xhbXAoZmxvb3IoRCkvMjU1LjAsMC4sMS4pOwp2ZWMzIHJnYj1jb2xvci5yZ2IqRDsKcmdiPXRvR2FtbWFTcGFjZShyZ2IpOwpyZXR1cm4gdmVjNChjbGFtcChyZ2IsMC4sMS4pLEQpOyAKfQp2ZWMzIGZyb21SR0JEKHZlYzQgcmdiZCkgewpyZ2JkLnJnYj10b0xpbmVhclNwYWNlKHJnYmQucmdiKTsKcmV0dXJuIHJnYmQucmdiL3JnYmQuYTsKfQp2ZWMzIHBhcmFsbGF4Q29ycmVjdE5vcm1hbCggdmVjMyB2ZXJ0ZXhQb3MsdmVjMyBvcmlnVmVjLHZlYzMgY3ViZVNpemUsdmVjMyBjdWJlUG9zICkgewp2ZWMzIGludk9yaWdWZWM9dmVjMygxLjAsMS4wLDEuMCkvb3JpZ1ZlYzsKdmVjMyBoYWxmU2l6ZT1jdWJlU2l6ZSowLjU7CnZlYzMgaW50ZXJzZWNBdE1heFBsYW5lPShjdWJlUG9zK2hhbGZTaXplLXZlcnRleFBvcykqaW52T3JpZ1ZlYzsKdmVjMyBpbnRlcnNlY0F0TWluUGxhbmU9KGN1YmVQb3MtaGFsZlNpemUtdmVydGV4UG9zKSppbnZPcmlnVmVjOwp2ZWMzIGxhcmdlc3RJbnRlcnNlYz1tYXgoaW50ZXJzZWNBdE1heFBsYW5lLGludGVyc2VjQXRNaW5QbGFuZSk7CmZsb2F0IGRpc3RhbmNlPW1pbihtaW4obGFyZ2VzdEludGVyc2VjLngsbGFyZ2VzdEludGVyc2VjLnkpLGxhcmdlc3RJbnRlcnNlYy56KTsKdmVjMyBpbnRlcnNlY3RQb3NpdGlvbldTPXZlcnRleFBvcytvcmlnVmVjKmRpc3RhbmNlOwpyZXR1cm4gaW50ZXJzZWN0UG9zaXRpb25XUy1jdWJlUG9zOwp9CmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtCYV09VWE7Y29uc3Qga2E9InNjZW5lVmVydGV4RGVjbGFyYXRpb24iLFZhPWB1bmlmb3JtIG1hdDQgdmlld1Byb2plY3Rpb247CiNpZmRlZiBNVUxUSVZJRVcKdW5pZm9ybSBtYXQ0IHZpZXdQcm9qZWN0aW9uUjsKI2VuZGlmCnVuaWZvcm0gbWF0NCB2aWV3Owp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbjsKdW5pZm9ybSB2ZWM0IHZFeWVQb3NpdGlvbjsKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2thXT1WYTtjb25zdCBXYT0ibWVzaFZlcnRleERlY2xhcmF0aW9uIix6YT1gdW5pZm9ybSBtYXQ0IHdvcmxkOwp1bmlmb3JtIGZsb2F0IHZpc2liaWxpdHk7CmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtXYV09emE7Y29uc3QgR2E9InNoYWRvd01hcFZlcnRleERlY2xhcmF0aW9uIixYYT1gI2luY2x1ZGU8c2NlbmVWZXJ0ZXhEZWNsYXJhdGlvbj4KI2luY2x1ZGU8bWVzaFZlcnRleERlY2xhcmF0aW9uPgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbR2FdPVhhO2NvbnN0IEhhPSJzY2VuZVVib0RlY2xhcmF0aW9uIixLYT1gbGF5b3V0KHN0ZDE0MCxjb2x1bW5fbWFqb3IpIHVuaWZvcm07CnVuaWZvcm0gU2NlbmUgewptYXQ0IHZpZXdQcm9qZWN0aW9uOwojaWZkZWYgTVVMVElWSUVXCm1hdDQgdmlld1Byb2plY3Rpb25SOwojZW5kaWYgCm1hdDQgdmlldzsKbWF0NCBwcm9qZWN0aW9uOwp2ZWM0IHZFeWVQb3NpdGlvbjsKfTsKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW0hhXT1LYTtjb25zdCBZYT0ibWVzaFVib0RlY2xhcmF0aW9uIixaYT1gI2lmZGVmIFdFQkdMMgp1bmlmb3JtIG1hdDQgd29ybGQ7CnVuaWZvcm0gZmxvYXQgdmlzaWJpbGl0eTsKI2Vsc2UKbGF5b3V0KHN0ZDE0MCxjb2x1bW5fbWFqb3IpIHVuaWZvcm07CnVuaWZvcm0gTWVzaAp7Cm1hdDQgd29ybGQ7CmZsb2F0IHZpc2liaWxpdHk7Cn07CiNlbmRpZgojZGVmaW5lIFdPUkxEX1VCTwpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbWWFdPVphO2NvbnN0IHFhPSJzaGFkb3dNYXBVYm9EZWNsYXJhdGlvbiIsamE9YGxheW91dChzdGQxNDAsY29sdW1uX21ham9yKSB1bmlmb3JtOwojaW5jbHVkZTxzY2VuZVVib0RlY2xhcmF0aW9uPgojaW5jbHVkZTxtZXNoVWJvRGVjbGFyYXRpb24+CmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtxYV09amE7Y29uc3QgJGE9InNoYWRvd01hcFZlcnRleEV4dHJhRGVjbGFyYXRpb24iLFFhPWAjaWYgU01fTk9STUFMQklBUz09MQp1bmlmb3JtIHZlYzMgbGlnaHREYXRhU007CiNlbmRpZgp1bmlmb3JtIHZlYzMgYmlhc0FuZFNjYWxlU007CnVuaWZvcm0gdmVjMiBkZXB0aFZhbHVlc1NNOwp2YXJ5aW5nIGZsb2F0IHZEZXB0aE1ldHJpY1NNOwojaWYgU01fVVNFRElTVEFOQ0U9PTEKdmFyeWluZyB2ZWMzIHZQb3NpdGlvbldTTTsKI2VuZGlmCiNpZiBkZWZpbmVkKFNNX0RFUFRIQ0xBTVApICYmIFNNX0RFUFRIQ0xBTVA9PTEKdmFyeWluZyBmbG9hdCB6U007CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbJGFdPVFhO2NvbnN0IEphPSJjbGlwUGxhbmVWZXJ0ZXhEZWNsYXJhdGlvbiIsZW89YCNpZmRlZiBDTElQUExBTkUKdW5pZm9ybSB2ZWM0IHZDbGlwUGxhbmU7CnZhcnlpbmcgZmxvYXQgZkNsaXBEaXN0YW5jZTsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkUyCnVuaWZvcm0gdmVjNCB2Q2xpcFBsYW5lMjsKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlMjsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkUzCnVuaWZvcm0gdmVjNCB2Q2xpcFBsYW5lMzsKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlMzsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkU0CnVuaWZvcm0gdmVjNCB2Q2xpcFBsYW5lNDsKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlNDsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkU1CnVuaWZvcm0gdmVjNCB2Q2xpcFBsYW5lNTsKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlNTsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkU2CnVuaWZvcm0gdmVjNCB2Q2xpcFBsYW5lNjsKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlNjsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtKYV09ZW87Y29uc3QgdG89Im1vcnBoVGFyZ2V0c1ZlcnRleEdsb2JhbCIsaW89YCNpZmRlZiBNT1JQSFRBUkdFVFMKI2lmZGVmIE1PUlBIVEFSR0VUU19URVhUVVJFCmZsb2F0IHZlcnRleElEOwojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVt0b109aW87Y29uc3Qgc289Im1vcnBoVGFyZ2V0c1ZlcnRleCIscm89YCNpZmRlZiBNT1JQSFRBUkdFVFMKI2lmZGVmIE1PUlBIVEFSR0VUU19URVhUVVJFIAp2ZXJ0ZXhJRD1mbG9hdChnbF9WZXJ0ZXhJRCkqbW9ycGhUYXJnZXRUZXh0dXJlSW5mby54Owpwb3NpdGlvblVwZGF0ZWQrPShyZWFkVmVjdG9yM0Zyb21SYXdTYW1wbGVyKHtYfSx2ZXJ0ZXhJRCktcG9zaXRpb24pKm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1t7WH1dOwp2ZXJ0ZXhJRCs9MS4wOwojaWZkZWYgTU9SUEhUQVJHRVRTX05PUk1BTApub3JtYWxVcGRhdGVkKz0ocmVhZFZlY3RvcjNGcm9tUmF3U2FtcGxlcih7WH0sdmVydGV4SUQpIC1ub3JtYWwpKm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1t7WH1dOwp2ZXJ0ZXhJRCs9MS4wOwojZW5kaWYKI2lmZGVmIE1PUlBIVEFSR0VUU19VVgp1dlVwZGF0ZWQrPShyZWFkVmVjdG9yM0Zyb21SYXdTYW1wbGVyKHtYfSx2ZXJ0ZXhJRCkueHktdXYpKm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1t7WH1dOwp2ZXJ0ZXhJRCs9MS4wOwojZW5kaWYKI2lmZGVmIE1PUlBIVEFSR0VUU19UQU5HRU5UCnRhbmdlbnRVcGRhdGVkLnh5eis9KHJlYWRWZWN0b3IzRnJvbVJhd1NhbXBsZXIoe1h9LHZlcnRleElEKSAtdGFuZ2VudC54eXopKm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1t7WH1dOwojZW5kaWYKI2Vsc2UKcG9zaXRpb25VcGRhdGVkKz0ocG9zaXRpb257WH0tcG9zaXRpb24pKm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1t7WH1dOwojaWZkZWYgTU9SUEhUQVJHRVRTX05PUk1BTApub3JtYWxVcGRhdGVkKz0obm9ybWFse1h9LW5vcm1hbCkqbW9ycGhUYXJnZXRJbmZsdWVuY2VzW3tYfV07CiNlbmRpZgojaWZkZWYgTU9SUEhUQVJHRVRTX1RBTkdFTlQKdGFuZ2VudFVwZGF0ZWQueHl6Kz0odGFuZ2VudHtYfS10YW5nZW50Lnh5eikqbW9ycGhUYXJnZXRJbmZsdWVuY2VzW3tYfV07CiNlbmRpZgojaWZkZWYgTU9SUEhUQVJHRVRTX1VWCnV2VXBkYXRlZCs9KHV2X3tYfS11dikqbW9ycGhUYXJnZXRJbmZsdWVuY2VzW3tYfV07CiNlbmRpZgojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtzb109cm87Y29uc3Qgbm89Imluc3RhbmNlc1ZlcnRleCIsYW89YCNpZmRlZiBJTlNUQU5DRVMKbWF0NCBmaW5hbFdvcmxkPW1hdDQod29ybGQwLHdvcmxkMSx3b3JsZDIsd29ybGQzKTsKI2lmIGRlZmluZWQoUFJFUEFTU19WRUxPQ0lUWSkgfHwgZGVmaW5lZChWRUxPQ0lUWSkKbWF0NCBmaW5hbFByZXZpb3VzV29ybGQ9bWF0NChwcmV2aW91c1dvcmxkMCxwcmV2aW91c1dvcmxkMSxwcmV2aW91c1dvcmxkMixwcmV2aW91c1dvcmxkMyk7CiNlbmRpZgojaWZkZWYgVEhJTl9JTlNUQU5DRVMKZmluYWxXb3JsZD13b3JsZCpmaW5hbFdvcmxkOwojaWYgZGVmaW5lZChQUkVQQVNTX1ZFTE9DSVRZKSB8fCBkZWZpbmVkKFZFTE9DSVRZKQpmaW5hbFByZXZpb3VzV29ybGQ9cHJldmlvdXNXb3JsZCpmaW5hbFByZXZpb3VzV29ybGQ7CiNlbmRpZgojZW5kaWYKI2Vsc2UKbWF0NCBmaW5hbFdvcmxkPXdvcmxkOwojaWYgZGVmaW5lZChQUkVQQVNTX1ZFTE9DSVRZKSB8fCBkZWZpbmVkKFZFTE9DSVRZKQptYXQ0IGZpbmFsUHJldmlvdXNXb3JsZD1wcmV2aW91c1dvcmxkOwojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtub109YW87Y29uc3Qgb289ImJvbmVzVmVydGV4Iixobz1gI2lmbmRlZiBCQUtFRF9WRVJURVhfQU5JTUFUSU9OX1RFWFRVUkUKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjAKbWF0NCBpbmZsdWVuY2U7CiNpZmRlZiBCT05FVEVYVFVSRQppbmZsdWVuY2U9cmVhZE1hdHJpeEZyb21SYXdTYW1wbGVyKGJvbmVTYW1wbGVyLG1hdHJpY2VzSW5kaWNlc1swXSkqbWF0cmljZXNXZWlnaHRzWzBdOwojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MQppbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlcihib25lU2FtcGxlcixtYXRyaWNlc0luZGljZXNbMV0pKm1hdHJpY2VzV2VpZ2h0c1sxXTsKI2VuZGlmCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz4yCmluZmx1ZW5jZSs9cmVhZE1hdHJpeEZyb21SYXdTYW1wbGVyKGJvbmVTYW1wbGVyLG1hdHJpY2VzSW5kaWNlc1syXSkqbWF0cmljZXNXZWlnaHRzWzJdOwojZW5kaWYKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjMKaW5mbHVlbmNlKz1yZWFkTWF0cml4RnJvbVJhd1NhbXBsZXIoYm9uZVNhbXBsZXIsbWF0cmljZXNJbmRpY2VzWzNdKSptYXRyaWNlc1dlaWdodHNbM107CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NAppbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlcihib25lU2FtcGxlcixtYXRyaWNlc0luZGljZXNFeHRyYVswXSkqbWF0cmljZXNXZWlnaHRzRXh0cmFbMF07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NQppbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlcihib25lU2FtcGxlcixtYXRyaWNlc0luZGljZXNFeHRyYVsxXSkqbWF0cmljZXNXZWlnaHRzRXh0cmFbMV07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NgppbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlcihib25lU2FtcGxlcixtYXRyaWNlc0luZGljZXNFeHRyYVsyXSkqbWF0cmljZXNXZWlnaHRzRXh0cmFbMl07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NwppbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlcihib25lU2FtcGxlcixtYXRyaWNlc0luZGljZXNFeHRyYVszXSkqbWF0cmljZXNXZWlnaHRzRXh0cmFbM107CiNlbmRpZgojZWxzZQppbmZsdWVuY2U9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNbMF0pXSptYXRyaWNlc1dlaWdodHNbMF07CiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz4xCmluZmx1ZW5jZSs9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNbMV0pXSptYXRyaWNlc1dlaWdodHNbMV07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MgppbmZsdWVuY2UrPW1Cb25lc1tpbnQobWF0cmljZXNJbmRpY2VzWzJdKV0qbWF0cmljZXNXZWlnaHRzWzJdOwojZW5kaWYKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjMKaW5mbHVlbmNlKz1tQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc1szXSldKm1hdHJpY2VzV2VpZ2h0c1szXTsKI2VuZGlmCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz40CmluZmx1ZW5jZSs9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNFeHRyYVswXSldKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzBdOwojZW5kaWYKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjUKaW5mbHVlbmNlKz1tQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc0V4dHJhWzFdKV0qbWF0cmljZXNXZWlnaHRzRXh0cmFbMV07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NgppbmZsdWVuY2UrPW1Cb25lc1tpbnQobWF0cmljZXNJbmRpY2VzRXh0cmFbMl0pXSptYXRyaWNlc1dlaWdodHNFeHRyYVsyXTsKI2VuZGlmCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz43CmluZmx1ZW5jZSs9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNFeHRyYVszXSldKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzNdOwojZW5kaWYKI2VuZGlmCmZpbmFsV29ybGQ9ZmluYWxXb3JsZCppbmZsdWVuY2U7CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW29vXT1obztjb25zdCBsbz0iYmFrZWRWZXJ0ZXhBbmltYXRpb24iLGNvPWAjaWZkZWYgQkFLRURfVkVSVEVYX0FOSU1BVElPTl9URVhUVVJFCnsKI2lmZGVmIElOU1RBTkNFUwojZGVmaW5lIEJWQVNOQU1FIGJha2VkVmVydGV4QW5pbWF0aW9uU2V0dGluZ3NJbnN0YW5jZWQKI2Vsc2UKI2RlZmluZSBCVkFTTkFNRSBiYWtlZFZlcnRleEFuaW1hdGlvblNldHRpbmdzCiNlbmRpZgpmbG9hdCBWQVRTdGFydEZyYW1lPUJWQVNOQU1FLng7CmZsb2F0IFZBVEVuZEZyYW1lPUJWQVNOQU1FLnk7CmZsb2F0IFZBVE9mZnNldEZyYW1lPUJWQVNOQU1FLno7CmZsb2F0IFZBVFNwZWVkPUJWQVNOQU1FLnc7CmZsb2F0IHRvdGFsRnJhbWVzPVZBVEVuZEZyYW1lLVZBVFN0YXJ0RnJhbWUrMS4wOwpmbG9hdCB0aW1lPWJha2VkVmVydGV4QW5pbWF0aW9uVGltZSpWQVRTcGVlZC90b3RhbEZyYW1lczsKZmxvYXQgZnJhbWVDb3JyZWN0aW9uPXRpbWU8MS4wID8gMC4wIDogMS4wOwpmbG9hdCBudW1PZkZyYW1lcz10b3RhbEZyYW1lcy1mcmFtZUNvcnJlY3Rpb247CmZsb2F0IFZBVEZyYW1lTnVtPWZyYWN0KHRpbWUpKm51bU9mRnJhbWVzOwpWQVRGcmFtZU51bT1tb2QoVkFURnJhbWVOdW0rVkFUT2Zmc2V0RnJhbWUsbnVtT2ZGcmFtZXMpOwpWQVRGcmFtZU51bT1mbG9vcihWQVRGcmFtZU51bSk7ClZBVEZyYW1lTnVtKz1WQVRTdGFydEZyYW1lK2ZyYW1lQ29ycmVjdGlvbjsKbWF0NCBWQVRJbmZsdWVuY2U7ClZBVEluZmx1ZW5jZT1yZWFkTWF0cml4RnJvbVJhd1NhbXBsZXJWQVQoYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlLG1hdHJpY2VzSW5kaWNlc1swXSxWQVRGcmFtZU51bSkqbWF0cmljZXNXZWlnaHRzWzBdOwojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MQpWQVRJbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmUsbWF0cmljZXNJbmRpY2VzWzFdLFZBVEZyYW1lTnVtKSptYXRyaWNlc1dlaWdodHNbMV07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MgpWQVRJbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmUsbWF0cmljZXNJbmRpY2VzWzJdLFZBVEZyYW1lTnVtKSptYXRyaWNlc1dlaWdodHNbMl07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MwpWQVRJbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmUsbWF0cmljZXNJbmRpY2VzWzNdLFZBVEZyYW1lTnVtKSptYXRyaWNlc1dlaWdodHNbM107CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NApWQVRJbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmUsbWF0cmljZXNJbmRpY2VzRXh0cmFbMF0sVkFURnJhbWVOdW0pKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzBdOwojZW5kaWYKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjUKVkFUSW5mbHVlbmNlKz1yZWFkTWF0cml4RnJvbVJhd1NhbXBsZXJWQVQoYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlLG1hdHJpY2VzSW5kaWNlc0V4dHJhWzFdLFZBVEZyYW1lTnVtKSptYXRyaWNlc1dlaWdodHNFeHRyYVsxXTsKI2VuZGlmCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz42ClZBVEluZmx1ZW5jZSs9cmVhZE1hdHJpeEZyb21SYXdTYW1wbGVyVkFUKGJha2VkVmVydGV4QW5pbWF0aW9uVGV4dHVyZSxtYXRyaWNlc0luZGljZXNFeHRyYVsyXSxWQVRGcmFtZU51bSkqbWF0cmljZXNXZWlnaHRzRXh0cmFbMl07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NwpWQVRJbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmUsbWF0cmljZXNJbmRpY2VzRXh0cmFbM10sVkFURnJhbWVOdW0pKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzNdOwojZW5kaWYKZmluYWxXb3JsZD1maW5hbFdvcmxkKlZBVEluZmx1ZW5jZTsKfQojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2xvXT1jbztjb25zdCB1bz0ic2hhZG93TWFwVmVydGV4Tm9ybWFsQmlhcyIsZm89YCNpZiBTTV9OT1JNQUxCSUFTPT0xCiNpZiBTTV9ESVJFQ1RJT05JTkxJR0hUREFUQT09MQp2ZWMzIHdvcmxkTGlnaHREaXJTTT1ub3JtYWxpemUoLWxpZ2h0RGF0YVNNLnh5eik7CiNlbHNlCnZlYzMgZGlyZWN0aW9uVG9MaWdodFNNPWxpZ2h0RGF0YVNNLnh5ei13b3JsZFBvcy54eXo7CnZlYzMgd29ybGRMaWdodERpclNNPW5vcm1hbGl6ZShkaXJlY3Rpb25Ub0xpZ2h0U00pOwojZW5kaWYKZmxvYXQgbmRsU009ZG90KHZOb3JtYWxXLHdvcmxkTGlnaHREaXJTTSk7CmZsb2F0IHNpbk5MU009c3FydCgxLjAtbmRsU00qbmRsU00pOwpmbG9hdCBub3JtYWxCaWFzU009Ymlhc0FuZFNjYWxlU00ueSpzaW5OTFNNOwp3b3JsZFBvcy54eXotPXZOb3JtYWxXKm5vcm1hbEJpYXNTTTsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVt1b109Zm87Y29uc3QgX289InNoYWRvd01hcFZlcnRleE1ldHJpYyIsZ289YCNpZiBTTV9VU0VESVNUQU5DRT09MQp2UG9zaXRpb25XU009d29ybGRQb3MueHl6OwojZW5kaWYKI2lmIFNNX0RFUFRIVEVYVFVSRT09MQojaWZkZWYgSVNfTkRDX0hBTEZfWlJBTkdFCiNkZWZpbmUgQklBU0ZBQ1RPUiAwLjUKI2Vsc2UKI2RlZmluZSBCSUFTRkFDVE9SIDEuMAojZW5kaWYKI2lmZGVmIFVTRV9SRVZFUlNFX0RFUFRIQlVGRkVSCmdsX1Bvc2l0aW9uLnotPWJpYXNBbmRTY2FsZVNNLngqZ2xfUG9zaXRpb24udypCSUFTRkFDVE9SOwojZWxzZQpnbF9Qb3NpdGlvbi56Kz1iaWFzQW5kU2NhbGVTTS54KmdsX1Bvc2l0aW9uLncqQklBU0ZBQ1RPUjsKI2VuZGlmCiNlbmRpZgojaWYgZGVmaW5lZChTTV9ERVBUSENMQU1QKSAmJiBTTV9ERVBUSENMQU1QPT0xCnpTTT1nbF9Qb3NpdGlvbi56OwpnbF9Qb3NpdGlvbi56PTAuMDsKI2VsaWYgU01fVVNFRElTVEFOQ0U9PTAKI2lmZGVmIFVTRV9SRVZFUlNFX0RFUFRIQlVGRkVSCnZEZXB0aE1ldHJpY1NNPSgtZ2xfUG9zaXRpb24ueitkZXB0aFZhbHVlc1NNLngpL2RlcHRoVmFsdWVzU00ueStiaWFzQW5kU2NhbGVTTS54OwojZWxzZQp2RGVwdGhNZXRyaWNTTT0oZ2xfUG9zaXRpb24ueitkZXB0aFZhbHVlc1NNLngpL2RlcHRoVmFsdWVzU00ueStiaWFzQW5kU2NhbGVTTS54OwojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtfb109Z287Y29uc3QgcG89ImNsaXBQbGFuZVZlcnRleCIsbW89YCNpZmRlZiBDTElQUExBTkUKZkNsaXBEaXN0YW5jZT1kb3Qod29ybGRQb3MsdkNsaXBQbGFuZSk7CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FMgpmQ2xpcERpc3RhbmNlMj1kb3Qod29ybGRQb3MsdkNsaXBQbGFuZTIpOwojZW5kaWYKI2lmZGVmIENMSVBQTEFORTMKZkNsaXBEaXN0YW5jZTM9ZG90KHdvcmxkUG9zLHZDbGlwUGxhbmUzKTsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkU0CmZDbGlwRGlzdGFuY2U0PWRvdCh3b3JsZFBvcyx2Q2xpcFBsYW5lNCk7CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FNQpmQ2xpcERpc3RhbmNlNT1kb3Qod29ybGRQb3MsdkNsaXBQbGFuZTUpOwojZW5kaWYKI2lmZGVmIENMSVBQTEFORTYKZkNsaXBEaXN0YW5jZTY9ZG90KHdvcmxkUG9zLHZDbGlwUGxhbmU2KTsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtwb109bW87Y29uc3QgRW89InNoYWRvd01hcFZlcnRleFNoYWRlciIsdm89YGF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uOwojaWZkZWYgTk9STUFMCmF0dHJpYnV0ZSB2ZWMzIG5vcm1hbDsKI2VuZGlmCiNpbmNsdWRlPGJvbmVzRGVjbGFyYXRpb24+CiNpbmNsdWRlPGJha2VkVmVydGV4QW5pbWF0aW9uRGVjbGFyYXRpb24+CiNpbmNsdWRlPG1vcnBoVGFyZ2V0c1ZlcnRleEdsb2JhbERlY2xhcmF0aW9uPgojaW5jbHVkZTxtb3JwaFRhcmdldHNWZXJ0ZXhEZWNsYXJhdGlvbj5bMC4ubWF4U2ltdWx0YW5lb3VzTW9ycGhUYXJnZXRzXQojaWZkZWYgSU5TVEFOQ0VTCmF0dHJpYnV0ZSB2ZWM0IHdvcmxkMDsKYXR0cmlidXRlIHZlYzQgd29ybGQxOwphdHRyaWJ1dGUgdmVjNCB3b3JsZDI7CmF0dHJpYnV0ZSB2ZWM0IHdvcmxkMzsKI2VuZGlmCiNpbmNsdWRlPGhlbHBlckZ1bmN0aW9ucz4KI2luY2x1ZGU8X19kZWNsX19zaGFkb3dNYXBWZXJ0ZXg+CiNpZmRlZiBBTFBIQVRFWFRVUkUKdmFyeWluZyB2ZWMyIHZVVjsKdW5pZm9ybSBtYXQ0IGRpZmZ1c2VNYXRyaXg7CiNpZmRlZiBVVjEKYXR0cmlidXRlIHZlYzIgdXY7CiNlbmRpZgojaWZkZWYgVVYyCmF0dHJpYnV0ZSB2ZWMyIHV2MjsKI2VuZGlmCiNlbmRpZgojaW5jbHVkZTxzaGFkb3dNYXBWZXJ0ZXhFeHRyYURlY2xhcmF0aW9uPgojaW5jbHVkZTxjbGlwUGxhbmVWZXJ0ZXhEZWNsYXJhdGlvbj4KI2RlZmluZSBDVVNUT01fVkVSVEVYX0RFRklOSVRJT05TCnZvaWQgbWFpbih2b2lkKQp7CnZlYzMgcG9zaXRpb25VcGRhdGVkPXBvc2l0aW9uOwojaWZkZWYgVVYxCnZlYzIgdXZVcGRhdGVkPXV2OwojZW5kaWYKI2lmZGVmIE5PUk1BTAp2ZWMzIG5vcm1hbFVwZGF0ZWQ9bm9ybWFsOwojZW5kaWYKI2luY2x1ZGU8bW9ycGhUYXJnZXRzVmVydGV4R2xvYmFsPgojaW5jbHVkZTxtb3JwaFRhcmdldHNWZXJ0ZXg+WzAuLm1heFNpbXVsdGFuZW91c01vcnBoVGFyZ2V0c10KI2luY2x1ZGU8aW5zdGFuY2VzVmVydGV4PgojaW5jbHVkZTxib25lc1ZlcnRleD4KI2luY2x1ZGU8YmFrZWRWZXJ0ZXhBbmltYXRpb24+CnZlYzQgd29ybGRQb3M9ZmluYWxXb3JsZCp2ZWM0KHBvc2l0aW9uVXBkYXRlZCwxLjApOwojaWZkZWYgTk9STUFMCm1hdDMgbm9ybVdvcmxkU009bWF0MyhmaW5hbFdvcmxkKTsKI2lmIGRlZmluZWQoSU5TVEFOQ0VTKSAmJiBkZWZpbmVkKFRISU5fSU5TVEFOQ0VTKQp2ZWMzIHZOb3JtYWxXPW5vcm1hbFVwZGF0ZWQvdmVjMyhkb3Qobm9ybVdvcmxkU01bMF0sbm9ybVdvcmxkU01bMF0pLGRvdChub3JtV29ybGRTTVsxXSxub3JtV29ybGRTTVsxXSksZG90KG5vcm1Xb3JsZFNNWzJdLG5vcm1Xb3JsZFNNWzJdKSk7CnZOb3JtYWxXPW5vcm1hbGl6ZShub3JtV29ybGRTTSp2Tm9ybWFsVyk7CiNlbHNlCiNpZmRlZiBOT05VTklGT1JNU0NBTElORwpub3JtV29ybGRTTT10cmFuc3Bvc2VNYXQzKGludmVyc2VNYXQzKG5vcm1Xb3JsZFNNKSk7CiNlbmRpZgp2ZWMzIHZOb3JtYWxXPW5vcm1hbGl6ZShub3JtV29ybGRTTSpub3JtYWxVcGRhdGVkKTsKI2VuZGlmCiNlbmRpZgojaW5jbHVkZTxzaGFkb3dNYXBWZXJ0ZXhOb3JtYWxCaWFzPgpnbF9Qb3NpdGlvbj12aWV3UHJvamVjdGlvbip3b3JsZFBvczsKI2luY2x1ZGU8c2hhZG93TWFwVmVydGV4TWV0cmljPgojaWZkZWYgQUxQSEFURVhUVVJFCiNpZmRlZiBVVjEKdlVWPXZlYzIoZGlmZnVzZU1hdHJpeCp2ZWM0KHV2VXBkYXRlZCwxLjAsMC4wKSk7CiNlbmRpZgojaWZkZWYgVVYyCnZVVj12ZWMyKGRpZmZ1c2VNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpOwojZW5kaWYKI2VuZGlmCiNpbmNsdWRlPGNsaXBQbGFuZVZlcnRleD4KfWA7VS5TaGFkZXJzU3RvcmVbRW9dPXZvO2NvbnN0IFRvPSJkZXB0aEJveEJsdXJQaXhlbFNoYWRlciIsYm89YHZhcnlpbmcgdmVjMiB2VVY7CnVuaWZvcm0gc2FtcGxlcjJEIHRleHR1cmVTYW1wbGVyOwp1bmlmb3JtIHZlYzIgc2NyZWVuU2l6ZTsKI2RlZmluZSBDVVNUT01fRlJBR01FTlRfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpCnsKdmVjNCBjb2xvckRlcHRoPXZlYzQoMC4wKTsKZm9yIChpbnQgeD0tT0ZGU0VUOyB4PD1PRkZTRVQ7IHgrKykKZm9yIChpbnQgeT0tT0ZGU0VUOyB5PD1PRkZTRVQ7IHkrKykKY29sb3JEZXB0aCs9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKHgseSkvc2NyZWVuU2l6ZSk7CmdsX0ZyYWdDb2xvcj0oY29sb3JEZXB0aC9mbG9hdCgoT0ZGU0VUKjIrMSkqKE9GRlNFVCoyKzEpKSk7Cn1gO1UuU2hhZGVyc1N0b3JlW1RvXT1ibztjb25zdCBTbz0ic2hhZG93TWFwRnJhZ21lbnRTb2Z0VHJhbnNwYXJlbnRTaGFkb3ciLHhvPWAjaWYgU01fU09GVFRSQU5TUEFSRU5UU0hBRE9XPT0xCmlmICgoYmF5ZXJEaXRoZXI4KGZsb29yKG1vZChnbF9GcmFnQ29vcmQueHksOC4wKSkpKS82NC4wPj1zb2Z0VHJhbnNwYXJlbnRTaGFkb3dTTSphbHBoYSkgZGlzY2FyZDsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtTb109eG87Y2xhc3MgR3tjb25zdHJ1Y3RvcihlLHQsaSxzKXt0aGlzLm9uQmVmb3JlU2hhZG93TWFwUmVuZGVyT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQWZ0ZXJTaGFkb3dNYXBSZW5kZXJPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25CZWZvcmVTaGFkb3dNYXBSZW5kZXJNZXNoT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQWZ0ZXJTaGFkb3dNYXBSZW5kZXJNZXNoT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9iaWFzPTVlLTUsdGhpcy5fbm9ybWFsQmlhcz0wLHRoaXMuX2JsdXJCb3hPZmZzZXQ9MSx0aGlzLl9ibHVyU2NhbGU9Mix0aGlzLl9ibHVyS2VybmVsPTEsdGhpcy5fdXNlS2VybmVsQmx1cj0hMSx0aGlzLl9maWx0ZXI9Ry5GSUxURVJfTk9ORSx0aGlzLl9maWx0ZXJpbmdRdWFsaXR5PUcuUVVBTElUWV9ISUdILHRoaXMuX2NvbnRhY3RIYXJkZW5pbmdMaWdodFNpemVVVlJhdGlvPS4xLHRoaXMuX2RhcmtuZXNzPTAsdGhpcy5fdHJhbnNwYXJlbmN5U2hhZG93PSExLHRoaXMuZW5hYmxlU29mdFRyYW5zcGFyZW50U2hhZG93PSExLHRoaXMudXNlT3BhY2l0eVRleHR1cmVGb3JUcmFuc3BhcmVudFNoYWRvdz0hMSx0aGlzLmZydXN0dW1FZGdlRmFsbG9mZj0wLHRoaXMuZm9yY2VCYWNrRmFjZXNPbmx5PSExLHRoaXMuX2xpZ2h0RGlyZWN0aW9uPXAuWmVybygpLHRoaXMuX3ZpZXdNYXRyaXg9eC5aZXJvKCksdGhpcy5fcHJvamVjdGlvbk1hdHJpeD14Llplcm8oKSx0aGlzLl90cmFuc2Zvcm1NYXRyaXg9eC5aZXJvKCksdGhpcy5fY2FjaGVkUG9zaXRpb249bmV3IHAoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLHRoaXMuX2NhY2hlZERpcmVjdGlvbj1uZXcgcChOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSksdGhpcy5fY3VycmVudEZhY2VJbmRleD0wLHRoaXMuX2N1cnJlbnRGYWNlSW5kZXhDYWNoZT0wLHRoaXMuX2RlZmF1bHRUZXh0dXJlTWF0cml4PXguSWRlbnRpdHkoKSx0aGlzLl9tYXBTaXplPWUsdGhpcy5fbGlnaHQ9dCx0aGlzLl9zY2VuZT10LmdldFNjZW5lKCksdGhpcy5fY2FtZXJhPXM/P251bGw7bGV0IHI9dC5fc2hhZG93R2VuZXJhdG9ycztyfHwocj10Ll9zaGFkb3dHZW5lcmF0b3JzPW5ldyBNYXApLHIuc2V0KHRoaXMuX2NhbWVyYSx0aGlzKSx0aGlzLmlkPXQuaWQsdGhpcy5fdXNlVUJPPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLnN1cHBvcnRzVW5pZm9ybUJ1ZmZlcnMsdGhpcy5fdXNlVUJPJiYodGhpcy5fc2NlbmVVQk9zPVtdLHRoaXMuX3NjZW5lVUJPcy5wdXNoKHRoaXMuX3NjZW5lLmNyZWF0ZVNjZW5lVW5pZm9ybUJ1ZmZlcihgU2NlbmUgZm9yIFNoYWRvdyBHZW5lcmF0b3IgKGxpZ2h0ICIke3RoaXMuX2xpZ2h0Lm5hbWV9IilgKSkpLEcuX1NjZW5lQ29tcG9uZW50SW5pdGlhbGl6YXRpb24odGhpcy5fc2NlbmUpO2NvbnN0IG49dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpO2k/bi50ZXh0dXJlRmxvYXRSZW5kZXImJm4udGV4dHVyZUZsb2F0TGluZWFyRmlsdGVyaW5nP3RoaXMuX3RleHR1cmVUeXBlPTE6bi50ZXh0dXJlSGFsZkZsb2F0UmVuZGVyJiZuLnRleHR1cmVIYWxmRmxvYXRMaW5lYXJGaWx0ZXJpbmc/dGhpcy5fdGV4dHVyZVR5cGU9Mjp0aGlzLl90ZXh0dXJlVHlwZT0wOm4udGV4dHVyZUhhbGZGbG9hdFJlbmRlciYmbi50ZXh0dXJlSGFsZkZsb2F0TGluZWFyRmlsdGVyaW5nP3RoaXMuX3RleHR1cmVUeXBlPTI6bi50ZXh0dXJlRmxvYXRSZW5kZXImJm4udGV4dHVyZUZsb2F0TGluZWFyRmlsdGVyaW5nP3RoaXMuX3RleHR1cmVUeXBlPTE6dGhpcy5fdGV4dHVyZVR5cGU9MCx0aGlzLl9pbml0aWFsaXplR2VuZXJhdG9yKCksdGhpcy5fYXBwbHlGaWx0ZXJWYWx1ZXMoKX1nZXQgYmlhcygpe3JldHVybiB0aGlzLl9iaWFzfXNldCBiaWFzKGUpe3RoaXMuX2JpYXM9ZX1nZXQgbm9ybWFsQmlhcygpe3JldHVybiB0aGlzLl9ub3JtYWxCaWFzfXNldCBub3JtYWxCaWFzKGUpe3RoaXMuX25vcm1hbEJpYXM9ZX1nZXQgYmx1ckJveE9mZnNldCgpe3JldHVybiB0aGlzLl9ibHVyQm94T2Zmc2V0fXNldCBibHVyQm94T2Zmc2V0KGUpe3RoaXMuX2JsdXJCb3hPZmZzZXQhPT1lJiYodGhpcy5fYmx1ckJveE9mZnNldD1lLHRoaXMuX2Rpc3Bvc2VCbHVyUG9zdFByb2Nlc3NlcygpKX1nZXQgYmx1clNjYWxlKCl7cmV0dXJuIHRoaXMuX2JsdXJTY2FsZX1zZXQgYmx1clNjYWxlKGUpe3RoaXMuX2JsdXJTY2FsZSE9PWUmJih0aGlzLl9ibHVyU2NhbGU9ZSx0aGlzLl9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKSl9Z2V0IGJsdXJLZXJuZWwoKXtyZXR1cm4gdGhpcy5fYmx1cktlcm5lbH1zZXQgYmx1cktlcm5lbChlKXt0aGlzLl9ibHVyS2VybmVsIT09ZSYmKHRoaXMuX2JsdXJLZXJuZWw9ZSx0aGlzLl9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKSl9Z2V0IHVzZUtlcm5lbEJsdXIoKXtyZXR1cm4gdGhpcy5fdXNlS2VybmVsQmx1cn1zZXQgdXNlS2VybmVsQmx1cihlKXt0aGlzLl91c2VLZXJuZWxCbHVyIT09ZSYmKHRoaXMuX3VzZUtlcm5lbEJsdXI9ZSx0aGlzLl9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKSl9Z2V0IGRlcHRoU2NhbGUoKXtyZXR1cm4gdGhpcy5fZGVwdGhTY2FsZSE9PXZvaWQgMD90aGlzLl9kZXB0aFNjYWxlOnRoaXMuX2xpZ2h0LmdldERlcHRoU2NhbGUoKX1zZXQgZGVwdGhTY2FsZShlKXt0aGlzLl9kZXB0aFNjYWxlPWV9X3ZhbGlkYXRlRmlsdGVyKGUpe3JldHVybiBlfWdldCBmaWx0ZXIoKXtyZXR1cm4gdGhpcy5fZmlsdGVyfXNldCBmaWx0ZXIoZSl7aWYoZT10aGlzLl92YWxpZGF0ZUZpbHRlcihlKSx0aGlzLl9saWdodC5uZWVkQ3ViZSgpKXtpZihlPT09Ry5GSUxURVJfQkxVUkVYUE9ORU5USUFMU0hBRE9XTUFQKXt0aGlzLnVzZUV4cG9uZW50aWFsU2hhZG93TWFwPSEwO3JldHVybn1lbHNlIGlmKGU9PT1HLkZJTFRFUl9CTFVSQ0xPU0VFWFBPTkVOVElBTFNIQURPV01BUCl7dGhpcy51c2VDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwPSEwO3JldHVybn1lbHNlIGlmKGU9PT1HLkZJTFRFUl9QQ0Z8fGU9PT1HLkZJTFRFUl9QQ1NTKXt0aGlzLnVzZVBvaXNzb25TYW1wbGluZz0hMDtyZXR1cm59fWlmKChlPT09Ry5GSUxURVJfUENGfHxlPT09Ry5GSUxURVJfUENTUykmJiF0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5fZmVhdHVyZXMuc3VwcG9ydFNoYWRvd1NhbXBsZXJzKXt0aGlzLnVzZVBvaXNzb25TYW1wbGluZz0hMDtyZXR1cm59dGhpcy5fZmlsdGVyIT09ZSYmKHRoaXMuX2ZpbHRlcj1lLHRoaXMuX2Rpc3Bvc2VCbHVyUG9zdFByb2Nlc3NlcygpLHRoaXMuX2FwcGx5RmlsdGVyVmFsdWVzKCksdGhpcy5fbGlnaHQuX21hcmtNZXNoZXNBc0xpZ2h0RGlydHkoKSl9Z2V0IHVzZVBvaXNzb25TYW1wbGluZygpe3JldHVybiB0aGlzLmZpbHRlcj09PUcuRklMVEVSX1BPSVNTT05TQU1QTElOR31zZXQgdXNlUG9pc3NvblNhbXBsaW5nKGUpe2NvbnN0IHQ9dGhpcy5fdmFsaWRhdGVGaWx0ZXIoRy5GSUxURVJfUE9JU1NPTlNBTVBMSU5HKTshZSYmdGhpcy5maWx0ZXIhPT1HLkZJTFRFUl9QT0lTU09OU0FNUExJTkd8fCh0aGlzLmZpbHRlcj1lP3Q6Ry5GSUxURVJfTk9ORSl9Z2V0IHVzZUV4cG9uZW50aWFsU2hhZG93TWFwKCl7cmV0dXJuIHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfRVhQT05FTlRJQUxTSEFET1dNQVB9c2V0IHVzZUV4cG9uZW50aWFsU2hhZG93TWFwKGUpe2NvbnN0IHQ9dGhpcy5fdmFsaWRhdGVGaWx0ZXIoRy5GSUxURVJfRVhQT05FTlRJQUxTSEFET1dNQVApOyFlJiZ0aGlzLmZpbHRlciE9PUcuRklMVEVSX0VYUE9ORU5USUFMU0hBRE9XTUFQfHwodGhpcy5maWx0ZXI9ZT90OkcuRklMVEVSX05PTkUpfWdldCB1c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXAoKXtyZXR1cm4gdGhpcy5maWx0ZXI9PT1HLkZJTFRFUl9CTFVSRVhQT05FTlRJQUxTSEFET1dNQVB9c2V0IHVzZUJsdXJFeHBvbmVudGlhbFNoYWRvd01hcChlKXtjb25zdCB0PXRoaXMuX3ZhbGlkYXRlRmlsdGVyKEcuRklMVEVSX0JMVVJFWFBPTkVOVElBTFNIQURPV01BUCk7IWUmJnRoaXMuZmlsdGVyIT09Ry5GSUxURVJfQkxVUkVYUE9ORU5USUFMU0hBRE9XTUFQfHwodGhpcy5maWx0ZXI9ZT90OkcuRklMVEVSX05PTkUpfWdldCB1c2VDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwKCl7cmV0dXJuIHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfQ0xPU0VFWFBPTkVOVElBTFNIQURPV01BUH1zZXQgdXNlQ2xvc2VFeHBvbmVudGlhbFNoYWRvd01hcChlKXtjb25zdCB0PXRoaXMuX3ZhbGlkYXRlRmlsdGVyKEcuRklMVEVSX0NMT1NFRVhQT05FTlRJQUxTSEFET1dNQVApOyFlJiZ0aGlzLmZpbHRlciE9PUcuRklMVEVSX0NMT1NFRVhQT05FTlRJQUxTSEFET1dNQVB8fCh0aGlzLmZpbHRlcj1lP3Q6Ry5GSUxURVJfTk9ORSl9Z2V0IHVzZUJsdXJDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwKCl7cmV0dXJuIHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfQkxVUkNMT1NFRVhQT05FTlRJQUxTSEFET1dNQVB9c2V0IHVzZUJsdXJDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwKGUpe2NvbnN0IHQ9dGhpcy5fdmFsaWRhdGVGaWx0ZXIoRy5GSUxURVJfQkxVUkNMT1NFRVhQT05FTlRJQUxTSEFET1dNQVApOyFlJiZ0aGlzLmZpbHRlciE9PUcuRklMVEVSX0JMVVJDTE9TRUVYUE9ORU5USUFMU0hBRE9XTUFQfHwodGhpcy5maWx0ZXI9ZT90OkcuRklMVEVSX05PTkUpfWdldCB1c2VQZXJjZW50YWdlQ2xvc2VyRmlsdGVyaW5nKCl7cmV0dXJuIHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfUENGfXNldCB1c2VQZXJjZW50YWdlQ2xvc2VyRmlsdGVyaW5nKGUpe2NvbnN0IHQ9dGhpcy5fdmFsaWRhdGVGaWx0ZXIoRy5GSUxURVJfUENGKTshZSYmdGhpcy5maWx0ZXIhPT1HLkZJTFRFUl9QQ0Z8fCh0aGlzLmZpbHRlcj1lP3Q6Ry5GSUxURVJfTk9ORSl9Z2V0IGZpbHRlcmluZ1F1YWxpdHkoKXtyZXR1cm4gdGhpcy5fZmlsdGVyaW5nUXVhbGl0eX1zZXQgZmlsdGVyaW5nUXVhbGl0eShlKXt0aGlzLl9maWx0ZXJpbmdRdWFsaXR5IT09ZSYmKHRoaXMuX2ZpbHRlcmluZ1F1YWxpdHk9ZSx0aGlzLl9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKSx0aGlzLl9hcHBseUZpbHRlclZhbHVlcygpLHRoaXMuX2xpZ2h0Ll9tYXJrTWVzaGVzQXNMaWdodERpcnR5KCkpfWdldCB1c2VDb250YWN0SGFyZGVuaW5nU2hhZG93KCl7cmV0dXJuIHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfUENTU31zZXQgdXNlQ29udGFjdEhhcmRlbmluZ1NoYWRvdyhlKXtjb25zdCB0PXRoaXMuX3ZhbGlkYXRlRmlsdGVyKEcuRklMVEVSX1BDU1MpOyFlJiZ0aGlzLmZpbHRlciE9PUcuRklMVEVSX1BDU1N8fCh0aGlzLmZpbHRlcj1lP3Q6Ry5GSUxURVJfTk9ORSl9Z2V0IGNvbnRhY3RIYXJkZW5pbmdMaWdodFNpemVVVlJhdGlvKCl7cmV0dXJuIHRoaXMuX2NvbnRhY3RIYXJkZW5pbmdMaWdodFNpemVVVlJhdGlvfXNldCBjb250YWN0SGFyZGVuaW5nTGlnaHRTaXplVVZSYXRpbyhlKXt0aGlzLl9jb250YWN0SGFyZGVuaW5nTGlnaHRTaXplVVZSYXRpbz1lfWdldCBkYXJrbmVzcygpe3JldHVybiB0aGlzLl9kYXJrbmVzc31zZXQgZGFya25lc3MoZSl7dGhpcy5zZXREYXJrbmVzcyhlKX1nZXREYXJrbmVzcygpe3JldHVybiB0aGlzLl9kYXJrbmVzc31zZXREYXJrbmVzcyhlKXtyZXR1cm4gZT49MT90aGlzLl9kYXJrbmVzcz0xOmU8PTA/dGhpcy5fZGFya25lc3M9MDp0aGlzLl9kYXJrbmVzcz1lLHRoaXN9Z2V0IHRyYW5zcGFyZW5jeVNoYWRvdygpe3JldHVybiB0aGlzLl90cmFuc3BhcmVuY3lTaGFkb3d9c2V0IHRyYW5zcGFyZW5jeVNoYWRvdyhlKXt0aGlzLnNldFRyYW5zcGFyZW5jeVNoYWRvdyhlKX1zZXRUcmFuc3BhcmVuY3lTaGFkb3coZSl7cmV0dXJuIHRoaXMuX3RyYW5zcGFyZW5jeVNoYWRvdz1lLHRoaXN9Z2V0U2hhZG93TWFwKCl7cmV0dXJuIHRoaXMuX3NoYWRvd01hcH1nZXRTaGFkb3dNYXBGb3JSZW5kZXJpbmcoKXtyZXR1cm4gdGhpcy5fc2hhZG93TWFwMj90aGlzLl9zaGFkb3dNYXAyOnRoaXMuX3NoYWRvd01hcH1nZXRDbGFzc05hbWUoKXtyZXR1cm4gRy5DTEFTU05BTUV9YWRkU2hhZG93Q2FzdGVyKGUsdD0hMCl7aWYoIXRoaXMuX3NoYWRvd01hcClyZXR1cm4gdGhpcztpZih0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdHx8KHRoaXMuX3NoYWRvd01hcC5yZW5kZXJMaXN0PVtdKSx0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdC5pbmRleE9mKGUpPT09LTEmJnRoaXMuX3NoYWRvd01hcC5yZW5kZXJMaXN0LnB1c2goZSksdClmb3IoY29uc3QgaSBvZiBlLmdldENoaWxkTWVzaGVzKCkpdGhpcy5fc2hhZG93TWFwLnJlbmRlckxpc3QuaW5kZXhPZihpKT09PS0xJiZ0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdC5wdXNoKGkpO3JldHVybiB0aGlzfXJlbW92ZVNoYWRvd0Nhc3RlcihlLHQ9ITApe2lmKCF0aGlzLl9zaGFkb3dNYXB8fCF0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdClyZXR1cm4gdGhpcztjb25zdCBpPXRoaXMuX3NoYWRvd01hcC5yZW5kZXJMaXN0LmluZGV4T2YoZSk7aWYoaSE9PS0xJiZ0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdC5zcGxpY2UoaSwxKSx0KWZvcihjb25zdCBzIG9mIGUuZ2V0Q2hpbGRyZW4oKSl0aGlzLnJlbW92ZVNoYWRvd0Nhc3RlcihzKTtyZXR1cm4gdGhpc31nZXRMaWdodCgpe3JldHVybiB0aGlzLl9saWdodH1fZ2V0Q2FtZXJhKCl7dmFyIGU7cmV0dXJuKGU9dGhpcy5fY2FtZXJhKSE9PW51bGwmJmUhPT12b2lkIDA/ZTp0aGlzLl9zY2VuZS5hY3RpdmVDYW1lcmF9Z2V0IG1hcFNpemUoKXtyZXR1cm4gdGhpcy5fbWFwU2l6ZX1zZXQgbWFwU2l6ZShlKXt0aGlzLl9tYXBTaXplPWUsdGhpcy5fbGlnaHQuX21hcmtNZXNoZXNBc0xpZ2h0RGlydHkoKSx0aGlzLnJlY3JlYXRlU2hhZG93TWFwKCl9X2luaXRpYWxpemVHZW5lcmF0b3IoKXt0aGlzLl9saWdodC5fbWFya01lc2hlc0FzTGlnaHREaXJ0eSgpLHRoaXMuX2luaXRpYWxpemVTaGFkb3dNYXAoKX1fY3JlYXRlVGFyZ2V0UmVuZGVyVGV4dHVyZSgpe2NvbnN0IGU9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7ZS5fZmVhdHVyZXMuc3VwcG9ydERlcHRoU3RlbmNpbFRleHR1cmU/KHRoaXMuX3NoYWRvd01hcD1uZXcgX3QodGhpcy5fbGlnaHQubmFtZSsiX3NoYWRvd01hcCIsdGhpcy5fbWFwU2l6ZSx0aGlzLl9zY2VuZSwhMSwhMCx0aGlzLl90ZXh0dXJlVHlwZSx0aGlzLl9saWdodC5uZWVkQ3ViZSgpLHZvaWQgMCwhMSwhMSksdGhpcy5fc2hhZG93TWFwLmNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmUoZS51c2VSZXZlcnNlRGVwdGhCdWZmZXI/NTE2OjUxMywhMCkpOnRoaXMuX3NoYWRvd01hcD1uZXcgX3QodGhpcy5fbGlnaHQubmFtZSsiX3NoYWRvd01hcCIsdGhpcy5fbWFwU2l6ZSx0aGlzLl9zY2VuZSwhMSwhMCx0aGlzLl90ZXh0dXJlVHlwZSx0aGlzLl9saWdodC5uZWVkQ3ViZSgpKX1faW5pdGlhbGl6ZVNoYWRvd01hcCgpe2lmKHRoaXMuX2NyZWF0ZVRhcmdldFJlbmRlclRleHR1cmUoKSx0aGlzLl9zaGFkb3dNYXA9PT1udWxsKXJldHVybjt0aGlzLl9zaGFkb3dNYXAud3JhcFU9Ti5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9zaGFkb3dNYXAud3JhcFY9Ti5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9zaGFkb3dNYXAuYW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbD0xLHRoaXMuX3NoYWRvd01hcC51cGRhdGVTYW1wbGluZ01vZGUoTi5CSUxJTkVBUl9TQU1QTElOR01PREUpLHRoaXMuX3NoYWRvd01hcC5yZW5kZXJQYXJ0aWNsZXM9ITEsdGhpcy5fc2hhZG93TWFwLmlnbm9yZUNhbWVyYVZpZXdwb3J0PSEwLHRoaXMuX3N0b3JlZFVuaXF1ZUlkJiYodGhpcy5fc2hhZG93TWFwLnVuaXF1ZUlkPXRoaXMuX3N0b3JlZFVuaXF1ZUlkKSx0aGlzLl9zaGFkb3dNYXAuY3VzdG9tUmVuZGVyRnVuY3Rpb249dGhpcy5fcmVuZGVyRm9yU2hhZG93TWFwLmJpbmQodGhpcyksdGhpcy5fc2hhZG93TWFwLmN1c3RvbUlzUmVhZHlGdW5jdGlvbj0oKT0+ITA7Y29uc3QgZT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKTt0aGlzLl9zaGFkb3dNYXAub25CZWZvcmVCaW5kT2JzZXJ2YWJsZS5hZGQoKCk9Pnt2YXIgczt0aGlzLl9jdXJyZW50U2NlbmVVQk89dGhpcy5fc2NlbmUuZ2V0U2NlbmVVbmlmb3JtQnVmZmVyKCksKHM9ZS5fZGVidWdQdXNoR3JvdXApPT09bnVsbHx8cz09PXZvaWQgMHx8cy5jYWxsKGUsYHNoYWRvdyBtYXAgZ2VuZXJhdGlvbiBmb3IgcGFzcyBpZCAke2UuY3VycmVudFJlbmRlclBhc3NJZH1gLDEpfSksdGhpcy5fc2hhZG93TWFwLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5hZGQocz0+e3RoaXMuX3NjZW5lVUJPcyYmdGhpcy5fc2NlbmUuc2V0U2NlbmVVbmlmb3JtQnVmZmVyKHRoaXMuX3NjZW5lVUJPc1swXSksdGhpcy5fY3VycmVudEZhY2VJbmRleD1zLHRoaXMuX2ZpbHRlcj09PUcuRklMVEVSX1BDRiYmZS5zZXRDb2xvcldyaXRlKCExKSx0aGlzLmdldFRyYW5zZm9ybU1hdHJpeCgpLHRoaXMuX3NjZW5lLnNldFRyYW5zZm9ybU1hdHJpeCh0aGlzLl92aWV3TWF0cml4LHRoaXMuX3Byb2plY3Rpb25NYXRyaXgpLHRoaXMuX3VzZVVCTyYmKHRoaXMuX3NjZW5lLmdldFNjZW5lVW5pZm9ybUJ1ZmZlcigpLnVuYmluZEVmZmVjdCgpLHRoaXMuX3NjZW5lLmZpbmFsaXplU2NlbmVVYm8oKSl9KSx0aGlzLl9zaGFkb3dNYXAub25BZnRlclVuYmluZE9ic2VydmFibGUuYWRkKCgpPT57dmFyIHMscjtpZih0aGlzLl9zY2VuZVVCT3MmJnRoaXMuX3NjZW5lLnNldFNjZW5lVW5pZm9ybUJ1ZmZlcih0aGlzLl9jdXJyZW50U2NlbmVVQk8pLHRoaXMuX3NjZW5lLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCgpLHRoaXMuX2ZpbHRlcj09PUcuRklMVEVSX1BDRiYmZS5zZXRDb2xvcldyaXRlKCEwKSwhdGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXAmJiF0aGlzLnVzZUJsdXJDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwKXsocz1lLl9kZWJ1Z1BvcEdyb3VwKT09PW51bGx8fHM9PT12b2lkIDB8fHMuY2FsbChlLDEpO3JldHVybn1jb25zdCBuPXRoaXMuZ2V0U2hhZG93TWFwRm9yUmVuZGVyaW5nKCk7biYmKHRoaXMuX3NjZW5lLnBvc3RQcm9jZXNzTWFuYWdlci5kaXJlY3RSZW5kZXIodGhpcy5fYmx1clBvc3RQcm9jZXNzZXMsbi5yZW5kZXJUYXJnZXQsITApLGUudW5CaW5kRnJhbWVidWZmZXIobi5yZW5kZXJUYXJnZXQsITApLChyPWUuX2RlYnVnUG9wR3JvdXApPT09bnVsbHx8cj09PXZvaWQgMHx8ci5jYWxsKGUsMSkpfSk7Y29uc3QgdD1uZXcgbWUoMCwwLDAsMCksaT1uZXcgbWUoMSwxLDEsMSk7dGhpcy5fc2hhZG93TWFwLm9uQ2xlYXJPYnNlcnZhYmxlLmFkZChzPT57dGhpcy5fZmlsdGVyPT09Ry5GSUxURVJfUENGP3MuY2xlYXIoaSwhMSwhMCwhMSk6dGhpcy51c2VFeHBvbmVudGlhbFNoYWRvd01hcHx8dGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXA/cy5jbGVhcih0LCEwLCEwLCExKTpzLmNsZWFyKGksITAsITAsITEpfSksdGhpcy5fc2hhZG93TWFwLm9uUmVzaXplT2JzZXJ2YWJsZS5hZGQocz0+e3RoaXMuX3N0b3JlZFVuaXF1ZUlkPXRoaXMuX3NoYWRvd01hcC51bmlxdWVJZCx0aGlzLl9tYXBTaXplPXMuZ2V0UmVuZGVyU2l6ZSgpLHRoaXMuX2xpZ2h0Ll9tYXJrTWVzaGVzQXNMaWdodERpcnR5KCksdGhpcy5yZWNyZWF0ZVNoYWRvd01hcCgpfSk7Zm9yKGxldCBzPVdlLk1JTl9SRU5ERVJJTkdHUk9VUFM7czxXZS5NQVhfUkVOREVSSU5HR1JPVVBTO3MrKyl0aGlzLl9zaGFkb3dNYXAuc2V0UmVuZGVyaW5nQXV0b0NsZWFyRGVwdGhTdGVuY2lsKHMsITEpfV9pbml0aWFsaXplQmx1clJUVEFuZFBvc3RQcm9jZXNzZXMoKXtjb25zdCBlPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLHQ9dGhpcy5fbWFwU2l6ZS90aGlzLmJsdXJTY2FsZTsoIXRoaXMudXNlS2VybmVsQmx1cnx8dGhpcy5ibHVyU2NhbGUhPT0xKSYmKHRoaXMuX3NoYWRvd01hcDI9bmV3IF90KHRoaXMuX2xpZ2h0Lm5hbWUrIl9zaGFkb3dNYXAyIix0LHRoaXMuX3NjZW5lLCExLCEwLHRoaXMuX3RleHR1cmVUeXBlLHZvaWQgMCx2b2lkIDAsITEpLHRoaXMuX3NoYWRvd01hcDIud3JhcFU9Ti5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9zaGFkb3dNYXAyLndyYXBWPU4uQ0xBTVBfQUREUkVTU01PREUsdGhpcy5fc2hhZG93TWFwMi51cGRhdGVTYW1wbGluZ01vZGUoTi5CSUxJTkVBUl9TQU1QTElOR01PREUpKSx0aGlzLnVzZUtlcm5lbEJsdXI/KHRoaXMuX2tlcm5lbEJsdXJYUG9zdHByb2Nlc3M9bmV3IEp0KHRoaXMuX2xpZ2h0Lm5hbWUrIktlcm5lbEJsdXJYIixuZXcgdmUoMSwwKSx0aGlzLmJsdXJLZXJuZWwsMSxudWxsLE4uQklMSU5FQVJfU0FNUExJTkdNT0RFLGUsITEsdGhpcy5fdGV4dHVyZVR5cGUpLHRoaXMuX2tlcm5lbEJsdXJYUG9zdHByb2Nlc3Mud2lkdGg9dCx0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzLmhlaWdodD10LHRoaXMuX2tlcm5lbEJsdXJYUG9zdHByb2Nlc3MuZXh0ZXJuYWxUZXh0dXJlU2FtcGxlckJpbmRpbmc9ITAsdGhpcy5fa2VybmVsQmx1clhQb3N0cHJvY2Vzcy5vbkFwcGx5T2JzZXJ2YWJsZS5hZGQoaT0+e2kuc2V0VGV4dHVyZSgidGV4dHVyZVNhbXBsZXIiLHRoaXMuX3NoYWRvd01hcCl9KSx0aGlzLl9rZXJuZWxCbHVyWVBvc3Rwcm9jZXNzPW5ldyBKdCh0aGlzLl9saWdodC5uYW1lKyJLZXJuZWxCbHVyWSIsbmV3IHZlKDAsMSksdGhpcy5ibHVyS2VybmVsLDEsbnVsbCxOLkJJTElORUFSX1NBTVBMSU5HTU9ERSxlLCExLHRoaXMuX3RleHR1cmVUeXBlKSx0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzLmF1dG9DbGVhcj0hMSx0aGlzLl9rZXJuZWxCbHVyWVBvc3Rwcm9jZXNzLmF1dG9DbGVhcj0hMSx0aGlzLl90ZXh0dXJlVHlwZT09PTAmJih0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzLnBhY2tlZEZsb2F0PSEwLHRoaXMuX2tlcm5lbEJsdXJZUG9zdHByb2Nlc3MucGFja2VkRmxvYXQ9ITApLHRoaXMuX2JsdXJQb3N0UHJvY2Vzc2VzPVt0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzLHRoaXMuX2tlcm5lbEJsdXJZUG9zdHByb2Nlc3NdKToodGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzPW5ldyBNZSh0aGlzLl9saWdodC5uYW1lKyJEZXB0aEJveEJsdXIiLCJkZXB0aEJveEJsdXIiLFsic2NyZWVuU2l6ZSIsImJveE9mZnNldCJdLFtdLDEsbnVsbCxOLkJJTElORUFSX1NBTVBMSU5HTU9ERSxlLCExLCIjZGVmaW5lIE9GRlNFVCAiK3RoaXMuX2JsdXJCb3hPZmZzZXQsdGhpcy5fdGV4dHVyZVR5cGUpLHRoaXMuX2JveEJsdXJQb3N0cHJvY2Vzcy5leHRlcm5hbFRleHR1cmVTYW1wbGVyQmluZGluZz0hMCx0aGlzLl9ib3hCbHVyUG9zdHByb2Nlc3Mub25BcHBseU9ic2VydmFibGUuYWRkKGk9PntpLnNldEZsb2F0Migic2NyZWVuU2l6ZSIsdCx0KSxpLnNldFRleHR1cmUoInRleHR1cmVTYW1wbGVyIix0aGlzLl9zaGFkb3dNYXApfSksdGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzLmF1dG9DbGVhcj0hMSx0aGlzLl9ibHVyUG9zdFByb2Nlc3Nlcz1bdGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzXSl9X3JlbmRlckZvclNoYWRvd01hcChlLHQsaSxzKXtsZXQgcjtpZihzLmxlbmd0aClmb3Iocj0wO3I8cy5sZW5ndGg7cisrKXRoaXMuX3JlbmRlclN1Yk1lc2hGb3JTaGFkb3dNYXAocy5kYXRhW3JdKTtmb3Iocj0wO3I8ZS5sZW5ndGg7cisrKXRoaXMuX3JlbmRlclN1Yk1lc2hGb3JTaGFkb3dNYXAoZS5kYXRhW3JdKTtmb3Iocj0wO3I8dC5sZW5ndGg7cisrKXRoaXMuX3JlbmRlclN1Yk1lc2hGb3JTaGFkb3dNYXAodC5kYXRhW3JdKTtpZih0aGlzLl90cmFuc3BhcmVuY3lTaGFkb3cpZm9yKHI9MDtyPGkubGVuZ3RoO3IrKyl0aGlzLl9yZW5kZXJTdWJNZXNoRm9yU2hhZG93TWFwKGkuZGF0YVtyXSwhMCk7ZWxzZSBmb3Iocj0wO3I8aS5sZW5ndGg7cisrKWkuZGF0YVtyXS5nZXRFZmZlY3RpdmVNZXNoKCkuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2lzQWN0aXZlSW50ZXJtZWRpYXRlPSExfV9iaW5kQ3VzdG9tRWZmZWN0Rm9yUmVuZGVyU3ViTWVzaEZvclNoYWRvd01hcChlLHQsaSl7dC5zZXRNYXRyaXgoInZpZXdQcm9qZWN0aW9uIix0aGlzLmdldFRyYW5zZm9ybU1hdHJpeCgpKX1fcmVuZGVyU3ViTWVzaEZvclNoYWRvd01hcChlLHQ9ITEpe3ZhciBpLHM7Y29uc3Qgcj1lLmdldFJlbmRlcmluZ01lc2goKSxuPWUuZ2V0RWZmZWN0aXZlTWVzaCgpLGE9dGhpcy5fc2NlbmUsbz1hLmdldEVuZ2luZSgpLGg9ZS5nZXRNYXRlcmlhbCgpO2lmKG4uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2lzQWN0aXZlSW50ZXJtZWRpYXRlPSExLCFofHxlLnZlcnRpY2VzQ291bnQ9PT0wfHxlLl9yZW5kZXJJZD09PWEuZ2V0UmVuZGVySWQoKSlyZXR1cm47Y29uc3QgbD1uLl9nZXRXb3JsZE1hdHJpeERldGVybWluYW50KCk8MDtsZXQgdT0oaT1yLm92ZXJyaWRlTWF0ZXJpYWxTaWRlT3JpZW50YXRpb24pIT09bnVsbCYmaSE9PXZvaWQgMD9pOmguc2lkZU9yaWVudGF0aW9uO2wmJih1PXU9PT0wPzE6MCk7Y29uc3QgZD11PT09MDtvLnNldFN0YXRlKGguYmFja0ZhY2VDdWxsaW5nLHZvaWQgMCx2b2lkIDAsZCxoLmN1bGxCYWNrRmFjZXMpO2NvbnN0IGY9ci5fZ2V0SW5zdGFuY2VzUmVuZGVyTGlzdChlLl9pZCwhIWUuZ2V0UmVwbGFjZW1lbnRNZXNoKCkpO2lmKGYubXVzdFJldHVybilyZXR1cm47Y29uc3QgXz1vLmdldENhcHMoKS5pbnN0YW5jZWRBcnJheXMmJihmLnZpc2libGVJbnN0YW5jZXNbZS5faWRdIT09bnVsbCYmZi52aXNpYmxlSW5zdGFuY2VzW2UuX2lkXSE9PXZvaWQgMHx8ci5oYXNUaGluSW5zdGFuY2VzKTtpZighKHRoaXMuY3VzdG9tQWxsb3dSZW5kZXJpbmcmJiF0aGlzLmN1c3RvbUFsbG93UmVuZGVyaW5nKGUpKSlpZih0aGlzLmlzUmVhZHkoZSxfLHQpKXtlLl9yZW5kZXJJZD1hLmdldFJlbmRlcklkKCk7Y29uc3QgRT1oLnNoYWRvd0RlcHRoV3JhcHBlcixtPShzPUU9PW51bGw/dm9pZCAwOkUuZ2V0RWZmZWN0KGUsdGhpcyxvLmN1cnJlbnRSZW5kZXJQYXNzSWQpKSE9PW51bGwmJnMhPT12b2lkIDA/czplLl9nZXREcmF3V3JhcHBlcigpLHY9bWkuR2V0RWZmZWN0KG0pO28uZW5hYmxlRWZmZWN0KG0pLF98fHIuX2JpbmQoZSx2LGguZmlsbE1vZGUpLHRoaXMuZ2V0VHJhbnNmb3JtTWF0cml4KCksdi5zZXRGbG9hdDMoImJpYXNBbmRTY2FsZVNNIix0aGlzLmJpYXMsdGhpcy5ub3JtYWxCaWFzLHRoaXMuZGVwdGhTY2FsZSksdGhpcy5nZXRMaWdodCgpLmdldFR5cGVJRCgpPT09aGUuTElHSFRUWVBFSURfRElSRUNUSU9OQUxMSUdIVD92LnNldFZlY3RvcjMoImxpZ2h0RGF0YVNNIix0aGlzLl9jYWNoZWREaXJlY3Rpb24pOnYuc2V0VmVjdG9yMygibGlnaHREYXRhU00iLHRoaXMuX2NhY2hlZFBvc2l0aW9uKTtjb25zdCBTPXRoaXMuX2dldENhbWVyYSgpO2lmKFMmJnYuc2V0RmxvYXQyKCJkZXB0aFZhbHVlc1NNIix0aGlzLmdldExpZ2h0KCkuZ2V0RGVwdGhNaW5aKFMpLHRoaXMuZ2V0TGlnaHQoKS5nZXREZXB0aE1pblooUykrdGhpcy5nZXRMaWdodCgpLmdldERlcHRoTWF4WihTKSksdCYmdGhpcy5lbmFibGVTb2Z0VHJhbnNwYXJlbnRTaGFkb3cmJnYuc2V0RmxvYXQoInNvZnRUcmFuc3BhcmVudFNoYWRvd1NNIixuLnZpc2liaWxpdHkqaC5hbHBoYSksRSllLl9zZXRNYWluRHJhd1dyYXBwZXJPdmVycmlkZShtKSxFLnN0YW5kYWxvbmU/RS5iYXNlTWF0ZXJpYWwuYmluZEZvclN1Yk1lc2gobi5nZXRXb3JsZE1hdHJpeCgpLHIsZSk6aC5iaW5kRm9yU3ViTWVzaChuLmdldFdvcmxkTWF0cml4KCkscixlKSxlLl9zZXRNYWluRHJhd1dyYXBwZXJPdmVycmlkZShudWxsKTtlbHNle2lmKHRoaXMudXNlT3BhY2l0eVRleHR1cmVGb3JUcmFuc3BhcmVudFNoYWRvdyl7Y29uc3QgQT1oLm9wYWNpdHlUZXh0dXJlO0EmJih2LnNldFRleHR1cmUoImRpZmZ1c2VTYW1wbGVyIixBKSx2LnNldE1hdHJpeCgiZGlmZnVzZU1hdHJpeCIsQS5nZXRUZXh0dXJlTWF0cml4KCl8fHRoaXMuX2RlZmF1bHRUZXh0dXJlTWF0cml4KSl9ZWxzZSBpZihoLm5lZWRBbHBoYVRlc3RpbmcoKXx8aC5uZWVkQWxwaGFCbGVuZGluZygpKXtjb25zdCBBPWguZ2V0QWxwaGFUZXN0VGV4dHVyZSgpO0EmJih2LnNldFRleHR1cmUoImRpZmZ1c2VTYW1wbGVyIixBKSx2LnNldE1hdHJpeCgiZGlmZnVzZU1hdHJpeCIsQS5nZXRUZXh0dXJlTWF0cml4KCl8fHRoaXMuX2RlZmF1bHRUZXh0dXJlTWF0cml4KSl9aWYoci51c2VCb25lcyYmci5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJnIuc2tlbGV0b24pe2NvbnN0IEE9ci5za2VsZXRvbjtpZihBLmlzVXNpbmdUZXh0dXJlRm9yTWF0cmljZXMpe2NvbnN0IEM9QS5nZXRUcmFuc2Zvcm1NYXRyaXhUZXh0dXJlKHIpO2lmKCFDKXJldHVybjt2LnNldFRleHR1cmUoImJvbmVTYW1wbGVyIixDKSx2LnNldEZsb2F0KCJib25lVGV4dHVyZVdpZHRoIiw0KihBLmJvbmVzLmxlbmd0aCsxKSl9ZWxzZSB2LnNldE1hdHJpY2VzKCJtQm9uZXMiLEEuZ2V0VHJhbnNmb3JtTWF0cmljZXMocikpfWllLkJpbmRNb3JwaFRhcmdldFBhcmFtZXRlcnMocix2KSxyLm1vcnBoVGFyZ2V0TWFuYWdlciYmci5tb3JwaFRhcmdldE1hbmFnZXIuaXNVc2luZ1RleHR1cmVGb3JUYXJnZXRzJiZyLm1vcnBoVGFyZ2V0TWFuYWdlci5fYmluZCh2KSxycyh2LGgsYSl9IXRoaXMuX3VzZVVCTyYmIUUmJnRoaXMuX2JpbmRDdXN0b21FZmZlY3RGb3JSZW5kZXJTdWJNZXNoRm9yU2hhZG93TWFwKGUsdixuKSxpZS5CaW5kU2NlbmVVbmlmb3JtQnVmZmVyKHYsdGhpcy5fc2NlbmUuZ2V0U2NlbmVVbmlmb3JtQnVmZmVyKCkpLHRoaXMuX3NjZW5lLmdldFNjZW5lVW5pZm9ybUJ1ZmZlcigpLmJpbmRVbmlmb3JtQnVmZmVyKCk7Y29uc3QgeT1uLmdldFdvcmxkTWF0cml4KCk7XyYmKG4uZ2V0TWVzaFVuaWZvcm1CdWZmZXIoKS5iaW5kVG9FZmZlY3QodiwiTWVzaCIpLG4udHJhbnNmZXJUb0VmZmVjdCh5KSksdGhpcy5mb3JjZUJhY2tGYWNlc09ubHkmJm8uc2V0U3RhdGUoITAsMCwhMSwhMCxoLmN1bGxCYWNrRmFjZXMpLHRoaXMub25CZWZvcmVTaGFkb3dNYXBSZW5kZXJNZXNoT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMociksdGhpcy5vbkJlZm9yZVNoYWRvd01hcFJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHYpLHIuX3Byb2Nlc3NSZW5kZXJpbmcobixlLHYsaC5maWxsTW9kZSxmLF8sKEEsQyk9PntuIT09ciYmIUE/KHIuZ2V0TWVzaFVuaWZvcm1CdWZmZXIoKS5iaW5kVG9FZmZlY3QodiwiTWVzaCIpLHIudHJhbnNmZXJUb0VmZmVjdChDKSk6KG4uZ2V0TWVzaFVuaWZvcm1CdWZmZXIoKS5iaW5kVG9FZmZlY3QodiwiTWVzaCIpLG4udHJhbnNmZXJUb0VmZmVjdChBP0M6eSkpfSksdGhpcy5mb3JjZUJhY2tGYWNlc09ubHkmJm8uc2V0U3RhdGUoITAsMCwhMSwhMSxoLmN1bGxCYWNrRmFjZXMpLHRoaXMub25BZnRlclNoYWRvd01hcFJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHYpLHRoaXMub25BZnRlclNoYWRvd01hcFJlbmRlck1lc2hPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhyKX1lbHNlIHRoaXMuX3NoYWRvd01hcCYmdGhpcy5fc2hhZG93TWFwLnJlc2V0UmVmcmVzaENvdW50ZXIoKX1fYXBwbHlGaWx0ZXJWYWx1ZXMoKXt0aGlzLl9zaGFkb3dNYXAmJih0aGlzLmZpbHRlcj09PUcuRklMVEVSX05PTkV8fHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfUENTUz90aGlzLl9zaGFkb3dNYXAudXBkYXRlU2FtcGxpbmdNb2RlKE4uTkVBUkVTVF9TQU1QTElOR01PREUpOnRoaXMuX3NoYWRvd01hcC51cGRhdGVTYW1wbGluZ01vZGUoTi5CSUxJTkVBUl9TQU1QTElOR01PREUpKX1mb3JjZUNvbXBpbGF0aW9uKGUsdCl7Y29uc3QgaT17dXNlSW5zdGFuY2VzOiExLC4uLnR9LHM9dGhpcy5nZXRTaGFkb3dNYXAoKTtpZighcyl7ZSYmZSh0aGlzKTtyZXR1cm59Y29uc3Qgcj1zLnJlbmRlckxpc3Q7aWYoIXIpe2UmJmUodGhpcyk7cmV0dXJufWNvbnN0IG49bmV3IEFycmF5O2Zvcihjb25zdCBoIG9mIHIpbi5wdXNoKC4uLmguc3ViTWVzaGVzKTtpZihuLmxlbmd0aD09PTApe2UmJmUodGhpcyk7cmV0dXJufWxldCBhPTA7Y29uc3Qgbz0oKT0+e3ZhciBoLGw7aWYoISghdGhpcy5fc2NlbmV8fCF0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSkpe2Zvcig7dGhpcy5pc1JlYWR5KG5bYV0saS51c2VJbnN0YW5jZXMsKGw9KGg9blthXS5nZXRNYXRlcmlhbCgpKT09PW51bGx8fGg9PT12b2lkIDA/dm9pZCAwOmgubmVlZEFscGhhQmxlbmRpbmdGb3JNZXNoKG5bYV0uZ2V0TWVzaCgpKSkhPT1udWxsJiZsIT09dm9pZCAwP2w6ITEpOylpZihhKyssYT49bi5sZW5ndGgpe2UmJmUodGhpcyk7cmV0dXJufXNldFRpbWVvdXQobywxNil9fTtvKCl9Zm9yY2VDb21waWxhdGlvbkFzeW5jKGUpe3JldHVybiBuZXcgUHJvbWlzZSh0PT57dGhpcy5mb3JjZUNvbXBpbGF0aW9uKCgpPT57dCgpfSxlKX0pfV9pc1JlYWR5Q3VzdG9tRGVmaW5lcyhlLHQsaSl7fV9wcmVwYXJlU2hhZG93RGVmaW5lcyhlLHQsaSxzKXtpLnB1c2goIiNkZWZpbmUgU01fTElHSFRUWVBFXyIrdGhpcy5fbGlnaHQuZ2V0Q2xhc3NOYW1lKCkudG9VcHBlckNhc2UoKSksaS5wdXNoKCIjZGVmaW5lIFNNX0ZMT0FUICIrKHRoaXMuX3RleHR1cmVUeXBlIT09MD8iMSI6IjAiKSksaS5wdXNoKCIjZGVmaW5lIFNNX0VTTSAiKyh0aGlzLnVzZUV4cG9uZW50aWFsU2hhZG93TWFwfHx0aGlzLnVzZUJsdXJFeHBvbmVudGlhbFNoYWRvd01hcD8iMSI6IjAiKSksaS5wdXNoKCIjZGVmaW5lIFNNX0RFUFRIVEVYVFVSRSAiKyh0aGlzLnVzZVBlcmNlbnRhZ2VDbG9zZXJGaWx0ZXJpbmd8fHRoaXMudXNlQ29udGFjdEhhcmRlbmluZ1NoYWRvdz8iMSI6IjAiKSk7Y29uc3Qgcj1lLmdldE1lc2goKTtyZXR1cm4gaS5wdXNoKCIjZGVmaW5lIFNNX05PUk1BTEJJQVMgIisodGhpcy5ub3JtYWxCaWFzJiZyLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk5vcm1hbEtpbmQpPyIxIjoiMCIpKSxpLnB1c2goIiNkZWZpbmUgU01fRElSRUNUSU9OSU5MSUdIVERBVEEgIisodGhpcy5nZXRMaWdodCgpLmdldFR5cGVJRCgpPT09aGUuTElHSFRUWVBFSURfRElSRUNUSU9OQUxMSUdIVD8iMSI6IjAiKSksaS5wdXNoKCIjZGVmaW5lIFNNX1VTRURJU1RBTkNFICIrKHRoaXMuX2xpZ2h0Lm5lZWRDdWJlKCk/IjEiOiIwIikpLGkucHVzaCgiI2RlZmluZSBTTV9TT0ZUVFJBTlNQQVJFTlRTSEFET1cgIisodGhpcy5lbmFibGVTb2Z0VHJhbnNwYXJlbnRTaGFkb3cmJnM/IjEiOiIwIikpLHRoaXMuX2lzUmVhZHlDdXN0b21EZWZpbmVzKGksZSx0KSxpfWlzUmVhZHkoZSx0LGkpe3ZhciBzO2NvbnN0IHI9ZS5nZXRNYXRlcmlhbCgpLG49cj09bnVsbD92b2lkIDA6ci5zaGFkb3dEZXB0aFdyYXBwZXI7aWYoIXIpcmV0dXJuITE7Y29uc3QgYT1bXTtpZih0aGlzLl9wcmVwYXJlU2hhZG93RGVmaW5lcyhlLHQsYSxpKSxuKXtpZighbi5pc1JlYWR5Rm9yU3ViTWVzaChlLGEsdGhpcyx0LHRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLmN1cnJlbnRSZW5kZXJQYXNzSWQpKXJldHVybiExfWVsc2V7Y29uc3Qgbz1lLl9nZXREcmF3V3JhcHBlcih2b2lkIDAsITApO2xldCBoPW8uZWZmZWN0LGw9by5kZWZpbmVzO2NvbnN0IHU9W2cuUG9zaXRpb25LaW5kXSxkPWUuZ2V0TWVzaCgpO3RoaXMubm9ybWFsQmlhcyYmZC5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Ob3JtYWxLaW5kKSYmKHUucHVzaChnLk5vcm1hbEtpbmQpLGEucHVzaCgiI2RlZmluZSBOT1JNQUwiKSxkLm5vblVuaWZvcm1TY2FsaW5nJiZhLnB1c2goIiNkZWZpbmUgTk9OVU5JRk9STVNDQUxJTkciKSk7Y29uc3QgZj1yPT1udWxsP3ZvaWQgMDpyLm5lZWRBbHBoYVRlc3RpbmcoKSxfPXI9PW51bGw/dm9pZCAwOnIubmVlZEFscGhhQmxlbmRpbmcoKTtpZihyJiYoZnx8Xykpe2xldCB5PW51bGw7aWYodGhpcy51c2VPcGFjaXR5VGV4dHVyZUZvclRyYW5zcGFyZW50U2hhZG93P3k9ci5vcGFjaXR5VGV4dHVyZTp5PXIuZ2V0QWxwaGFUZXN0VGV4dHVyZSgpLHkpe2lmKCF5LmlzUmVhZHkoKSlyZXR1cm4hMTtjb25zdCBBPShzPXIuYWxwaGFDdXRPZmYpIT09bnVsbCYmcyE9PXZvaWQgMD9zOkcuREVGQVVMVF9BTFBIQV9DVVRPRkY7YS5wdXNoKCIjZGVmaW5lIEFMUEhBVEVYVFVSRSIpLGYmJmEucHVzaChgI2RlZmluZSBBTFBIQVRFU1RWQUxVRSAke0F9JHtBJTE9PT0wPyIuIjoiIn1gKSxkLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWS2luZCkmJih1LnB1c2goZy5VVktpbmQpLGEucHVzaCgiI2RlZmluZSBVVjEiKSksZC5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5VVjJLaW5kKSYmeS5jb29yZGluYXRlc0luZGV4PT09MSYmKHUucHVzaChnLlVWMktpbmQpLGEucHVzaCgiI2RlZmluZSBVVjIiKSl9fWNvbnN0IEU9bmV3IHpzO2lmKGQudXNlQm9uZXMmJmQuY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzJiZkLnNrZWxldG9uKXt1LnB1c2goZy5NYXRyaWNlc0luZGljZXNLaW5kKSx1LnB1c2goZy5NYXRyaWNlc1dlaWdodHNLaW5kKSxkLm51bUJvbmVJbmZsdWVuY2Vycz40JiYodS5wdXNoKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kKSx1LnB1c2goZy5NYXRyaWNlc1dlaWdodHNFeHRyYUtpbmQpKTtjb25zdCB5PWQuc2tlbGV0b247YS5wdXNoKCIjZGVmaW5lIE5VTV9CT05FX0lORkxVRU5DRVJTICIrZC5udW1Cb25lSW5mbHVlbmNlcnMpLGQubnVtQm9uZUluZmx1ZW5jZXJzPjAmJkUuYWRkQ1BVU2tpbm5pbmdGYWxsYmFjaygwLGQpLHkuaXNVc2luZ1RleHR1cmVGb3JNYXRyaWNlcz9hLnB1c2goIiNkZWZpbmUgQk9ORVRFWFRVUkUiKTphLnB1c2goIiNkZWZpbmUgQm9uZXNQZXJNZXNoICIrKHkuYm9uZXMubGVuZ3RoKzEpKX1lbHNlIGEucHVzaCgiI2RlZmluZSBOVU1fQk9ORV9JTkZMVUVOQ0VSUyAwIik7Y29uc3QgbT1kLm1vcnBoVGFyZ2V0TWFuYWdlcjtsZXQgdj0wO2lmKG0mJm0ubnVtSW5mbHVlbmNlcnM+MCYmKGEucHVzaCgiI2RlZmluZSBNT1JQSFRBUkdFVFMiKSx2PW0ubnVtSW5mbHVlbmNlcnMsYS5wdXNoKCIjZGVmaW5lIE5VTV9NT1JQSF9JTkZMVUVOQ0VSUyAiK3YpLG0uaXNVc2luZ1RleHR1cmVGb3JUYXJnZXRzJiZhLnB1c2goIiNkZWZpbmUgTU9SUEhUQVJHRVRTX1RFWFRVUkUiKSxpZS5QcmVwYXJlQXR0cmlidXRlc0Zvck1vcnBoVGFyZ2V0c0luZmx1ZW5jZXJzKHUsZCx2KSksT3Mocix0aGlzLl9zY2VuZSxhKSx0JiYoYS5wdXNoKCIjZGVmaW5lIElOU1RBTkNFUyIpLGllLlB1c2hBdHRyaWJ1dGVzRm9ySW5zdGFuY2VzKHUpLGUuZ2V0UmVuZGVyaW5nTWVzaCgpLmhhc1RoaW5JbnN0YW5jZXMmJmEucHVzaCgiI2RlZmluZSBUSElOX0lOU1RBTkNFUyIpKSx0aGlzLmN1c3RvbVNoYWRlck9wdGlvbnMmJnRoaXMuY3VzdG9tU2hhZGVyT3B0aW9ucy5kZWZpbmVzKWZvcihjb25zdCB5IG9mIHRoaXMuY3VzdG9tU2hhZGVyT3B0aW9ucy5kZWZpbmVzKWEuaW5kZXhPZih5KT09PS0xJiZhLnB1c2goeSk7Y29uc3QgUz1hLmpvaW4oYApgKTtpZihsIT09Uyl7bD1TO2xldCB5PSJzaGFkb3dNYXAiO2NvbnN0IEE9WyJ3b3JsZCIsIm1Cb25lcyIsInZpZXdQcm9qZWN0aW9uIiwiZGlmZnVzZU1hdHJpeCIsImxpZ2h0RGF0YVNNIiwiZGVwdGhWYWx1ZXNTTSIsImJpYXNBbmRTY2FsZVNNIiwibW9ycGhUYXJnZXRJbmZsdWVuY2VzIiwiYm9uZVRleHR1cmVXaWR0aCIsInNvZnRUcmFuc3BhcmVudFNoYWRvd1NNIiwibW9ycGhUYXJnZXRUZXh0dXJlSW5mbyIsIm1vcnBoVGFyZ2V0VGV4dHVyZUluZGljZXMiXSxDPVsiZGlmZnVzZVNhbXBsZXIiLCJib25lU2FtcGxlciIsIm1vcnBoVGFyZ2V0cyJdLGI9WyJTY2VuZSIsIk1lc2giXTtpZihzcyhBKSx0aGlzLmN1c3RvbVNoYWRlck9wdGlvbnMpe2lmKHk9dGhpcy5jdXN0b21TaGFkZXJPcHRpb25zLnNoYWRlck5hbWUsdGhpcy5jdXN0b21TaGFkZXJPcHRpb25zLmF0dHJpYnV0ZXMpZm9yKGNvbnN0IEwgb2YgdGhpcy5jdXN0b21TaGFkZXJPcHRpb25zLmF0dHJpYnV0ZXMpdS5pbmRleE9mKEwpPT09LTEmJnUucHVzaChMKTtpZih0aGlzLmN1c3RvbVNoYWRlck9wdGlvbnMudW5pZm9ybXMpZm9yKGNvbnN0IEwgb2YgdGhpcy5jdXN0b21TaGFkZXJPcHRpb25zLnVuaWZvcm1zKUEuaW5kZXhPZihMKT09PS0xJiZBLnB1c2goTCk7aWYodGhpcy5jdXN0b21TaGFkZXJPcHRpb25zLnNhbXBsZXJzKWZvcihjb25zdCBMIG9mIHRoaXMuY3VzdG9tU2hhZGVyT3B0aW9ucy5zYW1wbGVycylDLmluZGV4T2YoTCk9PT0tMSYmQy5wdXNoKEwpfWNvbnN0IE09dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7aD1NLmNyZWF0ZUVmZmVjdCh5LHthdHRyaWJ1dGVzOnUsdW5pZm9ybXNOYW1lczpBLHVuaWZvcm1CdWZmZXJzTmFtZXM6YixzYW1wbGVyczpDLGRlZmluZXM6UyxmYWxsYmFja3M6RSxvbkNvbXBpbGVkOm51bGwsb25FcnJvcjpudWxsLGluZGV4UGFyYW1ldGVyczp7bWF4U2ltdWx0YW5lb3VzTW9ycGhUYXJnZXRzOnZ9fSxNKSxvLnNldEVmZmVjdChoLGwpfWlmKCFoLmlzUmVhZHkoKSlyZXR1cm4hMX1yZXR1cm4odGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXB8fHRoaXMudXNlQmx1ckNsb3NlRXhwb25lbnRpYWxTaGFkb3dNYXApJiYoIXRoaXMuX2JsdXJQb3N0UHJvY2Vzc2VzfHwhdGhpcy5fYmx1clBvc3RQcm9jZXNzZXMubGVuZ3RoKSYmdGhpcy5faW5pdGlhbGl6ZUJsdXJSVFRBbmRQb3N0UHJvY2Vzc2VzKCksISh0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzJiYhdGhpcy5fa2VybmVsQmx1clhQb3N0cHJvY2Vzcy5pc1JlYWR5KCl8fHRoaXMuX2tlcm5lbEJsdXJZUG9zdHByb2Nlc3MmJiF0aGlzLl9rZXJuZWxCbHVyWVBvc3Rwcm9jZXNzLmlzUmVhZHkoKXx8dGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzJiYhdGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzLmlzUmVhZHkoKSl9cHJlcGFyZURlZmluZXMoZSx0KXtjb25zdCBpPXRoaXMuX3NjZW5lLHM9dGhpcy5fbGlnaHQ7IWkuc2hhZG93c0VuYWJsZWR8fCFzLnNoYWRvd0VuYWJsZWR8fChlWyJTSEFET1ciK3RdPSEwLHRoaXMudXNlQ29udGFjdEhhcmRlbmluZ1NoYWRvdz8oZVsiU0hBRE9XUENTUyIrdF09ITAsdGhpcy5fZmlsdGVyaW5nUXVhbGl0eT09PUcuUVVBTElUWV9MT1c/ZVsiU0hBRE9XTE9XUVVBTElUWSIrdF09ITA6dGhpcy5fZmlsdGVyaW5nUXVhbGl0eT09PUcuUVVBTElUWV9NRURJVU0mJihlWyJTSEFET1dNRURJVU1RVUFMSVRZIit0XT0hMCkpOnRoaXMudXNlUGVyY2VudGFnZUNsb3NlckZpbHRlcmluZz8oZVsiU0hBRE9XUENGIit0XT0hMCx0aGlzLl9maWx0ZXJpbmdRdWFsaXR5PT09Ry5RVUFMSVRZX0xPVz9lWyJTSEFET1dMT1dRVUFMSVRZIit0XT0hMDp0aGlzLl9maWx0ZXJpbmdRdWFsaXR5PT09Ry5RVUFMSVRZX01FRElVTSYmKGVbIlNIQURPV01FRElVTVFVQUxJVFkiK3RdPSEwKSk6dGhpcy51c2VQb2lzc29uU2FtcGxpbmc/ZVsiU0hBRE9XUE9JU1NPTiIrdF09ITA6dGhpcy51c2VFeHBvbmVudGlhbFNoYWRvd01hcHx8dGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXA/ZVsiU0hBRE9XRVNNIit0XT0hMDoodGhpcy51c2VDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwfHx0aGlzLnVzZUJsdXJDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwKSYmKGVbIlNIQURPV0NMT1NFRVNNIit0XT0hMCkscy5uZWVkQ3ViZSgpJiYoZVsiU0hBRE9XQ1VCRSIrdF09ITApKX1iaW5kU2hhZG93TGlnaHQoZSx0KXtjb25zdCBpPXRoaXMuX2xpZ2h0O2lmKCF0aGlzLl9zY2VuZS5zaGFkb3dzRW5hYmxlZHx8IWkuc2hhZG93RW5hYmxlZClyZXR1cm47Y29uc3Qgcj10aGlzLl9nZXRDYW1lcmEoKTtpZighcilyZXR1cm47Y29uc3Qgbj10aGlzLmdldFNoYWRvd01hcCgpO24mJihpLm5lZWRDdWJlKCl8fHQuc2V0TWF0cml4KCJsaWdodE1hdHJpeCIrZSx0aGlzLmdldFRyYW5zZm9ybU1hdHJpeCgpKSx0aGlzLl9maWx0ZXI9PT1HLkZJTFRFUl9QQ0Y/KHQuc2V0RGVwdGhTdGVuY2lsVGV4dHVyZSgic2hhZG93U2FtcGxlciIrZSx0aGlzLmdldFNoYWRvd01hcEZvclJlbmRlcmluZygpKSxpLl91bmlmb3JtQnVmZmVyLnVwZGF0ZUZsb2F0NCgic2hhZG93c0luZm8iLHRoaXMuZ2V0RGFya25lc3MoKSxuLmdldFNpemUoKS53aWR0aCwxL24uZ2V0U2l6ZSgpLndpZHRoLHRoaXMuZnJ1c3R1bUVkZ2VGYWxsb2ZmLGUpKTp0aGlzLl9maWx0ZXI9PT1HLkZJTFRFUl9QQ1NTPyh0LnNldERlcHRoU3RlbmNpbFRleHR1cmUoInNoYWRvd1NhbXBsZXIiK2UsdGhpcy5nZXRTaGFkb3dNYXBGb3JSZW5kZXJpbmcoKSksdC5zZXRUZXh0dXJlKCJkZXB0aFNhbXBsZXIiK2UsdGhpcy5nZXRTaGFkb3dNYXBGb3JSZW5kZXJpbmcoKSksaS5fdW5pZm9ybUJ1ZmZlci51cGRhdGVGbG9hdDQoInNoYWRvd3NJbmZvIix0aGlzLmdldERhcmtuZXNzKCksMS9uLmdldFNpemUoKS53aWR0aCx0aGlzLl9jb250YWN0SGFyZGVuaW5nTGlnaHRTaXplVVZSYXRpbypuLmdldFNpemUoKS53aWR0aCx0aGlzLmZydXN0dW1FZGdlRmFsbG9mZixlKSk6KHQuc2V0VGV4dHVyZSgic2hhZG93U2FtcGxlciIrZSx0aGlzLmdldFNoYWRvd01hcEZvclJlbmRlcmluZygpKSxpLl91bmlmb3JtQnVmZmVyLnVwZGF0ZUZsb2F0NCgic2hhZG93c0luZm8iLHRoaXMuZ2V0RGFya25lc3MoKSx0aGlzLmJsdXJTY2FsZS9uLmdldFNpemUoKS53aWR0aCx0aGlzLmRlcHRoU2NhbGUsdGhpcy5mcnVzdHVtRWRnZUZhbGxvZmYsZSkpLGkuX3VuaWZvcm1CdWZmZXIudXBkYXRlRmxvYXQyKCJkZXB0aFZhbHVlcyIsdGhpcy5nZXRMaWdodCgpLmdldERlcHRoTWluWihyKSx0aGlzLmdldExpZ2h0KCkuZ2V0RGVwdGhNaW5aKHIpK3RoaXMuZ2V0TGlnaHQoKS5nZXREZXB0aE1heFoociksZSkpfWdldFRyYW5zZm9ybU1hdHJpeCgpe2NvbnN0IGU9dGhpcy5fc2NlbmU7aWYodGhpcy5fY3VycmVudFJlbmRlcklkPT09ZS5nZXRSZW5kZXJJZCgpJiZ0aGlzLl9jdXJyZW50RmFjZUluZGV4Q2FjaGU9PT10aGlzLl9jdXJyZW50RmFjZUluZGV4KXJldHVybiB0aGlzLl90cmFuc2Zvcm1NYXRyaXg7dGhpcy5fY3VycmVudFJlbmRlcklkPWUuZ2V0UmVuZGVySWQoKSx0aGlzLl9jdXJyZW50RmFjZUluZGV4Q2FjaGU9dGhpcy5fY3VycmVudEZhY2VJbmRleDtsZXQgdD10aGlzLl9saWdodC5wb3NpdGlvbjtpZih0aGlzLl9saWdodC5jb21wdXRlVHJhbnNmb3JtZWRJbmZvcm1hdGlvbigpJiYodD10aGlzLl9saWdodC50cmFuc2Zvcm1lZFBvc2l0aW9uKSxwLk5vcm1hbGl6ZVRvUmVmKHRoaXMuX2xpZ2h0LmdldFNoYWRvd0RpcmVjdGlvbih0aGlzLl9jdXJyZW50RmFjZUluZGV4KSx0aGlzLl9saWdodERpcmVjdGlvbiksTWF0aC5hYnMocC5Eb3QodGhpcy5fbGlnaHREaXJlY3Rpb24scC5VcCgpKSk9PT0xJiYodGhpcy5fbGlnaHREaXJlY3Rpb24uej0xZS0xMyksdGhpcy5fbGlnaHQubmVlZFByb2plY3Rpb25NYXRyaXhDb21wdXRlKCl8fCF0aGlzLl9jYWNoZWRQb3NpdGlvbnx8IXRoaXMuX2NhY2hlZERpcmVjdGlvbnx8IXQuZXF1YWxzKHRoaXMuX2NhY2hlZFBvc2l0aW9uKXx8IXRoaXMuX2xpZ2h0RGlyZWN0aW9uLmVxdWFscyh0aGlzLl9jYWNoZWREaXJlY3Rpb24pKXt0aGlzLl9jYWNoZWRQb3NpdGlvbi5jb3B5RnJvbSh0KSx0aGlzLl9jYWNoZWREaXJlY3Rpb24uY29weUZyb20odGhpcy5fbGlnaHREaXJlY3Rpb24pLHguTG9va0F0TEhUb1JlZih0LHQuYWRkKHRoaXMuX2xpZ2h0RGlyZWN0aW9uKSxwLlVwKCksdGhpcy5fdmlld01hdHJpeCk7Y29uc3QgaT10aGlzLmdldFNoYWRvd01hcCgpO2lmKGkpe2NvbnN0IHM9aS5yZW5kZXJMaXN0O3MmJnRoaXMuX2xpZ2h0LnNldFNoYWRvd1Byb2plY3Rpb25NYXRyaXgodGhpcy5fcHJvamVjdGlvbk1hdHJpeCx0aGlzLl92aWV3TWF0cml4LHMpfXRoaXMuX3ZpZXdNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLl9wcm9qZWN0aW9uTWF0cml4LHRoaXMuX3RyYW5zZm9ybU1hdHJpeCl9cmV0dXJuIHRoaXMuX3RyYW5zZm9ybU1hdHJpeH1yZWNyZWF0ZVNoYWRvd01hcCgpe2NvbnN0IGU9dGhpcy5fc2hhZG93TWFwO2lmKCFlKXJldHVybjtjb25zdCB0PWUucmVuZGVyTGlzdDtpZih0aGlzLl9kaXNwb3NlUlRUYW5kUG9zdFByb2Nlc3NlcygpLHRoaXMuX2luaXRpYWxpemVHZW5lcmF0b3IoKSx0aGlzLmZpbHRlcj10aGlzLl9maWx0ZXIsdGhpcy5fYXBwbHlGaWx0ZXJWYWx1ZXMoKSx0KXt0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdHx8KHRoaXMuX3NoYWRvd01hcC5yZW5kZXJMaXN0PVtdKTtmb3IoY29uc3QgaSBvZiB0KXRoaXMuX3NoYWRvd01hcC5yZW5kZXJMaXN0LnB1c2goaSl9ZWxzZSB0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdD1udWxsfV9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKXt0aGlzLl9zaGFkb3dNYXAyJiYodGhpcy5fc2hhZG93TWFwMi5kaXNwb3NlKCksdGhpcy5fc2hhZG93TWFwMj1udWxsKSx0aGlzLl9ib3hCbHVyUG9zdHByb2Nlc3MmJih0aGlzLl9ib3hCbHVyUG9zdHByb2Nlc3MuZGlzcG9zZSgpLHRoaXMuX2JveEJsdXJQb3N0cHJvY2Vzcz1udWxsKSx0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzJiYodGhpcy5fa2VybmVsQmx1clhQb3N0cHJvY2Vzcy5kaXNwb3NlKCksdGhpcy5fa2VybmVsQmx1clhQb3N0cHJvY2Vzcz1udWxsKSx0aGlzLl9rZXJuZWxCbHVyWVBvc3Rwcm9jZXNzJiYodGhpcy5fa2VybmVsQmx1cllQb3N0cHJvY2Vzcy5kaXNwb3NlKCksdGhpcy5fa2VybmVsQmx1cllQb3N0cHJvY2Vzcz1udWxsKSx0aGlzLl9ibHVyUG9zdFByb2Nlc3Nlcz1bXX1fZGlzcG9zZVJUVGFuZFBvc3RQcm9jZXNzZXMoKXt0aGlzLl9zaGFkb3dNYXAmJih0aGlzLl9zaGFkb3dNYXAuZGlzcG9zZSgpLHRoaXMuX3NoYWRvd01hcD1udWxsKSx0aGlzLl9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKX1fZGlzcG9zZVNjZW5lVUJPcygpe2lmKHRoaXMuX3NjZW5lVUJPcyl7Zm9yKGNvbnN0IGUgb2YgdGhpcy5fc2NlbmVVQk9zKWUuZGlzcG9zZSgpO3RoaXMuX3NjZW5lVUJPcz1bXX19ZGlzcG9zZSgpe2lmKHRoaXMuX2Rpc3Bvc2VSVFRhbmRQb3N0UHJvY2Vzc2VzKCksdGhpcy5fZGlzcG9zZVNjZW5lVUJPcygpLHRoaXMuX2xpZ2h0KXtpZih0aGlzLl9saWdodC5fc2hhZG93R2VuZXJhdG9ycyl7Y29uc3QgZT10aGlzLl9saWdodC5fc2hhZG93R2VuZXJhdG9ycy5lbnRyaWVzKCk7Zm9yKGxldCB0PWUubmV4dCgpO3QuZG9uZSE9PSEwO3Q9ZS5uZXh0KCkpe2NvbnN0W2ksc109dC52YWx1ZTtzPT09dGhpcyYmdGhpcy5fbGlnaHQuX3NoYWRvd0dlbmVyYXRvcnMuZGVsZXRlKGkpfXRoaXMuX2xpZ2h0Ll9zaGFkb3dHZW5lcmF0b3JzLnNpemU9PT0wJiYodGhpcy5fbGlnaHQuX3NoYWRvd0dlbmVyYXRvcnM9bnVsbCl9dGhpcy5fbGlnaHQuX21hcmtNZXNoZXNBc0xpZ2h0RGlydHkoKX10aGlzLm9uQmVmb3JlU2hhZG93TWFwUmVuZGVyTWVzaE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlU2hhZG93TWFwUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlclNoYWRvd01hcFJlbmRlck1lc2hPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkFmdGVyU2hhZG93TWFwUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpfXNlcmlhbGl6ZSgpe3ZhciBlO2NvbnN0IHQ9e30saT10aGlzLmdldFNoYWRvd01hcCgpO2lmKCFpKXJldHVybiB0O2lmKHQuY2xhc3NOYW1lPXRoaXMuZ2V0Q2xhc3NOYW1lKCksdC5saWdodElkPXRoaXMuX2xpZ2h0LmlkLHQuY2FtZXJhSWQ9KGU9dGhpcy5fY2FtZXJhKT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUuaWQsdC5pZD10aGlzLmlkLHQubWFwU2l6ZT1pLmdldFJlbmRlclNpemUoKSx0LmZvcmNlQmFja0ZhY2VzT25seT10aGlzLmZvcmNlQmFja0ZhY2VzT25seSx0LmRhcmtuZXNzPXRoaXMuZ2V0RGFya25lc3MoKSx0LnRyYW5zcGFyZW5jeVNoYWRvdz10aGlzLl90cmFuc3BhcmVuY3lTaGFkb3csdC5mcnVzdHVtRWRnZUZhbGxvZmY9dGhpcy5mcnVzdHVtRWRnZUZhbGxvZmYsdC5iaWFzPXRoaXMuYmlhcyx0Lm5vcm1hbEJpYXM9dGhpcy5ub3JtYWxCaWFzLHQudXNlUGVyY2VudGFnZUNsb3NlckZpbHRlcmluZz10aGlzLnVzZVBlcmNlbnRhZ2VDbG9zZXJGaWx0ZXJpbmcsdC51c2VDb250YWN0SGFyZGVuaW5nU2hhZG93PXRoaXMudXNlQ29udGFjdEhhcmRlbmluZ1NoYWRvdyx0LmNvbnRhY3RIYXJkZW5pbmdMaWdodFNpemVVVlJhdGlvPXRoaXMuY29udGFjdEhhcmRlbmluZ0xpZ2h0U2l6ZVVWUmF0aW8sdC5maWx0ZXJpbmdRdWFsaXR5PXRoaXMuZmlsdGVyaW5nUXVhbGl0eSx0LnVzZUV4cG9uZW50aWFsU2hhZG93TWFwPXRoaXMudXNlRXhwb25lbnRpYWxTaGFkb3dNYXAsdC51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXA9dGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXAsdC51c2VDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwPXRoaXMudXNlQmx1ckV4cG9uZW50aWFsU2hhZG93TWFwLHQudXNlQmx1ckNsb3NlRXhwb25lbnRpYWxTaGFkb3dNYXA9dGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXAsdC51c2VQb2lzc29uU2FtcGxpbmc9dGhpcy51c2VQb2lzc29uU2FtcGxpbmcsdC5kZXB0aFNjYWxlPXRoaXMuZGVwdGhTY2FsZSx0LmJsdXJCb3hPZmZzZXQ9dGhpcy5ibHVyQm94T2Zmc2V0LHQuYmx1cktlcm5lbD10aGlzLmJsdXJLZXJuZWwsdC5ibHVyU2NhbGU9dGhpcy5ibHVyU2NhbGUsdC51c2VLZXJuZWxCbHVyPXRoaXMudXNlS2VybmVsQmx1cix0LnJlbmRlckxpc3Q9W10saS5yZW5kZXJMaXN0KWZvcihsZXQgcz0wO3M8aS5yZW5kZXJMaXN0Lmxlbmd0aDtzKyspe2NvbnN0IHI9aS5yZW5kZXJMaXN0W3NdO3QucmVuZGVyTGlzdC5wdXNoKHIuaWQpfXJldHVybiB0fXN0YXRpYyBQYXJzZShlLHQsaSl7Y29uc3Qgcz10LmdldExpZ2h0QnlJZChlLmxpZ2h0SWQpLHI9ZS5jYW1lcmFJZCE9PXZvaWQgMD90LmdldENhbWVyYUJ5SWQoZS5jYW1lcmFJZCk6bnVsbCxuPWk/aShlLm1hcFNpemUscyxyKTpuZXcgRyhlLm1hcFNpemUscyx2b2lkIDAsciksYT1uLmdldFNoYWRvd01hcCgpO2ZvcihsZXQgbz0wO288ZS5yZW5kZXJMaXN0Lmxlbmd0aDtvKyspdC5nZXRNZXNoZXNCeUlkKGUucmVuZGVyTGlzdFtvXSkuZm9yRWFjaChmdW5jdGlvbihsKXthJiYoYS5yZW5kZXJMaXN0fHwoYS5yZW5kZXJMaXN0PVtdKSxhLnJlbmRlckxpc3QucHVzaChsKSl9KTtyZXR1cm4gZS5pZCE9PXZvaWQgMCYmKG4uaWQ9ZS5pZCksbi5mb3JjZUJhY2tGYWNlc09ubHk9ISFlLmZvcmNlQmFja0ZhY2VzT25seSxlLmRhcmtuZXNzIT09dm9pZCAwJiZuLnNldERhcmtuZXNzKGUuZGFya25lc3MpLGUudHJhbnNwYXJlbmN5U2hhZG93JiZuLnNldFRyYW5zcGFyZW5jeVNoYWRvdyghMCksZS5mcnVzdHVtRWRnZUZhbGxvZmYhPT12b2lkIDAmJihuLmZydXN0dW1FZGdlRmFsbG9mZj1lLmZydXN0dW1FZGdlRmFsbG9mZiksZS5iaWFzIT09dm9pZCAwJiYobi5iaWFzPWUuYmlhcyksZS5ub3JtYWxCaWFzIT09dm9pZCAwJiYobi5ub3JtYWxCaWFzPWUubm9ybWFsQmlhcyksZS51c2VQZXJjZW50YWdlQ2xvc2VyRmlsdGVyaW5nP24udXNlUGVyY2VudGFnZUNsb3NlckZpbHRlcmluZz0hMDplLnVzZUNvbnRhY3RIYXJkZW5pbmdTaGFkb3c/bi51c2VDb250YWN0SGFyZGVuaW5nU2hhZG93PSEwOmUudXNlUG9pc3NvblNhbXBsaW5nP24udXNlUG9pc3NvblNhbXBsaW5nPSEwOmUudXNlRXhwb25lbnRpYWxTaGFkb3dNYXA/bi51c2VFeHBvbmVudGlhbFNoYWRvd01hcD0hMDplLnVzZUJsdXJFeHBvbmVudGlhbFNoYWRvd01hcD9uLnVzZUJsdXJFeHBvbmVudGlhbFNoYWRvd01hcD0hMDplLnVzZUNsb3NlRXhwb25lbnRpYWxTaGFkb3dNYXA/bi51c2VDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwPSEwOmUudXNlQmx1ckNsb3NlRXhwb25lbnRpYWxTaGFkb3dNYXA/bi51c2VCbHVyQ2xvc2VFeHBvbmVudGlhbFNoYWRvd01hcD0hMDplLnVzZVZhcmlhbmNlU2hhZG93TWFwP24udXNlRXhwb25lbnRpYWxTaGFkb3dNYXA9ITA6ZS51c2VCbHVyVmFyaWFuY2VTaGFkb3dNYXAmJihuLnVzZUJsdXJFeHBvbmVudGlhbFNoYWRvd01hcD0hMCksZS5jb250YWN0SGFyZGVuaW5nTGlnaHRTaXplVVZSYXRpbyE9PXZvaWQgMCYmKG4uY29udGFjdEhhcmRlbmluZ0xpZ2h0U2l6ZVVWUmF0aW89ZS5jb250YWN0SGFyZGVuaW5nTGlnaHRTaXplVVZSYXRpbyksZS5maWx0ZXJpbmdRdWFsaXR5IT09dm9pZCAwJiYobi5maWx0ZXJpbmdRdWFsaXR5PWUuZmlsdGVyaW5nUXVhbGl0eSksZS5kZXB0aFNjYWxlJiYobi5kZXB0aFNjYWxlPWUuZGVwdGhTY2FsZSksZS5ibHVyU2NhbGUmJihuLmJsdXJTY2FsZT1lLmJsdXJTY2FsZSksZS5ibHVyQm94T2Zmc2V0JiYobi5ibHVyQm94T2Zmc2V0PWUuYmx1ckJveE9mZnNldCksZS51c2VLZXJuZWxCbHVyJiYobi51c2VLZXJuZWxCbHVyPWUudXNlS2VybmVsQmx1ciksZS5ibHVyS2VybmVsJiYobi5ibHVyS2VybmVsPWUuYmx1cktlcm5lbCksbn19Ry5DTEFTU05BTUU9IlNoYWRvd0dlbmVyYXRvciIsRy5GSUxURVJfTk9ORT0wLEcuRklMVEVSX0VYUE9ORU5USUFMU0hBRE9XTUFQPTEsRy5GSUxURVJfUE9JU1NPTlNBTVBMSU5HPTIsRy5GSUxURVJfQkxVUkVYUE9ORU5USUFMU0hBRE9XTUFQPTMsRy5GSUxURVJfQ0xPU0VFWFBPTkVOVElBTFNIQURPV01BUD00LEcuRklMVEVSX0JMVVJDTE9TRUVYUE9ORU5USUFMU0hBRE9XTUFQPTUsRy5GSUxURVJfUENGPTYsRy5GSUxURVJfUENTUz03LEcuUVVBTElUWV9ISUdIPTAsRy5RVUFMSVRZX01FRElVTT0xLEcuUVVBTElUWV9MT1c9MixHLkRFRkFVTFRfQUxQSEFfQ1VUT0ZGPS41LEcuX1NjZW5lQ29tcG9uZW50SW5pdGlhbGl6YXRpb249Yz0+e3Rocm93ICQoIlNoYWRvd0dlbmVyYXRvclNjZW5lQ29tcG9uZW50Iil9O2NvbnN0IE1vPSJkZXB0aFBpeGVsU2hhZGVyIixBbz1gI2lmZGVmIEFMUEhBVEVTVAp2YXJ5aW5nIHZlYzIgdlVWOwp1bmlmb3JtIHNhbXBsZXIyRCBkaWZmdXNlU2FtcGxlcjsKI2VuZGlmCiNpbmNsdWRlPGNsaXBQbGFuZUZyYWdtZW50RGVjbGFyYXRpb24+CnZhcnlpbmcgZmxvYXQgdkRlcHRoTWV0cmljOwojaWZkZWYgUEFDS0VECiNpbmNsdWRlPHBhY2tpbmdGdW5jdGlvbnM+CiNlbmRpZgojZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9ERUZJTklUSU9OUwp2b2lkIG1haW4odm9pZCkKewojaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudD4KI2lmZGVmIEFMUEhBVEVTVAppZiAodGV4dHVyZTJEKGRpZmZ1c2VTYW1wbGVyLHZVVikuYTwwLjQpCmRpc2NhcmQ7CiNlbmRpZgojaWZkZWYgTk9OTElORUFSREVQVEgKI2lmZGVmIFBBQ0tFRApnbF9GcmFnQ29sb3I9cGFjayhnbF9GcmFnQ29vcmQueik7CiNlbHNlCmdsX0ZyYWdDb2xvcj12ZWM0KGdsX0ZyYWdDb29yZC56LDAuMCwwLjAsMC4wKTsKI2VuZGlmCiNlbHNlCiNpZmRlZiBQQUNLRUQKZ2xfRnJhZ0NvbG9yPXBhY2sodkRlcHRoTWV0cmljKTsKI2Vsc2UKZ2xfRnJhZ0NvbG9yPXZlYzQodkRlcHRoTWV0cmljLDAuMCwwLjAsMS4wKTsKI2VuZGlmCiNlbmRpZgp9YDtVLlNoYWRlcnNTdG9yZVtNb109QW87Y29uc3QgUm89Imluc3RhbmNlc0RlY2xhcmF0aW9uIix5bz1gI2lmZGVmIElOU1RBTkNFUwphdHRyaWJ1dGUgdmVjNCB3b3JsZDA7CmF0dHJpYnV0ZSB2ZWM0IHdvcmxkMTsKYXR0cmlidXRlIHZlYzQgd29ybGQyOwphdHRyaWJ1dGUgdmVjNCB3b3JsZDM7CiNpZmRlZiBJTlNUQU5DRVNDT0xPUgphdHRyaWJ1dGUgdmVjNCBpbnN0YW5jZUNvbG9yOwojZW5kaWYKI2lmIGRlZmluZWQoVEhJTl9JTlNUQU5DRVMpICYmICFkZWZpbmVkKFdPUkxEX1VCTykKdW5pZm9ybSBtYXQ0IHdvcmxkOwojZW5kaWYKI2lmIGRlZmluZWQoVkVMT0NJVFkpIHx8IGRlZmluZWQoUFJFUEFTU19WRUxPQ0lUWSkKYXR0cmlidXRlIHZlYzQgcHJldmlvdXNXb3JsZDA7CmF0dHJpYnV0ZSB2ZWM0IHByZXZpb3VzV29ybGQxOwphdHRyaWJ1dGUgdmVjNCBwcmV2aW91c1dvcmxkMjsKYXR0cmlidXRlIHZlYzQgcHJldmlvdXNXb3JsZDM7CiNpZmRlZiBUSElOX0lOU1RBTkNFUwp1bmlmb3JtIG1hdDQgcHJldmlvdXNXb3JsZDsKI2VuZGlmCiNlbmRpZgojZWxzZQojaWYgIWRlZmluZWQoV09STERfVUJPKQp1bmlmb3JtIG1hdDQgd29ybGQ7CiNlbmRpZgojaWYgZGVmaW5lZChWRUxPQ0lUWSkgfHwgZGVmaW5lZChQUkVQQVNTX1ZFTE9DSVRZKQp1bmlmb3JtIG1hdDQgcHJldmlvdXNXb3JsZDsKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbUm9dPXlvO2NvbnN0IENvPSJkZXB0aFZlcnRleFNoYWRlciIsSW89YGF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uOwojaW5jbHVkZTxib25lc0RlY2xhcmF0aW9uPgojaW5jbHVkZTxiYWtlZFZlcnRleEFuaW1hdGlvbkRlY2xhcmF0aW9uPgojaW5jbHVkZTxtb3JwaFRhcmdldHNWZXJ0ZXhHbG9iYWxEZWNsYXJhdGlvbj4KI2luY2x1ZGU8bW9ycGhUYXJnZXRzVmVydGV4RGVjbGFyYXRpb24+WzAuLm1heFNpbXVsdGFuZW91c01vcnBoVGFyZ2V0c10KI2luY2x1ZGU8Y2xpcFBsYW5lVmVydGV4RGVjbGFyYXRpb24+CiNpbmNsdWRlPGluc3RhbmNlc0RlY2xhcmF0aW9uPgp1bmlmb3JtIG1hdDQgdmlld1Byb2plY3Rpb247CnVuaWZvcm0gdmVjMiBkZXB0aFZhbHVlczsKI2lmIGRlZmluZWQoQUxQSEFURVNUKSB8fCBkZWZpbmVkKE5FRURfVVYpCnZhcnlpbmcgdmVjMiB2VVY7CnVuaWZvcm0gbWF0NCBkaWZmdXNlTWF0cml4OwojaWZkZWYgVVYxCmF0dHJpYnV0ZSB2ZWMyIHV2OwojZW5kaWYKI2lmZGVmIFVWMgphdHRyaWJ1dGUgdmVjMiB1djI7CiNlbmRpZgojZW5kaWYKdmFyeWluZyBmbG9hdCB2RGVwdGhNZXRyaWM7CiNkZWZpbmUgQ1VTVE9NX1ZFUlRFWF9ERUZJTklUSU9OUwp2b2lkIG1haW4odm9pZCkKewp2ZWMzIHBvc2l0aW9uVXBkYXRlZD1wb3NpdGlvbjsKI2lmZGVmIFVWMQp2ZWMyIHV2VXBkYXRlZD11djsKI2VuZGlmCiNpbmNsdWRlPG1vcnBoVGFyZ2V0c1ZlcnRleEdsb2JhbD4KI2luY2x1ZGU8bW9ycGhUYXJnZXRzVmVydGV4PlswLi5tYXhTaW11bHRhbmVvdXNNb3JwaFRhcmdldHNdCiNpbmNsdWRlPGluc3RhbmNlc1ZlcnRleD4KI2luY2x1ZGU8Ym9uZXNWZXJ0ZXg+CiNpbmNsdWRlPGJha2VkVmVydGV4QW5pbWF0aW9uPgp2ZWM0IHdvcmxkUG9zPWZpbmFsV29ybGQqdmVjNChwb3NpdGlvblVwZGF0ZWQsMS4wKTsKI2luY2x1ZGU8Y2xpcFBsYW5lVmVydGV4PgpnbF9Qb3NpdGlvbj12aWV3UHJvamVjdGlvbip3b3JsZFBvczsKI2lmZGVmIFVTRV9SRVZFUlNFX0RFUFRIQlVGRkVSCnZEZXB0aE1ldHJpYz0oKC1nbF9Qb3NpdGlvbi56K2RlcHRoVmFsdWVzLngpLyhkZXB0aFZhbHVlcy55KSk7CiNlbHNlCnZEZXB0aE1ldHJpYz0oKGdsX1Bvc2l0aW9uLnorZGVwdGhWYWx1ZXMueCkvKGRlcHRoVmFsdWVzLnkpKTsKI2VuZGlmCiNpZiBkZWZpbmVkKEFMUEhBVEVTVCkgfHwgZGVmaW5lZChCQVNJQ19SRU5ERVIpCiNpZmRlZiBVVjEKdlVWPXZlYzIoZGlmZnVzZU1hdHJpeCp2ZWM0KHV2VXBkYXRlZCwxLjAsMC4wKSk7CiNlbmRpZgojaWZkZWYgVVYyCnZVVj12ZWMyKGRpZmZ1c2VNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpOwojZW5kaWYKI2VuZGlmCn0KYDtVLlNoYWRlcnNTdG9yZVtDb109SW87Y2xhc3MgYXN7Y29uc3RydWN0b3IoZSx0PTEsaT1udWxsLHM9ITEscj1OLlRSSUxJTkVBUl9TQU1QTElOR01PREUpe3RoaXMuZW5hYmxlZD0hMCx0aGlzLmZvcmNlRGVwdGhXcml0ZVRyYW5zcGFyZW50TWVzaGVzPSExLHRoaXMudXNlT25seUluQWN0aXZlQ2FtZXJhPSExLHRoaXMuX3NjZW5lPWUsdGhpcy5fc3RvcmVOb25MaW5lYXJEZXB0aD1zLHRoaXMuaXNQYWNrZWQ9dD09PTAsdGhpcy5pc1BhY2tlZD90aGlzLl9jbGVhckNvbG9yPW5ldyBtZSgxLDEsMSwxKTp0aGlzLl9jbGVhckNvbG9yPW5ldyBtZSgxLDAsMCwxKSxhcy5fU2NlbmVDb21wb25lbnRJbml0aWFsaXphdGlvbih0aGlzLl9zY2VuZSk7Y29uc3Qgbj1lLmdldEVuZ2luZSgpO3RoaXMuX2NhbWVyYT1pLHIhPT1OLk5FQVJFU1RfU0FNUExJTkdNT0RFJiYodD09PTEmJiFuLl9jYXBzLnRleHR1cmVGbG9hdExpbmVhckZpbHRlcmluZyYmKHI9Ti5ORUFSRVNUX1NBTVBMSU5HTU9ERSksdD09PTImJiFuLl9jYXBzLnRleHR1cmVIYWxmRmxvYXRMaW5lYXJGaWx0ZXJpbmcmJihyPU4uTkVBUkVTVF9TQU1QTElOR01PREUpKTtjb25zdCBhPXRoaXMuaXNQYWNrZWR8fCFuLl9mZWF0dXJlcy5zdXBwb3J0RXh0ZW5kZWRUZXh0dXJlRm9ybWF0cz81OjY7dGhpcy5fZGVwdGhNYXA9bmV3IF90KCJEZXB0aFJlbmRlcmVyIix7d2lkdGg6bi5nZXRSZW5kZXJXaWR0aCgpLGhlaWdodDpuLmdldFJlbmRlckhlaWdodCgpfSx0aGlzLl9zY2VuZSwhMSwhMCx0LCExLHIsdm9pZCAwLHZvaWQgMCx2b2lkIDAsYSksdGhpcy5fZGVwdGhNYXAud3JhcFU9Ti5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9kZXB0aE1hcC53cmFwVj1OLkNMQU1QX0FERFJFU1NNT0RFLHRoaXMuX2RlcHRoTWFwLnJlZnJlc2hSYXRlPTEsdGhpcy5fZGVwdGhNYXAucmVuZGVyUGFydGljbGVzPSExLHRoaXMuX2RlcHRoTWFwLnJlbmRlckxpc3Q9bnVsbCx0aGlzLl9kZXB0aE1hcC5hY3RpdmVDYW1lcmE9dGhpcy5fY2FtZXJhLHRoaXMuX2RlcHRoTWFwLmlnbm9yZUNhbWVyYVZpZXdwb3J0PSEwLHRoaXMuX2RlcHRoTWFwLnVzZUNhbWVyYVBvc3RQcm9jZXNzZXM9ITEsdGhpcy5fZGVwdGhNYXAub25DbGVhck9ic2VydmFibGUuYWRkKGg9PntoLmNsZWFyKHRoaXMuX2NsZWFyQ29sb3IsITAsITAsITApfSksdGhpcy5fZGVwdGhNYXAub25CZWZvcmVCaW5kT2JzZXJ2YWJsZS5hZGQoKCk9Pnt2YXIgaDsoaD1uLl9kZWJ1Z1B1c2hHcm91cCk9PT1udWxsfHxoPT09dm9pZCAwfHxoLmNhbGwobiwiZGVwdGggcmVuZGVyZXIiLDEpfSksdGhpcy5fZGVwdGhNYXAub25BZnRlclVuYmluZE9ic2VydmFibGUuYWRkKCgpPT57dmFyIGg7KGg9bi5fZGVidWdQb3BHcm91cCk9PT1udWxsfHxoPT09dm9pZCAwfHxoLmNhbGwobiwxKX0pLHRoaXMuX2RlcHRoTWFwLmN1c3RvbUlzUmVhZHlGdW5jdGlvbj0oaCxsLHUpPT57aWYoKHV8fGw9PT0wKSYmaC5zdWJNZXNoZXMpZm9yKGxldCBkPTA7ZDxoLnN1Yk1lc2hlcy5sZW5ndGg7KytkKXtjb25zdCBmPWguc3ViTWVzaGVzW2RdLF89Zi5nZXRSZW5kZXJpbmdNZXNoKCksRT1fLl9nZXRJbnN0YW5jZXNSZW5kZXJMaXN0KGYuX2lkLCEhZi5nZXRSZXBsYWNlbWVudE1lc2goKSksbT1uLmdldENhcHMoKS5pbnN0YW5jZWRBcnJheXMmJihFLnZpc2libGVJbnN0YW5jZXNbZi5faWRdIT09bnVsbCYmRS52aXNpYmxlSW5zdGFuY2VzW2YuX2lkXSE9PXZvaWQgMHx8Xy5oYXNUaGluSW5zdGFuY2VzKTtpZighdGhpcy5pc1JlYWR5KGYsbSkpcmV0dXJuITF9cmV0dXJuITB9O2NvbnN0IG89aD0+e3ZhciBsLHU7Y29uc3QgZD1oLmdldFJlbmRlcmluZ01lc2goKSxmPWguZ2V0RWZmZWN0aXZlTWVzaCgpLF89dGhpcy5fc2NlbmUsRT1fLmdldEVuZ2luZSgpLG09aC5nZXRNYXRlcmlhbCgpO2lmKGYuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2lzQWN0aXZlSW50ZXJtZWRpYXRlPSExLCFtfHxmLmluZmluaXRlRGlzdGFuY2V8fG0uZGlzYWJsZURlcHRoV3JpdGV8fGgudmVydGljZXNDb3VudD09PTB8fGguX3JlbmRlcklkPT09Xy5nZXRSZW5kZXJJZCgpKXJldHVybjtjb25zdCB2PWYuX2dldFdvcmxkTWF0cml4RGV0ZXJtaW5hbnQoKTwwO2xldCBTPShsPWQub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbikhPT1udWxsJiZsIT09dm9pZCAwP2w6bS5zaWRlT3JpZW50YXRpb247diYmKFM9Uz09PTA/MTowKTtjb25zdCB5PVM9PT0wO0Uuc2V0U3RhdGUobS5iYWNrRmFjZUN1bGxpbmcsMCwhMSx5LG0uY3VsbEJhY2tGYWNlcyk7Y29uc3QgQT1kLl9nZXRJbnN0YW5jZXNSZW5kZXJMaXN0KGguX2lkLCEhaC5nZXRSZXBsYWNlbWVudE1lc2goKSk7aWYoQS5tdXN0UmV0dXJuKXJldHVybjtjb25zdCBDPUUuZ2V0Q2FwcygpLmluc3RhbmNlZEFycmF5cyYmKEEudmlzaWJsZUluc3RhbmNlc1toLl9pZF0hPT1udWxsJiZBLnZpc2libGVJbnN0YW5jZXNbaC5faWRdIT09dm9pZCAwfHxkLmhhc1RoaW5JbnN0YW5jZXMpLGI9dGhpcy5fY2FtZXJhfHxfLmFjdGl2ZUNhbWVyYTtpZih0aGlzLmlzUmVhZHkoaCxDKSYmYil7aC5fcmVuZGVySWQ9Xy5nZXRSZW5kZXJJZCgpO2NvbnN0IE09KHU9Zi5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWxGb3JSZW5kZXJQYXNzKT09PW51bGx8fHU9PT12b2lkIDA/dm9pZCAwOnVbRS5jdXJyZW50UmVuZGVyUGFzc0lkXTtsZXQgTD1oLl9nZXREcmF3V3JhcHBlcigpOyFMJiZNJiYoTD1NLl9nZXREcmF3V3JhcHBlcigpKTtjb25zdCBrPWIubW9kZT09PWouT1JUSE9HUkFQSElDX0NBTUVSQTtpZighTClyZXR1cm47Y29uc3Qgdz1MLmVmZmVjdDtFLmVuYWJsZUVmZmVjdChMKSxDfHxkLl9iaW5kKGgsdyxtLmZpbGxNb2RlKSxNP00uYmluZEZvclN1Yk1lc2goZi5nZXRXb3JsZE1hdHJpeCgpLGYsaCk6KHcuc2V0TWF0cml4KCJ2aWV3UHJvamVjdGlvbiIsXy5nZXRUcmFuc2Zvcm1NYXRyaXgoKSksdy5zZXRNYXRyaXgoIndvcmxkIixmLmdldFdvcmxkTWF0cml4KCkpKTtsZXQgZGUsY2U7aWYoaz8oZGU9IUUudXNlUmV2ZXJzZURlcHRoQnVmZmVyJiZFLmlzTkRDSGFsZlpSYW5nZT8wOjEsY2U9RS51c2VSZXZlcnNlRGVwdGhCdWZmZXImJkUuaXNORENIYWxmWlJhbmdlPzA6MSk6KGRlPUUudXNlUmV2ZXJzZURlcHRoQnVmZmVyJiZFLmlzTkRDSGFsZlpSYW5nZT9iLm1pblo6RS5pc05EQ0hhbGZaUmFuZ2U/MDpiLm1pblosY2U9RS51c2VSZXZlcnNlRGVwdGhCdWZmZXImJkUuaXNORENIYWxmWlJhbmdlPzA6Yi5tYXhaKSx3LnNldEZsb2F0MigiZGVwdGhWYWx1ZXMiLGRlLGRlK2NlKSwhTSl7aWYobS5uZWVkQWxwaGFUZXN0aW5nKCkpe2NvbnN0IHNlPW0uZ2V0QWxwaGFUZXN0VGV4dHVyZSgpO3NlJiYody5zZXRUZXh0dXJlKCJkaWZmdXNlU2FtcGxlciIsc2UpLHcuc2V0TWF0cml4KCJkaWZmdXNlTWF0cml4IixzZS5nZXRUZXh0dXJlTWF0cml4KCkpKX1pZihkLnVzZUJvbmVzJiZkLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycyYmZC5za2VsZXRvbil7Y29uc3Qgc2U9ZC5za2VsZXRvbjtpZihzZS5pc1VzaW5nVGV4dHVyZUZvck1hdHJpY2VzKXtjb25zdCB0ZT1zZS5nZXRUcmFuc2Zvcm1NYXRyaXhUZXh0dXJlKGQpO2lmKCF0ZSlyZXR1cm47dy5zZXRUZXh0dXJlKCJib25lU2FtcGxlciIsdGUpLHcuc2V0RmxvYXQoImJvbmVUZXh0dXJlV2lkdGgiLDQqKHNlLmJvbmVzLmxlbmd0aCsxKSl9ZWxzZSB3LnNldE1hdHJpY2VzKCJtQm9uZXMiLHNlLmdldFRyYW5zZm9ybU1hdHJpY2VzKGQpKX1ycyh3LG0sXyksaWUuQmluZE1vcnBoVGFyZ2V0UGFyYW1ldGVycyhkLHcpLGQubW9ycGhUYXJnZXRNYW5hZ2VyJiZkLm1vcnBoVGFyZ2V0TWFuYWdlci5pc1VzaW5nVGV4dHVyZUZvclRhcmdldHMmJmQubW9ycGhUYXJnZXRNYW5hZ2VyLl9iaW5kKHcpfWQuX3Byb2Nlc3NSZW5kZXJpbmcoZixoLHcsbS5maWxsTW9kZSxBLEMsKHNlLHRlKT0+dy5zZXRNYXRyaXgoIndvcmxkIix0ZSkpfX07dGhpcy5fZGVwdGhNYXAuY3VzdG9tUmVuZGVyRnVuY3Rpb249KGgsbCx1LGQpPT57bGV0IGY7aWYoZC5sZW5ndGgpZm9yKGY9MDtmPGQubGVuZ3RoO2YrKylvKGQuZGF0YVtmXSk7Zm9yKGY9MDtmPGgubGVuZ3RoO2YrKylvKGguZGF0YVtmXSk7Zm9yKGY9MDtmPGwubGVuZ3RoO2YrKylvKGwuZGF0YVtmXSk7aWYodGhpcy5mb3JjZURlcHRoV3JpdGVUcmFuc3BhcmVudE1lc2hlcylmb3IoZj0wO2Y8dS5sZW5ndGg7ZisrKW8odS5kYXRhW2ZdKTtlbHNlIGZvcihmPTA7Zjx1Lmxlbmd0aDtmKyspdS5kYXRhW2ZdLmdldEVmZmVjdGl2ZU1lc2goKS5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5faXNBY3RpdmVJbnRlcm1lZGlhdGU9ITF9fXNldE1hdGVyaWFsRm9yUmVuZGVyaW5nKGUsdCl7dGhpcy5fZGVwdGhNYXAuc2V0TWF0ZXJpYWxGb3JSZW5kZXJpbmcoZSx0KX1pc1JlYWR5KGUsdCl7dmFyIGk7Y29uc3Qgcz10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSxyPWUuZ2V0TWVzaCgpLG49ci5nZXRTY2VuZSgpLGE9KGk9ci5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWxGb3JSZW5kZXJQYXNzKT09PW51bGx8fGk9PT12b2lkIDA/dm9pZCAwOmlbcy5jdXJyZW50UmVuZGVyUGFzc0lkXTtpZihhKXJldHVybiBhLmlzUmVhZHlGb3JTdWJNZXNoKHIsZSx0KTtjb25zdCBvPWUuZ2V0TWF0ZXJpYWwoKTtpZighb3x8by5kaXNhYmxlRGVwdGhXcml0ZSlyZXR1cm4hMTtjb25zdCBoPVtdLGw9W2cuUG9zaXRpb25LaW5kXTtpZihvJiZvLm5lZWRBbHBoYVRlc3RpbmcoKSYmby5nZXRBbHBoYVRlc3RUZXh0dXJlKCkmJihoLnB1c2goIiNkZWZpbmUgQUxQSEFURVNUIiksci5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5VVktpbmQpJiYobC5wdXNoKGcuVVZLaW5kKSxoLnB1c2goIiNkZWZpbmUgVVYxIikpLHIuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuVVYyS2luZCkmJihsLnB1c2goZy5VVjJLaW5kKSxoLnB1c2goIiNkZWZpbmUgVVYyIikpKSxyLnVzZUJvbmVzJiZyLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycyl7bC5wdXNoKGcuTWF0cmljZXNJbmRpY2VzS2luZCksbC5wdXNoKGcuTWF0cmljZXNXZWlnaHRzS2luZCksci5udW1Cb25lSW5mbHVlbmNlcnM+NCYmKGwucHVzaChnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCksbC5wdXNoKGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kKSksaC5wdXNoKCIjZGVmaW5lIE5VTV9CT05FX0lORkxVRU5DRVJTICIrci5udW1Cb25lSW5mbHVlbmNlcnMpLGgucHVzaCgiI2RlZmluZSBCb25lc1Blck1lc2ggIisoci5za2VsZXRvbj9yLnNrZWxldG9uLmJvbmVzLmxlbmd0aCsxOjApKTtjb25zdCBtPWUuZ2V0UmVuZGVyaW5nTWVzaCgpLnNrZWxldG9uO20hPW51bGwmJm0uaXNVc2luZ1RleHR1cmVGb3JNYXRyaWNlcyYmaC5wdXNoKCIjZGVmaW5lIEJPTkVURVhUVVJFIil9ZWxzZSBoLnB1c2goIiNkZWZpbmUgTlVNX0JPTkVfSU5GTFVFTkNFUlMgMCIpO2NvbnN0IHU9ci5tb3JwaFRhcmdldE1hbmFnZXI7bGV0IGQ9MDt1JiZ1Lm51bUluZmx1ZW5jZXJzPjAmJihkPXUubnVtSW5mbHVlbmNlcnMsaC5wdXNoKCIjZGVmaW5lIE1PUlBIVEFSR0VUUyIpLGgucHVzaCgiI2RlZmluZSBOVU1fTU9SUEhfSU5GTFVFTkNFUlMgIitkKSx1LmlzVXNpbmdUZXh0dXJlRm9yVGFyZ2V0cyYmaC5wdXNoKCIjZGVmaW5lIE1PUlBIVEFSR0VUU19URVhUVVJFIiksaWUuUHJlcGFyZUF0dHJpYnV0ZXNGb3JNb3JwaFRhcmdldHNJbmZsdWVuY2VycyhsLHIsZCkpLHQmJihoLnB1c2goIiNkZWZpbmUgSU5TVEFOQ0VTIiksaWUuUHVzaEF0dHJpYnV0ZXNGb3JJbnN0YW5jZXMobCksZS5nZXRSZW5kZXJpbmdNZXNoKCkuaGFzVGhpbkluc3RhbmNlcyYmaC5wdXNoKCIjZGVmaW5lIFRISU5fSU5TVEFOQ0VTIikpLHRoaXMuX3N0b3JlTm9uTGluZWFyRGVwdGgmJmgucHVzaCgiI2RlZmluZSBOT05MSU5FQVJERVBUSCIpLHRoaXMuaXNQYWNrZWQmJmgucHVzaCgiI2RlZmluZSBQQUNLRUQiKSxPcyhvLG4saCk7Y29uc3QgZj1lLl9nZXREcmF3V3JhcHBlcih2b2lkIDAsITApLF89Zi5kZWZpbmVzLEU9aC5qb2luKGAKYCk7aWYoXyE9PUUpe2NvbnN0IG09WyJ3b3JsZCIsIm1Cb25lcyIsImJvbmVUZXh0dXJlV2lkdGgiLCJ2aWV3UHJvamVjdGlvbiIsImRpZmZ1c2VNYXRyaXgiLCJkZXB0aFZhbHVlcyIsIm1vcnBoVGFyZ2V0SW5mbHVlbmNlcyIsIm1vcnBoVGFyZ2V0VGV4dHVyZUluZm8iLCJtb3JwaFRhcmdldFRleHR1cmVJbmRpY2VzIl07c3MobSksZi5zZXRFZmZlY3Qocy5jcmVhdGVFZmZlY3QoImRlcHRoIixsLG0sWyJkaWZmdXNlU2FtcGxlciIsIm1vcnBoVGFyZ2V0cyIsImJvbmVTYW1wbGVyIl0sRSx2b2lkIDAsdm9pZCAwLHZvaWQgMCx7bWF4U2ltdWx0YW5lb3VzTW9ycGhUYXJnZXRzOmR9KSxFKX1yZXR1cm4gZi5lZmZlY3QuaXNSZWFkeSgpfWdldERlcHRoTWFwKCl7cmV0dXJuIHRoaXMuX2RlcHRoTWFwfWRpc3Bvc2UoKXtjb25zdCBlPVtdO2Zvcihjb25zdCB0IGluIHRoaXMuX3NjZW5lLl9kZXB0aFJlbmRlcmVyKXRoaXMuX3NjZW5lLl9kZXB0aFJlbmRlcmVyW3RdPT09dGhpcyYmZS5wdXNoKHQpO2lmKGUubGVuZ3RoPjApe3RoaXMuX2RlcHRoTWFwLmRpc3Bvc2UoKTtmb3IoY29uc3QgdCBvZiBlKWRlbGV0ZSB0aGlzLl9zY2VuZS5fZGVwdGhSZW5kZXJlclt0XX19fWFzLl9TY2VuZUNvbXBvbmVudEluaXRpYWxpemF0aW9uPWM9Pnt0aHJvdyAkKCJEZXB0aFJlbmRlcmVyU2NlbmVDb21wb25lbnQiKX07Y29uc3QgUG89Im1pbm1heFJlZHV4UGl4ZWxTaGFkZXIiLERvPWB2YXJ5aW5nIHZlYzIgdlVWOwp1bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjsKI2lmIGRlZmluZWQoSU5JVElBTCkKdW5pZm9ybSBzYW1wbGVyMkQgc291cmNlVGV4dHVyZTsKdW5pZm9ybSB2ZWMyIHRleFNpemU7CnZvaWQgbWFpbih2b2lkKQp7Cml2ZWMyIGNvb3JkPWl2ZWMyKHZVVioodGV4U2l6ZS0xLjApKTsKZmxvYXQgZjE9dGV4ZWxGZXRjaChzb3VyY2VUZXh0dXJlLGNvb3JkLDApLnI7CmZsb2F0IGYyPXRleGVsRmV0Y2goc291cmNlVGV4dHVyZSxjb29yZCtpdmVjMigxLDApLDApLnI7CmZsb2F0IGYzPXRleGVsRmV0Y2goc291cmNlVGV4dHVyZSxjb29yZCtpdmVjMigxLDEpLDApLnI7CmZsb2F0IGY0PXRleGVsRmV0Y2goc291cmNlVGV4dHVyZSxjb29yZCtpdmVjMigwLDEpLDApLnI7CmZsb2F0IG1pbno9bWluKG1pbihtaW4oZjEsZjIpLGYzKSxmNCk7CiNpZmRlZiBERVBUSF9SRURVWApmbG9hdCBtYXh6PW1heChtYXgobWF4KHNpZ24oMS4wLWYxKSpmMSxzaWduKDEuMC1mMikqZjIpLHNpZ24oMS4wLWYzKSpmMyksc2lnbigxLjAtZjQpKmY0KTsKI2Vsc2UKZmxvYXQgbWF4ej1tYXgobWF4KG1heChmMSxmMiksZjMpLGY0KTsKI2VuZGlmCmdsRnJhZ0NvbG9yPXZlYzQobWlueixtYXh6LDAuLDAuKTsKfQojZWxpZiBkZWZpbmVkKE1BSU4pCnVuaWZvcm0gdmVjMiB0ZXhTaXplOwp2b2lkIG1haW4odm9pZCkKewppdmVjMiBjb29yZD1pdmVjMih2VVYqKHRleFNpemUtMS4wKSk7CnZlYzIgZjE9dGV4ZWxGZXRjaCh0ZXh0dXJlU2FtcGxlcixjb29yZCwwKS5yZzsKdmVjMiBmMj10ZXhlbEZldGNoKHRleHR1cmVTYW1wbGVyLGNvb3JkK2l2ZWMyKDEsMCksMCkucmc7CnZlYzIgZjM9dGV4ZWxGZXRjaCh0ZXh0dXJlU2FtcGxlcixjb29yZCtpdmVjMigxLDEpLDApLnJnOwp2ZWMyIGY0PXRleGVsRmV0Y2godGV4dHVyZVNhbXBsZXIsY29vcmQraXZlYzIoMCwxKSwwKS5yZzsKZmxvYXQgbWluej1taW4obWluKG1pbihmMS54LGYyLngpLGYzLngpLGY0LngpOwpmbG9hdCBtYXh6PW1heChtYXgobWF4KGYxLnksZjIueSksZjMueSksZjQueSk7CmdsRnJhZ0NvbG9yPXZlYzQobWlueixtYXh6LDAuLDAuKTsKfQojZWxpZiBkZWZpbmVkKE9ORUJFRk9SRUxBU1QpCnVuaWZvcm0gaXZlYzIgdGV4U2l6ZTsKdm9pZCBtYWluKHZvaWQpCnsKaXZlYzIgY29vcmQ9aXZlYzIodlVWKnZlYzIodGV4U2l6ZS0xKSk7CnZlYzIgZjE9dGV4ZWxGZXRjaCh0ZXh0dXJlU2FtcGxlcixjb29yZCAlIHRleFNpemUsMCkucmc7CnZlYzIgZjI9dGV4ZWxGZXRjaCh0ZXh0dXJlU2FtcGxlciwoY29vcmQraXZlYzIoMSwwKSkgJSB0ZXhTaXplLDApLnJnOwp2ZWMyIGYzPXRleGVsRmV0Y2godGV4dHVyZVNhbXBsZXIsKGNvb3JkK2l2ZWMyKDEsMSkpICUgdGV4U2l6ZSwwKS5yZzsKdmVjMiBmND10ZXhlbEZldGNoKHRleHR1cmVTYW1wbGVyLChjb29yZCtpdmVjMigwLDEpKSAlIHRleFNpemUsMCkucmc7CmZsb2F0IG1pbno9bWluKGYxLngsZjIueCk7CmZsb2F0IG1heHo9bWF4KGYxLnksZjIueSk7CmdsRnJhZ0NvbG9yPXZlYzQobWlueixtYXh6LDAuLDAuKTsKfQojZWxpZiBkZWZpbmVkKExBU1QpCnZvaWQgbWFpbih2b2lkKQp7CmdsRnJhZ0NvbG9yPXZlYzQoMC4pOwppZiAodHJ1ZSkgeyAKZGlzY2FyZDsKfQp9CiNlbmRpZgpgO1UuU2hhZGVyc1N0b3JlW1BvXT1EbztjbGFzcyBGb3tjb25zdHJ1Y3RvcihlKXt0aGlzLm9uQWZ0ZXJSZWR1Y3Rpb25QZXJmb3JtZWQ9bmV3IEYsdGhpcy5fZm9yY2VGdWxsc2NyZWVuVmlld3BvcnQ9ITAsdGhpcy5fYWN0aXZhdGVkPSExLHRoaXMuX2NhbWVyYT1lLHRoaXMuX3Bvc3RQcm9jZXNzTWFuYWdlcj1uZXcgUWkoZS5nZXRTY2VuZSgpKSx0aGlzLl9vbkNvbnRleHRSZXN0b3JlZE9ic2VydmVyPWUuZ2V0RW5naW5lKCkub25Db250ZXh0UmVzdG9yZWRPYnNlcnZhYmxlLmFkZCgoKT0+e3RoaXMuX3Bvc3RQcm9jZXNzTWFuYWdlci5fcmVidWlsZCgpfSl9Z2V0IHNvdXJjZVRleHR1cmUoKXtyZXR1cm4gdGhpcy5fc291cmNlVGV4dHVyZX1zZXRTb3VyY2VUZXh0dXJlKGUsdCxpPTIscz0hMCl7aWYoZT09PXRoaXMuX3NvdXJjZVRleHR1cmUpcmV0dXJuO3RoaXMuZGlzcG9zZSghMSksdGhpcy5fc291cmNlVGV4dHVyZT1lLHRoaXMuX3JlZHVjdGlvblN0ZXBzPVtdLHRoaXMuX2ZvcmNlRnVsbHNjcmVlblZpZXdwb3J0PXM7Y29uc3Qgcj10aGlzLl9jYW1lcmEuZ2V0U2NlbmUoKSxuPW5ldyBNZSgiSW5pdGlhbCByZWR1Y3Rpb24gcGhhc2UiLCJtaW5tYXhSZWR1eCIsWyJ0ZXhTaXplIl0sWyJzb3VyY2VUZXh0dXJlIl0sMSxudWxsLDEsci5nZXRFbmdpbmUoKSwhMSwiI2RlZmluZSBJTklUSUFMIisodD9gCiNkZWZpbmUgREVQVEhfUkVEVVhgOiIiKSxpLHZvaWQgMCx2b2lkIDAsdm9pZCAwLDcpO24uYXV0b0NsZWFyPSExLG4uZm9yY2VGdWxsc2NyZWVuVmlld3BvcnQ9cztsZXQgYT10aGlzLl9zb3VyY2VUZXh0dXJlLmdldFJlbmRlcldpZHRoKCksbz10aGlzLl9zb3VyY2VUZXh0dXJlLmdldFJlbmRlckhlaWdodCgpO24ub25BcHBseT0oKGwsdSk9PmQ9PntkLnNldFRleHR1cmUoInNvdXJjZVRleHR1cmUiLHRoaXMuX3NvdXJjZVRleHR1cmUpLGQuc2V0RmxvYXQyKCJ0ZXhTaXplIixsLHUpfSkoYSxvKSx0aGlzLl9yZWR1Y3Rpb25TdGVwcy5wdXNoKG4pO2xldCBoPTE7Zm9yKDthPjF8fG8+MTspe2E9TWF0aC5tYXgoTWF0aC5yb3VuZChhLzIpLDEpLG89TWF0aC5tYXgoTWF0aC5yb3VuZChvLzIpLDEpO2NvbnN0IGw9bmV3IE1lKCJSZWR1Y3Rpb24gcGhhc2UgIitoLCJtaW5tYXhSZWR1eCIsWyJ0ZXhTaXplIl0sbnVsbCx7d2lkdGg6YSxoZWlnaHQ6b30sbnVsbCwxLHIuZ2V0RW5naW5lKCksITEsIiNkZWZpbmUgIisoYT09MSYmbz09MT8iTEFTVCI6YT09MXx8bz09MT8iT05FQkVGT1JFTEFTVCI6Ik1BSU4iKSxpLHZvaWQgMCx2b2lkIDAsdm9pZCAwLDcpO2lmKGwuYXV0b0NsZWFyPSExLGwuZm9yY2VGdWxsc2NyZWVuVmlld3BvcnQ9cyxsLm9uQXBwbHk9KCh1LGQpPT5mPT57dT09MXx8ZD09MT9mLnNldEludDIoInRleFNpemUiLHUsZCk6Zi5zZXRGbG9hdDIoInRleFNpemUiLHUsZCl9KShhLG8pLHRoaXMuX3JlZHVjdGlvblN0ZXBzLnB1c2gobCksaCsrLGE9PTEmJm89PTEpe2NvbnN0IHU9KGQsZixfKT0+e2NvbnN0IEU9bmV3IEZsb2F0MzJBcnJheSg0KmQqZiksbT17bWluOjAsbWF4OjB9O3JldHVybigpPT57ci5nZXRFbmdpbmUoKS5fcmVhZFRleHR1cmVQaXhlbHMoXy5pbnB1dFRleHR1cmUudGV4dHVyZSxkLGYsLTEsMCxFLCExKSxtLm1pbj1FWzBdLG0ubWF4PUVbMV0sdGhpcy5vbkFmdGVyUmVkdWN0aW9uUGVyZm9ybWVkLm5vdGlmeU9ic2VydmVycyhtKX19O2wub25BZnRlclJlbmRlck9ic2VydmFibGUuYWRkKHUoYSxvLGwpKX19fWdldCByZWZyZXNoUmF0ZSgpe3JldHVybiB0aGlzLl9zb3VyY2VUZXh0dXJlP3RoaXMuX3NvdXJjZVRleHR1cmUucmVmcmVzaFJhdGU6LTF9c2V0IHJlZnJlc2hSYXRlKGUpe3RoaXMuX3NvdXJjZVRleHR1cmUmJih0aGlzLl9zb3VyY2VUZXh0dXJlLnJlZnJlc2hSYXRlPWUpfWdldCBhY3RpdmF0ZWQoKXtyZXR1cm4gdGhpcy5fYWN0aXZhdGVkfWFjdGl2YXRlKCl7dGhpcy5fb25BZnRlclVuYmluZE9ic2VydmVyfHwhdGhpcy5fc291cmNlVGV4dHVyZXx8KHRoaXMuX29uQWZ0ZXJVbmJpbmRPYnNlcnZlcj10aGlzLl9zb3VyY2VUZXh0dXJlLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLmFkZCgoKT0+e3ZhciBlLHQ7Y29uc3QgaT10aGlzLl9jYW1lcmEuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKTsoZT1pLl9kZWJ1Z1B1c2hHcm91cCk9PT1udWxsfHxlPT09dm9pZCAwfHxlLmNhbGwoaSwibWluIG1heCByZWR1Y3Rpb24iLDEpLHRoaXMuX3JlZHVjdGlvblN0ZXBzWzBdLmFjdGl2YXRlKHRoaXMuX2NhbWVyYSksdGhpcy5fcG9zdFByb2Nlc3NNYW5hZ2VyLmRpcmVjdFJlbmRlcih0aGlzLl9yZWR1Y3Rpb25TdGVwcyx0aGlzLl9yZWR1Y3Rpb25TdGVwc1swXS5pbnB1dFRleHR1cmUsdGhpcy5fZm9yY2VGdWxsc2NyZWVuVmlld3BvcnQpLGkudW5CaW5kRnJhbWVidWZmZXIodGhpcy5fcmVkdWN0aW9uU3RlcHNbMF0uaW5wdXRUZXh0dXJlLCExKSwodD1pLl9kZWJ1Z1BvcEdyb3VwKT09PW51bGx8fHQ9PT12b2lkIDB8fHQuY2FsbChpLDEpfSksdGhpcy5fYWN0aXZhdGVkPSEwKX1kZWFjdGl2YXRlKCl7IXRoaXMuX29uQWZ0ZXJVbmJpbmRPYnNlcnZlcnx8IXRoaXMuX3NvdXJjZVRleHR1cmV8fCh0aGlzLl9zb3VyY2VUZXh0dXJlLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkFmdGVyVW5iaW5kT2JzZXJ2ZXIpLHRoaXMuX29uQWZ0ZXJVbmJpbmRPYnNlcnZlcj1udWxsLHRoaXMuX2FjdGl2YXRlZD0hMSl9ZGlzcG9zZShlPSEwKXtpZihlJiYodGhpcy5vbkFmdGVyUmVkdWN0aW9uUGVyZm9ybWVkLmNsZWFyKCksdGhpcy5fb25Db250ZXh0UmVzdG9yZWRPYnNlcnZlciYmKHRoaXMuX2NhbWVyYS5nZXRFbmdpbmUoKS5vbkNvbnRleHRSZXN0b3JlZE9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXIpLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXI9bnVsbCkpLHRoaXMuZGVhY3RpdmF0ZSgpLHRoaXMuX3JlZHVjdGlvblN0ZXBzKXtmb3IobGV0IHQ9MDt0PHRoaXMuX3JlZHVjdGlvblN0ZXBzLmxlbmd0aDsrK3QpdGhpcy5fcmVkdWN0aW9uU3RlcHNbdF0uZGlzcG9zZSgpO3RoaXMuX3JlZHVjdGlvblN0ZXBzPW51bGx9dGhpcy5fcG9zdFByb2Nlc3NNYW5hZ2VyJiZlJiZ0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIuZGlzcG9zZSgpLHRoaXMuX3NvdXJjZVRleHR1cmU9bnVsbH19Y2xhc3Mgd28gZXh0ZW5kcyBGb3tjb25zdHJ1Y3RvcihlKXtzdXBlcihlKX1nZXQgZGVwdGhSZW5kZXJlcigpe3JldHVybiB0aGlzLl9kZXB0aFJlbmRlcmVyfXNldERlcHRoUmVuZGVyZXIoZT1udWxsLHQ9MixpPSEwKXtjb25zdCBzPXRoaXMuX2NhbWVyYS5nZXRTY2VuZSgpO3RoaXMuX2RlcHRoUmVuZGVyZXImJihkZWxldGUgcy5fZGVwdGhSZW5kZXJlclt0aGlzLl9kZXB0aFJlbmRlcmVySWRdLHRoaXMuX2RlcHRoUmVuZGVyZXIuZGlzcG9zZSgpLHRoaXMuX2RlcHRoUmVuZGVyZXI9bnVsbCksZT09PW51bGwmJihzLl9kZXB0aFJlbmRlcmVyfHwocy5fZGVwdGhSZW5kZXJlcj17fSksZT10aGlzLl9kZXB0aFJlbmRlcmVyPW5ldyBhcyhzLHQsdGhpcy5fY2FtZXJhLCExLDEpLGUuZW5hYmxlZD0hMSx0aGlzLl9kZXB0aFJlbmRlcmVySWQ9Im1pbm1heCIrdGhpcy5fY2FtZXJhLmlkLHMuX2RlcHRoUmVuZGVyZXJbdGhpcy5fZGVwdGhSZW5kZXJlcklkXT1lKSxzdXBlci5zZXRTb3VyY2VUZXh0dXJlKGUuZ2V0RGVwdGhNYXAoKSwhMCx0LGkpfXNldFNvdXJjZVRleHR1cmUoZSx0LGk9MixzPSEwKXtzdXBlci5zZXRTb3VyY2VUZXh0dXJlKGUsdCxpLHMpfWFjdGl2YXRlKCl7dGhpcy5fZGVwdGhSZW5kZXJlciYmKHRoaXMuX2RlcHRoUmVuZGVyZXIuZW5hYmxlZD0hMCksc3VwZXIuYWN0aXZhdGUoKX1kZWFjdGl2YXRlKCl7c3VwZXIuZGVhY3RpdmF0ZSgpLHRoaXMuX2RlcHRoUmVuZGVyZXImJih0aGlzLl9kZXB0aFJlbmRlcmVyLmVuYWJsZWQ9ITEpfWRpc3Bvc2UoZT0hMCl7aWYoc3VwZXIuZGlzcG9zZShlKSx0aGlzLl9kZXB0aFJlbmRlcmVyJiZlKXtjb25zdCB0PXRoaXMuX2RlcHRoUmVuZGVyZXIuZ2V0RGVwdGhNYXAoKS5nZXRTY2VuZSgpO3QmJmRlbGV0ZSB0Ll9kZXB0aFJlbmRlcmVyW3RoaXMuX2RlcHRoUmVuZGVyZXJJZF0sdGhpcy5fZGVwdGhSZW5kZXJlci5kaXNwb3NlKCksdGhpcy5fZGVwdGhSZW5kZXJlcj1udWxsfX19Y29uc3QgTnI9cC5VcCgpLE9vPXAuWmVybygpLExlPW5ldyBwLHhpPW5ldyBwLG9zPW5ldyB4O2NsYXNzIGtlIGV4dGVuZHMgR3tjb25zdHJ1Y3RvcihlLHQsaSxzKXtpZigha2UuSXNTdXBwb3J0ZWQpe08uRXJyb3IoIkNhc2NhZGVkU2hhZG93TWFwIGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhlIGN1cnJlbnQgZW5naW5lLiIpO3JldHVybn1zdXBlcihlLHQsaSxzKSx0aGlzLnVzZVBlcmNlbnRhZ2VDbG9zZXJGaWx0ZXJpbmc9ITB9X3ZhbGlkYXRlRmlsdGVyKGUpe3JldHVybiBlPT09Ry5GSUxURVJfTk9ORXx8ZT09PUcuRklMVEVSX1BDRnx8ZT09PUcuRklMVEVSX1BDU1M/ZTooY29uc29sZS5lcnJvcignVW5zdXBwb3J0ZWQgZmlsdGVyICInK2UrJyIhJyksRy5GSUxURVJfTk9ORSl9Z2V0IG51bUNhc2NhZGVzKCl7cmV0dXJuIHRoaXMuX251bUNhc2NhZGVzfXNldCBudW1DYXNjYWRlcyhlKXtlPU1hdGgubWluKE1hdGgubWF4KGUsa2UuTUlOX0NBU0NBREVTX0NPVU5UKSxrZS5NQVhfQ0FTQ0FERVNfQ09VTlQpLGUhPT10aGlzLl9udW1DYXNjYWRlcyYmKHRoaXMuX251bUNhc2NhZGVzPWUsdGhpcy5yZWNyZWF0ZVNoYWRvd01hcCgpLHRoaXMuX3JlY3JlYXRlU2NlbmVVQk9zKCkpfWdldCBmcmVlemVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvKCl7cmV0dXJuIHRoaXMuX2ZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm99c2V0IGZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm8oZSl7dGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGUmJmUmJih0aGlzLl9zY2VuZS5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX2ZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm9PYnNlcnZhYmxlKSx0aGlzLl9mcmVlemVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvT2JzZXJ2YWJsZT1udWxsKSwhdGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGUmJiFlJiYodGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGU9dGhpcy5fc2NlbmUub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmFkZCh0aGlzLl9jb21wdXRlU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mby5iaW5kKHRoaXMpKSksdGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbz1lLGUmJnRoaXMuX2NvbXB1dGVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvKCl9X2NvbXB1dGVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvKCl7aWYodGhpcy5fc2NiaU1pbi5jb3B5RnJvbUZsb2F0cyhOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSksdGhpcy5fc2NiaU1heC5jb3B5RnJvbUZsb2F0cyhOdW1iZXIuTUlOX1ZBTFVFLE51bWJlci5NSU5fVkFMVUUsTnVtYmVyLk1JTl9WQUxVRSksdGhpcy5fc2hhZG93TWFwJiZ0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdCl7Y29uc3QgZT10aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdDtmb3IobGV0IGk9MDtpPGUubGVuZ3RoO2krKyl7Y29uc3Qgcz1lW2ldO2lmKCFzKWNvbnRpbnVlO2NvbnN0IHI9cy5nZXRCb3VuZGluZ0luZm8oKSxuPXIuYm91bmRpbmdCb3g7dGhpcy5fc2NiaU1pbi5taW5pbWl6ZUluUGxhY2Uobi5taW5pbXVtV29ybGQpLHRoaXMuX3NjYmlNYXgubWF4aW1pemVJblBsYWNlKG4ubWF4aW11bVdvcmxkKX1jb25zdCB0PXRoaXMuX3NjZW5lLm1lc2hlcztmb3IobGV0IGk9MDtpPHQubGVuZ3RoO2krKyl7Y29uc3Qgcz10W2ldO2lmKCFzfHwhcy5pc1Zpc2libGV8fCFzLmlzRW5hYmxlZHx8IXMucmVjZWl2ZVNoYWRvd3MpY29udGludWU7Y29uc3Qgcj1zLmdldEJvdW5kaW5nSW5mbygpLG49ci5ib3VuZGluZ0JveDt0aGlzLl9zY2JpTWluLm1pbmltaXplSW5QbGFjZShuLm1pbmltdW1Xb3JsZCksdGhpcy5fc2NiaU1heC5tYXhpbWl6ZUluUGxhY2Uobi5tYXhpbXVtV29ybGQpfX10aGlzLl9zaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvLnJlQ29uc3RydWN0KHRoaXMuX3NjYmlNaW4sdGhpcy5fc2NiaU1heCl9Z2V0IHNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm8oKXtyZXR1cm4gdGhpcy5fc2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb31zZXQgc2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbyhlKXt0aGlzLl9zaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvPWV9c2V0TWluTWF4RGlzdGFuY2UoZSx0KXt0aGlzLl9taW5EaXN0YW5jZT09PWUmJnRoaXMuX21heERpc3RhbmNlPT09dHx8KGU+dCYmKGU9MCx0PTEpLGU8MCYmKGU9MCksdD4xJiYodD0xKSx0aGlzLl9taW5EaXN0YW5jZT1lLHRoaXMuX21heERpc3RhbmNlPXQsdGhpcy5fYnJlYWtzQXJlRGlydHk9ITApfWdldCBtaW5EaXN0YW5jZSgpe3JldHVybiB0aGlzLl9taW5EaXN0YW5jZX1nZXQgbWF4RGlzdGFuY2UoKXtyZXR1cm4gdGhpcy5fbWF4RGlzdGFuY2V9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIGtlLkNMQVNTTkFNRX1nZXRDYXNjYWRlTWluRXh0ZW50cyhlKXtyZXR1cm4gZT49MCYmZTx0aGlzLl9udW1DYXNjYWRlcz90aGlzLl9jYXNjYWRlTWluRXh0ZW50c1tlXTpudWxsfWdldENhc2NhZGVNYXhFeHRlbnRzKGUpe3JldHVybiBlPj0wJiZlPHRoaXMuX251bUNhc2NhZGVzP3RoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW2VdOm51bGx9Z2V0IHNoYWRvd01heFooKXtyZXR1cm4gdGhpcy5fZ2V0Q2FtZXJhKCk/dGhpcy5fc2hhZG93TWF4WjowfXNldCBzaGFkb3dNYXhaKGUpe2NvbnN0IHQ9dGhpcy5fZ2V0Q2FtZXJhKCk7aWYoIXQpe3RoaXMuX3NoYWRvd01heFo9ZTtyZXR1cm59dGhpcy5fc2hhZG93TWF4Wj09PWV8fGU8dC5taW5afHxlPnQubWF4Wnx8KHRoaXMuX3NoYWRvd01heFo9ZSx0aGlzLl9saWdodC5fbWFya01lc2hlc0FzTGlnaHREaXJ0eSgpLHRoaXMuX2JyZWFrc0FyZURpcnR5PSEwKX1nZXQgZGVidWcoKXtyZXR1cm4gdGhpcy5fZGVidWd9c2V0IGRlYnVnKGUpe3RoaXMuX2RlYnVnPWUsdGhpcy5fbGlnaHQuX21hcmtNZXNoZXNBc0xpZ2h0RGlydHkoKX1nZXQgZGVwdGhDbGFtcCgpe3JldHVybiB0aGlzLl9kZXB0aENsYW1wfXNldCBkZXB0aENsYW1wKGUpe3RoaXMuX2RlcHRoQ2xhbXA9ZX1nZXQgY2FzY2FkZUJsZW5kUGVyY2VudGFnZSgpe3JldHVybiB0aGlzLl9jYXNjYWRlQmxlbmRQZXJjZW50YWdlfXNldCBjYXNjYWRlQmxlbmRQZXJjZW50YWdlKGUpe3RoaXMuX2Nhc2NhZGVCbGVuZFBlcmNlbnRhZ2U9ZSx0aGlzLl9saWdodC5fbWFya01lc2hlc0FzTGlnaHREaXJ0eSgpfWdldCBsYW1iZGEoKXtyZXR1cm4gdGhpcy5fbGFtYmRhfXNldCBsYW1iZGEoZSl7Y29uc3QgdD1NYXRoLm1pbihNYXRoLm1heChlLDApLDEpO3RoaXMuX2xhbWJkYSE9dCYmKHRoaXMuX2xhbWJkYT10LHRoaXMuX2JyZWFrc0FyZURpcnR5PSEwKX1nZXRDYXNjYWRlVmlld01hdHJpeChlKXtyZXR1cm4gZT49MCYmZTx0aGlzLl9udW1DYXNjYWRlcz90aGlzLl92aWV3TWF0cmljZXNbZV06bnVsbH1nZXRDYXNjYWRlUHJvamVjdGlvbk1hdHJpeChlKXtyZXR1cm4gZT49MCYmZTx0aGlzLl9udW1DYXNjYWRlcz90aGlzLl9wcm9qZWN0aW9uTWF0cmljZXNbZV06bnVsbH1nZXRDYXNjYWRlVHJhbnNmb3JtTWF0cml4KGUpe3JldHVybiBlPj0wJiZlPHRoaXMuX251bUNhc2NhZGVzP3RoaXMuX3RyYW5zZm9ybU1hdHJpY2VzW2VdOm51bGx9c2V0RGVwdGhSZW5kZXJlcihlKXt0aGlzLl9kZXB0aFJlbmRlcmVyPWUsdGhpcy5fZGVwdGhSZWR1Y2VyJiZ0aGlzLl9kZXB0aFJlZHVjZXIuc2V0RGVwdGhSZW5kZXJlcih0aGlzLl9kZXB0aFJlbmRlcmVyKX1nZXQgYXV0b0NhbGNEZXB0aEJvdW5kcygpe3JldHVybiB0aGlzLl9hdXRvQ2FsY0RlcHRoQm91bmRzfXNldCBhdXRvQ2FsY0RlcHRoQm91bmRzKGUpe2NvbnN0IHQ9dGhpcy5fZ2V0Q2FtZXJhKCk7aWYodCl7aWYodGhpcy5fYXV0b0NhbGNEZXB0aEJvdW5kcz1lLCFlKXt0aGlzLl9kZXB0aFJlZHVjZXImJnRoaXMuX2RlcHRoUmVkdWNlci5kZWFjdGl2YXRlKCksdGhpcy5zZXRNaW5NYXhEaXN0YW5jZSgwLDEpO3JldHVybn10aGlzLl9kZXB0aFJlZHVjZXJ8fCh0aGlzLl9kZXB0aFJlZHVjZXI9bmV3IHdvKHQpLHRoaXMuX2RlcHRoUmVkdWNlci5vbkFmdGVyUmVkdWN0aW9uUGVyZm9ybWVkLmFkZChpPT57bGV0IHM9aS5taW4scj1pLm1heDtzPj1yJiYocz0wLHI9MSksKHMhPXRoaXMuX21pbkRpc3RhbmNlfHxyIT10aGlzLl9tYXhEaXN0YW5jZSkmJnRoaXMuc2V0TWluTWF4RGlzdGFuY2UocyxyKX0pLHRoaXMuX2RlcHRoUmVkdWNlci5zZXREZXB0aFJlbmRlcmVyKHRoaXMuX2RlcHRoUmVuZGVyZXIpKSx0aGlzLl9kZXB0aFJlZHVjZXIuYWN0aXZhdGUoKX19Z2V0IGF1dG9DYWxjRGVwdGhCb3VuZHNSZWZyZXNoUmF0ZSgpe3ZhciBlLHQsaTtyZXR1cm4oaT0odD0oZT10aGlzLl9kZXB0aFJlZHVjZXIpPT09bnVsbHx8ZT09PXZvaWQgMD92b2lkIDA6ZS5kZXB0aFJlbmRlcmVyKT09PW51bGx8fHQ9PT12b2lkIDA/dm9pZCAwOnQuZ2V0RGVwdGhNYXAoKS5yZWZyZXNoUmF0ZSkhPT1udWxsJiZpIT09dm9pZCAwP2k6LTF9c2V0IGF1dG9DYWxjRGVwdGhCb3VuZHNSZWZyZXNoUmF0ZShlKXt2YXIgdDshKCh0PXRoaXMuX2RlcHRoUmVkdWNlcik9PT1udWxsfHx0PT09dm9pZCAwKSYmdC5kZXB0aFJlbmRlcmVyJiYodGhpcy5fZGVwdGhSZWR1Y2VyLmRlcHRoUmVuZGVyZXIuZ2V0RGVwdGhNYXAoKS5yZWZyZXNoUmF0ZT1lKX1zcGxpdEZydXN0dW0oKXt0aGlzLl9icmVha3NBcmVEaXJ0eT0hMH1fc3BsaXRGcnVzdHVtKCl7Y29uc3QgZT10aGlzLl9nZXRDYW1lcmEoKTtpZighZSlyZXR1cm47Y29uc3QgdD1lLm1pblosaT1lLm1heFoscz1pLXQscj10aGlzLl9taW5EaXN0YW5jZSxuPXRoaXMuX3NoYWRvd01heFo8aSYmdGhpcy5fc2hhZG93TWF4Wj49dD9NYXRoLm1pbigodGhpcy5fc2hhZG93TWF4Wi10KS8oaS10KSx0aGlzLl9tYXhEaXN0YW5jZSk6dGhpcy5fbWF4RGlzdGFuY2UsYT10K3IqcyxvPXQrbipzLGg9by1hLGw9by9hO2ZvcihsZXQgdT0wO3U8dGhpcy5fY2FzY2FkZXMubGVuZ3RoOysrdSl7Y29uc3QgZD0odSsxKS90aGlzLl9udW1DYXNjYWRlcyxmPWEqbCoqZCxfPWEraCpkLEU9dGhpcy5fbGFtYmRhKihmLV8pK187dGhpcy5fY2FzY2FkZXNbdV0ucHJldkJyZWFrRGlzdGFuY2U9dT09PTA/cjp0aGlzLl9jYXNjYWRlc1t1LTFdLmJyZWFrRGlzdGFuY2UsdGhpcy5fY2FzY2FkZXNbdV0uYnJlYWtEaXN0YW5jZT0oRS10KS9zLHRoaXMuX3ZpZXdTcGFjZUZydXN0dW1zWlt1XT1FLHRoaXMuX2ZydXN0dW1MZW5ndGhzW3VdPSh0aGlzLl9jYXNjYWRlc1t1XS5icmVha0Rpc3RhbmNlLXRoaXMuX2Nhc2NhZGVzW3VdLnByZXZCcmVha0Rpc3RhbmNlKSpzfXRoaXMuX2JyZWFrc0FyZURpcnR5PSExfV9jb21wdXRlTWF0cmljZXMoKXtjb25zdCBlPXRoaXMuX3NjZW5lO2lmKCF0aGlzLl9nZXRDYW1lcmEoKSlyZXR1cm47cC5Ob3JtYWxpemVUb1JlZih0aGlzLl9saWdodC5nZXRTaGFkb3dEaXJlY3Rpb24oMCksdGhpcy5fbGlnaHREaXJlY3Rpb24pLE1hdGguYWJzKHAuRG90KHRoaXMuX2xpZ2h0RGlyZWN0aW9uLHAuVXAoKSkpPT09MSYmKHRoaXMuX2xpZ2h0RGlyZWN0aW9uLno9MWUtMTMpLHRoaXMuX2NhY2hlZERpcmVjdGlvbi5jb3B5RnJvbSh0aGlzLl9saWdodERpcmVjdGlvbik7Y29uc3QgaT1lLmdldEVuZ2luZSgpLnVzZVJldmVyc2VEZXB0aEJ1ZmZlcjtmb3IobGV0IHM9MDtzPHRoaXMuX251bUNhc2NhZGVzOysrcyl7dGhpcy5fY29tcHV0ZUZydXN0dW1JbldvcmxkU3BhY2UocyksdGhpcy5fY29tcHV0ZUNhc2NhZGVGcnVzdHVtKHMpLHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW3NdLnN1YnRyYWN0VG9SZWYodGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbc10sTGUpLHRoaXMuX2ZydXN0dW1DZW50ZXJbc10uYWRkVG9SZWYodGhpcy5fbGlnaHREaXJlY3Rpb24uc2NhbGUodGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbc10ueiksdGhpcy5fc2hhZG93Q2FtZXJhUG9zW3NdKSx4Lkxvb2tBdExIVG9SZWYodGhpcy5fc2hhZG93Q2FtZXJhUG9zW3NdLHRoaXMuX2ZydXN0dW1DZW50ZXJbc10sTnIsdGhpcy5fdmlld01hdHJpY2VzW3NdKTtsZXQgcj0wLG49TGUuejtjb25zdCBhPXRoaXMuX3NoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm87YS51cGRhdGUodGhpcy5fdmlld01hdHJpY2VzW3NdKSxuPU1hdGgubWluKG4sYS5ib3VuZGluZ0JveC5tYXhpbXVtV29ybGQueiksIXRoaXMuX2RlcHRoQ2xhbXB8fHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfUENTUz9yPU1hdGgubWluKHIsYS5ib3VuZGluZ0JveC5taW5pbXVtV29ybGQueik6cj1NYXRoLm1heChyLGEuYm91bmRpbmdCb3gubWluaW11bVdvcmxkLnopLHguT3J0aG9PZmZDZW50ZXJMSFRvUmVmKHRoaXMuX2Nhc2NhZGVNaW5FeHRlbnRzW3NdLngsdGhpcy5fY2FzY2FkZU1heEV4dGVudHNbc10ueCx0aGlzLl9jYXNjYWRlTWluRXh0ZW50c1tzXS55LHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW3NdLnksaT9uOnIsaT9yOm4sdGhpcy5fcHJvamVjdGlvbk1hdHJpY2VzW3NdLGUuZ2V0RW5naW5lKCkuaXNORENIYWxmWlJhbmdlKSx0aGlzLl9jYXNjYWRlTWluRXh0ZW50c1tzXS56PXIsdGhpcy5fY2FzY2FkZU1heEV4dGVudHNbc10uej1uLHRoaXMuX3ZpZXdNYXRyaWNlc1tzXS5tdWx0aXBseVRvUmVmKHRoaXMuX3Byb2plY3Rpb25NYXRyaWNlc1tzXSx0aGlzLl90cmFuc2Zvcm1NYXRyaWNlc1tzXSkscC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKE9vLHRoaXMuX3RyYW5zZm9ybU1hdHJpY2VzW3NdLExlKSxMZS5zY2FsZUluUGxhY2UodGhpcy5fbWFwU2l6ZS8yKSx4aS5jb3B5RnJvbUZsb2F0cyhNYXRoLnJvdW5kKExlLngpLE1hdGgucm91bmQoTGUueSksTWF0aC5yb3VuZChMZS56KSkseGkuc3VidHJhY3RJblBsYWNlKExlKS5zY2FsZUluUGxhY2UoMi90aGlzLl9tYXBTaXplKSx4LlRyYW5zbGF0aW9uVG9SZWYoeGkueCx4aS55LDAsb3MpLHRoaXMuX3Byb2plY3Rpb25NYXRyaWNlc1tzXS5tdWx0aXBseVRvUmVmKG9zLHRoaXMuX3Byb2plY3Rpb25NYXRyaWNlc1tzXSksdGhpcy5fdmlld01hdHJpY2VzW3NdLm11bHRpcGx5VG9SZWYodGhpcy5fcHJvamVjdGlvbk1hdHJpY2VzW3NdLHRoaXMuX3RyYW5zZm9ybU1hdHJpY2VzW3NdKSx0aGlzLl90cmFuc2Zvcm1NYXRyaWNlc1tzXS5jb3B5VG9BcnJheSh0aGlzLl90cmFuc2Zvcm1NYXRyaWNlc0FzQXJyYXkscyoxNil9fV9jb21wdXRlRnJ1c3R1bUluV29ybGRTcGFjZShlKXtjb25zdCB0PXRoaXMuX2dldENhbWVyYSgpO2lmKCF0KXJldHVybjtjb25zdCBpPXRoaXMuX2Nhc2NhZGVzW2VdLnByZXZCcmVha0Rpc3RhbmNlLHM9dGhpcy5fY2FzY2FkZXNbZV0uYnJlYWtEaXN0YW5jZSxyPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLmlzTkRDSGFsZlpSYW5nZTt0LmdldFZpZXdNYXRyaXgoKTtjb25zdCBuPXguSW52ZXJ0KHQuZ2V0VHJhbnNmb3JtYXRpb25NYXRyaXgoKSksYT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS51c2VSZXZlcnNlRGVwdGhCdWZmZXI/NDowO2ZvcihsZXQgbz0wO288a2UuX0ZydXN0dW1Db3JuZXJzTkRDU3BhY2UubGVuZ3RoOysrbylMZS5jb3B5RnJvbShrZS5fRnJ1c3R1bUNvcm5lcnNORENTcGFjZVsobythKSVrZS5fRnJ1c3R1bUNvcm5lcnNORENTcGFjZS5sZW5ndGhdKSxyJiZMZS56PT09LTEmJihMZS56PTApLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZihMZSxuLHRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVtlXVtvXSk7Zm9yKGxldCBvPTA7bzxrZS5fRnJ1c3R1bUNvcm5lcnNORENTcGFjZS5sZW5ndGgvMjsrK28pTGUuY29weUZyb20odGhpcy5fZnJ1c3R1bUNvcm5lcnNXb3JsZFNwYWNlW2VdW28rNF0pLnN1YnRyYWN0SW5QbGFjZSh0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2VbZV1bb10pLHhpLmNvcHlGcm9tKExlKS5zY2FsZUluUGxhY2UoaSksTGUuc2NhbGVJblBsYWNlKHMpLExlLmFkZEluUGxhY2UodGhpcy5fZnJ1c3R1bUNvcm5lcnNXb3JsZFNwYWNlW2VdW29dKSx0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2VbZV1bbys0XS5jb3B5RnJvbShMZSksdGhpcy5fZnJ1c3R1bUNvcm5lcnNXb3JsZFNwYWNlW2VdW29dLmFkZEluUGxhY2UoeGkpfV9jb21wdXRlQ2FzY2FkZUZydXN0dW0oZSl7aWYodGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbZV0uY29weUZyb21GbG9hdHMoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW2VdLmNvcHlGcm9tRmxvYXRzKE51bWJlci5NSU5fVkFMVUUsTnVtYmVyLk1JTl9WQUxVRSxOdW1iZXIuTUlOX1ZBTFVFKSx0aGlzLl9mcnVzdHVtQ2VudGVyW2VdLmNvcHlGcm9tRmxvYXRzKDAsMCwwKSwhIXRoaXMuX2dldENhbWVyYSgpKXtmb3IobGV0IGk9MDtpPHRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVtlXS5sZW5ndGg7KytpKXRoaXMuX2ZydXN0dW1DZW50ZXJbZV0uYWRkSW5QbGFjZSh0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2VbZV1baV0pO2lmKHRoaXMuX2ZydXN0dW1DZW50ZXJbZV0uc2NhbGVJblBsYWNlKDEvdGhpcy5fZnJ1c3R1bUNvcm5lcnNXb3JsZFNwYWNlW2VdLmxlbmd0aCksdGhpcy5zdGFiaWxpemVDYXNjYWRlcyl7bGV0IGk9MDtmb3IobGV0IHM9MDtzPHRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVtlXS5sZW5ndGg7KytzKXtjb25zdCByPXRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVtlXVtzXS5zdWJ0cmFjdFRvUmVmKHRoaXMuX2ZydXN0dW1DZW50ZXJbZV0sTGUpLmxlbmd0aCgpO2k9TWF0aC5tYXgoaSxyKX1pPU1hdGguY2VpbChpKjE2KS8xNix0aGlzLl9jYXNjYWRlTWF4RXh0ZW50c1tlXS5jb3B5RnJvbUZsb2F0cyhpLGksaSksdGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbZV0uY29weUZyb21GbG9hdHMoLWksLWksLWkpfWVsc2V7Y29uc3QgaT10aGlzLl9mcnVzdHVtQ2VudGVyW2VdO3RoaXMuX2ZydXN0dW1DZW50ZXJbZV0uYWRkVG9SZWYodGhpcy5fbGlnaHREaXJlY3Rpb24sTGUpLHguTG9va0F0TEhUb1JlZihpLExlLE5yLG9zKTtmb3IobGV0IHM9MDtzPHRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVtlXS5sZW5ndGg7KytzKXAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZih0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2VbZV1bc10sb3MsTGUpLHRoaXMuX2Nhc2NhZGVNaW5FeHRlbnRzW2VdLm1pbmltaXplSW5QbGFjZShMZSksdGhpcy5fY2FzY2FkZU1heEV4dGVudHNbZV0ubWF4aW1pemVJblBsYWNlKExlKX19fV9yZWNyZWF0ZVNjZW5lVUJPcygpe2lmKHRoaXMuX2Rpc3Bvc2VTY2VuZVVCT3MoKSx0aGlzLl9zY2VuZVVCT3MpZm9yKGxldCBlPTA7ZTx0aGlzLl9udW1DYXNjYWRlczsrK2UpdGhpcy5fc2NlbmVVQk9zLnB1c2godGhpcy5fc2NlbmUuY3JlYXRlU2NlbmVVbmlmb3JtQnVmZmVyKGBTY2VuZSBmb3IgQ1NNIFNoYWRvdyBHZW5lcmF0b3IgKGxpZ2h0ICIke3RoaXMuX2xpZ2h0Lm5hbWV9IiBjYXNjYWRlICMke2V9KWApKX1zdGF0aWMgZ2V0IElzU3VwcG9ydGVkKCl7Y29uc3QgZT1mZS5MYXN0Q3JlYXRlZEVuZ2luZTtyZXR1cm4gZT9lLl9mZWF0dXJlcy5zdXBwb3J0Q1NNOiExfV9pbml0aWFsaXplR2VuZXJhdG9yKCl7dmFyIGUsdCxpLHMscixuLGEsbyxoLGwsdSxkLGYsXyxFLG0sdixTLHksQTt0aGlzLnBlbnVtYnJhRGFya25lc3M9KGU9dGhpcy5wZW51bWJyYURhcmtuZXNzKSE9PW51bGwmJmUhPT12b2lkIDA/ZToxLHRoaXMuX251bUNhc2NhZGVzPSh0PXRoaXMuX251bUNhc2NhZGVzKSE9PW51bGwmJnQhPT12b2lkIDA/dDprZS5ERUZBVUxUX0NBU0NBREVTX0NPVU5ULHRoaXMuc3RhYmlsaXplQ2FzY2FkZXM9KGk9dGhpcy5zdGFiaWxpemVDYXNjYWRlcykhPT1udWxsJiZpIT09dm9pZCAwP2k6ITEsdGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGU9KHM9dGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGUpIT09bnVsbCYmcyE9PXZvaWQgMD9zOm51bGwsdGhpcy5mcmVlemVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvPShyPXRoaXMuZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbykhPT1udWxsJiZyIT09dm9pZCAwP3I6ITEsdGhpcy5fc2NiaU1pbj0obj10aGlzLl9zY2JpTWluKSE9PW51bGwmJm4hPT12b2lkIDA/bjpuZXcgcCgwLDAsMCksdGhpcy5fc2NiaU1heD0oYT10aGlzLl9zY2JpTWF4KSE9PW51bGwmJmEhPT12b2lkIDA/YTpuZXcgcCgwLDAsMCksdGhpcy5fc2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbz0obz10aGlzLl9zaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvKSE9PW51bGwmJm8hPT12b2lkIDA/bzpuZXcgZHQobmV3IHAoMCwwLDApLG5ldyBwKDAsMCwwKSksdGhpcy5fYnJlYWtzQXJlRGlydHk9KGg9dGhpcy5fYnJlYWtzQXJlRGlydHkpIT09bnVsbCYmaCE9PXZvaWQgMD9oOiEwLHRoaXMuX21pbkRpc3RhbmNlPShsPXRoaXMuX21pbkRpc3RhbmNlKSE9PW51bGwmJmwhPT12b2lkIDA/bDowLHRoaXMuX21heERpc3RhbmNlPSh1PXRoaXMuX21heERpc3RhbmNlKSE9PW51bGwmJnUhPT12b2lkIDA/dToxLHRoaXMuX2N1cnJlbnRMYXllcj0oZD10aGlzLl9jdXJyZW50TGF5ZXIpIT09bnVsbCYmZCE9PXZvaWQgMD9kOjAsdGhpcy5fc2hhZG93TWF4Wj0oRT0oZj10aGlzLl9zaGFkb3dNYXhaKSE9PW51bGwmJmYhPT12b2lkIDA/ZjooXz10aGlzLl9nZXRDYW1lcmEoKSk9PT1udWxsfHxfPT09dm9pZCAwP3ZvaWQgMDpfLm1heFopIT09bnVsbCYmRSE9PXZvaWQgMD9FOjFlNCx0aGlzLl9kZWJ1Zz0obT10aGlzLl9kZWJ1ZykhPT1udWxsJiZtIT09dm9pZCAwP206ITEsdGhpcy5fZGVwdGhDbGFtcD0odj10aGlzLl9kZXB0aENsYW1wKSE9PW51bGwmJnYhPT12b2lkIDA/djohMCx0aGlzLl9jYXNjYWRlQmxlbmRQZXJjZW50YWdlPShTPXRoaXMuX2Nhc2NhZGVCbGVuZFBlcmNlbnRhZ2UpIT09bnVsbCYmUyE9PXZvaWQgMD9TOi4xLHRoaXMuX2xhbWJkYT0oeT10aGlzLl9sYW1iZGEpIT09bnVsbCYmeSE9PXZvaWQgMD95Oi41LHRoaXMuX2F1dG9DYWxjRGVwdGhCb3VuZHM9KEE9dGhpcy5fYXV0b0NhbGNEZXB0aEJvdW5kcykhPT1udWxsJiZBIT09dm9pZCAwP0E6ITEsdGhpcy5fcmVjcmVhdGVTY2VuZVVCT3MoKSxzdXBlci5faW5pdGlhbGl6ZUdlbmVyYXRvcigpfV9jcmVhdGVUYXJnZXRSZW5kZXJUZXh0dXJlKCl7Y29uc3QgZT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSx0PXt3aWR0aDp0aGlzLl9tYXBTaXplLGhlaWdodDp0aGlzLl9tYXBTaXplLGxheWVyczp0aGlzLm51bUNhc2NhZGVzfTt0aGlzLl9zaGFkb3dNYXA9bmV3IF90KHRoaXMuX2xpZ2h0Lm5hbWUrIl9DU01TaGFkb3dNYXAiLHQsdGhpcy5fc2NlbmUsITEsITAsdGhpcy5fdGV4dHVyZVR5cGUsITEsdm9pZCAwLCExLCExLHZvaWQgMCksdGhpcy5fc2hhZG93TWFwLmNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmUoZS51c2VSZXZlcnNlRGVwdGhCdWZmZXI/NTE2OjUxMywhMCl9X2luaXRpYWxpemVTaGFkb3dNYXAoKXtpZihzdXBlci5faW5pdGlhbGl6ZVNoYWRvd01hcCgpLHRoaXMuX3NoYWRvd01hcD09PW51bGwpcmV0dXJuO3RoaXMuX3RyYW5zZm9ybU1hdHJpY2VzQXNBcnJheT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuX251bUNhc2NhZGVzKjE2KSx0aGlzLl92aWV3U3BhY2VGcnVzdHVtc1o9bmV3IEFycmF5KHRoaXMuX251bUNhc2NhZGVzKSx0aGlzLl9mcnVzdHVtTGVuZ3Rocz1uZXcgQXJyYXkodGhpcy5fbnVtQ2FzY2FkZXMpLHRoaXMuX2xpZ2h0U2l6ZVVWQ29ycmVjdGlvbj1uZXcgQXJyYXkodGhpcy5fbnVtQ2FzY2FkZXMqMiksdGhpcy5fZGVwdGhDb3JyZWN0aW9uPW5ldyBBcnJheSh0aGlzLl9udW1DYXNjYWRlcyksdGhpcy5fY2FzY2FkZXM9W10sdGhpcy5fdmlld01hdHJpY2VzPVtdLHRoaXMuX3Byb2plY3Rpb25NYXRyaWNlcz1bXSx0aGlzLl90cmFuc2Zvcm1NYXRyaWNlcz1bXSx0aGlzLl9jYXNjYWRlTWluRXh0ZW50cz1bXSx0aGlzLl9jYXNjYWRlTWF4RXh0ZW50cz1bXSx0aGlzLl9mcnVzdHVtQ2VudGVyPVtdLHRoaXMuX3NoYWRvd0NhbWVyYVBvcz1bXSx0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2U9W107Zm9yKGxldCB0PTA7dDx0aGlzLl9udW1DYXNjYWRlczsrK3Qpe3RoaXMuX2Nhc2NhZGVzW3RdPXtwcmV2QnJlYWtEaXN0YW5jZTowLGJyZWFrRGlzdGFuY2U6MH0sdGhpcy5fdmlld01hdHJpY2VzW3RdPXguWmVybygpLHRoaXMuX3Byb2plY3Rpb25NYXRyaWNlc1t0XT14Llplcm8oKSx0aGlzLl90cmFuc2Zvcm1NYXRyaWNlc1t0XT14Llplcm8oKSx0aGlzLl9jYXNjYWRlTWluRXh0ZW50c1t0XT1uZXcgcCx0aGlzLl9jYXNjYWRlTWF4RXh0ZW50c1t0XT1uZXcgcCx0aGlzLl9mcnVzdHVtQ2VudGVyW3RdPW5ldyBwLHRoaXMuX3NoYWRvd0NhbWVyYVBvc1t0XT1uZXcgcCx0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2VbdF09bmV3IEFycmF5KGtlLl9GcnVzdHVtQ29ybmVyc05EQ1NwYWNlLmxlbmd0aCk7Zm9yKGxldCBpPTA7aTxrZS5fRnJ1c3R1bUNvcm5lcnNORENTcGFjZS5sZW5ndGg7KytpKXRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVt0XVtpXT1uZXcgcH1jb25zdCBlPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3RoaXMuX3NoYWRvd01hcC5vbkJlZm9yZUJpbmRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5fc2hhZG93TWFwLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX3NoYWRvd01hcC5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKHQ9Pnt0aGlzLl9zY2VuZVVCT3MmJnRoaXMuX3NjZW5lLnNldFNjZW5lVW5pZm9ybUJ1ZmZlcih0aGlzLl9zY2VuZVVCT3NbdF0pLHRoaXMuX2N1cnJlbnRMYXllcj10LHRoaXMuX2ZpbHRlcj09PUcuRklMVEVSX1BDRiYmZS5zZXRDb2xvcldyaXRlKCExKSx0aGlzLl9zY2VuZS5zZXRUcmFuc2Zvcm1NYXRyaXgodGhpcy5nZXRDYXNjYWRlVmlld01hdHJpeCh0KSx0aGlzLmdldENhc2NhZGVQcm9qZWN0aW9uTWF0cml4KHQpKSx0aGlzLl91c2VVQk8mJih0aGlzLl9zY2VuZS5nZXRTY2VuZVVuaWZvcm1CdWZmZXIoKS51bmJpbmRFZmZlY3QoKSx0aGlzLl9zY2VuZS5maW5hbGl6ZVNjZW5lVWJvKCkpfSksdGhpcy5fc2hhZG93TWFwLm9uQmVmb3JlQmluZE9ic2VydmFibGUuYWRkKCgpPT57dmFyIHQ7dGhpcy5fY3VycmVudFNjZW5lVUJPPXRoaXMuX3NjZW5lLmdldFNjZW5lVW5pZm9ybUJ1ZmZlcigpLCh0PWUuX2RlYnVnUHVzaEdyb3VwKT09PW51bGx8fHQ9PT12b2lkIDB8fHQuY2FsbChlLGBjYXNjYWRlZCBzaGFkb3cgbWFwIGdlbmVyYXRpb24gZm9yIHBhc3MgaWQgJHtlLmN1cnJlbnRSZW5kZXJQYXNzSWR9YCwxKSx0aGlzLl9icmVha3NBcmVEaXJ0eSYmdGhpcy5fc3BsaXRGcnVzdHVtKCksdGhpcy5fY29tcHV0ZU1hdHJpY2VzKCl9KSx0aGlzLl9zcGxpdEZydXN0dW0oKX1fYmluZEN1c3RvbUVmZmVjdEZvclJlbmRlclN1Yk1lc2hGb3JTaGFkb3dNYXAoZSx0KXt0LnNldE1hdHJpeCgidmlld1Byb2plY3Rpb24iLHRoaXMuZ2V0Q2FzY2FkZVRyYW5zZm9ybU1hdHJpeCh0aGlzLl9jdXJyZW50TGF5ZXIpKX1faXNSZWFkeUN1c3RvbURlZmluZXMoZSl7ZS5wdXNoKCIjZGVmaW5lIFNNX0RFUFRIQ0xBTVAgIisodGhpcy5fZGVwdGhDbGFtcCYmdGhpcy5fZmlsdGVyIT09Ry5GSUxURVJfUENTUz8iMSI6IjAiKSl9cHJlcGFyZURlZmluZXMoZSx0KXtzdXBlci5wcmVwYXJlRGVmaW5lcyhlLHQpO2NvbnN0IGk9dGhpcy5fc2NlbmUscz10aGlzLl9saWdodDtpZighaS5zaGFkb3dzRW5hYmxlZHx8IXMuc2hhZG93RW5hYmxlZClyZXR1cm47ZVsiU0hBRE9XQ1NNIit0XT0hMCxlWyJTSEFET1dDU01ERUJVRyIrdF09dGhpcy5kZWJ1ZyxlWyJTSEFET1dDU01OVU1fQ0FTQ0FERVMiK3RdPXRoaXMubnVtQ2FzY2FkZXMsZVsiU0hBRE9XQ1NNX1JJR0hUSEFOREVEIit0XT1pLnVzZVJpZ2h0SGFuZGVkU3lzdGVtO2NvbnN0IHI9dGhpcy5fZ2V0Q2FtZXJhKCk7ciYmdGhpcy5fc2hhZG93TWF4WjxyLm1heFomJihlWyJTSEFET1dDU01VU0VTSEFET1dNQVhaIit0XT0hMCksdGhpcy5jYXNjYWRlQmxlbmRQZXJjZW50YWdlPT09MCYmKGVbIlNIQURPV0NTTU5PQkxFTkQiK3RdPSEwKX1iaW5kU2hhZG93TGlnaHQoZSx0KXtjb25zdCBpPXRoaXMuX2xpZ2h0O2lmKCF0aGlzLl9zY2VuZS5zaGFkb3dzRW5hYmxlZHx8IWkuc2hhZG93RW5hYmxlZClyZXR1cm47Y29uc3Qgcj10aGlzLl9nZXRDYW1lcmEoKTtpZighcilyZXR1cm47Y29uc3Qgbj10aGlzLmdldFNoYWRvd01hcCgpO2lmKCFuKXJldHVybjtjb25zdCBhPW4uZ2V0U2l6ZSgpLndpZHRoO2lmKHQuc2V0TWF0cmljZXMoImxpZ2h0TWF0cml4IitlLHRoaXMuX3RyYW5zZm9ybU1hdHJpY2VzQXNBcnJheSksdC5zZXRBcnJheSgidmlld0ZydXN0dW1aIitlLHRoaXMuX3ZpZXdTcGFjZUZydXN0dW1zWiksdC5zZXRGbG9hdCgiY2FzY2FkZUJsZW5kRmFjdG9yIitlLHRoaXMuY2FzY2FkZUJsZW5kUGVyY2VudGFnZT09PTA/MWU0OjEvdGhpcy5jYXNjYWRlQmxlbmRQZXJjZW50YWdlKSx0LnNldEFycmF5KCJmcnVzdHVtTGVuZ3RocyIrZSx0aGlzLl9mcnVzdHVtTGVuZ3RocyksdGhpcy5fZmlsdGVyPT09Ry5GSUxURVJfUENGKXQuc2V0RGVwdGhTdGVuY2lsVGV4dHVyZSgic2hhZG93U2FtcGxlciIrZSxuKSxpLl91bmlmb3JtQnVmZmVyLnVwZGF0ZUZsb2F0NCgic2hhZG93c0luZm8iLHRoaXMuZ2V0RGFya25lc3MoKSxhLDEvYSx0aGlzLmZydXN0dW1FZGdlRmFsbG9mZixlKTtlbHNlIGlmKHRoaXMuX2ZpbHRlcj09PUcuRklMVEVSX1BDU1Mpe2ZvcihsZXQgbz0wO288dGhpcy5fbnVtQ2FzY2FkZXM7KytvKXRoaXMuX2xpZ2h0U2l6ZVVWQ29ycmVjdGlvbltvKjIrMF09bz09PTA/MToodGhpcy5fY2FzY2FkZU1heEV4dGVudHNbMF0ueC10aGlzLl9jYXNjYWRlTWluRXh0ZW50c1swXS54KS8odGhpcy5fY2FzY2FkZU1heEV4dGVudHNbb10ueC10aGlzLl9jYXNjYWRlTWluRXh0ZW50c1tvXS54KSx0aGlzLl9saWdodFNpemVVVkNvcnJlY3Rpb25bbyoyKzFdPW89PT0wPzE6KHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzWzBdLnktdGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbMF0ueSkvKHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW29dLnktdGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbb10ueSksdGhpcy5fZGVwdGhDb3JyZWN0aW9uW29dPW89PT0wPzE6KHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW29dLnotdGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbb10ueikvKHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzWzBdLnotdGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbMF0ueik7dC5zZXREZXB0aFN0ZW5jaWxUZXh0dXJlKCJzaGFkb3dTYW1wbGVyIitlLG4pLHQuc2V0VGV4dHVyZSgiZGVwdGhTYW1wbGVyIitlLG4pLHQuc2V0QXJyYXkyKCJsaWdodFNpemVVVkNvcnJlY3Rpb24iK2UsdGhpcy5fbGlnaHRTaXplVVZDb3JyZWN0aW9uKSx0LnNldEFycmF5KCJkZXB0aENvcnJlY3Rpb24iK2UsdGhpcy5fZGVwdGhDb3JyZWN0aW9uKSx0LnNldEZsb2F0KCJwZW51bWJyYURhcmtuZXNzIitlLHRoaXMucGVudW1icmFEYXJrbmVzcyksaS5fdW5pZm9ybUJ1ZmZlci51cGRhdGVGbG9hdDQoInNoYWRvd3NJbmZvIix0aGlzLmdldERhcmtuZXNzKCksMS9hLHRoaXMuX2NvbnRhY3RIYXJkZW5pbmdMaWdodFNpemVVVlJhdGlvKmEsdGhpcy5mcnVzdHVtRWRnZUZhbGxvZmYsZSl9ZWxzZSB0LnNldFRleHR1cmUoInNoYWRvd1NhbXBsZXIiK2UsbiksaS5fdW5pZm9ybUJ1ZmZlci51cGRhdGVGbG9hdDQoInNoYWRvd3NJbmZvIix0aGlzLmdldERhcmtuZXNzKCksYSwxL2EsdGhpcy5mcnVzdHVtRWRnZUZhbGxvZmYsZSk7aS5fdW5pZm9ybUJ1ZmZlci51cGRhdGVGbG9hdDIoImRlcHRoVmFsdWVzIix0aGlzLmdldExpZ2h0KCkuZ2V0RGVwdGhNaW5aKHIpLHRoaXMuZ2V0TGlnaHQoKS5nZXREZXB0aE1pbloocikrdGhpcy5nZXRMaWdodCgpLmdldERlcHRoTWF4WihyKSxlKX1nZXRUcmFuc2Zvcm1NYXRyaXgoKXtyZXR1cm4gdGhpcy5nZXRDYXNjYWRlVHJhbnNmb3JtTWF0cml4KDApfWRpc3Bvc2UoKXtzdXBlci5kaXNwb3NlKCksdGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGUmJih0aGlzLl9zY2VuZS5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX2ZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm9PYnNlcnZhYmxlKSx0aGlzLl9mcmVlemVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvT2JzZXJ2YWJsZT1udWxsKSx0aGlzLl9kZXB0aFJlZHVjZXImJih0aGlzLl9kZXB0aFJlZHVjZXIuZGlzcG9zZSgpLHRoaXMuX2RlcHRoUmVkdWNlcj1udWxsKX1zZXJpYWxpemUoKXtjb25zdCBlPXN1cGVyLnNlcmlhbGl6ZSgpLHQ9dGhpcy5nZXRTaGFkb3dNYXAoKTtpZighdClyZXR1cm4gZTtpZihlLm51bUNhc2NhZGVzPXRoaXMuX251bUNhc2NhZGVzLGUuZGVidWc9dGhpcy5fZGVidWcsZS5zdGFiaWxpemVDYXNjYWRlcz10aGlzLnN0YWJpbGl6ZUNhc2NhZGVzLGUubGFtYmRhPXRoaXMuX2xhbWJkYSxlLmNhc2NhZGVCbGVuZFBlcmNlbnRhZ2U9dGhpcy5jYXNjYWRlQmxlbmRQZXJjZW50YWdlLGUuZGVwdGhDbGFtcD10aGlzLl9kZXB0aENsYW1wLGUuYXV0b0NhbGNEZXB0aEJvdW5kcz10aGlzLmF1dG9DYWxjRGVwdGhCb3VuZHMsZS5zaGFkb3dNYXhaPXRoaXMuX3NoYWRvd01heFosZS5wZW51bWJyYURhcmtuZXNzPXRoaXMucGVudW1icmFEYXJrbmVzcyxlLmZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm89dGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbyxlLm1pbkRpc3RhbmNlPXRoaXMubWluRGlzdGFuY2UsZS5tYXhEaXN0YW5jZT10aGlzLm1heERpc3RhbmNlLGUucmVuZGVyTGlzdD1bXSx0LnJlbmRlckxpc3QpZm9yKGxldCBpPTA7aTx0LnJlbmRlckxpc3QubGVuZ3RoO2krKyl7Y29uc3Qgcz10LnJlbmRlckxpc3RbaV07ZS5yZW5kZXJMaXN0LnB1c2gocy5pZCl9cmV0dXJuIGV9c3RhdGljIFBhcnNlKGUsdCl7Y29uc3QgaT1HLlBhcnNlKGUsdCwocyxyLG4pPT5uZXcga2UocyxyLHZvaWQgMCxuKSk7cmV0dXJuIGUubnVtQ2FzY2FkZXMhPT12b2lkIDAmJihpLm51bUNhc2NhZGVzPWUubnVtQ2FzY2FkZXMpLGUuZGVidWchPT12b2lkIDAmJihpLmRlYnVnPWUuZGVidWcpLGUuc3RhYmlsaXplQ2FzY2FkZXMhPT12b2lkIDAmJihpLnN0YWJpbGl6ZUNhc2NhZGVzPWUuc3RhYmlsaXplQ2FzY2FkZXMpLGUubGFtYmRhIT09dm9pZCAwJiYoaS5sYW1iZGE9ZS5sYW1iZGEpLGUuY2FzY2FkZUJsZW5kUGVyY2VudGFnZSE9PXZvaWQgMCYmKGkuY2FzY2FkZUJsZW5kUGVyY2VudGFnZT1lLmNhc2NhZGVCbGVuZFBlcmNlbnRhZ2UpLGUuZGVwdGhDbGFtcCE9PXZvaWQgMCYmKGkuZGVwdGhDbGFtcD1lLmRlcHRoQ2xhbXApLGUuYXV0b0NhbGNEZXB0aEJvdW5kcyE9PXZvaWQgMCYmKGkuYXV0b0NhbGNEZXB0aEJvdW5kcz1lLmF1dG9DYWxjRGVwdGhCb3VuZHMpLGUuc2hhZG93TWF4WiE9PXZvaWQgMCYmKGkuc2hhZG93TWF4Wj1lLnNoYWRvd01heFopLGUucGVudW1icmFEYXJrbmVzcyE9PXZvaWQgMCYmKGkucGVudW1icmFEYXJrbmVzcz1lLnBlbnVtYnJhRGFya25lc3MpLGUuZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbyE9PXZvaWQgMCYmKGkuZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbz1lLmZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm8pLGUubWluRGlzdGFuY2UhPT12b2lkIDAmJmUubWF4RGlzdGFuY2UhPT12b2lkIDAmJmkuc2V0TWluTWF4RGlzdGFuY2UoZS5taW5EaXN0YW5jZSxlLm1heERpc3RhbmNlKSxpfX1rZS5fRnJ1c3R1bUNvcm5lcnNORENTcGFjZT1bbmV3IHAoLTEsMSwtMSksbmV3IHAoMSwxLC0xKSxuZXcgcCgxLC0xLC0xKSxuZXcgcCgtMSwtMSwtMSksbmV3IHAoLTEsMSwxKSxuZXcgcCgxLDEsMSksbmV3IHAoMSwtMSwxKSxuZXcgcCgtMSwtMSwxKV0sa2UuQ0xBU1NOQU1FPSJDYXNjYWRlZFNoYWRvd0dlbmVyYXRvciIsa2UuREVGQVVMVF9DQVNDQURFU19DT1VOVD00LGtlLk1JTl9DQVNDQURFU19DT1VOVD0yLGtlLk1BWF9DQVNDQURFU19DT1VOVD00LGtlLl9TY2VuZUNvbXBvbmVudEluaXRpYWxpemF0aW9uPWM9Pnt0aHJvdyAkKCJTaGFkb3dHZW5lcmF0b3JTY2VuZUNvbXBvbmVudCIpfSxaaS5BZGRQYXJzZXIocS5OQU1FX1NIQURPV0dFTkVSQVRPUiwoYyxlKT0+e2lmKGMuc2hhZG93R2VuZXJhdG9ycyE9PXZvaWQgMCYmYy5zaGFkb3dHZW5lcmF0b3JzIT09bnVsbClmb3IobGV0IHQ9MCxpPWMuc2hhZG93R2VuZXJhdG9ycy5sZW5ndGg7dDxpO3QrKyl7Y29uc3Qgcz1jLnNoYWRvd0dlbmVyYXRvcnNbdF07cy5jbGFzc05hbWU9PT1rZS5DTEFTU05BTUU/a2UuUGFyc2UocyxlKTpHLlBhcnNlKHMsZSl9fSk7Y2xhc3MgTG97Y29uc3RydWN0b3IoZSl7dGhpcy5uYW1lPXEuTkFNRV9TSEFET1dHRU5FUkFUT1IsdGhpcy5zY2VuZT1lfXJlZ2lzdGVyKCl7dGhpcy5zY2VuZS5fZ2F0aGVyUmVuZGVyVGFyZ2V0c1N0YWdlLnJlZ2lzdGVyU3RlcChxLlNURVBfR0FUSEVSUkVOREVSVEFSR0VUU19TSEFET1dHRU5FUkFUT1IsdGhpcyx0aGlzLl9nYXRoZXJSZW5kZXJUYXJnZXRzKX1yZWJ1aWxkKCl7fXNlcmlhbGl6ZShlKXtlLnNoYWRvd0dlbmVyYXRvcnM9W107Y29uc3QgdD10aGlzLnNjZW5lLmxpZ2h0cztmb3IoY29uc3QgaSBvZiB0KXtjb25zdCBzPWkuZ2V0U2hhZG93R2VuZXJhdG9ycygpO2lmKHMpe2NvbnN0IHI9cy52YWx1ZXMoKTtmb3IobGV0IG49ci5uZXh0KCk7bi5kb25lIT09ITA7bj1yLm5leHQoKSl7Y29uc3QgYT1uLnZhbHVlO2Uuc2hhZG93R2VuZXJhdG9ycy5wdXNoKGEuc2VyaWFsaXplKCkpfX19fWFkZEZyb21Db250YWluZXIoZSl7fXJlbW92ZUZyb21Db250YWluZXIoZSx0KXt9ZGlzcG9zZSgpe31fZ2F0aGVyUmVuZGVyVGFyZ2V0cyhlKXtjb25zdCB0PXRoaXMuc2NlbmU7aWYodGhpcy5zY2VuZS5zaGFkb3dzRW5hYmxlZClmb3IobGV0IGk9MDtpPHQubGlnaHRzLmxlbmd0aDtpKyspe2NvbnN0IHM9dC5saWdodHNbaV0scj1zLmdldFNoYWRvd0dlbmVyYXRvcnMoKTtpZihzLmlzRW5hYmxlZCgpJiZzLnNoYWRvd0VuYWJsZWQmJnIpe2NvbnN0IG49ci52YWx1ZXMoKTtmb3IobGV0IGE9bi5uZXh0KCk7YS5kb25lIT09ITA7YT1uLm5leHQoKSl7Y29uc3QgaD1hLnZhbHVlLmdldFNoYWRvd01hcCgpO3QudGV4dHVyZXMuaW5kZXhPZihoKSE9PS0xJiZlLnB1c2goaCl9fX19fUcuX1NjZW5lQ29tcG9uZW50SW5pdGlhbGl6YXRpb249Yz0+e2xldCBlPWMuX2dldENvbXBvbmVudChxLk5BTUVfU0hBRE9XR0VORVJBVE9SKTtlfHwoZT1uZXcgTG8oYyksYy5fYWRkQ29tcG9uZW50KGUpKX07Y29uc3QgTm89e2VuYWJsZVNoYWRvd3M6ITB9O2Z1bmN0aW9uIEJyKGM9Tm8pe2NvbnN0e2VuYWJsZVNoYWRvd3M6ZSxzaGFkb3dUcmFuc3BhcmVuY3k6dCxpbnRlbnNpdHk6aSxzY2VuZTpzfT1jLHI9bmV3IEl0KCJEaXJlY3Rpb25hbExpZ2h0IixuZXcgcCgtLjMsLTEsLjQpLHMpO3IucG9zaXRpb249bmV3IHAoLTUwLDY1LC01MCksci5pbnRlbnNpdHk9LjY1Kmk7Y29uc3Qgbj1uZXcgbnMoIkhlbWlzcGhlcmljTGlnaHQiLG5ldyBwKDEsMSwwKSxzKTtyZXR1cm4gbi5pbnRlbnNpdHk9LjQqaSxlJiYoci5zaGFkb3dNaW5aPTEsci5zaGFkb3dNYXhaPTcwLHIuc2hhZG93R2VuZXJhdG9yPW5ldyBHKDIwNDgsciksci5zaGFkb3dHZW5lcmF0b3IudXNlQ2xvc2VFeHBvbmVudGlhbFNoYWRvd01hcD0hMCxyLnNoYWRvd0dlbmVyYXRvci5kYXJrbmVzcz10KSx7ZGlyZWN0aW9uYWw6cixoZW1pc3BoZXJpYzpufX1mdW5jdGlvbiBVcihjKXtsZXQgdD1bMCwxLDIsMCwyLDMsNCw1LDYsNCw2LDcsOCw5LDEwLDgsMTAsMTEsMTIsMTMsMTQsMTIsMTQsMTUsMTYsMTcsMTgsMTYsMTgsMTksMjAsMjEsMjIsMjAsMjIsMjNdO2NvbnN0IGk9WzAsMCwxLDAsMCwxLDAsMCwxLDAsMCwxLDAsMCwtMSwwLDAsLTEsMCwwLC0xLDAsMCwtMSwxLDAsMCwxLDAsMCwxLDAsMCwxLDAsMCwtMSwwLDAsLTEsMCwwLC0xLDAsMCwtMSwwLDAsMCwxLDAsMCwxLDAsMCwxLDAsMCwxLDAsMCwtMSwwLDAsLTEsMCwwLC0xLDAsMCwtMSwwXSxzPVtdO2xldCByPVtdO2NvbnN0IG49Yy53aWR0aHx8Yy5zaXplfHwxLGE9Yy5oZWlnaHR8fGMuc2l6ZXx8MSxvPWMuZGVwdGh8fGMuc2l6ZXx8MSxoPWMud3JhcHx8ITE7bGV0IGw9Yy50b3BCYXNlQXQ9PT12b2lkIDA/MTpjLnRvcEJhc2VBdCx1PWMuYm90dG9tQmFzZUF0PT09dm9pZCAwPzA6Yy5ib3R0b21CYXNlQXQ7bD0obCs0KSU0LHU9KHUrNCklNDtjb25zdCBkPVsyLDAsMywxXSxmPVsyLDAsMSwzXTtsZXQgXz1kW2xdLEU9Zlt1XSxtPVsxLC0xLDEsLTEsLTEsMSwtMSwxLDEsMSwxLDEsMSwxLC0xLC0xLDEsLTEsLTEsLTEsLTEsMSwtMSwtMSwxLDEsLTEsMSwtMSwtMSwxLC0xLDEsMSwxLDEsLTEsMSwxLC0xLC0xLDEsLTEsLTEsLTEsLTEsMSwtMSwtMSwxLDEsLTEsMSwtMSwxLDEsLTEsMSwxLDEsMSwtMSwxLDEsLTEsLTEsLTEsLTEsLTEsLTEsLTEsMV07aWYoaCl7dD1bMiwzLDAsMiwwLDEsNCw1LDYsNCw2LDcsOSwxMCwxMSw5LDExLDgsMTIsMTQsMTUsMTIsMTMsMTRdLG09Wy0xLDEsMSwxLDEsMSwxLC0xLDEsLTEsLTEsMSwxLDEsLTEsLTEsMSwtMSwtMSwtMSwtMSwxLC0xLC0xLDEsMSwxLDEsMSwtMSwxLC0xLC0xLDEsLTEsMSwtMSwxLC0xLC0xLDEsMSwtMSwtMSwxLC0xLC0xLC0xXTtsZXQgTT1bWzEsMSwxXSxbLTEsMSwxXSxbLTEsMSwtMV0sWzEsMSwtMV1dLEw9W1stMSwtMSwxXSxbMSwtMSwxXSxbMSwtMSwtMV0sWy0xLC0xLC0xXV07Y29uc3Qgaz1bMTcsMTgsMTksMTZdLHc9WzIyLDIzLDIwLDIxXTtmb3IoO18+MDspTS51bnNoaWZ0KE0ucG9wKCkpLGsudW5zaGlmdChrLnBvcCgpKSxfLS07Zm9yKDtFPjA7KUwudW5zaGlmdChMLnBvcCgpKSx3LnVuc2hpZnQody5wb3AoKSksRS0tO009TS5mbGF0KCksTD1MLmZsYXQoKSxtPW0uY29uY2F0KE0pLmNvbmNhdChMKSx0LnB1c2goa1swXSxrWzJdLGtbM10sa1swXSxrWzFdLGtbMl0pLHQucHVzaCh3WzBdLHdbMl0sd1szXSx3WzBdLHdbMV0sd1syXSl9Y29uc3Qgdj1bbi8yLGEvMixvLzJdO3I9bS5yZWR1Y2UoKE0sTCxrKT0+TS5jb25jYXQoTCp2W2slM10pLFtdKTtjb25zdCBTPWMuc2lkZU9yaWVudGF0aW9uPT09MD8wOmMuc2lkZU9yaWVudGF0aW9ufHxlZS5ERUZBVUxUU0lERSx5PWMuZmFjZVVWfHxuZXcgQXJyYXkoNiksQT1jLmZhY2VDb2xvcnMsQz1bXTtmb3IobGV0IE09MDtNPDY7TSsrKXlbTV09PT12b2lkIDAmJih5W01dPW5ldyBDZSgwLDAsMSwxKSksQSYmQVtNXT09PXZvaWQgMCYmKEFbTV09bmV3IG1lKDEsMSwxLDEpKTtmb3IobGV0IE09MDtNPDY7TSsrKWlmKHMucHVzaCh5W01dLnosZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVj8xLXlbTV0udzp5W01dLncpLHMucHVzaCh5W01dLngsZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVj8xLXlbTV0udzp5W01dLncpLHMucHVzaCh5W01dLngsZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVj8xLXlbTV0ueTp5W01dLnkpLHMucHVzaCh5W01dLnosZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVj8xLXlbTV0ueTp5W01dLnkpLEEpZm9yKGxldCBMPTA7TDw0O0wrKylDLnB1c2goQVtNXS5yLEFbTV0uZyxBW01dLmIsQVtNXS5hKTtlZS5fQ29tcHV0ZVNpZGVzKFMscix0LGkscyxjLmZyb250VVZzLGMuYmFja1VWcyk7Y29uc3QgYj1uZXcgZWU7aWYoYi5pbmRpY2VzPXQsYi5wb3NpdGlvbnM9cixiLm5vcm1hbHM9aSxiLnV2cz1zLEEpe2NvbnN0IE09Uz09PWVlLkRPVUJMRVNJREU/Qy5jb25jYXQoQyk6QztiLmNvbG9ycz1NfXJldHVybiBifWZ1bmN0aW9uIE1pKGMsZT17fSx0PW51bGwpe2NvbnN0IGk9bmV3IFcoYyx0KTtyZXR1cm4gZS5zaWRlT3JpZW50YXRpb249Vy5fR2V0RGVmYXVsdFNpZGVPcmllbnRhdGlvbihlLnNpZGVPcmllbnRhdGlvbiksaS5fb3JpZ2luYWxCdWlsZGVyU2lkZU9yaWVudGF0aW9uPWUuc2lkZU9yaWVudGF0aW9uLFVyKGUpLmFwcGx5VG9NZXNoKGksZS51cGRhdGFibGUpLGl9ZWUuQ3JlYXRlQm94PVVyLFcuQ3JlYXRlQm94PShjLGUsdD1udWxsLGkscyk9Pk1pKGMse3NpemU6ZSxzaWRlT3JpZW50YXRpb246cyx1cGRhdGFibGU6aX0sdCk7Y2xhc3Mga3J7Y29uc3RydWN0b3IoKXt0aGlzLnByZXZpb3VzV29ybGRNYXRyaWNlcz17fSx0aGlzLnByZXZpb3VzQm9uZXM9e319c3RhdGljIEFkZFVuaWZvcm1zKGUpe2UucHVzaCgicHJldmlvdXNXb3JsZCIsInByZXZpb3VzVmlld1Byb2plY3Rpb24iLCJtUHJldmlvdXNCb25lcyIpfXN0YXRpYyBBZGRTYW1wbGVycyhlKXt9YmluZEZvclN1Yk1lc2goZSx0LGkscyxyKXtpZih0LnByZVBhc3NSZW5kZXJlciYmdC5wcmVQYXNzUmVuZGVyZXIuZW5hYmxlZCYmdC5wcmVQYXNzUmVuZGVyZXIuY3VycmVudFJUaXNTY2VuZVJUJiZ0LnByZVBhc3NSZW5kZXJlci5nZXRJbmRleCgyKSE9PS0xKXt0aGlzLnByZXZpb3VzV29ybGRNYXRyaWNlc1tpLnVuaXF1ZUlkXXx8KHRoaXMucHJldmlvdXNXb3JsZE1hdHJpY2VzW2kudW5pcXVlSWRdPXMuY2xvbmUoKSksdGhpcy5wcmV2aW91c1ZpZXdQcm9qZWN0aW9ufHwodGhpcy5wcmV2aW91c1ZpZXdQcm9qZWN0aW9uPXQuZ2V0VHJhbnNmb3JtTWF0cml4KCkuY2xvbmUoKSx0aGlzLmN1cnJlbnRWaWV3UHJvamVjdGlvbj10LmdldFRyYW5zZm9ybU1hdHJpeCgpLmNsb25lKCkpO2NvbnN0IG49dC5nZXRFbmdpbmUoKTt0aGlzLmN1cnJlbnRWaWV3UHJvamVjdGlvbi51cGRhdGVGbGFnIT09dC5nZXRUcmFuc2Zvcm1NYXRyaXgoKS51cGRhdGVGbGFnPyh0aGlzLl9sYXN0VXBkYXRlRnJhbWVJZD1uLmZyYW1lSWQsdGhpcy5wcmV2aW91c1ZpZXdQcm9qZWN0aW9uLmNvcHlGcm9tKHRoaXMuY3VycmVudFZpZXdQcm9qZWN0aW9uKSx0aGlzLmN1cnJlbnRWaWV3UHJvamVjdGlvbi5jb3B5RnJvbSh0LmdldFRyYW5zZm9ybU1hdHJpeCgpKSk6dGhpcy5fbGFzdFVwZGF0ZUZyYW1lSWQhPT1uLmZyYW1lSWQmJih0aGlzLl9sYXN0VXBkYXRlRnJhbWVJZD1uLmZyYW1lSWQsdGhpcy5wcmV2aW91c1ZpZXdQcm9qZWN0aW9uLmNvcHlGcm9tKHRoaXMuY3VycmVudFZpZXdQcm9qZWN0aW9uKSksZS5zZXRNYXRyaXgoInByZXZpb3VzV29ybGQiLHRoaXMucHJldmlvdXNXb3JsZE1hdHJpY2VzW2kudW5pcXVlSWRdKSxlLnNldE1hdHJpeCgicHJldmlvdXNWaWV3UHJvamVjdGlvbiIsdGhpcy5wcmV2aW91c1ZpZXdQcm9qZWN0aW9uKSx0aGlzLnByZXZpb3VzV29ybGRNYXRyaWNlc1tpLnVuaXF1ZUlkXT1zLmNsb25lKCl9fX1jbGFzcyBWciBleHRlbmRzIFB7Y29uc3RydWN0b3IoZSx0LGk9ITApe3N1cGVyKGUsdCksdGhpcy5fbm9ybWFsTWF0cml4PW5ldyB4LHRoaXMuX3N0b3JlRWZmZWN0T25TdWJNZXNoZXM9aX1nZXRFZmZlY3QoKXtyZXR1cm4gdGhpcy5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcz90aGlzLl9hY3RpdmVFZmZlY3Q6c3VwZXIuZ2V0RWZmZWN0KCl9aXNSZWFkeShlLHQpe3JldHVybiBlPyF0aGlzLl9zdG9yZUVmZmVjdE9uU3ViTWVzaGVzfHwhZS5zdWJNZXNoZXN8fGUuc3ViTWVzaGVzLmxlbmd0aD09PTA/ITA6dGhpcy5pc1JlYWR5Rm9yU3ViTWVzaChlLGUuc3ViTWVzaGVzWzBdLHQpOiExfV9pc1JlYWR5Rm9yU3ViTWVzaChlKXtjb25zdCB0PWUubWF0ZXJpYWxEZWZpbmVzO3JldHVybiEhKCF0aGlzLmNoZWNrUmVhZHlPbkV2ZXJ5Q2FsbCYmZS5lZmZlY3QmJnQmJnQuX3JlbmRlcklkPT09dGhpcy5nZXRTY2VuZSgpLmdldFJlbmRlcklkKCkpfWJpbmRPbmx5V29ybGRNYXRyaXgoZSl7dGhpcy5fYWN0aXZlRWZmZWN0LnNldE1hdHJpeCgid29ybGQiLGUpfWJpbmRPbmx5Tm9ybWFsTWF0cml4KGUpe3RoaXMuX2FjdGl2ZUVmZmVjdC5zZXRNYXRyaXgoIm5vcm1hbE1hdHJpeCIsZSl9YmluZChlLHQpe3QmJnRoaXMuYmluZEZvclN1Yk1lc2goZSx0LHQuc3ViTWVzaGVzWzBdKX1fYWZ0ZXJCaW5kKGUsdD1udWxsKXtzdXBlci5fYWZ0ZXJCaW5kKGUsdCksdGhpcy5nZXRTY2VuZSgpLl9jYWNoZWRFZmZlY3Q9dCx0JiYodC5fZm9yY2VSZWJpbmRPbk5leHRDYWxsPSExKX1fbXVzdFJlYmluZChlLHQsaT0xKXtyZXR1cm4gZS5pc0NhY2hlZE1hdGVyaWFsSW52YWxpZCh0aGlzLHQsaSl9fWNsYXNzIHVle3N0YXRpYyBnZXQgRGlmZnVzZVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX0RpZmZ1c2VUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IERpZmZ1c2VUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9EaWZmdXNlVGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fRGlmZnVzZVRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9c3RhdGljIGdldCBEZXRhaWxUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9EZXRhaWxUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IERldGFpbFRleHR1cmVFbmFibGVkKGUpe3RoaXMuX0RldGFpbFRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX0RldGFpbFRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9c3RhdGljIGdldCBBbWJpZW50VGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fQW1iaWVudFRleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgQW1iaWVudFRleHR1cmVFbmFibGVkKGUpe3RoaXMuX0FtYmllbnRUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9BbWJpZW50VGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IE9wYWNpdHlUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9PcGFjaXR5VGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBPcGFjaXR5VGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fT3BhY2l0eVRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX09wYWNpdHlUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgUmVmbGVjdGlvblRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX1JlZmxlY3Rpb25UZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IFJlZmxlY3Rpb25UZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9SZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fUmVmbGVjdGlvblRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9c3RhdGljIGdldCBFbWlzc2l2ZVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX0VtaXNzaXZlVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBFbWlzc2l2ZVRleHR1cmVFbmFibGVkKGUpe3RoaXMuX0VtaXNzaXZlVGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fRW1pc3NpdmVUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgU3BlY3VsYXJUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9TcGVjdWxhclRleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgU3BlY3VsYXJUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9TcGVjdWxhclRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX1NwZWN1bGFyVGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IEJ1bXBUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9CdW1wVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBCdW1wVGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fQnVtcFRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX0J1bXBUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgTGlnaHRtYXBUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9MaWdodG1hcFRleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgTGlnaHRtYXBUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9MaWdodG1hcFRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX0xpZ2h0bWFwVGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IFJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9SZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBSZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fUmVmcmFjdGlvblRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX1JlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgQ29sb3JHcmFkaW5nVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fQ29sb3JHcmFkaW5nVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBDb2xvckdyYWRpbmdUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9Db2xvckdyYWRpbmdUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9Db2xvckdyYWRpbmdUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgRnJlc25lbEVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fRnJlc25lbEVuYWJsZWR9c3RhdGljIHNldCBGcmVzbmVsRW5hYmxlZChlKXt0aGlzLl9GcmVzbmVsRW5hYmxlZCE9PWUmJih0aGlzLl9GcmVzbmVsRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoNCkpfXN0YXRpYyBnZXQgQ2xlYXJDb2F0VGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fQ2xlYXJDb2F0VGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBDbGVhckNvYXRUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9DbGVhckNvYXRUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9DbGVhckNvYXRUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgQ2xlYXJDb2F0QnVtcFRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX0NsZWFyQ29hdEJ1bXBUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IENsZWFyQ29hdEJ1bXBUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9DbGVhckNvYXRCdW1wVGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fQ2xlYXJDb2F0QnVtcFRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9c3RhdGljIGdldCBDbGVhckNvYXRUaW50VGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fQ2xlYXJDb2F0VGludFRleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgQ2xlYXJDb2F0VGludFRleHR1cmVFbmFibGVkKGUpe3RoaXMuX0NsZWFyQ29hdFRpbnRUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9DbGVhckNvYXRUaW50VGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IFNoZWVuVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fU2hlZW5UZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IFNoZWVuVGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fU2hlZW5UZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9TaGVlblRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9c3RhdGljIGdldCBBbmlzb3Ryb3BpY1RleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX0FuaXNvdHJvcGljVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBBbmlzb3Ryb3BpY1RleHR1cmVFbmFibGVkKGUpe3RoaXMuX0FuaXNvdHJvcGljVGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fQW5pc290cm9waWNUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgVGhpY2tuZXNzVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fVGhpY2tuZXNzVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBUaGlja25lc3NUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9UaGlja25lc3NUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9UaGlja25lc3NUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgUmVmcmFjdGlvbkludGVuc2l0eVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX1RoaWNrbmVzc1RleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgUmVmcmFjdGlvbkludGVuc2l0eVRleHR1cmVFbmFibGVkKGUpe3RoaXMuX1JlZnJhY3Rpb25JbnRlbnNpdHlUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9SZWZyYWN0aW9uSW50ZW5zaXR5VGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IFRyYW5zbHVjZW5jeUludGVuc2l0eVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX1RoaWNrbmVzc1RleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgVHJhbnNsdWNlbmN5SW50ZW5zaXR5VGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fVHJhbnNsdWNlbmN5SW50ZW5zaXR5VGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fVHJhbnNsdWNlbmN5SW50ZW5zaXR5VGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IElyaWRlc2NlbmNlVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fSXJpZGVzY2VuY2VUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IElyaWRlc2NlbmNlVGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fSXJpZGVzY2VuY2VUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9JcmlkZXNjZW5jZVRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9fXVlLl9EaWZmdXNlVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX0RldGFpbFRleHR1cmVFbmFibGVkPSEwLHVlLl9BbWJpZW50VGV4dHVyZUVuYWJsZWQ9ITAsdWUuX09wYWNpdHlUZXh0dXJlRW5hYmxlZD0hMCx1ZS5fUmVmbGVjdGlvblRleHR1cmVFbmFibGVkPSEwLHVlLl9FbWlzc2l2ZVRleHR1cmVFbmFibGVkPSEwLHVlLl9TcGVjdWxhclRleHR1cmVFbmFibGVkPSEwLHVlLl9CdW1wVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX0xpZ2h0bWFwVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX1JlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZD0hMCx1ZS5fQ29sb3JHcmFkaW5nVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX0ZyZXNuZWxFbmFibGVkPSEwLHVlLl9DbGVhckNvYXRUZXh0dXJlRW5hYmxlZD0hMCx1ZS5fQ2xlYXJDb2F0QnVtcFRleHR1cmVFbmFibGVkPSEwLHVlLl9DbGVhckNvYXRUaW50VGV4dHVyZUVuYWJsZWQ9ITAsdWUuX1NoZWVuVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX0FuaXNvdHJvcGljVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX1RoaWNrbmVzc1RleHR1cmVFbmFibGVkPSEwLHVlLl9SZWZyYWN0aW9uSW50ZW5zaXR5VGV4dHVyZUVuYWJsZWQ9ITAsdWUuX1RyYW5zbHVjZW5jeUludGVuc2l0eVRleHR1cmVFbmFibGVkPSEwLHVlLl9JcmlkZXNjZW5jZVRleHR1cmVFbmFibGVkPSEwO2NvbnN0IEJvPSJkZWZhdWx0RnJhZ21lbnREZWNsYXJhdGlvbiIsVW89YHVuaWZvcm0gdmVjNCB2RXllUG9zaXRpb247CnVuaWZvcm0gdmVjNCB2RGlmZnVzZUNvbG9yOwojaWZkZWYgU1BFQ1VMQVJURVJNCnVuaWZvcm0gdmVjNCB2U3BlY3VsYXJDb2xvcjsKI2VuZGlmCnVuaWZvcm0gdmVjMyB2RW1pc3NpdmVDb2xvcjsKdW5pZm9ybSB2ZWMzIHZBbWJpZW50Q29sb3I7CnVuaWZvcm0gZmxvYXQgdmlzaWJpbGl0eTsKI2lmZGVmIERJRkZVU0UKdW5pZm9ybSB2ZWMyIHZEaWZmdXNlSW5mb3M7CiNlbmRpZgojaWZkZWYgQU1CSUVOVAp1bmlmb3JtIHZlYzIgdkFtYmllbnRJbmZvczsKI2VuZGlmCiNpZmRlZiBPUEFDSVRZIAp1bmlmb3JtIHZlYzIgdk9wYWNpdHlJbmZvczsKI2VuZGlmCiNpZmRlZiBFTUlTU0lWRQp1bmlmb3JtIHZlYzIgdkVtaXNzaXZlSW5mb3M7CiNlbmRpZgojaWZkZWYgTElHSFRNQVAKdW5pZm9ybSB2ZWMyIHZMaWdodG1hcEluZm9zOwojZW5kaWYKI2lmZGVmIEJVTVAKdW5pZm9ybSB2ZWMzIHZCdW1wSW5mb3M7CnVuaWZvcm0gdmVjMiB2VGFuZ2VudFNwYWNlUGFyYW1zOwojZW5kaWYKI2lmZGVmIEFMUEhBVEVTVAp1bmlmb3JtIGZsb2F0IGFscGhhQ3V0T2ZmOwojZW5kaWYKI2lmIGRlZmluZWQoUkVGTEVDVElPTk1BUF9TUEhFUklDQUwpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9QUk9KRUNUSU9OKSB8fCBkZWZpbmVkKFJFRlJBQ1RJT04pIHx8IGRlZmluZWQoUFJFUEFTUykKdW5pZm9ybSBtYXQ0IHZpZXc7CiNlbmRpZgojaWZkZWYgUkVGUkFDVElPTgp1bmlmb3JtIHZlYzQgdlJlZnJhY3Rpb25JbmZvczsKI2lmbmRlZiBSRUZSQUNUSU9OTUFQXzNECnVuaWZvcm0gbWF0NCByZWZyYWN0aW9uTWF0cml4OwojZW5kaWYKI2lmZGVmIFJFRlJBQ1RJT05GUkVTTkVMCnVuaWZvcm0gdmVjNCByZWZyYWN0aW9uTGVmdENvbG9yOwp1bmlmb3JtIHZlYzQgcmVmcmFjdGlvblJpZ2h0Q29sb3I7CiNlbmRpZgojaWYgZGVmaW5lZChVU0VfTE9DQUxfUkVGUkFDVElPTk1BUF9DVUJJQykgJiYgZGVmaW5lZChSRUZSQUNUSU9OTUFQXzNEKQp1bmlmb3JtIHZlYzMgdlJlZnJhY3Rpb25Qb3NpdGlvbjsKdW5pZm9ybSB2ZWMzIHZSZWZyYWN0aW9uU2l6ZTsgCiNlbmRpZgojZW5kaWYKI2lmIGRlZmluZWQoU1BFQ1VMQVIpICYmIGRlZmluZWQoU1BFQ1VMQVJURVJNKQp1bmlmb3JtIHZlYzIgdlNwZWN1bGFySW5mb3M7CiNlbmRpZgojaWZkZWYgRElGRlVTRUZSRVNORUwKdW5pZm9ybSB2ZWM0IGRpZmZ1c2VMZWZ0Q29sb3I7CnVuaWZvcm0gdmVjNCBkaWZmdXNlUmlnaHRDb2xvcjsKI2VuZGlmCiNpZmRlZiBPUEFDSVRZRlJFU05FTAp1bmlmb3JtIHZlYzQgb3BhY2l0eVBhcnRzOwojZW5kaWYKI2lmZGVmIEVNSVNTSVZFRlJFU05FTAp1bmlmb3JtIHZlYzQgZW1pc3NpdmVMZWZ0Q29sb3I7CnVuaWZvcm0gdmVjNCBlbWlzc2l2ZVJpZ2h0Q29sb3I7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTgp1bmlmb3JtIHZlYzIgdlJlZmxlY3Rpb25JbmZvczsKI2lmIGRlZmluZWQoUkVGTEVDVElPTk1BUF9QTEFOQVIpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9DVUJJQykgfHwgZGVmaW5lZChSRUZMRUNUSU9OTUFQX1BST0pFQ1RJT04pIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVIpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9TUEhFUklDQUwpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9TS1lCT1gpCnVuaWZvcm0gbWF0NCByZWZsZWN0aW9uTWF0cml4OwojZW5kaWYKI2lmbmRlZiBSRUZMRUNUSU9OTUFQX1NLWUJPWAojaWYgZGVmaW5lZChVU0VfTE9DQUxfUkVGTEVDVElPTk1BUF9DVUJJQykgJiYgZGVmaW5lZChSRUZMRUNUSU9OTUFQX0NVQklDKQp1bmlmb3JtIHZlYzMgdlJlZmxlY3Rpb25Qb3NpdGlvbjsKdW5pZm9ybSB2ZWMzIHZSZWZsZWN0aW9uU2l6ZTsgCiNlbmRpZgojZW5kaWYKI2lmZGVmIFJFRkxFQ1RJT05GUkVTTkVMCnVuaWZvcm0gdmVjNCByZWZsZWN0aW9uTGVmdENvbG9yOwp1bmlmb3JtIHZlYzQgcmVmbGVjdGlvblJpZ2h0Q29sb3I7CiNlbmRpZgojZW5kaWYKI2lmZGVmIERFVEFJTAp1bmlmb3JtIHZlYzQgdkRldGFpbEluZm9zOwojZW5kaWYKI2RlZmluZSBBRERJVElPTkFMX0ZSQUdNRU5UX0RFQ0xBUkFUSU9OCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtCb109VW87Y29uc3Qga289ImRlZmF1bHRVYm9EZWNsYXJhdGlvbiIsVm89YGxheW91dChzdGQxNDAsY29sdW1uX21ham9yKSB1bmlmb3JtOwp1bmlmb3JtIE1hdGVyaWFsCnsKdmVjNCBkaWZmdXNlTGVmdENvbG9yOwp2ZWM0IGRpZmZ1c2VSaWdodENvbG9yOwp2ZWM0IG9wYWNpdHlQYXJ0czsKdmVjNCByZWZsZWN0aW9uTGVmdENvbG9yOwp2ZWM0IHJlZmxlY3Rpb25SaWdodENvbG9yOwp2ZWM0IHJlZnJhY3Rpb25MZWZ0Q29sb3I7CnZlYzQgcmVmcmFjdGlvblJpZ2h0Q29sb3I7CnZlYzQgZW1pc3NpdmVMZWZ0Q29sb3I7CnZlYzQgZW1pc3NpdmVSaWdodENvbG9yOwp2ZWMyIHZEaWZmdXNlSW5mb3M7CnZlYzIgdkFtYmllbnRJbmZvczsKdmVjMiB2T3BhY2l0eUluZm9zOwp2ZWMyIHZSZWZsZWN0aW9uSW5mb3M7CnZlYzMgdlJlZmxlY3Rpb25Qb3NpdGlvbjsKdmVjMyB2UmVmbGVjdGlvblNpemU7CnZlYzIgdkVtaXNzaXZlSW5mb3M7CnZlYzIgdkxpZ2h0bWFwSW5mb3M7CnZlYzIgdlNwZWN1bGFySW5mb3M7CnZlYzMgdkJ1bXBJbmZvczsKbWF0NCBkaWZmdXNlTWF0cml4OwptYXQ0IGFtYmllbnRNYXRyaXg7Cm1hdDQgb3BhY2l0eU1hdHJpeDsKbWF0NCByZWZsZWN0aW9uTWF0cml4OwptYXQ0IGVtaXNzaXZlTWF0cml4OwptYXQ0IGxpZ2h0bWFwTWF0cml4OwptYXQ0IHNwZWN1bGFyTWF0cml4OwptYXQ0IGJ1bXBNYXRyaXg7CnZlYzIgdlRhbmdlbnRTcGFjZVBhcmFtczsKZmxvYXQgcG9pbnRTaXplOwpmbG9hdCBhbHBoYUN1dE9mZjsKbWF0NCByZWZyYWN0aW9uTWF0cml4Owp2ZWM0IHZSZWZyYWN0aW9uSW5mb3M7CnZlYzMgdlJlZnJhY3Rpb25Qb3NpdGlvbjsKdmVjMyB2UmVmcmFjdGlvblNpemU7CnZlYzQgdlNwZWN1bGFyQ29sb3I7CnZlYzMgdkVtaXNzaXZlQ29sb3I7CnZlYzQgdkRpZmZ1c2VDb2xvcjsKdmVjMyB2QW1iaWVudENvbG9yOwojZGVmaW5lIEFERElUSU9OQUxfVUJPX0RFQ0xBUkFUSU9OCn07CiNpbmNsdWRlPHNjZW5lVWJvRGVjbGFyYXRpb24+CiNpbmNsdWRlPG1lc2hVYm9EZWNsYXJhdGlvbj4KYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2tvXT1Wbztjb25zdCBXbz0icHJlUGFzc0RlY2xhcmF0aW9uIix6bz1gI2lmZGVmIFBSRVBBU1MKI2V4dGVuc2lvbiBHTF9FWFRfZHJhd19idWZmZXJzIDogcmVxdWlyZQpsYXlvdXQobG9jYXRpb249MCkgb3V0IGhpZ2hwIHZlYzQgZ2xGcmFnRGF0YVt7WH1dO2hpZ2hwIHZlYzQgZ2xfRnJhZ0NvbG9yOwojaWZkZWYgUFJFUEFTU19ERVBUSAp2YXJ5aW5nIGhpZ2hwIHZlYzMgdlZpZXdQb3M7CiNlbmRpZgojaWZkZWYgUFJFUEFTU19WRUxPQ0lUWQp2YXJ5aW5nIGhpZ2hwIHZlYzQgdkN1cnJlbnRQb3NpdGlvbjt2YXJ5aW5nIGhpZ2hwIHZlYzQgdlByZXZpb3VzUG9zaXRpb247CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW1dvXT16bztjb25zdCBHbz0ib2l0RGVjbGFyYXRpb24iLFhvPWAjaWZkZWYgT1JERVJfSU5ERVBFTkRFTlRfVFJBTlNQQVJFTkNZCiNleHRlbnNpb24gR0xfRVhUX2RyYXdfYnVmZmVycyA6IHJlcXVpcmUKbGF5b3V0KGxvY2F0aW9uPTApIG91dCB2ZWMyIGRlcHRoOyAKbGF5b3V0KGxvY2F0aW9uPTEpIG91dCB2ZWM0IGZyb250Q29sb3I7CmxheW91dChsb2NhdGlvbj0yKSBvdXQgdmVjNCBiYWNrQ29sb3I7CiNkZWZpbmUgTUFYX0RFUFRIIDk5OTk5LjAKaGlnaHAgdmVjNCBnbF9GcmFnQ29sb3I7CnVuaWZvcm0gc2FtcGxlcjJEIG9pdERlcHRoU2FtcGxlcjsKdW5pZm9ybSBzYW1wbGVyMkQgb2l0RnJvbnRDb2xvclNhbXBsZXI7CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbR29dPVhvO2NvbnN0IEhvPSJtYWluVVZWYXJ5aW5nRGVjbGFyYXRpb24iLEtvPWAjaWZkZWYgTUFJTlVWe1h9CnZhcnlpbmcgdmVjMiB2TWFpblVWe1h9OwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW0hvXT1Lbztjb25zdCBZbz0ibGlnaHRGcmFnbWVudERlY2xhcmF0aW9uIixabz1gI2lmZGVmIExJR0hUe1h9CnVuaWZvcm0gdmVjNCB2TGlnaHREYXRhe1h9Owp1bmlmb3JtIHZlYzQgdkxpZ2h0RGlmZnVzZXtYfTsKI2lmZGVmIFNQRUNVTEFSVEVSTQp1bmlmb3JtIHZlYzQgdkxpZ2h0U3BlY3VsYXJ7WH07CiNlbHNlCnZlYzQgdkxpZ2h0U3BlY3VsYXJ7WH09dmVjNCgwLik7CiNlbmRpZgojaWZkZWYgU0hBRE9Xe1h9CiNpZmRlZiBTSEFET1dDU017WH0KdW5pZm9ybSBtYXQ0IGxpZ2h0TWF0cml4e1h9W1NIQURPV0NTTU5VTV9DQVNDQURFU3tYfV07CnVuaWZvcm0gZmxvYXQgdmlld0ZydXN0dW1ae1h9W1NIQURPV0NTTU5VTV9DQVNDQURFU3tYfV07CnVuaWZvcm0gZmxvYXQgZnJ1c3R1bUxlbmd0aHN7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdW5pZm9ybSBmbG9hdCBjYXNjYWRlQmxlbmRGYWN0b3J7WH07CnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHR7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdmFyeWluZyBmbG9hdCB2RGVwdGhNZXRyaWN7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdmFyeWluZyB2ZWM0IHZQb3NpdGlvbkZyb21DYW1lcmF7WH07CiNpZiBkZWZpbmVkKFNIQURPV1BDU1N7WH0pCnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEQXJyYXlTaGFkb3cgc2hhZG93U2FtcGxlcntYfTsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkRBcnJheSBkZXB0aFNhbXBsZXJ7WH07CnVuaWZvcm0gdmVjMiBsaWdodFNpemVVVkNvcnJlY3Rpb257WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdW5pZm9ybSBmbG9hdCBkZXB0aENvcnJlY3Rpb257WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdW5pZm9ybSBmbG9hdCBwZW51bWJyYURhcmtuZXNze1h9OwojZWxpZiBkZWZpbmVkKFNIQURPV1BDRntYfSkKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkRBcnJheVNoYWRvdyBzaGFkb3dTYW1wbGVye1h9OwojZWxzZQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyREFycmF5IHNoYWRvd1NhbXBsZXJ7WH07CiNlbmRpZgojaWZkZWYgU0hBRE9XQ1NNREVCVUd7WH0KY29uc3QgdmVjMyB2Q2FzY2FkZUNvbG9yc011bHRpcGxpZXJ7WH1bOF09dmVjM1s4XQooCnZlYzMgKCAxLjUsMC4wLDAuMCApLAp2ZWMzICggMC4wLDEuNSwwLjAgKSwKdmVjMyAoIDAuMCwwLjAsNS41ICksCnZlYzMgKCAxLjUsMC4wLDUuNSApLAp2ZWMzICggMS41LDEuNSwwLjAgKSwKdmVjMyAoIDEuMCwxLjAsMS4wICksCnZlYzMgKCAwLjAsMS4wLDUuNSApLAp2ZWMzICggMC41LDMuNSwwLjc1ICkKKTsKdmVjMyBzaGFkb3dEZWJ1Z3tYfTsKI2VuZGlmCiNpZmRlZiBTSEFET1dDU01VU0VTSEFET1dNQVhae1h9CmludCBpbmRleHtYfT0tMTsKI2Vsc2UKaW50IGluZGV4e1h9PVNIQURPV0NTTU5VTV9DQVNDQURFU3tYfS0xOwojZW5kaWYKZmxvYXQgZGlmZntYfT0wLjsKI2VsaWYgZGVmaW5lZChTSEFET1dDVUJFe1h9KQp1bmlmb3JtIHNhbXBsZXJDdWJlIHNoYWRvd1NhbXBsZXJ7WH07CiNlbHNlCnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHR7WH07CnZhcnlpbmcgZmxvYXQgdkRlcHRoTWV0cmlje1h9OwojaWYgZGVmaW5lZChTSEFET1dQQ1NTe1h9KQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVye1h9Owp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBkZXB0aFNhbXBsZXJ7WH07CiNlbGlmIGRlZmluZWQoU0hBRE9XUENGe1h9KQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVye1h9OwojZWxzZQp1bmlmb3JtIHNhbXBsZXIyRCBzaGFkb3dTYW1wbGVye1h9OwojZW5kaWYKdW5pZm9ybSBtYXQ0IGxpZ2h0TWF0cml4e1h9OwojZW5kaWYKdW5pZm9ybSB2ZWM0IHNoYWRvd3NJbmZve1h9Owp1bmlmb3JtIHZlYzIgZGVwdGhWYWx1ZXN7WH07CiNlbmRpZgojaWZkZWYgU1BPVExJR0hUe1h9CnVuaWZvcm0gdmVjNCB2TGlnaHREaXJlY3Rpb257WH07CnVuaWZvcm0gdmVjNCB2TGlnaHRGYWxsb2Zme1h9OwojZWxpZiBkZWZpbmVkKFBPSU5UTElHSFR7WH0pCnVuaWZvcm0gdmVjNCB2TGlnaHRGYWxsb2Zme1h9OwojZWxpZiBkZWZpbmVkKEhFTUlMSUdIVHtYfSkKdW5pZm9ybSB2ZWMzIHZMaWdodEdyb3VuZHtYfTsKI2VuZGlmCiNpZmRlZiBQUk9KRUNURURMSUdIVFRFWFRVUkV7WH0KdW5pZm9ybSBtYXQ0IHRleHR1cmVQcm9qZWN0aW9uTWF0cml4e1h9Owp1bmlmb3JtIHNhbXBsZXIyRCBwcm9qZWN0aW9uTGlnaHRTYW1wbGVye1h9OwojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtZb109Wm87Y29uc3QgcW89ImxpZ2h0VWJvRGVjbGFyYXRpb24iLGpvPWAjaWZkZWYgTElHSFR7WH0KdW5pZm9ybSBMaWdodHtYfQp7CnZlYzQgdkxpZ2h0RGF0YTsKdmVjNCB2TGlnaHREaWZmdXNlOwp2ZWM0IHZMaWdodFNwZWN1bGFyOwojaWZkZWYgU1BPVExJR0hUe1h9CnZlYzQgdkxpZ2h0RGlyZWN0aW9uOwp2ZWM0IHZMaWdodEZhbGxvZmY7CiNlbGlmIGRlZmluZWQoUE9JTlRMSUdIVHtYfSkKdmVjNCB2TGlnaHRGYWxsb2ZmOwojZWxpZiBkZWZpbmVkKEhFTUlMSUdIVHtYfSkKdmVjMyB2TGlnaHRHcm91bmQ7CiNlbmRpZgp2ZWM0IHNoYWRvd3NJbmZvOwp2ZWMyIGRlcHRoVmFsdWVzOwp9IGxpZ2h0e1h9OwojaWZkZWYgUFJPSkVDVEVETElHSFRURVhUVVJFe1h9CnVuaWZvcm0gbWF0NCB0ZXh0dXJlUHJvamVjdGlvbk1hdHJpeHtYfTsKdW5pZm9ybSBzYW1wbGVyMkQgcHJvamVjdGlvbkxpZ2h0U2FtcGxlcntYfTsKI2VuZGlmCiNpZmRlZiBTSEFET1d7WH0KI2lmZGVmIFNIQURPV0NTTXtYfQp1bmlmb3JtIG1hdDQgbGlnaHRNYXRyaXh7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdW5pZm9ybSBmbG9hdCB2aWV3RnJ1c3R1bVp7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdW5pZm9ybSBmbG9hdCBmcnVzdHVtTGVuZ3Roc3tYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp1bmlmb3JtIGZsb2F0IGNhc2NhZGVCbGVuZEZhY3RvcntYfTsKdmFyeWluZyB2ZWM0IHZQb3NpdGlvbkZyb21MaWdodHtYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp2YXJ5aW5nIGZsb2F0IHZEZXB0aE1ldHJpY3tYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp2YXJ5aW5nIHZlYzQgdlBvc2l0aW9uRnJvbUNhbWVyYXtYfTsKI2lmIGRlZmluZWQoU0hBRE9XUENTU3tYfSkKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkRBcnJheVNoYWRvdyBzaGFkb3dTYW1wbGVye1h9Owp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyREFycmF5IGRlcHRoU2FtcGxlcntYfTsKdW5pZm9ybSB2ZWMyIGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbntYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp1bmlmb3JtIGZsb2F0IGRlcHRoQ29ycmVjdGlvbntYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp1bmlmb3JtIGZsb2F0IHBlbnVtYnJhRGFya25lc3N7WH07CiNlbGlmIGRlZmluZWQoU0hBRE9XUENGe1h9KQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyREFycmF5U2hhZG93IHNoYWRvd1NhbXBsZXJ7WH07CiNlbHNlCnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEQXJyYXkgc2hhZG93U2FtcGxlcntYfTsKI2VuZGlmCiNpZmRlZiBTSEFET1dDU01ERUJVR3tYfQpjb25zdCB2ZWMzIHZDYXNjYWRlQ29sb3JzTXVsdGlwbGllcntYfVs4XT12ZWMzWzhdCigKdmVjMyAoIDEuNSwwLjAsMC4wICksCnZlYzMgKCAwLjAsMS41LDAuMCApLAp2ZWMzICggMC4wLDAuMCw1LjUgKSwKdmVjMyAoIDEuNSwwLjAsNS41ICksCnZlYzMgKCAxLjUsMS41LDAuMCApLAp2ZWMzICggMS4wLDEuMCwxLjAgKSwKdmVjMyAoIDAuMCwxLjAsNS41ICksCnZlYzMgKCAwLjUsMy41LDAuNzUgKQopOwp2ZWMzIHNoYWRvd0RlYnVne1h9OwojZW5kaWYKI2lmZGVmIFNIQURPV0NTTVVTRVNIQURPV01BWFp7WH0KaW50IGluZGV4e1h9PS0xOwojZWxzZQppbnQgaW5kZXh7WH09U0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9LTE7CiNlbmRpZgpmbG9hdCBkaWZme1h9PTAuOwojZWxpZiBkZWZpbmVkKFNIQURPV0NVQkV7WH0pCnVuaWZvcm0gc2FtcGxlckN1YmUgc2hhZG93U2FtcGxlcntYfTsgCiNlbHNlCnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHR7WH07CnZhcnlpbmcgZmxvYXQgdkRlcHRoTWV0cmlje1h9OwojaWYgZGVmaW5lZChTSEFET1dQQ1NTe1h9KQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVye1h9Owp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBkZXB0aFNhbXBsZXJ7WH07CiNlbGlmIGRlZmluZWQoU0hBRE9XUENGe1h9KQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVye1h9OwojZWxzZQp1bmlmb3JtIHNhbXBsZXIyRCBzaGFkb3dTYW1wbGVye1h9OwojZW5kaWYKdW5pZm9ybSBtYXQ0IGxpZ2h0TWF0cml4e1h9OwojZW5kaWYKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbcW9dPWpvO2NvbnN0ICRvPSJsaWdodHNGcmFnbWVudEZ1bmN0aW9ucyIsUW89YHN0cnVjdCBsaWdodGluZ0luZm8Kewp2ZWMzIGRpZmZ1c2U7CiNpZmRlZiBTUEVDVUxBUlRFUk0KdmVjMyBzcGVjdWxhcjsKI2VuZGlmCiNpZmRlZiBORE9UTApmbG9hdCBuZGw7CiNlbmRpZgp9OwpsaWdodGluZ0luZm8gY29tcHV0ZUxpZ2h0aW5nKHZlYzMgdmlld0RpcmVjdGlvblcsdmVjMyB2Tm9ybWFsLHZlYzQgbGlnaHREYXRhLHZlYzMgZGlmZnVzZUNvbG9yLHZlYzMgc3BlY3VsYXJDb2xvcixmbG9hdCByYW5nZSxmbG9hdCBnbG9zc2luZXNzKSB7CmxpZ2h0aW5nSW5mbyByZXN1bHQ7CnZlYzMgbGlnaHRWZWN0b3JXOwpmbG9hdCBhdHRlbnVhdGlvbj0xLjA7CmlmIChsaWdodERhdGEudz09MC4pCnsKdmVjMyBkaXJlY3Rpb249bGlnaHREYXRhLnh5ei12UG9zaXRpb25XOwphdHRlbnVhdGlvbj1tYXgoMC4sMS4wLWxlbmd0aChkaXJlY3Rpb24pL3JhbmdlKTsKbGlnaHRWZWN0b3JXPW5vcm1hbGl6ZShkaXJlY3Rpb24pOwp9CmVsc2UKewpsaWdodFZlY3Rvclc9bm9ybWFsaXplKC1saWdodERhdGEueHl6KTsKfQpmbG9hdCBuZGw9bWF4KDAuLGRvdCh2Tm9ybWFsLGxpZ2h0VmVjdG9yVykpOwojaWZkZWYgTkRPVEwKcmVzdWx0Lm5kbD1uZGw7CiNlbmRpZgpyZXN1bHQuZGlmZnVzZT1uZGwqZGlmZnVzZUNvbG9yKmF0dGVudWF0aW9uOwojaWZkZWYgU1BFQ1VMQVJURVJNCnZlYzMgYW5nbGVXPW5vcm1hbGl6ZSh2aWV3RGlyZWN0aW9uVytsaWdodFZlY3RvclcpOwpmbG9hdCBzcGVjQ29tcD1tYXgoMC4sZG90KHZOb3JtYWwsYW5nbGVXKSk7CnNwZWNDb21wPXBvdyhzcGVjQ29tcCxtYXgoMS4sZ2xvc3NpbmVzcykpOwpyZXN1bHQuc3BlY3VsYXI9c3BlY0NvbXAqc3BlY3VsYXJDb2xvciphdHRlbnVhdGlvbjsKI2VuZGlmCnJldHVybiByZXN1bHQ7Cn0KbGlnaHRpbmdJbmZvIGNvbXB1dGVTcG90TGlnaHRpbmcodmVjMyB2aWV3RGlyZWN0aW9uVyx2ZWMzIHZOb3JtYWwsdmVjNCBsaWdodERhdGEsdmVjNCBsaWdodERpcmVjdGlvbix2ZWMzIGRpZmZ1c2VDb2xvcix2ZWMzIHNwZWN1bGFyQ29sb3IsZmxvYXQgcmFuZ2UsZmxvYXQgZ2xvc3NpbmVzcykgewpsaWdodGluZ0luZm8gcmVzdWx0Owp2ZWMzIGRpcmVjdGlvbj1saWdodERhdGEueHl6LXZQb3NpdGlvblc7CnZlYzMgbGlnaHRWZWN0b3JXPW5vcm1hbGl6ZShkaXJlY3Rpb24pOwpmbG9hdCBhdHRlbnVhdGlvbj1tYXgoMC4sMS4wLWxlbmd0aChkaXJlY3Rpb24pL3JhbmdlKTsKZmxvYXQgY29zQW5nbGU9bWF4KDAuLGRvdChsaWdodERpcmVjdGlvbi54eXosLWxpZ2h0VmVjdG9yVykpOwppZiAoY29zQW5nbGU+PWxpZ2h0RGlyZWN0aW9uLncpCnsKY29zQW5nbGU9bWF4KDAuLHBvdyhjb3NBbmdsZSxsaWdodERhdGEudykpOwphdHRlbnVhdGlvbio9Y29zQW5nbGU7CmZsb2F0IG5kbD1tYXgoMC4sZG90KHZOb3JtYWwsbGlnaHRWZWN0b3JXKSk7CiNpZmRlZiBORE9UTApyZXN1bHQubmRsPW5kbDsKI2VuZGlmCnJlc3VsdC5kaWZmdXNlPW5kbCpkaWZmdXNlQ29sb3IqYXR0ZW51YXRpb247CiNpZmRlZiBTUEVDVUxBUlRFUk0KdmVjMyBhbmdsZVc9bm9ybWFsaXplKHZpZXdEaXJlY3Rpb25XK2xpZ2h0VmVjdG9yVyk7CmZsb2F0IHNwZWNDb21wPW1heCgwLixkb3Qodk5vcm1hbCxhbmdsZVcpKTsKc3BlY0NvbXA9cG93KHNwZWNDb21wLG1heCgxLixnbG9zc2luZXNzKSk7CnJlc3VsdC5zcGVjdWxhcj1zcGVjQ29tcCpzcGVjdWxhckNvbG9yKmF0dGVudWF0aW9uOwojZW5kaWYKcmV0dXJuIHJlc3VsdDsKfQpyZXN1bHQuZGlmZnVzZT12ZWMzKDAuKTsKI2lmZGVmIFNQRUNVTEFSVEVSTQpyZXN1bHQuc3BlY3VsYXI9dmVjMygwLik7CiNlbmRpZgojaWZkZWYgTkRPVEwKcmVzdWx0Lm5kbD0wLjsKI2VuZGlmCnJldHVybiByZXN1bHQ7Cn0KbGlnaHRpbmdJbmZvIGNvbXB1dGVIZW1pc3BoZXJpY0xpZ2h0aW5nKHZlYzMgdmlld0RpcmVjdGlvblcsdmVjMyB2Tm9ybWFsLHZlYzQgbGlnaHREYXRhLHZlYzMgZGlmZnVzZUNvbG9yLHZlYzMgc3BlY3VsYXJDb2xvcix2ZWMzIGdyb3VuZENvbG9yLGZsb2F0IGdsb3NzaW5lc3MpIHsKbGlnaHRpbmdJbmZvIHJlc3VsdDsKZmxvYXQgbmRsPWRvdCh2Tm9ybWFsLGxpZ2h0RGF0YS54eXopKjAuNSswLjU7CiNpZmRlZiBORE9UTApyZXN1bHQubmRsPW5kbDsKI2VuZGlmCnJlc3VsdC5kaWZmdXNlPW1peChncm91bmRDb2xvcixkaWZmdXNlQ29sb3IsbmRsKTsKI2lmZGVmIFNQRUNVTEFSVEVSTQp2ZWMzIGFuZ2xlVz1ub3JtYWxpemUodmlld0RpcmVjdGlvblcrbGlnaHREYXRhLnh5eik7CmZsb2F0IHNwZWNDb21wPW1heCgwLixkb3Qodk5vcm1hbCxhbmdsZVcpKTsKc3BlY0NvbXA9cG93KHNwZWNDb21wLG1heCgxLixnbG9zc2luZXNzKSk7CnJlc3VsdC5zcGVjdWxhcj1zcGVjQ29tcCpzcGVjdWxhckNvbG9yOwojZW5kaWYKcmV0dXJuIHJlc3VsdDsKfQojZGVmaW5lIGlubGluZQp2ZWMzIGNvbXB1dGVQcm9qZWN0aW9uVGV4dHVyZURpZmZ1c2VMaWdodGluZyhzYW1wbGVyMkQgcHJvamVjdGlvbkxpZ2h0U2FtcGxlcixtYXQ0IHRleHR1cmVQcm9qZWN0aW9uTWF0cml4KXsKdmVjNCBzdHJxPXRleHR1cmVQcm9qZWN0aW9uTWF0cml4KnZlYzQodlBvc2l0aW9uVywxLjApOwpzdHJxLz1zdHJxLnc7CnZlYzMgdGV4dHVyZUNvbG9yPXRleHR1cmUyRChwcm9qZWN0aW9uTGlnaHRTYW1wbGVyLHN0cnEueHkpLnJnYjsKcmV0dXJuIHRleHR1cmVDb2xvcjsKfWA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVskb109UW87Y29uc3QgSm89InNoYWRvd3NGcmFnbWVudEZ1bmN0aW9ucyIsZWg9YCNpZmRlZiBTSEFET1dTCiNpZiBkZWZpbmVkKFdFQkdMMikgfHwgZGVmaW5lZChXRUJHUFUpIHx8IGRlZmluZWQoTkFUSVZFKQojZGVmaW5lIFRFWFRVUkVGVU5DKHMsYyxsKSB0ZXh0dXJlMkRMb2RFWFQocyxjLGwpCiNlbHNlCiNkZWZpbmUgVEVYVFVSRUZVTkMocyxjLGIpIHRleHR1cmUyRChzLGMsYikKI2VuZGlmCiNpZm5kZWYgU0hBRE9XRkxPQVQKZmxvYXQgdW5wYWNrKHZlYzQgY29sb3IpCnsKY29uc3QgdmVjNCBiaXRfc2hpZnQ9dmVjNCgxLjAvKDI1NS4wKjI1NS4wKjI1NS4wKSwxLjAvKDI1NS4wKjI1NS4wKSwxLjAvMjU1LjAsMS4wKTsKcmV0dXJuIGRvdChjb2xvcixiaXRfc2hpZnQpOwp9CiNlbmRpZgpmbG9hdCBjb21wdXRlRmFsbE9mZihmbG9hdCB2YWx1ZSx2ZWMyIGNsaXBTcGFjZSxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYpCnsKZmxvYXQgbWFzaz1zbW9vdGhzdGVwKDEuMC1mcnVzdHVtRWRnZUZhbGxvZmYsMS4wMDAwMDAxMixjbGFtcChkb3QoY2xpcFNwYWNlLGNsaXBTcGFjZSksMC4sMS4pKTsKcmV0dXJuIG1peCh2YWx1ZSwxLjAsbWFzayk7Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd0N1YmUodmVjMyBsaWdodFBvc2l0aW9uLHNhbXBsZXJDdWJlIHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsdmVjMiBkZXB0aFZhbHVlcykKewp2ZWMzIGRpcmVjdGlvblRvTGlnaHQ9dlBvc2l0aW9uVy1saWdodFBvc2l0aW9uOwpmbG9hdCBkZXB0aD1sZW5ndGgoZGlyZWN0aW9uVG9MaWdodCk7CmRlcHRoPShkZXB0aCtkZXB0aFZhbHVlcy54KS8oZGVwdGhWYWx1ZXMueSk7CmRlcHRoPWNsYW1wKGRlcHRoLDAuLDEuMCk7CmRpcmVjdGlvblRvTGlnaHQ9bm9ybWFsaXplKGRpcmVjdGlvblRvTGlnaHQpOwpkaXJlY3Rpb25Ub0xpZ2h0Lnk9LWRpcmVjdGlvblRvTGlnaHQueTsKI2lmbmRlZiBTSEFET1dGTE9BVApmbG9hdCBzaGFkb3c9dW5wYWNrKHRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCkpOwojZWxzZQpmbG9hdCBzaGFkb3c9dGV4dHVyZUN1YmUoc2hhZG93U2FtcGxlcixkaXJlY3Rpb25Ub0xpZ2h0KS54OwojZW5kaWYKcmV0dXJuIGRlcHRoPnNoYWRvdyA/IGRhcmtuZXNzIDogMS4wOwp9CiNkZWZpbmUgaW5saW5lCmZsb2F0IGNvbXB1dGVTaGFkb3dXaXRoUG9pc3NvblNhbXBsaW5nQ3ViZSh2ZWMzIGxpZ2h0UG9zaXRpb24sc2FtcGxlckN1YmUgc2hhZG93U2FtcGxlcixmbG9hdCBtYXBTaXplLGZsb2F0IGRhcmtuZXNzLHZlYzIgZGVwdGhWYWx1ZXMpCnsKdmVjMyBkaXJlY3Rpb25Ub0xpZ2h0PXZQb3NpdGlvblctbGlnaHRQb3NpdGlvbjsKZmxvYXQgZGVwdGg9bGVuZ3RoKGRpcmVjdGlvblRvTGlnaHQpOwpkZXB0aD0oZGVwdGgrZGVwdGhWYWx1ZXMueCkvKGRlcHRoVmFsdWVzLnkpOwpkZXB0aD1jbGFtcChkZXB0aCwwLiwxLjApOwpkaXJlY3Rpb25Ub0xpZ2h0PW5vcm1hbGl6ZShkaXJlY3Rpb25Ub0xpZ2h0KTsKZGlyZWN0aW9uVG9MaWdodC55PS1kaXJlY3Rpb25Ub0xpZ2h0Lnk7CmZsb2F0IHZpc2liaWxpdHk9MS47CnZlYzMgcG9pc3NvbkRpc2tbNF07CnBvaXNzb25EaXNrWzBdPXZlYzMoLTEuMCwxLjAsLTEuMCk7CnBvaXNzb25EaXNrWzFdPXZlYzMoMS4wLC0xLjAsLTEuMCk7CnBvaXNzb25EaXNrWzJdPXZlYzMoLTEuMCwtMS4wLC0xLjApOwpwb2lzc29uRGlza1szXT12ZWMzKDEuMCwtMS4wLDEuMCk7CiNpZm5kZWYgU0hBRE9XRkxPQVQKaWYgKHVucGFjayh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQrcG9pc3NvbkRpc2tbMF0qbWFwU2l6ZSkpPGRlcHRoKSB2aXNpYmlsaXR5LT0wLjI1OwppZiAodW5wYWNrKHRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCtwb2lzc29uRGlza1sxXSptYXBTaXplKSk8ZGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CmlmICh1bnBhY2sodGV4dHVyZUN1YmUoc2hhZG93U2FtcGxlcixkaXJlY3Rpb25Ub0xpZ2h0K3BvaXNzb25EaXNrWzJdKm1hcFNpemUpKTxkZXB0aCkgdmlzaWJpbGl0eS09MC4yNTsKaWYgKHVucGFjayh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQrcG9pc3NvbkRpc2tbM10qbWFwU2l6ZSkpPGRlcHRoKSB2aXNpYmlsaXR5LT0wLjI1OwojZWxzZQppZiAodGV4dHVyZUN1YmUoc2hhZG93U2FtcGxlcixkaXJlY3Rpb25Ub0xpZ2h0K3BvaXNzb25EaXNrWzBdKm1hcFNpemUpLng8ZGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CmlmICh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQrcG9pc3NvbkRpc2tbMV0qbWFwU2l6ZSkueDxkZXB0aCkgdmlzaWJpbGl0eS09MC4yNTsKaWYgKHRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCtwb2lzc29uRGlza1syXSptYXBTaXplKS54PGRlcHRoKSB2aXNpYmlsaXR5LT0wLjI1OwppZiAodGV4dHVyZUN1YmUoc2hhZG93U2FtcGxlcixkaXJlY3Rpb25Ub0xpZ2h0K3BvaXNzb25EaXNrWzNdKm1hcFNpemUpLng8ZGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CiNlbmRpZgpyZXR1cm4gbWluKDEuMCx2aXNpYmlsaXR5K2RhcmtuZXNzKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aEVTTUN1YmUodmVjMyBsaWdodFBvc2l0aW9uLHNhbXBsZXJDdWJlIHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZGVwdGhTY2FsZSx2ZWMyIGRlcHRoVmFsdWVzKQp7CnZlYzMgZGlyZWN0aW9uVG9MaWdodD12UG9zaXRpb25XLWxpZ2h0UG9zaXRpb247CmZsb2F0IGRlcHRoPWxlbmd0aChkaXJlY3Rpb25Ub0xpZ2h0KTsKZGVwdGg9KGRlcHRoK2RlcHRoVmFsdWVzLngpLyhkZXB0aFZhbHVlcy55KTsKZmxvYXQgc2hhZG93UGl4ZWxEZXB0aD1jbGFtcChkZXB0aCwwLiwxLjApOwpkaXJlY3Rpb25Ub0xpZ2h0PW5vcm1hbGl6ZShkaXJlY3Rpb25Ub0xpZ2h0KTsKZGlyZWN0aW9uVG9MaWdodC55PS1kaXJlY3Rpb25Ub0xpZ2h0Lnk7CiNpZm5kZWYgU0hBRE9XRkxPQVQKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXVucGFjayh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQpKTsKI2Vsc2UKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCkueDsKI2VuZGlmCmZsb2F0IGVzbT0xLjAtY2xhbXAoZXhwKG1pbig4Ny4sZGVwdGhTY2FsZSpzaGFkb3dQaXhlbERlcHRoKSkqc2hhZG93TWFwU2FtcGxlLDAuLDEuLWRhcmtuZXNzKTsgCnJldHVybiBlc207Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhDbG9zZUVTTUN1YmUodmVjMyBsaWdodFBvc2l0aW9uLHNhbXBsZXJDdWJlIHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZGVwdGhTY2FsZSx2ZWMyIGRlcHRoVmFsdWVzKQp7CnZlYzMgZGlyZWN0aW9uVG9MaWdodD12UG9zaXRpb25XLWxpZ2h0UG9zaXRpb247CmZsb2F0IGRlcHRoPWxlbmd0aChkaXJlY3Rpb25Ub0xpZ2h0KTsKZGVwdGg9KGRlcHRoK2RlcHRoVmFsdWVzLngpLyhkZXB0aFZhbHVlcy55KTsKZmxvYXQgc2hhZG93UGl4ZWxEZXB0aD1jbGFtcChkZXB0aCwwLiwxLjApOwpkaXJlY3Rpb25Ub0xpZ2h0PW5vcm1hbGl6ZShkaXJlY3Rpb25Ub0xpZ2h0KTsKZGlyZWN0aW9uVG9MaWdodC55PS1kaXJlY3Rpb25Ub0xpZ2h0Lnk7CiNpZm5kZWYgU0hBRE9XRkxPQVQKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXVucGFjayh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQpKTsKI2Vsc2UKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCkueDsKI2VuZGlmCmZsb2F0IGVzbT1jbGFtcChleHAobWluKDg3LiwtZGVwdGhTY2FsZSooc2hhZG93UGl4ZWxEZXB0aC1zaGFkb3dNYXBTYW1wbGUpKSksZGFya25lc3MsMS4pOwpyZXR1cm4gZXNtOwp9CiNpZiBkZWZpbmVkKFdFQkdMMikgfHwgZGVmaW5lZChXRUJHUFUpIHx8IGRlZmluZWQoTkFUSVZFKQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93Q1NNKGZsb2F0IGxheWVyLHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLGhpZ2hwIHNhbXBsZXIyREFycmF5IHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmKQp7CnZlYzMgY2xpcFNwYWNlPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7CnZlYzIgdXY9MC41KmNsaXBTcGFjZS54eSt2ZWMyKDAuNSk7CnZlYzMgdXZMYXllcj12ZWMzKHV2LngsdXYueSxsYXllcik7CmZsb2F0IHNoYWRvd1BpeGVsRGVwdGg9Y2xhbXAoZGVwdGhNZXRyaWMsMC4sMS4wKTsKI2lmbmRlZiBTSEFET1dGTE9BVApmbG9hdCBzaGFkb3c9dW5wYWNrKHRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2TGF5ZXIpKTsKI2Vsc2UKZmxvYXQgc2hhZG93PXRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2TGF5ZXIpLng7CiNlbmRpZgpyZXR1cm4gc2hhZG93UGl4ZWxEZXB0aD5zaGFkb3cgPyBjb21wdXRlRmFsbE9mZihkYXJrbmVzcyxjbGlwU3BhY2UueHksZnJ1c3R1bUVkZ2VGYWxsb2ZmKSA6IDEuOwp9CiNlbmRpZgojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93KHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLHNhbXBsZXIyRCBzaGFkb3dTYW1wbGVyLGZsb2F0IGRhcmtuZXNzLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZikKewp2ZWMzIGNsaXBTcGFjZT12UG9zaXRpb25Gcm9tTGlnaHQueHl6L3ZQb3NpdGlvbkZyb21MaWdodC53Owp2ZWMyIHV2PTAuNSpjbGlwU3BhY2UueHkrdmVjMigwLjUpOwppZiAodXYueDwwLiB8fCB1di54PjEuMCB8fCB1di55PDAuIHx8IHV2Lnk+MS4wKQp7CnJldHVybiAxLjA7Cn0KZWxzZQp7CmZsb2F0IHNoYWRvd1BpeGVsRGVwdGg9Y2xhbXAoZGVwdGhNZXRyaWMsMC4sMS4wKTsKI2lmbmRlZiBTSEFET1dGTE9BVApmbG9hdCBzaGFkb3c9dW5wYWNrKFRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdXYsMC4pKTsKI2Vsc2UKZmxvYXQgc2hhZG93PVRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdXYsMC4pLng7CiNlbmRpZgpyZXR1cm4gc2hhZG93UGl4ZWxEZXB0aD5zaGFkb3cgPyBjb21wdXRlRmFsbE9mZihkYXJrbmVzcyxjbGlwU3BhY2UueHksZnJ1c3R1bUVkZ2VGYWxsb2ZmKSA6IDEuOwp9Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhQb2lzc29uU2FtcGxpbmcodmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsc2FtcGxlcjJEIHNoYWRvd1NhbXBsZXIsZmxvYXQgbWFwU2l6ZSxmbG9hdCBkYXJrbmVzcyxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYpCnsKdmVjMyBjbGlwU3BhY2U9dlBvc2l0aW9uRnJvbUxpZ2h0Lnh5ei92UG9zaXRpb25Gcm9tTGlnaHQudzsKdmVjMiB1dj0wLjUqY2xpcFNwYWNlLnh5K3ZlYzIoMC41KTsKaWYgKHV2Lng8MC4gfHwgdXYueD4xLjAgfHwgdXYueTwwLiB8fCB1di55PjEuMCkKewpyZXR1cm4gMS4wOwp9CmVsc2UKewpmbG9hdCBzaGFkb3dQaXhlbERlcHRoPWNsYW1wKGRlcHRoTWV0cmljLDAuLDEuMCk7CmZsb2F0IHZpc2liaWxpdHk9MS47CnZlYzIgcG9pc3NvbkRpc2tbNF07CnBvaXNzb25EaXNrWzBdPXZlYzIoLTAuOTQyMDE2MjQsLTAuMzk5MDYyMTYpOwpwb2lzc29uRGlza1sxXT12ZWMyKDAuOTQ1NTg2MDksLTAuNzY4OTA3MjUpOwpwb2lzc29uRGlza1syXT12ZWMyKC0wLjA5NDE4NDEwMSwtMC45MjkzODg3MCk7CnBvaXNzb25EaXNrWzNdPXZlYzIoMC4zNDQ5NTkzOCwwLjI5Mzg3NzYwKTsKI2lmbmRlZiBTSEFET1dGTE9BVAppZiAodW5wYWNrKFRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdXYrcG9pc3NvbkRpc2tbMF0qbWFwU2l6ZSwwLikpPHNoYWRvd1BpeGVsRGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CmlmICh1bnBhY2soVEVYVFVSRUZVTkMoc2hhZG93U2FtcGxlcix1ditwb2lzc29uRGlza1sxXSptYXBTaXplLDAuKSk8c2hhZG93UGl4ZWxEZXB0aCkgdmlzaWJpbGl0eS09MC4yNTsKaWYgKHVucGFjayhURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2K3BvaXNzb25EaXNrWzJdKm1hcFNpemUsMC4pKTxzaGFkb3dQaXhlbERlcHRoKSB2aXNpYmlsaXR5LT0wLjI1OwppZiAodW5wYWNrKFRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdXYrcG9pc3NvbkRpc2tbM10qbWFwU2l6ZSwwLikpPHNoYWRvd1BpeGVsRGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CiNlbHNlCmlmIChURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2K3BvaXNzb25EaXNrWzBdKm1hcFNpemUsMC4pLng8c2hhZG93UGl4ZWxEZXB0aCkgdmlzaWJpbGl0eS09MC4yNTsKaWYgKFRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdXYrcG9pc3NvbkRpc2tbMV0qbWFwU2l6ZSwwLikueDxzaGFkb3dQaXhlbERlcHRoKSB2aXNpYmlsaXR5LT0wLjI1OwppZiAoVEVYVFVSRUZVTkMoc2hhZG93U2FtcGxlcix1ditwb2lzc29uRGlza1syXSptYXBTaXplLDAuKS54PHNoYWRvd1BpeGVsRGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CmlmIChURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2K3BvaXNzb25EaXNrWzNdKm1hcFNpemUsMC4pLng8c2hhZG93UGl4ZWxEZXB0aCkgdmlzaWJpbGl0eS09MC4yNTsKI2VuZGlmCnJldHVybiBjb21wdXRlRmFsbE9mZihtaW4oMS4wLHZpc2liaWxpdHkrZGFya25lc3MpLGNsaXBTcGFjZS54eSxmcnVzdHVtRWRnZUZhbGxvZmYpOwp9Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhFU00odmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsc2FtcGxlcjJEIHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZGVwdGhTY2FsZSxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYpCnsKdmVjMyBjbGlwU3BhY2U9dlBvc2l0aW9uRnJvbUxpZ2h0Lnh5ei92UG9zaXRpb25Gcm9tTGlnaHQudzsKdmVjMiB1dj0wLjUqY2xpcFNwYWNlLnh5K3ZlYzIoMC41KTsKaWYgKHV2Lng8MC4gfHwgdXYueD4xLjAgfHwgdXYueTwwLiB8fCB1di55PjEuMCkKewpyZXR1cm4gMS4wOwp9CmVsc2UKewpmbG9hdCBzaGFkb3dQaXhlbERlcHRoPWNsYW1wKGRlcHRoTWV0cmljLDAuLDEuMCk7CiNpZm5kZWYgU0hBRE9XRkxPQVQKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXVucGFjayhURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2LDAuKSk7CiNlbHNlCmZsb2F0IHNoYWRvd01hcFNhbXBsZT1URVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2LDAuKS54OwojZW5kaWYKZmxvYXQgZXNtPTEuMC1jbGFtcChleHAobWluKDg3LixkZXB0aFNjYWxlKnNoYWRvd1BpeGVsRGVwdGgpKSpzaGFkb3dNYXBTYW1wbGUsMC4sMS4tZGFya25lc3MpOwpyZXR1cm4gY29tcHV0ZUZhbGxPZmYoZXNtLGNsaXBTcGFjZS54eSxmcnVzdHVtRWRnZUZhbGxvZmYpOwp9Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhDbG9zZUVTTSh2ZWM0IHZQb3NpdGlvbkZyb21MaWdodCxmbG9hdCBkZXB0aE1ldHJpYyxzYW1wbGVyMkQgc2hhZG93U2FtcGxlcixmbG9hdCBkYXJrbmVzcyxmbG9hdCBkZXB0aFNjYWxlLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZikKewp2ZWMzIGNsaXBTcGFjZT12UG9zaXRpb25Gcm9tTGlnaHQueHl6L3ZQb3NpdGlvbkZyb21MaWdodC53Owp2ZWMyIHV2PTAuNSpjbGlwU3BhY2UueHkrdmVjMigwLjUpOwppZiAodXYueDwwLiB8fCB1di54PjEuMCB8fCB1di55PDAuIHx8IHV2Lnk+MS4wKQp7CnJldHVybiAxLjA7Cn0KZWxzZQp7CmZsb2F0IHNoYWRvd1BpeGVsRGVwdGg9Y2xhbXAoZGVwdGhNZXRyaWMsMC4sMS4wKTsgCiNpZm5kZWYgU0hBRE9XRkxPQVQKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXVucGFjayhURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2LDAuKSk7CiNlbHNlCmZsb2F0IHNoYWRvd01hcFNhbXBsZT1URVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2LDAuKS54OwojZW5kaWYKZmxvYXQgZXNtPWNsYW1wKGV4cChtaW4oODcuLC1kZXB0aFNjYWxlKihzaGFkb3dQaXhlbERlcHRoLXNoYWRvd01hcFNhbXBsZSkpKSxkYXJrbmVzcywxLik7CnJldHVybiBjb21wdXRlRmFsbE9mZihlc20sY2xpcFNwYWNlLnh5LGZydXN0dW1FZGdlRmFsbG9mZik7Cn0KfQojaWZkZWYgSVNfTkRDX0hBTEZfWlJBTkdFCiNkZWZpbmUgWklOQ0xJUCBjbGlwU3BhY2UuegojZWxzZQojZGVmaW5lIFpJTkNMSVAgdXZEZXB0aC56CiNlbmRpZgojaWYgZGVmaW5lZChXRUJHTDIpIHx8IGRlZmluZWQoV0VCR1BVKSB8fCBkZWZpbmVkKE5BVElWRSkKI2RlZmluZSBHUkVBVEVTVF9MRVNTX1RIQU5fT05FIDAuOTk5OTk5OTQKI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhDU01QQ0YxKGZsb2F0IGxheWVyLHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLGhpZ2hwIHNhbXBsZXIyREFycmF5U2hhZG93IHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmKQp7CnZlYzMgY2xpcFNwYWNlPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7CnZlYzMgdXZEZXB0aD12ZWMzKDAuNSpjbGlwU3BhY2UueHl6K3ZlYzMoMC41KSk7CnV2RGVwdGguej1jbGFtcChaSU5DTElQLDAuLEdSRUFURVNUX0xFU1NfVEhBTl9PTkUpOwp2ZWM0IHV2RGVwdGhMYXllcj12ZWM0KHV2RGVwdGgueCx1dkRlcHRoLnksbGF5ZXIsdXZEZXB0aC56KTsKZmxvYXQgc2hhZG93PXRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2RGVwdGhMYXllcik7CnNoYWRvdz1taXgoZGFya25lc3MsMS4sc2hhZG93KTsKcmV0dXJuIGNvbXB1dGVGYWxsT2ZmKHNoYWRvdyxjbGlwU3BhY2UueHksZnJ1c3R1bUVkZ2VGYWxsb2ZmKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aENTTVBDRjMoZmxvYXQgbGF5ZXIsdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsaGlnaHAgc2FtcGxlcjJEQXJyYXlTaGFkb3cgc2hhZG93U2FtcGxlcix2ZWMyIHNoYWRvd01hcFNpemVBbmRJbnZlcnNlLGZsb2F0IGRhcmtuZXNzLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZikKewp2ZWMzIGNsaXBTcGFjZT12UG9zaXRpb25Gcm9tTGlnaHQueHl6L3ZQb3NpdGlvbkZyb21MaWdodC53Owp2ZWMzIHV2RGVwdGg9dmVjMygwLjUqY2xpcFNwYWNlLnh5eit2ZWMzKDAuNSkpOwp1dkRlcHRoLno9Y2xhbXAoWklOQ0xJUCwwLixHUkVBVEVTVF9MRVNTX1RIQU5fT05FKTsKdmVjMiB1dj11dkRlcHRoLnh5KnNoYWRvd01hcFNpemVBbmRJbnZlcnNlLng7IAp1dis9MC41OyAKdmVjMiBzdD1mcmFjdCh1dik7IAp2ZWMyIGJhc2VfdXY9Zmxvb3IodXYpLTAuNTsgCmJhc2VfdXYqPXNoYWRvd01hcFNpemVBbmRJbnZlcnNlLnk7IAp2ZWMyIHV2dzA9My4tMi4qc3Q7CnZlYzIgdXZ3MT0xLisyLipzdDsKdmVjMiB1PXZlYzIoKDIuLXN0LngpL3V2dzAueC0xLixzdC54L3V2dzEueCsxLikqc2hhZG93TWFwU2l6ZUFuZEludmVyc2UueTsKdmVjMiB2PXZlYzIoKDIuLXN0LnkpL3V2dzAueS0xLixzdC55L3V2dzEueSsxLikqc2hhZG93TWFwU2l6ZUFuZEludmVyc2UueTsKZmxvYXQgc2hhZG93PTAuOwpzaGFkb3crPXV2dzAueCp1dncwLnkqdGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdmVjNChiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzBdKSxsYXllcix1dkRlcHRoLnopKTsKc2hhZG93Kz11dncxLngqdXZ3MC55KnRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHZlYzQoYmFzZV91di54eSt2ZWMyKHVbMV0sdlswXSksbGF5ZXIsdXZEZXB0aC56KSk7CnNoYWRvdys9dXZ3MC54KnV2dzEueSp0ZXh0dXJlMkQoc2hhZG93U2FtcGxlcix2ZWM0KGJhc2VfdXYueHkrdmVjMih1WzBdLHZbMV0pLGxheWVyLHV2RGVwdGgueikpOwpzaGFkb3crPXV2dzEueCp1dncxLnkqdGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdmVjNChiYXNlX3V2Lnh5K3ZlYzIodVsxXSx2WzFdKSxsYXllcix1dkRlcHRoLnopKTsKc2hhZG93PXNoYWRvdy8xNi47CnNoYWRvdz1taXgoZGFya25lc3MsMS4sc2hhZG93KTsKcmV0dXJuIGNvbXB1dGVGYWxsT2ZmKHNoYWRvdyxjbGlwU3BhY2UueHksZnJ1c3R1bUVkZ2VGYWxsb2ZmKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aENTTVBDRjUoZmxvYXQgbGF5ZXIsdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsaGlnaHAgc2FtcGxlcjJEQXJyYXlTaGFkb3cgc2hhZG93U2FtcGxlcix2ZWMyIHNoYWRvd01hcFNpemVBbmRJbnZlcnNlLGZsb2F0IGRhcmtuZXNzLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZikKewp2ZWMzIGNsaXBTcGFjZT12UG9zaXRpb25Gcm9tTGlnaHQueHl6L3ZQb3NpdGlvbkZyb21MaWdodC53Owp2ZWMzIHV2RGVwdGg9dmVjMygwLjUqY2xpcFNwYWNlLnh5eit2ZWMzKDAuNSkpOwp1dkRlcHRoLno9Y2xhbXAoWklOQ0xJUCwwLixHUkVBVEVTVF9MRVNTX1RIQU5fT05FKTsKdmVjMiB1dj11dkRlcHRoLnh5KnNoYWRvd01hcFNpemVBbmRJbnZlcnNlLng7IAp1dis9MC41OyAKdmVjMiBzdD1mcmFjdCh1dik7IAp2ZWMyIGJhc2VfdXY9Zmxvb3IodXYpLTAuNTsgCmJhc2VfdXYqPXNoYWRvd01hcFNpemVBbmRJbnZlcnNlLnk7IAp2ZWMyIHV2dzA9NC4tMy4qc3Q7CnZlYzIgdXZ3MT12ZWMyKDcuKTsKdmVjMiB1dncyPTEuKzMuKnN0Owp2ZWMzIHU9dmVjMygoMy4tMi4qc3QueCkvdXZ3MC54LTIuLCgzLitzdC54KS91dncxLngsc3QueC91dncyLngrMi4pKnNoYWRvd01hcFNpemVBbmRJbnZlcnNlLnk7CnZlYzMgdj12ZWMzKCgzLi0yLipzdC55KS91dncwLnktMi4sKDMuK3N0LnkpL3V2dzEueSxzdC55L3V2dzIueSsyLikqc2hhZG93TWFwU2l6ZUFuZEludmVyc2UueTsKZmxvYXQgc2hhZG93PTAuOwpzaGFkb3crPXV2dzAueCp1dncwLnkqdGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdmVjNChiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzBdKSxsYXllcix1dkRlcHRoLnopKTsKc2hhZG93Kz11dncxLngqdXZ3MC55KnRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHZlYzQoYmFzZV91di54eSt2ZWMyKHVbMV0sdlswXSksbGF5ZXIsdXZEZXB0aC56KSk7CnNoYWRvdys9dXZ3Mi54KnV2dzAueSp0ZXh0dXJlMkQoc2hhZG93U2FtcGxlcix2ZWM0KGJhc2VfdXYueHkrdmVjMih1WzJdLHZbMF0pLGxheWVyLHV2RGVwdGgueikpOwpzaGFkb3crPXV2dzAueCp1dncxLnkqdGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdmVjNChiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzFdKSxsYXllcix1dkRlcHRoLnopKTsKc2hhZG93Kz11dncxLngqdXZ3MS55KnRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHZlYzQoYmFzZV91di54eSt2ZWMyKHVbMV0sdlsxXSksbGF5ZXIsdXZEZXB0aC56KSk7CnNoYWRvdys9dXZ3Mi54KnV2dzEueSp0ZXh0dXJlMkQoc2hhZG93U2FtcGxlcix2ZWM0KGJhc2VfdXYueHkrdmVjMih1WzJdLHZbMV0pLGxheWVyLHV2RGVwdGgueikpOwpzaGFkb3crPXV2dzAueCp1dncyLnkqdGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdmVjNChiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzJdKSxsYXllcix1dkRlcHRoLnopKTsKc2hhZG93Kz11dncxLngqdXZ3Mi55KnRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHZlYzQoYmFzZV91di54eSt2ZWMyKHVbMV0sdlsyXSksbGF5ZXIsdXZEZXB0aC56KSk7CnNoYWRvdys9dXZ3Mi54KnV2dzIueSp0ZXh0dXJlMkQoc2hhZG93U2FtcGxlcix2ZWM0KGJhc2VfdXYueHkrdmVjMih1WzJdLHZbMl0pLGxheWVyLHV2RGVwdGgueikpOwpzaGFkb3c9c2hhZG93LzE0NC47CnNoYWRvdz1taXgoZGFya25lc3MsMS4sc2hhZG93KTsKcmV0dXJuIGNvbXB1dGVGYWxsT2ZmKHNoYWRvdyxjbGlwU3BhY2UueHksZnJ1c3R1bUVkZ2VGYWxsb2ZmKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aFBDRjEodmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsaGlnaHAgc2FtcGxlcjJEU2hhZG93IHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmKQp7CmlmIChkZXB0aE1ldHJpYz4xLjAgfHwgZGVwdGhNZXRyaWM8MC4wKSB7CnJldHVybiAxLjA7Cn0KZWxzZQp7CnZlYzMgY2xpcFNwYWNlPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7CnZlYzMgdXZEZXB0aD12ZWMzKDAuNSpjbGlwU3BhY2UueHl6K3ZlYzMoMC41KSk7CnV2RGVwdGguej1aSU5DTElQOwpmbG9hdCBzaGFkb3c9VEVYVFVSRUZVTkMoc2hhZG93U2FtcGxlcix1dkRlcHRoLDAuKTsKc2hhZG93PW1peChkYXJrbmVzcywxLixzaGFkb3cpOwpyZXR1cm4gY29tcHV0ZUZhbGxPZmYoc2hhZG93LGNsaXBTcGFjZS54eSxmcnVzdHVtRWRnZUZhbGxvZmYpOwp9Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhQQ0YzKHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVyLHZlYzIgc2hhZG93TWFwU2l6ZUFuZEludmVyc2UsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmKQp7CmlmIChkZXB0aE1ldHJpYz4xLjAgfHwgZGVwdGhNZXRyaWM8MC4wKSB7CnJldHVybiAxLjA7Cn0KZWxzZQp7CnZlYzMgY2xpcFNwYWNlPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7CnZlYzMgdXZEZXB0aD12ZWMzKDAuNSpjbGlwU3BhY2UueHl6K3ZlYzMoMC41KSk7CnV2RGVwdGguej1aSU5DTElQOwp2ZWMyIHV2PXV2RGVwdGgueHkqc2hhZG93TWFwU2l6ZUFuZEludmVyc2UueDsgCnV2Kz0wLjU7IAp2ZWMyIHN0PWZyYWN0KHV2KTsgCnZlYzIgYmFzZV91dj1mbG9vcih1diktMC41OyAKYmFzZV91dio9c2hhZG93TWFwU2l6ZUFuZEludmVyc2UueTsgCnZlYzIgdXZ3MD0zLi0yLipzdDsKdmVjMiB1dncxPTEuKzIuKnN0Owp2ZWMyIHU9dmVjMigoMi4tc3QueCkvdXZ3MC54LTEuLHN0LngvdXZ3MS54KzEuKSpzaGFkb3dNYXBTaXplQW5kSW52ZXJzZS55Owp2ZWMyIHY9dmVjMigoMi4tc3QueSkvdXZ3MC55LTEuLHN0LnkvdXZ3MS55KzEuKSpzaGFkb3dNYXBTaXplQW5kSW52ZXJzZS55OwpmbG9hdCBzaGFkb3c9MC47CnNoYWRvdys9dXZ3MC54KnV2dzAueSpURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHZlYzMoYmFzZV91di54eSt2ZWMyKHVbMF0sdlswXSksdXZEZXB0aC56KSwwLik7CnNoYWRvdys9dXZ3MS54KnV2dzAueSpURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHZlYzMoYmFzZV91di54eSt2ZWMyKHVbMV0sdlswXSksdXZEZXB0aC56KSwwLik7CnNoYWRvdys9dXZ3MC54KnV2dzEueSpURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHZlYzMoYmFzZV91di54eSt2ZWMyKHVbMF0sdlsxXSksdXZEZXB0aC56KSwwLik7CnNoYWRvdys9dXZ3MS54KnV2dzEueSpURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHZlYzMoYmFzZV91di54eSt2ZWMyKHVbMV0sdlsxXSksdXZEZXB0aC56KSwwLik7CnNoYWRvdz1zaGFkb3cvMTYuOwpzaGFkb3c9bWl4KGRhcmtuZXNzLDEuLHNoYWRvdyk7CnJldHVybiBjb21wdXRlRmFsbE9mZihzaGFkb3csY2xpcFNwYWNlLnh5LGZydXN0dW1FZGdlRmFsbG9mZik7Cn0KfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aFBDRjUodmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsaGlnaHAgc2FtcGxlcjJEU2hhZG93IHNoYWRvd1NhbXBsZXIsdmVjMiBzaGFkb3dNYXBTaXplQW5kSW52ZXJzZSxmbG9hdCBkYXJrbmVzcyxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYpCnsKaWYgKGRlcHRoTWV0cmljPjEuMCB8fCBkZXB0aE1ldHJpYzwwLjApIHsKcmV0dXJuIDEuMDsKfQplbHNlCnsKdmVjMyBjbGlwU3BhY2U9dlBvc2l0aW9uRnJvbUxpZ2h0Lnh5ei92UG9zaXRpb25Gcm9tTGlnaHQudzsKdmVjMyB1dkRlcHRoPXZlYzMoMC41KmNsaXBTcGFjZS54eXordmVjMygwLjUpKTsKdXZEZXB0aC56PVpJTkNMSVA7CnZlYzIgdXY9dXZEZXB0aC54eSpzaGFkb3dNYXBTaXplQW5kSW52ZXJzZS54OyAKdXYrPTAuNTsgCnZlYzIgc3Q9ZnJhY3QodXYpOyAKdmVjMiBiYXNlX3V2PWZsb29yKHV2KS0wLjU7IApiYXNlX3V2Kj1zaGFkb3dNYXBTaXplQW5kSW52ZXJzZS55OyAKdmVjMiB1dncwPTQuLTMuKnN0Owp2ZWMyIHV2dzE9dmVjMig3Lik7CnZlYzIgdXZ3Mj0xLiszLipzdDsKdmVjMyB1PXZlYzMoKDMuLTIuKnN0LngpL3V2dzAueC0yLiwoMy4rc3QueCkvdXZ3MS54LHN0LngvdXZ3Mi54KzIuKSpzaGFkb3dNYXBTaXplQW5kSW52ZXJzZS55Owp2ZWMzIHY9dmVjMygoMy4tMi4qc3QueSkvdXZ3MC55LTIuLCgzLitzdC55KS91dncxLnksc3QueS91dncyLnkrMi4pKnNoYWRvd01hcFNpemVBbmRJbnZlcnNlLnk7CmZsb2F0IHNoYWRvdz0wLjsKc2hhZG93Kz11dncwLngqdXZ3MC55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzBdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncxLngqdXZ3MC55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsxXSx2WzBdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncyLngqdXZ3MC55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsyXSx2WzBdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncwLngqdXZ3MS55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzFdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncxLngqdXZ3MS55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsxXSx2WzFdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncyLngqdXZ3MS55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsyXSx2WzFdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncwLngqdXZ3Mi55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzJdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncxLngqdXZ3Mi55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsxXSx2WzJdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncyLngqdXZ3Mi55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsyXSx2WzJdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93PXNoYWRvdy8xNDQuOwpzaGFkb3c9bWl4KGRhcmtuZXNzLDEuLHNoYWRvdyk7CnJldHVybiBjb21wdXRlRmFsbE9mZihzaGFkb3csY2xpcFNwYWNlLnh5LGZydXN0dW1FZGdlRmFsbG9mZik7Cn0KfQpjb25zdCB2ZWMzIFBvaXNzb25TYW1wbGVyczMyWzY0XT12ZWMzWzY0XSgKdmVjMygwLjA2NDA3MDEzLDAuMDU0MDk5MjcsMC4pLAp2ZWMzKDAuNzM2NjU3NywwLjU3ODkzOTQsMC4pLAp2ZWMzKC0wLjYyNzA1NDIsLTAuNTMyMDI3OCwwLiksCnZlYzMoLTAuNDA5NjEwNywwLjg0MTEwOTUsMC4pLAp2ZWMzKDAuNjg0OTU2NCwtMC40OTkwODE4LDAuKSwKdmVjMygtMC44NzQxODEsLTAuMDQ1Nzk3MzUsMC4pLAp2ZWMzKDAuOTk4OTk5OCwwLjAwMDk4ODAwNjYsMC4pLAp2ZWMzKC0wLjAwNDkyMDU3OCwtMC45MTUxNjQ5LDAuKSwKdmVjMygwLjE4MDU3NjMsMC45NzQ3NDgzLDAuKSwKdmVjMygtMC4yMTM4NDUxLDAuMjYzNTgxOCwwLiksCnZlYzMoMC4xMDk4NDUsMC4zODg0Nzg1LDAuKSwKdmVjMygwLjA2ODc2NzU1LC0wLjM1ODEwNzQsMC4pLAp2ZWMzKDAuMzc0MDczLC0wLjc2NjEyNjYsMC4pLAp2ZWMzKDAuMzA3OTEzMiwtMC4xMjE2NzYzLDAuKSwKdmVjMygtMC4zNzk0MzM1LC0wLjgyNzE1ODMsMC4pLAp2ZWMzKC0wLjIwMzg3OCwtMC4wNzcxNTAzNCwwLiksCnZlYzMoMC41OTEyNjk3LDAuMTQ2OTc5OSwwLiksCnZlYzMoLTAuODgwNjksMC4zMDMxNzg0LDAuKSwKdmVjMygwLjUwNDAxMDgsMC44MjgzNzIyLDAuKSwKdmVjMygtMC41ODQ0MTI0LDAuNTQ5NDg3NywwLiksCnZlYzMoMC42MDE3Nzk5LC0wLjE3MjY2NTQsMC4pLAp2ZWMzKC0wLjU1NTQ5ODEsMC4xNTU5OTk3LDAuKSwKdmVjMygtMC4zMDE2MzY5LC0wLjM5MDA5MjgsMC4pLAp2ZWMzKC0wLjU1NTA2MzIsLTAuMTcyMzc2MiwwLiksCnZlYzMoMC45MjUwMjksMC4yOTk1MDQxLDAuKSwKdmVjMygtMC4yNDczMTM3LDAuNTUzODUwNSwwLiksCnZlYzMoMC45MTgzMDM3LC0wLjI4NjIzOTIsMC4pLAp2ZWMzKDAuMjQ2OTQyMSwwLjY3MTg3MTIsMC4pLAp2ZWMzKDAuMzkxNjM5NywtMC40MzI4MjA5LDAuKSwKdmVjMygtMC4wMzU3NjkyNywtMC42MjIwMDMyLDAuKSwKdmVjMygtMC4wNDY2MTI1NSwwLjc5OTUyMDEsMC4pLAp2ZWMzKDAuNDQwMjkyNCwwLjM2NDAzMTIsMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLikKKTsKY29uc3QgdmVjMyBQb2lzc29uU2FtcGxlcnM2NFs2NF09dmVjM1s2NF0oCnZlYzMoLTAuNjEzMzkyLDAuNjE3NDgxLDAuKSwKdmVjMygwLjE3MDAxOSwtMC4wNDAyNTQsMC4pLAp2ZWMzKC0wLjI5OTQxNywwLjc5MTkyNSwwLiksCnZlYzMoMC42NDU2ODAsMC40OTMyMTAsMC4pLAp2ZWMzKC0wLjY1MTc4NCwwLjcxNzg4NywwLiksCnZlYzMoMC40MjEwMDMsMC4wMjcwNzAsMC4pLAp2ZWMzKC0wLjgxNzE5NCwtMC4yNzEwOTYsMC4pLAp2ZWMzKC0wLjcwNTM3NCwtMC42NjgyMDMsMC4pLAp2ZWMzKDAuOTc3MDUwLC0wLjEwODYxNSwwLiksCnZlYzMoMC4wNjMzMjYsMC4xNDIzNjksMC4pLAp2ZWMzKDAuMjAzNTI4LDAuMjE0MzMxLDAuKSwKdmVjMygtMC42Njc1MzEsMC4zMjYwOTAsMC4pLAp2ZWMzKC0wLjA5ODQyMiwtMC4yOTU3NTUsMC4pLAp2ZWMzKC0wLjg4NTkyMiwwLjIxNTM2OSwwLiksCnZlYzMoMC41NjY2MzcsMC42MDUyMTMsMC4pLAp2ZWMzKDAuMDM5NzY2LC0wLjM5NjEwMCwwLiksCnZlYzMoMC43NTE5NDYsMC40NTMzNTIsMC4pLAp2ZWMzKDAuMDc4NzA3LC0wLjcxNTMyMywwLiksCnZlYzMoLTAuMDc1ODM4LC0wLjUyOTM0NCwwLiksCnZlYzMoMC43MjQ0NzksLTAuNTgwNzk4LDAuKSwKdmVjMygwLjIyMjk5OSwtMC4yMTUxMjUsMC4pLAp2ZWMzKC0wLjQ2NzU3NCwtMC40MDU0MzgsMC4pLAp2ZWMzKC0wLjI0ODI2OCwtMC44MTQ3NTMsMC4pLAp2ZWMzKDAuMzU0NDExLC0wLjg4NzU3MCwwLiksCnZlYzMoMC4xNzU4MTcsMC4zODIzNjYsMC4pLAp2ZWMzKDAuNDg3NDcyLC0wLjA2MzA4MiwwLiksCnZlYzMoLTAuMDg0MDc4LDAuODk4MzEyLDAuKSwKdmVjMygwLjQ4ODg3NiwtMC43ODM0NDEsMC4pLAp2ZWMzKDAuNDcwMDE2LDAuMjE3OTMzLDAuKSwKdmVjMygtMC42OTY4OTAsLTAuNTQ5NzkxLDAuKSwKdmVjMygtMC4xNDk2OTMsMC42MDU3NjIsMC4pLAp2ZWMzKDAuMDM0MjExLDAuOTc5OTgwLDAuKSwKdmVjMygwLjUwMzA5OCwtMC4zMDg4NzgsMC4pLAp2ZWMzKC0wLjAxNjIwNSwtMC44NzI5MjEsMC4pLAp2ZWMzKDAuMzg1Nzg0LC0wLjM5MzkwMiwwLiksCnZlYzMoLTAuMTQ2ODg2LC0wLjg1OTI0OSwwLiksCnZlYzMoMC42NDMzNjEsMC4xNjQwOTgsMC4pLAp2ZWMzKDAuNjM0Mzg4LC0wLjA0OTQ3MSwwLiksCnZlYzMoLTAuNjg4ODk0LDAuMDA3ODQzLDAuKSwKdmVjMygwLjQ2NDAzNCwtMC4xODg4MTgsMC4pLAp2ZWMzKC0wLjQ0MDg0MCwwLjEzNzQ4NiwwLiksCnZlYzMoMC4zNjQ0ODMsMC41MTE3MDQsMC4pLAp2ZWMzKDAuMDM0MDI4LDAuMzI1OTY4LDAuKSwKdmVjMygwLjA5OTA5NCwtMC4zMDgwMjMsMC4pLAp2ZWMzKDAuNjkzOTYwLC0wLjM2NjI1MywwLiksCnZlYzMoMC42Nzg4ODQsLTAuMjA0Njg4LDAuKSwKdmVjMygwLjAwMTgwMSwwLjc4MDMyOCwwLiksCnZlYzMoMC4xNDUxNzcsLTAuODk4OTg0LDAuKSwKdmVjMygwLjA2MjY1NSwtMC42MTE4NjYsMC4pLAp2ZWMzKDAuMzE1MjI2LC0wLjYwNDI5NywwLiksCnZlYzMoLTAuNzgwMTQ1LDAuNDg2MjUxLDAuKSwKdmVjMygtMC4zNzE4NjgsMC44ODIxMzgsMC4pLAp2ZWMzKDAuMjAwNDc2LDAuNDk0NDMwLDAuKSwKdmVjMygtMC40OTQ1NTIsLTAuNzExMDUxLDAuKSwKdmVjMygwLjYxMjQ3NiwwLjcwNTI1MiwwLiksCnZlYzMoLTAuNTc4ODQ1LC0wLjc2ODc5MiwwLiksCnZlYzMoLTAuNzcyNDU0LC0wLjA5MDk3NiwwLiksCnZlYzMoMC41MDQ0NDAsMC4zNzIyOTUsMC4pLAp2ZWMzKDAuMTU1NzM2LDAuMDY1MTU3LDAuKSwKdmVjMygwLjM5MTUyMiwwLjg0OTYwNSwwLiksCnZlYzMoLTAuNjIwMTA2LC0wLjMyODEwNCwwLiksCnZlYzMoMC43ODkyMzksLTAuNDE5OTY1LDAuKSwKdmVjMygtMC41NDUzOTYsMC41MzgxMzMsMC4pLAp2ZWMzKC0wLjE3ODU2NCwtMC41OTYwNTcsMC4pCik7CiNkZWZpbmUgaW5saW5lCmZsb2F0IGNvbXB1dGVTaGFkb3dXaXRoQ1NNUENTUyhmbG9hdCBsYXllcix2ZWM0IHZQb3NpdGlvbkZyb21MaWdodCxmbG9hdCBkZXB0aE1ldHJpYyxoaWdocCBzYW1wbGVyMkRBcnJheSBkZXB0aFNhbXBsZXIsaGlnaHAgc2FtcGxlcjJEQXJyYXlTaGFkb3cgc2hhZG93U2FtcGxlcixmbG9hdCBzaGFkb3dNYXBTaXplSW52ZXJzZSxmbG9hdCBsaWdodFNpemVVVixmbG9hdCBkYXJrbmVzcyxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYsaW50IHNlYXJjaFRhcENvdW50LGludCBwY2ZUYXBDb3VudCx2ZWMzWzY0XSBwb2lzc29uU2FtcGxlcnMsdmVjMiBsaWdodFNpemVVVkNvcnJlY3Rpb24sZmxvYXQgZGVwdGhDb3JyZWN0aW9uLGZsb2F0IHBlbnVtYnJhRGFya25lc3MpCnsKdmVjMyBjbGlwU3BhY2U9dlBvc2l0aW9uRnJvbUxpZ2h0Lnh5ei92UG9zaXRpb25Gcm9tTGlnaHQudzsKdmVjMyB1dkRlcHRoPXZlYzMoMC41KmNsaXBTcGFjZS54eXordmVjMygwLjUpKTsKdXZEZXB0aC56PWNsYW1wKFpJTkNMSVAsMC4sR1JFQVRFU1RfTEVTU19USEFOX09ORSk7CnZlYzQgdXZEZXB0aExheWVyPXZlYzQodXZEZXB0aC54LHV2RGVwdGgueSxsYXllcix1dkRlcHRoLnopOwpmbG9hdCBibG9ja2VyRGVwdGg9MC4wOwpmbG9hdCBzdW1CbG9ja2VyRGVwdGg9MC4wOwpmbG9hdCBudW1CbG9ja2VyPTAuMDsKZm9yIChpbnQgaT0wOyBpPHNlYXJjaFRhcENvdW50OyBpICsrKSB7CmJsb2NrZXJEZXB0aD10ZXh0dXJlMkQoZGVwdGhTYW1wbGVyLHZlYzModXZEZXB0aC54eSsobGlnaHRTaXplVVYqbGlnaHRTaXplVVZDb3JyZWN0aW9uKnNoYWRvd01hcFNpemVJbnZlcnNlKlBvaXNzb25TYW1wbGVyczMyW2ldLnh5KSxsYXllcikpLnI7CmlmIChibG9ja2VyRGVwdGg8ZGVwdGhNZXRyaWMpIHsKc3VtQmxvY2tlckRlcHRoKz1ibG9ja2VyRGVwdGg7Cm51bUJsb2NrZXIrKzsKfQp9CmZsb2F0IGF2Z0Jsb2NrZXJEZXB0aD1zdW1CbG9ja2VyRGVwdGgvbnVtQmxvY2tlcjsKZmxvYXQgQUFPZmZzZXQ9c2hhZG93TWFwU2l6ZUludmVyc2UqMTAuOwpmbG9hdCBwZW51bWJyYVJhdGlvPSgoZGVwdGhNZXRyaWMtYXZnQmxvY2tlckRlcHRoKSpkZXB0aENvcnJlY3Rpb24rQUFPZmZzZXQpOwp2ZWM0IGZpbHRlclJhZGl1cz12ZWM0KHBlbnVtYnJhUmF0aW8qbGlnaHRTaXplVVYqbGlnaHRTaXplVVZDb3JyZWN0aW9uKnNoYWRvd01hcFNpemVJbnZlcnNlLDAuLDAuKTsKZmxvYXQgcmFuZG9tPWdldFJhbmQodlBvc2l0aW9uRnJvbUxpZ2h0Lnh5KTsKZmxvYXQgcm90YXRpb25BbmdsZT1yYW5kb20qMy4xNDE1OTI2Owp2ZWMyIHJvdGF0aW9uVmVjdG9yPXZlYzIoY29zKHJvdGF0aW9uQW5nbGUpLHNpbihyb3RhdGlvbkFuZ2xlKSk7CmZsb2F0IHNoYWRvdz0wLjsKZm9yIChpbnQgaT0wOyBpPHBjZlRhcENvdW50OyBpKyspIHsKdmVjNCBvZmZzZXQ9dmVjNChwb2lzc29uU2FtcGxlcnNbaV0sMC4pOwpvZmZzZXQ9dmVjNChvZmZzZXQueCpyb3RhdGlvblZlY3Rvci54LW9mZnNldC55KnJvdGF0aW9uVmVjdG9yLnksb2Zmc2V0Lnkqcm90YXRpb25WZWN0b3IueCtvZmZzZXQueCpyb3RhdGlvblZlY3Rvci55LDAuLDAuKTsKc2hhZG93Kz10ZXh0dXJlMkQoc2hhZG93U2FtcGxlcix1dkRlcHRoTGF5ZXIrb2Zmc2V0KmZpbHRlclJhZGl1cyk7Cn0Kc2hhZG93Lz1mbG9hdChwY2ZUYXBDb3VudCk7CnNoYWRvdz1taXgoc2hhZG93LDEuLG1pbigoZGVwdGhNZXRyaWMtYXZnQmxvY2tlckRlcHRoKSpkZXB0aENvcnJlY3Rpb24qcGVudW1icmFEYXJrbmVzcywxLikpOwpzaGFkb3c9bWl4KGRhcmtuZXNzLDEuLHNoYWRvdyk7CmlmIChudW1CbG9ja2VyPDEuMCkgewpyZXR1cm4gMS4wOwp9CmVsc2UKewpyZXR1cm4gY29tcHV0ZUZhbGxPZmYoc2hhZG93LGNsaXBTcGFjZS54eSxmcnVzdHVtRWRnZUZhbGxvZmYpOwp9Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhQQ1NTKHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLHNhbXBsZXIyRCBkZXB0aFNhbXBsZXIsaGlnaHAgc2FtcGxlcjJEU2hhZG93IHNoYWRvd1NhbXBsZXIsZmxvYXQgc2hhZG93TWFwU2l6ZUludmVyc2UsZmxvYXQgbGlnaHRTaXplVVYsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmLGludCBzZWFyY2hUYXBDb3VudCxpbnQgcGNmVGFwQ291bnQsdmVjM1s2NF0gcG9pc3NvblNhbXBsZXJzKQp7CmlmIChkZXB0aE1ldHJpYz4xLjAgfHwgZGVwdGhNZXRyaWM8MC4wKSB7CnJldHVybiAxLjA7Cn0KZWxzZQp7CnZlYzMgY2xpcFNwYWNlPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7CnZlYzMgdXZEZXB0aD12ZWMzKDAuNSpjbGlwU3BhY2UueHl6K3ZlYzMoMC41KSk7CnV2RGVwdGguej1aSU5DTElQOwpmbG9hdCBibG9ja2VyRGVwdGg9MC4wOwpmbG9hdCBzdW1CbG9ja2VyRGVwdGg9MC4wOwpmbG9hdCBudW1CbG9ja2VyPTAuMDsKZm9yIChpbnQgaT0wOyBpPHNlYXJjaFRhcENvdW50OyBpICsrKSB7CmJsb2NrZXJEZXB0aD1URVhUVVJFRlVOQyhkZXB0aFNhbXBsZXIsdXZEZXB0aC54eSsobGlnaHRTaXplVVYqc2hhZG93TWFwU2l6ZUludmVyc2UqUG9pc3NvblNhbXBsZXJzMzJbaV0ueHkpLDAuKS5yOwppZiAoYmxvY2tlckRlcHRoPGRlcHRoTWV0cmljKSB7CnN1bUJsb2NrZXJEZXB0aCs9YmxvY2tlckRlcHRoOwpudW1CbG9ja2VyKys7Cn0KfQppZiAobnVtQmxvY2tlcjwxLjApIHsKcmV0dXJuIDEuMDsKfQplbHNlCnsKZmxvYXQgYXZnQmxvY2tlckRlcHRoPXN1bUJsb2NrZXJEZXB0aC9udW1CbG9ja2VyOwpmbG9hdCBBQU9mZnNldD1zaGFkb3dNYXBTaXplSW52ZXJzZSoxMC47CmZsb2F0IHBlbnVtYnJhUmF0aW89KChkZXB0aE1ldHJpYy1hdmdCbG9ja2VyRGVwdGgpK0FBT2Zmc2V0KTsKZmxvYXQgZmlsdGVyUmFkaXVzPXBlbnVtYnJhUmF0aW8qbGlnaHRTaXplVVYqc2hhZG93TWFwU2l6ZUludmVyc2U7CmZsb2F0IHJhbmRvbT1nZXRSYW5kKHZQb3NpdGlvbkZyb21MaWdodC54eSk7CmZsb2F0IHJvdGF0aW9uQW5nbGU9cmFuZG9tKjMuMTQxNTkyNjsKdmVjMiByb3RhdGlvblZlY3Rvcj12ZWMyKGNvcyhyb3RhdGlvbkFuZ2xlKSxzaW4ocm90YXRpb25BbmdsZSkpOwpmbG9hdCBzaGFkb3c9MC47CmZvciAoaW50IGk9MDsgaTxwY2ZUYXBDb3VudDsgaSsrKSB7CnZlYzMgb2Zmc2V0PXBvaXNzb25TYW1wbGVyc1tpXTsKb2Zmc2V0PXZlYzMob2Zmc2V0Lngqcm90YXRpb25WZWN0b3IueC1vZmZzZXQueSpyb3RhdGlvblZlY3Rvci55LG9mZnNldC55KnJvdGF0aW9uVmVjdG9yLngrb2Zmc2V0Lngqcm90YXRpb25WZWN0b3IueSwwLik7CnNoYWRvdys9VEVYVFVSRUZVTkMoc2hhZG93U2FtcGxlcix1dkRlcHRoK29mZnNldCpmaWx0ZXJSYWRpdXMsMC4pOwp9CnNoYWRvdy89ZmxvYXQocGNmVGFwQ291bnQpOwpzaGFkb3c9bWl4KHNoYWRvdywxLixkZXB0aE1ldHJpYy1hdmdCbG9ja2VyRGVwdGgpOwpzaGFkb3c9bWl4KGRhcmtuZXNzLDEuLHNoYWRvdyk7CnJldHVybiBjb21wdXRlRmFsbE9mZihzaGFkb3csY2xpcFNwYWNlLnh5LGZydXN0dW1FZGdlRmFsbG9mZik7Cn0KfQp9CiNkZWZpbmUgaW5saW5lCmZsb2F0IGNvbXB1dGVTaGFkb3dXaXRoUENTUzE2KHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLHNhbXBsZXIyRCBkZXB0aFNhbXBsZXIsaGlnaHAgc2FtcGxlcjJEU2hhZG93IHNoYWRvd1NhbXBsZXIsZmxvYXQgc2hhZG93TWFwU2l6ZUludmVyc2UsZmxvYXQgbGlnaHRTaXplVVYsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmKQp7CnJldHVybiBjb21wdXRlU2hhZG93V2l0aFBDU1ModlBvc2l0aW9uRnJvbUxpZ2h0LGRlcHRoTWV0cmljLGRlcHRoU2FtcGxlcixzaGFkb3dTYW1wbGVyLHNoYWRvd01hcFNpemVJbnZlcnNlLGxpZ2h0U2l6ZVVWLGRhcmtuZXNzLGZydXN0dW1FZGdlRmFsbG9mZiwxNiwxNixQb2lzc29uU2FtcGxlcnMzMik7Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhQQ1NTMzIodmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsc2FtcGxlcjJEIGRlcHRoU2FtcGxlcixoaWdocCBzYW1wbGVyMkRTaGFkb3cgc2hhZG93U2FtcGxlcixmbG9hdCBzaGFkb3dNYXBTaXplSW52ZXJzZSxmbG9hdCBsaWdodFNpemVVVixmbG9hdCBkYXJrbmVzcyxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYpCnsKcmV0dXJuIGNvbXB1dGVTaGFkb3dXaXRoUENTUyh2UG9zaXRpb25Gcm9tTGlnaHQsZGVwdGhNZXRyaWMsZGVwdGhTYW1wbGVyLHNoYWRvd1NhbXBsZXIsc2hhZG93TWFwU2l6ZUludmVyc2UsbGlnaHRTaXplVVYsZGFya25lc3MsZnJ1c3R1bUVkZ2VGYWxsb2ZmLDE2LDMyLFBvaXNzb25TYW1wbGVyczMyKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aFBDU1M2NCh2ZWM0IHZQb3NpdGlvbkZyb21MaWdodCxmbG9hdCBkZXB0aE1ldHJpYyxzYW1wbGVyMkQgZGVwdGhTYW1wbGVyLGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVyLGZsb2F0IHNoYWRvd01hcFNpemVJbnZlcnNlLGZsb2F0IGxpZ2h0U2l6ZVVWLGZsb2F0IGRhcmtuZXNzLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZikKewpyZXR1cm4gY29tcHV0ZVNoYWRvd1dpdGhQQ1NTKHZQb3NpdGlvbkZyb21MaWdodCxkZXB0aE1ldHJpYyxkZXB0aFNhbXBsZXIsc2hhZG93U2FtcGxlcixzaGFkb3dNYXBTaXplSW52ZXJzZSxsaWdodFNpemVVVixkYXJrbmVzcyxmcnVzdHVtRWRnZUZhbGxvZmYsMzIsNjQsUG9pc3NvblNhbXBsZXJzNjQpOwp9CiNkZWZpbmUgaW5saW5lCmZsb2F0IGNvbXB1dGVTaGFkb3dXaXRoQ1NNUENTUzE2KGZsb2F0IGxheWVyLHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLGhpZ2hwIHNhbXBsZXIyREFycmF5IGRlcHRoU2FtcGxlcixoaWdocCBzYW1wbGVyMkRBcnJheVNoYWRvdyBzaGFkb3dTYW1wbGVyLGZsb2F0IHNoYWRvd01hcFNpemVJbnZlcnNlLGZsb2F0IGxpZ2h0U2l6ZVVWLGZsb2F0IGRhcmtuZXNzLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZix2ZWMyIGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbixmbG9hdCBkZXB0aENvcnJlY3Rpb24sZmxvYXQgcGVudW1icmFEYXJrbmVzcykKewpyZXR1cm4gY29tcHV0ZVNoYWRvd1dpdGhDU01QQ1NTKGxheWVyLHZQb3NpdGlvbkZyb21MaWdodCxkZXB0aE1ldHJpYyxkZXB0aFNhbXBsZXIsc2hhZG93U2FtcGxlcixzaGFkb3dNYXBTaXplSW52ZXJzZSxsaWdodFNpemVVVixkYXJrbmVzcyxmcnVzdHVtRWRnZUZhbGxvZmYsMTYsMTYsUG9pc3NvblNhbXBsZXJzMzIsbGlnaHRTaXplVVZDb3JyZWN0aW9uLGRlcHRoQ29ycmVjdGlvbixwZW51bWJyYURhcmtuZXNzKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aENTTVBDU1MzMihmbG9hdCBsYXllcix2ZWM0IHZQb3NpdGlvbkZyb21MaWdodCxmbG9hdCBkZXB0aE1ldHJpYyxoaWdocCBzYW1wbGVyMkRBcnJheSBkZXB0aFNhbXBsZXIsaGlnaHAgc2FtcGxlcjJEQXJyYXlTaGFkb3cgc2hhZG93U2FtcGxlcixmbG9hdCBzaGFkb3dNYXBTaXplSW52ZXJzZSxmbG9hdCBsaWdodFNpemVVVixmbG9hdCBkYXJrbmVzcyxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYsdmVjMiBsaWdodFNpemVVVkNvcnJlY3Rpb24sZmxvYXQgZGVwdGhDb3JyZWN0aW9uLGZsb2F0IHBlbnVtYnJhRGFya25lc3MpCnsKcmV0dXJuIGNvbXB1dGVTaGFkb3dXaXRoQ1NNUENTUyhsYXllcix2UG9zaXRpb25Gcm9tTGlnaHQsZGVwdGhNZXRyaWMsZGVwdGhTYW1wbGVyLHNoYWRvd1NhbXBsZXIsc2hhZG93TWFwU2l6ZUludmVyc2UsbGlnaHRTaXplVVYsZGFya25lc3MsZnJ1c3R1bUVkZ2VGYWxsb2ZmLDE2LDMyLFBvaXNzb25TYW1wbGVyczMyLGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbixkZXB0aENvcnJlY3Rpb24scGVudW1icmFEYXJrbmVzcyk7Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhDU01QQ1NTNjQoZmxvYXQgbGF5ZXIsdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsaGlnaHAgc2FtcGxlcjJEQXJyYXkgZGVwdGhTYW1wbGVyLGhpZ2hwIHNhbXBsZXIyREFycmF5U2hhZG93IHNoYWRvd1NhbXBsZXIsZmxvYXQgc2hhZG93TWFwU2l6ZUludmVyc2UsZmxvYXQgbGlnaHRTaXplVVYsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmLHZlYzIgbGlnaHRTaXplVVZDb3JyZWN0aW9uLGZsb2F0IGRlcHRoQ29ycmVjdGlvbixmbG9hdCBwZW51bWJyYURhcmtuZXNzKQp7CnJldHVybiBjb21wdXRlU2hhZG93V2l0aENTTVBDU1MobGF5ZXIsdlBvc2l0aW9uRnJvbUxpZ2h0LGRlcHRoTWV0cmljLGRlcHRoU2FtcGxlcixzaGFkb3dTYW1wbGVyLHNoYWRvd01hcFNpemVJbnZlcnNlLGxpZ2h0U2l6ZVVWLGRhcmtuZXNzLGZydXN0dW1FZGdlRmFsbG9mZiwzMiw2NCxQb2lzc29uU2FtcGxlcnM2NCxsaWdodFNpemVVVkNvcnJlY3Rpb24sZGVwdGhDb3JyZWN0aW9uLHBlbnVtYnJhRGFya25lc3MpOwp9CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW0pvXT1laDtjb25zdCB0aD0ic2FtcGxlckZyYWdtZW50RGVjbGFyYXRpb24iLGloPWAjaWZkZWYgX0RFRklORU5BTUVfCiNpZiBfREVGSU5FTkFNRV9ESVJFQ1RVVj09MQojZGVmaW5lIHZfVkFSWUlOR05BTUVfVVYgdk1haW5VVjEKI2VsaWYgX0RFRklORU5BTUVfRElSRUNUVVY9PTIKI2RlZmluZSB2X1ZBUllJTkdOQU1FX1VWIHZNYWluVVYyCiNlbGlmIF9ERUZJTkVOQU1FX0RJUkVDVFVWPT0zCiNkZWZpbmUgdl9WQVJZSU5HTkFNRV9VViB2TWFpblVWMwojZWxpZiBfREVGSU5FTkFNRV9ESVJFQ1RVVj09NAojZGVmaW5lIHZfVkFSWUlOR05BTUVfVVYgdk1haW5VVjQKI2VsaWYgX0RFRklORU5BTUVfRElSRUNUVVY9PTUKI2RlZmluZSB2X1ZBUllJTkdOQU1FX1VWIHZNYWluVVY1CiNlbGlmIF9ERUZJTkVOQU1FX0RJUkVDVFVWPT02CiNkZWZpbmUgdl9WQVJZSU5HTkFNRV9VViB2TWFpblVWNgojZWxzZQp2YXJ5aW5nIHZlYzIgdl9WQVJZSU5HTkFNRV9VVjsKI2VuZGlmCnVuaWZvcm0gc2FtcGxlcjJEIF9TQU1QTEVSTkFNRV9TYW1wbGVyOwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3RoXT1paDtjb25zdCBzaD0iZnJlc25lbEZ1bmN0aW9uIixyaD1gI2lmZGVmIEZSRVNORUwKZmxvYXQgY29tcHV0ZUZyZXNuZWxUZXJtKHZlYzMgdmlld0RpcmVjdGlvbix2ZWMzIHdvcmxkTm9ybWFsLGZsb2F0IGJpYXMsZmxvYXQgcG93ZXIpCnsKZmxvYXQgZnJlc25lbFRlcm09cG93KGJpYXMrYWJzKGRvdCh2aWV3RGlyZWN0aW9uLHdvcmxkTm9ybWFsKSkscG93ZXIpOwpyZXR1cm4gY2xhbXAoZnJlc25lbFRlcm0sMC4sMS4pOwp9CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbc2hdPXJoO2NvbnN0IG5oPSJyZWZsZWN0aW9uRnVuY3Rpb24iLGFoPWB2ZWMzIGNvbXB1dGVGaXhlZEVxdWlyZWN0YW5ndWxhckNvb3Jkcyh2ZWM0IHdvcmxkUG9zLHZlYzMgd29ybGROb3JtYWwsdmVjMyBkaXJlY3Rpb24pCnsKZmxvYXQgbG9uPWF0YW4oZGlyZWN0aW9uLnosZGlyZWN0aW9uLngpOwpmbG9hdCBsYXQ9YWNvcyhkaXJlY3Rpb24ueSk7CnZlYzIgc3BoZXJlQ29vcmRzPXZlYzIobG9uLGxhdCkqUkVDSVBST0NBTF9QSTIqMi4wOwpmbG9hdCBzPXNwaGVyZUNvb3Jkcy54KjAuNSswLjU7CmZsb2F0IHQ9c3BoZXJlQ29vcmRzLnk7CnJldHVybiB2ZWMzKHMsdCwwKTsgCn0KdmVjMyBjb21wdXRlTWlycm9yZWRGaXhlZEVxdWlyZWN0YW5ndWxhckNvb3Jkcyh2ZWM0IHdvcmxkUG9zLHZlYzMgd29ybGROb3JtYWwsdmVjMyBkaXJlY3Rpb24pCnsKZmxvYXQgbG9uPWF0YW4oZGlyZWN0aW9uLnosZGlyZWN0aW9uLngpOwpmbG9hdCBsYXQ9YWNvcyhkaXJlY3Rpb24ueSk7CnZlYzIgc3BoZXJlQ29vcmRzPXZlYzIobG9uLGxhdCkqUkVDSVBST0NBTF9QSTIqMi4wOwpmbG9hdCBzPXNwaGVyZUNvb3Jkcy54KjAuNSswLjU7CmZsb2F0IHQ9c3BoZXJlQ29vcmRzLnk7CnJldHVybiB2ZWMzKDEuMC1zLHQsMCk7IAp9CnZlYzMgY29tcHV0ZUVxdWlyZWN0YW5ndWxhckNvb3Jkcyh2ZWM0IHdvcmxkUG9zLHZlYzMgd29ybGROb3JtYWwsdmVjMyBleWVQb3NpdGlvbixtYXQ0IHJlZmxlY3Rpb25NYXRyaXgpCnsKdmVjMyBjYW1lcmFUb1ZlcnRleD1ub3JtYWxpemUod29ybGRQb3MueHl6LWV5ZVBvc2l0aW9uKTsKdmVjMyByPW5vcm1hbGl6ZShyZWZsZWN0KGNhbWVyYVRvVmVydGV4LHdvcmxkTm9ybWFsKSk7CnI9dmVjMyhyZWZsZWN0aW9uTWF0cml4KnZlYzQociwwKSk7CmZsb2F0IGxvbj1hdGFuKHIueixyLngpOwpmbG9hdCBsYXQ9YWNvcyhyLnkpOwp2ZWMyIHNwaGVyZUNvb3Jkcz12ZWMyKGxvbixsYXQpKlJFQ0lQUk9DQUxfUEkyKjIuMDsKZmxvYXQgcz1zcGhlcmVDb29yZHMueCowLjUrMC41OwpmbG9hdCB0PXNwaGVyZUNvb3Jkcy55OwpyZXR1cm4gdmVjMyhzLHQsMCk7Cn0KdmVjMyBjb21wdXRlU3BoZXJpY2FsQ29vcmRzKHZlYzQgd29ybGRQb3MsdmVjMyB3b3JsZE5vcm1hbCxtYXQ0IHZpZXcsbWF0NCByZWZsZWN0aW9uTWF0cml4KQp7CnZlYzMgdmlld0Rpcj1ub3JtYWxpemUodmVjMyh2aWV3KndvcmxkUG9zKSk7CnZlYzMgdmlld05vcm1hbD1ub3JtYWxpemUodmVjMyh2aWV3KnZlYzQod29ybGROb3JtYWwsMC4wKSkpOwp2ZWMzIHI9cmVmbGVjdCh2aWV3RGlyLHZpZXdOb3JtYWwpOwpyPXZlYzMocmVmbGVjdGlvbk1hdHJpeCp2ZWM0KHIsMCkpOwpyLno9ci56LTEuMDsKZmxvYXQgbT0yLjAqbGVuZ3RoKHIpOwpyZXR1cm4gdmVjMyhyLngvbSswLjUsMS4wLXIueS9tLTAuNSwwKTsKfQp2ZWMzIGNvbXB1dGVQbGFuYXJDb29yZHModmVjNCB3b3JsZFBvcyx2ZWMzIHdvcmxkTm9ybWFsLHZlYzMgZXllUG9zaXRpb24sbWF0NCByZWZsZWN0aW9uTWF0cml4KQp7CnZlYzMgdmlld0Rpcj13b3JsZFBvcy54eXotZXllUG9zaXRpb247CnZlYzMgY29vcmRzPW5vcm1hbGl6ZShyZWZsZWN0KHZpZXdEaXIsd29ybGROb3JtYWwpKTsKcmV0dXJuIHZlYzMocmVmbGVjdGlvbk1hdHJpeCp2ZWM0KGNvb3JkcywxKSk7Cn0KdmVjMyBjb21wdXRlQ3ViaWNDb29yZHModmVjNCB3b3JsZFBvcyx2ZWMzIHdvcmxkTm9ybWFsLHZlYzMgZXllUG9zaXRpb24sbWF0NCByZWZsZWN0aW9uTWF0cml4KQp7CnZlYzMgdmlld0Rpcj1ub3JtYWxpemUod29ybGRQb3MueHl6LWV5ZVBvc2l0aW9uKTsKdmVjMyBjb29yZHM9cmVmbGVjdCh2aWV3RGlyLHdvcmxkTm9ybWFsKTsKY29vcmRzPXZlYzMocmVmbGVjdGlvbk1hdHJpeCp2ZWM0KGNvb3JkcywwKSk7CiNpZmRlZiBJTlZFUlRDVUJJQ01BUApjb29yZHMueSo9LTEuMDsKI2VuZGlmCnJldHVybiBjb29yZHM7Cn0KdmVjMyBjb21wdXRlQ3ViaWNMb2NhbENvb3Jkcyh2ZWM0IHdvcmxkUG9zLHZlYzMgd29ybGROb3JtYWwsdmVjMyBleWVQb3NpdGlvbixtYXQ0IHJlZmxlY3Rpb25NYXRyaXgsdmVjMyByZWZsZWN0aW9uU2l6ZSx2ZWMzIHJlZmxlY3Rpb25Qb3NpdGlvbikKewp2ZWMzIHZpZXdEaXI9bm9ybWFsaXplKHdvcmxkUG9zLnh5ei1leWVQb3NpdGlvbik7CnZlYzMgY29vcmRzPXJlZmxlY3Qodmlld0Rpcix3b3JsZE5vcm1hbCk7CmNvb3Jkcz1wYXJhbGxheENvcnJlY3ROb3JtYWwod29ybGRQb3MueHl6LGNvb3JkcyxyZWZsZWN0aW9uU2l6ZSxyZWZsZWN0aW9uUG9zaXRpb24pOwpjb29yZHM9dmVjMyhyZWZsZWN0aW9uTWF0cml4KnZlYzQoY29vcmRzLDApKTsKI2lmZGVmIElOVkVSVENVQklDTUFQCmNvb3Jkcy55Kj0tMS4wOwojZW5kaWYKcmV0dXJuIGNvb3JkczsKfQp2ZWMzIGNvbXB1dGVQcm9qZWN0aW9uQ29vcmRzKHZlYzQgd29ybGRQb3MsbWF0NCB2aWV3LG1hdDQgcmVmbGVjdGlvbk1hdHJpeCkKewpyZXR1cm4gdmVjMyhyZWZsZWN0aW9uTWF0cml4Kih2aWV3KndvcmxkUG9zKSk7Cn0KdmVjMyBjb21wdXRlU2t5Qm94Q29vcmRzKHZlYzMgcG9zaXRpb25XLG1hdDQgcmVmbGVjdGlvbk1hdHJpeCkKewpyZXR1cm4gdmVjMyhyZWZsZWN0aW9uTWF0cml4KnZlYzQocG9zaXRpb25XLDEuKSk7Cn0KI2lmZGVmIFJFRkxFQ1RJT04KdmVjMyBjb21wdXRlUmVmbGVjdGlvbkNvb3Jkcyh2ZWM0IHdvcmxkUG9zLHZlYzMgd29ybGROb3JtYWwpCnsKI2lmZGVmIFJFRkxFQ1RJT05NQVBfTUlSUk9SRURFUVVJUkVDVEFOR1VMQVJfRklYRUQKdmVjMyBkaXJlY3Rpb249bm9ybWFsaXplKHZEaXJlY3Rpb25XKTsKcmV0dXJuIGNvbXB1dGVNaXJyb3JlZEZpeGVkRXF1aXJlY3Rhbmd1bGFyQ29vcmRzKHdvcmxkUG9zLHdvcmxkTm9ybWFsLGRpcmVjdGlvbik7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVJfRklYRUQKdmVjMyBkaXJlY3Rpb249bm9ybWFsaXplKHZEaXJlY3Rpb25XKTsKcmV0dXJuIGNvbXB1dGVGaXhlZEVxdWlyZWN0YW5ndWxhckNvb3Jkcyh3b3JsZFBvcyx3b3JsZE5vcm1hbCxkaXJlY3Rpb24pOwojZW5kaWYKI2lmZGVmIFJFRkxFQ1RJT05NQVBfRVFVSVJFQ1RBTkdVTEFSCnJldHVybiBjb21wdXRlRXF1aXJlY3Rhbmd1bGFyQ29vcmRzKHdvcmxkUG9zLHdvcmxkTm9ybWFsLHZFeWVQb3NpdGlvbi54eXoscmVmbGVjdGlvbk1hdHJpeCk7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTk1BUF9TUEhFUklDQUwKcmV0dXJuIGNvbXB1dGVTcGhlcmljYWxDb29yZHMod29ybGRQb3Msd29ybGROb3JtYWwsdmlldyxyZWZsZWN0aW9uTWF0cml4KTsKI2VuZGlmCiNpZmRlZiBSRUZMRUNUSU9OTUFQX1BMQU5BUgpyZXR1cm4gY29tcHV0ZVBsYW5hckNvb3Jkcyh3b3JsZFBvcyx3b3JsZE5vcm1hbCx2RXllUG9zaXRpb24ueHl6LHJlZmxlY3Rpb25NYXRyaXgpOwojZW5kaWYKI2lmZGVmIFJFRkxFQ1RJT05NQVBfQ1VCSUMKI2lmZGVmIFVTRV9MT0NBTF9SRUZMRUNUSU9OTUFQX0NVQklDCnJldHVybiBjb21wdXRlQ3ViaWNMb2NhbENvb3Jkcyh3b3JsZFBvcyx3b3JsZE5vcm1hbCx2RXllUG9zaXRpb24ueHl6LHJlZmxlY3Rpb25NYXRyaXgsdlJlZmxlY3Rpb25TaXplLHZSZWZsZWN0aW9uUG9zaXRpb24pOwojZWxzZQpyZXR1cm4gY29tcHV0ZUN1YmljQ29vcmRzKHdvcmxkUG9zLHdvcmxkTm9ybWFsLHZFeWVQb3NpdGlvbi54eXoscmVmbGVjdGlvbk1hdHJpeCk7CiNlbmRpZgojZW5kaWYKI2lmZGVmIFJFRkxFQ1RJT05NQVBfUFJPSkVDVElPTgpyZXR1cm4gY29tcHV0ZVByb2plY3Rpb25Db29yZHMod29ybGRQb3MsdmlldyxyZWZsZWN0aW9uTWF0cml4KTsKI2VuZGlmCiNpZmRlZiBSRUZMRUNUSU9OTUFQX1NLWUJPWApyZXR1cm4gY29tcHV0ZVNreUJveENvb3Jkcyh2UG9zaXRpb25VVlcscmVmbGVjdGlvbk1hdHJpeCk7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTk1BUF9FWFBMSUNJVApyZXR1cm4gdmVjMygwLDAsMCk7CiNlbmRpZgp9CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbbmhdPWFoO2NvbnN0IG9oPSJpbWFnZVByb2Nlc3NpbmdEZWNsYXJhdGlvbiIsaGg9YCNpZmRlZiBFWFBPU1VSRQp1bmlmb3JtIGZsb2F0IGV4cG9zdXJlTGluZWFyOwojZW5kaWYKI2lmZGVmIENPTlRSQVNUCnVuaWZvcm0gZmxvYXQgY29udHJhc3Q7CiNlbmRpZgojaWYgZGVmaW5lZChWSUdORVRURSkgfHwgZGVmaW5lZChESVRIRVIpCnVuaWZvcm0gdmVjMiB2SW52ZXJzZVNjcmVlblNpemU7CiNlbmRpZgojaWZkZWYgVklHTkVUVEUKdW5pZm9ybSB2ZWM0IHZpZ25ldHRlU2V0dGluZ3MxOwp1bmlmb3JtIHZlYzQgdmlnbmV0dGVTZXR0aW5nczI7CiNlbmRpZgojaWZkZWYgQ09MT1JDVVJWRVMKdW5pZm9ybSB2ZWM0IHZDYW1lcmFDb2xvckN1cnZlTmVnYXRpdmU7CnVuaWZvcm0gdmVjNCB2Q2FtZXJhQ29sb3JDdXJ2ZU5ldXRyYWw7CnVuaWZvcm0gdmVjNCB2Q2FtZXJhQ29sb3JDdXJ2ZVBvc2l0aXZlOwojZW5kaWYKI2lmZGVmIENPTE9SR1JBRElORwojaWZkZWYgQ09MT1JHUkFESU5HM0QKdW5pZm9ybSBoaWdocCBzYW1wbGVyM0QgdHhDb2xvclRyYW5zZm9ybTsKI2Vsc2UKdW5pZm9ybSBzYW1wbGVyMkQgdHhDb2xvclRyYW5zZm9ybTsKI2VuZGlmCnVuaWZvcm0gdmVjNCBjb2xvclRyYW5zZm9ybVNldHRpbmdzOwojZW5kaWYKI2lmZGVmIERJVEhFUgp1bmlmb3JtIGZsb2F0IGRpdGhlckludGVuc2l0eTsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtvaF09aGg7Y29uc3QgbGg9ImltYWdlUHJvY2Vzc2luZ0Z1bmN0aW9ucyIsY2g9YCNpZiBkZWZpbmVkKENPTE9SR1JBRElORykgJiYgIWRlZmluZWQoQ09MT1JHUkFESU5HM0QpCi8qKiAKKiBQb2x5ZmlsbCBmb3IgU0FNUExFX1RFWFRVUkVfM0Qsd2hpY2ggaXMgdW5zdXBwb3J0ZWQgaW4gV2ViR0wuCiogc2FtcGxlcjNkU2V0dGluZy54PXRleHR1cmVPZmZzZXQgKDAuNS90ZXh0dXJlU2l6ZSkuCiogc2FtcGxlcjNkU2V0dGluZy55PXRleHR1cmVTaXplLgoqLwojZGVmaW5lIGlubGluZQp2ZWMzIHNhbXBsZVRleHR1cmUzRChzYW1wbGVyMkQgY29sb3JUcmFuc2Zvcm0sdmVjMyBjb2xvcix2ZWMyIHNhbXBsZXIzZFNldHRpbmcpCnsKZmxvYXQgc2xpY2VTaXplPTIuMCpzYW1wbGVyM2RTZXR0aW5nLng7IAojaWZkZWYgU0FNUExFUjNER1JFRU5ERVBUSApmbG9hdCBzbGljZUNvbnRpbnVvdXM9KGNvbG9yLmctc2FtcGxlcjNkU2V0dGluZy54KSpzYW1wbGVyM2RTZXR0aW5nLnk7CiNlbHNlCmZsb2F0IHNsaWNlQ29udGludW91cz0oY29sb3IuYi1zYW1wbGVyM2RTZXR0aW5nLngpKnNhbXBsZXIzZFNldHRpbmcueTsKI2VuZGlmCmZsb2F0IHNsaWNlSW50ZWdlcj1mbG9vcihzbGljZUNvbnRpbnVvdXMpOwpmbG9hdCBzbGljZUZyYWN0aW9uPXNsaWNlQ29udGludW91cy1zbGljZUludGVnZXI7CiNpZmRlZiBTQU1QTEVSM0RHUkVFTkRFUFRICnZlYzIgc2xpY2VVVj1jb2xvci5yYjsKI2Vsc2UKdmVjMiBzbGljZVVWPWNvbG9yLnJnOwojZW5kaWYKc2xpY2VVVi54Kj1zbGljZVNpemU7CnNsaWNlVVYueCs9c2xpY2VJbnRlZ2VyKnNsaWNlU2l6ZTsKc2xpY2VVVj1zYXR1cmF0ZShzbGljZVVWKTsKdmVjNCBzbGljZTBDb2xvcj10ZXh0dXJlMkQoY29sb3JUcmFuc2Zvcm0sc2xpY2VVVik7CnNsaWNlVVYueCs9c2xpY2VTaXplOwpzbGljZVVWPXNhdHVyYXRlKHNsaWNlVVYpOwp2ZWM0IHNsaWNlMUNvbG9yPXRleHR1cmUyRChjb2xvclRyYW5zZm9ybSxzbGljZVVWKTsKdmVjMyByZXN1bHQ9bWl4KHNsaWNlMENvbG9yLnJnYixzbGljZTFDb2xvci5yZ2Isc2xpY2VGcmFjdGlvbik7CiNpZmRlZiBTQU1QTEVSM0RCR1JNQVAKY29sb3IucmdiPXJlc3VsdC5yZ2I7CiNlbHNlCmNvbG9yLnJnYj1yZXN1bHQuYmdyOwojZW5kaWYKcmV0dXJuIGNvbG9yOwp9CiNlbmRpZgojaWZkZWYgVE9ORU1BUFBJTkdfQUNFUwpjb25zdCBtYXQzIEFDRVNJbnB1dE1hdD1tYXQzKAp2ZWMzKDAuNTk3MTksMC4wNzYwMCwwLjAyODQwKSwKdmVjMygwLjM1NDU4LDAuOTA4MzQsMC4xMzM4MyksCnZlYzMoMC4wNDgyMywwLjAxNTY2LDAuODM3NzcpCik7CmNvbnN0IG1hdDMgQUNFU091dHB1dE1hdD1tYXQzKAp2ZWMzKCAxLjYwNDc1LC0wLjEwMjA4LC0wLjAwMzI3KSwKdmVjMygtMC41MzEwOCwgMS4xMDgxMywtMC4wNzI3NiksCnZlYzMoLTAuMDczNjcsLTAuMDA2MDUsIDEuMDc2MDIpCik7CnZlYzMgUlJUQW5kT0RURml0KHZlYzMgdikKewp2ZWMzIGE9dioodiswLjAyNDU3ODYpLTAuMDAwMDkwNTM3Owp2ZWMzIGI9diooMC45ODM3MjkqdiswLjQzMjk1MTApKzAuMjM4MDgxOwpyZXR1cm4gYS9iOwp9CnZlYzMgQUNFU0ZpdHRlZCh2ZWMzIGNvbG9yKQp7CmNvbG9yPUFDRVNJbnB1dE1hdCpjb2xvcjsKY29sb3I9UlJUQW5kT0RURml0KGNvbG9yKTsKY29sb3I9QUNFU091dHB1dE1hdCpjb2xvcjsKY29sb3I9c2F0dXJhdGUoY29sb3IpOwpyZXR1cm4gY29sb3I7Cn0KI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX0lNQUdFUFJPQ0VTU0lOR0ZVTkNUSU9OU19ERUZJTklUSU9OUwp2ZWM0IGFwcGx5SW1hZ2VQcm9jZXNzaW5nKHZlYzQgcmVzdWx0KSB7CiNkZWZpbmUgQ1VTVE9NX0lNQUdFUFJPQ0VTU0lOR0ZVTkNUSU9OU19VUERBVEVSRVNVTFRfQVRTVEFSVAojaWZkZWYgRVhQT1NVUkUKcmVzdWx0LnJnYio9ZXhwb3N1cmVMaW5lYXI7CiNlbmRpZgojaWZkZWYgVklHTkVUVEUKdmVjMiB2aWV3cG9ydFhZPWdsX0ZyYWdDb29yZC54eSp2SW52ZXJzZVNjcmVlblNpemU7CnZpZXdwb3J0WFk9dmlld3BvcnRYWSoyLjAtMS4wOwp2ZWMzIHZpZ25ldHRlWFkxPXZlYzModmlld3BvcnRYWSp2aWduZXR0ZVNldHRpbmdzMS54eSt2aWduZXR0ZVNldHRpbmdzMS56dywxLjApOwpmbG9hdCB2aWduZXR0ZVRlcm09ZG90KHZpZ25ldHRlWFkxLHZpZ25ldHRlWFkxKTsKZmxvYXQgdmlnbmV0dGU9cG93KHZpZ25ldHRlVGVybSx2aWduZXR0ZVNldHRpbmdzMi53KTsKdmVjMyB2aWduZXR0ZUNvbG9yPXZpZ25ldHRlU2V0dGluZ3MyLnJnYjsKI2lmZGVmIFZJR05FVFRFQkxFTkRNT0RFTVVMVElQTFkKdmVjMyB2aWduZXR0ZUNvbG9yTXVsdGlwbGllcj1taXgodmlnbmV0dGVDb2xvcix2ZWMzKDEsMSwxKSx2aWduZXR0ZSk7CnJlc3VsdC5yZ2IqPXZpZ25ldHRlQ29sb3JNdWx0aXBsaWVyOwojZW5kaWYKI2lmZGVmIFZJR05FVFRFQkxFTkRNT0RFT1BBUVVFCnJlc3VsdC5yZ2I9bWl4KHZpZ25ldHRlQ29sb3IscmVzdWx0LnJnYix2aWduZXR0ZSk7CiNlbmRpZgojZW5kaWYKI2lmZGVmIFRPTkVNQVBQSU5HCiNpZmRlZiBUT05FTUFQUElOR19BQ0VTCnJlc3VsdC5yZ2I9QUNFU0ZpdHRlZChyZXN1bHQucmdiKTsKI2Vsc2UKY29uc3QgZmxvYXQgdG9uZW1hcHBpbmdDYWxpYnJhdGlvbj0xLjU5MDU3OTsKcmVzdWx0LnJnYj0xLjAtZXhwMigtdG9uZW1hcHBpbmdDYWxpYnJhdGlvbipyZXN1bHQucmdiKTsKI2VuZGlmCiNlbmRpZgpyZXN1bHQucmdiPXRvR2FtbWFTcGFjZShyZXN1bHQucmdiKTsKcmVzdWx0LnJnYj1zYXR1cmF0ZShyZXN1bHQucmdiKTsKI2lmZGVmIENPTlRSQVNUCnZlYzMgcmVzdWx0SGlnaENvbnRyYXN0PXJlc3VsdC5yZ2IqcmVzdWx0LnJnYiooMy4wLTIuMCpyZXN1bHQucmdiKTsKaWYgKGNvbnRyYXN0PDEuMCkgewpyZXN1bHQucmdiPW1peCh2ZWMzKDAuNSwwLjUsMC41KSxyZXN1bHQucmdiLGNvbnRyYXN0KTsKfSBlbHNlIHsKcmVzdWx0LnJnYj1taXgocmVzdWx0LnJnYixyZXN1bHRIaWdoQ29udHJhc3QsY29udHJhc3QtMS4wKTsKfQojZW5kaWYKI2lmZGVmIENPTE9SR1JBRElORwp2ZWMzIGNvbG9yVHJhbnNmb3JtSW5wdXQ9cmVzdWx0LnJnYipjb2xvclRyYW5zZm9ybVNldHRpbmdzLnh4eCtjb2xvclRyYW5zZm9ybVNldHRpbmdzLnl5eTsKI2lmZGVmIENPTE9SR1JBRElORzNECnZlYzMgY29sb3JUcmFuc2Zvcm1PdXRwdXQ9dGV4dHVyZSh0eENvbG9yVHJhbnNmb3JtLGNvbG9yVHJhbnNmb3JtSW5wdXQpLnJnYjsKI2Vsc2UKdmVjMyBjb2xvclRyYW5zZm9ybU91dHB1dD1zYW1wbGVUZXh0dXJlM0QodHhDb2xvclRyYW5zZm9ybSxjb2xvclRyYW5zZm9ybUlucHV0LGNvbG9yVHJhbnNmb3JtU2V0dGluZ3MueXopLnJnYjsKI2VuZGlmCnJlc3VsdC5yZ2I9bWl4KHJlc3VsdC5yZ2IsY29sb3JUcmFuc2Zvcm1PdXRwdXQsY29sb3JUcmFuc2Zvcm1TZXR0aW5ncy53d3cpOwojZW5kaWYKI2lmZGVmIENPTE9SQ1VSVkVTCmZsb2F0IGx1bWE9Z2V0THVtaW5hbmNlKHJlc3VsdC5yZ2IpOwp2ZWMyIGN1cnZlTWl4PWNsYW1wKHZlYzIobHVtYSozLjAtMS41LGx1bWEqLTMuMCsxLjUpLHZlYzIoMC4wKSx2ZWMyKDEuMCkpOwp2ZWM0IGNvbG9yQ3VydmU9dkNhbWVyYUNvbG9yQ3VydmVOZXV0cmFsK2N1cnZlTWl4LngqdkNhbWVyYUNvbG9yQ3VydmVQb3NpdGl2ZS1jdXJ2ZU1peC55KnZDYW1lcmFDb2xvckN1cnZlTmVnYXRpdmU7CnJlc3VsdC5yZ2IqPWNvbG9yQ3VydmUucmdiOwpyZXN1bHQucmdiPW1peCh2ZWMzKGx1bWEpLHJlc3VsdC5yZ2IsY29sb3JDdXJ2ZS5hKTsKI2VuZGlmCiNpZmRlZiBESVRIRVIKZmxvYXQgcmFuZD1nZXRSYW5kKGdsX0ZyYWdDb29yZC54eSp2SW52ZXJzZVNjcmVlblNpemUpOwpmbG9hdCBkaXRoZXI9bWl4KC1kaXRoZXJJbnRlbnNpdHksZGl0aGVySW50ZW5zaXR5LHJhbmQpOwpyZXN1bHQucmdiPXNhdHVyYXRlKHJlc3VsdC5yZ2IrdmVjMyhkaXRoZXIpKTsKI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX0lNQUdFUFJPQ0VTU0lOR0ZVTkNUSU9OU19VUERBVEVSRVNVTFRfQVRFTkQKcmV0dXJuIHJlc3VsdDsKfWA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtsaF09Y2g7Y29uc3QgdWg9ImJ1bXBGcmFnbWVudE1haW5GdW5jdGlvbnMiLGRoPWAjaWYgZGVmaW5lZChCVU1QKSB8fCBkZWZpbmVkKENMRUFSQ09BVF9CVU1QKSB8fCBkZWZpbmVkKEFOSVNPVFJPUElDKSB8fCBkZWZpbmVkKERFVEFJTCkKI2lmIGRlZmluZWQoVEFOR0VOVCkgJiYgZGVmaW5lZChOT1JNQUwpIAp2YXJ5aW5nIG1hdDMgdlRCTjsKI2VuZGlmCiNpZmRlZiBPQkpFQ1RTUEFDRV9OT1JNQUxNQVAKdW5pZm9ybSBtYXQ0IG5vcm1hbE1hdHJpeDsKI2VuZGlmCnZlYzMgcGVydHVyYk5vcm1hbEJhc2UobWF0MyBjb3RhbmdlbnRGcmFtZSx2ZWMzIG5vcm1hbCxmbG9hdCBzY2FsZSkKewojaWZkZWYgTk9STUFMWFlTQ0FMRQpub3JtYWw9bm9ybWFsaXplKG5vcm1hbCp2ZWMzKHNjYWxlLHNjYWxlLDEuMCkpOwojZW5kaWYKcmV0dXJuIG5vcm1hbGl6ZShjb3RhbmdlbnRGcmFtZSpub3JtYWwpOwp9CnZlYzMgcGVydHVyYk5vcm1hbChtYXQzIGNvdGFuZ2VudEZyYW1lLHZlYzMgdGV4dHVyZVNhbXBsZSxmbG9hdCBzY2FsZSkKewpyZXR1cm4gcGVydHVyYk5vcm1hbEJhc2UoY290YW5nZW50RnJhbWUsdGV4dHVyZVNhbXBsZSoyLjAtMS4wLHNjYWxlKTsKfQptYXQzIGNvdGFuZ2VudF9mcmFtZSh2ZWMzIG5vcm1hbCx2ZWMzIHAsdmVjMiB1dix2ZWMyIHRhbmdlbnRTcGFjZVBhcmFtcykKewp2ZWMzIGRwMT1kRmR4KHApOwp2ZWMzIGRwMj1kRmR5KHApOwp2ZWMyIGR1djE9ZEZkeCh1dik7CnZlYzIgZHV2Mj1kRmR5KHV2KTsKdmVjMyBkcDJwZXJwPWNyb3NzKGRwMixub3JtYWwpOwp2ZWMzIGRwMXBlcnA9Y3Jvc3Mobm9ybWFsLGRwMSk7CnZlYzMgdGFuZ2VudD1kcDJwZXJwKmR1djEueCtkcDFwZXJwKmR1djIueDsKdmVjMyBiaXRhbmdlbnQ9ZHAycGVycCpkdXYxLnkrZHAxcGVycCpkdXYyLnk7CnRhbmdlbnQqPXRhbmdlbnRTcGFjZVBhcmFtcy54OwpiaXRhbmdlbnQqPXRhbmdlbnRTcGFjZVBhcmFtcy55OwpmbG9hdCBkZXQ9bWF4KGRvdCh0YW5nZW50LHRhbmdlbnQpLGRvdChiaXRhbmdlbnQsYml0YW5nZW50KSk7CmZsb2F0IGludm1heD1kZXQ9PTAuMCA/IDAuMCA6IGludmVyc2VzcXJ0KGRldCk7CnJldHVybiBtYXQzKHRhbmdlbnQqaW52bWF4LGJpdGFuZ2VudCppbnZtYXgsbm9ybWFsKTsKfQojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3VoXT1kaDtjb25zdCBmaD0iYnVtcEZyYWdtZW50RnVuY3Rpb25zIixfaD1gI2lmIGRlZmluZWQoQlVNUCkKI2luY2x1ZGU8c2FtcGxlckZyYWdtZW50RGVjbGFyYXRpb24+KF9ERUZJTkVOQU1FXyxCVU1QLF9WQVJZSU5HTkFNRV8sQnVtcCxfU0FNUExFUk5BTUVfLGJ1bXApCiNlbmRpZgojaWYgZGVmaW5lZChERVRBSUwpCiNpbmNsdWRlPHNhbXBsZXJGcmFnbWVudERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sREVUQUlMLF9WQVJZSU5HTkFNRV8sRGV0YWlsLF9TQU1QTEVSTkFNRV8sZGV0YWlsKQojZW5kaWYKI2lmIGRlZmluZWQoQlVNUCkgJiYgZGVmaW5lZChQQVJBTExBWCkKY29uc3QgZmxvYXQgbWluU2FtcGxlcz00LjsKY29uc3QgZmxvYXQgbWF4U2FtcGxlcz0xNS47CmNvbnN0IGludCBpTWF4U2FtcGxlcz0xNTsKdmVjMiBwYXJhbGxheE9jY2x1c2lvbih2ZWMzIHZWaWV3RGlyQ29ULHZlYzMgdk5vcm1hbENvVCx2ZWMyIHRleENvb3JkLGZsb2F0IHBhcmFsbGF4U2NhbGUpIHsKZmxvYXQgcGFyYWxsYXhMaW1pdD1sZW5ndGgodlZpZXdEaXJDb1QueHkpL3ZWaWV3RGlyQ29ULno7CnBhcmFsbGF4TGltaXQqPXBhcmFsbGF4U2NhbGU7CnZlYzIgdk9mZnNldERpcj1ub3JtYWxpemUodlZpZXdEaXJDb1QueHkpOwp2ZWMyIHZNYXhPZmZzZXQ9dk9mZnNldERpcipwYXJhbGxheExpbWl0OwpmbG9hdCBudW1TYW1wbGVzPW1heFNhbXBsZXMrKGRvdCh2Vmlld0RpckNvVCx2Tm9ybWFsQ29UKSoobWluU2FtcGxlcy1tYXhTYW1wbGVzKSk7CmZsb2F0IHN0ZXBTaXplPTEuMC9udW1TYW1wbGVzOwpmbG9hdCBjdXJyUmF5SGVpZ2h0PTEuMDsKdmVjMiB2Q3Vyck9mZnNldD12ZWMyKDAsMCk7CnZlYzIgdkxhc3RPZmZzZXQ9dmVjMigwLDApOwpmbG9hdCBsYXN0U2FtcGxlZEhlaWdodD0xLjA7CmZsb2F0IGN1cnJTYW1wbGVkSGVpZ2h0PTEuMDsKYm9vbCBrZWVwV29ya2luZz10cnVlOwpmb3IgKGludCBpPTA7IGk8aU1heFNhbXBsZXM7IGkrKykKewpjdXJyU2FtcGxlZEhlaWdodD10ZXh0dXJlMkQoYnVtcFNhbXBsZXIsdGV4Q29vcmQrdkN1cnJPZmZzZXQpLnc7CmlmICgha2VlcFdvcmtpbmcpCnsKfQplbHNlIGlmIChjdXJyU2FtcGxlZEhlaWdodD5jdXJyUmF5SGVpZ2h0KQp7CmZsb2F0IGRlbHRhMT1jdXJyU2FtcGxlZEhlaWdodC1jdXJyUmF5SGVpZ2h0OwpmbG9hdCBkZWx0YTI9KGN1cnJSYXlIZWlnaHQrc3RlcFNpemUpLWxhc3RTYW1wbGVkSGVpZ2h0OwpmbG9hdCByYXRpbz1kZWx0YTEvKGRlbHRhMStkZWx0YTIpOwp2Q3Vyck9mZnNldD0ocmF0aW8pKiB2TGFzdE9mZnNldCsoMS4wLXJhdGlvKSp2Q3Vyck9mZnNldDsKa2VlcFdvcmtpbmc9ZmFsc2U7Cn0KZWxzZQp7CmN1cnJSYXlIZWlnaHQtPXN0ZXBTaXplOwp2TGFzdE9mZnNldD12Q3Vyck9mZnNldDsKdkN1cnJPZmZzZXQrPXN0ZXBTaXplKnZNYXhPZmZzZXQ7Cmxhc3RTYW1wbGVkSGVpZ2h0PWN1cnJTYW1wbGVkSGVpZ2h0Owp9Cn0KcmV0dXJuIHZDdXJyT2Zmc2V0Owp9CnZlYzIgcGFyYWxsYXhPZmZzZXQodmVjMyB2aWV3RGlyLGZsb2F0IGhlaWdodFNjYWxlKQp7CmZsb2F0IGhlaWdodD10ZXh0dXJlMkQoYnVtcFNhbXBsZXIsdkJ1bXBVVikudzsKdmVjMiB0ZXhDb29yZE9mZnNldD1oZWlnaHRTY2FsZSp2aWV3RGlyLnh5KmhlaWdodDsKcmV0dXJuIC10ZXhDb29yZE9mZnNldDsKfQojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2ZoXT1faDtjb25zdCBnaD0ibG9nRGVwdGhEZWNsYXJhdGlvbiIscGg9YCNpZmRlZiBMT0dBUklUSE1JQ0RFUFRICnVuaWZvcm0gZmxvYXQgbG9nYXJpdGhtaWNEZXB0aENvbnN0YW50Owp2YXJ5aW5nIGZsb2F0IHZGcmFnbWVudERlcHRoOwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2doXT1waDtjb25zdCBtaD0iZm9nRnJhZ21lbnREZWNsYXJhdGlvbiIsRWg9YCNpZmRlZiBGT0cKI2RlZmluZSBGT0dNT0RFX05PTkUgMC4KI2RlZmluZSBGT0dNT0RFX0VYUCAxLgojZGVmaW5lIEZPR01PREVfRVhQMiAyLgojZGVmaW5lIEZPR01PREVfTElORUFSIDMuCiNkZWZpbmUgRSAyLjcxODI4CnVuaWZvcm0gdmVjNCB2Rm9nSW5mb3M7CnVuaWZvcm0gdmVjMyB2Rm9nQ29sb3I7CnZhcnlpbmcgdmVjMyB2Rm9nRGlzdGFuY2U7CmZsb2F0IENhbGNGb2dGYWN0b3IoKQp7CmZsb2F0IGZvZ0NvZWZmPTEuMDsKZmxvYXQgZm9nU3RhcnQ9dkZvZ0luZm9zLnk7CmZsb2F0IGZvZ0VuZD12Rm9nSW5mb3MuejsKZmxvYXQgZm9nRGVuc2l0eT12Rm9nSW5mb3MudzsKZmxvYXQgZm9nRGlzdGFuY2U9bGVuZ3RoKHZGb2dEaXN0YW5jZSk7CmlmIChGT0dNT0RFX0xJTkVBUj09dkZvZ0luZm9zLngpCnsKZm9nQ29lZmY9KGZvZ0VuZC1mb2dEaXN0YW5jZSkvKGZvZ0VuZC1mb2dTdGFydCk7Cn0KZWxzZSBpZiAoRk9HTU9ERV9FWFA9PXZGb2dJbmZvcy54KQp7CmZvZ0NvZWZmPTEuMC9wb3coRSxmb2dEaXN0YW5jZSpmb2dEZW5zaXR5KTsKfQplbHNlIGlmIChGT0dNT0RFX0VYUDI9PXZGb2dJbmZvcy54KQp7CmZvZ0NvZWZmPTEuMC9wb3coRSxmb2dEaXN0YW5jZSpmb2dEaXN0YW5jZSpmb2dEZW5zaXR5KmZvZ0RlbnNpdHkpOwp9CnJldHVybiBjbGFtcChmb2dDb2VmZiwwLjAsMS4wKTsKfQojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW21oXT1FaDtjb25zdCB2aD0iYnVtcEZyYWdtZW50IixUaD1gdmVjMiB1dk9mZnNldD12ZWMyKDAuMCwwLjApOwojaWYgZGVmaW5lZChCVU1QKSB8fCBkZWZpbmVkKFBBUkFMTEFYKSB8fCBkZWZpbmVkKERFVEFJTCkKI2lmZGVmIE5PUk1BTFhZU0NBTEUKZmxvYXQgbm9ybWFsU2NhbGU9MS4wOwojZWxpZiBkZWZpbmVkKEJVTVApCmZsb2F0IG5vcm1hbFNjYWxlPXZCdW1wSW5mb3MueTsKI2Vsc2UKZmxvYXQgbm9ybWFsU2NhbGU9MS4wOwojZW5kaWYKI2lmIGRlZmluZWQoVEFOR0VOVCkgJiYgZGVmaW5lZChOT1JNQUwpCm1hdDMgVEJOPXZUQk47CiNlbGlmIGRlZmluZWQoQlVNUCkKdmVjMiBUQk5VVj1nbF9Gcm9udEZhY2luZyA/IHZCdW1wVVYgOiAtdkJ1bXBVVjsKbWF0MyBUQk49Y290YW5nZW50X2ZyYW1lKG5vcm1hbFcqbm9ybWFsU2NhbGUsdlBvc2l0aW9uVyxUQk5VVix2VGFuZ2VudFNwYWNlUGFyYW1zKTsKI2Vsc2UKdmVjMiBUQk5VVj1nbF9Gcm9udEZhY2luZyA/IHZEZXRhaWxVViA6IC12RGV0YWlsVVY7Cm1hdDMgVEJOPWNvdGFuZ2VudF9mcmFtZShub3JtYWxXKm5vcm1hbFNjYWxlLHZQb3NpdGlvblcsVEJOVVYsdmVjMigxLiwxLikpOwojZW5kaWYKI2VsaWYgZGVmaW5lZChBTklTT1RST1BJQykKI2lmIGRlZmluZWQoVEFOR0VOVCkgJiYgZGVmaW5lZChOT1JNQUwpCm1hdDMgVEJOPXZUQk47CiNlbHNlCnZlYzIgVEJOVVY9Z2xfRnJvbnRGYWNpbmcgPyB2TWFpblVWMSA6IC12TWFpblVWMTsKbWF0MyBUQk49Y290YW5nZW50X2ZyYW1lKG5vcm1hbFcsdlBvc2l0aW9uVyxUQk5VVix2ZWMyKDEuLDEuKSk7CiNlbmRpZgojZW5kaWYKI2lmZGVmIFBBUkFMTEFYCm1hdDMgaW52VEJOPXRyYW5zcG9zZU1hdDMoVEJOKTsKI2lmZGVmIFBBUkFMTEFYT0NDTFVTSU9OCnV2T2Zmc2V0PXBhcmFsbGF4T2NjbHVzaW9uKGludlRCTiotdmlld0RpcmVjdGlvblcsaW52VEJOKm5vcm1hbFcsdkJ1bXBVVix2QnVtcEluZm9zLnopOwojZWxzZQp1dk9mZnNldD1wYXJhbGxheE9mZnNldChpbnZUQk4qdmlld0RpcmVjdGlvblcsdkJ1bXBJbmZvcy56KTsKI2VuZGlmCiNlbmRpZgojaWZkZWYgREVUQUlMCnZlYzQgZGV0YWlsQ29sb3I9dGV4dHVyZTJEKGRldGFpbFNhbXBsZXIsdkRldGFpbFVWK3V2T2Zmc2V0KTsKdmVjMiBkZXRhaWxOb3JtYWxSRz1kZXRhaWxDb2xvci53eSoyLjAtMS4wOwpmbG9hdCBkZXRhaWxOb3JtYWxCPXNxcnQoMS4tc2F0dXJhdGUoZG90KGRldGFpbE5vcm1hbFJHLGRldGFpbE5vcm1hbFJHKSkpOwp2ZWMzIGRldGFpbE5vcm1hbD12ZWMzKGRldGFpbE5vcm1hbFJHLGRldGFpbE5vcm1hbEIpOwojZW5kaWYKI2lmZGVmIEJVTVAKI2lmZGVmIE9CSkVDVFNQQUNFX05PUk1BTE1BUApub3JtYWxXPW5vcm1hbGl6ZSh0ZXh0dXJlMkQoYnVtcFNhbXBsZXIsdkJ1bXBVVikueHl6ICoyLjAtMS4wKTsKbm9ybWFsVz1ub3JtYWxpemUobWF0Myhub3JtYWxNYXRyaXgpKm5vcm1hbFcpOwojZWxpZiAhZGVmaW5lZChERVRBSUwpCm5vcm1hbFc9cGVydHVyYk5vcm1hbChUQk4sdGV4dHVyZTJEKGJ1bXBTYW1wbGVyLHZCdW1wVVYrdXZPZmZzZXQpLnh5eix2QnVtcEluZm9zLnkpOwojZWxzZQp2ZWMzIGJ1bXBOb3JtYWw9dGV4dHVyZTJEKGJ1bXBTYW1wbGVyLHZCdW1wVVYrdXZPZmZzZXQpLnh5eioyLjAtMS4wOwojaWYgREVUQUlMX05PUk1BTEJMRU5ETUVUSE9EPT0wIApkZXRhaWxOb3JtYWwueHkqPXZEZXRhaWxJbmZvcy56Owp2ZWMzIGJsZW5kZWROb3JtYWw9bm9ybWFsaXplKHZlYzMoYnVtcE5vcm1hbC54eStkZXRhaWxOb3JtYWwueHksYnVtcE5vcm1hbC56KmRldGFpbE5vcm1hbC56KSk7CiNlbGlmIERFVEFJTF9OT1JNQUxCTEVORE1FVEhPRD09MSAKZGV0YWlsTm9ybWFsLnh5Kj12RGV0YWlsSW5mb3MuejsKYnVtcE5vcm1hbCs9dmVjMygwLjAsMC4wLDEuMCk7CmRldGFpbE5vcm1hbCo9dmVjMygtMS4wLC0xLjAsMS4wKTsKdmVjMyBibGVuZGVkTm9ybWFsPWJ1bXBOb3JtYWwqZG90KGJ1bXBOb3JtYWwsZGV0YWlsTm9ybWFsKS9idW1wTm9ybWFsLnotZGV0YWlsTm9ybWFsOwojZW5kaWYKbm9ybWFsVz1wZXJ0dXJiTm9ybWFsQmFzZShUQk4sYmxlbmRlZE5vcm1hbCx2QnVtcEluZm9zLnkpOwojZW5kaWYKI2VsaWYgZGVmaW5lZChERVRBSUwpCmRldGFpbE5vcm1hbC54eSo9dkRldGFpbEluZm9zLno7Cm5vcm1hbFc9cGVydHVyYk5vcm1hbEJhc2UoVEJOLGRldGFpbE5vcm1hbCx2RGV0YWlsSW5mb3Mueik7CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbdmhdPVRoO2NvbnN0IGJoPSJkZXB0aFByZVBhc3MiLFNoPWAjaWZkZWYgREVQVEhQUkVQQVNTCmdsX0ZyYWdDb2xvcj12ZWM0KDAuLDAuLDAuLDEuMCk7CnJldHVybjsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtiaF09U2g7Y29uc3QgeGg9ImxpZ2h0RnJhZ21lbnQiLE1oPWAjaWZkZWYgTElHSFR7WH0KI2lmIGRlZmluZWQoU0hBRE9XT05MWSkgfHwgZGVmaW5lZChMSUdIVE1BUCkgJiYgZGVmaW5lZChMSUdIVE1BUEVYQ0xVREVEe1h9KSAmJiBkZWZpbmVkKExJR0hUTUFQTk9TUEVDVUxBUntYfSkKI2Vsc2UKI2lmZGVmIFBCUgojaWZkZWYgU1BPVExJR0hUe1h9CnByZUluZm89Y29tcHV0ZVBvaW50QW5kU3BvdFByZUxpZ2h0aW5nSW5mbyhsaWdodHtYfS52TGlnaHREYXRhLHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcpOwojZWxpZiBkZWZpbmVkKFBPSU5UTElHSFR7WH0pCnByZUluZm89Y29tcHV0ZVBvaW50QW5kU3BvdFByZUxpZ2h0aW5nSW5mbyhsaWdodHtYfS52TGlnaHREYXRhLHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcpOwojZWxpZiBkZWZpbmVkKEhFTUlMSUdIVHtYfSkKcHJlSW5mbz1jb21wdXRlSGVtaXNwaGVyaWNQcmVMaWdodGluZ0luZm8obGlnaHR7WH0udkxpZ2h0RGF0YSx2aWV3RGlyZWN0aW9uVyxub3JtYWxXKTsKI2VsaWYgZGVmaW5lZChESVJMSUdIVHtYfSkKcHJlSW5mbz1jb21wdXRlRGlyZWN0aW9uYWxQcmVMaWdodGluZ0luZm8obGlnaHR7WH0udkxpZ2h0RGF0YSx2aWV3RGlyZWN0aW9uVyxub3JtYWxXKTsKI2VuZGlmCnByZUluZm8uTmRvdFY9TmRvdFY7CiNpZmRlZiBTUE9UTElHSFR7WH0KI2lmZGVmIExJR0hUX0ZBTExPRkZfR0xURntYfQpwcmVJbmZvLmF0dGVudWF0aW9uPWNvbXB1dGVEaXN0YW5jZUxpZ2h0RmFsbG9mZl9HTFRGKHByZUluZm8ubGlnaHREaXN0YW5jZVNxdWFyZWQsbGlnaHR7WH0udkxpZ2h0RmFsbG9mZi55KTsKcHJlSW5mby5hdHRlbnVhdGlvbio9Y29tcHV0ZURpcmVjdGlvbmFsTGlnaHRGYWxsb2ZmX0dMVEYobGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLnh5eixwcmVJbmZvLkwsbGlnaHR7WH0udkxpZ2h0RmFsbG9mZi56LGxpZ2h0e1h9LnZMaWdodEZhbGxvZmYudyk7CiNlbGlmIGRlZmluZWQoTElHSFRfRkFMTE9GRl9QSFlTSUNBTHtYfSkKcHJlSW5mby5hdHRlbnVhdGlvbj1jb21wdXRlRGlzdGFuY2VMaWdodEZhbGxvZmZfUGh5c2ljYWwocHJlSW5mby5saWdodERpc3RhbmNlU3F1YXJlZCk7CnByZUluZm8uYXR0ZW51YXRpb24qPWNvbXB1dGVEaXJlY3Rpb25hbExpZ2h0RmFsbG9mZl9QaHlzaWNhbChsaWdodHtYfS52TGlnaHREaXJlY3Rpb24ueHl6LHByZUluZm8uTCxsaWdodHtYfS52TGlnaHREaXJlY3Rpb24udyk7CiNlbGlmIGRlZmluZWQoTElHSFRfRkFMTE9GRl9TVEFOREFSRHtYfSkKcHJlSW5mby5hdHRlbnVhdGlvbj1jb21wdXRlRGlzdGFuY2VMaWdodEZhbGxvZmZfU3RhbmRhcmQocHJlSW5mby5saWdodE9mZnNldCxsaWdodHtYfS52TGlnaHRGYWxsb2ZmLngpOwpwcmVJbmZvLmF0dGVudWF0aW9uKj1jb21wdXRlRGlyZWN0aW9uYWxMaWdodEZhbGxvZmZfU3RhbmRhcmQobGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLnh5eixwcmVJbmZvLkwsbGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLncsbGlnaHR7WH0udkxpZ2h0RGF0YS53KTsKI2Vsc2UKcHJlSW5mby5hdHRlbnVhdGlvbj1jb21wdXRlRGlzdGFuY2VMaWdodEZhbGxvZmYocHJlSW5mby5saWdodE9mZnNldCxwcmVJbmZvLmxpZ2h0RGlzdGFuY2VTcXVhcmVkLGxpZ2h0e1h9LnZMaWdodEZhbGxvZmYueCxsaWdodHtYfS52TGlnaHRGYWxsb2ZmLnkpOwpwcmVJbmZvLmF0dGVudWF0aW9uKj1jb21wdXRlRGlyZWN0aW9uYWxMaWdodEZhbGxvZmYobGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLnh5eixwcmVJbmZvLkwsbGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLncsbGlnaHR7WH0udkxpZ2h0RGF0YS53LGxpZ2h0e1h9LnZMaWdodEZhbGxvZmYueixsaWdodHtYfS52TGlnaHRGYWxsb2ZmLncpOwojZW5kaWYKI2VsaWYgZGVmaW5lZChQT0lOVExJR0hUe1h9KQojaWZkZWYgTElHSFRfRkFMTE9GRl9HTFRGe1h9CnByZUluZm8uYXR0ZW51YXRpb249Y29tcHV0ZURpc3RhbmNlTGlnaHRGYWxsb2ZmX0dMVEYocHJlSW5mby5saWdodERpc3RhbmNlU3F1YXJlZCxsaWdodHtYfS52TGlnaHRGYWxsb2ZmLnkpOwojZWxpZiBkZWZpbmVkKExJR0hUX0ZBTExPRkZfUEhZU0lDQUx7WH0pCnByZUluZm8uYXR0ZW51YXRpb249Y29tcHV0ZURpc3RhbmNlTGlnaHRGYWxsb2ZmX1BoeXNpY2FsKHByZUluZm8ubGlnaHREaXN0YW5jZVNxdWFyZWQpOwojZWxpZiBkZWZpbmVkKExJR0hUX0ZBTExPRkZfU1RBTkRBUkR7WH0pCnByZUluZm8uYXR0ZW51YXRpb249Y29tcHV0ZURpc3RhbmNlTGlnaHRGYWxsb2ZmX1N0YW5kYXJkKHByZUluZm8ubGlnaHRPZmZzZXQsbGlnaHR7WH0udkxpZ2h0RmFsbG9mZi54KTsKI2Vsc2UKcHJlSW5mby5hdHRlbnVhdGlvbj1jb21wdXRlRGlzdGFuY2VMaWdodEZhbGxvZmYocHJlSW5mby5saWdodE9mZnNldCxwcmVJbmZvLmxpZ2h0RGlzdGFuY2VTcXVhcmVkLGxpZ2h0e1h9LnZMaWdodEZhbGxvZmYueCxsaWdodHtYfS52TGlnaHRGYWxsb2ZmLnkpOwojZW5kaWYKI2Vsc2UKcHJlSW5mby5hdHRlbnVhdGlvbj0xLjA7CiNlbmRpZgojaWZkZWYgSEVNSUxJR0hUe1h9CnByZUluZm8ucm91Z2huZXNzPXJvdWdobmVzczsKI2Vsc2UKcHJlSW5mby5yb3VnaG5lc3M9YWRqdXN0Um91Z2huZXNzRnJvbUxpZ2h0UHJvcGVydGllcyhyb3VnaG5lc3MsbGlnaHR7WH0udkxpZ2h0U3BlY3VsYXIuYSxwcmVJbmZvLmxpZ2h0RGlzdGFuY2UpOwojZW5kaWYKI2lmZGVmIElSSURFU0NFTkNFCnByZUluZm8uaXJpZGVzY2VuY2VJbnRlbnNpdHk9aXJpZGVzY2VuY2VJbnRlbnNpdHk7CiNlbmRpZgojaWZkZWYgSEVNSUxJR0hUe1h9CmluZm8uZGlmZnVzZT1jb21wdXRlSGVtaXNwaGVyaWNEaWZmdXNlTGlnaHRpbmcocHJlSW5mbyxsaWdodHtYfS52TGlnaHREaWZmdXNlLnJnYixsaWdodHtYfS52TGlnaHRHcm91bmQpOwojZWxpZiBkZWZpbmVkKFNTX1RSQU5TTFVDRU5DWSkKaW5mby5kaWZmdXNlPWNvbXB1dGVEaWZmdXNlQW5kVHJhbnNtaXR0ZWRMaWdodGluZyhwcmVJbmZvLGxpZ2h0e1h9LnZMaWdodERpZmZ1c2UucmdiLHN1YlN1cmZhY2VPdXQudHJhbnNtaXR0YW5jZSk7CiNlbHNlCmluZm8uZGlmZnVzZT1jb21wdXRlRGlmZnVzZUxpZ2h0aW5nKHByZUluZm8sbGlnaHR7WH0udkxpZ2h0RGlmZnVzZS5yZ2IpOwojZW5kaWYKI2lmZGVmIFNQRUNVTEFSVEVSTQojaWZkZWYgQU5JU09UUk9QSUMKaW5mby5zcGVjdWxhcj1jb21wdXRlQW5pc290cm9waWNTcGVjdWxhckxpZ2h0aW5nKHByZUluZm8sdmlld0RpcmVjdGlvblcsbm9ybWFsVyxhbmlzb3Ryb3BpY091dC5hbmlzb3Ryb3BpY1RhbmdlbnQsYW5pc290cm9waWNPdXQuYW5pc290cm9waWNCaXRhbmdlbnQsYW5pc290cm9waWNPdXQuYW5pc290cm9weSxjbGVhcmNvYXRPdXQuc3BlY3VsYXJFbnZpcm9ubWVudFIwLHNwZWN1bGFyRW52aXJvbm1lbnRSOTAsQUFSb3VnaG5lc3NGYWN0b3JzLngsbGlnaHR7WH0udkxpZ2h0RGlmZnVzZS5yZ2IpOwojZWxzZQppbmZvLnNwZWN1bGFyPWNvbXB1dGVTcGVjdWxhckxpZ2h0aW5nKHByZUluZm8sbm9ybWFsVyxjbGVhcmNvYXRPdXQuc3BlY3VsYXJFbnZpcm9ubWVudFIwLHNwZWN1bGFyRW52aXJvbm1lbnRSOTAsQUFSb3VnaG5lc3NGYWN0b3JzLngsbGlnaHR7WH0udkxpZ2h0RGlmZnVzZS5yZ2IpOwojZW5kaWYKI2VuZGlmCiNpZmRlZiBTSEVFTgojaWZkZWYgU0hFRU5fTElOS1dJVEhBTEJFRE8KcHJlSW5mby5yb3VnaG5lc3M9c2hlZW5PdXQuc2hlZW5JbnRlbnNpdHk7CiNlbHNlCiNpZmRlZiBIRU1JTElHSFR7WH0KcHJlSW5mby5yb3VnaG5lc3M9c2hlZW5PdXQuc2hlZW5Sb3VnaG5lc3M7CiNlbHNlCnByZUluZm8ucm91Z2huZXNzPWFkanVzdFJvdWdobmVzc0Zyb21MaWdodFByb3BlcnRpZXMoc2hlZW5PdXQuc2hlZW5Sb3VnaG5lc3MsbGlnaHR7WH0udkxpZ2h0U3BlY3VsYXIuYSxwcmVJbmZvLmxpZ2h0RGlzdGFuY2UpOwojZW5kaWYKI2VuZGlmCmluZm8uc2hlZW49Y29tcHV0ZVNoZWVuTGlnaHRpbmcocHJlSW5mbyxub3JtYWxXLHNoZWVuT3V0LnNoZWVuQ29sb3Isc3BlY3VsYXJFbnZpcm9ubWVudFI5MCxBQVJvdWdobmVzc0ZhY3RvcnMueCxsaWdodHtYfS52TGlnaHREaWZmdXNlLnJnYik7CiNlbmRpZgojaWZkZWYgQ0xFQVJDT0FUCiNpZmRlZiBIRU1JTElHSFR7WH0KcHJlSW5mby5yb3VnaG5lc3M9Y2xlYXJjb2F0T3V0LmNsZWFyQ29hdFJvdWdobmVzczsKI2Vsc2UKcHJlSW5mby5yb3VnaG5lc3M9YWRqdXN0Um91Z2huZXNzRnJvbUxpZ2h0UHJvcGVydGllcyhjbGVhcmNvYXRPdXQuY2xlYXJDb2F0Um91Z2huZXNzLGxpZ2h0e1h9LnZMaWdodFNwZWN1bGFyLmEscHJlSW5mby5saWdodERpc3RhbmNlKTsKI2VuZGlmCmluZm8uY2xlYXJDb2F0PWNvbXB1dGVDbGVhckNvYXRMaWdodGluZyhwcmVJbmZvLGNsZWFyY29hdE91dC5jbGVhckNvYXROb3JtYWxXLGNsZWFyY29hdE91dC5jbGVhckNvYXRBQVJvdWdobmVzc0ZhY3RvcnMueCxjbGVhcmNvYXRPdXQuY2xlYXJDb2F0SW50ZW5zaXR5LGxpZ2h0e1h9LnZMaWdodERpZmZ1c2UucmdiKTsKI2lmZGVmIENMRUFSQ09BVF9USU5UCmFic29ycHRpb249Y29tcHV0ZUNsZWFyQ29hdExpZ2h0aW5nQWJzb3JwdGlvbihjbGVhcmNvYXRPdXQuY2xlYXJDb2F0TmRvdFZSZWZyYWN0LHByZUluZm8uTCxjbGVhcmNvYXRPdXQuY2xlYXJDb2F0Tm9ybWFsVyxjbGVhcmNvYXRPdXQuY2xlYXJDb2F0Q29sb3IsY2xlYXJjb2F0T3V0LmNsZWFyQ29hdFRoaWNrbmVzcyxjbGVhcmNvYXRPdXQuY2xlYXJDb2F0SW50ZW5zaXR5KTsKaW5mby5kaWZmdXNlKj1hYnNvcnB0aW9uOwojaWZkZWYgU1BFQ1VMQVJURVJNCmluZm8uc3BlY3VsYXIqPWFic29ycHRpb247CiNlbmRpZgojZW5kaWYKaW5mby5kaWZmdXNlKj1pbmZvLmNsZWFyQ29hdC53OwojaWZkZWYgU1BFQ1VMQVJURVJNCmluZm8uc3BlY3VsYXIqPWluZm8uY2xlYXJDb2F0Lnc7CiNlbmRpZgojaWZkZWYgU0hFRU4KaW5mby5zaGVlbio9aW5mby5jbGVhckNvYXQudzsKI2VuZGlmCiNlbmRpZgojZWxzZQojaWZkZWYgU1BPVExJR0hUe1h9CmluZm89Y29tcHV0ZVNwb3RMaWdodGluZyh2aWV3RGlyZWN0aW9uVyxub3JtYWxXLGxpZ2h0e1h9LnZMaWdodERhdGEsbGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLGxpZ2h0e1h9LnZMaWdodERpZmZ1c2UucmdiLGxpZ2h0e1h9LnZMaWdodFNwZWN1bGFyLnJnYixsaWdodHtYfS52TGlnaHREaWZmdXNlLmEsZ2xvc3NpbmVzcyk7CiNlbGlmIGRlZmluZWQoSEVNSUxJR0hUe1h9KQppbmZvPWNvbXB1dGVIZW1pc3BoZXJpY0xpZ2h0aW5nKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsbGlnaHR7WH0udkxpZ2h0RGF0YSxsaWdodHtYfS52TGlnaHREaWZmdXNlLnJnYixsaWdodHtYfS52TGlnaHRTcGVjdWxhci5yZ2IsbGlnaHR7WH0udkxpZ2h0R3JvdW5kLGdsb3NzaW5lc3MpOwojZWxpZiBkZWZpbmVkKFBPSU5UTElHSFR7WH0pIHx8IGRlZmluZWQoRElSTElHSFR7WH0pCmluZm89Y29tcHV0ZUxpZ2h0aW5nKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsbGlnaHR7WH0udkxpZ2h0RGF0YSxsaWdodHtYfS52TGlnaHREaWZmdXNlLnJnYixsaWdodHtYfS52TGlnaHRTcGVjdWxhci5yZ2IsbGlnaHR7WH0udkxpZ2h0RGlmZnVzZS5hLGdsb3NzaW5lc3MpOwojZW5kaWYKI2VuZGlmCiNpZmRlZiBQUk9KRUNURURMSUdIVFRFWFRVUkV7WH0KaW5mby5kaWZmdXNlKj1jb21wdXRlUHJvamVjdGlvblRleHR1cmVEaWZmdXNlTGlnaHRpbmcocHJvamVjdGlvbkxpZ2h0U2FtcGxlcntYfSx0ZXh0dXJlUHJvamVjdGlvbk1hdHJpeHtYfSk7CiNlbmRpZgojZW5kaWYKI2lmZGVmIFNIQURPV3tYfQojaWZkZWYgU0hBRE9XQ1NNe1h9CmZvciAoaW50IGk9MDsgaTxTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH07IGkrKykgCnsKI2lmZGVmIFNIQURPV0NTTV9SSUdIVEhBTkRFRHtYfQpkaWZme1h9PXZpZXdGcnVzdHVtWntYfVtpXSt2UG9zaXRpb25Gcm9tQ2FtZXJhe1h9Lno7CiNlbHNlCmRpZmZ7WH09dmlld0ZydXN0dW1ae1h9W2ldLXZQb3NpdGlvbkZyb21DYW1lcmF7WH0uejsKI2VuZGlmCmlmIChkaWZme1h9Pj0wLikgewppbmRleHtYfT1pOwpicmVhazsKfQp9CiNpZmRlZiBTSEFET1dDU01VU0VTSEFET1dNQVhae1h9CmlmIChpbmRleHtYfT49MCkKI2VuZGlmCnsKI2lmIGRlZmluZWQoU0hBRE9XUENGe1h9KQojaWYgZGVmaW5lZChTSEFET1dMT1dRVUFMSVRZe1h9KQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhDU01QQ0YxKGZsb2F0KGluZGV4e1h9KSx2UG9zaXRpb25Gcm9tTGlnaHR7WH1baW5kZXh7WH1dLHZEZXB0aE1ldHJpY3tYfVtpbmRleHtYfV0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncpOwojZWxpZiBkZWZpbmVkKFNIQURPV01FRElVTVFVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aENTTVBDRjMoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnl6LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbHNlCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aENTTVBDRjUoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnl6LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbmRpZgojZWxpZiBkZWZpbmVkKFNIQURPV1BDU1N7WH0pCiNpZiBkZWZpbmVkKFNIQURPV0xPV1FVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aENTTVBDU1MxNihmbG9hdChpbmRleHtYfSksdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2luZGV4e1h9XSx2RGVwdGhNZXRyaWN7WH1baW5kZXh7WH1dLGRlcHRoU2FtcGxlcntYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnksbGlnaHR7WH0uc2hhZG93c0luZm8ueixsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncsbGlnaHRTaXplVVZDb3JyZWN0aW9ue1h9W2luZGV4e1h9XSxkZXB0aENvcnJlY3Rpb257WH1baW5kZXh7WH1dLHBlbnVtYnJhRGFya25lc3N7WH0pOwojZWxpZiBkZWZpbmVkKFNIQURPV01FRElVTVFVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aENTTVBDU1MzMihmbG9hdChpbmRleHtYfSksdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2luZGV4e1h9XSx2RGVwdGhNZXRyaWN7WH1baW5kZXh7WH1dLGRlcHRoU2FtcGxlcntYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnksbGlnaHR7WH0uc2hhZG93c0luZm8ueixsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncsbGlnaHRTaXplVVZDb3JyZWN0aW9ue1h9W2luZGV4e1h9XSxkZXB0aENvcnJlY3Rpb257WH1baW5kZXh7WH1dLHBlbnVtYnJhRGFya25lc3N7WH0pOwojZWxzZQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhDU01QQ1NTNjQoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxkZXB0aFNhbXBsZXJ7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby55LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnosbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53LGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbntYfVtpbmRleHtYfV0sZGVwdGhDb3JyZWN0aW9ue1h9W2luZGV4e1h9XSxwZW51bWJyYURhcmtuZXNze1h9KTsKI2VuZGlmCiNlbHNlCnNoYWRvdz1jb21wdXRlU2hhZG93Q1NNKGZsb2F0KGluZGV4e1h9KSx2UG9zaXRpb25Gcm9tTGlnaHR7WH1baW5kZXh7WH1dLHZEZXB0aE1ldHJpY3tYfVtpbmRleHtYfV0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncpOwojZW5kaWYKI2lmZGVmIFNIQURPV0NTTURFQlVHe1h9CnNoYWRvd0RlYnVne1h9PXZlYzMoc2hhZG93KSp2Q2FzY2FkZUNvbG9yc011bHRpcGxpZXJ7WH1baW5kZXh7WH1dOwojZW5kaWYKI2lmbmRlZiBTSEFET1dDU01OT0JMRU5Ee1h9CmZsb2F0IGZydXN0dW1MZW5ndGg9ZnJ1c3R1bUxlbmd0aHN7WH1baW5kZXh7WH1dOwpmbG9hdCBkaWZmUmF0aW89Y2xhbXAoZGlmZntYfS9mcnVzdHVtTGVuZ3RoLDAuLDEuKSpjYXNjYWRlQmxlbmRGYWN0b3J7WH07CmlmIChpbmRleHtYfTwoU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9LTEpICYmIGRpZmZSYXRpbzwxLikKewppbmRleHtYfSs9MTsKZmxvYXQgbmV4dFNoYWRvdz0wLjsKI2lmIGRlZmluZWQoU0hBRE9XUENGe1h9KQojaWYgZGVmaW5lZChTSEFET1dMT1dRVUFMSVRZe1h9KQpuZXh0U2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoQ1NNUENGMShmbG9hdChpbmRleHtYfSksdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2luZGV4e1h9XSx2RGVwdGhNZXRyaWN7WH1baW5kZXh7WH1dLHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VsaWYgZGVmaW5lZChTSEFET1dNRURJVU1RVUFMSVRZe1h9KQpuZXh0U2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoQ1NNUENGMyhmbG9hdChpbmRleHtYfSksdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2luZGV4e1h9XSx2RGVwdGhNZXRyaWN7WH1baW5kZXh7WH1dLHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueXosbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2Vsc2UKbmV4dFNoYWRvdz1jb21wdXRlU2hhZG93V2l0aENTTVBDRjUoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnl6LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbmRpZgojZWxpZiBkZWZpbmVkKFNIQURPV1BDU1N7WH0pCiNpZiBkZWZpbmVkKFNIQURPV0xPV1FVQUxJVFl7WH0pCm5leHRTaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhDU01QQ1NTMTYoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxkZXB0aFNhbXBsZXJ7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby55LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnosbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53LGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbntYfVtpbmRleHtYfV0sZGVwdGhDb3JyZWN0aW9ue1h9W2luZGV4e1h9XSxwZW51bWJyYURhcmtuZXNze1h9KTsKI2VsaWYgZGVmaW5lZChTSEFET1dNRURJVU1RVUFMSVRZe1h9KQpuZXh0U2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoQ1NNUENTUzMyKGZsb2F0KGluZGV4e1h9KSx2UG9zaXRpb25Gcm9tTGlnaHR7WH1baW5kZXh7WH1dLHZEZXB0aE1ldHJpY3tYfVtpbmRleHtYfV0sZGVwdGhTYW1wbGVye1h9LHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueSxsaWdodHtYfS5zaGFkb3dzSW5mby56LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyxsaWdodFNpemVVVkNvcnJlY3Rpb257WH1baW5kZXh7WH1dLGRlcHRoQ29ycmVjdGlvbntYfVtpbmRleHtYfV0scGVudW1icmFEYXJrbmVzc3tYfSk7CiNlbHNlCm5leHRTaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhDU01QQ1NTNjQoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxkZXB0aFNhbXBsZXJ7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby55LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnosbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53LGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbntYfVtpbmRleHtYfV0sZGVwdGhDb3JyZWN0aW9ue1h9W2luZGV4e1h9XSxwZW51bWJyYURhcmtuZXNze1h9KTsKI2VuZGlmCiNlbHNlCm5leHRTaGFkb3c9Y29tcHV0ZVNoYWRvd0NTTShmbG9hdChpbmRleHtYfSksdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2luZGV4e1h9XSx2RGVwdGhNZXRyaWN7WH1baW5kZXh7WH1dLHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VuZGlmCnNoYWRvdz1taXgobmV4dFNoYWRvdyxzaGFkb3csZGlmZlJhdGlvKTsKI2lmZGVmIFNIQURPV0NTTURFQlVHe1h9CnNoYWRvd0RlYnVne1h9PW1peCh2ZWMzKG5leHRTaGFkb3cpKnZDYXNjYWRlQ29sb3JzTXVsdGlwbGllcntYfVtpbmRleHtYfV0sc2hhZG93RGVidWd7WH0sZGlmZlJhdGlvKTsKI2VuZGlmCn0KI2VuZGlmCn0KI2VsaWYgZGVmaW5lZChTSEFET1dDTE9TRUVTTXtYfSkKI2lmIGRlZmluZWQoU0hBRE9XQ1VCRXtYfSkKc2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoQ2xvc2VFU01DdWJlKGxpZ2h0e1h9LnZMaWdodERhdGEueHl6LHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby56LGxpZ2h0e1h9LmRlcHRoVmFsdWVzKTsKI2Vsc2UKc2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoQ2xvc2VFU00odlBvc2l0aW9uRnJvbUxpZ2h0e1h9LHZEZXB0aE1ldHJpY3tYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8ueixsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VuZGlmCiNlbGlmIGRlZmluZWQoU0hBRE9XRVNNe1h9KQojaWYgZGVmaW5lZChTSEFET1dDVUJFe1h9KQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhFU01DdWJlKGxpZ2h0e1h9LnZMaWdodERhdGEueHl6LHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby56LGxpZ2h0e1h9LmRlcHRoVmFsdWVzKTsKI2Vsc2UKc2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoRVNNKHZQb3NpdGlvbkZyb21MaWdodHtYfSx2RGVwdGhNZXRyaWN7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnosbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbmRpZgojZWxpZiBkZWZpbmVkKFNIQURPV1BPSVNTT057WH0pCiNpZiBkZWZpbmVkKFNIQURPV0NVQkV7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aFBvaXNzb25TYW1wbGluZ0N1YmUobGlnaHR7WH0udkxpZ2h0RGF0YS54eXosc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby55LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uZGVwdGhWYWx1ZXMpOwojZWxzZQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhQb2lzc29uU2FtcGxpbmcodlBvc2l0aW9uRnJvbUxpZ2h0e1h9LHZEZXB0aE1ldHJpY3tYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnksbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VuZGlmCiNlbGlmIGRlZmluZWQoU0hBRE9XUENGe1h9KQojaWYgZGVmaW5lZChTSEFET1dMT1dRVUFMSVRZe1h9KQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhQQ0YxKHZQb3NpdGlvbkZyb21MaWdodHtYfSx2RGVwdGhNZXRyaWN7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncpOwojZWxpZiBkZWZpbmVkKFNIQURPV01FRElVTVFVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aFBDRjModlBvc2l0aW9uRnJvbUxpZ2h0e1h9LHZEZXB0aE1ldHJpY3tYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnl6LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbHNlCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aFBDRjUodlBvc2l0aW9uRnJvbUxpZ2h0e1h9LHZEZXB0aE1ldHJpY3tYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnl6LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbmRpZgojZWxpZiBkZWZpbmVkKFNIQURPV1BDU1N7WH0pCiNpZiBkZWZpbmVkKFNIQURPV0xPV1FVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aFBDU1MxNih2UG9zaXRpb25Gcm9tTGlnaHR7WH0sdkRlcHRoTWV0cmlje1h9LGRlcHRoU2FtcGxlcntYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnksbGlnaHR7WH0uc2hhZG93c0luZm8ueixsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncpOwojZWxpZiBkZWZpbmVkKFNIQURPV01FRElVTVFVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aFBDU1MzMih2UG9zaXRpb25Gcm9tTGlnaHR7WH0sdkRlcHRoTWV0cmlje1h9LGRlcHRoU2FtcGxlcntYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnksbGlnaHR7WH0uc2hhZG93c0luZm8ueixsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncpOwojZWxzZQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhQQ1NTNjQodlBvc2l0aW9uRnJvbUxpZ2h0e1h9LHZEZXB0aE1ldHJpY3tYfSxkZXB0aFNhbXBsZXJ7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby55LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnosbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VuZGlmCiNlbHNlCiNpZiBkZWZpbmVkKFNIQURPV0NVQkV7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93Q3ViZShsaWdodHtYfS52TGlnaHREYXRhLnh5eixzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uZGVwdGhWYWx1ZXMpOwojZWxzZQpzaGFkb3c9Y29tcHV0ZVNoYWRvdyh2UG9zaXRpb25Gcm9tTGlnaHR7WH0sdkRlcHRoTWV0cmlje1h9LHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VuZGlmCiNlbmRpZgojaWZkZWYgU0hBRE9XT05MWQojaWZuZGVmIFNIQURPV0lOVVNFCiNkZWZpbmUgU0hBRE9XSU5VU0UKI2VuZGlmCmdsb2JhbFNoYWRvdys9c2hhZG93OwpzaGFkb3dMaWdodENvdW50Kz0xLjA7CiNlbmRpZgojZWxzZQpzaGFkb3c9MS47CiNlbmRpZgojaWZuZGVmIFNIQURPV09OTFkKI2lmZGVmIENVU1RPTVVTRVJMSUdIVElORwpkaWZmdXNlQmFzZSs9Y29tcHV0ZUN1c3RvbURpZmZ1c2VMaWdodGluZyhpbmZvLGRpZmZ1c2VCYXNlLHNoYWRvdyk7CiNpZmRlZiBTUEVDVUxBUlRFUk0Kc3BlY3VsYXJCYXNlKz1jb21wdXRlQ3VzdG9tU3BlY3VsYXJMaWdodGluZyhpbmZvLHNwZWN1bGFyQmFzZSxzaGFkb3cpOwojZW5kaWYKI2VsaWYgZGVmaW5lZChMSUdIVE1BUCkgJiYgZGVmaW5lZChMSUdIVE1BUEVYQ0xVREVEe1h9KQpkaWZmdXNlQmFzZSs9bGlnaHRtYXBDb2xvci5yZ2Iqc2hhZG93OwojaWZkZWYgU1BFQ1VMQVJURVJNCiNpZm5kZWYgTElHSFRNQVBOT1NQRUNVTEFSe1h9CnNwZWN1bGFyQmFzZSs9aW5mby5zcGVjdWxhcipzaGFkb3cqbGlnaHRtYXBDb2xvci5yZ2I7CiNlbmRpZgojZW5kaWYKI2lmZGVmIENMRUFSQ09BVAojaWZuZGVmIExJR0hUTUFQTk9TUEVDVUxBUntYfQpjbGVhckNvYXRCYXNlKz1pbmZvLmNsZWFyQ29hdC5yZ2Iqc2hhZG93KmxpZ2h0bWFwQ29sb3IucmdiOwojZW5kaWYKI2VuZGlmCiNpZmRlZiBTSEVFTgojaWZuZGVmIExJR0hUTUFQTk9TUEVDVUxBUntYfQpzaGVlbkJhc2UrPWluZm8uc2hlZW4ucmdiKnNoYWRvdzsKI2VuZGlmCiNlbmRpZgojZWxzZQojaWZkZWYgU0hBRE9XQ1NNREVCVUd7WH0KZGlmZnVzZUJhc2UrPWluZm8uZGlmZnVzZSpzaGFkb3dEZWJ1Z3tYfTsKI2Vsc2UgCmRpZmZ1c2VCYXNlKz1pbmZvLmRpZmZ1c2Uqc2hhZG93OwojZW5kaWYKI2lmZGVmIFNQRUNVTEFSVEVSTQpzcGVjdWxhckJhc2UrPWluZm8uc3BlY3VsYXIqc2hhZG93OwojZW5kaWYKI2lmZGVmIENMRUFSQ09BVApjbGVhckNvYXRCYXNlKz1pbmZvLmNsZWFyQ29hdC5yZ2Iqc2hhZG93OwojZW5kaWYKI2lmZGVmIFNIRUVOCnNoZWVuQmFzZSs9aW5mby5zaGVlbi5yZ2Iqc2hhZG93OwojZW5kaWYKI2VuZGlmCiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3hoXT1NaDtjb25zdCBBaD0ibG9nRGVwdGhGcmFnbWVudCIsUmg9YCNpZmRlZiBMT0dBUklUSE1JQ0RFUFRICmdsX0ZyYWdEZXB0aEVYVD1sb2cyKHZGcmFnbWVudERlcHRoKSpsb2dhcml0aG1pY0RlcHRoQ29uc3RhbnQqMC41OwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW0FoXT1SaDtjb25zdCB5aD0iZm9nRnJhZ21lbnQiLENoPWAjaWZkZWYgRk9HCmZsb2F0IGZvZz1DYWxjRm9nRmFjdG9yKCk7CiNpZmRlZiBQQlIKZm9nPXRvTGluZWFyU3BhY2UoZm9nKTsKI2VuZGlmCmNvbG9yLnJnYj1taXgodkZvZ0NvbG9yLGNvbG9yLnJnYixmb2cpOwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3loXT1DaDtjb25zdCBJaD0ib2l0RnJhZ21lbnQiLFBoPWAjaWZkZWYgT1JERVJfSU5ERVBFTkRFTlRfVFJBTlNQQVJFTkNZCmZsb2F0IGZyYWdEZXB0aD1nbF9GcmFnQ29vcmQuejsgCiNpZmRlZiBPUkRFUl9JTkRFUEVOREVOVF9UUkFOU1BBUkVOQ1lfMTZCSVRTCnVpbnQgaGFsZkZsb2F0PXBhY2tIYWxmMngxNih2ZWMyKGZyYWdEZXB0aCkpOwp2ZWMyIGZ1bGw9dW5wYWNrSGFsZjJ4MTYoaGFsZkZsb2F0KTsKZnJhZ0RlcHRoPWZ1bGwueDsKI2VuZGlmCml2ZWMyIGZyYWdDb29yZD1pdmVjMihnbF9GcmFnQ29vcmQueHkpOwp2ZWMyIGxhc3REZXB0aD10ZXhlbEZldGNoKG9pdERlcHRoU2FtcGxlcixmcmFnQ29vcmQsMCkucmc7CnZlYzQgbGFzdEZyb250Q29sb3I9dGV4ZWxGZXRjaChvaXRGcm9udENvbG9yU2FtcGxlcixmcmFnQ29vcmQsMCk7CmRlcHRoLnJnPXZlYzIoLU1BWF9ERVBUSCk7CmZyb250Q29sb3I9bGFzdEZyb250Q29sb3I7CmJhY2tDb2xvcj12ZWM0KDAuMCk7CiNpZmRlZiBVU0VfUkVWRVJTRV9ERVBUSEJVRkZFUgpmbG9hdCBmdXJ0aGVzdERlcHRoPS1sYXN0RGVwdGgueDsKZmxvYXQgbmVhcmVzdERlcHRoPWxhc3REZXB0aC55OwojZWxzZQpmbG9hdCBuZWFyZXN0RGVwdGg9LWxhc3REZXB0aC54OwpmbG9hdCBmdXJ0aGVzdERlcHRoPWxhc3REZXB0aC55OwojZW5kaWYKZmxvYXQgYWxwaGFNdWx0aXBsaWVyPTEuMC1sYXN0RnJvbnRDb2xvci5hOwojaWZkZWYgVVNFX1JFVkVSU0VfREVQVEhCVUZGRVIKaWYgKGZyYWdEZXB0aD5uZWFyZXN0RGVwdGggfHwgZnJhZ0RlcHRoPGZ1cnRoZXN0RGVwdGgpIHsKI2Vsc2UKaWYgKGZyYWdEZXB0aDxuZWFyZXN0RGVwdGggfHwgZnJhZ0RlcHRoPmZ1cnRoZXN0RGVwdGgpIHsKI2VuZGlmCnJldHVybjsKfQojaWZkZWYgVVNFX1JFVkVSU0VfREVQVEhCVUZGRVIKaWYgKGZyYWdEZXB0aDxuZWFyZXN0RGVwdGggJiYgZnJhZ0RlcHRoPmZ1cnRoZXN0RGVwdGgpIHsKI2Vsc2UKaWYgKGZyYWdEZXB0aD5uZWFyZXN0RGVwdGggJiYgZnJhZ0RlcHRoPGZ1cnRoZXN0RGVwdGgpIHsKI2VuZGlmCmRlcHRoLnJnPXZlYzIoLWZyYWdEZXB0aCxmcmFnRGVwdGgpOwpyZXR1cm47Cn0KI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtJaF09UGg7Y29uc3QgRGg9ImRlZmF1bHRQaXhlbFNoYWRlciIsRmg9YCNpbmNsdWRlPF9fZGVjbF9fZGVmYXVsdEZyYWdtZW50PgojaWYgZGVmaW5lZChCVU1QKSB8fCAhZGVmaW5lZChOT1JNQUwpCiNleHRlbnNpb24gR0xfT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzIDogZW5hYmxlCiNlbmRpZgojaW5jbHVkZTxwcmVQYXNzRGVjbGFyYXRpb24+W1NDRU5FX01SVF9DT1VOVF0KI2luY2x1ZGU8b2l0RGVjbGFyYXRpb24+CiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0JFR0lOCiNpZmRlZiBMT0dBUklUSE1JQ0RFUFRICiNleHRlbnNpb24gR0xfRVhUX2ZyYWdfZGVwdGggOiBlbmFibGUKI2VuZGlmCiNkZWZpbmUgUkVDSVBST0NBTF9QSTIgMC4xNTkxNTQ5NAp2YXJ5aW5nIHZlYzMgdlBvc2l0aW9uVzsKI2lmZGVmIE5PUk1BTAp2YXJ5aW5nIHZlYzMgdk5vcm1hbFc7CiNlbmRpZgojaWYgZGVmaW5lZChWRVJURVhDT0xPUikgfHwgZGVmaW5lZChJTlNUQU5DRVNDT0xPUikgJiYgZGVmaW5lZChJTlNUQU5DRVMpCnZhcnlpbmcgdmVjNCB2Q29sb3I7CiNlbmRpZgojaW5jbHVkZTxtYWluVVZWYXJ5aW5nRGVjbGFyYXRpb24+WzEuLjddCiNpbmNsdWRlPGhlbHBlckZ1bmN0aW9ucz4KI2luY2x1ZGU8X19kZWNsX19saWdodEZyYWdtZW50PlswLi5tYXhTaW11bHRhbmVvdXNMaWdodHNdCiNpbmNsdWRlPGxpZ2h0c0ZyYWdtZW50RnVuY3Rpb25zPgojaW5jbHVkZTxzaGFkb3dzRnJhZ21lbnRGdW5jdGlvbnM+CiNpbmNsdWRlPHNhbXBsZXJGcmFnbWVudERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sRElGRlVTRSxfVkFSWUlOR05BTUVfLERpZmZ1c2UsX1NBTVBMRVJOQU1FXyxkaWZmdXNlKQojaW5jbHVkZTxzYW1wbGVyRnJhZ21lbnREZWNsYXJhdGlvbj4oX0RFRklORU5BTUVfLEFNQklFTlQsX1ZBUllJTkdOQU1FXyxBbWJpZW50LF9TQU1QTEVSTkFNRV8sYW1iaWVudCkKI2luY2x1ZGU8c2FtcGxlckZyYWdtZW50RGVjbGFyYXRpb24+KF9ERUZJTkVOQU1FXyxPUEFDSVRZLF9WQVJZSU5HTkFNRV8sT3BhY2l0eSxfU0FNUExFUk5BTUVfLG9wYWNpdHkpCiNpbmNsdWRlPHNhbXBsZXJGcmFnbWVudERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sRU1JU1NJVkUsX1ZBUllJTkdOQU1FXyxFbWlzc2l2ZSxfU0FNUExFUk5BTUVfLGVtaXNzaXZlKQojaW5jbHVkZTxzYW1wbGVyRnJhZ21lbnREZWNsYXJhdGlvbj4oX0RFRklORU5BTUVfLExJR0hUTUFQLF9WQVJZSU5HTkFNRV8sTGlnaHRtYXAsX1NBTVBMRVJOQU1FXyxsaWdodG1hcCkKI2lmZGVmIFJFRlJBQ1RJT04KI2lmZGVmIFJFRlJBQ1RJT05NQVBfM0QKdW5pZm9ybSBzYW1wbGVyQ3ViZSByZWZyYWN0aW9uQ3ViZVNhbXBsZXI7CiNlbHNlCnVuaWZvcm0gc2FtcGxlcjJEIHJlZnJhY3Rpb24yRFNhbXBsZXI7CiNlbmRpZgojZW5kaWYKI2lmIGRlZmluZWQoU1BFQ1VMQVJURVJNKQojaW5jbHVkZTxzYW1wbGVyRnJhZ21lbnREZWNsYXJhdGlvbj4oX0RFRklORU5BTUVfLFNQRUNVTEFSLF9WQVJZSU5HTkFNRV8sU3BlY3VsYXIsX1NBTVBMRVJOQU1FXyxzcGVjdWxhcikKI2VuZGlmCiNpbmNsdWRlPGZyZXNuZWxGdW5jdGlvbj4KI2lmZGVmIFJFRkxFQ1RJT04KI2lmZGVmIFJFRkxFQ1RJT05NQVBfM0QKdW5pZm9ybSBzYW1wbGVyQ3ViZSByZWZsZWN0aW9uQ3ViZVNhbXBsZXI7CiNlbHNlCnVuaWZvcm0gc2FtcGxlcjJEIHJlZmxlY3Rpb24yRFNhbXBsZXI7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTk1BUF9TS1lCT1gKdmFyeWluZyB2ZWMzIHZQb3NpdGlvblVWVzsKI2Vsc2UKI2lmIGRlZmluZWQoUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVJfRklYRUQpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9NSVJST1JFREVRVUlSRUNUQU5HVUxBUl9GSVhFRCkKdmFyeWluZyB2ZWMzIHZEaXJlY3Rpb25XOwojZW5kaWYKI2VuZGlmCiNpbmNsdWRlPHJlZmxlY3Rpb25GdW5jdGlvbj4KI2VuZGlmCiNpbmNsdWRlPGltYWdlUHJvY2Vzc2luZ0RlY2xhcmF0aW9uPgojaW5jbHVkZTxpbWFnZVByb2Nlc3NpbmdGdW5jdGlvbnM+CiNpbmNsdWRlPGJ1bXBGcmFnbWVudE1haW5GdW5jdGlvbnM+CiNpbmNsdWRlPGJ1bXBGcmFnbWVudEZ1bmN0aW9ucz4KI2luY2x1ZGU8Y2xpcFBsYW5lRnJhZ21lbnREZWNsYXJhdGlvbj4KI2luY2x1ZGU8bG9nRGVwdGhEZWNsYXJhdGlvbj4KI2luY2x1ZGU8Zm9nRnJhZ21lbnREZWNsYXJhdGlvbj4KI2RlZmluZSBDVVNUT01fRlJBR01FTlRfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpIHsKI2RlZmluZSBDVVNUT01fRlJBR01FTlRfTUFJTl9CRUdJTgojaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudD4KdmVjMyB2aWV3RGlyZWN0aW9uVz1ub3JtYWxpemUodkV5ZVBvc2l0aW9uLnh5ei12UG9zaXRpb25XKTsKdmVjNCBiYXNlQ29sb3I9dmVjNCgxLiwxLiwxLiwxLik7CnZlYzMgZGlmZnVzZUNvbG9yPXZEaWZmdXNlQ29sb3IucmdiOwpmbG9hdCBhbHBoYT12RGlmZnVzZUNvbG9yLmE7CiNpZmRlZiBOT1JNQUwKdmVjMyBub3JtYWxXPW5vcm1hbGl6ZSh2Tm9ybWFsVyk7CiNlbHNlCnZlYzMgbm9ybWFsVz1ub3JtYWxpemUoLWNyb3NzKGRGZHgodlBvc2l0aW9uVyksZEZkeSh2UG9zaXRpb25XKSkpOwojZW5kaWYKI2luY2x1ZGU8YnVtcEZyYWdtZW50PgojaWZkZWYgVFdPU0lERURMSUdIVElORwpub3JtYWxXPWdsX0Zyb250RmFjaW5nID8gbm9ybWFsVyA6IC1ub3JtYWxXOwojZW5kaWYKI2lmZGVmIERJRkZVU0UKYmFzZUNvbG9yPXRleHR1cmUyRChkaWZmdXNlU2FtcGxlcix2RGlmZnVzZVVWK3V2T2Zmc2V0KTsKI2lmIGRlZmluZWQoQUxQSEFURVNUKSAmJiAhZGVmaW5lZChBTFBIQVRFU1RfQUZURVJBTExBTFBIQUNPTVBVVEFUSU9OUykKaWYgKGJhc2VDb2xvci5hPGFscGhhQ3V0T2ZmKQpkaXNjYXJkOwojZW5kaWYKI2lmZGVmIEFMUEhBRlJPTURJRkZVU0UKYWxwaGEqPWJhc2VDb2xvci5hOwojZW5kaWYKI2RlZmluZSBDVVNUT01fRlJBR01FTlRfVVBEQVRFX0FMUEhBCmJhc2VDb2xvci5yZ2IqPXZEaWZmdXNlSW5mb3MueTsKI2VuZGlmCiNpbmNsdWRlPGRlcHRoUHJlUGFzcz4KI2lmIGRlZmluZWQoVkVSVEVYQ09MT1IpIHx8IGRlZmluZWQoSU5TVEFOQ0VTQ09MT1IpICYmIGRlZmluZWQoSU5TVEFOQ0VTKQpiYXNlQ29sb3IucmdiKj12Q29sb3IucmdiOwojZW5kaWYKI2lmZGVmIERFVEFJTApiYXNlQ29sb3IucmdiPWJhc2VDb2xvci5yZ2IqMi4wKm1peCgwLjUsZGV0YWlsQ29sb3Iucix2RGV0YWlsSW5mb3MueSk7CiNlbmRpZgojZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9VUERBVEVfRElGRlVTRQp2ZWMzIGJhc2VBbWJpZW50Q29sb3I9dmVjMygxLiwxLiwxLik7CiNpZmRlZiBBTUJJRU5UCmJhc2VBbWJpZW50Q29sb3I9dGV4dHVyZTJEKGFtYmllbnRTYW1wbGVyLHZBbWJpZW50VVYrdXZPZmZzZXQpLnJnYip2QW1iaWVudEluZm9zLnk7CiNlbmRpZgojZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9CRUZPUkVfTElHSFRTCiNpZmRlZiBTUEVDVUxBUlRFUk0KZmxvYXQgZ2xvc3NpbmVzcz12U3BlY3VsYXJDb2xvci5hOwp2ZWMzIHNwZWN1bGFyQ29sb3I9dlNwZWN1bGFyQ29sb3IucmdiOwojaWZkZWYgU1BFQ1VMQVIKdmVjNCBzcGVjdWxhck1hcENvbG9yPXRleHR1cmUyRChzcGVjdWxhclNhbXBsZXIsdlNwZWN1bGFyVVYrdXZPZmZzZXQpOwpzcGVjdWxhckNvbG9yPXNwZWN1bGFyTWFwQ29sb3IucmdiOwojaWZkZWYgR0xPU1NJTkVTUwpnbG9zc2luZXNzPWdsb3NzaW5lc3Mqc3BlY3VsYXJNYXBDb2xvci5hOwojZW5kaWYKI2VuZGlmCiNlbHNlCmZsb2F0IGdsb3NzaW5lc3M9MC47CiNlbmRpZgp2ZWMzIGRpZmZ1c2VCYXNlPXZlYzMoMC4sMC4sMC4pOwpsaWdodGluZ0luZm8gaW5mbzsKI2lmZGVmIFNQRUNVTEFSVEVSTQp2ZWMzIHNwZWN1bGFyQmFzZT12ZWMzKDAuLDAuLDAuKTsKI2VuZGlmCmZsb2F0IHNoYWRvdz0xLjsKI2lmZGVmIExJR0hUTUFQCnZlYzQgbGlnaHRtYXBDb2xvcj10ZXh0dXJlMkQobGlnaHRtYXBTYW1wbGVyLHZMaWdodG1hcFVWK3V2T2Zmc2V0KTsKI2lmZGVmIFJHQkRMSUdIVE1BUApsaWdodG1hcENvbG9yLnJnYj1mcm9tUkdCRChsaWdodG1hcENvbG9yKTsKI2VuZGlmCmxpZ2h0bWFwQ29sb3IucmdiKj12TGlnaHRtYXBJbmZvcy55OwojZW5kaWYKI2luY2x1ZGU8bGlnaHRGcmFnbWVudD5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXQp2ZWM0IHJlZnJhY3Rpb25Db2xvcj12ZWM0KDAuLDAuLDAuLDEuKTsKI2lmZGVmIFJFRlJBQ1RJT04KdmVjMyByZWZyYWN0aW9uVmVjdG9yPW5vcm1hbGl6ZShyZWZyYWN0KC12aWV3RGlyZWN0aW9uVyxub3JtYWxXLHZSZWZyYWN0aW9uSW5mb3MueSkpOwojaWZkZWYgUkVGUkFDVElPTk1BUF8zRAojaWZkZWYgVVNFX0xPQ0FMX1JFRlJBQ1RJT05NQVBfQ1VCSUMKcmVmcmFjdGlvblZlY3Rvcj1wYXJhbGxheENvcnJlY3ROb3JtYWwodlBvc2l0aW9uVyxyZWZyYWN0aW9uVmVjdG9yLHZSZWZyYWN0aW9uU2l6ZSx2UmVmcmFjdGlvblBvc2l0aW9uKTsKI2VuZGlmCnJlZnJhY3Rpb25WZWN0b3IueT1yZWZyYWN0aW9uVmVjdG9yLnkqdlJlZnJhY3Rpb25JbmZvcy53OwppZiAoZG90KHJlZnJhY3Rpb25WZWN0b3Isdmlld0RpcmVjdGlvblcpPDEuMCkgewpyZWZyYWN0aW9uQ29sb3I9dGV4dHVyZUN1YmUocmVmcmFjdGlvbkN1YmVTYW1wbGVyLHJlZnJhY3Rpb25WZWN0b3IpOwp9CiNlbHNlCnZlYzMgdlJlZnJhY3Rpb25VVlc9dmVjMyhyZWZyYWN0aW9uTWF0cml4Kih2aWV3KnZlYzQodlBvc2l0aW9uVytyZWZyYWN0aW9uVmVjdG9yKnZSZWZyYWN0aW9uSW5mb3MueiwxLjApKSk7CnZlYzIgcmVmcmFjdGlvbkNvb3Jkcz12UmVmcmFjdGlvblVWVy54eS92UmVmcmFjdGlvblVWVy56OwpyZWZyYWN0aW9uQ29vcmRzLnk9MS4wLXJlZnJhY3Rpb25Db29yZHMueTsKcmVmcmFjdGlvbkNvbG9yPXRleHR1cmUyRChyZWZyYWN0aW9uMkRTYW1wbGVyLHJlZnJhY3Rpb25Db29yZHMpOwojZW5kaWYKI2lmZGVmIFJHQkRSRUZSQUNUSU9OCnJlZnJhY3Rpb25Db2xvci5yZ2I9ZnJvbVJHQkQocmVmcmFjdGlvbkNvbG9yKTsKI2VuZGlmCiNpZmRlZiBJU19SRUZSQUNUSU9OX0xJTkVBUgpyZWZyYWN0aW9uQ29sb3IucmdiPXRvR2FtbWFTcGFjZShyZWZyYWN0aW9uQ29sb3IucmdiKTsKI2VuZGlmCnJlZnJhY3Rpb25Db2xvci5yZ2IqPXZSZWZyYWN0aW9uSW5mb3MueDsKI2VuZGlmCnZlYzQgcmVmbGVjdGlvbkNvbG9yPXZlYzQoMC4sMC4sMC4sMS4pOwojaWZkZWYgUkVGTEVDVElPTgp2ZWMzIHZSZWZsZWN0aW9uVVZXPWNvbXB1dGVSZWZsZWN0aW9uQ29vcmRzKHZlYzQodlBvc2l0aW9uVywxLjApLG5vcm1hbFcpOwojaWZkZWYgUkVGTEVDVElPTk1BUF9PUFBPU0lURVoKdlJlZmxlY3Rpb25VVlcueio9LTEuMDsKI2VuZGlmCiNpZmRlZiBSRUZMRUNUSU9OTUFQXzNECiNpZmRlZiBST1VHSE5FU1MKZmxvYXQgYmlhcz12UmVmbGVjdGlvbkluZm9zLnk7CiNpZmRlZiBTUEVDVUxBUlRFUk0KI2lmZGVmIFNQRUNVTEFSCiNpZmRlZiBHTE9TU0lORVNTCmJpYXMqPSgxLjAtc3BlY3VsYXJNYXBDb2xvci5hKTsKI2VuZGlmCiNlbmRpZgojZW5kaWYKcmVmbGVjdGlvbkNvbG9yPXRleHR1cmVDdWJlKHJlZmxlY3Rpb25DdWJlU2FtcGxlcix2UmVmbGVjdGlvblVWVyxiaWFzKTsKI2Vsc2UKcmVmbGVjdGlvbkNvbG9yPXRleHR1cmVDdWJlKHJlZmxlY3Rpb25DdWJlU2FtcGxlcix2UmVmbGVjdGlvblVWVyk7CiNlbmRpZgojZWxzZQp2ZWMyIGNvb3Jkcz12UmVmbGVjdGlvblVWVy54eTsKI2lmZGVmIFJFRkxFQ1RJT05NQVBfUFJPSkVDVElPTgpjb29yZHMvPXZSZWZsZWN0aW9uVVZXLno7CiNlbmRpZgpjb29yZHMueT0xLjAtY29vcmRzLnk7CnJlZmxlY3Rpb25Db2xvcj10ZXh0dXJlMkQocmVmbGVjdGlvbjJEU2FtcGxlcixjb29yZHMpOwojZW5kaWYKI2lmZGVmIFJHQkRSRUZMRUNUSU9OCnJlZmxlY3Rpb25Db2xvci5yZ2I9ZnJvbVJHQkQocmVmbGVjdGlvbkNvbG9yKTsKI2VuZGlmCiNpZmRlZiBJU19SRUZMRUNUSU9OX0xJTkVBUgpyZWZsZWN0aW9uQ29sb3IucmdiPXRvR2FtbWFTcGFjZShyZWZsZWN0aW9uQ29sb3IucmdiKTsKI2VuZGlmCnJlZmxlY3Rpb25Db2xvci5yZ2IqPXZSZWZsZWN0aW9uSW5mb3MueDsKI2lmZGVmIFJFRkxFQ1RJT05GUkVTTkVMCmZsb2F0IHJlZmxlY3Rpb25GcmVzbmVsVGVybT1jb21wdXRlRnJlc25lbFRlcm0odmlld0RpcmVjdGlvblcsbm9ybWFsVyxyZWZsZWN0aW9uUmlnaHRDb2xvci5hLHJlZmxlY3Rpb25MZWZ0Q29sb3IuYSk7CiNpZmRlZiBSRUZMRUNUSU9ORlJFU05FTEZST01TUEVDVUxBUgojaWZkZWYgU1BFQ1VMQVJURVJNCnJlZmxlY3Rpb25Db2xvci5yZ2IqPXNwZWN1bGFyQ29sb3IucmdiKigxLjAtcmVmbGVjdGlvbkZyZXNuZWxUZXJtKStyZWZsZWN0aW9uRnJlc25lbFRlcm0qcmVmbGVjdGlvblJpZ2h0Q29sb3IucmdiOwojZWxzZQpyZWZsZWN0aW9uQ29sb3IucmdiKj1yZWZsZWN0aW9uTGVmdENvbG9yLnJnYiooMS4wLXJlZmxlY3Rpb25GcmVzbmVsVGVybSkrcmVmbGVjdGlvbkZyZXNuZWxUZXJtKnJlZmxlY3Rpb25SaWdodENvbG9yLnJnYjsKI2VuZGlmCiNlbHNlCnJlZmxlY3Rpb25Db2xvci5yZ2IqPXJlZmxlY3Rpb25MZWZ0Q29sb3IucmdiKigxLjAtcmVmbGVjdGlvbkZyZXNuZWxUZXJtKStyZWZsZWN0aW9uRnJlc25lbFRlcm0qcmVmbGVjdGlvblJpZ2h0Q29sb3IucmdiOwojZW5kaWYKI2VuZGlmCiNlbmRpZgojaWZkZWYgUkVGUkFDVElPTkZSRVNORUwKZmxvYXQgcmVmcmFjdGlvbkZyZXNuZWxUZXJtPWNvbXB1dGVGcmVzbmVsVGVybSh2aWV3RGlyZWN0aW9uVyxub3JtYWxXLHJlZnJhY3Rpb25SaWdodENvbG9yLmEscmVmcmFjdGlvbkxlZnRDb2xvci5hKTsKcmVmcmFjdGlvbkNvbG9yLnJnYio9cmVmcmFjdGlvbkxlZnRDb2xvci5yZ2IqKDEuMC1yZWZyYWN0aW9uRnJlc25lbFRlcm0pK3JlZnJhY3Rpb25GcmVzbmVsVGVybSpyZWZyYWN0aW9uUmlnaHRDb2xvci5yZ2I7CiNlbmRpZgojaWZkZWYgT1BBQ0lUWQp2ZWM0IG9wYWNpdHlNYXA9dGV4dHVyZTJEKG9wYWNpdHlTYW1wbGVyLHZPcGFjaXR5VVYrdXZPZmZzZXQpOwojaWZkZWYgT1BBQ0lUWVJHQgpvcGFjaXR5TWFwLnJnYj1vcGFjaXR5TWFwLnJnYip2ZWMzKDAuMywwLjU5LDAuMTEpOwphbHBoYSo9KG9wYWNpdHlNYXAueCtvcGFjaXR5TWFwLnkrb3BhY2l0eU1hcC56KSogdk9wYWNpdHlJbmZvcy55OwojZWxzZQphbHBoYSo9b3BhY2l0eU1hcC5hKnZPcGFjaXR5SW5mb3MueTsKI2VuZGlmCiNlbmRpZgojaWYgZGVmaW5lZChWRVJURVhBTFBIQSkgfHwgZGVmaW5lZChJTlNUQU5DRVNDT0xPUikgJiYgZGVmaW5lZChJTlNUQU5DRVMpCmFscGhhKj12Q29sb3IuYTsKI2VuZGlmCiNpZmRlZiBPUEFDSVRZRlJFU05FTApmbG9hdCBvcGFjaXR5RnJlc25lbFRlcm09Y29tcHV0ZUZyZXNuZWxUZXJtKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsb3BhY2l0eVBhcnRzLnosb3BhY2l0eVBhcnRzLncpOwphbHBoYSs9b3BhY2l0eVBhcnRzLngqKDEuMC1vcGFjaXR5RnJlc25lbFRlcm0pK29wYWNpdHlGcmVzbmVsVGVybSpvcGFjaXR5UGFydHMueTsKI2VuZGlmCiNpZmRlZiBBTFBIQVRFU1QKI2lmZGVmIEFMUEhBVEVTVF9BRlRFUkFMTEFMUEhBQ09NUFVUQVRJT05TCmlmIChhbHBoYTxhbHBoYUN1dE9mZikKZGlzY2FyZDsKI2VuZGlmCiNpZm5kZWYgQUxQSEFCTEVORAphbHBoYT0xLjA7CiNlbmRpZgojZW5kaWYKdmVjMyBlbWlzc2l2ZUNvbG9yPXZFbWlzc2l2ZUNvbG9yOwojaWZkZWYgRU1JU1NJVkUKZW1pc3NpdmVDb2xvcis9dGV4dHVyZTJEKGVtaXNzaXZlU2FtcGxlcix2RW1pc3NpdmVVVit1dk9mZnNldCkucmdiKnZFbWlzc2l2ZUluZm9zLnk7CiNlbmRpZgojaWZkZWYgRU1JU1NJVkVGUkVTTkVMCmZsb2F0IGVtaXNzaXZlRnJlc25lbFRlcm09Y29tcHV0ZUZyZXNuZWxUZXJtKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsZW1pc3NpdmVSaWdodENvbG9yLmEsZW1pc3NpdmVMZWZ0Q29sb3IuYSk7CmVtaXNzaXZlQ29sb3IqPWVtaXNzaXZlTGVmdENvbG9yLnJnYiooMS4wLWVtaXNzaXZlRnJlc25lbFRlcm0pK2VtaXNzaXZlRnJlc25lbFRlcm0qZW1pc3NpdmVSaWdodENvbG9yLnJnYjsKI2VuZGlmCiNpZmRlZiBESUZGVVNFRlJFU05FTApmbG9hdCBkaWZmdXNlRnJlc25lbFRlcm09Y29tcHV0ZUZyZXNuZWxUZXJtKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsZGlmZnVzZVJpZ2h0Q29sb3IuYSxkaWZmdXNlTGVmdENvbG9yLmEpOwpkaWZmdXNlQmFzZSo9ZGlmZnVzZUxlZnRDb2xvci5yZ2IqKDEuMC1kaWZmdXNlRnJlc25lbFRlcm0pK2RpZmZ1c2VGcmVzbmVsVGVybSpkaWZmdXNlUmlnaHRDb2xvci5yZ2I7CiNlbmRpZgojaWZkZWYgRU1JU1NJVkVBU0lMTFVNSU5BVElPTgp2ZWMzIGZpbmFsRGlmZnVzZT1jbGFtcChkaWZmdXNlQmFzZSpkaWZmdXNlQ29sb3IrdkFtYmllbnRDb2xvciwwLjAsMS4wKSpiYXNlQ29sb3IucmdiOwojZWxzZQojaWZkZWYgTElOS0VNSVNTSVZFV0lUSERJRkZVU0UKdmVjMyBmaW5hbERpZmZ1c2U9Y2xhbXAoKGRpZmZ1c2VCYXNlK2VtaXNzaXZlQ29sb3IpKmRpZmZ1c2VDb2xvcit2QW1iaWVudENvbG9yLDAuMCwxLjApKmJhc2VDb2xvci5yZ2I7CiNlbHNlCnZlYzMgZmluYWxEaWZmdXNlPWNsYW1wKGRpZmZ1c2VCYXNlKmRpZmZ1c2VDb2xvcitlbWlzc2l2ZUNvbG9yK3ZBbWJpZW50Q29sb3IsMC4wLDEuMCkqYmFzZUNvbG9yLnJnYjsKI2VuZGlmCiNlbmRpZgojaWZkZWYgU1BFQ1VMQVJURVJNCnZlYzMgZmluYWxTcGVjdWxhcj1zcGVjdWxhckJhc2Uqc3BlY3VsYXJDb2xvcjsKI2lmZGVmIFNQRUNVTEFST1ZFUkFMUEhBCmFscGhhPWNsYW1wKGFscGhhK2RvdChmaW5hbFNwZWN1bGFyLHZlYzMoMC4zLDAuNTksMC4xMSkpLDAuLDEuKTsKI2VuZGlmCiNlbHNlCnZlYzMgZmluYWxTcGVjdWxhcj12ZWMzKDAuMCk7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTk9WRVJBTFBIQQphbHBoYT1jbGFtcChhbHBoYStkb3QocmVmbGVjdGlvbkNvbG9yLnJnYix2ZWMzKDAuMywwLjU5LDAuMTEpKSwwLiwxLik7CiNlbmRpZgojaWZkZWYgRU1JU1NJVkVBU0lMTFVNSU5BVElPTgp2ZWM0IGNvbG9yPXZlYzQoY2xhbXAoZmluYWxEaWZmdXNlKmJhc2VBbWJpZW50Q29sb3IrZmluYWxTcGVjdWxhcityZWZsZWN0aW9uQ29sb3IucmdiK2VtaXNzaXZlQ29sb3IrcmVmcmFjdGlvbkNvbG9yLnJnYiwwLjAsMS4wKSxhbHBoYSk7CiNlbHNlCnZlYzQgY29sb3I9dmVjNChmaW5hbERpZmZ1c2UqYmFzZUFtYmllbnRDb2xvcitmaW5hbFNwZWN1bGFyK3JlZmxlY3Rpb25Db2xvci5yZ2IrcmVmcmFjdGlvbkNvbG9yLnJnYixhbHBoYSk7CiNlbmRpZgojaWZkZWYgTElHSFRNQVAKI2lmbmRlZiBMSUdIVE1BUEVYQ0xVREVECiNpZmRlZiBVU0VMSUdIVE1BUEFTU0hBRE9XTUFQCmNvbG9yLnJnYio9bGlnaHRtYXBDb2xvci5yZ2I7CiNlbHNlCmNvbG9yLnJnYis9bGlnaHRtYXBDb2xvci5yZ2I7CiNlbmRpZgojZW5kaWYKI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0JFRk9SRV9GT0cKY29sb3IucmdiPW1heChjb2xvci5yZ2IsMC4pOwojaW5jbHVkZTxsb2dEZXB0aEZyYWdtZW50PgojaW5jbHVkZTxmb2dGcmFnbWVudD4KI2lmZGVmIElNQUdFUFJPQ0VTU0lOR1BPU1RQUk9DRVNTCmNvbG9yLnJnYj10b0xpbmVhclNwYWNlKGNvbG9yLnJnYik7CiNlbHNlCiNpZmRlZiBJTUFHRVBST0NFU1NJTkcKY29sb3IucmdiPXRvTGluZWFyU3BhY2UoY29sb3IucmdiKTsKY29sb3I9YXBwbHlJbWFnZVByb2Nlc3NpbmcoY29sb3IpOwojZW5kaWYKI2VuZGlmCmNvbG9yLmEqPXZpc2liaWxpdHk7CiNpZmRlZiBQUkVNVUxUSVBMWUFMUEhBCmNvbG9yLnJnYio9Y29sb3IuYTsKI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0JFRk9SRV9GUkFHQ09MT1IKI2lmZGVmIFBSRVBBU1MKZmxvYXQgd3JpdGVHZW9tZXRyeUluZm89Y29sb3IuYT4wLjQgPyAxLjAgOiAwLjA7CmdsX0ZyYWdEYXRhWzBdPWNvbG9yOyAKI2lmZGVmIFBSRVBBU1NfUE9TSVRJT04KZ2xfRnJhZ0RhdGFbUFJFUEFTU19QT1NJVElPTl9JTkRFWF09dmVjNCh2UG9zaXRpb25XLHdyaXRlR2VvbWV0cnlJbmZvKTsKI2VuZGlmCiNpZmRlZiBQUkVQQVNTX1ZFTE9DSVRZCnZlYzIgYT0odkN1cnJlbnRQb3NpdGlvbi54eS92Q3VycmVudFBvc2l0aW9uLncpKjAuNSswLjU7CnZlYzIgYj0odlByZXZpb3VzUG9zaXRpb24ueHkvdlByZXZpb3VzUG9zaXRpb24udykqMC41KzAuNTsKdmVjMiB2ZWxvY2l0eT1hYnMoYS1iKTsKdmVsb2NpdHk9dmVjMihwb3codmVsb2NpdHkueCwxLjAvMy4wKSxwb3codmVsb2NpdHkueSwxLjAvMy4wKSkqc2lnbihhLWIpKjAuNSswLjU7CmdsX0ZyYWdEYXRhW1BSRVBBU1NfVkVMT0NJVFlfSU5ERVhdPXZlYzQodmVsb2NpdHksMC4wLHdyaXRlR2VvbWV0cnlJbmZvKTsKI2VuZGlmCiNpZmRlZiBQUkVQQVNTX0lSUkFESUFOQ0UKZ2xfRnJhZ0RhdGFbUFJFUEFTU19JUlJBRElBTkNFX0lOREVYXT12ZWM0KDAuMCwwLjAsMC4wLHdyaXRlR2VvbWV0cnlJbmZvKTsgCiNlbmRpZgojaWZkZWYgUFJFUEFTU19ERVBUSApnbF9GcmFnRGF0YVtQUkVQQVNTX0RFUFRIX0lOREVYXT12ZWM0KHZWaWV3UG9zLnosMC4wLDAuMCx3cml0ZUdlb21ldHJ5SW5mbyk7IAojZW5kaWYKI2lmZGVmIFBSRVBBU1NfTk9STUFMCmdsX0ZyYWdEYXRhW1BSRVBBU1NfTk9STUFMX0lOREVYXT12ZWM0KCh2aWV3KnZlYzQobm9ybWFsVywwLjApKS5yZ2Isd3JpdGVHZW9tZXRyeUluZm8pOyAKI2VuZGlmCiNpZmRlZiBQUkVQQVNTX0FMQkVET19TUVJUCmdsX0ZyYWdEYXRhW1BSRVBBU1NfQUxCRURPX1NRUlRfSU5ERVhdPXZlYzQoMC4wLDAuMCwwLjAsd3JpdGVHZW9tZXRyeUluZm8pOyAKI2VuZGlmCiNpZmRlZiBQUkVQQVNTX1JFRkxFQ1RJVklUWQojaWYgZGVmaW5lZChTUEVDVUxBUlRFUk0pCiNpZiBkZWZpbmVkKFNQRUNVTEFSKQpnbF9GcmFnRGF0YVtQUkVQQVNTX1JFRkxFQ1RJVklUWV9JTkRFWF09dmVjNChzcGVjdWxhck1hcENvbG9yKSp3cml0ZUdlb21ldHJ5SW5mbzsgCiNlbHNlCmdsX0ZyYWdEYXRhW1BSRVBBU1NfUkVGTEVDVElWSVRZX0lOREVYXT12ZWM0KHNwZWN1bGFyQ29sb3IsMS4wKSp3cml0ZUdlb21ldHJ5SW5mbzsKI2VuZGlmCiNlbHNlCmdsX0ZyYWdEYXRhW1BSRVBBU1NfUkVGTEVDVElWSVRZX0lOREVYXT12ZWM0KDAuMCwwLjAsMC4wLDEuMCkqd3JpdGVHZW9tZXRyeUluZm87CiNlbmRpZgojZW5kaWYKI2VuZGlmCiNpZiAhZGVmaW5lZChQUkVQQVNTKSB8fCBkZWZpbmVkKFdFQkdMMikKZ2xfRnJhZ0NvbG9yPWNvbG9yOwojZW5kaWYKI2luY2x1ZGU8b2l0RnJhZ21lbnQ+CiNpZiBPUkRFUl9JTkRFUEVOREVOVF9UUkFOU1BBUkVOQ1kKaWYgKGZyYWdEZXB0aD09bmVhcmVzdERlcHRoKSB7CmZyb250Q29sb3IucmdiKz1jb2xvci5yZ2IqY29sb3IuYSphbHBoYU11bHRpcGxpZXI7CmZyb250Q29sb3IuYT0xLjAtYWxwaGFNdWx0aXBsaWVyKigxLjAtY29sb3IuYSk7Cn0gZWxzZSB7CmJhY2tDb2xvcis9Y29sb3I7Cn0KI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX01BSU5fRU5ECn0KYDtVLlNoYWRlcnNTdG9yZVtEaF09Rmg7Y29uc3Qgd2g9ImRlZmF1bHRWZXJ0ZXhEZWNsYXJhdGlvbiIsT2g9YHVuaWZvcm0gbWF0NCB2aWV3UHJvamVjdGlvbjsKdW5pZm9ybSBtYXQ0IHZpZXc7CiNpZmRlZiBESUZGVVNFCnVuaWZvcm0gbWF0NCBkaWZmdXNlTWF0cml4Owp1bmlmb3JtIHZlYzIgdkRpZmZ1c2VJbmZvczsKI2VuZGlmCiNpZmRlZiBBTUJJRU5UCnVuaWZvcm0gbWF0NCBhbWJpZW50TWF0cml4Owp1bmlmb3JtIHZlYzIgdkFtYmllbnRJbmZvczsKI2VuZGlmCiNpZmRlZiBPUEFDSVRZCnVuaWZvcm0gbWF0NCBvcGFjaXR5TWF0cml4Owp1bmlmb3JtIHZlYzIgdk9wYWNpdHlJbmZvczsKI2VuZGlmCiNpZmRlZiBFTUlTU0lWRQp1bmlmb3JtIHZlYzIgdkVtaXNzaXZlSW5mb3M7CnVuaWZvcm0gbWF0NCBlbWlzc2l2ZU1hdHJpeDsKI2VuZGlmCiNpZmRlZiBMSUdIVE1BUAp1bmlmb3JtIHZlYzIgdkxpZ2h0bWFwSW5mb3M7CnVuaWZvcm0gbWF0NCBsaWdodG1hcE1hdHJpeDsKI2VuZGlmCiNpZiBkZWZpbmVkKFNQRUNVTEFSKSAmJiBkZWZpbmVkKFNQRUNVTEFSVEVSTSkKdW5pZm9ybSB2ZWMyIHZTcGVjdWxhckluZm9zOwp1bmlmb3JtIG1hdDQgc3BlY3VsYXJNYXRyaXg7CiNlbmRpZgojaWZkZWYgQlVNUAp1bmlmb3JtIHZlYzMgdkJ1bXBJbmZvczsKdW5pZm9ybSBtYXQ0IGJ1bXBNYXRyaXg7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTgp1bmlmb3JtIG1hdDQgcmVmbGVjdGlvbk1hdHJpeDsKI2VuZGlmCiNpZmRlZiBQT0lOVFNJWkUKdW5pZm9ybSBmbG9hdCBwb2ludFNpemU7CiNlbmRpZgojaWZkZWYgREVUQUlMCnVuaWZvcm0gdmVjNCB2RGV0YWlsSW5mb3M7CnVuaWZvcm0gbWF0NCBkZXRhaWxNYXRyaXg7CiNlbmRpZgojZGVmaW5lIEFERElUSU9OQUxfVkVSVEVYX0RFQ0xBUkFUSU9OCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVt3aF09T2g7Y29uc3QgTGg9InV2QXR0cmlidXRlRGVjbGFyYXRpb24iLE5oPWAjaWZkZWYgVVZ7WH0KYXR0cmlidXRlIHZlYzIgdXZ7WH07CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbTGhdPU5oO2NvbnN0IEJoPSJwcmVQYXNzVmVydGV4RGVjbGFyYXRpb24iLFVoPWAjaWZkZWYgUFJFUEFTUwojaWZkZWYgUFJFUEFTU19ERVBUSAp2YXJ5aW5nIHZlYzMgdlZpZXdQb3M7CiNlbmRpZgojaWZkZWYgUFJFUEFTU19WRUxPQ0lUWQp1bmlmb3JtIG1hdDQgcHJldmlvdXNWaWV3UHJvamVjdGlvbjsKdmFyeWluZyB2ZWM0IHZDdXJyZW50UG9zaXRpb247CnZhcnlpbmcgdmVjNCB2UHJldmlvdXNQb3NpdGlvbjsKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbQmhdPVVoO2NvbnN0IGtoPSJzYW1wbGVyVmVydGV4RGVjbGFyYXRpb24iLFZoPWAjaWYgZGVmaW5lZChfREVGSU5FTkFNRV8pICYmIF9ERUZJTkVOQU1FX0RJUkVDVFVWPT0wCnZhcnlpbmcgdmVjMiB2X1ZBUllJTkdOQU1FX1VWOwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2toXT1WaDtjb25zdCBXaD0iYnVtcFZlcnRleERlY2xhcmF0aW9uIix6aD1gI2lmIGRlZmluZWQoQlVNUCkgfHwgZGVmaW5lZChQQVJBTExBWCkgfHwgZGVmaW5lZChDTEVBUkNPQVRfQlVNUCkgfHwgZGVmaW5lZChBTklTT1RST1BJQykKI2lmIGRlZmluZWQoVEFOR0VOVCkgJiYgZGVmaW5lZChOT1JNQUwpIAp2YXJ5aW5nIG1hdDMgdlRCTjsKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbV2hdPXpoO2NvbnN0IEdoPSJmb2dWZXJ0ZXhEZWNsYXJhdGlvbiIsWGg9YCNpZmRlZiBGT0cKdmFyeWluZyB2ZWMzIHZGb2dEaXN0YW5jZTsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtHaF09WGg7Y29uc3QgSGg9ImxpZ2h0VnhGcmFnbWVudERlY2xhcmF0aW9uIixLaD1gI2lmZGVmIExJR0hUe1h9CnVuaWZvcm0gdmVjNCB2TGlnaHREYXRhe1h9Owp1bmlmb3JtIHZlYzQgdkxpZ2h0RGlmZnVzZXtYfTsKI2lmZGVmIFNQRUNVTEFSVEVSTQp1bmlmb3JtIHZlYzQgdkxpZ2h0U3BlY3VsYXJ7WH07CiNlbHNlCnZlYzQgdkxpZ2h0U3BlY3VsYXJ7WH09dmVjNCgwLik7CiNlbmRpZgojaWZkZWYgU0hBRE9Xe1h9CiNpZmRlZiBTSEFET1dDU017WH0KdW5pZm9ybSBtYXQ0IGxpZ2h0TWF0cml4e1h9W1NIQURPV0NTTU5VTV9DQVNDQURFU3tYfV07CnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHR7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdmFyeWluZyBmbG9hdCB2RGVwdGhNZXRyaWN7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdmFyeWluZyB2ZWM0IHZQb3NpdGlvbkZyb21DYW1lcmF7WH07CiNlbGlmIGRlZmluZWQoU0hBRE9XQ1VCRXtYfSkKI2Vsc2UKdmFyeWluZyB2ZWM0IHZQb3NpdGlvbkZyb21MaWdodHtYfTsKdmFyeWluZyBmbG9hdCB2RGVwdGhNZXRyaWN7WH07CnVuaWZvcm0gbWF0NCBsaWdodE1hdHJpeHtYfTsKI2VuZGlmCnVuaWZvcm0gdmVjNCBzaGFkb3dzSW5mb3tYfTsKdW5pZm9ybSB2ZWMyIGRlcHRoVmFsdWVze1h9OwojZW5kaWYKI2lmZGVmIFNQT1RMSUdIVHtYfQp1bmlmb3JtIHZlYzQgdkxpZ2h0RGlyZWN0aW9ue1h9Owp1bmlmb3JtIHZlYzQgdkxpZ2h0RmFsbG9mZntYfTsKI2VsaWYgZGVmaW5lZChQT0lOVExJR0hUe1h9KQp1bmlmb3JtIHZlYzQgdkxpZ2h0RmFsbG9mZntYfTsKI2VsaWYgZGVmaW5lZChIRU1JTElHSFR7WH0pCnVuaWZvcm0gdmVjMyB2TGlnaHRHcm91bmR7WH07CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW0hoXT1LaDtjb25zdCBZaD0ibGlnaHRWeFVib0RlY2xhcmF0aW9uIixaaD1gI2lmZGVmIExJR0hUe1h9CnVuaWZvcm0gTGlnaHR7WH0Kewp2ZWM0IHZMaWdodERhdGE7CnZlYzQgdkxpZ2h0RGlmZnVzZTsKdmVjNCB2TGlnaHRTcGVjdWxhcjsKI2lmZGVmIFNQT1RMSUdIVHtYfQp2ZWM0IHZMaWdodERpcmVjdGlvbjsKdmVjNCB2TGlnaHRGYWxsb2ZmOwojZWxpZiBkZWZpbmVkKFBPSU5UTElHSFR7WH0pCnZlYzQgdkxpZ2h0RmFsbG9mZjsKI2VsaWYgZGVmaW5lZChIRU1JTElHSFR7WH0pCnZlYzMgdkxpZ2h0R3JvdW5kOwojZW5kaWYKdmVjNCBzaGFkb3dzSW5mbzsKdmVjMiBkZXB0aFZhbHVlczsKfSBsaWdodHtYfTsKI2lmZGVmIFNIQURPV3tYfQojaWZkZWYgU0hBRE9XQ1NNe1h9CnVuaWZvcm0gbWF0NCBsaWdodE1hdHJpeHtYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp2YXJ5aW5nIHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W1NIQURPV0NTTU5VTV9DQVNDQURFU3tYfV07CnZhcnlpbmcgZmxvYXQgdkRlcHRoTWV0cmlje1h9W1NIQURPV0NTTU5VTV9DQVNDQURFU3tYfV07CnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tQ2FtZXJhe1h9OwojZWxpZiBkZWZpbmVkKFNIQURPV0NVQkV7WH0pCiNlbHNlCnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHR7WH07CnZhcnlpbmcgZmxvYXQgdkRlcHRoTWV0cmlje1h9Owp1bmlmb3JtIG1hdDQgbGlnaHRNYXRyaXh7WH07CiNlbmRpZgojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtZaF09Wmg7Y29uc3QgcWg9InByZVBhc3NWZXJ0ZXgiLGpoPWAjaWZkZWYgUFJFUEFTU19ERVBUSAp2Vmlld1Bvcz0odmlldyp3b3JsZFBvcykucmdiOwojZW5kaWYKI2lmIGRlZmluZWQoUFJFUEFTU19WRUxPQ0lUWSkgJiYgZGVmaW5lZChCT05FU19WRUxPQ0lUWV9FTkFCTEVEKQp2Q3VycmVudFBvc2l0aW9uPXZpZXdQcm9qZWN0aW9uKndvcmxkUG9zOwojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MAptYXQ0IHByZXZpb3VzSW5mbHVlbmNlOwpwcmV2aW91c0luZmx1ZW5jZT1tUHJldmlvdXNCb25lc1tpbnQobWF0cmljZXNJbmRpY2VzWzBdKV0qbWF0cmljZXNXZWlnaHRzWzBdOwojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MQpwcmV2aW91c0luZmx1ZW5jZSs9bVByZXZpb3VzQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc1sxXSldKm1hdHJpY2VzV2VpZ2h0c1sxXTsKI2VuZGlmIAojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MgpwcmV2aW91c0luZmx1ZW5jZSs9bVByZXZpb3VzQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc1syXSldKm1hdHJpY2VzV2VpZ2h0c1syXTsKI2VuZGlmIAojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MwpwcmV2aW91c0luZmx1ZW5jZSs9bVByZXZpb3VzQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc1szXSldKm1hdHJpY2VzV2VpZ2h0c1szXTsKI2VuZGlmCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz40CnByZXZpb3VzSW5mbHVlbmNlKz1tUHJldmlvdXNCb25lc1tpbnQobWF0cmljZXNJbmRpY2VzRXh0cmFbMF0pXSptYXRyaWNlc1dlaWdodHNFeHRyYVswXTsKI2VuZGlmIAojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NQpwcmV2aW91c0luZmx1ZW5jZSs9bVByZXZpb3VzQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc0V4dHJhWzFdKV0qbWF0cmljZXNXZWlnaHRzRXh0cmFbMV07CiNlbmRpZiAKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjYKcHJldmlvdXNJbmZsdWVuY2UrPW1QcmV2aW91c0JvbmVzW2ludChtYXRyaWNlc0luZGljZXNFeHRyYVsyXSldKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzJdOwojZW5kaWYgCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz43CnByZXZpb3VzSW5mbHVlbmNlKz1tUHJldmlvdXNCb25lc1tpbnQobWF0cmljZXNJbmRpY2VzRXh0cmFbM10pXSptYXRyaWNlc1dlaWdodHNFeHRyYVszXTsKI2VuZGlmCnZQcmV2aW91c1Bvc2l0aW9uPXByZXZpb3VzVmlld1Byb2plY3Rpb24qZmluYWxQcmV2aW91c1dvcmxkKnByZXZpb3VzSW5mbHVlbmNlKnZlYzQocG9zaXRpb25VcGRhdGVkLDEuMCk7CiNlbHNlCnZQcmV2aW91c1Bvc2l0aW9uPXByZXZpb3VzVmlld1Byb2plY3Rpb24qZmluYWxQcmV2aW91c1dvcmxkKnZlYzQocG9zaXRpb25VcGRhdGVkLDEuMCk7CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3FoXT1qaDtjb25zdCAkaD0idXZWYXJpYWJsZURlY2xhcmF0aW9uIixRaD1gI2lmICFkZWZpbmVkKFVWe1h9KSAmJiBkZWZpbmVkKE1BSU5VVntYfSkKdmVjMiB1dntYfT12ZWMyKDAuLDAuKTsKI2VuZGlmCiNpZmRlZiBNQUlOVVZ7WH0Kdk1haW5VVntYfT11dntYfTsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVskaF09UWg7Y29uc3QgSmg9InNhbXBsZXJWZXJ0ZXhJbXBsZW1lbnRhdGlvbiIsZWw9YCNpZiBkZWZpbmVkKF9ERUZJTkVOQU1FXykgJiYgX0RFRklORU5BTUVfRElSRUNUVVY9PTAKaWYgKHZfSU5GT05BTUVfPT0wLikKewp2X1ZBUllJTkdOQU1FX1VWPXZlYzIoX01BVFJJWE5BTUVfTWF0cml4KnZlYzQodXZVcGRhdGVkLDEuMCwwLjApKTsKfQojaWZkZWYgVVYyCmVsc2UgaWYgKHZfSU5GT05BTUVfPT0xLikKewp2X1ZBUllJTkdOQU1FX1VWPXZlYzIoX01BVFJJWE5BTUVfTWF0cml4KnZlYzQodXYyLDEuMCwwLjApKTsKfQojZW5kaWYKI2lmZGVmIFVWMwplbHNlIGlmICh2X0lORk9OQU1FXz09Mi4pCnsKdl9WQVJZSU5HTkFNRV9VVj12ZWMyKF9NQVRSSVhOQU1FX01hdHJpeCp2ZWM0KHV2MywxLjAsMC4wKSk7Cn0KI2VuZGlmCiNpZmRlZiBVVjQKZWxzZSBpZiAodl9JTkZPTkFNRV89PTMuKQp7CnZfVkFSWUlOR05BTUVfVVY9dmVjMihfTUFUUklYTkFNRV9NYXRyaXgqdmVjNCh1djQsMS4wLDAuMCkpOwp9CiNlbmRpZgojaWZkZWYgVVY1CmVsc2UgaWYgKHZfSU5GT05BTUVfPT00LikKewp2X1ZBUllJTkdOQU1FX1VWPXZlYzIoX01BVFJJWE5BTUVfTWF0cml4KnZlYzQodXY1LDEuMCwwLjApKTsKfQojZW5kaWYKI2lmZGVmIFVWNgplbHNlIGlmICh2X0lORk9OQU1FXz09NS4pCnsKdl9WQVJZSU5HTkFNRV9VVj12ZWMyKF9NQVRSSVhOQU1FX01hdHJpeCp2ZWM0KHV2NiwxLjAsMC4wKSk7Cn0KI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbSmhdPWVsO2NvbnN0IHRsPSJidW1wVmVydGV4IixpbD1gI2lmIGRlZmluZWQoQlVNUCkgfHwgZGVmaW5lZChQQVJBTExBWCkgfHwgZGVmaW5lZChDTEVBUkNPQVRfQlVNUCkgfHwgZGVmaW5lZChBTklTT1RST1BJQykKI2lmIGRlZmluZWQoVEFOR0VOVCkgJiYgZGVmaW5lZChOT1JNQUwpCnZlYzMgdGJuTm9ybWFsPW5vcm1hbGl6ZShub3JtYWxVcGRhdGVkKTsKdmVjMyB0Ym5UYW5nZW50PW5vcm1hbGl6ZSh0YW5nZW50VXBkYXRlZC54eXopOwp2ZWMzIHRibkJpdGFuZ2VudD1jcm9zcyh0Ym5Ob3JtYWwsdGJuVGFuZ2VudCkqdGFuZ2VudFVwZGF0ZWQudzsKdlRCTj1tYXQzKGZpbmFsV29ybGQpKm1hdDModGJuVGFuZ2VudCx0Ym5CaXRhbmdlbnQsdGJuTm9ybWFsKTsKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbdGxdPWlsO2NvbnN0IHNsPSJmb2dWZXJ0ZXgiLHJsPWAjaWZkZWYgRk9HCnZGb2dEaXN0YW5jZT0odmlldyp3b3JsZFBvcykueHl6OwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3NsXT1ybDtjb25zdCBubD0ic2hhZG93c1ZlcnRleCIsYWw9YCNpZmRlZiBTSEFET1dTCiNpZiBkZWZpbmVkKFNIQURPV0NTTXtYfSkKdlBvc2l0aW9uRnJvbUNhbWVyYXtYfT12aWV3KndvcmxkUG9zOwpmb3IgKGludCBpPTA7IGk8U0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9OyBpKyspIHsKdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2ldPWxpZ2h0TWF0cml4e1h9W2ldKndvcmxkUG9zOwojaWZkZWYgVVNFX1JFVkVSU0VfREVQVEhCVUZGRVIKdkRlcHRoTWV0cmlje1h9W2ldPSgtdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2ldLnorbGlnaHR7WH0uZGVwdGhWYWx1ZXMueCkvbGlnaHR7WH0uZGVwdGhWYWx1ZXMueTsKI2Vsc2UKdkRlcHRoTWV0cmlje1h9W2ldPSh2UG9zaXRpb25Gcm9tTGlnaHR7WH1baV0ueitsaWdodHtYfS5kZXB0aFZhbHVlcy54KS9saWdodHtYfS5kZXB0aFZhbHVlcy55OwojZW5kaWYKfQojZWxpZiBkZWZpbmVkKFNIQURPV3tYfSkgJiYgIWRlZmluZWQoU0hBRE9XQ1VCRXtYfSkKdlBvc2l0aW9uRnJvbUxpZ2h0e1h9PWxpZ2h0TWF0cml4e1h9KndvcmxkUG9zOwojaWZkZWYgVVNFX1JFVkVSU0VfREVQVEhCVUZGRVIKdkRlcHRoTWV0cmlje1h9PSgtdlBvc2l0aW9uRnJvbUxpZ2h0e1h9LnorbGlnaHR7WH0uZGVwdGhWYWx1ZXMueCkvbGlnaHR7WH0uZGVwdGhWYWx1ZXMueTsKI2Vsc2UKdkRlcHRoTWV0cmlje1h9PSh2UG9zaXRpb25Gcm9tTGlnaHR7WH0ueitsaWdodHtYfS5kZXB0aFZhbHVlcy54KS9saWdodHtYfS5kZXB0aFZhbHVlcy55OwojZW5kaWYKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbbmxdPWFsO2NvbnN0IG9sPSJ2ZXJ0ZXhDb2xvck1peGluZyIsaGw9YCNpZiBkZWZpbmVkKFZFUlRFWENPTE9SKSB8fCBkZWZpbmVkKElOU1RBTkNFU0NPTE9SKSAmJiBkZWZpbmVkKElOU1RBTkNFUykKdkNvbG9yPXZlYzQoMS4wKTsKI2lmZGVmIFZFUlRFWENPTE9SCiNpZmRlZiBWRVJURVhBTFBIQQp2Q29sb3IqPWNvbG9yOwojZWxzZQp2Q29sb3IucmdiKj1jb2xvci5yZ2I7CiNlbmRpZgojZW5kaWYKI2lmZGVmIElOU1RBTkNFU0NPTE9SCnZDb2xvcio9aW5zdGFuY2VDb2xvcjsKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbb2xdPWhsO2NvbnN0IGxsPSJwb2ludENsb3VkVmVydGV4IixjbD1gI2lmIGRlZmluZWQoUE9JTlRTSVpFKSAmJiAhZGVmaW5lZChXRUJHUFUpCmdsX1BvaW50U2l6ZT1wb2ludFNpemU7CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbbGxdPWNsO2NvbnN0IHVsPSJsb2dEZXB0aFZlcnRleCIsZGw9YCNpZmRlZiBMT0dBUklUSE1JQ0RFUFRICnZGcmFnbWVudERlcHRoPTEuMCtnbF9Qb3NpdGlvbi53OwpnbF9Qb3NpdGlvbi56PWxvZzIobWF4KDAuMDAwMDAxLHZGcmFnbWVudERlcHRoKSkqbG9nYXJpdGhtaWNEZXB0aENvbnN0YW50OwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3VsXT1kbDtjb25zdCBmbD0iZGVmYXVsdFZlcnRleFNoYWRlciIsX2w9YCNpbmNsdWRlPF9fZGVjbF9fZGVmYXVsdFZlcnRleD4KI2RlZmluZSBDVVNUT01fVkVSVEVYX0JFR0lOCmF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uOwojaWZkZWYgTk9STUFMCmF0dHJpYnV0ZSB2ZWMzIG5vcm1hbDsKI2VuZGlmCiNpZmRlZiBUQU5HRU5UCmF0dHJpYnV0ZSB2ZWM0IHRhbmdlbnQ7CiNlbmRpZgojaWZkZWYgVVYxCmF0dHJpYnV0ZSB2ZWMyIHV2OwojZW5kaWYKI2luY2x1ZGU8dXZBdHRyaWJ1dGVEZWNsYXJhdGlvbj5bMi4uN10KI2lmZGVmIFZFUlRFWENPTE9SCmF0dHJpYnV0ZSB2ZWM0IGNvbG9yOwojZW5kaWYKI2luY2x1ZGU8aGVscGVyRnVuY3Rpb25zPgojaW5jbHVkZTxib25lc0RlY2xhcmF0aW9uPgojaW5jbHVkZTxiYWtlZFZlcnRleEFuaW1hdGlvbkRlY2xhcmF0aW9uPgojaW5jbHVkZTxpbnN0YW5jZXNEZWNsYXJhdGlvbj4KI2luY2x1ZGU8cHJlUGFzc1ZlcnRleERlY2xhcmF0aW9uPgojaW5jbHVkZTxtYWluVVZWYXJ5aW5nRGVjbGFyYXRpb24+WzEuLjddCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhEZWNsYXJhdGlvbj4oX0RFRklORU5BTUVfLERJRkZVU0UsX1ZBUllJTkdOQU1FXyxEaWZmdXNlKQojaW5jbHVkZTxzYW1wbGVyVmVydGV4RGVjbGFyYXRpb24+KF9ERUZJTkVOQU1FXyxERVRBSUwsX1ZBUllJTkdOQU1FXyxEZXRhaWwpCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhEZWNsYXJhdGlvbj4oX0RFRklORU5BTUVfLEFNQklFTlQsX1ZBUllJTkdOQU1FXyxBbWJpZW50KQojaW5jbHVkZTxzYW1wbGVyVmVydGV4RGVjbGFyYXRpb24+KF9ERUZJTkVOQU1FXyxPUEFDSVRZLF9WQVJZSU5HTkFNRV8sT3BhY2l0eSkKI2luY2x1ZGU8c2FtcGxlclZlcnRleERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sRU1JU1NJVkUsX1ZBUllJTkdOQU1FXyxFbWlzc2l2ZSkKI2luY2x1ZGU8c2FtcGxlclZlcnRleERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sTElHSFRNQVAsX1ZBUllJTkdOQU1FXyxMaWdodG1hcCkKI2lmIGRlZmluZWQoU1BFQ1VMQVJURVJNKQojaW5jbHVkZTxzYW1wbGVyVmVydGV4RGVjbGFyYXRpb24+KF9ERUZJTkVOQU1FXyxTUEVDVUxBUixfVkFSWUlOR05BTUVfLFNwZWN1bGFyKQojZW5kaWYKI2luY2x1ZGU8c2FtcGxlclZlcnRleERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sQlVNUCxfVkFSWUlOR05BTUVfLEJ1bXApCnZhcnlpbmcgdmVjMyB2UG9zaXRpb25XOwojaWZkZWYgTk9STUFMCnZhcnlpbmcgdmVjMyB2Tm9ybWFsVzsKI2VuZGlmCiNpZiBkZWZpbmVkKFZFUlRFWENPTE9SKSB8fCBkZWZpbmVkKElOU1RBTkNFU0NPTE9SKSAmJiBkZWZpbmVkKElOU1RBTkNFUykKdmFyeWluZyB2ZWM0IHZDb2xvcjsKI2VuZGlmCiNpbmNsdWRlPGJ1bXBWZXJ0ZXhEZWNsYXJhdGlvbj4KI2luY2x1ZGU8Y2xpcFBsYW5lVmVydGV4RGVjbGFyYXRpb24+CiNpbmNsdWRlPGZvZ1ZlcnRleERlY2xhcmF0aW9uPgojaW5jbHVkZTxfX2RlY2xfX2xpZ2h0VnhGcmFnbWVudD5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXQojaW5jbHVkZTxtb3JwaFRhcmdldHNWZXJ0ZXhHbG9iYWxEZWNsYXJhdGlvbj4KI2luY2x1ZGU8bW9ycGhUYXJnZXRzVmVydGV4RGVjbGFyYXRpb24+WzAuLm1heFNpbXVsdGFuZW91c01vcnBoVGFyZ2V0c10KI2lmZGVmIFJFRkxFQ1RJT05NQVBfU0tZQk9YCnZhcnlpbmcgdmVjMyB2UG9zaXRpb25VVlc7CiNlbmRpZgojaWYgZGVmaW5lZChSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRCkgfHwgZGVmaW5lZChSRUZMRUNUSU9OTUFQX01JUlJPUkVERVFVSVJFQ1RBTkdVTEFSX0ZJWEVEKQp2YXJ5aW5nIHZlYzMgdkRpcmVjdGlvblc7CiNlbmRpZgojaW5jbHVkZTxsb2dEZXB0aERlY2xhcmF0aW9uPgojZGVmaW5lIENVU1RPTV9WRVJURVhfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpIHsKI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fQkVHSU4KdmVjMyBwb3NpdGlvblVwZGF0ZWQ9cG9zaXRpb247CiNpZmRlZiBOT1JNQUwKdmVjMyBub3JtYWxVcGRhdGVkPW5vcm1hbDsKI2VuZGlmCiNpZmRlZiBUQU5HRU5UCnZlYzQgdGFuZ2VudFVwZGF0ZWQ9dGFuZ2VudDsKI2VuZGlmCiNpZmRlZiBVVjEKdmVjMiB1dlVwZGF0ZWQ9dXY7CiNlbmRpZgojaW5jbHVkZTxtb3JwaFRhcmdldHNWZXJ0ZXhHbG9iYWw+CiNpbmNsdWRlPG1vcnBoVGFyZ2V0c1ZlcnRleD5bMC4ubWF4U2ltdWx0YW5lb3VzTW9ycGhUYXJnZXRzXQojaWZkZWYgUkVGTEVDVElPTk1BUF9TS1lCT1gKdlBvc2l0aW9uVVZXPXBvc2l0aW9uVXBkYXRlZDsKI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX1ZFUlRFWF9VUERBVEVfUE9TSVRJT04KI2RlZmluZSBDVVNUT01fVkVSVEVYX1VQREFURV9OT1JNQUwKI2luY2x1ZGU8aW5zdGFuY2VzVmVydGV4PgojaWYgZGVmaW5lZChQUkVQQVNTKSAmJiBkZWZpbmVkKFBSRVBBU1NfVkVMT0NJVFkpICYmICFkZWZpbmVkKEJPTkVTX1ZFTE9DSVRZX0VOQUJMRUQpCnZDdXJyZW50UG9zaXRpb249dmlld1Byb2plY3Rpb24qZmluYWxXb3JsZCp2ZWM0KHBvc2l0aW9uVXBkYXRlZCwxLjApOwp2UHJldmlvdXNQb3NpdGlvbj1wcmV2aW91c1ZpZXdQcm9qZWN0aW9uKmZpbmFsUHJldmlvdXNXb3JsZCp2ZWM0KHBvc2l0aW9uVXBkYXRlZCwxLjApOwojZW5kaWYKI2luY2x1ZGU8Ym9uZXNWZXJ0ZXg+CiNpbmNsdWRlPGJha2VkVmVydGV4QW5pbWF0aW9uPgp2ZWM0IHdvcmxkUG9zPWZpbmFsV29ybGQqdmVjNChwb3NpdGlvblVwZGF0ZWQsMS4wKTsKI2lmZGVmIE5PUk1BTAptYXQzIG5vcm1hbFdvcmxkPW1hdDMoZmluYWxXb3JsZCk7CiNpZiBkZWZpbmVkKElOU1RBTkNFUykgJiYgZGVmaW5lZChUSElOX0lOU1RBTkNFUykKdk5vcm1hbFc9bm9ybWFsVXBkYXRlZC92ZWMzKGRvdChub3JtYWxXb3JsZFswXSxub3JtYWxXb3JsZFswXSksZG90KG5vcm1hbFdvcmxkWzFdLG5vcm1hbFdvcmxkWzFdKSxkb3Qobm9ybWFsV29ybGRbMl0sbm9ybWFsV29ybGRbMl0pKTsKdk5vcm1hbFc9bm9ybWFsaXplKG5vcm1hbFdvcmxkKnZOb3JtYWxXKTsKI2Vsc2UKI2lmZGVmIE5PTlVOSUZPUk1TQ0FMSU5HCm5vcm1hbFdvcmxkPXRyYW5zcG9zZU1hdDMoaW52ZXJzZU1hdDMobm9ybWFsV29ybGQpKTsKI2VuZGlmCnZOb3JtYWxXPW5vcm1hbGl6ZShub3JtYWxXb3JsZCpub3JtYWxVcGRhdGVkKTsKI2VuZGlmCiNlbmRpZgojZGVmaW5lIENVU1RPTV9WRVJURVhfVVBEQVRFX1dPUkxEUE9TCiNpZmRlZiBNVUxUSVZJRVcKaWYgKGdsX1ZpZXdJRF9PVlI9PTB1KSB7CmdsX1Bvc2l0aW9uPXZpZXdQcm9qZWN0aW9uKndvcmxkUG9zOwp9IGVsc2UgewpnbF9Qb3NpdGlvbj12aWV3UHJvamVjdGlvblIqd29ybGRQb3M7Cn0KI2Vsc2UKZ2xfUG9zaXRpb249dmlld1Byb2plY3Rpb24qd29ybGRQb3M7CiNlbmRpZgp2UG9zaXRpb25XPXZlYzMod29ybGRQb3MpOwojaW5jbHVkZTxwcmVQYXNzVmVydGV4PgojaWYgZGVmaW5lZChSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRCkgfHwgZGVmaW5lZChSRUZMRUNUSU9OTUFQX01JUlJPUkVERVFVSVJFQ1RBTkdVTEFSX0ZJWEVEKQp2RGlyZWN0aW9uVz1ub3JtYWxpemUodmVjMyhmaW5hbFdvcmxkKnZlYzQocG9zaXRpb25VcGRhdGVkLDAuMCkpKTsKI2VuZGlmCiNpZm5kZWYgVVYxCnZlYzIgdXZVcGRhdGVkPXZlYzIoMC4sMC4pOwojZW5kaWYKI2lmZGVmIE1BSU5VVjEKdk1haW5VVjE9dXZVcGRhdGVkOwojZW5kaWYKI2luY2x1ZGU8dXZWYXJpYWJsZURlY2xhcmF0aW9uPlsyLi43XQojaW5jbHVkZTxzYW1wbGVyVmVydGV4SW1wbGVtZW50YXRpb24+KF9ERUZJTkVOQU1FXyxESUZGVVNFLF9WQVJZSU5HTkFNRV8sRGlmZnVzZSxfTUFUUklYTkFNRV8sZGlmZnVzZSxfSU5GT05BTUVfLERpZmZ1c2VJbmZvcy54KQojaW5jbHVkZTxzYW1wbGVyVmVydGV4SW1wbGVtZW50YXRpb24+KF9ERUZJTkVOQU1FXyxERVRBSUwsX1ZBUllJTkdOQU1FXyxEZXRhaWwsX01BVFJJWE5BTUVfLGRldGFpbCxfSU5GT05BTUVfLERldGFpbEluZm9zLngpCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhJbXBsZW1lbnRhdGlvbj4oX0RFRklORU5BTUVfLEFNQklFTlQsX1ZBUllJTkdOQU1FXyxBbWJpZW50LF9NQVRSSVhOQU1FXyxhbWJpZW50LF9JTkZPTkFNRV8sQW1iaWVudEluZm9zLngpCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhJbXBsZW1lbnRhdGlvbj4oX0RFRklORU5BTUVfLE9QQUNJVFksX1ZBUllJTkdOQU1FXyxPcGFjaXR5LF9NQVRSSVhOQU1FXyxvcGFjaXR5LF9JTkZPTkFNRV8sT3BhY2l0eUluZm9zLngpCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhJbXBsZW1lbnRhdGlvbj4oX0RFRklORU5BTUVfLEVNSVNTSVZFLF9WQVJZSU5HTkFNRV8sRW1pc3NpdmUsX01BVFJJWE5BTUVfLGVtaXNzaXZlLF9JTkZPTkFNRV8sRW1pc3NpdmVJbmZvcy54KQojaW5jbHVkZTxzYW1wbGVyVmVydGV4SW1wbGVtZW50YXRpb24+KF9ERUZJTkVOQU1FXyxMSUdIVE1BUCxfVkFSWUlOR05BTUVfLExpZ2h0bWFwLF9NQVRSSVhOQU1FXyxsaWdodG1hcCxfSU5GT05BTUVfLExpZ2h0bWFwSW5mb3MueCkKI2lmIGRlZmluZWQoU1BFQ1VMQVJURVJNKQojaW5jbHVkZTxzYW1wbGVyVmVydGV4SW1wbGVtZW50YXRpb24+KF9ERUZJTkVOQU1FXyxTUEVDVUxBUixfVkFSWUlOR05BTUVfLFNwZWN1bGFyLF9NQVRSSVhOQU1FXyxzcGVjdWxhcixfSU5GT05BTUVfLFNwZWN1bGFySW5mb3MueCkKI2VuZGlmCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhJbXBsZW1lbnRhdGlvbj4oX0RFRklORU5BTUVfLEJVTVAsX1ZBUllJTkdOQU1FXyxCdW1wLF9NQVRSSVhOQU1FXyxidW1wLF9JTkZPTkFNRV8sQnVtcEluZm9zLngpCiNpbmNsdWRlPGJ1bXBWZXJ0ZXg+CiNpbmNsdWRlPGNsaXBQbGFuZVZlcnRleD4KI2luY2x1ZGU8Zm9nVmVydGV4PgojaW5jbHVkZTxzaGFkb3dzVmVydGV4PlswLi5tYXhTaW11bHRhbmVvdXNMaWdodHNdCiNpbmNsdWRlPHZlcnRleENvbG9yTWl4aW5nPgojaW5jbHVkZTxwb2ludENsb3VkVmVydGV4PgojaW5jbHVkZTxsb2dEZXB0aFZlcnRleD4KI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fRU5ECn0KYDtVLlNoYWRlcnNTdG9yZVtmbF09X2w7Y29uc3QgZ2w9bmV3IFJlZ0V4cCgiXihbZ2ltdXNdKykhIik7Y2xhc3MgZWl7Y29uc3RydWN0b3IoZSl7dGhpcy5fcGx1Z2lucz1bXSx0aGlzLl9hY3RpdmVQbHVnaW5zPVtdLHRoaXMuX2FjdGl2ZVBsdWdpbnNGb3JFeHRyYUV2ZW50cz1bXSx0aGlzLl9tYXRlcmlhbD1lLHRoaXMuX3NjZW5lPWUuZ2V0U2NlbmUoKSx0aGlzLl9lbmdpbmU9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCl9X2FkZFBsdWdpbihlKXtmb3IobGV0IHM9MDtzPHRoaXMuX3BsdWdpbnMubGVuZ3RoOysrcylpZih0aGlzLl9wbHVnaW5zW3NdLm5hbWU9PT1lLm5hbWUpdGhyb3dgUGx1Z2luICIke2UubmFtZX0iIGFscmVhZHkgYWRkZWQgdG8gdGhlIG1hdGVyaWFsICIke3RoaXMuX21hdGVyaWFsLm5hbWV9IiFgO2lmKHRoaXMuX21hdGVyaWFsLl91bmlmb3JtQnVmZmVyTGF5b3V0QnVpbHQpdGhyb3dgVGhlIHBsdWdpbiAiJHtlLm5hbWV9IiBjYW4ndCBiZSBhZGRlZCB0byB0aGUgbWF0ZXJpYWwgIiR7dGhpcy5fbWF0ZXJpYWwubmFtZX0iIGJlY2F1c2UgdGhpcyBtYXRlcmlhbCBoYXMgYWxyZWFkeSBiZWVuIHVzZWQgZm9yIHJlbmRlcmluZyEgUGxlYXNlIGFkZCBwbHVnaW5zIHRvIG1hdGVyaWFscyBiZWZvcmUgYW55IHJlbmRlcmluZyB3aXRoIHRoaXMgbWF0ZXJpYWwgb2NjdXJzLmA7Y29uc3QgdD1lLmdldENsYXNzTmFtZSgpO2VpLl9NYXRlcmlhbFBsdWdpbkNsYXNzVG9NYWluRGVmaW5lW3RdfHwoZWkuX01hdGVyaWFsUGx1Z2luQ2xhc3NUb01haW5EZWZpbmVbdF09Ik1BVEVSSUFMUExVR0lOXyIrICsrZWkuX01hdGVyaWFsUGx1Z2luQ291bnRlciksdGhpcy5fbWF0ZXJpYWwuX2NhbGxiYWNrUGx1Z2luRXZlbnRHZW5lcmljPXRoaXMuX2hhbmRsZVBsdWdpbkV2ZW50LmJpbmQodGhpcyksdGhpcy5fcGx1Z2lucy5wdXNoKGUpLHRoaXMuX3BsdWdpbnMuc29ydCgocyxyKT0+cy5wcmlvcml0eS1yLnByaW9yaXR5KSx0aGlzLl9jb2RlSW5qZWN0aW9uUG9pbnRzPXt9O2NvbnN0IGk9e307aVtlaS5fTWF0ZXJpYWxQbHVnaW5DbGFzc1RvTWFpbkRlZmluZVt0XV09e3R5cGU6ImJvb2xlYW4iLGRlZmF1bHQ6ITB9O2Zvcihjb25zdCBzIG9mIHRoaXMuX3BsdWdpbnMpcy5jb2xsZWN0RGVmaW5lcyhpKSx0aGlzLl9jb2xsZWN0UG9pbnROYW1lcygidmVydGV4IixzLmdldEN1c3RvbUNvZGUoInZlcnRleCIpKSx0aGlzLl9jb2xsZWN0UG9pbnROYW1lcygiZnJhZ21lbnQiLHMuZ2V0Q3VzdG9tQ29kZSgiZnJhZ21lbnQiKSk7dGhpcy5fZGVmaW5lTmFtZXNGcm9tUGx1Z2lucz1pfV9hY3RpdmF0ZVBsdWdpbihlKXt0aGlzLl9hY3RpdmVQbHVnaW5zLmluZGV4T2YoZSk9PT0tMSYmKHRoaXMuX2FjdGl2ZVBsdWdpbnMucHVzaChlKSx0aGlzLl9hY3RpdmVQbHVnaW5zLnNvcnQoKHQsaSk9PnQucHJpb3JpdHktaS5wcmlvcml0eSksdGhpcy5fbWF0ZXJpYWwuX2NhbGxiYWNrUGx1Z2luRXZlbnRJc1JlYWR5Rm9yU3ViTWVzaD10aGlzLl9oYW5kbGVQbHVnaW5FdmVudElzUmVhZHlGb3JTdWJNZXNoLmJpbmQodGhpcyksdGhpcy5fbWF0ZXJpYWwuX2NhbGxiYWNrUGx1Z2luRXZlbnRQcmVwYXJlRGVmaW5lc0JlZm9yZUF0dHJpYnV0ZXM9dGhpcy5faGFuZGxlUGx1Z2luRXZlbnRQcmVwYXJlRGVmaW5lc0JlZm9yZUF0dHJpYnV0ZXMuYmluZCh0aGlzKSx0aGlzLl9tYXRlcmlhbC5fY2FsbGJhY2tQbHVnaW5FdmVudFByZXBhcmVEZWZpbmVzPXRoaXMuX2hhbmRsZVBsdWdpbkV2ZW50UHJlcGFyZURlZmluZXMuYmluZCh0aGlzKSx0aGlzLl9tYXRlcmlhbC5fY2FsbGJhY2tQbHVnaW5FdmVudEJpbmRGb3JTdWJNZXNoPXRoaXMuX2hhbmRsZVBsdWdpbkV2ZW50QmluZEZvclN1Yk1lc2guYmluZCh0aGlzKSxlLnJlZ2lzdGVyRm9yRXh0cmFFdmVudHMmJih0aGlzLl9hY3RpdmVQbHVnaW5zRm9yRXh0cmFFdmVudHMucHVzaChlKSx0aGlzLl9hY3RpdmVQbHVnaW5zRm9yRXh0cmFFdmVudHMuc29ydCgodCxpKT0+dC5wcmlvcml0eS1pLnByaW9yaXR5KSx0aGlzLl9tYXRlcmlhbC5fY2FsbGJhY2tQbHVnaW5FdmVudEhhc1JlbmRlclRhcmdldFRleHR1cmVzPXRoaXMuX2hhbmRsZVBsdWdpbkV2ZW50SGFzUmVuZGVyVGFyZ2V0VGV4dHVyZXMuYmluZCh0aGlzKSx0aGlzLl9tYXRlcmlhbC5fY2FsbGJhY2tQbHVnaW5FdmVudEZpbGxSZW5kZXJUYXJnZXRUZXh0dXJlcz10aGlzLl9oYW5kbGVQbHVnaW5FdmVudEZpbGxSZW5kZXJUYXJnZXRUZXh0dXJlcy5iaW5kKHRoaXMpLHRoaXMuX21hdGVyaWFsLl9jYWxsYmFja1BsdWdpbkV2ZW50SGFyZEJpbmRGb3JTdWJNZXNoPXRoaXMuX2hhbmRsZVBsdWdpbkV2ZW50SGFyZEJpbmRGb3JTdWJNZXNoLmJpbmQodGhpcykpKX1nZXRQbHVnaW4oZSl7Zm9yKGxldCB0PTA7dDx0aGlzLl9wbHVnaW5zLmxlbmd0aDsrK3QpaWYodGhpcy5fcGx1Z2luc1t0XS5uYW1lPT09ZSlyZXR1cm4gdGhpcy5fcGx1Z2luc1t0XTtyZXR1cm4gbnVsbH1faGFuZGxlUGx1Z2luRXZlbnRJc1JlYWR5Rm9yU3ViTWVzaChlKXtsZXQgdD0hMDtmb3IoY29uc3QgaSBvZiB0aGlzLl9hY3RpdmVQbHVnaW5zKXQ9dCYmaS5pc1JlYWR5Rm9yU3ViTWVzaChlLmRlZmluZXMsdGhpcy5fc2NlbmUsdGhpcy5fZW5naW5lLGUuc3ViTWVzaCk7ZS5pc1JlYWR5Rm9yU3ViTWVzaD10fV9oYW5kbGVQbHVnaW5FdmVudFByZXBhcmVEZWZpbmVzQmVmb3JlQXR0cmlidXRlcyhlKXtmb3IoY29uc3QgdCBvZiB0aGlzLl9hY3RpdmVQbHVnaW5zKXQucHJlcGFyZURlZmluZXNCZWZvcmVBdHRyaWJ1dGVzKGUuZGVmaW5lcyx0aGlzLl9zY2VuZSxlLm1lc2gpfV9oYW5kbGVQbHVnaW5FdmVudFByZXBhcmVEZWZpbmVzKGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuX2FjdGl2ZVBsdWdpbnMpdC5wcmVwYXJlRGVmaW5lcyhlLmRlZmluZXMsdGhpcy5fc2NlbmUsZS5tZXNoKX1faGFuZGxlUGx1Z2luRXZlbnRIYXJkQmluZEZvclN1Yk1lc2goZSl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fYWN0aXZlUGx1Z2luc0ZvckV4dHJhRXZlbnRzKXQuaGFyZEJpbmRGb3JTdWJNZXNoKHRoaXMuX21hdGVyaWFsLl91bmlmb3JtQnVmZmVyLHRoaXMuX3NjZW5lLHRoaXMuX2VuZ2luZSxlLnN1Yk1lc2gpfV9oYW5kbGVQbHVnaW5FdmVudEJpbmRGb3JTdWJNZXNoKGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuX2FjdGl2ZVBsdWdpbnMpdC5iaW5kRm9yU3ViTWVzaCh0aGlzLl9tYXRlcmlhbC5fdW5pZm9ybUJ1ZmZlcix0aGlzLl9zY2VuZSx0aGlzLl9lbmdpbmUsZS5zdWJNZXNoKX1faGFuZGxlUGx1Z2luRXZlbnRIYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyhlKXtsZXQgdD0hMTtmb3IoY29uc3QgaSBvZiB0aGlzLl9hY3RpdmVQbHVnaW5zRm9yRXh0cmFFdmVudHMpaWYodD1pLmhhc1JlbmRlclRhcmdldFRleHR1cmVzKCksdClicmVhaztlLmhhc1JlbmRlclRhcmdldFRleHR1cmVzPXR9X2hhbmRsZVBsdWdpbkV2ZW50RmlsbFJlbmRlclRhcmdldFRleHR1cmVzKGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuX2FjdGl2ZVBsdWdpbnNGb3JFeHRyYUV2ZW50cyl0LmZpbGxSZW5kZXJUYXJnZXRUZXh0dXJlcyhlLnJlbmRlclRhcmdldHMpfV9oYW5kbGVQbHVnaW5FdmVudChlLHQpe3N3aXRjaChlKXtjYXNlIFFlLkdldEFjdGl2ZVRleHR1cmVzOntjb25zdCBpPXQ7Zm9yKGNvbnN0IHMgb2YgdGhpcy5fYWN0aXZlUGx1Z2lucylzLmdldEFjdGl2ZVRleHR1cmVzKGkuYWN0aXZlVGV4dHVyZXMpO2JyZWFrfWNhc2UgUWUuR2V0QW5pbWF0YWJsZXM6e2NvbnN0IGk9dDtmb3IoY29uc3QgcyBvZiB0aGlzLl9hY3RpdmVQbHVnaW5zKXMuZ2V0QW5pbWF0YWJsZXMoaS5hbmltYXRhYmxlcyk7YnJlYWt9Y2FzZSBRZS5IYXNUZXh0dXJlOntjb25zdCBpPXQ7bGV0IHM9ITE7Zm9yKGNvbnN0IHIgb2YgdGhpcy5fYWN0aXZlUGx1Z2lucylpZihzPXIuaGFzVGV4dHVyZShpLnRleHR1cmUpLHMpYnJlYWs7aS5oYXNUZXh0dXJlPXM7YnJlYWt9Y2FzZSBRZS5EaXNwb3NlZDp7Y29uc3QgaT10O2Zvcihjb25zdCBzIG9mIHRoaXMuX3BsdWdpbnMpcy5kaXNwb3NlKGkuZm9yY2VEaXNwb3NlVGV4dHVyZXMpO2JyZWFrfWNhc2UgUWUuR2V0RGVmaW5lTmFtZXM6e2NvbnN0IGk9dDtpLmRlZmluZU5hbWVzPXRoaXMuX2RlZmluZU5hbWVzRnJvbVBsdWdpbnM7YnJlYWt9Y2FzZSBRZS5QcmVwYXJlRWZmZWN0Ontjb25zdCBpPXQ7Zm9yKGNvbnN0IHMgb2YgdGhpcy5fYWN0aXZlUGx1Z2lucylpLmZhbGxiYWNrUmFuaz1zLmFkZEZhbGxiYWNrcyhpLmRlZmluZXMsaS5mYWxsYmFja3MsaS5mYWxsYmFja1JhbmspLHMuZ2V0QXR0cmlidXRlcyhpLmF0dHJpYnV0ZXMsdGhpcy5fc2NlbmUsaS5tZXNoKTt0aGlzLl91bmlmb3JtTGlzdC5sZW5ndGg+MCYmaS51bmlmb3Jtcy5wdXNoKC4uLnRoaXMuX3VuaWZvcm1MaXN0KSx0aGlzLl9zYW1wbGVyTGlzdC5sZW5ndGg+MCYmaS5zYW1wbGVycy5wdXNoKC4uLnRoaXMuX3NhbXBsZXJMaXN0KSx0aGlzLl91Ym9MaXN0Lmxlbmd0aD4wJiZpLnVuaWZvcm1CdWZmZXJzTmFtZXMucHVzaCguLi50aGlzLl91Ym9MaXN0KSxpLmN1c3RvbUNvZGU9dGhpcy5faW5qZWN0Q3VzdG9tQ29kZShpLmN1c3RvbUNvZGUpO2JyZWFrfWNhc2UgUWUuUHJlcGFyZVVuaWZvcm1CdWZmZXI6e2NvbnN0IGk9dDt0aGlzLl91Ym9EZWNsYXJhdGlvbj0iIix0aGlzLl92ZXJ0ZXhEZWNsYXJhdGlvbj0iIix0aGlzLl9mcmFnbWVudERlY2xhcmF0aW9uPSIiLHRoaXMuX3VuaWZvcm1MaXN0PVtdLHRoaXMuX3NhbXBsZXJMaXN0PVtdLHRoaXMuX3Vib0xpc3Q9W107Zm9yKGNvbnN0IHMgb2YgdGhpcy5fcGx1Z2lucyl7Y29uc3Qgcj1zLmdldFVuaWZvcm1zKCk7aWYocil7aWYoci51Ym8pZm9yKGNvbnN0IG4gb2Ygci51Ym8paS51Ym8uYWRkVW5pZm9ybShuLm5hbWUsbi5zaXplKSx0aGlzLl91Ym9EZWNsYXJhdGlvbis9YCR7bi50eXBlfSAke24ubmFtZX07XHIKYCx0aGlzLl91bmlmb3JtTGlzdC5wdXNoKG4ubmFtZSk7ci52ZXJ0ZXgmJih0aGlzLl92ZXJ0ZXhEZWNsYXJhdGlvbis9ci52ZXJ0ZXgrYFxyCmApLHIuZnJhZ21lbnQmJih0aGlzLl9mcmFnbWVudERlY2xhcmF0aW9uKz1yLmZyYWdtZW50K2BccgpgKX1zLmdldFNhbXBsZXJzKHRoaXMuX3NhbXBsZXJMaXN0KSxzLmdldFVuaWZvcm1CdWZmZXJzTmFtZXModGhpcy5fdWJvTGlzdCl9YnJlYWt9fX1fY29sbGVjdFBvaW50TmFtZXMoZSx0KXtpZih0KWZvcihjb25zdCBpIGluIHQpdGhpcy5fY29kZUluamVjdGlvblBvaW50c1tlXXx8KHRoaXMuX2NvZGVJbmplY3Rpb25Qb2ludHNbZV09e30pLHRoaXMuX2NvZGVJbmplY3Rpb25Qb2ludHNbZV1baV09ITB9X2luamVjdEN1c3RvbUNvZGUoZSl7cmV0dXJuKHQsaSk9Pnt2YXIgcztlJiYoaT1lKHQsaSkpLHRoaXMuX3Vib0RlY2xhcmF0aW9uJiYoaT1pLnJlcGxhY2UoIiNkZWZpbmUgQURESVRJT05BTF9VQk9fREVDTEFSQVRJT04iLHRoaXMuX3Vib0RlY2xhcmF0aW9uKSksdGhpcy5fdmVydGV4RGVjbGFyYXRpb24mJihpPWkucmVwbGFjZSgiI2RlZmluZSBBRERJVElPTkFMX1ZFUlRFWF9ERUNMQVJBVElPTiIsdGhpcy5fdmVydGV4RGVjbGFyYXRpb24pKSx0aGlzLl9mcmFnbWVudERlY2xhcmF0aW9uJiYoaT1pLnJlcGxhY2UoIiNkZWZpbmUgQURESVRJT05BTF9GUkFHTUVOVF9ERUNMQVJBVElPTiIsdGhpcy5fZnJhZ21lbnREZWNsYXJhdGlvbikpO2NvbnN0IHI9KHM9dGhpcy5fY29kZUluamVjdGlvblBvaW50cyk9PT1udWxsfHxzPT09dm9pZCAwP3ZvaWQgMDpzW3RdO2lmKCFyKXJldHVybiBpO2ZvcihsZXQgbiBpbiByKXtsZXQgYT0iIjtmb3IoY29uc3QgbyBvZiB0aGlzLl9hY3RpdmVQbHVnaW5zKXtjb25zdCBoPW8uZ2V0Q3VzdG9tQ29kZSh0KTtoIT1udWxsJiZoW25dJiYoYSs9aFtuXStgXHIKYCl9aWYoYS5sZW5ndGg+MClpZihuLmNoYXJBdCgwKT09PSIhIil7bj1uLnN1YnN0cmluZygxKTtsZXQgbz0iZyI7aWYobi5jaGFyQXQoMCk9PT0iISIpbz0iIixuPW4uc3Vic3RyaW5nKDEpO2Vsc2V7Y29uc3QgZD1nbC5leGVjKG4pO2QmJmQubGVuZ3RoPj0yJiYobz1kWzFdLG49bi5zdWJzdHJpbmcoby5sZW5ndGgrMSkpfW8uaW5kZXhPZigiZyIpPDAmJihvKz0iZyIpO2NvbnN0IGg9aSxsPW5ldyBSZWdFeHAobixvKTtsZXQgdT1sLmV4ZWMoaCk7Zm9yKDt1IT09bnVsbDspe2xldCBkPWE7Zm9yKGxldCBmPTA7Zjx1Lmxlbmd0aDsrK2YpZD1kLnJlcGxhY2UoIiQiK2YsdVtmXSk7aT1pLnJlcGxhY2UodVswXSxkKSx1PWwuZXhlYyhoKX19ZWxzZXtjb25zdCBvPSIjZGVmaW5lICIrbjtpPWkucmVwbGFjZShvLGBccgpgK2ErYFxyCmArbyl9fXJldHVybiBpfX19ZWkuX01hdGVyaWFsUGx1Z2luQ2xhc3NUb01haW5EZWZpbmU9e30sZWkuX01hdGVyaWFsUGx1Z2luQ291bnRlcj0wO2NsYXNzIGhze2NvbnN0cnVjdG9yKGUsdCxpLHMscj0hMCxuPSExKXt0aGlzLnByaW9yaXR5PTUwMCx0aGlzLnJlZ2lzdGVyRm9yRXh0cmFFdmVudHM9ITEsdGhpcy5fbWF0ZXJpYWw9ZSx0aGlzLm5hbWU9dCx0aGlzLnByaW9yaXR5PWksZS5wbHVnaW5NYW5hZ2VyfHwoZS5wbHVnaW5NYW5hZ2VyPW5ldyBlaShlKSksdGhpcy5fcGx1Z2luRGVmaW5lTmFtZXM9cyx0aGlzLl9wbHVnaW5NYW5hZ2VyPWUucGx1Z2luTWFuYWdlcixyJiZ0aGlzLl9wbHVnaW5NYW5hZ2VyLl9hZGRQbHVnaW4odGhpcyksbiYmdGhpcy5fZW5hYmxlKCEwKSx0aGlzLm1hcmtBbGxEZWZpbmVzQXNEaXJ0eT1lLl9kaXJ0eUNhbGxiYWNrc1s2M119X2VuYWJsZShlKXtlJiZ0aGlzLl9wbHVnaW5NYW5hZ2VyLl9hY3RpdmF0ZVBsdWdpbih0aGlzKX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iTWF0ZXJpYWxQbHVnaW5CYXNlIn1pc1JlYWR5Rm9yU3ViTWVzaChlLHQsaSxzKXtyZXR1cm4hMH1oYXJkQmluZEZvclN1Yk1lc2goZSx0LGkscyl7fWJpbmRGb3JTdWJNZXNoKGUsdCxpLHMpe31kaXNwb3NlKGUpe31nZXRDdXN0b21Db2RlKGUpe3JldHVybiBudWxsfWNvbGxlY3REZWZpbmVzKGUpe2lmKHRoaXMuX3BsdWdpbkRlZmluZU5hbWVzKWZvcihjb25zdCB0IG9mIE9iamVjdC5rZXlzKHRoaXMuX3BsdWdpbkRlZmluZU5hbWVzKSl7aWYodFswXT09PSJfIiljb250aW51ZTtjb25zdCBpPXR5cGVvZiB0aGlzLl9wbHVnaW5EZWZpbmVOYW1lc1t0XTtlW3RdPXt0eXBlOmk9PT0ibnVtYmVyIj8ibnVtYmVyIjppPT09InN0cmluZyI/InN0cmluZyI6aT09PSJib29sZWFuIj8iYm9vbGVhbiI6Im9iamVjdCIsZGVmYXVsdDp0aGlzLl9wbHVnaW5EZWZpbmVOYW1lc1t0XX19fXByZXBhcmVEZWZpbmVzQmVmb3JlQXR0cmlidXRlcyhlLHQsaSl7fXByZXBhcmVEZWZpbmVzKGUsdCxpKXt9aGFzVGV4dHVyZShlKXtyZXR1cm4hMX1oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcygpe3JldHVybiExfWZpbGxSZW5kZXJUYXJnZXRUZXh0dXJlcyhlKXt9Z2V0QWN0aXZlVGV4dHVyZXMoZSl7fWdldEFuaW1hdGFibGVzKGUpe31hZGRGYWxsYmFja3MoZSx0LGkpe3JldHVybiBpfWdldFNhbXBsZXJzKGUpe31nZXRBdHRyaWJ1dGVzKGUsdCxpKXt9Z2V0VW5pZm9ybUJ1ZmZlcnNOYW1lcyhlKXt9Z2V0VW5pZm9ybXMoKXtyZXR1cm57fX1jb3B5VG8oZSl7YWUuQ2xvbmUoKCk9PmUsdGhpcyl9c2VyaWFsaXplKCl7cmV0dXJuIGFlLlNlcmlhbGl6ZSh0aGlzKX1wYXJzZShlLHQsaSl7YWUuUGFyc2UoKCk9PnRoaXMsZSx0LGkpfX1UKFtSKCldLGhzLnByb3RvdHlwZSwibmFtZSIsdm9pZCAwKSxUKFtSKCldLGhzLnByb3RvdHlwZSwicHJpb3JpdHkiLHZvaWQgMCksVChbUigpXSxocy5wcm90b3R5cGUsInJlZ2lzdGVyRm9yRXh0cmFFdmVudHMiLHZvaWQgMCk7Y2xhc3MgcGwgZXh0ZW5kcyB5c3tjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5ERVRBSUw9ITEsdGhpcy5ERVRBSUxESVJFQ1RVVj0wLHRoaXMuREVUQUlMX05PUk1BTEJMRU5ETUVUSE9EPTB9fWNsYXNzIHBpIGV4dGVuZHMgaHN7Y29uc3RydWN0b3IoZSx0PSEwKXtzdXBlcihlLCJEZXRhaWxNYXAiLDE0MCxuZXcgcGwsdCksdGhpcy5fdGV4dHVyZT1udWxsLHRoaXMuZGlmZnVzZUJsZW5kTGV2ZWw9MSx0aGlzLnJvdWdobmVzc0JsZW5kTGV2ZWw9MSx0aGlzLmJ1bXBMZXZlbD0xLHRoaXMuX25vcm1hbEJsZW5kTWV0aG9kPVAuTUFURVJJQUxfTk9STUFMQkxFTkRNRVRIT0RfV0hJVEVPVVQsdGhpcy5faXNFbmFibGVkPSExLHRoaXMuaXNFbmFibGVkPSExLHRoaXMuX2ludGVybmFsTWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eT1lLl9kaXJ0eUNhbGxiYWNrc1sxXX1fbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSgpe3RoaXMuX2VuYWJsZSh0aGlzLl9pc0VuYWJsZWQpLHRoaXMuX2ludGVybmFsTWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSgpfWlzUmVhZHlGb3JTdWJNZXNoKGUsdCxpKXtyZXR1cm4gdGhpcy5faXNFbmFibGVkPyEoZS5fYXJlVGV4dHVyZXNEaXJ0eSYmdC50ZXh0dXJlc0VuYWJsZWQmJmkuZ2V0Q2FwcygpLnN0YW5kYXJkRGVyaXZhdGl2ZXMmJnRoaXMuX3RleHR1cmUmJnVlLkRldGFpbFRleHR1cmVFbmFibGVkJiYhdGhpcy5fdGV4dHVyZS5pc1JlYWR5KCkpOiEwfXByZXBhcmVEZWZpbmVzKGUsdCl7aWYodGhpcy5faXNFbmFibGVkKXtlLkRFVEFJTF9OT1JNQUxCTEVORE1FVEhPRD10aGlzLl9ub3JtYWxCbGVuZE1ldGhvZDtjb25zdCBpPXQuZ2V0RW5naW5lKCk7ZS5fYXJlVGV4dHVyZXNEaXJ0eSYmKGkuZ2V0Q2FwcygpLnN0YW5kYXJkRGVyaXZhdGl2ZXMmJnRoaXMuX3RleHR1cmUmJnVlLkRldGFpbFRleHR1cmVFbmFibGVkJiZ0aGlzLl9pc0VuYWJsZWQ/KGllLlByZXBhcmVEZWZpbmVzRm9yTWVyZ2VkVVYodGhpcy5fdGV4dHVyZSxlLCJERVRBSUwiKSxlLkRFVEFJTF9OT1JNQUxCTEVORE1FVEhPRD10aGlzLl9ub3JtYWxCbGVuZE1ldGhvZCk6ZS5ERVRBSUw9ITEpfWVsc2UgZS5ERVRBSUw9ITF9YmluZEZvclN1Yk1lc2goZSx0KXtpZighdGhpcy5faXNFbmFibGVkKXJldHVybjtjb25zdCBpPXRoaXMuX21hdGVyaWFsLmlzRnJvemVuOyghZS51c2VVYm98fCFpfHwhZS5pc1N5bmMpJiZ0aGlzLl90ZXh0dXJlJiZ1ZS5EZXRhaWxUZXh0dXJlRW5hYmxlZCYmKGUudXBkYXRlRmxvYXQ0KCJ2RGV0YWlsSW5mb3MiLHRoaXMuX3RleHR1cmUuY29vcmRpbmF0ZXNJbmRleCx0aGlzLmRpZmZ1c2VCbGVuZExldmVsLHRoaXMuYnVtcExldmVsLHRoaXMucm91Z2huZXNzQmxlbmRMZXZlbCksaWUuQmluZFRleHR1cmVNYXRyaXgodGhpcy5fdGV4dHVyZSxlLCJkZXRhaWwiKSksdC50ZXh0dXJlc0VuYWJsZWQmJnRoaXMuX3RleHR1cmUmJnVlLkRldGFpbFRleHR1cmVFbmFibGVkJiZlLnNldFRleHR1cmUoImRldGFpbFNhbXBsZXIiLHRoaXMuX3RleHR1cmUpfWhhc1RleHR1cmUoZSl7cmV0dXJuIHRoaXMuX3RleHR1cmU9PT1lfWdldEFjdGl2ZVRleHR1cmVzKGUpe3RoaXMuX3RleHR1cmUmJmUucHVzaCh0aGlzLl90ZXh0dXJlKX1nZXRBbmltYXRhYmxlcyhlKXt0aGlzLl90ZXh0dXJlJiZ0aGlzLl90ZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMuX3RleHR1cmUuYW5pbWF0aW9ucy5sZW5ndGg+MCYmZS5wdXNoKHRoaXMuX3RleHR1cmUpfWRpc3Bvc2UoZSl7dmFyIHQ7ZSYmKCh0PXRoaXMuX3RleHR1cmUpPT09bnVsbHx8dD09PXZvaWQgMHx8dC5kaXNwb3NlKCkpfWdldENsYXNzTmFtZSgpe3JldHVybiJEZXRhaWxNYXBDb25maWd1cmF0aW9uIn1nZXRTYW1wbGVycyhlKXtlLnB1c2goImRldGFpbFNhbXBsZXIiKX1nZXRVbmlmb3Jtcygpe3JldHVybnt1Ym86W3tuYW1lOiJ2RGV0YWlsSW5mb3MiLHNpemU6NCx0eXBlOiJ2ZWM0In0se25hbWU6ImRldGFpbE1hdHJpeCIsc2l6ZToxNix0eXBlOiJtYXQ0In1dfX19VChbbXQoImRldGFpbFRleHR1cmUiKSxiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0scGkucHJvdG90eXBlLCJ0ZXh0dXJlIix2b2lkIDApLFQoW1IoKV0scGkucHJvdG90eXBlLCJkaWZmdXNlQmxlbmRMZXZlbCIsdm9pZCAwKSxUKFtSKCldLHBpLnByb3RvdHlwZSwicm91Z2huZXNzQmxlbmRMZXZlbCIsdm9pZCAwKSxUKFtSKCldLHBpLnByb3RvdHlwZSwiYnVtcExldmVsIix2b2lkIDApLFQoW1IoKSxiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0scGkucHJvdG90eXBlLCJub3JtYWxCbGVuZE1ldGhvZCIsdm9pZCAwKSxUKFtSKCksYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLHBpLnByb3RvdHlwZSwiaXNFbmFibGVkIix2b2lkIDApO2NvbnN0IEdzPXtlZmZlY3Q6bnVsbCxzdWJNZXNoOm51bGx9O2NsYXNzIG1sIGV4dGVuZHMgeXN7Y29uc3RydWN0b3IoZSl7c3VwZXIoZSksdGhpcy5NQUlOVVYxPSExLHRoaXMuTUFJTlVWMj0hMSx0aGlzLk1BSU5VVjM9ITEsdGhpcy5NQUlOVVY0PSExLHRoaXMuTUFJTlVWNT0hMSx0aGlzLk1BSU5VVjY9ITEsdGhpcy5ESUZGVVNFPSExLHRoaXMuRElGRlVTRURJUkVDVFVWPTAsdGhpcy5CQUtFRF9WRVJURVhfQU5JTUFUSU9OX1RFWFRVUkU9ITEsdGhpcy5BTUJJRU5UPSExLHRoaXMuQU1CSUVOVERJUkVDVFVWPTAsdGhpcy5PUEFDSVRZPSExLHRoaXMuT1BBQ0lUWURJUkVDVFVWPTAsdGhpcy5PUEFDSVRZUkdCPSExLHRoaXMuUkVGTEVDVElPTj0hMSx0aGlzLkVNSVNTSVZFPSExLHRoaXMuRU1JU1NJVkVESVJFQ1RVVj0wLHRoaXMuU1BFQ1VMQVI9ITEsdGhpcy5TUEVDVUxBUkRJUkVDVFVWPTAsdGhpcy5CVU1QPSExLHRoaXMuQlVNUERJUkVDVFVWPTAsdGhpcy5QQVJBTExBWD0hMSx0aGlzLlBBUkFMTEFYT0NDTFVTSU9OPSExLHRoaXMuU1BFQ1VMQVJPVkVSQUxQSEE9ITEsdGhpcy5DTElQUExBTkU9ITEsdGhpcy5DTElQUExBTkUyPSExLHRoaXMuQ0xJUFBMQU5FMz0hMSx0aGlzLkNMSVBQTEFORTQ9ITEsdGhpcy5DTElQUExBTkU1PSExLHRoaXMuQ0xJUFBMQU5FNj0hMSx0aGlzLkFMUEhBVEVTVD0hMSx0aGlzLkRFUFRIUFJFUEFTUz0hMSx0aGlzLkFMUEhBRlJPTURJRkZVU0U9ITEsdGhpcy5QT0lOVFNJWkU9ITEsdGhpcy5GT0c9ITEsdGhpcy5TUEVDVUxBUlRFUk09ITEsdGhpcy5ESUZGVVNFRlJFU05FTD0hMSx0aGlzLk9QQUNJVFlGUkVTTkVMPSExLHRoaXMuUkVGTEVDVElPTkZSRVNORUw9ITEsdGhpcy5SRUZSQUNUSU9ORlJFU05FTD0hMSx0aGlzLkVNSVNTSVZFRlJFU05FTD0hMSx0aGlzLkZSRVNORUw9ITEsdGhpcy5OT1JNQUw9ITEsdGhpcy5UQU5HRU5UPSExLHRoaXMuVVYxPSExLHRoaXMuVVYyPSExLHRoaXMuVVYzPSExLHRoaXMuVVY0PSExLHRoaXMuVVY1PSExLHRoaXMuVVY2PSExLHRoaXMuVkVSVEVYQ09MT1I9ITEsdGhpcy5WRVJURVhBTFBIQT0hMSx0aGlzLk5VTV9CT05FX0lORkxVRU5DRVJTPTAsdGhpcy5Cb25lc1Blck1lc2g9MCx0aGlzLkJPTkVURVhUVVJFPSExLHRoaXMuQk9ORVNfVkVMT0NJVFlfRU5BQkxFRD0hMSx0aGlzLklOU1RBTkNFUz0hMSx0aGlzLlRISU5fSU5TVEFOQ0VTPSExLHRoaXMuSU5TVEFOQ0VTQ09MT1I9ITEsdGhpcy5HTE9TU0lORVNTPSExLHRoaXMuUk9VR0hORVNTPSExLHRoaXMuRU1JU1NJVkVBU0lMTFVNSU5BVElPTj0hMSx0aGlzLkxJTktFTUlTU0lWRVdJVEhESUZGVVNFPSExLHRoaXMuUkVGTEVDVElPTkZSRVNORUxGUk9NU1BFQ1VMQVI9ITEsdGhpcy5MSUdIVE1BUD0hMSx0aGlzLkxJR0hUTUFQRElSRUNUVVY9MCx0aGlzLk9CSkVDVFNQQUNFX05PUk1BTE1BUD0hMSx0aGlzLlVTRUxJR0hUTUFQQVNTSEFET1dNQVA9ITEsdGhpcy5SRUZMRUNUSU9OTUFQXzNEPSExLHRoaXMuUkVGTEVDVElPTk1BUF9TUEhFUklDQUw9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX1BMQU5BUj0hMSx0aGlzLlJFRkxFQ1RJT05NQVBfQ1VCSUM9ITEsdGhpcy5VU0VfTE9DQUxfUkVGTEVDVElPTk1BUF9DVUJJQz0hMSx0aGlzLlVTRV9MT0NBTF9SRUZSQUNUSU9OTUFQX0NVQklDPSExLHRoaXMuUkVGTEVDVElPTk1BUF9QUk9KRUNUSU9OPSExLHRoaXMuUkVGTEVDVElPTk1BUF9TS1lCT1g9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX0VYUExJQ0lUPSExLHRoaXMuUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVI9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRD0hMSx0aGlzLlJFRkxFQ1RJT05NQVBfTUlSUk9SRURFUVVJUkVDVEFOR1VMQVJfRklYRUQ9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX09QUE9TSVRFWj0hMSx0aGlzLklOVkVSVENVQklDTUFQPSExLHRoaXMuTE9HQVJJVEhNSUNERVBUSD0hMSx0aGlzLlJFRlJBQ1RJT049ITEsdGhpcy5SRUZSQUNUSU9OTUFQXzNEPSExLHRoaXMuUkVGTEVDVElPTk9WRVJBTFBIQT0hMSx0aGlzLlRXT1NJREVETElHSFRJTkc9ITEsdGhpcy5TSEFET1dGTE9BVD0hMSx0aGlzLk1PUlBIVEFSR0VUUz0hMSx0aGlzLk1PUlBIVEFSR0VUU19OT1JNQUw9ITEsdGhpcy5NT1JQSFRBUkdFVFNfVEFOR0VOVD0hMSx0aGlzLk1PUlBIVEFSR0VUU19VVj0hMSx0aGlzLk5VTV9NT1JQSF9JTkZMVUVOQ0VSUz0wLHRoaXMuTU9SUEhUQVJHRVRTX1RFWFRVUkU9ITEsdGhpcy5OT05VTklGT1JNU0NBTElORz0hMSx0aGlzLlBSRU1VTFRJUExZQUxQSEE9ITEsdGhpcy5BTFBIQVRFU1RfQUZURVJBTExBTFBIQUNPTVBVVEFUSU9OUz0hMSx0aGlzLkFMUEhBQkxFTkQ9ITAsdGhpcy5QUkVQQVNTPSExLHRoaXMuUFJFUEFTU19JUlJBRElBTkNFPSExLHRoaXMuUFJFUEFTU19JUlJBRElBTkNFX0lOREVYPS0xLHRoaXMuUFJFUEFTU19BTEJFRE9fU1FSVD0hMSx0aGlzLlBSRVBBU1NfQUxCRURPX1NRUlRfSU5ERVg9LTEsdGhpcy5QUkVQQVNTX0RFUFRIPSExLHRoaXMuUFJFUEFTU19ERVBUSF9JTkRFWD0tMSx0aGlzLlBSRVBBU1NfTk9STUFMPSExLHRoaXMuUFJFUEFTU19OT1JNQUxfSU5ERVg9LTEsdGhpcy5QUkVQQVNTX1BPU0lUSU9OPSExLHRoaXMuUFJFUEFTU19QT1NJVElPTl9JTkRFWD0tMSx0aGlzLlBSRVBBU1NfVkVMT0NJVFk9ITEsdGhpcy5QUkVQQVNTX1ZFTE9DSVRZX0lOREVYPS0xLHRoaXMuUFJFUEFTU19SRUZMRUNUSVZJVFk9ITEsdGhpcy5QUkVQQVNTX1JFRkxFQ1RJVklUWV9JTkRFWD0tMSx0aGlzLlNDRU5FX01SVF9DT1VOVD0wLHRoaXMuUkdCRExJR0hUTUFQPSExLHRoaXMuUkdCRFJFRkxFQ1RJT049ITEsdGhpcy5SR0JEUkVGUkFDVElPTj0hMSx0aGlzLklNQUdFUFJPQ0VTU0lORz0hMSx0aGlzLlZJR05FVFRFPSExLHRoaXMuVklHTkVUVEVCTEVORE1PREVNVUxUSVBMWT0hMSx0aGlzLlZJR05FVFRFQkxFTkRNT0RFT1BBUVVFPSExLHRoaXMuVE9ORU1BUFBJTkc9ITEsdGhpcy5UT05FTUFQUElOR19BQ0VTPSExLHRoaXMuQ09OVFJBU1Q9ITEsdGhpcy5DT0xPUkNVUlZFUz0hMSx0aGlzLkNPTE9SR1JBRElORz0hMSx0aGlzLkNPTE9SR1JBRElORzNEPSExLHRoaXMuU0FNUExFUjNER1JFRU5ERVBUSD0hMSx0aGlzLlNBTVBMRVIzREJHUk1BUD0hMSx0aGlzLkRJVEhFUj0hMSx0aGlzLklNQUdFUFJPQ0VTU0lOR1BPU1RQUk9DRVNTPSExLHRoaXMuU0tJUEZJTkFMQ09MT1JDTEFNUD0hMSx0aGlzLk1VTFRJVklFVz0hMSx0aGlzLk9SREVSX0lOREVQRU5ERU5UX1RSQU5TUEFSRU5DWT0hMSx0aGlzLk9SREVSX0lOREVQRU5ERU5UX1RSQU5TUEFSRU5DWV8xNkJJVFM9ITEsdGhpcy5DQU1FUkFfT1JUSE9HUkFQSElDPSExLHRoaXMuQ0FNRVJBX1BFUlNQRUNUSVZFPSExLHRoaXMuSVNfUkVGTEVDVElPTl9MSU5FQVI9ITEsdGhpcy5JU19SRUZSQUNUSU9OX0xJTkVBUj0hMSx0aGlzLkVYUE9TVVJFPSExLHRoaXMucmVidWlsZCgpfXNldFJlZmxlY3Rpb25Nb2RlKGUpe2NvbnN0IHQ9WyJSRUZMRUNUSU9OTUFQX0NVQklDIiwiUkVGTEVDVElPTk1BUF9FWFBMSUNJVCIsIlJFRkxFQ1RJT05NQVBfUExBTkFSIiwiUkVGTEVDVElPTk1BUF9QUk9KRUNUSU9OIiwiUkVGTEVDVElPTk1BUF9QUk9KRUNUSU9OIiwiUkVGTEVDVElPTk1BUF9TS1lCT1giLCJSRUZMRUNUSU9OTUFQX1NQSEVSSUNBTCIsIlJFRkxFQ1RJT05NQVBfRVFVSVJFQ1RBTkdVTEFSIiwiUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVJfRklYRUQiLCJSRUZMRUNUSU9OTUFQX01JUlJPUkVERVFVSVJFQ1RBTkdVTEFSX0ZJWEVEIl07Zm9yKGNvbnN0IGkgb2YgdCl0aGlzW2ldPWk9PT1lfX1jbGFzcyBCIGV4dGVuZHMgVnJ7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLHQpLHRoaXMuX2RpZmZ1c2VUZXh0dXJlPW51bGwsdGhpcy5fYW1iaWVudFRleHR1cmU9bnVsbCx0aGlzLl9vcGFjaXR5VGV4dHVyZT1udWxsLHRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlPW51bGwsdGhpcy5fZW1pc3NpdmVUZXh0dXJlPW51bGwsdGhpcy5fc3BlY3VsYXJUZXh0dXJlPW51bGwsdGhpcy5fYnVtcFRleHR1cmU9bnVsbCx0aGlzLl9saWdodG1hcFRleHR1cmU9bnVsbCx0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZT1udWxsLHRoaXMuYW1iaWVudENvbG9yPW5ldyByZSgwLDAsMCksdGhpcy5kaWZmdXNlQ29sb3I9bmV3IHJlKDEsMSwxKSx0aGlzLnNwZWN1bGFyQ29sb3I9bmV3IHJlKDEsMSwxKSx0aGlzLmVtaXNzaXZlQ29sb3I9bmV3IHJlKDAsMCwwKSx0aGlzLnNwZWN1bGFyUG93ZXI9NjQsdGhpcy5fdXNlQWxwaGFGcm9tRGlmZnVzZVRleHR1cmU9ITEsdGhpcy5fdXNlRW1pc3NpdmVBc0lsbHVtaW5hdGlvbj0hMSx0aGlzLl9saW5rRW1pc3NpdmVXaXRoRGlmZnVzZT0hMSx0aGlzLl91c2VTcGVjdWxhck92ZXJBbHBoYT0hMSx0aGlzLl91c2VSZWZsZWN0aW9uT3ZlckFscGhhPSExLHRoaXMuX2Rpc2FibGVMaWdodGluZz0hMSx0aGlzLl91c2VPYmplY3RTcGFjZU5vcm1hbE1hcD0hMSx0aGlzLl91c2VQYXJhbGxheD0hMSx0aGlzLl91c2VQYXJhbGxheE9jY2x1c2lvbj0hMSx0aGlzLnBhcmFsbGF4U2NhbGVCaWFzPS4wNSx0aGlzLl9yb3VnaG5lc3M9MCx0aGlzLmluZGV4T2ZSZWZyYWN0aW9uPS45OCx0aGlzLmludmVydFJlZnJhY3Rpb25ZPSEwLHRoaXMuYWxwaGFDdXRPZmY9LjQsdGhpcy5fdXNlTGlnaHRtYXBBc1NoYWRvd21hcD0hMSx0aGlzLl91c2VSZWZsZWN0aW9uRnJlc25lbEZyb21TcGVjdWxhcj0hMSx0aGlzLl91c2VHbG9zc2luZXNzRnJvbVNwZWN1bGFyTWFwQWxwaGE9ITEsdGhpcy5fbWF4U2ltdWx0YW5lb3VzTGlnaHRzPTQsdGhpcy5faW52ZXJ0Tm9ybWFsTWFwWD0hMSx0aGlzLl9pbnZlcnROb3JtYWxNYXBZPSExLHRoaXMuX3R3b1NpZGVkTGlnaHRpbmc9ITEsdGhpcy5fcmVuZGVyVGFyZ2V0cz1uZXcgJGUoMTYpLHRoaXMuX3dvcmxkVmlld1Byb2plY3Rpb25NYXRyaXg9eC5aZXJvKCksdGhpcy5fZ2xvYmFsQW1iaWVudENvbG9yPW5ldyByZSgwLDAsMCksdGhpcy5fY2FjaGVIYXNSZW5kZXJUYXJnZXRUZXh0dXJlcz0hMSx0aGlzLmRldGFpbE1hcD1uZXcgcGkodGhpcyksdGhpcy5fYXR0YWNoSW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbihudWxsKSx0aGlzLnByZVBhc3NDb25maWd1cmF0aW9uPW5ldyBrcix0aGlzLmdldFJlbmRlclRhcmdldFRleHR1cmVzPSgpPT4odGhpcy5fcmVuZGVyVGFyZ2V0cy5yZXNldCgpLEIuUmVmbGVjdGlvblRleHR1cmVFbmFibGVkJiZ0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSYmdGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaXNSZW5kZXJUYXJnZXQmJnRoaXMuX3JlbmRlclRhcmdldHMucHVzaCh0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSksQi5SZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWQmJnRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlJiZ0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZS5pc1JlbmRlclRhcmdldCYmdGhpcy5fcmVuZGVyVGFyZ2V0cy5wdXNoKHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlKSx0aGlzLl9ldmVudEluZm8ucmVuZGVyVGFyZ2V0cz10aGlzLl9yZW5kZXJUYXJnZXRzLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRGaWxsUmVuZGVyVGFyZ2V0VGV4dHVyZXModGhpcy5fZXZlbnRJbmZvKSx0aGlzLl9yZW5kZXJUYXJnZXRzKX1nZXQgaW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbigpe3JldHVybiB0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9ufXNldCBpbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uKGUpe3RoaXMuX2F0dGFjaEltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24oZSksdGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSgpfV9hdHRhY2hJbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uKGUpe2UhPT10aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uJiYodGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbiYmdGhpcy5faW1hZ2VQcm9jZXNzaW5nT2JzZXJ2ZXImJnRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24ub25VcGRhdGVQYXJhbWV0ZXJzLnJlbW92ZSh0aGlzLl9pbWFnZVByb2Nlc3NpbmdPYnNlcnZlciksZT90aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uPWU6dGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbj10aGlzLmdldFNjZW5lKCkuaW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbix0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uJiYodGhpcy5faW1hZ2VQcm9jZXNzaW5nT2JzZXJ2ZXI9dGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5vblVwZGF0ZVBhcmFtZXRlcnMuYWRkKCgpPT57dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzSW1hZ2VQcm9jZXNzaW5nRGlydHkoKX0pKSl9Z2V0IGlzUHJlUGFzc0NhcGFibGUoKXtyZXR1cm4hdGhpcy5kaXNhYmxlRGVwdGhXcml0ZX1nZXQgY2FtZXJhQ29sb3JDdXJ2ZXNFbmFibGVkKCl7cmV0dXJuIHRoaXMuaW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5jb2xvckN1cnZlc0VuYWJsZWR9c2V0IGNhbWVyYUNvbG9yQ3VydmVzRW5hYmxlZChlKXt0aGlzLmltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24uY29sb3JDdXJ2ZXNFbmFibGVkPWV9Z2V0IGNhbWVyYUNvbG9yR3JhZGluZ0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbG9yR3JhZGluZ0VuYWJsZWR9c2V0IGNhbWVyYUNvbG9yR3JhZGluZ0VuYWJsZWQoZSl7dGhpcy5pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbG9yR3JhZGluZ0VuYWJsZWQ9ZX1nZXQgY2FtZXJhVG9uZU1hcHBpbmdFbmFibGVkKCl7cmV0dXJuIHRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24udG9uZU1hcHBpbmdFbmFibGVkfXNldCBjYW1lcmFUb25lTWFwcGluZ0VuYWJsZWQoZSl7dGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi50b25lTWFwcGluZ0VuYWJsZWQ9ZX1nZXQgY2FtZXJhRXhwb3N1cmUoKXtyZXR1cm4gdGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5leHBvc3VyZX1zZXQgY2FtZXJhRXhwb3N1cmUoZSl7dGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5leHBvc3VyZT1lfWdldCBjYW1lcmFDb250cmFzdCgpe3JldHVybiB0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbnRyYXN0fXNldCBjYW1lcmFDb250cmFzdChlKXt0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbnRyYXN0PWV9Z2V0IGNhbWVyYUNvbG9yR3JhZGluZ1RleHR1cmUoKXtyZXR1cm4gdGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5jb2xvckdyYWRpbmdUZXh0dXJlfXNldCBjYW1lcmFDb2xvckdyYWRpbmdUZXh0dXJlKGUpe3RoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24uY29sb3JHcmFkaW5nVGV4dHVyZT1lfWdldCBjYW1lcmFDb2xvckN1cnZlcygpe3JldHVybiB0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbG9yQ3VydmVzfXNldCBjYW1lcmFDb2xvckN1cnZlcyhlKXt0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbG9yQ3VydmVzPWV9Z2V0IGNhblJlbmRlclRvTVJUKCl7cmV0dXJuITB9Z2V0IGhhc1JlbmRlclRhcmdldFRleHR1cmVzKCl7cmV0dXJuIEIuUmVmbGVjdGlvblRleHR1cmVFbmFibGVkJiZ0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSYmdGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaXNSZW5kZXJUYXJnZXR8fEIuUmVmcmFjdGlvblRleHR1cmVFbmFibGVkJiZ0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZSYmdGhpcy5fcmVmcmFjdGlvblRleHR1cmUuaXNSZW5kZXJUYXJnZXQ/ITA6dGhpcy5fY2FjaGVIYXNSZW5kZXJUYXJnZXRUZXh0dXJlc31nZXRDbGFzc05hbWUoKXtyZXR1cm4iU3RhbmRhcmRNYXRlcmlhbCJ9Z2V0IHVzZUxvZ2FyaXRobWljRGVwdGgoKXtyZXR1cm4gdGhpcy5fdXNlTG9nYXJpdGhtaWNEZXB0aH1zZXQgdXNlTG9nYXJpdGhtaWNEZXB0aChlKXt0aGlzLl91c2VMb2dhcml0aG1pY0RlcHRoPWUmJnRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5nZXRDYXBzKCkuZnJhZ21lbnREZXB0aFN1cHBvcnRlZCx0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNNaXNjRGlydHkoKX1uZWVkQWxwaGFCbGVuZGluZygpe3JldHVybiB0aGlzLl9kaXNhYmxlQWxwaGFCbGVuZGluZz8hMTp0aGlzLmFscGhhPDF8fHRoaXMuX29wYWNpdHlUZXh0dXJlIT1udWxsfHx0aGlzLl9zaG91bGRVc2VBbHBoYUZyb21EaWZmdXNlVGV4dHVyZSgpfHx0aGlzLl9vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuX29wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWR9bmVlZEFscGhhVGVzdGluZygpe3JldHVybiB0aGlzLl9mb3JjZUFscGhhVGVzdD8hMDp0aGlzLl9oYXNBbHBoYUNoYW5uZWwoKSYmKHRoaXMuX3RyYW5zcGFyZW5jeU1vZGU9PW51bGx8fHRoaXMuX3RyYW5zcGFyZW5jeU1vZGU9PT1QLk1BVEVSSUFMX0FMUEhBVEVTVCl9X3Nob3VsZFVzZUFscGhhRnJvbURpZmZ1c2VUZXh0dXJlKCl7cmV0dXJuIHRoaXMuX2RpZmZ1c2VUZXh0dXJlIT1udWxsJiZ0aGlzLl9kaWZmdXNlVGV4dHVyZS5oYXNBbHBoYSYmdGhpcy5fdXNlQWxwaGFGcm9tRGlmZnVzZVRleHR1cmUmJnRoaXMuX3RyYW5zcGFyZW5jeU1vZGUhPT1QLk1BVEVSSUFMX09QQVFVRX1faGFzQWxwaGFDaGFubmVsKCl7cmV0dXJuIHRoaXMuX2RpZmZ1c2VUZXh0dXJlIT1udWxsJiZ0aGlzLl9kaWZmdXNlVGV4dHVyZS5oYXNBbHBoYXx8dGhpcy5fb3BhY2l0eVRleHR1cmUhPW51bGx9Z2V0QWxwaGFUZXN0VGV4dHVyZSgpe3JldHVybiB0aGlzLl9kaWZmdXNlVGV4dHVyZX1pc1JlYWR5Rm9yU3ViTWVzaChlLHQsaT0hMSl7aWYodGhpcy5fdW5pZm9ybUJ1ZmZlckxheW91dEJ1aWx0fHx0aGlzLmJ1aWxkVW5pZm9ybUxheW91dCgpLHQuZWZmZWN0JiZ0aGlzLmlzRnJvemVuJiZ0LmVmZmVjdC5fd2FzUHJldmlvdXNseVJlYWR5JiZ0LmVmZmVjdC5fd2FzUHJldmlvdXNseVVzaW5nSW5zdGFuY2VzPT09aSlyZXR1cm4hMDt0Lm1hdGVyaWFsRGVmaW5lc3x8KHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRHZW5lcmljKFFlLkdldERlZmluZU5hbWVzLHRoaXMuX2V2ZW50SW5mbyksdC5tYXRlcmlhbERlZmluZXM9bmV3IG1sKHRoaXMuX2V2ZW50SW5mby5kZWZpbmVOYW1lcykpO2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpLHI9dC5tYXRlcmlhbERlZmluZXM7aWYodGhpcy5faXNSZWFkeUZvclN1Yk1lc2godCkpcmV0dXJuITA7Y29uc3Qgbj1zLmdldEVuZ2luZSgpO3IuX25lZWROb3JtYWxzPWllLlByZXBhcmVEZWZpbmVzRm9yTGlnaHRzKHMsZSxyLCEwLHRoaXMuX21heFNpbXVsdGFuZW91c0xpZ2h0cyx0aGlzLl9kaXNhYmxlTGlnaHRpbmcpLGllLlByZXBhcmVEZWZpbmVzRm9yTXVsdGl2aWV3KHMscik7Y29uc3QgYT10aGlzLm5lZWRBbHBoYUJsZW5kaW5nRm9yTWVzaChlKSYmdGhpcy5nZXRTY2VuZSgpLnVzZU9yZGVySW5kZXBlbmRlbnRUcmFuc3BhcmVuY3k7aWYoaWUuUHJlcGFyZURlZmluZXNGb3JQcmVQYXNzKHMscix0aGlzLmNhblJlbmRlclRvTVJUJiYhYSksaWUuUHJlcGFyZURlZmluZXNGb3JPSVQocyxyLGEpLHIuX2FyZVRleHR1cmVzRGlydHkpe3RoaXMuX2V2ZW50SW5mby5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcz0hMSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50SGFzUmVuZGVyVGFyZ2V0VGV4dHVyZXModGhpcy5fZXZlbnRJbmZvKSx0aGlzLl9jYWNoZUhhc1JlbmRlclRhcmdldFRleHR1cmVzPXRoaXMuX2V2ZW50SW5mby5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyxyLl9uZWVkVVZzPSExO2ZvcihsZXQgaD0xO2g8PTY7KytoKXJbIk1BSU5VViIraF09ITE7aWYocy50ZXh0dXJlc0VuYWJsZWQpe2lmKHIuRElGRlVTRURJUkVDVFVWPTAsci5CVU1QRElSRUNUVVY9MCxyLkFNQklFTlRESVJFQ1RVVj0wLHIuT1BBQ0lUWURJUkVDVFVWPTAsci5FTUlTU0lWRURJUkVDVFVWPTAsci5TUEVDVUxBUkRJUkVDVFVWPTAsci5MSUdIVE1BUERJUkVDVFVWPTAsdGhpcy5fZGlmZnVzZVRleHR1cmUmJkIuRGlmZnVzZVRleHR1cmVFbmFibGVkKWlmKHRoaXMuX2RpZmZ1c2VUZXh0dXJlLmlzUmVhZHlPck5vdEJsb2NraW5nKCkpaWUuUHJlcGFyZURlZmluZXNGb3JNZXJnZWRVVih0aGlzLl9kaWZmdXNlVGV4dHVyZSxyLCJESUZGVVNFIik7ZWxzZSByZXR1cm4hMTtlbHNlIHIuRElGRlVTRT0hMTtpZih0aGlzLl9hbWJpZW50VGV4dHVyZSYmQi5BbWJpZW50VGV4dHVyZUVuYWJsZWQpaWYodGhpcy5fYW1iaWVudFRleHR1cmUuaXNSZWFkeU9yTm90QmxvY2tpbmcoKSlpZS5QcmVwYXJlRGVmaW5lc0Zvck1lcmdlZFVWKHRoaXMuX2FtYmllbnRUZXh0dXJlLHIsIkFNQklFTlQiKTtlbHNlIHJldHVybiExO2Vsc2Ugci5BTUJJRU5UPSExO2lmKHRoaXMuX29wYWNpdHlUZXh0dXJlJiZCLk9wYWNpdHlUZXh0dXJlRW5hYmxlZClpZih0aGlzLl9vcGFjaXR5VGV4dHVyZS5pc1JlYWR5T3JOb3RCbG9ja2luZygpKWllLlByZXBhcmVEZWZpbmVzRm9yTWVyZ2VkVVYodGhpcy5fb3BhY2l0eVRleHR1cmUsciwiT1BBQ0lUWSIpLHIuT1BBQ0lUWVJHQj10aGlzLl9vcGFjaXR5VGV4dHVyZS5nZXRBbHBoYUZyb21SR0I7ZWxzZSByZXR1cm4hMTtlbHNlIHIuT1BBQ0lUWT0hMTtpZih0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSYmQi5SZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWQpaWYodGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaXNSZWFkeU9yTm90QmxvY2tpbmcoKSl7c3dpdGNoKHIuX25lZWROb3JtYWxzPSEwLHIuUkVGTEVDVElPTj0hMCxyLlJPVUdITkVTUz10aGlzLl9yb3VnaG5lc3M+MCxyLlJFRkxFQ1RJT05PVkVSQUxQSEE9dGhpcy5fdXNlUmVmbGVjdGlvbk92ZXJBbHBoYSxyLklOVkVSVENVQklDTUFQPXRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlLmNvb3JkaW5hdGVzTW9kZT09PU4uSU5WQ1VCSUNfTU9ERSxyLlJFRkxFQ1RJT05NQVBfM0Q9dGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaXNDdWJlLHIuUkVGTEVDVElPTk1BUF9PUFBPU0lURVo9ci5SRUZMRUNUSU9OTUFQXzNEJiZ0aGlzLmdldFNjZW5lKCkudXNlUmlnaHRIYW5kZWRTeXN0ZW0/IXRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlLmludmVydFo6dGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaW52ZXJ0WixyLlJHQkRSRUZMRUNUSU9OPXRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlLmlzUkdCRCx0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZS5jb29yZGluYXRlc01vZGUpe2Nhc2UgTi5FWFBMSUNJVF9NT0RFOnIuc2V0UmVmbGVjdGlvbk1vZGUoIlJFRkxFQ1RJT05NQVBfRVhQTElDSVQiKTticmVhaztjYXNlIE4uUExBTkFSX01PREU6ci5zZXRSZWZsZWN0aW9uTW9kZSgiUkVGTEVDVElPTk1BUF9QTEFOQVIiKTticmVhaztjYXNlIE4uUFJPSkVDVElPTl9NT0RFOnIuc2V0UmVmbGVjdGlvbk1vZGUoIlJFRkxFQ1RJT05NQVBfUFJPSkVDVElPTiIpO2JyZWFrO2Nhc2UgTi5TS1lCT1hfTU9ERTpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX1NLWUJPWCIpO2JyZWFrO2Nhc2UgTi5TUEhFUklDQUxfTU9ERTpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX1NQSEVSSUNBTCIpO2JyZWFrO2Nhc2UgTi5FUVVJUkVDVEFOR1VMQVJfTU9ERTpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUiIpO2JyZWFrO2Nhc2UgTi5GSVhFRF9FUVVJUkVDVEFOR1VMQVJfTU9ERTpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRCIpO2JyZWFrO2Nhc2UgTi5GSVhFRF9FUVVJUkVDVEFOR1VMQVJfTUlSUk9SRURfTU9ERTpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX01JUlJPUkVERVFVSVJFQ1RBTkdVTEFSX0ZJWEVEIik7YnJlYWs7Y2FzZSBOLkNVQklDX01PREU6Y2FzZSBOLklOVkNVQklDX01PREU6ZGVmYXVsdDpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX0NVQklDIik7YnJlYWt9ci5VU0VfTE9DQUxfUkVGTEVDVElPTk1BUF9DVUJJQz0hIXRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlLmJvdW5kaW5nQm94U2l6ZX1lbHNlIHJldHVybiExO2Vsc2Ugci5SRUZMRUNUSU9OPSExLHIuUkVGTEVDVElPTk1BUF9PUFBPU0lURVo9ITE7aWYodGhpcy5fZW1pc3NpdmVUZXh0dXJlJiZCLkVtaXNzaXZlVGV4dHVyZUVuYWJsZWQpaWYodGhpcy5fZW1pc3NpdmVUZXh0dXJlLmlzUmVhZHlPck5vdEJsb2NraW5nKCkpaWUuUHJlcGFyZURlZmluZXNGb3JNZXJnZWRVVih0aGlzLl9lbWlzc2l2ZVRleHR1cmUsciwiRU1JU1NJVkUiKTtlbHNlIHJldHVybiExO2Vsc2Ugci5FTUlTU0lWRT0hMTtpZih0aGlzLl9saWdodG1hcFRleHR1cmUmJkIuTGlnaHRtYXBUZXh0dXJlRW5hYmxlZClpZih0aGlzLl9saWdodG1hcFRleHR1cmUuaXNSZWFkeU9yTm90QmxvY2tpbmcoKSlpZS5QcmVwYXJlRGVmaW5lc0Zvck1lcmdlZFVWKHRoaXMuX2xpZ2h0bWFwVGV4dHVyZSxyLCJMSUdIVE1BUCIpLHIuVVNFTElHSFRNQVBBU1NIQURPV01BUD10aGlzLl91c2VMaWdodG1hcEFzU2hhZG93bWFwLHIuUkdCRExJR0hUTUFQPXRoaXMuX2xpZ2h0bWFwVGV4dHVyZS5pc1JHQkQ7ZWxzZSByZXR1cm4hMTtlbHNlIHIuTElHSFRNQVA9ITE7aWYodGhpcy5fc3BlY3VsYXJUZXh0dXJlJiZCLlNwZWN1bGFyVGV4dHVyZUVuYWJsZWQpaWYodGhpcy5fc3BlY3VsYXJUZXh0dXJlLmlzUmVhZHlPck5vdEJsb2NraW5nKCkpaWUuUHJlcGFyZURlZmluZXNGb3JNZXJnZWRVVih0aGlzLl9zcGVjdWxhclRleHR1cmUsciwiU1BFQ1VMQVIiKSxyLkdMT1NTSU5FU1M9dGhpcy5fdXNlR2xvc3NpbmVzc0Zyb21TcGVjdWxhck1hcEFscGhhO2Vsc2UgcmV0dXJuITE7ZWxzZSByLlNQRUNVTEFSPSExO2lmKHMuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLnN0YW5kYXJkRGVyaXZhdGl2ZXMmJnRoaXMuX2J1bXBUZXh0dXJlJiZCLkJ1bXBUZXh0dXJlRW5hYmxlZCl7aWYodGhpcy5fYnVtcFRleHR1cmUuaXNSZWFkeSgpKWllLlByZXBhcmVEZWZpbmVzRm9yTWVyZ2VkVVYodGhpcy5fYnVtcFRleHR1cmUsciwiQlVNUCIpLHIuUEFSQUxMQVg9dGhpcy5fdXNlUGFyYWxsYXgsci5QQVJBTExBWE9DQ0xVU0lPTj10aGlzLl91c2VQYXJhbGxheE9jY2x1c2lvbjtlbHNlIHJldHVybiExO3IuT0JKRUNUU1BBQ0VfTk9STUFMTUFQPXRoaXMuX3VzZU9iamVjdFNwYWNlTm9ybWFsTWFwfWVsc2Ugci5CVU1QPSExLHIuUEFSQUxMQVg9ITEsci5QQVJBTExBWE9DQ0xVU0lPTj0hMTtpZih0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZSYmQi5SZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWQpaWYodGhpcy5fcmVmcmFjdGlvblRleHR1cmUuaXNSZWFkeU9yTm90QmxvY2tpbmcoKSlyLl9uZWVkVVZzPSEwLHIuUkVGUkFDVElPTj0hMCxyLlJFRlJBQ1RJT05NQVBfM0Q9dGhpcy5fcmVmcmFjdGlvblRleHR1cmUuaXNDdWJlLHIuUkdCRFJFRlJBQ1RJT049dGhpcy5fcmVmcmFjdGlvblRleHR1cmUuaXNSR0JELHIuVVNFX0xPQ0FMX1JFRlJBQ1RJT05NQVBfQ1VCSUM9ISF0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZS5ib3VuZGluZ0JveFNpemU7ZWxzZSByZXR1cm4hMTtlbHNlIHIuUkVGUkFDVElPTj0hMTtyLlRXT1NJREVETElHSFRJTkc9IXRoaXMuX2JhY2tGYWNlQ3VsbGluZyYmdGhpcy5fdHdvU2lkZWRMaWdodGluZ31lbHNlIHIuRElGRlVTRT0hMSxyLkFNQklFTlQ9ITEsci5PUEFDSVRZPSExLHIuUkVGTEVDVElPTj0hMSxyLkVNSVNTSVZFPSExLHIuTElHSFRNQVA9ITEsci5CVU1QPSExLHIuUkVGUkFDVElPTj0hMTtyLkFMUEhBRlJPTURJRkZVU0U9dGhpcy5fc2hvdWxkVXNlQWxwaGFGcm9tRGlmZnVzZVRleHR1cmUoKSxyLkVNSVNTSVZFQVNJTExVTUlOQVRJT049dGhpcy5fdXNlRW1pc3NpdmVBc0lsbHVtaW5hdGlvbixyLkxJTktFTUlTU0lWRVdJVEhESUZGVVNFPXRoaXMuX2xpbmtFbWlzc2l2ZVdpdGhEaWZmdXNlLHIuU1BFQ1VMQVJPVkVSQUxQSEE9dGhpcy5fdXNlU3BlY3VsYXJPdmVyQWxwaGEsci5QUkVNVUxUSVBMWUFMUEhBPXRoaXMuYWxwaGFNb2RlPT09N3x8dGhpcy5hbHBoYU1vZGU9PT04LHIuQUxQSEFURVNUX0FGVEVSQUxMQUxQSEFDT01QVVRBVElPTlM9dGhpcy50cmFuc3BhcmVuY3lNb2RlIT09bnVsbCxyLkFMUEhBQkxFTkQ9dGhpcy50cmFuc3BhcmVuY3lNb2RlPT09bnVsbHx8dGhpcy5uZWVkQWxwaGFCbGVuZGluZ0Zvck1lc2goZSl9aWYodGhpcy5fZXZlbnRJbmZvLmlzUmVhZHlGb3JTdWJNZXNoPSEwLHRoaXMuX2V2ZW50SW5mby5kZWZpbmVzPXIsdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudElzUmVhZHlGb3JTdWJNZXNoKHRoaXMuX2V2ZW50SW5mbyksIXRoaXMuX2V2ZW50SW5mby5pc1JlYWR5Rm9yU3ViTWVzaClyZXR1cm4hMTtpZihyLl9hcmVJbWFnZVByb2Nlc3NpbmdEaXJ0eSYmdGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbil7aWYoIXRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24uaXNSZWFkeSgpKXJldHVybiExO3RoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24ucHJlcGFyZURlZmluZXMociksci5JU19SRUZMRUNUSU9OX0xJTkVBUj10aGlzLnJlZmxlY3Rpb25UZXh0dXJlIT1udWxsJiYhdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5nYW1tYVNwYWNlLHIuSVNfUkVGUkFDVElPTl9MSU5FQVI9dGhpcy5yZWZyYWN0aW9uVGV4dHVyZSE9bnVsbCYmIXRoaXMucmVmcmFjdGlvblRleHR1cmUuZ2FtbWFTcGFjZX1yLl9hcmVGcmVzbmVsRGlydHkmJihCLkZyZXNuZWxFbmFibGVkPyh0aGlzLl9kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnN8fHRoaXMuX29wYWNpdHlGcmVzbmVsUGFyYW1ldGVyc3x8dGhpcy5fZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVyc3x8dGhpcy5fcmVmcmFjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzfHx0aGlzLl9yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMpJiYoci5ESUZGVVNFRlJFU05FTD10aGlzLl9kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuX2RpZmZ1c2VGcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWQsci5PUEFDSVRZRlJFU05FTD10aGlzLl9vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuX29wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWQsci5SRUZMRUNUSU9ORlJFU05FTD10aGlzLl9yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuX3JlZmxlY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWQsci5SRUZMRUNUSU9ORlJFU05FTEZST01TUEVDVUxBUj10aGlzLl91c2VSZWZsZWN0aW9uRnJlc25lbEZyb21TcGVjdWxhcixyLlJFRlJBQ1RJT05GUkVTTkVMPXRoaXMuX3JlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5fcmVmcmFjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCxyLkVNSVNTSVZFRlJFU05FTD10aGlzLl9lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzJiZ0aGlzLl9lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCxyLl9uZWVkTm9ybWFscz0hMCxyLkZSRVNORUw9ITApOnIuRlJFU05FTD0hMSksaWUuUHJlcGFyZURlZmluZXNGb3JNaXNjKGUscyx0aGlzLl91c2VMb2dhcml0aG1pY0RlcHRoLHRoaXMucG9pbnRzQ2xvdWQsdGhpcy5mb2dFbmFibGVkLHRoaXMuX3Nob3VsZFR1cm5BbHBoYVRlc3RPbihlKXx8dGhpcy5fZm9yY2VBbHBoYVRlc3QsciksaWUuUHJlcGFyZURlZmluZXNGb3JGcmFtZUJvdW5kVmFsdWVzKHMsbix0aGlzLHIsaSxudWxsLHQuZ2V0UmVuZGVyaW5nTWVzaCgpLmhhc1RoaW5JbnN0YW5jZXMpLHRoaXMuX2V2ZW50SW5mby5kZWZpbmVzPXIsdGhpcy5fZXZlbnRJbmZvLm1lc2g9ZSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50UHJlcGFyZURlZmluZXNCZWZvcmVBdHRyaWJ1dGVzKHRoaXMuX2V2ZW50SW5mbyksaWUuUHJlcGFyZURlZmluZXNGb3JBdHRyaWJ1dGVzKGUsciwhMCwhMCwhMCksdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudFByZXBhcmVEZWZpbmVzKHRoaXMuX2V2ZW50SW5mbyk7bGV0IG89ITE7aWYoci5pc0RpcnR5KXtjb25zdCBoPXIuX2FyZUxpZ2h0c0Rpc3Bvc2VkO3IubWFya0FzUHJvY2Vzc2VkKCk7Y29uc3QgbD1uZXcgenM7ci5SRUZMRUNUSU9OJiZsLmFkZEZhbGxiYWNrKDAsIlJFRkxFQ1RJT04iKSxyLlNQRUNVTEFSJiZsLmFkZEZhbGxiYWNrKDAsIlNQRUNVTEFSIiksci5CVU1QJiZsLmFkZEZhbGxiYWNrKDAsIkJVTVAiKSxyLlBBUkFMTEFYJiZsLmFkZEZhbGxiYWNrKDEsIlBBUkFMTEFYIiksci5QQVJBTExBWE9DQ0xVU0lPTiYmbC5hZGRGYWxsYmFjaygwLCJQQVJBTExBWE9DQ0xVU0lPTiIpLHIuU1BFQ1VMQVJPVkVSQUxQSEEmJmwuYWRkRmFsbGJhY2soMCwiU1BFQ1VMQVJPVkVSQUxQSEEiKSxyLkZPRyYmbC5hZGRGYWxsYmFjaygxLCJGT0ciKSxyLlBPSU5UU0laRSYmbC5hZGRGYWxsYmFjaygwLCJQT0lOVFNJWkUiKSxyLkxPR0FSSVRITUlDREVQVEgmJmwuYWRkRmFsbGJhY2soMCwiTE9HQVJJVEhNSUNERVBUSCIpLGllLkhhbmRsZUZhbGxiYWNrc0ZvclNoYWRvd3MocixsLHRoaXMuX21heFNpbXVsdGFuZW91c0xpZ2h0cyksci5TUEVDVUxBUlRFUk0mJmwuYWRkRmFsbGJhY2soMCwiU1BFQ1VMQVJURVJNIiksci5ESUZGVVNFRlJFU05FTCYmbC5hZGRGYWxsYmFjaygxLCJESUZGVVNFRlJFU05FTCIpLHIuT1BBQ0lUWUZSRVNORUwmJmwuYWRkRmFsbGJhY2soMiwiT1BBQ0lUWUZSRVNORUwiKSxyLlJFRkxFQ1RJT05GUkVTTkVMJiZsLmFkZEZhbGxiYWNrKDMsIlJFRkxFQ1RJT05GUkVTTkVMIiksci5FTUlTU0lWRUZSRVNORUwmJmwuYWRkRmFsbGJhY2soNCwiRU1JU1NJVkVGUkVTTkVMIiksci5GUkVTTkVMJiZsLmFkZEZhbGxiYWNrKDQsIkZSRVNORUwiKSxyLk1VTFRJVklFVyYmbC5hZGRGYWxsYmFjaygwLCJNVUxUSVZJRVciKTtjb25zdCB1PVtnLlBvc2l0aW9uS2luZF07ci5OT1JNQUwmJnUucHVzaChnLk5vcm1hbEtpbmQpLHIuVEFOR0VOVCYmdS5wdXNoKGcuVGFuZ2VudEtpbmQpO2ZvcihsZXQgQT0xO0E8PTY7KytBKXJbIlVWIitBXSYmdS5wdXNoKGB1diR7QT09PTE/IiI6QX1gKTtyLlZFUlRFWENPTE9SJiZ1LnB1c2goZy5Db2xvcktpbmQpLGllLlByZXBhcmVBdHRyaWJ1dGVzRm9yQm9uZXModSxlLHIsbCksaWUuUHJlcGFyZUF0dHJpYnV0ZXNGb3JJbnN0YW5jZXModSxyKSxpZS5QcmVwYXJlQXR0cmlidXRlc0Zvck1vcnBoVGFyZ2V0cyh1LGUsciksaWUuUHJlcGFyZUF0dHJpYnV0ZXNGb3JCYWtlZFZlcnRleEFuaW1hdGlvbih1LGUscik7bGV0IGQ9ImRlZmF1bHQiO2NvbnN0IGY9WyJ3b3JsZCIsInZpZXciLCJ2aWV3UHJvamVjdGlvbiIsInZFeWVQb3NpdGlvbiIsInZMaWdodHNUeXBlIiwidkFtYmllbnRDb2xvciIsInZEaWZmdXNlQ29sb3IiLCJ2U3BlY3VsYXJDb2xvciIsInZFbWlzc2l2ZUNvbG9yIiwidmlzaWJpbGl0eSIsInZGb2dJbmZvcyIsInZGb2dDb2xvciIsInBvaW50U2l6ZSIsInZEaWZmdXNlSW5mb3MiLCJ2QW1iaWVudEluZm9zIiwidk9wYWNpdHlJbmZvcyIsInZSZWZsZWN0aW9uSW5mb3MiLCJ2RW1pc3NpdmVJbmZvcyIsInZTcGVjdWxhckluZm9zIiwidkJ1bXBJbmZvcyIsInZMaWdodG1hcEluZm9zIiwidlJlZnJhY3Rpb25JbmZvcyIsIm1Cb25lcyIsImRpZmZ1c2VNYXRyaXgiLCJhbWJpZW50TWF0cml4Iiwib3BhY2l0eU1hdHJpeCIsInJlZmxlY3Rpb25NYXRyaXgiLCJlbWlzc2l2ZU1hdHJpeCIsInNwZWN1bGFyTWF0cml4IiwiYnVtcE1hdHJpeCIsIm5vcm1hbE1hdHJpeCIsImxpZ2h0bWFwTWF0cml4IiwicmVmcmFjdGlvbk1hdHJpeCIsImRpZmZ1c2VMZWZ0Q29sb3IiLCJkaWZmdXNlUmlnaHRDb2xvciIsIm9wYWNpdHlQYXJ0cyIsInJlZmxlY3Rpb25MZWZ0Q29sb3IiLCJyZWZsZWN0aW9uUmlnaHRDb2xvciIsImVtaXNzaXZlTGVmdENvbG9yIiwiZW1pc3NpdmVSaWdodENvbG9yIiwicmVmcmFjdGlvbkxlZnRDb2xvciIsInJlZnJhY3Rpb25SaWdodENvbG9yIiwidlJlZmxlY3Rpb25Qb3NpdGlvbiIsInZSZWZsZWN0aW9uU2l6ZSIsInZSZWZyYWN0aW9uUG9zaXRpb24iLCJ2UmVmcmFjdGlvblNpemUiLCJsb2dhcml0aG1pY0RlcHRoQ29uc3RhbnQiLCJ2VGFuZ2VudFNwYWNlUGFyYW1zIiwiYWxwaGFDdXRPZmYiLCJib25lVGV4dHVyZVdpZHRoIiwibW9ycGhUYXJnZXRUZXh0dXJlSW5mbyIsIm1vcnBoVGFyZ2V0VGV4dHVyZUluZGljZXMiXSxfPVsiZGlmZnVzZVNhbXBsZXIiLCJhbWJpZW50U2FtcGxlciIsIm9wYWNpdHlTYW1wbGVyIiwicmVmbGVjdGlvbkN1YmVTYW1wbGVyIiwicmVmbGVjdGlvbjJEU2FtcGxlciIsImVtaXNzaXZlU2FtcGxlciIsInNwZWN1bGFyU2FtcGxlciIsImJ1bXBTYW1wbGVyIiwibGlnaHRtYXBTYW1wbGVyIiwicmVmcmFjdGlvbkN1YmVTYW1wbGVyIiwicmVmcmFjdGlvbjJEU2FtcGxlciIsImJvbmVTYW1wbGVyIiwibW9ycGhUYXJnZXRzIiwib2l0RGVwdGhTYW1wbGVyIiwib2l0RnJvbnRDb2xvclNhbXBsZXIiXSxFPVsiTWF0ZXJpYWwiLCJTY2VuZSIsIk1lc2giXTt0aGlzLl9ldmVudEluZm8uZmFsbGJhY2tzPWwsdGhpcy5fZXZlbnRJbmZvLmZhbGxiYWNrUmFuaz0wLHRoaXMuX2V2ZW50SW5mby5kZWZpbmVzPXIsdGhpcy5fZXZlbnRJbmZvLnVuaWZvcm1zPWYsdGhpcy5fZXZlbnRJbmZvLmF0dHJpYnV0ZXM9dSx0aGlzLl9ldmVudEluZm8uc2FtcGxlcnM9Xyx0aGlzLl9ldmVudEluZm8udW5pZm9ybUJ1ZmZlcnNOYW1lcz1FLHRoaXMuX2V2ZW50SW5mby5jdXN0b21Db2RlPXZvaWQgMCx0aGlzLl9ldmVudEluZm8ubWVzaD1lLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRHZW5lcmljKFFlLlByZXBhcmVFZmZlY3QsdGhpcy5fZXZlbnRJbmZvKSxrci5BZGRVbmlmb3JtcyhmKSxwZSYmKHBlLlByZXBhcmVVbmlmb3JtcyhmLHIpLHBlLlByZXBhcmVTYW1wbGVycyhfLHIpKSxpZS5QcmVwYXJlVW5pZm9ybXNBbmRTYW1wbGVyc0xpc3Qoe3VuaWZvcm1zTmFtZXM6Zix1bmlmb3JtQnVmZmVyc05hbWVzOkUsc2FtcGxlcnM6XyxkZWZpbmVzOnIsbWF4U2ltdWx0YW5lb3VzTGlnaHRzOnRoaXMuX21heFNpbXVsdGFuZW91c0xpZ2h0c30pLHNzKGYpO2NvbnN0IG09e307dGhpcy5jdXN0b21TaGFkZXJOYW1lUmVzb2x2ZSYmKGQ9dGhpcy5jdXN0b21TaGFkZXJOYW1lUmVzb2x2ZShkLGYsRSxfLHIsdSxtKSk7Y29uc3Qgdj1yLnRvU3RyaW5nKCksUz10LmVmZmVjdDtsZXQgeT1zLmdldEVuZ2luZSgpLmNyZWF0ZUVmZmVjdChkLHthdHRyaWJ1dGVzOnUsdW5pZm9ybXNOYW1lczpmLHVuaWZvcm1CdWZmZXJzTmFtZXM6RSxzYW1wbGVyczpfLGRlZmluZXM6dixmYWxsYmFja3M6bCxvbkNvbXBpbGVkOnRoaXMub25Db21waWxlZCxvbkVycm9yOnRoaXMub25FcnJvcixpbmRleFBhcmFtZXRlcnM6e21heFNpbXVsdGFuZW91c0xpZ2h0czp0aGlzLl9tYXhTaW11bHRhbmVvdXNMaWdodHMsbWF4U2ltdWx0YW5lb3VzTW9ycGhUYXJnZXRzOnIuTlVNX01PUlBIX0lORkxVRU5DRVJTfSxwcm9jZXNzRmluYWxDb2RlOm0ucHJvY2Vzc0ZpbmFsQ29kZSxwcm9jZXNzQ29kZUFmdGVySW5jbHVkZXM6dGhpcy5fZXZlbnRJbmZvLmN1c3RvbUNvZGUsbXVsdGlUYXJnZXQ6ci5QUkVQQVNTfSxuKTtpZih0aGlzLl9ldmVudEluZm8uY3VzdG9tQ29kZT12b2lkIDAseSlpZih0aGlzLl9vbkVmZmVjdENyZWF0ZWRPYnNlcnZhYmxlJiYoR3MuZWZmZWN0PXksR3Muc3ViTWVzaD10LHRoaXMuX29uRWZmZWN0Q3JlYXRlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKEdzKSksdGhpcy5hbGxvd1NoYWRlckhvdFN3YXBwaW5nJiZTJiYheS5pc1JlYWR5KCkpe2lmKHk9UyxyLm1hcmtBc1VucHJvY2Vzc2VkKCksbz10aGlzLmlzRnJvemVuLGgpcmV0dXJuIHIuX2FyZUxpZ2h0c0Rpc3Bvc2VkPSEwLCExfWVsc2Ugcy5yZXNldENhY2hlZE1hdGVyaWFsKCksdC5zZXRFZmZlY3QoeSxyLHRoaXMuX21hdGVyaWFsQ29udGV4dCl9cmV0dXJuIXQuZWZmZWN0fHwhdC5lZmZlY3QuaXNSZWFkeSgpPyExOihyLl9yZW5kZXJJZD1zLmdldFJlbmRlcklkKCksdC5lZmZlY3QuX3dhc1ByZXZpb3VzbHlSZWFkeT0hbyx0LmVmZmVjdC5fd2FzUHJldmlvdXNseVVzaW5nSW5zdGFuY2VzPWkscy5wZXJmb3JtYW5jZVByaW9yaXR5IT09Q3QuQmFja3dhcmRDb21wYXRpYmxlJiYodGhpcy5jaGVja1JlYWR5T25seU9uY2U9ITApLCEwKX1idWlsZFVuaWZvcm1MYXlvdXQoKXtjb25zdCBlPXRoaXMuX3VuaWZvcm1CdWZmZXI7ZS5hZGRVbmlmb3JtKCJkaWZmdXNlTGVmdENvbG9yIiw0KSxlLmFkZFVuaWZvcm0oImRpZmZ1c2VSaWdodENvbG9yIiw0KSxlLmFkZFVuaWZvcm0oIm9wYWNpdHlQYXJ0cyIsNCksZS5hZGRVbmlmb3JtKCJyZWZsZWN0aW9uTGVmdENvbG9yIiw0KSxlLmFkZFVuaWZvcm0oInJlZmxlY3Rpb25SaWdodENvbG9yIiw0KSxlLmFkZFVuaWZvcm0oInJlZnJhY3Rpb25MZWZ0Q29sb3IiLDQpLGUuYWRkVW5pZm9ybSgicmVmcmFjdGlvblJpZ2h0Q29sb3IiLDQpLGUuYWRkVW5pZm9ybSgiZW1pc3NpdmVMZWZ0Q29sb3IiLDQpLGUuYWRkVW5pZm9ybSgiZW1pc3NpdmVSaWdodENvbG9yIiw0KSxlLmFkZFVuaWZvcm0oInZEaWZmdXNlSW5mb3MiLDIpLGUuYWRkVW5pZm9ybSgidkFtYmllbnRJbmZvcyIsMiksZS5hZGRVbmlmb3JtKCJ2T3BhY2l0eUluZm9zIiwyKSxlLmFkZFVuaWZvcm0oInZSZWZsZWN0aW9uSW5mb3MiLDIpLGUuYWRkVW5pZm9ybSgidlJlZmxlY3Rpb25Qb3NpdGlvbiIsMyksZS5hZGRVbmlmb3JtKCJ2UmVmbGVjdGlvblNpemUiLDMpLGUuYWRkVW5pZm9ybSgidkVtaXNzaXZlSW5mb3MiLDIpLGUuYWRkVW5pZm9ybSgidkxpZ2h0bWFwSW5mb3MiLDIpLGUuYWRkVW5pZm9ybSgidlNwZWN1bGFySW5mb3MiLDIpLGUuYWRkVW5pZm9ybSgidkJ1bXBJbmZvcyIsMyksZS5hZGRVbmlmb3JtKCJkaWZmdXNlTWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJhbWJpZW50TWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJvcGFjaXR5TWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJyZWZsZWN0aW9uTWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJlbWlzc2l2ZU1hdHJpeCIsMTYpLGUuYWRkVW5pZm9ybSgibGlnaHRtYXBNYXRyaXgiLDE2KSxlLmFkZFVuaWZvcm0oInNwZWN1bGFyTWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJidW1wTWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJ2VGFuZ2VudFNwYWNlUGFyYW1zIiwyKSxlLmFkZFVuaWZvcm0oInBvaW50U2l6ZSIsMSksZS5hZGRVbmlmb3JtKCJhbHBoYUN1dE9mZiIsMSksZS5hZGRVbmlmb3JtKCJyZWZyYWN0aW9uTWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJ2UmVmcmFjdGlvbkluZm9zIiw0KSxlLmFkZFVuaWZvcm0oInZSZWZyYWN0aW9uUG9zaXRpb24iLDMpLGUuYWRkVW5pZm9ybSgidlJlZnJhY3Rpb25TaXplIiwzKSxlLmFkZFVuaWZvcm0oInZTcGVjdWxhckNvbG9yIiw0KSxlLmFkZFVuaWZvcm0oInZFbWlzc2l2ZUNvbG9yIiwzKSxlLmFkZFVuaWZvcm0oInZEaWZmdXNlQ29sb3IiLDQpLGUuYWRkVW5pZm9ybSgidkFtYmllbnRDb2xvciIsMyksc3VwZXIuYnVpbGRVbmlmb3JtTGF5b3V0KCl9YmluZEZvclN1Yk1lc2goZSx0LGkpe3ZhciBzO2NvbnN0IHI9dGhpcy5nZXRTY2VuZSgpLG49aS5tYXRlcmlhbERlZmluZXM7aWYoIW4pcmV0dXJuO2NvbnN0IGE9aS5lZmZlY3Q7aWYoIWEpcmV0dXJuO3RoaXMuX2FjdGl2ZUVmZmVjdD1hLHQuZ2V0TWVzaFVuaWZvcm1CdWZmZXIoKS5iaW5kVG9FZmZlY3QoYSwiTWVzaCIpLHQudHJhbnNmZXJUb0VmZmVjdChlKSx0aGlzLl91bmlmb3JtQnVmZmVyLmJpbmRUb0VmZmVjdChhLCJNYXRlcmlhbCIpLHRoaXMucHJlUGFzc0NvbmZpZ3VyYXRpb24uYmluZEZvclN1Yk1lc2godGhpcy5fYWN0aXZlRWZmZWN0LHIsdCxlLHRoaXMuaXNGcm96ZW4pLHRoaXMuX2V2ZW50SW5mby5zdWJNZXNoPWksdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudEhhcmRCaW5kRm9yU3ViTWVzaCh0aGlzLl9ldmVudEluZm8pLG4uT0JKRUNUU1BBQ0VfTk9STUFMTUFQJiYoZS50b05vcm1hbE1hdHJpeCh0aGlzLl9ub3JtYWxNYXRyaXgpLHRoaXMuYmluZE9ubHlOb3JtYWxNYXRyaXgodGhpcy5fbm9ybWFsTWF0cml4KSk7Y29uc3Qgbz1hLl9mb3JjZVJlYmluZE9uTmV4dENhbGx8fHRoaXMuX211c3RSZWJpbmQocixhLHQudmlzaWJpbGl0eSk7aWUuQmluZEJvbmVzUGFyYW1ldGVycyh0LGEpO2NvbnN0IGg9dGhpcy5fdW5pZm9ybUJ1ZmZlcjtpZihvKXtpZih0aGlzLmJpbmRWaWV3UHJvamVjdGlvbihhKSwhaC51c2VVYm98fCF0aGlzLmlzRnJvemVufHwhaC5pc1N5bmN8fGEuX2ZvcmNlUmViaW5kT25OZXh0Q2FsbCl7aWYoQi5GcmVzbmVsRW5hYmxlZCYmbi5GUkVTTkVMJiYodGhpcy5kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuZGlmZnVzZUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKGgudXBkYXRlQ29sb3I0KCJkaWZmdXNlTGVmdENvbG9yIix0aGlzLmRpZmZ1c2VGcmVzbmVsUGFyYW1ldGVycy5sZWZ0Q29sb3IsdGhpcy5kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMucG93ZXIpLGgudXBkYXRlQ29sb3I0KCJkaWZmdXNlUmlnaHRDb2xvciIsdGhpcy5kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMucmlnaHRDb2xvcix0aGlzLmRpZmZ1c2VGcmVzbmVsUGFyYW1ldGVycy5iaWFzKSksdGhpcy5vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMmJnRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmaC51cGRhdGVDb2xvcjQoIm9wYWNpdHlQYXJ0cyIsbmV3IHJlKHRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLmxlZnRDb2xvci50b0x1bWluYW5jZSgpLHRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLnJpZ2h0Q29sb3IudG9MdW1pbmFuY2UoKSx0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5iaWFzKSx0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5wb3dlciksdGhpcy5yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMucmVmbGVjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKGgudXBkYXRlQ29sb3I0KCJyZWZsZWN0aW9uTGVmdENvbG9yIix0aGlzLnJlZmxlY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5sZWZ0Q29sb3IsdGhpcy5yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMucG93ZXIpLGgudXBkYXRlQ29sb3I0KCJyZWZsZWN0aW9uUmlnaHRDb2xvciIsdGhpcy5yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMucmlnaHRDb2xvcix0aGlzLnJlZmxlY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5iaWFzKSksdGhpcy5yZWZyYWN0aW9uRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMucmVmcmFjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKGgudXBkYXRlQ29sb3I0KCJyZWZyYWN0aW9uTGVmdENvbG9yIix0aGlzLnJlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5sZWZ0Q29sb3IsdGhpcy5yZWZyYWN0aW9uRnJlc25lbFBhcmFtZXRlcnMucG93ZXIpLGgudXBkYXRlQ29sb3I0KCJyZWZyYWN0aW9uUmlnaHRDb2xvciIsdGhpcy5yZWZyYWN0aW9uRnJlc25lbFBhcmFtZXRlcnMucmlnaHRDb2xvcix0aGlzLnJlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5iaWFzKSksdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzJiZ0aGlzLmVtaXNzaXZlRnJlc25lbFBhcmFtZXRlcnMuaXNFbmFibGVkJiYoaC51cGRhdGVDb2xvcjQoImVtaXNzaXZlTGVmdENvbG9yIix0aGlzLmVtaXNzaXZlRnJlc25lbFBhcmFtZXRlcnMubGVmdENvbG9yLHRoaXMuZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycy5wb3dlciksaC51cGRhdGVDb2xvcjQoImVtaXNzaXZlUmlnaHRDb2xvciIsdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLnJpZ2h0Q29sb3IsdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLmJpYXMpKSksci50ZXh0dXJlc0VuYWJsZWQpe2lmKHRoaXMuX2RpZmZ1c2VUZXh0dXJlJiZCLkRpZmZ1c2VUZXh0dXJlRW5hYmxlZCYmKGgudXBkYXRlRmxvYXQyKCJ2RGlmZnVzZUluZm9zIix0aGlzLl9kaWZmdXNlVGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMuX2RpZmZ1c2VUZXh0dXJlLmxldmVsKSxpZS5CaW5kVGV4dHVyZU1hdHJpeCh0aGlzLl9kaWZmdXNlVGV4dHVyZSxoLCJkaWZmdXNlIikpLHRoaXMuX2FtYmllbnRUZXh0dXJlJiZCLkFtYmllbnRUZXh0dXJlRW5hYmxlZCYmKGgudXBkYXRlRmxvYXQyKCJ2QW1iaWVudEluZm9zIix0aGlzLl9hbWJpZW50VGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMuX2FtYmllbnRUZXh0dXJlLmxldmVsKSxpZS5CaW5kVGV4dHVyZU1hdHJpeCh0aGlzLl9hbWJpZW50VGV4dHVyZSxoLCJhbWJpZW50IikpLHRoaXMuX29wYWNpdHlUZXh0dXJlJiZCLk9wYWNpdHlUZXh0dXJlRW5hYmxlZCYmKGgudXBkYXRlRmxvYXQyKCJ2T3BhY2l0eUluZm9zIix0aGlzLl9vcGFjaXR5VGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMuX29wYWNpdHlUZXh0dXJlLmxldmVsKSxpZS5CaW5kVGV4dHVyZU1hdHJpeCh0aGlzLl9vcGFjaXR5VGV4dHVyZSxoLCJvcGFjaXR5IikpLHRoaXMuX2hhc0FscGhhQ2hhbm5lbCgpJiZoLnVwZGF0ZUZsb2F0KCJhbHBoYUN1dE9mZiIsdGhpcy5hbHBoYUN1dE9mZiksdGhpcy5fcmVmbGVjdGlvblRleHR1cmUmJkIuUmVmbGVjdGlvblRleHR1cmVFbmFibGVkJiYoaC51cGRhdGVGbG9hdDIoInZSZWZsZWN0aW9uSW5mb3MiLHRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlLmxldmVsLHRoaXMucm91Z2huZXNzKSxoLnVwZGF0ZU1hdHJpeCgicmVmbGVjdGlvbk1hdHJpeCIsdGhpcy5fcmVmbGVjdGlvblRleHR1cmUuZ2V0UmVmbGVjdGlvblRleHR1cmVNYXRyaXgoKSksdGhpcy5fcmVmbGVjdGlvblRleHR1cmUuYm91bmRpbmdCb3hTaXplKSl7Y29uc3QgbD10aGlzLl9yZWZsZWN0aW9uVGV4dHVyZTtoLnVwZGF0ZVZlY3RvcjMoInZSZWZsZWN0aW9uUG9zaXRpb24iLGwuYm91bmRpbmdCb3hQb3NpdGlvbiksaC51cGRhdGVWZWN0b3IzKCJ2UmVmbGVjdGlvblNpemUiLGwuYm91bmRpbmdCb3hTaXplKX1pZih0aGlzLl9lbWlzc2l2ZVRleHR1cmUmJkIuRW1pc3NpdmVUZXh0dXJlRW5hYmxlZCYmKGgudXBkYXRlRmxvYXQyKCJ2RW1pc3NpdmVJbmZvcyIsdGhpcy5fZW1pc3NpdmVUZXh0dXJlLmNvb3JkaW5hdGVzSW5kZXgsdGhpcy5fZW1pc3NpdmVUZXh0dXJlLmxldmVsKSxpZS5CaW5kVGV4dHVyZU1hdHJpeCh0aGlzLl9lbWlzc2l2ZVRleHR1cmUsaCwiZW1pc3NpdmUiKSksdGhpcy5fbGlnaHRtYXBUZXh0dXJlJiZCLkxpZ2h0bWFwVGV4dHVyZUVuYWJsZWQmJihoLnVwZGF0ZUZsb2F0MigidkxpZ2h0bWFwSW5mb3MiLHRoaXMuX2xpZ2h0bWFwVGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMuX2xpZ2h0bWFwVGV4dHVyZS5sZXZlbCksaWUuQmluZFRleHR1cmVNYXRyaXgodGhpcy5fbGlnaHRtYXBUZXh0dXJlLGgsImxpZ2h0bWFwIikpLHRoaXMuX3NwZWN1bGFyVGV4dHVyZSYmQi5TcGVjdWxhclRleHR1cmVFbmFibGVkJiYoaC51cGRhdGVGbG9hdDIoInZTcGVjdWxhckluZm9zIix0aGlzLl9zcGVjdWxhclRleHR1cmUuY29vcmRpbmF0ZXNJbmRleCx0aGlzLl9zcGVjdWxhclRleHR1cmUubGV2ZWwpLGllLkJpbmRUZXh0dXJlTWF0cml4KHRoaXMuX3NwZWN1bGFyVGV4dHVyZSxoLCJzcGVjdWxhciIpKSx0aGlzLl9idW1wVGV4dHVyZSYmci5nZXRFbmdpbmUoKS5nZXRDYXBzKCkuc3RhbmRhcmREZXJpdmF0aXZlcyYmQi5CdW1wVGV4dHVyZUVuYWJsZWQmJihoLnVwZGF0ZUZsb2F0MygidkJ1bXBJbmZvcyIsdGhpcy5fYnVtcFRleHR1cmUuY29vcmRpbmF0ZXNJbmRleCwxL3RoaXMuX2J1bXBUZXh0dXJlLmxldmVsLHRoaXMucGFyYWxsYXhTY2FsZUJpYXMpLGllLkJpbmRUZXh0dXJlTWF0cml4KHRoaXMuX2J1bXBUZXh0dXJlLGgsImJ1bXAiKSxyLl9taXJyb3JlZENhbWVyYVBvc2l0aW9uP2gudXBkYXRlRmxvYXQyKCJ2VGFuZ2VudFNwYWNlUGFyYW1zIix0aGlzLl9pbnZlcnROb3JtYWxNYXBYPzE6LTEsdGhpcy5faW52ZXJ0Tm9ybWFsTWFwWT8xOi0xKTpoLnVwZGF0ZUZsb2F0MigidlRhbmdlbnRTcGFjZVBhcmFtcyIsdGhpcy5faW52ZXJ0Tm9ybWFsTWFwWD8tMToxLHRoaXMuX2ludmVydE5vcm1hbE1hcFk/LTE6MSkpLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlJiZCLlJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZCl7bGV0IGw9MTtpZih0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZS5pc0N1YmV8fChoLnVwZGF0ZU1hdHJpeCgicmVmcmFjdGlvbk1hdHJpeCIsdGhpcy5fcmVmcmFjdGlvblRleHR1cmUuZ2V0UmVmbGVjdGlvblRleHR1cmVNYXRyaXgoKSksdGhpcy5fcmVmcmFjdGlvblRleHR1cmUuZGVwdGgmJihsPXRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlLmRlcHRoKSksaC51cGRhdGVGbG9hdDQoInZSZWZyYWN0aW9uSW5mb3MiLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlLmxldmVsLHRoaXMuaW5kZXhPZlJlZnJhY3Rpb24sbCx0aGlzLmludmVydFJlZnJhY3Rpb25ZPy0xOjEpLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlLmJvdW5kaW5nQm94U2l6ZSl7Y29uc3QgdT10aGlzLl9yZWZyYWN0aW9uVGV4dHVyZTtoLnVwZGF0ZVZlY3RvcjMoInZSZWZyYWN0aW9uUG9zaXRpb24iLHUuYm91bmRpbmdCb3hQb3NpdGlvbiksaC51cGRhdGVWZWN0b3IzKCJ2UmVmcmFjdGlvblNpemUiLHUuYm91bmRpbmdCb3hTaXplKX19fXRoaXMucG9pbnRzQ2xvdWQmJmgudXBkYXRlRmxvYXQoInBvaW50U2l6ZSIsdGhpcy5wb2ludFNpemUpLG4uU1BFQ1VMQVJURVJNJiZoLnVwZGF0ZUNvbG9yNCgidlNwZWN1bGFyQ29sb3IiLHRoaXMuc3BlY3VsYXJDb2xvcix0aGlzLnNwZWN1bGFyUG93ZXIpLGgudXBkYXRlQ29sb3IzKCJ2RW1pc3NpdmVDb2xvciIsQi5FbWlzc2l2ZVRleHR1cmVFbmFibGVkP3RoaXMuZW1pc3NpdmVDb2xvcjpyZS5CbGFja1JlYWRPbmx5KSxoLnVwZGF0ZUNvbG9yNCgidkRpZmZ1c2VDb2xvciIsdGhpcy5kaWZmdXNlQ29sb3IsdGhpcy5hbHBoYSksci5hbWJpZW50Q29sb3IubXVsdGlwbHlUb1JlZih0aGlzLmFtYmllbnRDb2xvcix0aGlzLl9nbG9iYWxBbWJpZW50Q29sb3IpLGgudXBkYXRlQ29sb3IzKCJ2QW1iaWVudENvbG9yIix0aGlzLl9nbG9iYWxBbWJpZW50Q29sb3IpfXIudGV4dHVyZXNFbmFibGVkJiYodGhpcy5fZGlmZnVzZVRleHR1cmUmJkIuRGlmZnVzZVRleHR1cmVFbmFibGVkJiZhLnNldFRleHR1cmUoImRpZmZ1c2VTYW1wbGVyIix0aGlzLl9kaWZmdXNlVGV4dHVyZSksdGhpcy5fYW1iaWVudFRleHR1cmUmJkIuQW1iaWVudFRleHR1cmVFbmFibGVkJiZhLnNldFRleHR1cmUoImFtYmllbnRTYW1wbGVyIix0aGlzLl9hbWJpZW50VGV4dHVyZSksdGhpcy5fb3BhY2l0eVRleHR1cmUmJkIuT3BhY2l0eVRleHR1cmVFbmFibGVkJiZhLnNldFRleHR1cmUoIm9wYWNpdHlTYW1wbGVyIix0aGlzLl9vcGFjaXR5VGV4dHVyZSksdGhpcy5fcmVmbGVjdGlvblRleHR1cmUmJkIuUmVmbGVjdGlvblRleHR1cmVFbmFibGVkJiYodGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaXNDdWJlP2Euc2V0VGV4dHVyZSgicmVmbGVjdGlvbkN1YmVTYW1wbGVyIix0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSk6YS5zZXRUZXh0dXJlKCJyZWZsZWN0aW9uMkRTYW1wbGVyIix0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSkpLHRoaXMuX2VtaXNzaXZlVGV4dHVyZSYmQi5FbWlzc2l2ZVRleHR1cmVFbmFibGVkJiZhLnNldFRleHR1cmUoImVtaXNzaXZlU2FtcGxlciIsdGhpcy5fZW1pc3NpdmVUZXh0dXJlKSx0aGlzLl9saWdodG1hcFRleHR1cmUmJkIuTGlnaHRtYXBUZXh0dXJlRW5hYmxlZCYmYS5zZXRUZXh0dXJlKCJsaWdodG1hcFNhbXBsZXIiLHRoaXMuX2xpZ2h0bWFwVGV4dHVyZSksdGhpcy5fc3BlY3VsYXJUZXh0dXJlJiZCLlNwZWN1bGFyVGV4dHVyZUVuYWJsZWQmJmEuc2V0VGV4dHVyZSgic3BlY3VsYXJTYW1wbGVyIix0aGlzLl9zcGVjdWxhclRleHR1cmUpLHRoaXMuX2J1bXBUZXh0dXJlJiZyLmdldEVuZ2luZSgpLmdldENhcHMoKS5zdGFuZGFyZERlcml2YXRpdmVzJiZCLkJ1bXBUZXh0dXJlRW5hYmxlZCYmYS5zZXRUZXh0dXJlKCJidW1wU2FtcGxlciIsdGhpcy5fYnVtcFRleHR1cmUpLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlJiZCLlJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZCYmKHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlLmlzQ3ViZT9hLnNldFRleHR1cmUoInJlZnJhY3Rpb25DdWJlU2FtcGxlciIsdGhpcy5fcmVmcmFjdGlvblRleHR1cmUpOmEuc2V0VGV4dHVyZSgicmVmcmFjdGlvbjJEU2FtcGxlciIsdGhpcy5fcmVmcmFjdGlvblRleHR1cmUpKSksdGhpcy5nZXRTY2VuZSgpLnVzZU9yZGVySW5kZXBlbmRlbnRUcmFuc3BhcmVuY3kmJnRoaXMubmVlZEFscGhhQmxlbmRpbmdGb3JNZXNoKHQpJiZ0aGlzLmdldFNjZW5lKCkuZGVwdGhQZWVsaW5nUmVuZGVyZXIuYmluZChhKSx0aGlzLl9ldmVudEluZm8uc3ViTWVzaD1pLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRCaW5kRm9yU3ViTWVzaCh0aGlzLl9ldmVudEluZm8pLHJzKGEsdGhpcyxyKSx0aGlzLmJpbmRFeWVQb3NpdGlvbihhKX1lbHNlIHIuZ2V0RW5naW5lKCkuX2ZlYXR1cmVzLm5lZWRUb0Fsd2F5c0JpbmRVbmlmb3JtQnVmZmVycyYmKHRoaXMuX25lZWRUb0JpbmRTY2VuZVVibz0hMCk7KG98fCF0aGlzLmlzRnJvemVuKSYmKHIubGlnaHRzRW5hYmxlZCYmIXRoaXMuX2Rpc2FibGVMaWdodGluZyYmaWUuQmluZExpZ2h0cyhyLHQsYSxuLHRoaXMuX21heFNpbXVsdGFuZW91c0xpZ2h0cyksKHIuZm9nRW5hYmxlZCYmdC5hcHBseUZvZyYmci5mb2dNb2RlIT09bmUuRk9HTU9ERV9OT05FfHx0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZXx8dGhpcy5fcmVmcmFjdGlvblRleHR1cmV8fHQucmVjZWl2ZVNoYWRvd3N8fG4uUFJFUEFTUykmJnRoaXMuYmluZFZpZXcoYSksaWUuQmluZEZvZ1BhcmFtZXRlcnMocix0LGEpLG4uTlVNX01PUlBIX0lORkxVRU5DRVJTJiZpZS5CaW5kTW9ycGhUYXJnZXRQYXJhbWV0ZXJzKHQsYSksbi5CQUtFRF9WRVJURVhfQU5JTUFUSU9OX1RFWFRVUkUmJigocz10LmJha2VkVmVydGV4QW5pbWF0aW9uTWFuYWdlcik9PT1udWxsfHxzPT09dm9pZCAwfHxzLmJpbmQoYSxuLklOU1RBTkNFUykpLHRoaXMudXNlTG9nYXJpdGhtaWNEZXB0aCYmaWUuQmluZExvZ0RlcHRoKG4sYSxyKSx0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uJiYhdGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5hcHBseUJ5UG9zdFByb2Nlc3MmJnRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24uYmluZCh0aGlzLl9hY3RpdmVFZmZlY3QpKSx0aGlzLl9hZnRlckJpbmQodCx0aGlzLl9hY3RpdmVFZmZlY3QpLGgudXBkYXRlKCl9Z2V0QW5pbWF0YWJsZXMoKXtjb25zdCBlPXN1cGVyLmdldEFuaW1hdGFibGVzKCk7cmV0dXJuIHRoaXMuX2RpZmZ1c2VUZXh0dXJlJiZ0aGlzLl9kaWZmdXNlVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9kaWZmdXNlVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fZGlmZnVzZVRleHR1cmUpLHRoaXMuX2FtYmllbnRUZXh0dXJlJiZ0aGlzLl9hbWJpZW50VGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9hbWJpZW50VGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fYW1iaWVudFRleHR1cmUpLHRoaXMuX29wYWNpdHlUZXh0dXJlJiZ0aGlzLl9vcGFjaXR5VGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9vcGFjaXR5VGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fb3BhY2l0eVRleHR1cmUpLHRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlJiZ0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fcmVmbGVjdGlvblRleHR1cmUpLHRoaXMuX2VtaXNzaXZlVGV4dHVyZSYmdGhpcy5fZW1pc3NpdmVUZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMuX2VtaXNzaXZlVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fZW1pc3NpdmVUZXh0dXJlKSx0aGlzLl9zcGVjdWxhclRleHR1cmUmJnRoaXMuX3NwZWN1bGFyVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9zcGVjdWxhclRleHR1cmUuYW5pbWF0aW9ucy5sZW5ndGg+MCYmZS5wdXNoKHRoaXMuX3NwZWN1bGFyVGV4dHVyZSksdGhpcy5fYnVtcFRleHR1cmUmJnRoaXMuX2J1bXBUZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMuX2J1bXBUZXh0dXJlLmFuaW1hdGlvbnMubGVuZ3RoPjAmJmUucHVzaCh0aGlzLl9idW1wVGV4dHVyZSksdGhpcy5fbGlnaHRtYXBUZXh0dXJlJiZ0aGlzLl9saWdodG1hcFRleHR1cmUuYW5pbWF0aW9ucyYmdGhpcy5fbGlnaHRtYXBUZXh0dXJlLmFuaW1hdGlvbnMubGVuZ3RoPjAmJmUucHVzaCh0aGlzLl9saWdodG1hcFRleHR1cmUpLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlJiZ0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fcmVmcmFjdGlvblRleHR1cmUpLGV9Z2V0QWN0aXZlVGV4dHVyZXMoKXtjb25zdCBlPXN1cGVyLmdldEFjdGl2ZVRleHR1cmVzKCk7cmV0dXJuIHRoaXMuX2RpZmZ1c2VUZXh0dXJlJiZlLnB1c2godGhpcy5fZGlmZnVzZVRleHR1cmUpLHRoaXMuX2FtYmllbnRUZXh0dXJlJiZlLnB1c2godGhpcy5fYW1iaWVudFRleHR1cmUpLHRoaXMuX29wYWNpdHlUZXh0dXJlJiZlLnB1c2godGhpcy5fb3BhY2l0eVRleHR1cmUpLHRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlJiZlLnB1c2godGhpcy5fcmVmbGVjdGlvblRleHR1cmUpLHRoaXMuX2VtaXNzaXZlVGV4dHVyZSYmZS5wdXNoKHRoaXMuX2VtaXNzaXZlVGV4dHVyZSksdGhpcy5fc3BlY3VsYXJUZXh0dXJlJiZlLnB1c2godGhpcy5fc3BlY3VsYXJUZXh0dXJlKSx0aGlzLl9idW1wVGV4dHVyZSYmZS5wdXNoKHRoaXMuX2J1bXBUZXh0dXJlKSx0aGlzLl9saWdodG1hcFRleHR1cmUmJmUucHVzaCh0aGlzLl9saWdodG1hcFRleHR1cmUpLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlJiZlLnB1c2godGhpcy5fcmVmcmFjdGlvblRleHR1cmUpLGV9aGFzVGV4dHVyZShlKXtyZXR1cm4hIShzdXBlci5oYXNUZXh0dXJlKGUpfHx0aGlzLl9kaWZmdXNlVGV4dHVyZT09PWV8fHRoaXMuX2FtYmllbnRUZXh0dXJlPT09ZXx8dGhpcy5fb3BhY2l0eVRleHR1cmU9PT1lfHx0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZT09PWV8fHRoaXMuX2VtaXNzaXZlVGV4dHVyZT09PWV8fHRoaXMuX3NwZWN1bGFyVGV4dHVyZT09PWV8fHRoaXMuX2J1bXBUZXh0dXJlPT09ZXx8dGhpcy5fbGlnaHRtYXBUZXh0dXJlPT09ZXx8dGhpcy5fcmVmcmFjdGlvblRleHR1cmU9PT1lKX1kaXNwb3NlKGUsdCl7dmFyIGkscyxyLG4sYSxvLGgsbCx1O3QmJigoaT10aGlzLl9kaWZmdXNlVGV4dHVyZSk9PT1udWxsfHxpPT09dm9pZCAwfHxpLmRpc3Bvc2UoKSwocz10aGlzLl9hbWJpZW50VGV4dHVyZSk9PT1udWxsfHxzPT09dm9pZCAwfHxzLmRpc3Bvc2UoKSwocj10aGlzLl9vcGFjaXR5VGV4dHVyZSk9PT1udWxsfHxyPT09dm9pZCAwfHxyLmRpc3Bvc2UoKSwobj10aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSk9PT1udWxsfHxuPT09dm9pZCAwfHxuLmRpc3Bvc2UoKSwoYT10aGlzLl9lbWlzc2l2ZVRleHR1cmUpPT09bnVsbHx8YT09PXZvaWQgMHx8YS5kaXNwb3NlKCksKG89dGhpcy5fc3BlY3VsYXJUZXh0dXJlKT09PW51bGx8fG89PT12b2lkIDB8fG8uZGlzcG9zZSgpLChoPXRoaXMuX2J1bXBUZXh0dXJlKT09PW51bGx8fGg9PT12b2lkIDB8fGguZGlzcG9zZSgpLChsPXRoaXMuX2xpZ2h0bWFwVGV4dHVyZSk9PT1udWxsfHxsPT09dm9pZCAwfHxsLmRpc3Bvc2UoKSwodT10aGlzLl9yZWZyYWN0aW9uVGV4dHVyZSk9PT1udWxsfHx1PT09dm9pZCAwfHx1LmRpc3Bvc2UoKSksdGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbiYmdGhpcy5faW1hZ2VQcm9jZXNzaW5nT2JzZXJ2ZXImJnRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24ub25VcGRhdGVQYXJhbWV0ZXJzLnJlbW92ZSh0aGlzLl9pbWFnZVByb2Nlc3NpbmdPYnNlcnZlciksc3VwZXIuZGlzcG9zZShlLHQpfWNsb25lKGUpe2NvbnN0IHQ9YWUuQ2xvbmUoKCk9Pm5ldyBCKGUsdGhpcy5nZXRTY2VuZSgpKSx0aGlzKTtyZXR1cm4gdC5uYW1lPWUsdC5pZD1lLHRoaXMuc3RlbmNpbC5jb3B5VG8odC5zdGVuY2lsKSx0fXN0YXRpYyBQYXJzZShlLHQsaSl7Y29uc3Qgcz1hZS5QYXJzZSgoKT0+bmV3IEIoZS5uYW1lLHQpLGUsdCxpKTtyZXR1cm4gZS5zdGVuY2lsJiZzLnN0ZW5jaWwucGFyc2UoZS5zdGVuY2lsLHQsaSksc31zdGF0aWMgZ2V0IERpZmZ1c2VUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB1ZS5EaWZmdXNlVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBEaWZmdXNlVGV4dHVyZUVuYWJsZWQoZSl7dWUuRGlmZnVzZVRleHR1cmVFbmFibGVkPWV9c3RhdGljIGdldCBEZXRhaWxUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB1ZS5EZXRhaWxUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IERldGFpbFRleHR1cmVFbmFibGVkKGUpe3VlLkRldGFpbFRleHR1cmVFbmFibGVkPWV9c3RhdGljIGdldCBBbWJpZW50VGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdWUuQW1iaWVudFRleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgQW1iaWVudFRleHR1cmVFbmFibGVkKGUpe3VlLkFtYmllbnRUZXh0dXJlRW5hYmxlZD1lfXN0YXRpYyBnZXQgT3BhY2l0eVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHVlLk9wYWNpdHlUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IE9wYWNpdHlUZXh0dXJlRW5hYmxlZChlKXt1ZS5PcGFjaXR5VGV4dHVyZUVuYWJsZWQ9ZX1zdGF0aWMgZ2V0IFJlZmxlY3Rpb25UZXh0dXJlRW5hYmxlZCgpe3JldHVybiB1ZS5SZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBSZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWQoZSl7dWUuUmVmbGVjdGlvblRleHR1cmVFbmFibGVkPWV9c3RhdGljIGdldCBFbWlzc2l2ZVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHVlLkVtaXNzaXZlVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBFbWlzc2l2ZVRleHR1cmVFbmFibGVkKGUpe3VlLkVtaXNzaXZlVGV4dHVyZUVuYWJsZWQ9ZX1zdGF0aWMgZ2V0IFNwZWN1bGFyVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdWUuU3BlY3VsYXJUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IFNwZWN1bGFyVGV4dHVyZUVuYWJsZWQoZSl7dWUuU3BlY3VsYXJUZXh0dXJlRW5hYmxlZD1lfXN0YXRpYyBnZXQgQnVtcFRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHVlLkJ1bXBUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IEJ1bXBUZXh0dXJlRW5hYmxlZChlKXt1ZS5CdW1wVGV4dHVyZUVuYWJsZWQ9ZX1zdGF0aWMgZ2V0IExpZ2h0bWFwVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdWUuTGlnaHRtYXBUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IExpZ2h0bWFwVGV4dHVyZUVuYWJsZWQoZSl7dWUuTGlnaHRtYXBUZXh0dXJlRW5hYmxlZD1lfXN0YXRpYyBnZXQgUmVmcmFjdGlvblRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHVlLlJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IFJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZChlKXt1ZS5SZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWQ9ZX1zdGF0aWMgZ2V0IENvbG9yR3JhZGluZ1RleHR1cmVFbmFibGVkKCl7cmV0dXJuIHVlLkNvbG9yR3JhZGluZ1RleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgQ29sb3JHcmFkaW5nVGV4dHVyZUVuYWJsZWQoZSl7dWUuQ29sb3JHcmFkaW5nVGV4dHVyZUVuYWJsZWQ9ZX1zdGF0aWMgZ2V0IEZyZXNuZWxFbmFibGVkKCl7cmV0dXJuIHVlLkZyZXNuZWxFbmFibGVkfXN0YXRpYyBzZXQgRnJlc25lbEVuYWJsZWQoZSl7dWUuRnJlc25lbEVuYWJsZWQ9ZX19VChbbXQoImRpZmZ1c2VUZXh0dXJlIildLEIucHJvdG90eXBlLCJfZGlmZnVzZVRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0FuZE1pc2NEaXJ0eSIpXSxCLnByb3RvdHlwZSwiZGlmZnVzZVRleHR1cmUiLHZvaWQgMCksVChbbXQoImFtYmllbnRUZXh0dXJlIildLEIucHJvdG90eXBlLCJfYW1iaWVudFRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJhbWJpZW50VGV4dHVyZSIsdm9pZCAwKSxUKFttdCgib3BhY2l0eVRleHR1cmUiKV0sQi5wcm90b3R5cGUsIl9vcGFjaXR5VGV4dHVyZSIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzQW5kTWlzY0RpcnR5IildLEIucHJvdG90eXBlLCJvcGFjaXR5VGV4dHVyZSIsdm9pZCAwKSxUKFttdCgicmVmbGVjdGlvblRleHR1cmUiKV0sQi5wcm90b3R5cGUsIl9yZWZsZWN0aW9uVGV4dHVyZSIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0sQi5wcm90b3R5cGUsInJlZmxlY3Rpb25UZXh0dXJlIix2b2lkIDApLFQoW210KCJlbWlzc2l2ZVRleHR1cmUiKV0sQi5wcm90b3R5cGUsIl9lbWlzc2l2ZVRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJlbWlzc2l2ZVRleHR1cmUiLHZvaWQgMCksVChbbXQoInNwZWN1bGFyVGV4dHVyZSIpXSxCLnByb3RvdHlwZSwiX3NwZWN1bGFyVGV4dHVyZSIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0sQi5wcm90b3R5cGUsInNwZWN1bGFyVGV4dHVyZSIsdm9pZCAwKSxUKFttdCgiYnVtcFRleHR1cmUiKV0sQi5wcm90b3R5cGUsIl9idW1wVGV4dHVyZSIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0sQi5wcm90b3R5cGUsImJ1bXBUZXh0dXJlIix2b2lkIDApLFQoW210KCJsaWdodG1hcFRleHR1cmUiKV0sQi5wcm90b3R5cGUsIl9saWdodG1hcFRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJsaWdodG1hcFRleHR1cmUiLHZvaWQgMCksVChbbXQoInJlZnJhY3Rpb25UZXh0dXJlIildLEIucHJvdG90eXBlLCJfcmVmcmFjdGlvblRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJyZWZyYWN0aW9uVGV4dHVyZSIsdm9pZCAwKSxUKFtjaSgiYW1iaWVudCIpXSxCLnByb3RvdHlwZSwiYW1iaWVudENvbG9yIix2b2lkIDApLFQoW2NpKCJkaWZmdXNlIildLEIucHJvdG90eXBlLCJkaWZmdXNlQ29sb3IiLHZvaWQgMCksVChbY2koInNwZWN1bGFyIildLEIucHJvdG90eXBlLCJzcGVjdWxhckNvbG9yIix2b2lkIDApLFQoW2NpKCJlbWlzc2l2ZSIpXSxCLnByb3RvdHlwZSwiZW1pc3NpdmVDb2xvciIsdm9pZCAwKSxUKFtSKCldLEIucHJvdG90eXBlLCJzcGVjdWxhclBvd2VyIix2b2lkIDApLFQoW1IoInVzZUFscGhhRnJvbURpZmZ1c2VUZXh0dXJlIildLEIucHJvdG90eXBlLCJfdXNlQWxwaGFGcm9tRGlmZnVzZVRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0FuZE1pc2NEaXJ0eSIpXSxCLnByb3RvdHlwZSwidXNlQWxwaGFGcm9tRGlmZnVzZVRleHR1cmUiLHZvaWQgMCksVChbUigidXNlRW1pc3NpdmVBc0lsbHVtaW5hdGlvbiIpXSxCLnByb3RvdHlwZSwiX3VzZUVtaXNzaXZlQXNJbGx1bWluYXRpb24iLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJ1c2VFbWlzc2l2ZUFzSWxsdW1pbmF0aW9uIix2b2lkIDApLFQoW1IoImxpbmtFbWlzc2l2ZVdpdGhEaWZmdXNlIildLEIucHJvdG90eXBlLCJfbGlua0VtaXNzaXZlV2l0aERpZmZ1c2UiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJsaW5rRW1pc3NpdmVXaXRoRGlmZnVzZSIsdm9pZCAwKSxUKFtSKCJ1c2VTcGVjdWxhck92ZXJBbHBoYSIpXSxCLnByb3RvdHlwZSwiX3VzZVNwZWN1bGFyT3ZlckFscGhhIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSIpXSxCLnByb3RvdHlwZSwidXNlU3BlY3VsYXJPdmVyQWxwaGEiLHZvaWQgMCksVChbUigidXNlUmVmbGVjdGlvbk92ZXJBbHBoYSIpXSxCLnByb3RvdHlwZSwiX3VzZVJlZmxlY3Rpb25PdmVyQWxwaGEiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJ1c2VSZWZsZWN0aW9uT3ZlckFscGhhIix2b2lkIDApLFQoW1IoImRpc2FibGVMaWdodGluZyIpXSxCLnByb3RvdHlwZSwiX2Rpc2FibGVMaWdodGluZyIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc0xpZ2h0c0RpcnR5IildLEIucHJvdG90eXBlLCJkaXNhYmxlTGlnaHRpbmciLHZvaWQgMCksVChbUigidXNlT2JqZWN0U3BhY2VOb3JtYWxNYXAiKV0sQi5wcm90b3R5cGUsIl91c2VPYmplY3RTcGFjZU5vcm1hbE1hcCIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0sQi5wcm90b3R5cGUsInVzZU9iamVjdFNwYWNlTm9ybWFsTWFwIix2b2lkIDApLFQoW1IoInVzZVBhcmFsbGF4IildLEIucHJvdG90eXBlLCJfdXNlUGFyYWxsYXgiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJ1c2VQYXJhbGxheCIsdm9pZCAwKSxUKFtSKCJ1c2VQYXJhbGxheE9jY2x1c2lvbiIpXSxCLnByb3RvdHlwZSwiX3VzZVBhcmFsbGF4T2NjbHVzaW9uIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSIpXSxCLnByb3RvdHlwZSwidXNlUGFyYWxsYXhPY2NsdXNpb24iLHZvaWQgMCksVChbUigpXSxCLnByb3RvdHlwZSwicGFyYWxsYXhTY2FsZUJpYXMiLHZvaWQgMCksVChbUigicm91Z2huZXNzIildLEIucHJvdG90eXBlLCJfcm91Z2huZXNzIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSIpXSxCLnByb3RvdHlwZSwicm91Z2huZXNzIix2b2lkIDApLFQoW1IoKV0sQi5wcm90b3R5cGUsImluZGV4T2ZSZWZyYWN0aW9uIix2b2lkIDApLFQoW1IoKV0sQi5wcm90b3R5cGUsImludmVydFJlZnJhY3Rpb25ZIix2b2lkIDApLFQoW1IoKV0sQi5wcm90b3R5cGUsImFscGhhQ3V0T2ZmIix2b2lkIDApLFQoW1IoInVzZUxpZ2h0bWFwQXNTaGFkb3dtYXAiKV0sQi5wcm90b3R5cGUsIl91c2VMaWdodG1hcEFzU2hhZG93bWFwIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSIpXSxCLnByb3RvdHlwZSwidXNlTGlnaHRtYXBBc1NoYWRvd21hcCIsdm9pZCAwKSxUKFtOaSgiZGlmZnVzZUZyZXNuZWxQYXJhbWV0ZXJzIildLEIucHJvdG90eXBlLCJfZGlmZnVzZUZyZXNuZWxQYXJhbWV0ZXJzIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzRnJlc25lbERpcnR5IildLEIucHJvdG90eXBlLCJkaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMiLHZvaWQgMCksVChbTmkoIm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycyIpXSxCLnByb3RvdHlwZSwiX29wYWNpdHlGcmVzbmVsUGFyYW1ldGVycyIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc0ZyZXNuZWxBbmRNaXNjRGlydHkiKV0sQi5wcm90b3R5cGUsIm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycyIsdm9pZCAwKSxUKFtOaSgicmVmbGVjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzIildLEIucHJvdG90eXBlLCJfcmVmbGVjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzRnJlc25lbERpcnR5IildLEIucHJvdG90eXBlLCJyZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMiLHZvaWQgMCksVChbTmkoInJlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycyIpXSxCLnByb3RvdHlwZSwiX3JlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycyIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc0ZyZXNuZWxEaXJ0eSIpXSxCLnByb3RvdHlwZSwicmVmcmFjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzIix2b2lkIDApLFQoW05pKCJlbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzIildLEIucHJvdG90eXBlLCJfZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycyIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc0ZyZXNuZWxEaXJ0eSIpXSxCLnByb3RvdHlwZSwiZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycyIsdm9pZCAwKSxUKFtSKCJ1c2VSZWZsZWN0aW9uRnJlc25lbEZyb21TcGVjdWxhciIpXSxCLnByb3RvdHlwZSwiX3VzZVJlZmxlY3Rpb25GcmVzbmVsRnJvbVNwZWN1bGFyIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzRnJlc25lbERpcnR5IildLEIucHJvdG90eXBlLCJ1c2VSZWZsZWN0aW9uRnJlc25lbEZyb21TcGVjdWxhciIsdm9pZCAwKSxUKFtSKCJ1c2VHbG9zc2luZXNzRnJvbVNwZWN1bGFyTWFwQWxwaGEiKV0sQi5wcm90b3R5cGUsIl91c2VHbG9zc2luZXNzRnJvbVNwZWN1bGFyTWFwQWxwaGEiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJ1c2VHbG9zc2luZXNzRnJvbVNwZWN1bGFyTWFwQWxwaGEiLHZvaWQgMCksVChbUigibWF4U2ltdWx0YW5lb3VzTGlnaHRzIildLEIucHJvdG90eXBlLCJfbWF4U2ltdWx0YW5lb3VzTGlnaHRzIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzTGlnaHRzRGlydHkiKV0sQi5wcm90b3R5cGUsIm1heFNpbXVsdGFuZW91c0xpZ2h0cyIsdm9pZCAwKSxUKFtSKCJpbnZlcnROb3JtYWxNYXBYIildLEIucHJvdG90eXBlLCJfaW52ZXJ0Tm9ybWFsTWFwWCIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0sQi5wcm90b3R5cGUsImludmVydE5vcm1hbE1hcFgiLHZvaWQgMCksVChbUigiaW52ZXJ0Tm9ybWFsTWFwWSIpXSxCLnByb3RvdHlwZSwiX2ludmVydE5vcm1hbE1hcFkiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJpbnZlcnROb3JtYWxNYXBZIix2b2lkIDApLFQoW1IoInR3b1NpZGVkTGlnaHRpbmciKV0sQi5wcm90b3R5cGUsIl90d29TaWRlZExpZ2h0aW5nIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSIpXSxCLnByb3RvdHlwZSwidHdvU2lkZWRMaWdodGluZyIsdm9pZCAwKSxUKFtSKCldLEIucHJvdG90eXBlLCJ1c2VMb2dhcml0aG1pY0RlcHRoIixudWxsKSxpdCgiQkFCWUxPTi5TdGFuZGFyZE1hdGVyaWFsIixCKSxuZS5EZWZhdWx0TWF0ZXJpYWxGYWN0b3J5PWM9Pm5ldyBCKCJkZWZhdWx0IG1hdGVyaWFsIixjKTtjb25zdCBFbD0iaW1hZ2VQcm9jZXNzaW5nQ29tcGF0aWJpbGl0eSIsdmw9YCNpZmRlZiBJTUFHRVBST0NFU1NJTkdQT1NUUFJPQ0VTUwpnbF9GcmFnQ29sb3IucmdiPXBvdyhnbF9GcmFnQ29sb3IucmdiLHZlYzMoMi4yKSk7CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbRWxdPXZsO2NvbnN0IFRsPSJzaGFkb3dPbmx5UGl4ZWxTaGFkZXIiLGJsPWBwcmVjaXNpb24gaGlnaHAgZmxvYXQ7CnVuaWZvcm0gdmVjNCB2RXllUG9zaXRpb247CnVuaWZvcm0gZmxvYXQgYWxwaGE7CnVuaWZvcm0gdmVjMyBzaGFkb3dDb2xvcjsKdmFyeWluZyB2ZWMzIHZQb3NpdGlvblc7CiNpZmRlZiBOT1JNQUwKdmFyeWluZyB2ZWMzIHZOb3JtYWxXOwojZW5kaWYKI2luY2x1ZGU8aGVscGVyRnVuY3Rpb25zPgojaW5jbHVkZTxfX2RlY2xfX2xpZ2h0RnJhZ21lbnQ+WzAuLm1heFNpbXVsdGFuZW91c0xpZ2h0c10KI2luY2x1ZGU8bGlnaHRzRnJhZ21lbnRGdW5jdGlvbnM+CiNpbmNsdWRlPHNoYWRvd3NGcmFnbWVudEZ1bmN0aW9ucz4KI2luY2x1ZGU8Y2xpcFBsYW5lRnJhZ21lbnREZWNsYXJhdGlvbj4KI2luY2x1ZGU8Zm9nRnJhZ21lbnREZWNsYXJhdGlvbj4KI2RlZmluZSBDVVNUT01fRlJBR01FTlRfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpIHsKI2RlZmluZSBDVVNUT01fRlJBR01FTlRfTUFJTl9CRUdJTgojaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudD4KdmVjMyB2aWV3RGlyZWN0aW9uVz1ub3JtYWxpemUodkV5ZVBvc2l0aW9uLnh5ei12UG9zaXRpb25XKTsKI2lmZGVmIE5PUk1BTAp2ZWMzIG5vcm1hbFc9bm9ybWFsaXplKHZOb3JtYWxXKTsKI2Vsc2UKdmVjMyBub3JtYWxXPXZlYzMoMS4wLDEuMCwxLjApOwojZW5kaWYKdmVjMyBkaWZmdXNlQmFzZT12ZWMzKDAuLDAuLDAuKTsKbGlnaHRpbmdJbmZvIGluZm87CmZsb2F0IHNoYWRvdz0xLjsKZmxvYXQgZ2xvc3NpbmVzcz0wLjsKI2luY2x1ZGU8bGlnaHRGcmFnbWVudD5bMC4uMV0KdmVjNCBjb2xvcj12ZWM0KHNoYWRvd0NvbG9yLCgxLjAtY2xhbXAoc2hhZG93LDAuLDEuKSkqYWxwaGEpOwojaW5jbHVkZTxmb2dGcmFnbWVudD4KZ2xfRnJhZ0NvbG9yPWNvbG9yOwojaW5jbHVkZTxpbWFnZVByb2Nlc3NpbmdDb21wYXRpYmlsaXR5PgojZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9NQUlOX0VORAp9YDtVLlNoYWRlcnNTdG9yZVtUbF09Ymw7Y29uc3QgU2w9InNoYWRvd09ubHlWZXJ0ZXhTaGFkZXIiLHhsPWBwcmVjaXNpb24gaGlnaHAgZmxvYXQ7CmF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uOwojaWZkZWYgTk9STUFMCmF0dHJpYnV0ZSB2ZWMzIG5vcm1hbDsKI2VuZGlmCiNpbmNsdWRlPGJvbmVzRGVjbGFyYXRpb24+CiNpbmNsdWRlPGJha2VkVmVydGV4QW5pbWF0aW9uRGVjbGFyYXRpb24+CiNpbmNsdWRlPGluc3RhbmNlc0RlY2xhcmF0aW9uPgp1bmlmb3JtIG1hdDQgdmlldzsKdW5pZm9ybSBtYXQ0IHZpZXdQcm9qZWN0aW9uOwojaWZkZWYgUE9JTlRTSVpFCnVuaWZvcm0gZmxvYXQgcG9pbnRTaXplOwojZW5kaWYKdmFyeWluZyB2ZWMzIHZQb3NpdGlvblc7CiNpZmRlZiBOT1JNQUwKdmFyeWluZyB2ZWMzIHZOb3JtYWxXOwojZW5kaWYKI2lmZGVmIFZFUlRFWENPTE9SCnZhcnlpbmcgdmVjNCB2Q29sb3I7CiNlbmRpZgojaW5jbHVkZTxjbGlwUGxhbmVWZXJ0ZXhEZWNsYXJhdGlvbj4KI2luY2x1ZGU8Zm9nVmVydGV4RGVjbGFyYXRpb24+CiNpbmNsdWRlPF9fZGVjbF9fbGlnaHRGcmFnbWVudD5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXQojZGVmaW5lIENVU1RPTV9WRVJURVhfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpIHsKI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fQkVHSU4KI2luY2x1ZGU8aW5zdGFuY2VzVmVydGV4PgojaW5jbHVkZTxib25lc1ZlcnRleD4KI2luY2x1ZGU8YmFrZWRWZXJ0ZXhBbmltYXRpb24+CnZlYzQgd29ybGRQb3M9ZmluYWxXb3JsZCp2ZWM0KHBvc2l0aW9uLDEuMCk7CmdsX1Bvc2l0aW9uPXZpZXdQcm9qZWN0aW9uKndvcmxkUG9zOwp2UG9zaXRpb25XPXZlYzMod29ybGRQb3MpOwojaWZkZWYgTk9STUFMCnZOb3JtYWxXPW5vcm1hbGl6ZSh2ZWMzKGZpbmFsV29ybGQqdmVjNChub3JtYWwsMC4wKSkpOwojZW5kaWYKI2luY2x1ZGU8Y2xpcFBsYW5lVmVydGV4PgojaW5jbHVkZTxmb2dWZXJ0ZXg+CiNpbmNsdWRlPHNoYWRvd3NWZXJ0ZXg+WzAuLm1heFNpbXVsdGFuZW91c0xpZ2h0c10KI2lmIGRlZmluZWQoUE9JTlRTSVpFKSAmJiAhZGVmaW5lZChXRUJHUFUpCmdsX1BvaW50U2l6ZT1wb2ludFNpemU7CiNlbmRpZgojZGVmaW5lIENVU1RPTV9WRVJURVhfTUFJTl9FTkQKfQpgO1UuU2hhZGVyc1N0b3JlW1NsXT14bDtjbGFzcyBNbCBleHRlbmRzIHlze2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLkNMSVBQTEFORT0hMSx0aGlzLkNMSVBQTEFORTI9ITEsdGhpcy5DTElQUExBTkUzPSExLHRoaXMuQ0xJUFBMQU5FND0hMSx0aGlzLkNMSVBQTEFORTU9ITEsdGhpcy5DTElQUExBTkU2PSExLHRoaXMuUE9JTlRTSVpFPSExLHRoaXMuRk9HPSExLHRoaXMuTk9STUFMPSExLHRoaXMuTlVNX0JPTkVfSU5GTFVFTkNFUlM9MCx0aGlzLkJvbmVzUGVyTWVzaD0wLHRoaXMuSU5TVEFOQ0VTPSExLHRoaXMuSU1BR0VQUk9DRVNTSU5HUE9TVFBST0NFU1M9ITEsdGhpcy5TS0lQRklOQUxDT0xPUkNMQU1QPSExLHRoaXMucmVidWlsZCgpfX1jbGFzcyBraSBleHRlbmRzIFZye2NvbnN0cnVjdG9yKGUsdCl7c3VwZXIoZSx0KSx0aGlzLl9uZWVkQWxwaGFCbGVuZGluZz0hMCx0aGlzLnNoYWRvd0NvbG9yPXJlLkJsYWNrKCl9bmVlZEFscGhhQmxlbmRpbmcoKXtyZXR1cm4gdGhpcy5fbmVlZEFscGhhQmxlbmRpbmd9bmVlZEFscGhhVGVzdGluZygpe3JldHVybiExfWdldEFscGhhVGVzdFRleHR1cmUoKXtyZXR1cm4gbnVsbH1nZXQgYWN0aXZlTGlnaHQoKXtyZXR1cm4gdGhpcy5fYWN0aXZlTGlnaHR9c2V0IGFjdGl2ZUxpZ2h0KGUpe3RoaXMuX2FjdGl2ZUxpZ2h0PWV9X2dldEZpcnN0U2hhZG93TGlnaHRGb3JNZXNoKGUpe2Zvcihjb25zdCB0IG9mIGUubGlnaHRTb3VyY2VzKWlmKHQuc2hhZG93RW5hYmxlZClyZXR1cm4gdDtyZXR1cm4gbnVsbH1pc1JlYWR5Rm9yU3ViTWVzaChlLHQsaSl7dmFyIHM7aWYodGhpcy5pc0Zyb3plbiYmdC5lZmZlY3QmJnQuZWZmZWN0Ll93YXNQcmV2aW91c2x5UmVhZHkmJnQuZWZmZWN0Ll93YXNQcmV2aW91c2x5VXNpbmdJbnN0YW5jZXM9PT1pKXJldHVybiEwO3QubWF0ZXJpYWxEZWZpbmVzfHwodC5tYXRlcmlhbERlZmluZXM9bmV3IE1sKTtjb25zdCByPXQubWF0ZXJpYWxEZWZpbmVzLG49dGhpcy5nZXRTY2VuZSgpO2lmKHRoaXMuX2lzUmVhZHlGb3JTdWJNZXNoKHQpKXJldHVybiEwO2NvbnN0IGE9bi5nZXRFbmdpbmUoKTtpZih0aGlzLl9hY3RpdmVMaWdodCl7Zm9yKGNvbnN0IGggb2YgZS5saWdodFNvdXJjZXMpaWYoaC5zaGFkb3dFbmFibGVkKXtpZih0aGlzLl9hY3RpdmVMaWdodD09PWgpYnJlYWs7Y29uc3QgbD1lLmxpZ2h0U291cmNlcy5pbmRleE9mKHRoaXMuX2FjdGl2ZUxpZ2h0KTtsIT09LTEmJihlLmxpZ2h0U291cmNlcy5zcGxpY2UobCwxKSxlLmxpZ2h0U291cmNlcy5zcGxpY2UoMCwwLHRoaXMuX2FjdGl2ZUxpZ2h0KSk7YnJlYWt9fWllLlByZXBhcmVEZWZpbmVzRm9yRnJhbWVCb3VuZFZhbHVlcyhuLGEsdGhpcyxyLCEhaSksaWUuUHJlcGFyZURlZmluZXNGb3JNaXNjKGUsbiwhMSx0aGlzLnBvaW50c0Nsb3VkLHRoaXMuZm9nRW5hYmxlZCx0aGlzLl9zaG91bGRUdXJuQWxwaGFUZXN0T24oZSksciksci5fbmVlZE5vcm1hbHM9aWUuUHJlcGFyZURlZmluZXNGb3JMaWdodHMobixlLHIsITEsMSk7Y29uc3Qgbz0ocz10aGlzLl9nZXRGaXJzdFNoYWRvd0xpZ2h0Rm9yTWVzaChlKSk9PT1udWxsfHxzPT09dm9pZCAwP3ZvaWQgMDpzLmdldFNoYWRvd0dlbmVyYXRvcigpO2lmKHRoaXMuX25lZWRBbHBoYUJsZW5kaW5nPSEwLG8mJm8uZ2V0Q2xhc3NOYW1lJiZvLmdldENsYXNzTmFtZSgpPT09IkNhc2NhZGVkU2hhZG93R2VuZXJhdG9yIil7Y29uc3QgaD1vO3RoaXMuX25lZWRBbHBoYUJsZW5kaW5nPSFoLmF1dG9DYWxjRGVwdGhCb3VuZHN9aWYoaWUuUHJlcGFyZURlZmluZXNGb3JBdHRyaWJ1dGVzKGUsciwhMSwhMCksci5pc0RpcnR5KXtyLm1hcmtBc1Byb2Nlc3NlZCgpLG4ucmVzZXRDYWNoZWRNYXRlcmlhbCgpO2NvbnN0IGg9bmV3IHpzO3IuRk9HJiZoLmFkZEZhbGxiYWNrKDEsIkZPRyIpLGllLkhhbmRsZUZhbGxiYWNrc0ZvclNoYWRvd3MocixoLDEpLHIuTlVNX0JPTkVfSU5GTFVFTkNFUlM+MCYmaC5hZGRDUFVTa2lubmluZ0ZhbGxiYWNrKDAsZSksci5JTUFHRVBST0NFU1NJTkdQT1NUUFJPQ0VTUz1uLmltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24uYXBwbHlCeVBvc3RQcm9jZXNzO2NvbnN0IGw9W2cuUG9zaXRpb25LaW5kXTtyLk5PUk1BTCYmbC5wdXNoKGcuTm9ybWFsS2luZCksaWUuUHJlcGFyZUF0dHJpYnV0ZXNGb3JCb25lcyhsLGUscixoKSxpZS5QcmVwYXJlQXR0cmlidXRlc0Zvckluc3RhbmNlcyhsLHIpO2NvbnN0IHU9InNoYWRvd09ubHkiLGQ9ci50b1N0cmluZygpLGY9WyJ3b3JsZCIsInZpZXciLCJ2aWV3UHJvamVjdGlvbiIsInZFeWVQb3NpdGlvbiIsInZMaWdodHNUeXBlIiwidkZvZ0luZm9zIiwidkZvZ0NvbG9yIiwicG9pbnRTaXplIiwiYWxwaGEiLCJzaGFkb3dDb2xvciIsIm1Cb25lcyJdLF89bmV3IEFycmF5LEU9bmV3IEFycmF5O3NzKGYpLGllLlByZXBhcmVVbmlmb3Jtc0FuZFNhbXBsZXJzTGlzdCh7dW5pZm9ybXNOYW1lczpmLHVuaWZvcm1CdWZmZXJzTmFtZXM6RSxzYW1wbGVyczpfLGRlZmluZXM6cixtYXhTaW11bHRhbmVvdXNMaWdodHM6MX0pLHQuc2V0RWZmZWN0KG4uZ2V0RW5naW5lKCkuY3JlYXRlRWZmZWN0KHUse2F0dHJpYnV0ZXM6bCx1bmlmb3Jtc05hbWVzOmYsdW5pZm9ybUJ1ZmZlcnNOYW1lczpFLHNhbXBsZXJzOl8sZGVmaW5lczpkLGZhbGxiYWNrczpoLG9uQ29tcGlsZWQ6dGhpcy5vbkNvbXBpbGVkLG9uRXJyb3I6dGhpcy5vbkVycm9yLGluZGV4UGFyYW1ldGVyczp7bWF4U2ltdWx0YW5lb3VzTGlnaHRzOjF9fSxhKSxyLHRoaXMuX21hdGVyaWFsQ29udGV4dCl9cmV0dXJuIXQuZWZmZWN0fHwhdC5lZmZlY3QuaXNSZWFkeSgpPyExOihyLl9yZW5kZXJJZD1uLmdldFJlbmRlcklkKCksdC5lZmZlY3QuX3dhc1ByZXZpb3VzbHlSZWFkeT0hMCx0LmVmZmVjdC5fd2FzUHJldmlvdXNseVVzaW5nSW5zdGFuY2VzPSEhaSwhMCl9YmluZEZvclN1Yk1lc2goZSx0LGkpe2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpLHI9aS5tYXRlcmlhbERlZmluZXM7aWYoIXIpcmV0dXJuO2NvbnN0IG49aS5lZmZlY3Q7aWYobil7aWYodGhpcy5fYWN0aXZlRWZmZWN0PW4sdGhpcy5iaW5kT25seVdvcmxkTWF0cml4KGUpLHRoaXMuX2FjdGl2ZUVmZmVjdC5zZXRNYXRyaXgoInZpZXdQcm9qZWN0aW9uIixzLmdldFRyYW5zZm9ybU1hdHJpeCgpKSxpZS5CaW5kQm9uZXNQYXJhbWV0ZXJzKHQsdGhpcy5fYWN0aXZlRWZmZWN0KSx0aGlzLl9tdXN0UmViaW5kKHMsbikmJihycyhuLHRoaXMscyksdGhpcy5wb2ludHNDbG91ZCYmdGhpcy5fYWN0aXZlRWZmZWN0LnNldEZsb2F0KCJwb2ludFNpemUiLHRoaXMucG9pbnRTaXplKSx0aGlzLl9hY3RpdmVFZmZlY3Quc2V0RmxvYXQoImFscGhhIix0aGlzLmFscGhhKSx0aGlzLl9hY3RpdmVFZmZlY3Quc2V0Q29sb3IzKCJzaGFkb3dDb2xvciIsdGhpcy5zaGFkb3dDb2xvcikscy5iaW5kRXllUG9zaXRpb24obikpLHMubGlnaHRzRW5hYmxlZCl7aWUuQmluZExpZ2h0cyhzLHQsdGhpcy5fYWN0aXZlRWZmZWN0LHIsMSk7Y29uc3QgYT10aGlzLl9nZXRGaXJzdFNoYWRvd0xpZ2h0Rm9yTWVzaCh0KTthJiYoYS5fcmVuZGVySWQ9LTEpfShzLmZvZ0VuYWJsZWQmJnQuYXBwbHlGb2cmJnMuZm9nTW9kZSE9PW5lLkZPR01PREVfTk9ORXx8ci5TSEFET1dDU00wKSYmdGhpcy5fYWN0aXZlRWZmZWN0LnNldE1hdHJpeCgidmlldyIscy5nZXRWaWV3TWF0cml4KCkpLGllLkJpbmRGb2dQYXJhbWV0ZXJzKHMsdCx0aGlzLl9hY3RpdmVFZmZlY3QpLHRoaXMuX2FmdGVyQmluZCh0LHRoaXMuX2FjdGl2ZUVmZmVjdCl9fWNsb25lKGUpe3JldHVybiBhZS5DbG9uZSgoKT0+bmV3IGtpKGUsdGhpcy5nZXRTY2VuZSgpKSx0aGlzKX1zZXJpYWxpemUoKXtjb25zdCBlPXN1cGVyLnNlcmlhbGl6ZSgpO3JldHVybiBlLmN1c3RvbVR5cGU9IkJBQllMT04uU2hhZG93T25seU1hdGVyaWFsIixlfWdldENsYXNzTmFtZSgpe3JldHVybiJTaGFkb3dPbmx5TWF0ZXJpYWwifXN0YXRpYyBQYXJzZShlLHQsaSl7cmV0dXJuIGFlLlBhcnNlKCgpPT5uZXcga2koZS5uYW1lLHQpLGUsdCxpKX19aXQoIkJBQllMT04uU2hhZG93T25seU1hdGVyaWFsIixraSk7Y29uc3QgQWw9e2FzcGVjdDozMDAvMTUwLGVuYWJsZURlYnVnZ2luZzohMSxlbmFibGVTaGFkb3dzOiEwfTtjbGFzcyBSbHtjb25zdHJ1Y3RvcihlKXtidCh0aGlzLCJzaXplIiw5LjUpO3RoaXMuY29uZmlnPXsuLi5BbCwuLi5lfSx0aGlzLmNyZWF0ZSgpfWNyZWF0ZShlKXt0aGlzLmRlc3Ryb3koKSxPYmplY3QuYXNzaWduKHRoaXMuY29uZmlnLGUpO2NvbnN0e2FzcGVjdDp0LGVuYWJsZURlYnVnZ2luZzppPSEwLGVuYWJsZVNoYWRvd3M6c309dGhpcy5jb25maWcscj0zMDtsZXQgbjt0aGlzLmJveD1uZXcgSigiZGljZUJveCIpLGk/KG49bmV3IEIoImRpY2VCb3hfbWF0ZXJpYWwiKSxuLmFscGhhPS43LG4uZGlmZnVzZUNvbG9yPW5ldyByZSgxLDEsMCkpOnMmJihuPW5ldyBraSgic2hhZG93T25seSIsdGhpcy5jb25maWcuc2NlbmUpKTtjb25zdCBhPU1pKCJncm91bmQiLHt3aWR0aDp0aGlzLnNpemUqMixoZWlnaHQ6MSxkZXB0aDp0aGlzLnNpemUqMn0sdGhpcy5jb25maWcuc2NlbmUpO2lmKGEuc2NhbGluZz1uZXcgcCh0LDEsMSksYS5tYXRlcmlhbD1uLGEucmVjZWl2ZVNoYWRvd3M9ITAsYS5zZXRQYXJlbnQodGhpcy5ib3gpLGkpe2NvbnN0IG89TWkoIndhbGxUb3AiLHt3aWR0aDp0aGlzLnNpemUsaGVpZ2h0OnIsZGVwdGg6MX0sdGhpcy5jb25maWcuc2NlbmUpO28ucG9zaXRpb24ueT1yLzIsby5wb3NpdGlvbi56PXRoaXMuc2l6ZS8tMixvLnNjYWxpbmc9bmV3IHAodCwxLDEpLG8ubWF0ZXJpYWw9bixvLnNldFBhcmVudCh0aGlzLmJveCk7Y29uc3QgaD1NaSgid2FsbFJpZ2h0Iix7d2lkdGg6MSxoZWlnaHQ6cixkZXB0aDp0aGlzLnNpemV9LHRoaXMuY29uZmlnLnNjZW5lKTtoLnBvc2l0aW9uLng9dGhpcy5zaXplKnQvMixoLnBvc2l0aW9uLnk9ci8yLGgubWF0ZXJpYWw9bixoLnNldFBhcmVudCh0aGlzLmJveCk7Y29uc3QgbD1NaSgid2FsbEJvdHRvbSIse3dpZHRoOnRoaXMuc2l6ZSxoZWlnaHQ6cixkZXB0aDoxfSx0aGlzLmNvbmZpZy5zY2VuZSk7bC5wb3NpdGlvbi55PXIvMixsLnBvc2l0aW9uLno9dGhpcy5zaXplLzIsbC5zY2FsaW5nPW5ldyBwKHQsMSwxKSxsLm1hdGVyaWFsPW4sbC5zZXRQYXJlbnQodGhpcy5ib3gpO2NvbnN0IHU9TWkoIndhbGxMZWZ0Iix7d2lkdGg6MSxoZWlnaHQ6cixkZXB0aDp0aGlzLnNpemV9LHRoaXMuY29uZmlnLnNjZW5lKTt1LnBvc2l0aW9uLng9dGhpcy5zaXplKnQvLTIsdS5wb3NpdGlvbi55PXIvMix1Lm1hdGVyaWFsPW4sdS5zZXRQYXJlbnQodGhpcy5ib3gpfX1kZXN0cm95KCl7dGhpcy5ib3gmJnRoaXMuYm94LmRpc3Bvc2UoKX19dmFyIHRpOyhmdW5jdGlvbihjKXtjW2MuQ2xlYW49MF09IkNsZWFuIixjW2MuU3RvcD0xXT0iU3RvcCIsY1tjLlN5bmM9Ml09IlN5bmMiLGNbYy5Ob1N5bmM9M109Ik5vU3luYyJ9KSh0aXx8KHRpPXt9KSk7Y2xhc3MgbGV7c3RhdGljIGdldCBGb3JjZUZ1bGxTY2VuZUxvYWRpbmdGb3JJbmNyZW1lbnRhbCgpe3JldHVybiBPZS5Gb3JjZUZ1bGxTY2VuZUxvYWRpbmdGb3JJbmNyZW1lbnRhbH1zdGF0aWMgc2V0IEZvcmNlRnVsbFNjZW5lTG9hZGluZ0ZvckluY3JlbWVudGFsKGUpe09lLkZvcmNlRnVsbFNjZW5lTG9hZGluZ0ZvckluY3JlbWVudGFsPWV9c3RhdGljIGdldCBTaG93TG9hZGluZ1NjcmVlbigpe3JldHVybiBPZS5TaG93TG9hZGluZ1NjcmVlbn1zdGF0aWMgc2V0IFNob3dMb2FkaW5nU2NyZWVuKGUpe09lLlNob3dMb2FkaW5nU2NyZWVuPWV9c3RhdGljIGdldCBsb2dnaW5nTGV2ZWwoKXtyZXR1cm4gT2UubG9nZ2luZ0xldmVsfXN0YXRpYyBzZXQgbG9nZ2luZ0xldmVsKGUpe09lLmxvZ2dpbmdMZXZlbD1lfXN0YXRpYyBnZXQgQ2xlYW5Cb25lTWF0cml4V2VpZ2h0cygpe3JldHVybiBPZS5DbGVhbkJvbmVNYXRyaXhXZWlnaHRzfXN0YXRpYyBzZXQgQ2xlYW5Cb25lTWF0cml4V2VpZ2h0cyhlKXtPZS5DbGVhbkJvbmVNYXRyaXhXZWlnaHRzPWV9c3RhdGljIEdldERlZmF1bHRQbHVnaW4oKXtyZXR1cm4gbGUuX1JlZ2lzdGVyZWRQbHVnaW5zWyIuYmFieWxvbiJdfXN0YXRpYyBfR2V0UGx1Z2luRm9yRXh0ZW5zaW9uKGUpe2NvbnN0IHQ9bGUuX1JlZ2lzdGVyZWRQbHVnaW5zW2VdO3JldHVybiB0fHwoTy5XYXJuKCJVbmFibGUgdG8gZmluZCBhIHBsdWdpbiB0byBsb2FkICIrZSsiIGZpbGVzLiBUcnlpbmcgdG8gdXNlIC5iYWJ5bG9uIGRlZmF1bHQgcGx1Z2luLiBUbyBsb2FkIGZyb20gYSBzcGVjaWZpYyBmaWxldHlwZSAoZWcuIGdsdGYpIHNlZTogaHR0cHM6Ly9kb2MuYmFieWxvbmpzLmNvbS9mZWF0dXJlcy9mZWF0dXJlc0RlZXBEaXZlL2ltcG9ydGVycy9sb2FkaW5nRmlsZVR5cGVzIiksbGUuR2V0RGVmYXVsdFBsdWdpbigpKX1zdGF0aWMgX0dldFBsdWdpbkZvckRpcmVjdExvYWQoZSl7Zm9yKGNvbnN0IHQgaW4gbGUuX1JlZ2lzdGVyZWRQbHVnaW5zKXtjb25zdCBpPWxlLl9SZWdpc3RlcmVkUGx1Z2luc1t0XS5wbHVnaW47aWYoaS5jYW5EaXJlY3RMb2FkJiZpLmNhbkRpcmVjdExvYWQoZSkpcmV0dXJuIGxlLl9SZWdpc3RlcmVkUGx1Z2luc1t0XX1yZXR1cm4gbGUuR2V0RGVmYXVsdFBsdWdpbigpfXN0YXRpYyBfR2V0UGx1Z2luRm9yRmlsZW5hbWUoZSl7Y29uc3QgdD1lLmluZGV4T2YoIj8iKTt0IT09LTEmJihlPWUuc3Vic3RyaW5nKDAsdCkpO2NvbnN0IGk9ZS5sYXN0SW5kZXhPZigiLiIpLHM9ZS5zdWJzdHJpbmcoaSxlLmxlbmd0aCkudG9Mb3dlckNhc2UoKTtyZXR1cm4gbGUuX0dldFBsdWdpbkZvckV4dGVuc2lvbihzKX1zdGF0aWMgX0dldERpcmVjdExvYWQoZSl7cmV0dXJuIGUuc3Vic3RyKDAsNSk9PT0iZGF0YToiP2Uuc3Vic3RyKDUpOm51bGx9c3RhdGljIF9Gb3JtYXRFcnJvck1lc3NhZ2UoZSx0LGkpe2xldCBzPSJVbmFibGUgdG8gbG9hZCBmcm9tICIrZS51cmw7cmV0dXJuIHQ/cys9YDogJHt0fWA6aSYmKHMrPWA6ICR7aX1gKSxzfXN0YXRpYyBfTG9hZERhdGEoZSx0LGkscyxyLG4sYSl7Y29uc3Qgbz1sZS5fR2V0RGlyZWN0TG9hZChlLnVybCksaD1hP2xlLl9HZXRQbHVnaW5Gb3JFeHRlbnNpb24oYSk6bz9sZS5fR2V0UGx1Z2luRm9yRGlyZWN0TG9hZChlLnVybCk6bGUuX0dldFBsdWdpbkZvckZpbGVuYW1lKGUudXJsKTtsZXQgbDtpZihoLnBsdWdpbi5jcmVhdGVQbHVnaW4hPT12b2lkIDA/bD1oLnBsdWdpbi5jcmVhdGVQbHVnaW4oKTpsPWgucGx1Z2luLCFsKXRocm93IlRoZSBsb2FkZXIgcGx1Z2luIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGZpbGUgdHlwZSB5b3UgYXJlIHRyeWluZyB0byBsb2FkIGhhcyBub3QgYmVlbiBmb3VuZC4gSWYgdXNpbmcgZXM2LCBwbGVhc2UgaW1wb3J0IHRoZSBwbHVnaW4geW91IHdpc2ggdG8gdXNlIGJlZm9yZS4iO2lmKGxlLk9uUGx1Z2luQWN0aXZhdGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMobCksbyYmKGwuY2FuRGlyZWN0TG9hZCYmbC5jYW5EaXJlY3RMb2FkKGUudXJsKXx8IU1zKGUudXJsKSkpe2lmKGwuZGlyZWN0TG9hZCl7Y29uc3QgeT1sLmRpcmVjdExvYWQodCxvKTt5LnRoZW4/eS50aGVuKEE9PntpKGwsQSl9KS5jYXRjaChBPT57cigiRXJyb3IgaW4gZGlyZWN0TG9hZCBvZiBfbG9hZERhdGE6ICIrQSxBKX0pOmkobCx5KX1lbHNlIGkobCxvKTtyZXR1cm4gbH1jb25zdCB1PWguaXNCaW5hcnksZD0oeSxBKT0+e2lmKHQuaXNEaXNwb3NlZCl7cigiU2NlbmUgaGFzIGJlZW4gZGlzcG9zZWQiKTtyZXR1cm59aShsLHksQSl9O2xldCBmPW51bGwsXz0hMTtjb25zdCBFPWwub25EaXNwb3NlT2JzZXJ2YWJsZTtFJiZFLmFkZCgoKT0+e189ITAsZiYmKGYuYWJvcnQoKSxmPW51bGwpLG4oKX0pO2NvbnN0IG09KCk9PntpZihfKXJldHVybjtjb25zdCB5PShDLGIpPT57cihDPT1udWxsP3ZvaWQgMDpDLnN0YXR1c1RleHQsYil9LEE9ZS5maWxlfHxlLnVybDtmPWwubG9hZEZpbGU/bC5sb2FkRmlsZSh0LEEsZCxzLHUseSk6dC5fbG9hZEZpbGUoQSxkLHMsITAsdSx5KX0sdj10LmdldEVuZ2luZSgpO2xldCBTPXYuZW5hYmxlT2ZmbGluZVN1cHBvcnQ7aWYoUyl7bGV0IHk9ITE7Zm9yKGNvbnN0IEEgb2YgdC5kaXNhYmxlT2ZmbGluZVN1cHBvcnRFeGNlcHRpb25SdWxlcylpZihBLnRlc3QoZS51cmwpKXt5PSEwO2JyZWFrfVM9IXl9cmV0dXJuIFMmJkkuT2ZmbGluZVByb3ZpZGVyRmFjdG9yeT90Lm9mZmxpbmVQcm92aWRlcj1JLk9mZmxpbmVQcm92aWRlckZhY3RvcnkoZS51cmwsbSx2LmRpc2FibGVNYW5pZmVzdENoZWNrKTptKCksbH1zdGF0aWMgX0dldEZpbGVJbmZvKGUsdCl7bGV0IGkscyxyPW51bGw7aWYoIXQpaT1lLHM9SC5HZXRGaWxlbmFtZShlKSxlPUguR2V0Rm9sZGVyUGF0aChlKTtlbHNlIGlmKHQubmFtZSl7Y29uc3Qgbj10O2k9YGZpbGU6JHtuLm5hbWV9YCxzPW4ubmFtZSxyPW59ZWxzZSBpZih0eXBlb2YgdD09InN0cmluZyImJnQuc3RhcnRzV2l0aCgiZGF0YToiKSlpPXQscz0iIjtlbHNle2NvbnN0IG49dDtpZihuLnN1YnN0cigwLDEpPT09Ii8iKXJldHVybiBILkVycm9yKCJXcm9uZyBzY2VuZUZpbGVuYW1lIHBhcmFtZXRlciIpLG51bGw7aT1lK24scz1ufXJldHVybnt1cmw6aSxyb290VXJsOmUsbmFtZTpzLGZpbGU6cn19c3RhdGljIEdldFBsdWdpbkZvckV4dGVuc2lvbihlKXtyZXR1cm4gbGUuX0dldFBsdWdpbkZvckV4dGVuc2lvbihlKS5wbHVnaW59c3RhdGljIElzUGx1Z2luRm9yRXh0ZW5zaW9uQXZhaWxhYmxlKGUpe3JldHVybiEhbGUuX1JlZ2lzdGVyZWRQbHVnaW5zW2VdfXN0YXRpYyBSZWdpc3RlclBsdWdpbihlKXtpZih0eXBlb2YgZS5leHRlbnNpb25zPT0ic3RyaW5nIil7Y29uc3QgdD1lLmV4dGVuc2lvbnM7bGUuX1JlZ2lzdGVyZWRQbHVnaW5zW3QudG9Mb3dlckNhc2UoKV09e3BsdWdpbjplLGlzQmluYXJ5OiExfX1lbHNle2NvbnN0IHQ9ZS5leHRlbnNpb25zO09iamVjdC5rZXlzKHQpLmZvckVhY2goaT0+e2xlLl9SZWdpc3RlcmVkUGx1Z2luc1tpLnRvTG93ZXJDYXNlKCldPXtwbHVnaW46ZSxpc0JpbmFyeTp0W2ldLmlzQmluYXJ5fX0pfX1zdGF0aWMgSW1wb3J0TWVzaChlLHQsaT0iIixzPWZlLkxhc3RDcmVhdGVkU2NlbmUscj1udWxsLG49bnVsbCxhPW51bGwsbz1udWxsKXtpZighcylyZXR1cm4gTy5FcnJvcigiTm8gc2NlbmUgYXZhaWxhYmxlIHRvIGltcG9ydCBtZXNoIHRvIiksbnVsbDtjb25zdCBoPWxlLl9HZXRGaWxlSW5mbyh0LGkpO2lmKCFoKXJldHVybiBudWxsO2NvbnN0IGw9e307cy5hZGRQZW5kaW5nRGF0YShsKTtjb25zdCB1PSgpPT57cy5yZW1vdmVQZW5kaW5nRGF0YShsKX0sZD0oRSxtKT0+e2NvbnN0IHY9bGUuX0Zvcm1hdEVycm9yTWVzc2FnZShoLEUsbSk7YT9hKHMsdixuZXcgTnQodixvaS5TY2VuZUxvYWRlckVycm9yLG0pKTpPLkVycm9yKHYpLHUoKX0sZj1uP0U9Pnt0cnl7bihFKX1jYXRjaChtKXtkKCJFcnJvciBpbiBvblByb2dyZXNzIGNhbGxiYWNrOiAiK20sbSl9fTp2b2lkIDAsXz0oRSxtLHYsUyx5LEEsQyk9PntpZihzLmltcG9ydGVkTWVzaGVzRmlsZXMucHVzaChoLnVybCkscil0cnl7cihFLG0sdixTLHksQSxDKX1jYXRjaChiKXtkKCJFcnJvciBpbiBvblN1Y2Nlc3MgY2FsbGJhY2s6ICIrYixiKX1zLnJlbW92ZVBlbmRpbmdEYXRhKGwpfTtyZXR1cm4gbGUuX0xvYWREYXRhKGgscywoRSxtLHYpPT57aWYoRS5yZXdyaXRlUm9vdFVSTCYmKGgucm9vdFVybD1FLnJld3JpdGVSb290VVJMKGgucm9vdFVybCx2KSksRS5pbXBvcnRNZXNoKXtjb25zdCBTPUUseT1uZXcgQXJyYXksQT1uZXcgQXJyYXksQz1uZXcgQXJyYXk7aWYoIVMuaW1wb3J0TWVzaChlLHMsbSxoLnJvb3RVcmwseSxBLEMsZCkpcmV0dXJuO3MubG9hZGluZ1BsdWdpbk5hbWU9RS5uYW1lLF8oeSxBLEMsW10sW10sW10sW10pfWVsc2UgRS5pbXBvcnRNZXNoQXN5bmMoZSxzLG0saC5yb290VXJsLGYsaC5uYW1lKS50aGVuKHk9PntzLmxvYWRpbmdQbHVnaW5OYW1lPUUubmFtZSxfKHkubWVzaGVzLHkucGFydGljbGVTeXN0ZW1zLHkuc2tlbGV0b25zLHkuYW5pbWF0aW9uR3JvdXBzLHkudHJhbnNmb3JtTm9kZXMseS5nZW9tZXRyaWVzLHkubGlnaHRzKX0pLmNhdGNoKHk9PntkKHkubWVzc2FnZSx5KX0pfSxmLGQsdSxvKX1zdGF0aWMgSW1wb3J0TWVzaEFzeW5jKGUsdCxpPSIiLHM9ZmUuTGFzdENyZWF0ZWRTY2VuZSxyPW51bGwsbj1udWxsKXtyZXR1cm4gbmV3IFByb21pc2UoKGEsbyk9PntsZS5JbXBvcnRNZXNoKGUsdCxpLHMsKGgsbCx1LGQsZixfLEUpPT57YSh7bWVzaGVzOmgscGFydGljbGVTeXN0ZW1zOmwsc2tlbGV0b25zOnUsYW5pbWF0aW9uR3JvdXBzOmQsdHJhbnNmb3JtTm9kZXM6ZixnZW9tZXRyaWVzOl8sbGlnaHRzOkV9KX0sciwoaCxsLHUpPT57byh1fHxuZXcgRXJyb3IobCkpfSxuKX0pfXN0YXRpYyBMb2FkKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkRW5naW5lLHM9bnVsbCxyPW51bGwsbj1udWxsLGE9bnVsbCl7cmV0dXJuIGk/bGUuQXBwZW5kKGUsdCxuZXcgbmUoaSkscyxyLG4sYSk6KEguRXJyb3IoIk5vIGVuZ2luZSBhdmFpbGFibGUiKSxudWxsKX1zdGF0aWMgTG9hZEFzeW5jKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkRW5naW5lLHM9bnVsbCxyPW51bGwpe3JldHVybiBuZXcgUHJvbWlzZSgobixhKT0+e2xlLkxvYWQoZSx0LGksbz0+e24obyl9LHMsKG8saCxsKT0+e2EobHx8bmV3IEVycm9yKGgpKX0scil9KX1zdGF0aWMgQXBwZW5kKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkU2NlbmUscz1udWxsLHI9bnVsbCxuPW51bGwsYT1udWxsKXtpZighaSlyZXR1cm4gTy5FcnJvcigiTm8gc2NlbmUgYXZhaWxhYmxlIHRvIGFwcGVuZCB0byIpLG51bGw7Y29uc3Qgbz1sZS5fR2V0RmlsZUluZm8oZSx0KTtpZighbylyZXR1cm4gbnVsbDtjb25zdCBoPXt9O2kuYWRkUGVuZGluZ0RhdGEoaCk7Y29uc3QgbD0oKT0+e2kucmVtb3ZlUGVuZGluZ0RhdGEoaCl9O2xlLlNob3dMb2FkaW5nU2NyZWVuJiYhdGhpcy5fU2hvd2luZ0xvYWRpbmdTY3JlZW4mJih0aGlzLl9TaG93aW5nTG9hZGluZ1NjcmVlbj0hMCxpLmdldEVuZ2luZSgpLmRpc3BsYXlMb2FkaW5nVUkoKSxpLmV4ZWN1dGVXaGVuUmVhZHkoKCk9PntpLmdldEVuZ2luZSgpLmhpZGVMb2FkaW5nVUkoKSx0aGlzLl9TaG93aW5nTG9hZGluZ1NjcmVlbj0hMX0pKTtjb25zdCB1PShfLEUpPT57Y29uc3QgbT1sZS5fRm9ybWF0RXJyb3JNZXNzYWdlKG8sXyxFKTtuP24oaSxtLG5ldyBOdChtLG9pLlNjZW5lTG9hZGVyRXJyb3IsRSkpOk8uRXJyb3IobSksbCgpfSxkPXI/Xz0+e3RyeXtyKF8pfWNhdGNoKEUpe3UoIkVycm9yIGluIG9uUHJvZ3Jlc3MgY2FsbGJhY2siLEUpfX06dm9pZCAwLGY9KCk9PntpZihzKXRyeXtzKGkpfWNhdGNoKF8pe3UoIkVycm9yIGluIG9uU3VjY2VzcyBjYWxsYmFjayIsXyl9aS5yZW1vdmVQZW5kaW5nRGF0YShoKX07cmV0dXJuIGxlLl9Mb2FkRGF0YShvLGksKF8sRSk9PntpZihfLmxvYWQpe2lmKCFfLmxvYWQoaSxFLG8ucm9vdFVybCx1KSlyZXR1cm47aS5sb2FkaW5nUGx1Z2luTmFtZT1fLm5hbWUsZigpfWVsc2UgXy5sb2FkQXN5bmMoaSxFLG8ucm9vdFVybCxkLG8ubmFtZSkudGhlbigoKT0+e2kubG9hZGluZ1BsdWdpbk5hbWU9Xy5uYW1lLGYoKX0pLmNhdGNoKHY9Pnt1KHYubWVzc2FnZSx2KX0pfSxkLHUsbCxhKX1zdGF0aWMgQXBwZW5kQXN5bmMoZSx0PSIiLGk9ZmUuTGFzdENyZWF0ZWRTY2VuZSxzPW51bGwscj1udWxsKXtyZXR1cm4gbmV3IFByb21pc2UoKG4sYSk9PntsZS5BcHBlbmQoZSx0LGksbz0+e24obyl9LHMsKG8saCxsKT0+e2EobHx8bmV3IEVycm9yKGgpKX0scil9KX1zdGF0aWMgTG9hZEFzc2V0Q29udGFpbmVyKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkU2NlbmUscz1udWxsLHI9bnVsbCxuPW51bGwsYT1udWxsKXtpZighaSlyZXR1cm4gTy5FcnJvcigiTm8gc2NlbmUgYXZhaWxhYmxlIHRvIGxvYWQgYXNzZXQgY29udGFpbmVyIHRvIiksbnVsbDtjb25zdCBvPWxlLl9HZXRGaWxlSW5mbyhlLHQpO2lmKCFvKXJldHVybiBudWxsO2NvbnN0IGg9e307aS5hZGRQZW5kaW5nRGF0YShoKTtjb25zdCBsPSgpPT57aS5yZW1vdmVQZW5kaW5nRGF0YShoKX0sdT0oXyxFKT0+e2NvbnN0IG09bGUuX0Zvcm1hdEVycm9yTWVzc2FnZShvLF8sRSk7bj9uKGksbSxuZXcgTnQobSxvaS5TY2VuZUxvYWRlckVycm9yLEUpKTpPLkVycm9yKG0pLGwoKX0sZD1yP189Pnt0cnl7cihfKX1jYXRjaChFKXt1KCJFcnJvciBpbiBvblByb2dyZXNzIGNhbGxiYWNrIixFKX19OnZvaWQgMCxmPV89PntpZihzKXRyeXtzKF8pfWNhdGNoKEUpe3UoIkVycm9yIGluIG9uU3VjY2VzcyBjYWxsYmFjayIsRSl9aS5yZW1vdmVQZW5kaW5nRGF0YShoKX07cmV0dXJuIGxlLl9Mb2FkRGF0YShvLGksKF8sRSk9PntpZihfLmxvYWRBc3NldENvbnRhaW5lcil7Y29uc3Qgdj1fLmxvYWRBc3NldENvbnRhaW5lcihpLEUsby5yb290VXJsLHUpO2lmKCF2KXJldHVybjtpLmxvYWRpbmdQbHVnaW5OYW1lPV8ubmFtZSxmKHYpfWVsc2UgXy5sb2FkQXNzZXRDb250YWluZXJBc3luYz9fLmxvYWRBc3NldENvbnRhaW5lckFzeW5jKGksRSxvLnJvb3RVcmwsZCxvLm5hbWUpLnRoZW4odj0+e2kubG9hZGluZ1BsdWdpbk5hbWU9Xy5uYW1lLGYodil9KS5jYXRjaCh2PT57dSh2Lm1lc3NhZ2Usdil9KTp1KCJMb2FkQXNzZXRDb250YWluZXIgaXMgbm90IHN1cHBvcnRlZCBieSB0aGlzIHBsdWdpbi4gUGx1Z2luIGRpZCBub3QgcHJvdmlkZSBhIGxvYWRBc3NldENvbnRhaW5lciBvciBsb2FkQXNzZXRDb250YWluZXJBc3luYyBtZXRob2QuIil9LGQsdSxsLGEpfXN0YXRpYyBMb2FkQXNzZXRDb250YWluZXJBc3luYyhlLHQ9IiIsaT1mZS5MYXN0Q3JlYXRlZFNjZW5lLHM9bnVsbCxyPW51bGwpe3JldHVybiBuZXcgUHJvbWlzZSgobixhKT0+e2xlLkxvYWRBc3NldENvbnRhaW5lcihlLHQsaSxvPT57bihvKX0scywobyxoLGwpPT57YShsfHxuZXcgRXJyb3IoaCkpfSxyKX0pfXN0YXRpYyBJbXBvcnRBbmltYXRpb25zKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkU2NlbmUscz0hMCxyPXRpLkNsZWFuLG49bnVsbCxhPW51bGwsbz1udWxsLGg9bnVsbCxsPW51bGwpe2lmKCFpKXtPLkVycm9yKCJObyBzY2VuZSBhdmFpbGFibGUgdG8gbG9hZCBhbmltYXRpb25zIHRvIik7cmV0dXJufWlmKHMpe2Zvcihjb25zdCBfIG9mIGkuYW5pbWF0YWJsZXMpXy5yZXNldCgpO2kuc3RvcEFsbEFuaW1hdGlvbnMoKSxpLmFuaW1hdGlvbkdyb3Vwcy5zbGljZSgpLmZvckVhY2goXz0+e18uZGlzcG9zZSgpfSksaS5nZXROb2RlcygpLmZvckVhY2goXz0+e18uYW5pbWF0aW9ucyYmKF8uYW5pbWF0aW9ucz1bXSl9KX1lbHNlIHN3aXRjaChyKXtjYXNlIHRpLkNsZWFuOmkuYW5pbWF0aW9uR3JvdXBzLnNsaWNlKCkuZm9yRWFjaChmPT57Zi5kaXNwb3NlKCl9KTticmVhaztjYXNlIHRpLlN0b3A6aS5hbmltYXRpb25Hcm91cHMuZm9yRWFjaChmPT57Zi5zdG9wKCl9KTticmVhaztjYXNlIHRpLlN5bmM6aS5hbmltYXRpb25Hcm91cHMuZm9yRWFjaChmPT57Zi5yZXNldCgpLGYucmVzdGFydCgpfSk7YnJlYWs7Y2FzZSB0aS5Ob1N5bmM6YnJlYWs7ZGVmYXVsdDpPLkVycm9yKCJVbmtub3duIGFuaW1hdGlvbiBncm91cCBsb2FkaW5nIG1vZGUgdmFsdWUgJyIrcisiJyIpO3JldHVybn1jb25zdCB1PWkuYW5pbWF0YWJsZXMubGVuZ3RoLGQ9Zj0+e2YubWVyZ2VBbmltYXRpb25zVG8oaSxpLmFuaW1hdGFibGVzLnNsaWNlKHUpLG4pLGYuZGlzcG9zZSgpLGkub25BbmltYXRpb25GaWxlSW1wb3J0ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhpKSxhJiZhKGkpfTt0aGlzLkxvYWRBc3NldENvbnRhaW5lcihlLHQsaSxkLG8saCxsKX1zdGF0aWMgSW1wb3J0QW5pbWF0aW9uc0FzeW5jKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkU2NlbmUscz0hMCxyPXRpLkNsZWFuLG49bnVsbCxhPW51bGwsbz1udWxsLGg9bnVsbCxsPW51bGwpe3JldHVybiBuZXcgUHJvbWlzZSgodSxkKT0+e2xlLkltcG9ydEFuaW1hdGlvbnMoZSx0LGkscyxyLG4sZj0+e3UoZil9LG8sKGYsXyxFKT0+e2QoRXx8bmV3IEVycm9yKF8pKX0sbCl9KX19bGUuTk9fTE9HR0lORz0wLGxlLk1JTklNQUxfTE9HR0lORz0xLGxlLlNVTU1BUllfTE9HR0lORz0yLGxlLkRFVEFJTEVEX0xPR0dJTkc9MyxsZS5PblBsdWdpbkFjdGl2YXRlZE9ic2VydmFibGU9bmV3IEYsbGUuX1JlZ2lzdGVyZWRQbHVnaW5zPXt9LGxlLl9TaG93aW5nTG9hZGluZ1NjcmVlbj0hMTtjbGFzcyBfZXtjb25zdHJ1Y3RvcihlLHQsaT1OdW1iZXIuTUFYX1ZBTFVFKXt0aGlzLm9yaWdpbj1lLHRoaXMuZGlyZWN0aW9uPXQsdGhpcy5sZW5ndGg9aX1jbG9uZSgpe3JldHVybiBuZXcgX2UodGhpcy5vcmlnaW4uY2xvbmUoKSx0aGlzLmRpcmVjdGlvbi5jbG9uZSgpLHRoaXMubGVuZ3RoKX1pbnRlcnNlY3RzQm94TWluTWF4KGUsdCxpPTApe2NvbnN0IHM9X2UuX1RtcFZlY3RvcjNbMF0uY29weUZyb21GbG9hdHMoZS54LWksZS55LWksZS56LWkpLHI9X2UuX1RtcFZlY3RvcjNbMV0uY29weUZyb21GbG9hdHModC54K2ksdC55K2ksdC56K2kpO2xldCBuPTAsYT1OdW1iZXIuTUFYX1ZBTFVFLG8saCxsLHU7aWYoTWF0aC5hYnModGhpcy5kaXJlY3Rpb24ueCk8MWUtNyl7aWYodGhpcy5vcmlnaW4ueDxzLnh8fHRoaXMub3JpZ2luLng+ci54KXJldHVybiExfWVsc2UgaWYobz0xL3RoaXMuZGlyZWN0aW9uLngsaD0ocy54LXRoaXMub3JpZ2luLngpKm8sbD0oci54LXRoaXMub3JpZ2luLngpKm8sbD09PS0xLzAmJihsPTEvMCksaD5sJiYodT1oLGg9bCxsPXUpLG49TWF0aC5tYXgoaCxuKSxhPU1hdGgubWluKGwsYSksbj5hKXJldHVybiExO2lmKE1hdGguYWJzKHRoaXMuZGlyZWN0aW9uLnkpPDFlLTcpe2lmKHRoaXMub3JpZ2luLnk8cy55fHx0aGlzLm9yaWdpbi55PnIueSlyZXR1cm4hMX1lbHNlIGlmKG89MS90aGlzLmRpcmVjdGlvbi55LGg9KHMueS10aGlzLm9yaWdpbi55KSpvLGw9KHIueS10aGlzLm9yaWdpbi55KSpvLGw9PT0tMS8wJiYobD0xLzApLGg+bCYmKHU9aCxoPWwsbD11KSxuPU1hdGgubWF4KGgsbiksYT1NYXRoLm1pbihsLGEpLG4+YSlyZXR1cm4hMTtpZihNYXRoLmFicyh0aGlzLmRpcmVjdGlvbi56KTwxZS03KXtpZih0aGlzLm9yaWdpbi56PHMuenx8dGhpcy5vcmlnaW4uej5yLnopcmV0dXJuITF9ZWxzZSBpZihvPTEvdGhpcy5kaXJlY3Rpb24ueixoPShzLnotdGhpcy5vcmlnaW4ueikqbyxsPShyLnotdGhpcy5vcmlnaW4ueikqbyxsPT09LTEvMCYmKGw9MS8wKSxoPmwmJih1PWgsaD1sLGw9dSksbj1NYXRoLm1heChoLG4pLGE9TWF0aC5taW4obCxhKSxuPmEpcmV0dXJuITE7cmV0dXJuITB9aW50ZXJzZWN0c0JveChlLHQ9MCl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c0JveE1pbk1heChlLm1pbmltdW0sZS5tYXhpbXVtLHQpfWludGVyc2VjdHNTcGhlcmUoZSx0PTApe2NvbnN0IGk9ZS5jZW50ZXIueC10aGlzLm9yaWdpbi54LHM9ZS5jZW50ZXIueS10aGlzLm9yaWdpbi55LHI9ZS5jZW50ZXIuei10aGlzLm9yaWdpbi56LG49aSppK3MqcytyKnIsYT1lLnJhZGl1cyt0LG89YSphO2lmKG48PW8pcmV0dXJuITA7Y29uc3QgaD1pKnRoaXMuZGlyZWN0aW9uLngrcyp0aGlzLmRpcmVjdGlvbi55K3IqdGhpcy5kaXJlY3Rpb24uejtyZXR1cm4gaDwwPyExOm4taCpoPD1vfWludGVyc2VjdHNUcmlhbmdsZShlLHQsaSl7Y29uc3Qgcz1fZS5fVG1wVmVjdG9yM1swXSxyPV9lLl9UbXBWZWN0b3IzWzFdLG49X2UuX1RtcFZlY3RvcjNbMl0sYT1fZS5fVG1wVmVjdG9yM1szXSxvPV9lLl9UbXBWZWN0b3IzWzRdO3Quc3VidHJhY3RUb1JlZihlLHMpLGkuc3VidHJhY3RUb1JlZihlLHIpLHAuQ3Jvc3NUb1JlZih0aGlzLmRpcmVjdGlvbixyLG4pO2NvbnN0IGg9cC5Eb3QocyxuKTtpZihoPT09MClyZXR1cm4gbnVsbDtjb25zdCBsPTEvaDt0aGlzLm9yaWdpbi5zdWJ0cmFjdFRvUmVmKGUsYSk7Y29uc3QgdT1wLkRvdChhLG4pKmw7aWYodTwwfHx1PjEpcmV0dXJuIG51bGw7cC5Dcm9zc1RvUmVmKGEscyxvKTtjb25zdCBkPXAuRG90KHRoaXMuZGlyZWN0aW9uLG8pKmw7aWYoZDwwfHx1K2Q+MSlyZXR1cm4gbnVsbDtjb25zdCBmPXAuRG90KHIsbykqbDtyZXR1cm4gZj50aGlzLmxlbmd0aD9udWxsOm5ldyBEcygxLXUtZCx1LGYpfWludGVyc2VjdHNQbGFuZShlKXtsZXQgdDtjb25zdCBpPXAuRG90KGUubm9ybWFsLHRoaXMuZGlyZWN0aW9uKTtpZihNYXRoLmFicyhpKTw5OTk5OTk5OTc0NzUyNDNlLTIxKXJldHVybiBudWxsO3tjb25zdCBzPXAuRG90KGUubm9ybWFsLHRoaXMub3JpZ2luKTtyZXR1cm4gdD0oLWUuZC1zKS9pLHQ8MD90PC05OTk5OTk5OTc0NzUyNDNlLTIxP251bGw6MDp0fX1pbnRlcnNlY3RzQXhpcyhlLHQ9MCl7c3dpdGNoKGUpe2Nhc2UieSI6e2NvbnN0IGk9KHRoaXMub3JpZ2luLnktdCkvdGhpcy5kaXJlY3Rpb24ueTtyZXR1cm4gaT4wP251bGw6bmV3IHAodGhpcy5vcmlnaW4ueCt0aGlzLmRpcmVjdGlvbi54Ki1pLHQsdGhpcy5vcmlnaW4ueit0aGlzLmRpcmVjdGlvbi56Ki1pKX1jYXNlIngiOntjb25zdCBpPSh0aGlzLm9yaWdpbi54LXQpL3RoaXMuZGlyZWN0aW9uLng7cmV0dXJuIGk+MD9udWxsOm5ldyBwKHQsdGhpcy5vcmlnaW4ueSt0aGlzLmRpcmVjdGlvbi55Ki1pLHRoaXMub3JpZ2luLnordGhpcy5kaXJlY3Rpb24ueiotaSl9Y2FzZSJ6Ijp7Y29uc3QgaT0odGhpcy5vcmlnaW4uei10KS90aGlzLmRpcmVjdGlvbi56O3JldHVybiBpPjA/bnVsbDpuZXcgcCh0aGlzLm9yaWdpbi54K3RoaXMuZGlyZWN0aW9uLngqLWksdGhpcy5vcmlnaW4ueSt0aGlzLmRpcmVjdGlvbi55Ki1pLHQpfWRlZmF1bHQ6cmV0dXJuIG51bGx9fWludGVyc2VjdHNNZXNoKGUsdCl7Y29uc3QgaT1ELk1hdHJpeFswXTtyZXR1cm4gZS5nZXRXb3JsZE1hdHJpeCgpLmludmVydFRvUmVmKGkpLHRoaXMuX3RtcFJheT9fZS5UcmFuc2Zvcm1Ub1JlZih0aGlzLGksdGhpcy5fdG1wUmF5KTp0aGlzLl90bXBSYXk9X2UuVHJhbnNmb3JtKHRoaXMsaSksZS5pbnRlcnNlY3RzKHRoaXMuX3RtcFJheSx0KX1pbnRlcnNlY3RzTWVzaGVzKGUsdCxpKXtpP2kubGVuZ3RoPTA6aT1bXTtmb3IobGV0IHM9MDtzPGUubGVuZ3RoO3MrKyl7Y29uc3Qgcj10aGlzLmludGVyc2VjdHNNZXNoKGVbc10sdCk7ci5oaXQmJmkucHVzaChyKX1yZXR1cm4gaS5zb3J0KHRoaXMuX2NvbXBhcmVQaWNraW5nSW5mbyksaX1fY29tcGFyZVBpY2tpbmdJbmZvKGUsdCl7cmV0dXJuIGUuZGlzdGFuY2U8dC5kaXN0YW5jZT8tMTplLmRpc3RhbmNlPnQuZGlzdGFuY2U/MTowfWludGVyc2VjdGlvblNlZ21lbnQoZSx0LGkpe2NvbnN0IHM9dGhpcy5vcmlnaW4scj1ELlZlY3RvcjNbMF0sbj1ELlZlY3RvcjNbMV0sYT1ELlZlY3RvcjNbMl0sbz1ELlZlY3RvcjNbM107dC5zdWJ0cmFjdFRvUmVmKGUsciksdGhpcy5kaXJlY3Rpb24uc2NhbGVUb1JlZihfZS5fUmF5bCxhKSxzLmFkZFRvUmVmKGEsbiksZS5zdWJ0cmFjdFRvUmVmKHMsbyk7Y29uc3QgaD1wLkRvdChyLHIpLGw9cC5Eb3QocixhKSx1PXAuRG90KGEsYSksZD1wLkRvdChyLG8pLGY9cC5Eb3QoYSxvKSxfPWgqdS1sKmw7bGV0IEUsbT1fLHYsUz1fO188X2UuX1NtYWxsbnVtPyhFPTAsbT0xLHY9ZixTPXUpOihFPWwqZi11KmQsdj1oKmYtbCpkLEU8MD8oRT0wLHY9ZixTPXUpOkU+bSYmKEU9bSx2PWYrbCxTPXUpKSx2PDA/KHY9MCwtZDwwP0U9MDotZD5oP0U9bTooRT0tZCxtPWgpKTp2PlMmJih2PVMsLWQrbDwwP0U9MDotZCtsPmg/RT1tOihFPS1kK2wsbT1oKSk7Y29uc3QgeT1NYXRoLmFicyhFKTxfZS5fU21hbGxudW0/MDpFL20sQT1NYXRoLmFicyh2KTxfZS5fU21hbGxudW0/MDp2L1MsQz1ELlZlY3RvcjNbNF07YS5zY2FsZVRvUmVmKEEsQyk7Y29uc3QgYj1ELlZlY3RvcjNbNV07ci5zY2FsZVRvUmVmKHksYiksYi5hZGRJblBsYWNlKG8pO2NvbnN0IE09RC5WZWN0b3IzWzZdO3JldHVybiBiLnN1YnRyYWN0VG9SZWYoQyxNKSxBPjAmJkE8PXRoaXMubGVuZ3RoJiZNLmxlbmd0aFNxdWFyZWQoKTxpKmk/Yi5sZW5ndGgoKTotMX11cGRhdGUoZSx0LGkscyxyLG4sYSxvPSExKXtpZihvKXtfZS5fUmF5RGlzdGFudHx8KF9lLl9SYXlEaXN0YW50PV9lLlplcm8oKSksX2UuX1JheURpc3RhbnQudW5wcm9qZWN0UmF5VG9SZWYoZSx0LGkscyx4LklkZW50aXR5UmVhZE9ubHksbixhKTtjb25zdCBoPUQuTWF0cml4WzBdO3IuaW52ZXJ0VG9SZWYoaCksX2UuVHJhbnNmb3JtVG9SZWYoX2UuX1JheURpc3RhbnQsaCx0aGlzKX1lbHNlIHRoaXMudW5wcm9qZWN0UmF5VG9SZWYoZSx0LGkscyxyLG4sYSk7cmV0dXJuIHRoaXN9c3RhdGljIFplcm8oKXtyZXR1cm4gbmV3IF9lKHAuWmVybygpLHAuWmVybygpKX1zdGF0aWMgQ3JlYXRlTmV3KGUsdCxpLHMscixuLGEpe3JldHVybiBfZS5aZXJvKCkudXBkYXRlKGUsdCxpLHMscixuLGEpfXN0YXRpYyBDcmVhdGVOZXdGcm9tVG8oZSx0LGk9eC5JZGVudGl0eVJlYWRPbmx5KXtjb25zdCBzPXQuc3VidHJhY3QoZSkscj1NYXRoLnNxcnQocy54KnMueCtzLnkqcy55K3MueipzLnopO3JldHVybiBzLm5vcm1hbGl6ZSgpLF9lLlRyYW5zZm9ybShuZXcgX2UoZSxzLHIpLGkpfXN0YXRpYyBUcmFuc2Zvcm0oZSx0KXtjb25zdCBpPW5ldyBfZShuZXcgcCgwLDAsMCksbmV3IHAoMCwwLDApKTtyZXR1cm4gX2UuVHJhbnNmb3JtVG9SZWYoZSx0LGkpLGl9c3RhdGljIFRyYW5zZm9ybVRvUmVmKGUsdCxpKXtwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYoZS5vcmlnaW4sdCxpLm9yaWdpbikscC5UcmFuc2Zvcm1Ob3JtYWxUb1JlZihlLmRpcmVjdGlvbix0LGkuZGlyZWN0aW9uKSxpLmxlbmd0aD1lLmxlbmd0aDtjb25zdCBzPWkuZGlyZWN0aW9uLHI9cy5sZW5ndGgoKTtpZighKHI9PT0wfHxyPT09MSkpe2NvbnN0IG49MS9yO3MueCo9bixzLnkqPW4scy56Kj1uLGkubGVuZ3RoKj1yfX11bnByb2plY3RSYXlUb1JlZihlLHQsaSxzLHIsbixhKXt2YXIgbztjb25zdCBoPUQuTWF0cml4WzBdO3IubXVsdGlwbHlUb1JlZihuLGgpLGgubXVsdGlwbHlUb1JlZihhLGgpLGguaW52ZXJ0KCk7Y29uc3QgbD1ELlZlY3RvcjNbMF07bC54PWUvaSoyLTEsbC55PS0odC9zKjItMSksbC56PSEoKG89ZmUuTGFzdENyZWF0ZWRFbmdpbmUpPT09bnVsbHx8bz09PXZvaWQgMCkmJm8uaXNORENIYWxmWlJhbmdlPzA6LTE7Y29uc3QgdT1ELlZlY3RvcjNbMV0uY29weUZyb21GbG9hdHMobC54LGwueSwxLTFlLTgpLGQ9RC5WZWN0b3IzWzJdLGY9RC5WZWN0b3IzWzNdO3AuX1VucHJvamVjdEZyb21JbnZlcnRlZE1hdHJpeFRvUmVmKGwsaCxkKSxwLl9VbnByb2plY3RGcm9tSW52ZXJ0ZWRNYXRyaXhUb1JlZih1LGgsZiksdGhpcy5vcmlnaW4uY29weUZyb20oZCksZi5zdWJ0cmFjdFRvUmVmKGQsdGhpcy5kaXJlY3Rpb24pLHRoaXMuZGlyZWN0aW9uLm5vcm1hbGl6ZSgpfX1fZS5fVG1wVmVjdG9yMz1CZS5CdWlsZEFycmF5KDYscC5aZXJvKSxfZS5fUmF5RGlzdGFudD1fZS5aZXJvKCksX2UuX1NtYWxsbnVtPTFlLTgsX2UuX1JheWw9MWU5LG5lLnByb3RvdHlwZS5jcmVhdGVQaWNraW5nUmF5PWZ1bmN0aW9uKGMsZSx0LGkscz0hMSl7Y29uc3Qgcj1fZS5aZXJvKCk7cmV0dXJuIHRoaXMuY3JlYXRlUGlja2luZ1JheVRvUmVmKGMsZSx0LHIsaSxzKSxyfSxuZS5wcm90b3R5cGUuY3JlYXRlUGlja2luZ1JheVRvUmVmPWZ1bmN0aW9uKGMsZSx0LGkscyxyPSExLG49ITEpe2NvbnN0IGE9dGhpcy5nZXRFbmdpbmUoKTtpZighcyl7aWYoIXRoaXMuYWN0aXZlQ2FtZXJhKXJldHVybiB0aGlzO3M9dGhpcy5hY3RpdmVDYW1lcmF9Y29uc3QgaD1zLnZpZXdwb3J0LnRvR2xvYmFsKGEuZ2V0UmVuZGVyV2lkdGgoKSxhLmdldFJlbmRlckhlaWdodCgpKTtyZXR1cm4gYz1jL2EuZ2V0SGFyZHdhcmVTY2FsaW5nTGV2ZWwoKS1oLngsZT1lL2EuZ2V0SGFyZHdhcmVTY2FsaW5nTGV2ZWwoKS0oYS5nZXRSZW5kZXJIZWlnaHQoKS1oLnktaC5oZWlnaHQpLGkudXBkYXRlKGMsZSxoLndpZHRoLGguaGVpZ2h0LHR8fHguSWRlbnRpdHlSZWFkT25seSxyP3guSWRlbnRpdHlSZWFkT25seTpzLmdldFZpZXdNYXRyaXgoKSxzLmdldFByb2plY3Rpb25NYXRyaXgoKSxuKSx0aGlzfSxuZS5wcm90b3R5cGUuY3JlYXRlUGlja2luZ1JheUluQ2FtZXJhU3BhY2U9ZnVuY3Rpb24oYyxlLHQpe2NvbnN0IGk9X2UuWmVybygpO3JldHVybiB0aGlzLmNyZWF0ZVBpY2tpbmdSYXlJbkNhbWVyYVNwYWNlVG9SZWYoYyxlLGksdCksaX0sbmUucHJvdG90eXBlLmNyZWF0ZVBpY2tpbmdSYXlJbkNhbWVyYVNwYWNlVG9SZWY9ZnVuY3Rpb24oYyxlLHQsaSl7aWYoIVV0KXJldHVybiB0aGlzO2NvbnN0IHM9dGhpcy5nZXRFbmdpbmUoKTtpZighaSl7aWYoIXRoaXMuYWN0aXZlQ2FtZXJhKXRocm93IG5ldyBFcnJvcigiQWN0aXZlIGNhbWVyYSBub3Qgc2V0Iik7aT10aGlzLmFjdGl2ZUNhbWVyYX1jb25zdCBuPWkudmlld3BvcnQudG9HbG9iYWwocy5nZXRSZW5kZXJXaWR0aCgpLHMuZ2V0UmVuZGVySGVpZ2h0KCkpLGE9eC5JZGVudGl0eSgpO3JldHVybiBjPWMvcy5nZXRIYXJkd2FyZVNjYWxpbmdMZXZlbCgpLW4ueCxlPWUvcy5nZXRIYXJkd2FyZVNjYWxpbmdMZXZlbCgpLShzLmdldFJlbmRlckhlaWdodCgpLW4ueS1uLmhlaWdodCksdC51cGRhdGUoYyxlLG4ud2lkdGgsbi5oZWlnaHQsYSxhLGkuZ2V0UHJvamVjdGlvbk1hdHJpeCgpKSx0aGlzfSxuZS5wcm90b3R5cGUuX2ludGVybmFsUGlja0Zvck1lc2g9ZnVuY3Rpb24oYyxlLHQsaSxzLHIsbixhKXtjb25zdCBvPWUoaSx0LmVuYWJsZURpc3RhbnRQaWNraW5nKSxoPXQuaW50ZXJzZWN0cyhvLHMsbixyLGksYSk7cmV0dXJuIWh8fCFoLmhpdHx8IXMmJmMhPW51bGwmJmguZGlzdGFuY2U+PWMuZGlzdGFuY2U/bnVsbDpofSxuZS5wcm90b3R5cGUuX2ludGVybmFsUGljaz1mdW5jdGlvbihjLGUsdCxpLHMpe2xldCByPW51bGw7Zm9yKGxldCBuPTA7bjx0aGlzLm1lc2hlcy5sZW5ndGg7bisrKXtjb25zdCBhPXRoaXMubWVzaGVzW25dO2lmKGUpe2lmKCFlKGEpKWNvbnRpbnVlfWVsc2UgaWYoIWEuaXNFbmFibGVkKCl8fCFhLmlzVmlzaWJsZXx8IWEuaXNQaWNrYWJsZSljb250aW51ZTtjb25zdCBvPWEuZ2V0V29ybGRNYXRyaXgoKTtpZihhLmhhc1RoaW5JbnN0YW5jZXMmJmEudGhpbkluc3RhbmNlRW5hYmxlUGlja2luZyl7Y29uc3QgaD10aGlzLl9pbnRlcm5hbFBpY2tGb3JNZXNoKHIsYyxhLG8sITAsITAscyk7aWYoaCl7aWYoaSlyZXR1cm4gaDtjb25zdCBsPUQuTWF0cml4WzFdLHU9YS50aGluSW5zdGFuY2VHZXRXb3JsZE1hdHJpY2VzKCk7Zm9yKGxldCBkPTA7ZDx1Lmxlbmd0aDtkKyspe3VbZF0ubXVsdGlwbHlUb1JlZihvLGwpO2NvbnN0IF89dGhpcy5faW50ZXJuYWxQaWNrRm9yTWVzaChyLGMsYSxsLHQsaSxzLCEwKTtpZihfJiYocj1fLHIudGhpbkluc3RhbmNlSW5kZXg9ZCx0KSlyZXR1cm4gcn19fWVsc2V7Y29uc3QgaD10aGlzLl9pbnRlcm5hbFBpY2tGb3JNZXNoKHIsYyxhLG8sdCxpLHMpO2lmKGgmJihyPWgsdCkpcmV0dXJuIHJ9fXJldHVybiByfHxuZXcgVXR9LG5lLnByb3RvdHlwZS5faW50ZXJuYWxNdWx0aVBpY2s9ZnVuY3Rpb24oYyxlLHQpe2lmKCFVdClyZXR1cm4gbnVsbDtjb25zdCBpPW5ldyBBcnJheTtmb3IobGV0IHM9MDtzPHRoaXMubWVzaGVzLmxlbmd0aDtzKyspe2NvbnN0IHI9dGhpcy5tZXNoZXNbc107aWYoZSl7aWYoIWUocikpY29udGludWV9ZWxzZSBpZighci5pc0VuYWJsZWQoKXx8IXIuaXNWaXNpYmxlfHwhci5pc1BpY2thYmxlKWNvbnRpbnVlO2NvbnN0IG49ci5nZXRXb3JsZE1hdHJpeCgpO2lmKHIuaGFzVGhpbkluc3RhbmNlcyYmci50aGluSW5zdGFuY2VFbmFibGVQaWNraW5nKXtpZih0aGlzLl9pbnRlcm5hbFBpY2tGb3JNZXNoKG51bGwsYyxyLG4sITAsITAsdCkpe2NvbnN0IG89RC5NYXRyaXhbMV0saD1yLnRoaW5JbnN0YW5jZUdldFdvcmxkTWF0cmljZXMoKTtmb3IobGV0IGw9MDtsPGgubGVuZ3RoO2wrKyl7aFtsXS5tdWx0aXBseVRvUmVmKG4sbyk7Y29uc3QgZD10aGlzLl9pbnRlcm5hbFBpY2tGb3JNZXNoKG51bGwsYyxyLG8sITEsITEsdCwhMCk7ZCYmKGQudGhpbkluc3RhbmNlSW5kZXg9bCxpLnB1c2goZCkpfX19ZWxzZXtjb25zdCBhPXRoaXMuX2ludGVybmFsUGlja0Zvck1lc2gobnVsbCxjLHIsbiwhMSwhMSx0KTthJiZpLnB1c2goYSl9fXJldHVybiBpfSxuZS5wcm90b3R5cGUucGlja1dpdGhCb3VuZGluZ0luZm89ZnVuY3Rpb24oYyxlLHQsaSxzKXtpZighVXQpcmV0dXJuIG51bGw7Y29uc3Qgcj10aGlzLl9pbnRlcm5hbFBpY2sobj0+KHRoaXMuX3RlbXBQaWNraW5nUmF5fHwodGhpcy5fdGVtcFBpY2tpbmdSYXk9X2UuWmVybygpKSx0aGlzLmNyZWF0ZVBpY2tpbmdSYXlUb1JlZihjLGUsbix0aGlzLl90ZW1wUGlja2luZ1JheSxzfHxudWxsKSx0aGlzLl90ZW1wUGlja2luZ1JheSksdCxpLCEwKTtyZXR1cm4gciYmKHIucmF5PXRoaXMuY3JlYXRlUGlja2luZ1JheShjLGUseC5JZGVudGl0eSgpLHN8fG51bGwpKSxyfSxPYmplY3QuZGVmaW5lUHJvcGVydHkobmUucHJvdG90eXBlLCJfcGlja2luZ0F2YWlsYWJsZSIse2dldDooKT0+ITAsZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITF9KSxuZS5wcm90b3R5cGUucGljaz1mdW5jdGlvbihjLGUsdCxpLHMscixuPSExKXtjb25zdCBhPXRoaXMuX2ludGVybmFsUGljaygobyxoKT0+KHRoaXMuX3RlbXBQaWNraW5nUmF5fHwodGhpcy5fdGVtcFBpY2tpbmdSYXk9X2UuWmVybygpKSx0aGlzLmNyZWF0ZVBpY2tpbmdSYXlUb1JlZihjLGUsbyx0aGlzLl90ZW1wUGlja2luZ1JheSxzfHxudWxsLCExLGgpLHRoaXMuX3RlbXBQaWNraW5nUmF5KSx0LGksITEscik7cmV0dXJuIGEmJihhLnJheT10aGlzLmNyZWF0ZVBpY2tpbmdSYXkoYyxlLHguSWRlbnRpdHkoKSxzfHxudWxsKSksYX0sbmUucHJvdG90eXBlLnBpY2tXaXRoUmF5PWZ1bmN0aW9uKGMsZSx0LGkpe2NvbnN0IHM9dGhpcy5faW50ZXJuYWxQaWNrKHI9Pih0aGlzLl9waWNrV2l0aFJheUludmVyc2VNYXRyaXh8fCh0aGlzLl9waWNrV2l0aFJheUludmVyc2VNYXRyaXg9eC5JZGVudGl0eSgpKSxyLmludmVydFRvUmVmKHRoaXMuX3BpY2tXaXRoUmF5SW52ZXJzZU1hdHJpeCksdGhpcy5fY2FjaGVkUmF5Rm9yVHJhbnNmb3JtfHwodGhpcy5fY2FjaGVkUmF5Rm9yVHJhbnNmb3JtPV9lLlplcm8oKSksX2UuVHJhbnNmb3JtVG9SZWYoYyx0aGlzLl9waWNrV2l0aFJheUludmVyc2VNYXRyaXgsdGhpcy5fY2FjaGVkUmF5Rm9yVHJhbnNmb3JtKSx0aGlzLl9jYWNoZWRSYXlGb3JUcmFuc2Zvcm0pLGUsdCwhMSxpKTtyZXR1cm4gcyYmKHMucmF5PWMpLHN9LG5lLnByb3RvdHlwZS5tdWx0aVBpY2s9ZnVuY3Rpb24oYyxlLHQsaSxzKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxNdWx0aVBpY2socj0+dGhpcy5jcmVhdGVQaWNraW5nUmF5KGMsZSxyLGl8fG51bGwpLHQscyl9LG5lLnByb3RvdHlwZS5tdWx0aVBpY2tXaXRoUmF5PWZ1bmN0aW9uKGMsZSx0KXtyZXR1cm4gdGhpcy5faW50ZXJuYWxNdWx0aVBpY2soaT0+KHRoaXMuX3BpY2tXaXRoUmF5SW52ZXJzZU1hdHJpeHx8KHRoaXMuX3BpY2tXaXRoUmF5SW52ZXJzZU1hdHJpeD14LklkZW50aXR5KCkpLGkuaW52ZXJ0VG9SZWYodGhpcy5fcGlja1dpdGhSYXlJbnZlcnNlTWF0cml4KSx0aGlzLl9jYWNoZWRSYXlGb3JUcmFuc2Zvcm18fCh0aGlzLl9jYWNoZWRSYXlGb3JUcmFuc2Zvcm09X2UuWmVybygpKSxfZS5UcmFuc2Zvcm1Ub1JlZihjLHRoaXMuX3BpY2tXaXRoUmF5SW52ZXJzZU1hdHJpeCx0aGlzLl9jYWNoZWRSYXlGb3JUcmFuc2Zvcm0pLHRoaXMuX2NhY2hlZFJheUZvclRyYW5zZm9ybSksZSx0KX0sai5wcm90b3R5cGUuZ2V0Rm9yd2FyZFJheT1mdW5jdGlvbihjPTEwMCxlLHQpe3JldHVybiB0aGlzLmdldEZvcndhcmRSYXlUb1JlZihuZXcgX2UocC5aZXJvKCkscC5aZXJvKCksYyksYyxlLHQpfSxqLnByb3RvdHlwZS5nZXRGb3J3YXJkUmF5VG9SZWY9ZnVuY3Rpb24oYyxlPTEwMCx0LGkpe3JldHVybiB0fHwodD10aGlzLmdldFdvcmxkTWF0cml4KCkpLGMubGVuZ3RoPWUsaT9jLm9yaWdpbi5jb3B5RnJvbShpKTpjLm9yaWdpbi5jb3B5RnJvbSh0aGlzLnBvc2l0aW9uKSxELlZlY3RvcjNbMl0uc2V0KDAsMCx0aGlzLl9zY2VuZS51c2VSaWdodEhhbmRlZFN5c3RlbT8tMToxKSxwLlRyYW5zZm9ybU5vcm1hbFRvUmVmKEQuVmVjdG9yM1syXSx0LEQuVmVjdG9yM1szXSkscC5Ob3JtYWxpemVUb1JlZihELlZlY3RvcjNbM10sYy5kaXJlY3Rpb24pLGN9O3ZhciB5bD1mdW5jdGlvbihjLGUsdCl7Zm9yKHZhciBpIGluIGUpaWYoYy5uYW1lPT09ZVtpXSlyZXR1cm4gdC5wdXNoKGMuaWQpLCEwO3JldHVybiBjLnBhcmVudElkJiZ0LmluZGV4T2YoYy5wYXJlbnRJZCkhPT0tMT8odC5wdXNoKGMuaWQpLCEwKTohMX0sbHM9ZnVuY3Rpb24oYyxlKXtyZXR1cm4gYysiIG9mICIrKGU/ZS5maWxlKyIgZnJvbSAiK2UubmFtZSsiIHZlcnNpb246ICIrZS52ZXJzaW9uKyIsIGV4cG9ydGVyIHZlcnNpb246ICIrZS5leHBvcnRlcl92ZXJzaW9uOiJ1bmtub3duIil9O2xlLlJlZ2lzdGVyUGx1Z2luKHtuYW1lOiJiYWJ5bG9uLmpzIixleHRlbnNpb25zOiIuanNvbiIsY2FuRGlyZWN0TG9hZDpmdW5jdGlvbihjKXtyZXR1cm4gYy5pbmRleE9mKCJqc29uIikhPT0tMSwhMH0saW1wb3J0TWVzaDpmdW5jdGlvbihjLGUsdCxpLHMscixuLGEpe3ZhciBvPSJpbXBvcnRNZXNoIGhhcyBmYWlsZWQgSlNPTiBwYXJzZSI7dHJ5e3ZhciBoPUpTT04ucGFyc2UodCk7aC5waHlzaWNzRW5hYmxlZD0hMSxoPT1udWxsfHxoLm1lc2hlcy5tYXAoUz0+ZGVsZXRlIFMucGh5c2ljc0ltcG9zdG9yKSxvPSIiO3ZhciBsPWxlLmxvZ2dpbmdMZXZlbD09PWxlLkRFVEFJTEVEX0xPR0dJTkc7Yz9BcnJheS5pc0FycmF5KGMpfHwoYz1bY10pOmM9bnVsbDt2YXIgdT1uZXcgQXJyYXk7aWYoaC5tZXNoZXMhPT12b2lkIDAmJmgubWVzaGVzIT09bnVsbCl7dmFyIGQsZjtmb3IoZD0wLGY9aC5tZXNoZXMubGVuZ3RoO2Q8ZjtkKyspe3ZhciBfPWgubWVzaGVzW2RdO2lmKGM9PT1udWxsfHx5bChfLGMsdSkpe2MhPT1udWxsJiZkZWxldGUgY1tjLmluZGV4T2YoXy5uYW1lKV07dmFyIEU9Vy5QYXJzZShfLGUsaSk7cy5wdXNoKEUpLG8rPWAKCU1lc2ggYCtFLnRvU3RyaW5nKGwpfX12YXIgbTtmb3IoZD0wLGY9ZS5tZXNoZXMubGVuZ3RoO2Q8ZjtkKyspbT1lLm1lc2hlc1tkXSxtLl93YWl0aW5nUGFyZW50SWQmJihtLnBhcmVudD1lLmdldExhc3RFbnRyeUJ5SUQobS5fd2FpdGluZ1BhcmVudElkKSxtLl93YWl0aW5nUGFyZW50SWQ9bnVsbCksbS5jb21wdXRlV29ybGRNYXRyaXgoITApfXJldHVybiEwfWNhdGNoKFMpe3ZhciB2PWxzKCJpbXBvcnRNZXNoIixoP2gucHJvZHVjZXI6IlVua25vd24iKStvO2lmKGEpYSh2LFMpO2Vsc2UgdGhyb3cgTy5Mb2codiksU31maW5hbGx5e28hPT1udWxsJiZsZS5sb2dnaW5nTGV2ZWwhPT1sZS5OT19MT0dHSU5HJiZPLkxvZyhscygiaW1wb3J0TWVzaCIsaD9oLnByb2R1Y2VyOiJVbmtub3duIikrKGxlLmxvZ2dpbmdMZXZlbCE9PWxlLk1JTklNQUxfTE9HR0lORz9vOiIiKSl9cmV0dXJuITF9LGxvYWQ6ZnVuY3Rpb24oYyxlLHQsaSl7dmFyIHM9ImltcG9ydFNjZW5lIGhhcyBmYWlsZWQgSlNPTiBwYXJzZSI7dHJ5e3ZhciByPUpTT04ucGFyc2UoZSk7cz0iIixyLmNsZWFyQ29sb3IhPT12b2lkIDAmJnIuY2xlYXJDb2xvciE9PW51bGwmJihjLmNsZWFyQ29sb3I9Q29sb3I0LkZyb21BcnJheShyLmNsZWFyQ29sb3IpKTt2YXIgbj1sb2FkQXNzZXRDb250YWluZXIoYyxlLHQsaSwhMCk7cmV0dXJuISFufWNhdGNoKG8pe3ZhciBhPWxzKCJpbXBvcnRTY2VuZSIscj9yLnByb2R1Y2VyOiJVbmtub3duIikrcztpZihpKWkoYSxvKTtlbHNlIHRocm93IE8uTG9nKGEpLG99ZmluYWxseXtzIT09bnVsbCYmbGUubG9nZ2luZ0xldmVsIT09bGUuTk9fTE9HR0lORyYmTy5Mb2cobHMoImltcG9ydFNjZW5lIixyP3IucHJvZHVjZXI6IlVua25vd24iKSsobGUubG9nZ2luZ0xldmVsIT09bGUuTUlOSU1BTF9MT0dHSU5HP3M6IiIpKX1yZXR1cm4hMX0sbG9hZEFzc2V0Q29udGFpbmVyOmZ1bmN0aW9uKGMsZSx0LGkpe3ZhciBzPWxvYWRBc3NldENvbnRhaW5lcihjLGUsdCxpKTtyZXR1cm4gc319KSxXLl9pbnN0YW5jZWRNZXNoRmFjdG9yeT0oYyxlKT0+e2NvbnN0IHQ9bmV3IENsKGMsZSk7aWYoZS5pbnN0YW5jZWRCdWZmZXJzKXt0Lmluc3RhbmNlZEJ1ZmZlcnM9e307Zm9yKGNvbnN0IGkgaW4gZS5pbnN0YW5jZWRCdWZmZXJzKXQuaW5zdGFuY2VkQnVmZmVyc1tpXT1lLmluc3RhbmNlZEJ1ZmZlcnNbaV19cmV0dXJuIHR9O2NsYXNzIENsIGV4dGVuZHMgb3R7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLHQuZ2V0U2NlbmUoKSksdGhpcy5faW5kZXhJblNvdXJjZU1lc2hJbnN0YW5jZUFycmF5PS0xLHRoaXMuX2Rpc3RhbmNlVG9DYW1lcmE9MCx0LmFkZEluc3RhbmNlKHRoaXMpLHRoaXMuX3NvdXJjZU1lc2g9dCx0aGlzLl91bkluZGV4ZWQ9dC5fdW5JbmRleGVkLHRoaXMucG9zaXRpb24uY29weUZyb20odC5wb3NpdGlvbiksdGhpcy5yb3RhdGlvbi5jb3B5RnJvbSh0LnJvdGF0aW9uKSx0aGlzLnNjYWxpbmcuY29weUZyb20odC5zY2FsaW5nKSx0LnJvdGF0aW9uUXVhdGVybmlvbiYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uPXQucm90YXRpb25RdWF0ZXJuaW9uLmNsb25lKCkpLHRoaXMuYW5pbWF0aW9ucz10LmFuaW1hdGlvbnMuc2xpY2UoKTtmb3IoY29uc3QgaSBvZiB0LmdldEFuaW1hdGlvblJhbmdlcygpKWkhPW51bGwmJnRoaXMuY3JlYXRlQW5pbWF0aW9uUmFuZ2UoaS5uYW1lLGkuZnJvbSxpLnRvKTt0aGlzLmluZmluaXRlRGlzdGFuY2U9dC5pbmZpbml0ZURpc3RhbmNlLHRoaXMuc2V0UGl2b3RNYXRyaXgodC5nZXRQaXZvdE1hdHJpeCgpKSx0aGlzLnJlZnJlc2hCb3VuZGluZ0luZm8oITAsITApLHRoaXMuX3N5bmNTdWJNZXNoZXMoKX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iSW5zdGFuY2VkTWVzaCJ9Z2V0IGxpZ2h0U291cmNlcygpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLl9saWdodFNvdXJjZXN9X3Jlc3luY0xpZ2h0U291cmNlcygpe31fcmVzeW5jTGlnaHRTb3VyY2UoKXt9X3JlbW92ZUxpZ2h0U291cmNlKCl7fWdldCByZWNlaXZlU2hhZG93cygpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLnJlY2VpdmVTaGFkb3dzfWdldCBtYXRlcmlhbCgpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLm1hdGVyaWFsfWdldCB2aXNpYmlsaXR5KCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2gudmlzaWJpbGl0eX1nZXQgc2tlbGV0b24oKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaC5za2VsZXRvbn1nZXQgcmVuZGVyaW5nR3JvdXBJZCgpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLnJlbmRlcmluZ0dyb3VwSWR9c2V0IHJlbmRlcmluZ0dyb3VwSWQoZSl7IXRoaXMuX3NvdXJjZU1lc2h8fGU9PT10aGlzLl9zb3VyY2VNZXNoLnJlbmRlcmluZ0dyb3VwSWR8fE8uV2FybigiTm90ZSAtIHNldHRpbmcgcmVuZGVyaW5nR3JvdXBJZCBvZiBhbiBpbnN0YW5jZWQgbWVzaCBoYXMgbm8gZWZmZWN0IG9uIHRoZSBzY2VuZSIpfWdldFRvdGFsVmVydGljZXMoKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaD90aGlzLl9zb3VyY2VNZXNoLmdldFRvdGFsVmVydGljZXMoKTowfWdldFRvdGFsSW5kaWNlcygpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLmdldFRvdGFsSW5kaWNlcygpfWdldCBzb3VyY2VNZXNoKCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2h9Y3JlYXRlSW5zdGFuY2UoZSl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2guY3JlYXRlSW5zdGFuY2UoZSl9aXNSZWFkeShlPSExKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaC5pc1JlYWR5KGUsITApfWdldFZlcnRpY2VzRGF0YShlLHQpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLmdldFZlcnRpY2VzRGF0YShlLHQpfXNldFZlcnRpY2VzRGF0YShlLHQsaSxzKXtyZXR1cm4gdGhpcy5zb3VyY2VNZXNoJiZ0aGlzLnNvdXJjZU1lc2guc2V0VmVydGljZXNEYXRhKGUsdCxpLHMpLHRoaXMuc291cmNlTWVzaH11cGRhdGVWZXJ0aWNlc0RhdGEoZSx0LGkscyl7cmV0dXJuIHRoaXMuc291cmNlTWVzaCYmdGhpcy5zb3VyY2VNZXNoLnVwZGF0ZVZlcnRpY2VzRGF0YShlLHQsaSxzKSx0aGlzLnNvdXJjZU1lc2h9c2V0SW5kaWNlcyhlLHQ9bnVsbCl7cmV0dXJuIHRoaXMuc291cmNlTWVzaCYmdGhpcy5zb3VyY2VNZXNoLnNldEluZGljZXMoZSx0KSx0aGlzLnNvdXJjZU1lc2h9aXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLmlzVmVydGljZXNEYXRhUHJlc2VudChlKX1nZXRJbmRpY2VzKCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2guZ2V0SW5kaWNlcygpfWdldCBfcG9zaXRpb25zKCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2guX3Bvc2l0aW9uc31yZWZyZXNoQm91bmRpbmdJbmZvKGU9ITEsdD0hMSl7aWYodGhpcy5oYXNCb3VuZGluZ0luZm8mJnRoaXMuZ2V0Qm91bmRpbmdJbmZvKCkuaXNMb2NrZWQpcmV0dXJuIHRoaXM7Y29uc3QgaT10aGlzLl9zb3VyY2VNZXNoLmdlb21ldHJ5P3RoaXMuX3NvdXJjZU1lc2guZ2VvbWV0cnkuYm91bmRpbmdCaWFzOm51bGw7cmV0dXJuIHRoaXMuX3JlZnJlc2hCb3VuZGluZ0luZm8odGhpcy5fc291cmNlTWVzaC5fZ2V0UG9zaXRpb25EYXRhKGUsdCksaSksdGhpc31fcHJlQWN0aXZhdGUoKXtyZXR1cm4gdGhpcy5fY3VycmVudExPRCYmdGhpcy5fY3VycmVudExPRC5fcHJlQWN0aXZhdGUoKSx0aGlzfV9hY3RpdmF0ZShlLHQpe2lmKHN1cGVyLl9hY3RpdmF0ZShlLHQpLHRoaXMuX3NvdXJjZU1lc2guc3ViTWVzaGVzfHxPLldhcm4oIkluc3RhbmNlcyBzaG91bGQgb25seSBiZSBjcmVhdGVkIGZvciBtZXNoZXMgd2l0aCBnZW9tZXRyeS4iKSx0aGlzLl9jdXJyZW50TE9EKXtpZih0aGlzLl9jdXJyZW50TE9ELl9nZXRXb3JsZE1hdHJpeERldGVybWluYW50KCk+PTAhPXRoaXMuX2dldFdvcmxkTWF0cml4RGV0ZXJtaW5hbnQoKT49MClyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fYWN0QXNSZWd1bGFyTWVzaD0hMCwhMDtpZih0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hY3RBc1JlZ3VsYXJNZXNoPSExLHRoaXMuX2N1cnJlbnRMT0QuX3JlZ2lzdGVySW5zdGFuY2VGb3JSZW5kZXJJZCh0aGlzLGUpLHQpe2lmKCF0aGlzLl9jdXJyZW50TE9ELl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9pc0FjdGl2ZUludGVybWVkaWF0ZSlyZXR1cm4gdGhpcy5fY3VycmVudExPRC5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fb25seUZvckluc3RhbmNlc0ludGVybWVkaWF0ZT0hMCwhMH1lbHNlIGlmKCF0aGlzLl9jdXJyZW50TE9ELl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9pc0FjdGl2ZSlyZXR1cm4gdGhpcy5fY3VycmVudExPRC5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fb25seUZvckluc3RhbmNlcz0hMCwhMH1yZXR1cm4hMX1fcG9zdEFjdGl2YXRlKCl7dGhpcy5fc291cmNlTWVzaC5lZGdlc1NoYXJlV2l0aEluc3RhbmNlcyYmdGhpcy5fc291cmNlTWVzaC5fZWRnZXNSZW5kZXJlciYmdGhpcy5fc291cmNlTWVzaC5fZWRnZXNSZW5kZXJlci5pc0VuYWJsZWQmJnRoaXMuX3NvdXJjZU1lc2guX3JlbmRlcmluZ0dyb3VwPyh0aGlzLl9zb3VyY2VNZXNoLl9yZW5kZXJpbmdHcm91cC5fZWRnZXNSZW5kZXJlcnMucHVzaE5vRHVwbGljYXRlKHRoaXMuX3NvdXJjZU1lc2guX2VkZ2VzUmVuZGVyZXIpLHRoaXMuX3NvdXJjZU1lc2guX2VkZ2VzUmVuZGVyZXIuY3VzdG9tSW5zdGFuY2VzLnB1c2godGhpcy5nZXRXb3JsZE1hdHJpeCgpKSk6dGhpcy5fZWRnZXNSZW5kZXJlciYmdGhpcy5fZWRnZXNSZW5kZXJlci5pc0VuYWJsZWQmJnRoaXMuX3NvdXJjZU1lc2guX3JlbmRlcmluZ0dyb3VwJiZ0aGlzLl9zb3VyY2VNZXNoLl9yZW5kZXJpbmdHcm91cC5fZWRnZXNSZW5kZXJlcnMucHVzaCh0aGlzLl9lZGdlc1JlbmRlcmVyKX1nZXRXb3JsZE1hdHJpeCgpe2lmKHRoaXMuX2N1cnJlbnRMT0QmJnRoaXMuX2N1cnJlbnRMT0QuYmlsbGJvYXJkTW9kZSE9PUouQklMTEJPQVJETU9ERV9OT05FJiZ0aGlzLl9jdXJyZW50TE9ELl9tYXN0ZXJNZXNoIT09dGhpcyl7dGhpcy5fYmlsbGJvYXJkV29ybGRNYXRyaXh8fCh0aGlzLl9iaWxsYm9hcmRXb3JsZE1hdHJpeD1uZXcgeCk7Y29uc3QgZT10aGlzLl9jdXJyZW50TE9ELl9tYXN0ZXJNZXNoO3JldHVybiB0aGlzLl9jdXJyZW50TE9ELl9tYXN0ZXJNZXNoPXRoaXMsRC5WZWN0b3IzWzddLmNvcHlGcm9tKHRoaXMuX2N1cnJlbnRMT0QucG9zaXRpb24pLHRoaXMuX2N1cnJlbnRMT0QucG9zaXRpb24uc2V0KDAsMCwwKSx0aGlzLl9iaWxsYm9hcmRXb3JsZE1hdHJpeC5jb3B5RnJvbSh0aGlzLl9jdXJyZW50TE9ELmNvbXB1dGVXb3JsZE1hdHJpeCghMCkpLHRoaXMuX2N1cnJlbnRMT0QucG9zaXRpb24uY29weUZyb20oRC5WZWN0b3IzWzddKSx0aGlzLl9jdXJyZW50TE9ELl9tYXN0ZXJNZXNoPWUsdGhpcy5fYmlsbGJvYXJkV29ybGRNYXRyaXh9cmV0dXJuIHN1cGVyLmdldFdvcmxkTWF0cml4KCl9Z2V0IGlzQW5JbnN0YW5jZSgpe3JldHVybiEwfWdldExPRChlKXtpZighZSlyZXR1cm4gdGhpcztjb25zdCB0PXRoaXMuc291cmNlTWVzaC5nZXRMT0RMZXZlbHMoKTtpZighdHx8dC5sZW5ndGg9PT0wKXRoaXMuX2N1cnJlbnRMT0Q9dGhpcy5zb3VyY2VNZXNoO2Vsc2V7Y29uc3QgaT10aGlzLmdldEJvdW5kaW5nSW5mbygpO3RoaXMuX2N1cnJlbnRMT0Q9dGhpcy5zb3VyY2VNZXNoLmdldExPRChlLGkuYm91bmRpbmdTcGhlcmUpfXJldHVybiB0aGlzLl9jdXJyZW50TE9EfV9wcmVBY3RpdmF0ZUZvckludGVybWVkaWF0ZVJlbmRlcmluZyhlKXtyZXR1cm4gdGhpcy5zb3VyY2VNZXNoLl9wcmVBY3RpdmF0ZUZvckludGVybWVkaWF0ZVJlbmRlcmluZyhlKX1fc3luY1N1Yk1lc2hlcygpe2lmKHRoaXMucmVsZWFzZVN1Yk1lc2hlcygpLHRoaXMuX3NvdXJjZU1lc2guc3ViTWVzaGVzKWZvcihsZXQgZT0wO2U8dGhpcy5fc291cmNlTWVzaC5zdWJNZXNoZXMubGVuZ3RoO2UrKyl0aGlzLl9zb3VyY2VNZXNoLnN1Yk1lc2hlc1tlXS5jbG9uZSh0aGlzLHRoaXMuX3NvdXJjZU1lc2gpO3JldHVybiB0aGlzfV9nZW5lcmF0ZVBvaW50c0FycmF5KCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2guX2dlbmVyYXRlUG9pbnRzQXJyYXkoKX1fdXBkYXRlQm91bmRpbmdJbmZvKCl7cmV0dXJuIHRoaXMuaGFzQm91bmRpbmdJbmZvP3RoaXMuZ2V0Qm91bmRpbmdJbmZvKCkudXBkYXRlKHRoaXMud29ybGRNYXRyaXhGcm9tQ2FjaGUpOnRoaXMuYnVpbGRCb3VuZGluZ0luZm8odGhpcy5hYnNvbHV0ZVBvc2l0aW9uLHRoaXMuYWJzb2x1dGVQb3NpdGlvbix0aGlzLndvcmxkTWF0cml4RnJvbUNhY2hlKSx0aGlzLl91cGRhdGVTdWJNZXNoZXNCb3VuZGluZ0luZm8odGhpcy53b3JsZE1hdHJpeEZyb21DYWNoZSksdGhpc31jbG9uZShlLHQ9bnVsbCxpLHMpe2NvbnN0IHI9KHN8fHRoaXMuX3NvdXJjZU1lc2gpLmNyZWF0ZUluc3RhbmNlKGUpO2lmKHZzLkRlZXBDb3B5KHRoaXMscixbIm5hbWUiLCJzdWJNZXNoZXMiLCJ1bmlxdWVJZCIsInBhcmVudCIsImxpZ2h0U291cmNlcyIsInJlY2VpdmVTaGFkb3dzIiwibWF0ZXJpYWwiLCJ2aXNpYmlsaXR5Iiwic2tlbGV0b24iLCJzb3VyY2VNZXNoIiwiaXNBbkluc3RhbmNlIiwiZmFjZXROYiIsImlzRmFjZXREYXRhRW5hYmxlZCIsImlzQmxvY2tlZCIsInVzZUJvbmVzIiwiaGFzSW5zdGFuY2VzIiwiY29sbGlkZXIiLCJlZGdlc1JlbmRlcmVyIiwiZm9yd2FyZCIsInVwIiwicmlnaHQiLCJhYnNvbHV0ZVBvc2l0aW9uIiwiYWJzb2x1dGVTY2FsaW5nIiwiYWJzb2x1dGVSb3RhdGlvblF1YXRlcm5pb24iLCJpc1dvcmxkTWF0cml4RnJvemVuIiwibm9uVW5pZm9ybVNjYWxpbmciLCJiZWhhdmlvcnMiLCJ3b3JsZE1hdHJpeEZyb21DYWNoZSIsImhhc1RoaW5JbnN0YW5jZXMiLCJoYXNCb3VuZGluZ0luZm8iXSxbXSksdGhpcy5yZWZyZXNoQm91bmRpbmdJbmZvKCksdCYmKHIucGFyZW50PXQpLCFpKWZvcihsZXQgbj0wO248dGhpcy5nZXRTY2VuZSgpLm1lc2hlcy5sZW5ndGg7bisrKXtjb25zdCBhPXRoaXMuZ2V0U2NlbmUoKS5tZXNoZXNbbl07YS5wYXJlbnQ9PT10aGlzJiZhLmNsb25lKGEubmFtZSxyKX1yZXR1cm4gci5jb21wdXRlV29ybGRNYXRyaXgoITApLHRoaXMub25DbG9uZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhyKSxyfWRpc3Bvc2UoZSx0PSExKXt0aGlzLl9zb3VyY2VNZXNoLnJlbW92ZUluc3RhbmNlKHRoaXMpLHN1cGVyLmRpc3Bvc2UoZSx0KX1fc2VyaWFsaXplQXNQYXJlbnQoZSl7c3VwZXIuX3NlcmlhbGl6ZUFzUGFyZW50KGUpLGUucGFyZW50SWQ9dGhpcy5fc291cmNlTWVzaC51bmlxdWVJZCxlLnBhcmVudEluc3RhbmNlSW5kZXg9dGhpcy5faW5kZXhJblNvdXJjZU1lc2hJbnN0YW5jZUFycmF5fWluc3RhbnRpYXRlSGllcmFyY2h5KGU9bnVsbCx0LGkpe2NvbnN0IHM9dGhpcy5jbG9uZSgiQ2xvbmUgb2YgIisodGhpcy5uYW1lfHx0aGlzLmlkKSxlfHx0aGlzLnBhcmVudCwhMCx0JiZ0Lm5ld1NvdXJjZWRNZXNoKTtzJiZpJiZpKHRoaXMscyk7Zm9yKGNvbnN0IHIgb2YgdGhpcy5nZXRDaGlsZFRyYW5zZm9ybU5vZGVzKCEwKSlyLmluc3RhbnRpYXRlSGllcmFyY2h5KHMsdCxpKTtyZXR1cm4gc319Vy5wcm90b3R5cGUucmVnaXN0ZXJJbnN0YW5jZWRCdWZmZXI9ZnVuY3Rpb24oYyxlKXt2YXIgdCxpO2lmKChpPSh0PXRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZSk9PT1udWxsfHx0PT09dm9pZCAwP3ZvaWQgMDp0LnZlcnRleEJ1ZmZlcnNbY10pPT09bnVsbHx8aT09PXZvaWQgMHx8aS5kaXNwb3NlKCksIXRoaXMuaW5zdGFuY2VkQnVmZmVycyl7dGhpcy5pbnN0YW5jZWRCdWZmZXJzPXt9O2Zvcihjb25zdCBzIG9mIHRoaXMuaW5zdGFuY2VzKXMuaW5zdGFuY2VkQnVmZmVycz17fTt0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2V8fCh0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2U9e2RhdGE6e30sdmVydGV4QnVmZmVyczp7fSxzdHJpZGVzOnt9LHNpemVzOnt9LHZlcnRleEFycmF5T2JqZWN0czp0aGlzLmdldEVuZ2luZSgpLmdldENhcHMoKS52ZXJ0ZXhBcnJheU9iamVjdD97fTp2b2lkIDB9KX10aGlzLmluc3RhbmNlZEJ1ZmZlcnNbY109bnVsbCx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2Uuc3RyaWRlc1tjXT1lLHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS5zaXplc1tjXT1lKjMyLHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS5kYXRhW2NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnNpemVzW2NdKSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVyc1tjXT1uZXcgZyh0aGlzLmdldEVuZ2luZSgpLHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS5kYXRhW2NdLGMsITAsITEsZSwhMCk7Zm9yKGNvbnN0IHMgb2YgdGhpcy5pbnN0YW5jZXMpcy5pbnN0YW5jZWRCdWZmZXJzW2NdPW51bGw7dGhpcy5faW52YWxpZGF0ZUluc3RhbmNlVmVydGV4QXJyYXlPYmplY3QoKSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNBdHRyaWJ1dGVzRGlydHkoKX0sVy5wcm90b3R5cGUuX3Byb2Nlc3NJbnN0YW5jZWRCdWZmZXJzPWZ1bmN0aW9uKGMsZSl7Y29uc3QgdD1jP2MubGVuZ3RoOjA7Zm9yKGNvbnN0IGkgaW4gdGhpcy5pbnN0YW5jZWRCdWZmZXJzKXtsZXQgcz10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2Uuc2l6ZXNbaV07Y29uc3Qgcj10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2Uuc3RyaWRlc1tpXSxuPSh0KzEpKnI7Zm9yKDtzPG47KXMqPTI7dGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLmRhdGFbaV0ubGVuZ3RoIT1zJiYodGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLmRhdGFbaV09bmV3IEZsb2F0MzJBcnJheShzKSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2Uuc2l6ZXNbaV09cyx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVyc1tpXSYmKHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS52ZXJ0ZXhCdWZmZXJzW2ldLmRpc3Bvc2UoKSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVyc1tpXT1udWxsKSk7Y29uc3QgYT10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UuZGF0YVtpXTtsZXQgbz0wO2lmKGUpe2NvbnN0IGg9dGhpcy5pbnN0YW5jZWRCdWZmZXJzW2ldO2gudG9BcnJheT9oLnRvQXJyYXkoYSxvKTpoLmNvcHlUb0FycmF5P2guY29weVRvQXJyYXkoYSxvKTphW29dPWgsbys9cn1mb3IobGV0IGg9MDtoPHQ7aCsrKXtjb25zdCB1PWNbaF0uaW5zdGFuY2VkQnVmZmVyc1tpXTt1LnRvQXJyYXk/dS50b0FycmF5KGEsbyk6dS5jb3B5VG9BcnJheT91LmNvcHlUb0FycmF5KGEsbyk6YVtvXT11LG8rPXJ9dGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnNbaV0/dGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnNbaV0udXBkYXRlRGlyZWN0bHkoYSwwKToodGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnNbaV09bmV3IGcodGhpcy5nZXRFbmdpbmUoKSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UuZGF0YVtpXSxpLCEwLCExLHIsITApLHRoaXMuX2ludmFsaWRhdGVJbnN0YW5jZVZlcnRleEFycmF5T2JqZWN0KCkpfX0sVy5wcm90b3R5cGUuX2ludmFsaWRhdGVJbnN0YW5jZVZlcnRleEFycmF5T2JqZWN0PWZ1bmN0aW9uKCl7aWYoISghdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlfHx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QXJyYXlPYmplY3RzPT09dm9pZCAwKSl7Zm9yKGNvbnN0IGMgaW4gdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEFycmF5T2JqZWN0cyl0aGlzLmdldEVuZ2luZSgpLnJlbGVhc2VWZXJ0ZXhBcnJheU9iamVjdCh0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QXJyYXlPYmplY3RzW2NdKTt0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QXJyYXlPYmplY3RzPXt9fX0sVy5wcm90b3R5cGUuX2Rpc3Bvc2VJbnN0YW5jZVNwZWNpZmljRGF0YT1mdW5jdGlvbigpe2Zvcih0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0J1ZmZlciYmKHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UuaW5zdGFuY2VzQnVmZmVyLmRpc3Bvc2UoKSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0J1ZmZlcj1udWxsKTt0aGlzLmluc3RhbmNlcy5sZW5ndGg7KXRoaXMuaW5zdGFuY2VzWzBdLmRpc3Bvc2UoKTtmb3IoY29uc3QgYyBpbiB0aGlzLmluc3RhbmNlZEJ1ZmZlcnMpdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnNbY10mJnRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS52ZXJ0ZXhCdWZmZXJzW2NdLmRpc3Bvc2UoKTt0aGlzLl9pbnZhbGlkYXRlSW5zdGFuY2VWZXJ0ZXhBcnJheU9iamVjdCgpLHRoaXMuaW5zdGFuY2VkQnVmZmVycz17fX07Y29uc3QgV3I9Yz0+SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjKSksSWw9e2Fzc2V0UGF0aDoiIixlbmFibGVTaGFkb3dzOiExLGdyb3VwSWQ6bnVsbCxpZDpudWxsLGxpZ2h0czpbXSxyb2xsSWQ6bnVsbCxzY2VuZTpudWxsfSxYdD1jbGFzc3tjb25zdHJ1Y3RvcihlLHQpe2J0KHRoaXMsInZhbHVlIiwwKTtidCh0aGlzLCJhc2xlZXAiLCExKTt0aGlzLmNvbmZpZz17Li4uSWwsLi4uZX0sdGhpcy5pZD10aGlzLmNvbmZpZy5pZCE9PXZvaWQgMD90aGlzLmNvbmZpZy5pZDpEYXRlLm5vdygpLHRoaXMuc2lkZXM9dGhpcy5jb25maWcuc2lkZXMsdGhpcy5kaWVUeXBlPXRoaXMuY29uZmlnLmRpZVR5cGUsdGhpcy5jb21ib0tleT1gJHt0aGlzLmNvbmZpZy50aGVtZX1fJHt0aGlzLmNvbmZpZy5kaWVUeXBlfWAsdGhpcy5zY2VuZT10LHRoaXMuY3JlYXRlSW5zdGFuY2UoKX1jcmVhdGVJbnN0YW5jZSgpe2NvbnN0IGU9YCR7dGhpcy5jb25maWcubWVzaE5hbWV9XyR7dGhpcy5kaWVUeXBlfV8ke3RoaXMuY29uZmlnLnRoZW1lfSR7dGhpcy5jb25maWcuY29sb3JTdWZmaXh9YCx0PWAke2V9LWluc3RhbmNlLSR7dGhpcy5pZH1gLGk9dGhpcy5zY2VuZS5nZXRNZXNoQnlOYW1lKGUpLmNyZWF0ZUluc3RhbmNlKHQpO2lmKHRoaXMuY29uZmlnLmNvbG9yU3VmZml4Lmxlbmd0aD4wKXtjb25zdCBzPXJlLkZyb21IZXhTdHJpbmcodGhpcy5jb25maWcudGhlbWVDb2xvcik7aS5pbnN0YW5jZWRCdWZmZXJzLmN1c3RvbUNvbG9yPXN9aS5wb3NpdGlvbi55PS0xMDAsaS5zY2FsaW5nPW5ldyBwKGkuc2NhbGluZy54KnRoaXMuY29uZmlnLnNjYWxlLGkuc2NhbGluZy55KnRoaXMuY29uZmlnLnNjYWxlLGkuc2NhbGluZy56KnRoaXMuY29uZmlnLnNjYWxlKSx0aGlzLmNvbmZpZy5lbmFibGVTaGFkb3dzJiZ0aGlzLmNvbmZpZy5saWdodHMuZGlyZWN0aW9uYWwuc2hhZG93R2VuZXJhdG9yLmFkZFNoYWRvd0Nhc3RlcihpKSx0aGlzLm1lc2g9aX1zdGF0aWMgYXN5bmMgbG9hZERpZShlLHQpe2NvbnN0e3NpZGVzOmksdGhlbWU6cz0iZGVmYXVsdCIsbWVzaE5hbWU6cixjb2xvclN1ZmZpeDpufT1lO2UuZGllVHlwZXx8KGUuZGllVHlwZT1OdW1iZXIuaXNJbnRlZ2VyKGkpP2BkJHtpfWA6aSk7Y29uc3QgYT1yKyJfIitlLmRpZVR5cGUsbz1hKyJfIitzK247bGV0IGg9dC5nZXRNZXNoQnlOYW1lKG8pO3JldHVybiBofHwoaD10LmdldE1lc2hCeU5hbWUoYSkuY2xvbmUobykpLGgubWF0ZXJpYWx8fChoLm1hdGVyaWFsPXQuZ2V0TWF0ZXJpYWxCeU5hbWUocytuKSxuLmxlbmd0aD4wJiZoLnJlZ2lzdGVySW5zdGFuY2VkQnVmZmVyKCJjdXN0b21Db2xvciIsMykpLGV9c3RhdGljIGFzeW5jIGxvYWRNb2RlbHMoZSx0KXtjb25zdHttZXNoRmlsZVBhdGg6aSxtZXNoTmFtZTpzLHNjYWxlOnIsZDRGYWNlRG93bjpuPSEwfT1lO2xldCBhPSExLG89ITE7Y29uc3QgaD1hd2FpdCBmZXRjaChgJHtpfWApLnRoZW4obD0+e2lmKGwub2spe2NvbnN0IHU9bC5oZWFkZXJzLmdldCgiY29udGVudC10eXBlIik7aWYodSYmdS5pbmRleE9mKCJhcHBsaWNhdGlvbi9qc29uIikhPT0tMSlyZXR1cm4gbC5qc29uKCk7aWYobC50eXBlJiZsLnR5cGU9PT0iYmFzaWMiKXJldHVybiBsLmpzb24oKTt0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBjb250ZW50VHlwZTogJHt1fS4gRXhwZWN0ZWQgImFwcGxpY2F0aW9uL2pzb24iIG9yICJiYXNpYyJgKX1lbHNlIHRocm93IG5ldyBFcnJvcihgVW5hYmxlIHRvIGxvYWQgM0QgbWVzaCBmaWxlOiAnJHtpfScuIFJlcXVlc3QgcmVqZWN0ZWQgd2l0aCBzdGF0dXMgJHtsLnN0YXR1c306ICR7bC5zdGF0dXNUZXh0fWApfSkuY2F0Y2gobD0+Y29uc29sZS5lcnJvcihsKSk7aWYoaClyZXR1cm4gbGUuSW1wb3J0TWVzaEFzeW5jKG51bGwsbnVsbCwiZGF0YToiK0pTT04uc3RyaW5naWZ5KGgpLHQpLnRoZW4obD0+e2lmKGwubWVzaGVzLmZvckVhY2godT0+e3UubmFtZT09PSJfX3Jvb3RfXyImJnUuZGlzcG9zZSgpLHUubmFtZS5pbmNsdWRlcygiY29sbGlkZXIiKSYmKHUuc2NhbGluZz1uZXcgcCh1LnNjYWxpbmcueCouOSx1LnNjYWxpbmcueSouOSx1LnNjYWxpbmcueiouOSkpLGF8fChhPXUubmFtZT09PSJkMTAwIiksb3x8KG89dS5uYW1lPT09ImQxMCIpLHUuc2V0RW5hYmxlZCghMSksdS5mcmVlemVOb3JtYWxzKCksdS5mcmVlemVXb3JsZE1hdHJpeCgpLHUuaXNQaWNrYWJsZT0hMSx1LmRvTm90U3luY0JvdW5kaW5nSW5mbz0hMCx1Lm5hbWU9cysiXyIrdS5uYW1lfSksIWEmJm8mJih0LmdldE1lc2hCeU5hbWUocysiX2QxMCIpLmNsb25lKHMrIl9kMTAwIiksdC5nZXRNZXNoQnlOYW1lKHMrIl9kMTBfY29sbGlkZXIiKS5jbG9uZShzKyJfZDEwMF9jb2xsaWRlciIpLGguY29sbGlkZXJGYWNlTWFwJiYoaC5jb2xsaWRlckZhY2VNYXAuZDEwMD1XcihoLmNvbGxpZGVyRmFjZU1hcC5kMTApLE9iamVjdC52YWx1ZXMoaC5jb2xsaWRlckZhY2VNYXAuZDEwMCkuZm9yRWFjaCgodSxkKT0+e2guY29sbGlkZXJGYWNlTWFwLmQxMDBbZF09dSoodT09PTEwPzA6MTApfSkpKSwhaC5jb2xsaWRlckZhY2VNYXApdGhyb3cgbmV3IEVycm9yKGAnY29sbGlkZXJGYWNlTWFwJyBkYXRhIG5vdCBmb3VuZCBpbiAke2l9LiBXaXRob3V0IHRoZSBjb2xsaWRlckZhY2VNYXAgZGF0YSBkaWNlIHZhbHVlcyBjYW4gbm90IGJlIHJlc29sdmVkLmApO3QudGhlbWVEYXRhW3NdPXt9LHQudGhlbWVEYXRhW3NdLmNvbGxpZGVyRmFjZU1hcD1oLmNvbGxpZGVyRmFjZU1hcCx0LnRoZW1lRGF0YVtzXS5kNEZhY2VEb3duPW59KS5jYXRjaChsPT5jb25zb2xlLmVycm9yKGwpKSxoLm1lc2hlcy5maWx0ZXIobD0+bC5uYW1lLmluY2x1ZGVzKCJjb2xsaWRlciIpKX11cGRhdGVDb25maWcoZSl7dGhpcy5jb25maWc9ey4uLnRoaXMuY29uZmlnLC4uLmV9fXN0YXRpYyBzZXRWZWN0b3IzKGUsdCxpKXtyZXR1cm4gWHQudmVjdG9yMy5zZXQoZSx0LGkpfXN0YXRpYyBnZXRWZWN0b3IzKCl7cmV0dXJuIFh0LnZlY3RvcjN9c3RhdGljIGFzeW5jIGdldFJvbGxSZXN1bHQoZSx0KXtjb25zdCBpPShzPWUpPT5uZXcgUHJvbWlzZSgocixuKT0+e2NvbnN0IGE9ZS5jb25maWcucGFyZW50TWVzaHx8ZS5jb25maWcubWVzaE5hbWUsbz10LnRoZW1lRGF0YVthXS5jb2xsaWRlckZhY2VNYXAsaD10LnRoZW1lRGF0YVthXS5kNEZhY2VEb3duO2lmKCFvW3MuZGllVHlwZV0pdGhyb3cgbmV3IEVycm9yKGBObyBjb2xsaWRlckZhY2VNYXAgZGF0YSBmb3IgJHtzLmRpZVR5cGV9YCk7Y29uc3QgbD10LmdldE1lc2hCeU5hbWUoYCR7YX1fJHtzLmRpZVR5cGV9X2NvbGxpZGVyYCkuY3JlYXRlSW5zdGFuY2UoYCR7YX1fJHtzLmRpZVR5cGV9LWhpdGJveC0ke3MuaWR9YCk7bC5pc1BpY2thYmxlPSEwLGwuaXNWaXNpYmxlPSEwLGwuc2V0RW5hYmxlZCghMCksbC5wb3NpdGlvbj1zLm1lc2gucG9zaXRpb24sbC5yb3RhdGlvblF1YXRlcm5pb249cy5tZXNoLnJvdGF0aW9uUXVhdGVybmlvbjtsZXQgdT1YdC5zZXRWZWN0b3IzKDAsMSwwKTtzLmRpZVR5cGU9PT0iZDQiJiZoJiYodT1YdC5zZXRWZWN0b3IzKDAsLTEsMCkpLFh0LnJheS5kaXJlY3Rpb249dSxYdC5yYXkub3JpZ2luPWUubWVzaC5wb3NpdGlvbjtjb25zdCBkPXQucGlja1dpdGhSYXkoWHQucmF5KTtpZihsLmRpc3Bvc2UoKSxzLnZhbHVlPW9bcy5kaWVUeXBlXVtkLmZhY2VJZF0scy52YWx1ZT09PXZvaWQgMCl0aHJvdyBuZXcgRXJyb3IoYGNvbGxpZGVyRmFjZU1hcCBFcnJvcjogTm8gdmFsdWUgZm91bmQgZm9yICR7cy5kaWVUeXBlfSBtZXNoIGZhY2UgJHtkLmZhY2VJZH1gKTtyZXR1cm4gcihzLnZhbHVlKX0pLmNhdGNoKHI9PmNvbnNvbGUuZXJyb3IocikpO3JldHVybiBlLm1lc2g/YXdhaXQgaSgpOmUudmFsdWV9fTtsZXQgUHQ9WHQ7YnQoUHQsInJheSIsbmV3IF9lKHAuWmVybygpLHAuWmVybygpLDEpKSxidChQdCwidmVjdG9yMyIscC5aZXJvKCkpO2NsYXNzIFBse2NvbnN0cnVjdG9yKCl7fX1jbGFzcyBpaSBleHRlbmRzIEJ7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLHQpLHRoaXMuQ3VzdG9tUGFydHM9bmV3IFBsLHRoaXMuY3VzdG9tU2hhZGVyTmFtZVJlc29sdmU9dGhpcy5CdWlsZGVyLHRoaXMuRnJhZ21lbnRTaGFkZXI9UGUuU2hhZGVyc1N0b3JlLmRlZmF1bHRQaXhlbFNoYWRlcix0aGlzLlZlcnRleFNoYWRlcj1QZS5TaGFkZXJzU3RvcmUuZGVmYXVsdFZlcnRleFNoYWRlcn1BdHRhY2hBZnRlckJpbmQoZSx0KXtpZih0aGlzLl9uZXdVbmlmb3JtSW5zdGFuY2VzKWZvcihjb25zdCBpIGluIHRoaXMuX25ld1VuaWZvcm1JbnN0YW5jZXMpe2NvbnN0IHM9aS50b1N0cmluZygpLnNwbGl0KCItIik7c1swXT09InZlYzIiP3Quc2V0VmVjdG9yMihzWzFdLHRoaXMuX25ld1VuaWZvcm1JbnN0YW5jZXNbaV0pOnNbMF09PSJ2ZWMzIj90LnNldFZlY3RvcjMoc1sxXSx0aGlzLl9uZXdVbmlmb3JtSW5zdGFuY2VzW2ldKTpzWzBdPT0idmVjNCI/dC5zZXRWZWN0b3I0KHNbMV0sdGhpcy5fbmV3VW5pZm9ybUluc3RhbmNlc1tpXSk6c1swXT09Im1hdDQiP3Quc2V0TWF0cml4KHNbMV0sdGhpcy5fbmV3VW5pZm9ybUluc3RhbmNlc1tpXSk6c1swXT09ImZsb2F0IiYmdC5zZXRGbG9hdChzWzFdLHRoaXMuX25ld1VuaWZvcm1JbnN0YW5jZXNbaV0pfWlmKHRoaXMuX25ld1NhbXBsZXJJbnN0YW5jZXMpZm9yKGNvbnN0IGkgaW4gdGhpcy5fbmV3U2FtcGxlckluc3RhbmNlcyl7Y29uc3Qgcz1pLnRvU3RyaW5nKCkuc3BsaXQoIi0iKTtzWzBdPT0ic2FtcGxlcjJEIiYmdGhpcy5fbmV3U2FtcGxlckluc3RhbmNlc1tpXS5pc1JlYWR5JiZ0aGlzLl9uZXdTYW1wbGVySW5zdGFuY2VzW2ldLmlzUmVhZHkoKSYmdC5zZXRUZXh0dXJlKHNbMV0sdGhpcy5fbmV3U2FtcGxlckluc3RhbmNlc1tpXSl9fVJldmlld1VuaWZvcm0oZSx0KXtpZihlPT0idW5pZm9ybSImJnRoaXMuX25ld1VuaWZvcm1zKWZvcihsZXQgaT0wO2k8dGhpcy5fbmV3VW5pZm9ybXMubGVuZ3RoO2krKyl0aGlzLl9jdXN0b21Vbmlmb3JtW2ldLmluZGV4T2YoInNhbXBsZXIiKT09LTEmJnQucHVzaCh0aGlzLl9uZXdVbmlmb3Jtc1tpXSk7aWYoZT09InNhbXBsZXIiJiZ0aGlzLl9uZXdVbmlmb3Jtcylmb3IobGV0IGk9MDtpPHRoaXMuX25ld1VuaWZvcm1zLmxlbmd0aDtpKyspdGhpcy5fY3VzdG9tVW5pZm9ybVtpXS5pbmRleE9mKCJzYW1wbGVyIikhPS0xJiZ0LnB1c2godGhpcy5fbmV3VW5pZm9ybXNbaV0pO3JldHVybiB0fUJ1aWxkZXIoZSx0LGkscyxyLG4pe2lmKG4mJnRoaXMuX2N1c3RvbUF0dHJpYnV0ZXMmJnRoaXMuX2N1c3RvbUF0dHJpYnV0ZXMubGVuZ3RoPjAmJm4ucHVzaCguLi50aGlzLl9jdXN0b21BdHRyaWJ1dGVzKSx0aGlzLlJldmlld1VuaWZvcm0oInVuaWZvcm0iLHQpLHRoaXMuUmV2aWV3VW5pZm9ybSgic2FtcGxlciIscyksdGhpcy5faXNDcmVhdGVkU2hhZGVyKXJldHVybiB0aGlzLl9jcmVhdGVkU2hhZGVyTmFtZTt0aGlzLl9pc0NyZWF0ZWRTaGFkZXI9ITEsaWkuU2hhZGVySW5kZXhlcisrO2NvbnN0IGE9ImN1c3RvbV8iK2lpLlNoYWRlckluZGV4ZXIsbz10aGlzLl9hZnRlckJpbmQuYmluZCh0aGlzKTtyZXR1cm4gdGhpcy5fYWZ0ZXJCaW5kPShoLGwpPT57aWYobCl7dGhpcy5BdHRhY2hBZnRlckJpbmQoaCxsKTt0cnl7byhoLGwpfWNhdGNoe319fSxQZS5TaGFkZXJzU3RvcmVbYSsiVmVydGV4U2hhZGVyIl09dGhpcy5WZXJ0ZXhTaGFkZXIucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fVkVSVEVYX0JFR0lOIix0aGlzLkN1c3RvbVBhcnRzLlZlcnRleF9CZWdpbj90aGlzLkN1c3RvbVBhcnRzLlZlcnRleF9CZWdpbjoiIikucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fVkVSVEVYX0RFRklOSVRJT05TIiwodGhpcy5fY3VzdG9tVW5pZm9ybT90aGlzLl9jdXN0b21Vbmlmb3JtLmpvaW4oYApgKToiIikrKHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0RlZmluaXRpb25zP3RoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0RlZmluaXRpb25zOiIiKSkucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fQkVHSU4iLHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X01haW5CZWdpbj90aGlzLkN1c3RvbVBhcnRzLlZlcnRleF9NYWluQmVnaW46IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX1ZFUlRFWF9VUERBVEVfUE9TSVRJT04iLHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0JlZm9yZV9Qb3NpdGlvblVwZGF0ZWQ/dGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQmVmb3JlX1Bvc2l0aW9uVXBkYXRlZDoiIikucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fVkVSVEVYX1VQREFURV9OT1JNQUwiLHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0JlZm9yZV9Ob3JtYWxVcGRhdGVkP3RoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0JlZm9yZV9Ob3JtYWxVcGRhdGVkOiIiKS5yZXBsYWNlKCIjZGVmaW5lIENVU1RPTV9WRVJURVhfTUFJTl9FTkQiLHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X01haW5FbmQ/dGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfTWFpbkVuZDoiIiksdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQWZ0ZXJfV29ybGRQb3NDb21wdXRlZCYmKFBlLlNoYWRlcnNTdG9yZVthKyJWZXJ0ZXhTaGFkZXIiXT1QZS5TaGFkZXJzU3RvcmVbYSsiVmVydGV4U2hhZGVyIl0ucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fVkVSVEVYX1VQREFURV9XT1JMRFBPUyIsdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQWZ0ZXJfV29ybGRQb3NDb21wdXRlZCkpLFBlLlNoYWRlcnNTdG9yZVthKyJQaXhlbFNoYWRlciJdPXRoaXMuRnJhZ21lbnRTaGFkZXIucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fRlJBR01FTlRfQkVHSU4iLHRoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVnaW4/dGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9CZWdpbjoiIikucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fRlJBR01FTlRfTUFJTl9CRUdJTiIsdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9NYWluQmVnaW4/dGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9NYWluQmVnaW46IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0RFRklOSVRJT05TIiwodGhpcy5fY3VzdG9tVW5pZm9ybT90aGlzLl9jdXN0b21Vbmlmb3JtLmpvaW4oYApgKToiIikrKHRoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfRGVmaW5pdGlvbnM/dGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9EZWZpbml0aW9uczoiIikpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX1VQREFURV9ESUZGVVNFIix0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0N1c3RvbV9EaWZmdXNlP3RoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQ3VzdG9tX0RpZmZ1c2U6IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX1VQREFURV9BTFBIQSIsdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fQWxwaGE/dGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fQWxwaGE6IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0JFRk9SRV9MSUdIVFMiLHRoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVmb3JlX0xpZ2h0cz90aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9MaWdodHM6IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0JFRk9SRV9GUkFHQ09MT1IiLHRoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVmb3JlX0ZyYWdDb2xvcj90aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9GcmFnQ29sb3I6IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX01BSU5fRU5EIix0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X01haW5FbmQ/dGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9NYWluRW5kOiIiKSx0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9Gb2cmJihQZS5TaGFkZXJzU3RvcmVbYSsiUGl4ZWxTaGFkZXIiXT1QZS5TaGFkZXJzU3RvcmVbYSsiUGl4ZWxTaGFkZXIiXS5yZXBsYWNlKCIjZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9CRUZPUkVfRk9HIix0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9Gb2cpKSx0aGlzLl9pc0NyZWF0ZWRTaGFkZXI9ITAsdGhpcy5fY3JlYXRlZFNoYWRlck5hbWU9YSxhfUFkZFVuaWZvcm0oZSx0LGkpe3JldHVybiB0aGlzLl9jdXN0b21Vbmlmb3JtfHwodGhpcy5fY3VzdG9tVW5pZm9ybT1uZXcgQXJyYXksdGhpcy5fbmV3VW5pZm9ybXM9bmV3IEFycmF5LHRoaXMuX25ld1NhbXBsZXJJbnN0YW5jZXM9e30sdGhpcy5fbmV3VW5pZm9ybUluc3RhbmNlcz17fSksaSYmKHQuaW5kZXhPZigic2FtcGxlciIpIT0tMT90aGlzLl9uZXdTYW1wbGVySW5zdGFuY2VzW3QrIi0iK2VdPWk6dGhpcy5fbmV3VW5pZm9ybUluc3RhbmNlc1t0KyItIitlXT1pKSx0aGlzLl9jdXN0b21Vbmlmb3JtLnB1c2goInVuaWZvcm0gIit0KyIgIitlKyI7IiksdGhpcy5fbmV3VW5pZm9ybXMucHVzaChlKSx0aGlzfUFkZEF0dHJpYnV0ZShlKXtyZXR1cm4gdGhpcy5fY3VzdG9tQXR0cmlidXRlc3x8KHRoaXMuX2N1c3RvbUF0dHJpYnV0ZXM9W10pLHRoaXMuX2N1c3RvbUF0dHJpYnV0ZXMucHVzaChlKSx0aGlzfUZyYWdtZW50X0JlZ2luKGUpe3JldHVybiB0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZ2luPWUsdGhpc31GcmFnbWVudF9EZWZpbml0aW9ucyhlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9EZWZpbml0aW9ucz1lLHRoaXN9RnJhZ21lbnRfTWFpbkJlZ2luKGUpe3JldHVybiB0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X01haW5CZWdpbj1lLHRoaXN9RnJhZ21lbnRfTWFpbkVuZChlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9NYWluRW5kPWUsdGhpc31GcmFnbWVudF9DdXN0b21fRGlmZnVzZShlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fRGlmZnVzZT1lLnJlcGxhY2UoInJlc3VsdCIsImRpZmZ1c2VDb2xvciIpLHRoaXN9RnJhZ21lbnRfQ3VzdG9tX0FscGhhKGUpe3JldHVybiB0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0N1c3RvbV9BbHBoYT1lLnJlcGxhY2UoInJlc3VsdCIsImFscGhhIiksdGhpc31GcmFnbWVudF9CZWZvcmVfTGlnaHRzKGUpe3JldHVybiB0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9MaWdodHM9ZSx0aGlzfUZyYWdtZW50X0JlZm9yZV9Gb2coZSl7cmV0dXJuIHRoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVmb3JlX0ZvZz1lLHRoaXN9RnJhZ21lbnRfQmVmb3JlX0ZyYWdDb2xvcihlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9CZWZvcmVfRnJhZ0NvbG9yPWUucmVwbGFjZSgicmVzdWx0IiwiY29sb3IiKSx0aGlzfVZlcnRleF9CZWdpbihlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQmVnaW49ZSx0aGlzfVZlcnRleF9EZWZpbml0aW9ucyhlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfRGVmaW5pdGlvbnM9ZSx0aGlzfVZlcnRleF9NYWluQmVnaW4oZSl7cmV0dXJuIHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X01haW5CZWdpbj1lLHRoaXN9VmVydGV4X0JlZm9yZV9Qb3NpdGlvblVwZGF0ZWQoZSl7cmV0dXJuIHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0JlZm9yZV9Qb3NpdGlvblVwZGF0ZWQ9ZS5yZXBsYWNlKCJyZXN1bHQiLCJwb3NpdGlvblVwZGF0ZWQiKSx0aGlzfVZlcnRleF9CZWZvcmVfTm9ybWFsVXBkYXRlZChlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQmVmb3JlX05vcm1hbFVwZGF0ZWQ9ZS5yZXBsYWNlKCJyZXN1bHQiLCJub3JtYWxVcGRhdGVkIiksdGhpc31WZXJ0ZXhfQWZ0ZXJfV29ybGRQb3NDb21wdXRlZChlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQWZ0ZXJfV29ybGRQb3NDb21wdXRlZD1lLHRoaXN9VmVydGV4X01haW5FbmQoZSl7cmV0dXJuIHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X01haW5FbmQ9ZSx0aGlzfX1paS5TaGFkZXJJbmRleGVyPTEsaXQoIkJBQllMT04uQ3VzdG9tTWF0ZXJpYWwiLGlpKSxpaS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oYyl7Y29uc3QgZT10aGlzLHQ9YWUuQ2xvbmUoKCk9Pm5ldyBpaShjLHRoaXMuZ2V0U2NlbmUoKSksdGhpcyk7cmV0dXJuIHQubmFtZT1jLHQuaWQ9Yyx0LkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZ2luPWUuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVnaW4sdC5DdXN0b21QYXJ0cy5GcmFnbWVudF9EZWZpbml0aW9ucz1lLkN1c3RvbVBhcnRzLkZyYWdtZW50X0RlZmluaXRpb25zLHQuQ3VzdG9tUGFydHMuRnJhZ21lbnRfTWFpbkJlZ2luPWUuQ3VzdG9tUGFydHMuRnJhZ21lbnRfTWFpbkJlZ2luLHQuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQ3VzdG9tX0RpZmZ1c2U9ZS5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fRGlmZnVzZSx0LkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9MaWdodHM9ZS5DdXN0b21QYXJ0cy5GcmFnbWVudF9CZWZvcmVfTGlnaHRzLHQuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVmb3JlX0ZvZz1lLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9Gb2csdC5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fQWxwaGE9ZS5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fQWxwaGEsdC5DdXN0b21QYXJ0cy5GcmFnbWVudF9CZWZvcmVfRnJhZ0NvbG9yPWUuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVmb3JlX0ZyYWdDb2xvcix0LkN1c3RvbVBhcnRzLlZlcnRleF9CZWdpbj1lLkN1c3RvbVBhcnRzLlZlcnRleF9CZWdpbix0LkN1c3RvbVBhcnRzLlZlcnRleF9EZWZpbml0aW9ucz1lLkN1c3RvbVBhcnRzLlZlcnRleF9EZWZpbml0aW9ucyx0LkN1c3RvbVBhcnRzLlZlcnRleF9NYWluQmVnaW49ZS5DdXN0b21QYXJ0cy5WZXJ0ZXhfTWFpbkJlZ2luLHQuQ3VzdG9tUGFydHMuVmVydGV4X0JlZm9yZV9Qb3NpdGlvblVwZGF0ZWQ9ZS5DdXN0b21QYXJ0cy5WZXJ0ZXhfQmVmb3JlX1Bvc2l0aW9uVXBkYXRlZCx0LkN1c3RvbVBhcnRzLlZlcnRleF9CZWZvcmVfTm9ybWFsVXBkYXRlZD1lLkN1c3RvbVBhcnRzLlZlcnRleF9CZWZvcmVfTm9ybWFsVXBkYXRlZCx0LkN1c3RvbVBhcnRzLlZlcnRleF9BZnRlcl9Xb3JsZFBvc0NvbXB1dGVkPWUuQ3VzdG9tUGFydHMuVmVydGV4X0FmdGVyX1dvcmxkUG9zQ29tcHV0ZWQsdC5DdXN0b21QYXJ0cy5WZXJ0ZXhfTWFpbkVuZD1lLkN1c3RvbVBhcnRzLlZlcnRleF9NYWluRW5kLHR9O2NsYXNzIERse2NvbnN0cnVjdG9yKGUpe2J0KHRoaXMsImxvYWRlZFRoZW1lcyIse30pO2J0KHRoaXMsInRoZW1lRGF0YSIse30pO3RoaXMuc2NlbmU9ZS5zY2VuZX1hc3luYyBsb2FkU3RhbmRhcmRNYXRlcmlhbChlKXtjb25zdHt0aGVtZTp0LG1hdGVyaWFsOml9PWUscz1uZXcgQih0LHRoaXMuc2NlbmUpO2kuZGlmZnVzZVRleHR1cmUmJihzLmRpZmZ1c2VUZXh0dXJlPWF3YWl0IHRoaXMuZ2V0VGV4dHVyZSgiZGlmZnVzZSIsZSkpLGkuYnVtcFRleHR1cmUmJihzLmJ1bXBUZXh0dXJlPWF3YWl0IHRoaXMuZ2V0VGV4dHVyZSgiYnVtcCIsZSkpLGkuc3BlY3VsYXJUZXh0dXJlJiYocy5zcGVjdWxhclRleHR1cmU9YXdhaXQgdGhpcy5nZXRUZXh0dXJlKCJzcGVjdWxhciIsZSkpLHMuYWxsb3dTaGFkZXJIb3RTd2FwcGluZz0hMX1hc3luYyBsb2FkQ29sb3JNYXRlcmlhbChlKXtjb25zdHt0aGVtZTp0LG1hdGVyaWFsOml9PWUscz1uZXcgaWkodCsiX2xpZ2h0Iix0aGlzLnNjZW5lKSxyPVdyKGUpO2kuZGlmZnVzZVRleHR1cmUmJmkuZGlmZnVzZVRleHR1cmUubGlnaHQmJihyLm1hdGVyaWFsLmRpZmZ1c2VUZXh0dXJlPWUubWF0ZXJpYWwuZGlmZnVzZVRleHR1cmUubGlnaHQscy5kaWZmdXNlVGV4dHVyZT1hd2FpdCB0aGlzLmdldFRleHR1cmUoImRpZmZ1c2UiLHIpKSxpLmJ1bXBUZXh0dXJlJiYocy5idW1wVGV4dHVyZT1hd2FpdCB0aGlzLmdldFRleHR1cmUoImJ1bXAiLGUpKSxpLnNwZWN1bGFyVGV4dHVyZSYmKHMuc3BlY3VsYXJUZXh0dXJlPWF3YWl0IHRoaXMuZ2V0VGV4dHVyZSgic3BlY3VsYXIiLGUpKSxzLmFsbG93U2hhZGVySG90U3dhcHBpbmc9ITEscy5WZXJ0ZXhfRGVmaW5pdGlvbnMoYAogICAgICBhdHRyaWJ1dGUgdmVjMyBjdXN0b21Db2xvcjsKICAgICAgdmFyeWluZyB2ZWMzIHZDb2xvcjsKICAgIGApLlZlcnRleF9NYWluRW5kKGAKICAgICAgdkNvbG9yID0gY3VzdG9tQ29sb3I7CiAgICBgKS5GcmFnbWVudF9EZWZpbml0aW9ucyhgCiAgICAgIHZhcnlpbmcgdmVjMyB2Q29sb3I7CiAgICBgKS5GcmFnbWVudF9DdXN0b21fRGlmZnVzZShgCiAgICAgIGJhc2VDb2xvci5yZ2IgPSBtaXgodkNvbG9yLnJnYiwgYmFzZUNvbG9yLnJnYiwgYmFzZUNvbG9yLmEpOwogICAgYCkscy5BZGRBdHRyaWJ1dGUoImN1c3RvbUNvbG9yIik7Y29uc3Qgbj1zLmNsb25lKHQrIl9kYXJrIik7aS5kaWZmdXNlVGV4dHVyZSYmaS5kaWZmdXNlVGV4dHVyZS5kYXJrJiYoci5tYXRlcmlhbC5kaWZmdXNlVGV4dHVyZT1lLm1hdGVyaWFsLmRpZmZ1c2VUZXh0dXJlLmRhcmssbi5kaWZmdXNlVGV4dHVyZT1hd2FpdCB0aGlzLmdldFRleHR1cmUoImRpZmZ1c2UiLHIpKSxuLkFkZEF0dHJpYnV0ZSgiY3VzdG9tQ29sb3IiKX1hc3luYyBnZXRUZXh0dXJlKGUsdCl7Y29uc3R7YmFzZVBhdGg6aSxtYXRlcmlhbDpzLHRoZW1lOnJ9PXQ7bGV0IG47Y29uc3QgYT1lKyJMZXZlbCIsbz1lKyJUZXh0dXJlIjt0cnl7c3dpdGNoKGUpe2Nhc2UiZGlmZnVzZSI6bj1hd2FpdCB0aGlzLmltcG9ydFRleHR1cmVBc3luYyhgJHtpfS8ke3Nbb119YCxyKSxzW2FdJiYobi5sZXZlbD1zW2FdKTticmVhaztjYXNlImJ1bXAiOm49YXdhaXQgdGhpcy5pbXBvcnRUZXh0dXJlQXN5bmMoYCR7aX0vJHtzW29dfWAsciksc1thXSYmKG4ubGV2ZWw9c1thXSk7YnJlYWs7Y2FzZSJzcGVjdWxhciI6bj1hd2FpdCB0aGlzLmltcG9ydFRleHR1cmVBc3luYyhgJHtpfS8ke3Nbb119YCxyKSxzLnNwZWN1bGFyUG93ZXImJihuLnNwZWN1bGFyUG93ZXI9cy5zcGVjdWxhclBvd2VyKTticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgVGV4dHVyZSB0eXBlOiAke2V9IGlzIG5vdCBzdXBwb3J0ZWRgKX19Y2F0Y2goaCl7Y29uc29sZS5lcnJvcihoKX1yZXR1cm4gbn1hc3luYyBpbXBvcnRUZXh0dXJlQXN5bmMoZSx0KXtyZXR1cm4gbmV3IFByb21pc2UoKGkscyk9PntsZXQgcj1lLm1hdGNoKC9eKC4qXC8pKC4qKSQvKSxuPW5ldyBOKGUsdGhpcy5zY2VuZSx2b2lkIDAsITAsdm9pZCAwLCgpPT5pKG4pLCgpPT5zKGBVbmFibGUgdG8gbG9hZCB0ZXh0dXJlICcke3JbMl19JyBmb3IgdGhlbWU6ICcke3R9Jy4gQ2hlY2sgdGhhdCB5b3VyIGFzc2V0UGF0aCBpcyBjb25maWd1cmVkIGNvcnJlY3RseSBhbmQgdGhhdCB0aGUgZmlsZXMgZXhpc3QgYXQgcGF0aDogJyR7clsxXX0nYCkpfSkuY2F0Y2goaT0+Y29uc29sZS5lcnJvcihpKSl9YXN5bmMgbG9hZChlKXtjb25zdHttYXRlcmlhbDp0fT1lO3QudHlwZT09PSJjb2xvciI/YXdhaXQgdGhpcy5sb2FkQ29sb3JNYXRlcmlhbChlKTp0LnR5cGU9PT0ic3RhbmRhcmQiP2F3YWl0IHRoaXMubG9hZFN0YW5kYXJkTWF0ZXJpYWwoZSk6Y29uc29sZS5lcnJvcihgTWF0ZXJpYWwgdHlwZTogJHt0LnR5cGV9IG5vdCBzdXBwb3J0ZWRgKX19Y2xhc3MgRmx7Y29uc3RydWN0b3IoZSl7bnQodGhpcyx1cyk7YnQodGhpcywiY29uZmlnIik7YnQodGhpcywiaW5pdGlhbGl6ZWQiLCExKTtudCh0aGlzLFhlLHt9KTtudCh0aGlzLEFpLDApO250KHRoaXMsRnQsMCk7bnQodGhpcyxSaSxbXSk7bnQodGhpcyxNdCx2b2lkIDApO250KHRoaXMsVHQsdm9pZCAwKTtudCh0aGlzLEplLHZvaWQgMCk7bnQodGhpcyxjcyx2b2lkIDApO250KHRoaXMsQXQsdm9pZCAwKTtudCh0aGlzLFZpLHZvaWQgMCk7bnQodGhpcyxXaSx2b2lkIDApO250KHRoaXMsZ3Qsdm9pZCAwKTtudCh0aGlzLHppLHt9KTtidCh0aGlzLCJub29wIiwoKT0+e30pO2J0KHRoaXMsImRpY2VCdWZmZXJWaWV3IixuZXcgRmxvYXQzMkFycmF5KDhlMykpO3RoaXMub25Jbml0Q29tcGxldGU9ZS5vbkluaXRDb21wbGV0ZXx8dGhpcy5ub29wLHRoaXMub25UaGVtZUxvYWRlZD1lLm9uVGhlbWVMb2FkZWR8fHRoaXMubm9vcCx0aGlzLm9uUm9sbFJlc3VsdD1lLm9uUm9sbFJlc3VsdHx8dGhpcy5ub29wLHRoaXMub25Sb2xsQ29tcGxldGU9ZS5vblJvbGxDb21wbGV0ZXx8dGhpcy5ub29wLHRoaXMub25EaWVSZW1vdmVkPWUub25EaWVSZW1vdmVkfHx0aGlzLm5vb3AsdGhpcy5pbml0aWFsaXplZD10aGlzLmluaXRTY2VuZShlKX1hc3luYyBpbml0U2NlbmUoZSl7bHQodGhpcyxNdCxlLmNhbnZhcyksWSh0aGlzLE10KS53aWR0aD1lLndpZHRoLFkodGhpcyxNdCkuaGVpZ2h0PWUuaGVpZ2h0LHRoaXMuY29uZmlnPWUub3B0aW9ucyxsdCh0aGlzLFR0LGduKFkodGhpcyxNdCkpKSxsdCh0aGlzLEplLEtuKHtlbmdpbmU6WSh0aGlzLFR0KX0pKSxsdCh0aGlzLGNzLFluKHtlbmdpbmU6WSh0aGlzLFR0KSxzY2VuZTpZKHRoaXMsSmUpfSkpLGx0KHRoaXMsQXQsQnIoe2VuYWJsZVNoYWRvd3M6dGhpcy5jb25maWcuZW5hYmxlU2hhZG93cyxzaGFkb3dUcmFuc3BhcmVuY3k6dGhpcy5jb25maWcuc2hhZG93VHJhbnNwYXJlbmN5LGludGVuc2l0eTp0aGlzLmNvbmZpZy5saWdodEludGVuc2l0eSxzY2VuZTpZKHRoaXMsSmUpfSkpLGx0KHRoaXMsVmksbmV3IFJsKHtlbmFibGVTaGFkb3dzOnRoaXMuY29uZmlnLmVuYWJsZVNoYWRvd3MsYXNwZWN0OlkodGhpcyxNdCkud2lkdGgvWSh0aGlzLE10KS5oZWlnaHQsbGlnaHRzOlkodGhpcyxBdCksc2NlbmU6WSh0aGlzLEplKX0pKSxsdCh0aGlzLFdpLG5ldyBEbCh7c2NlbmU6WSh0aGlzLEplKX0pKSx0aGlzLm9uSW5pdENvbXBsZXRlKCl9Y29ubmVjdChlKXtsdCh0aGlzLGd0LGUpLFkodGhpcyxndCkucG9zdE1lc3NhZ2Uoe2FjdGlvbjoiaW5pdEJ1ZmZlciIsZGljZUJ1ZmZlcjp0aGlzLmRpY2VCdWZmZXJWaWV3LmJ1ZmZlcn0sW3RoaXMuZGljZUJ1ZmZlclZpZXcuYnVmZmVyXSksWSh0aGlzLGd0KS5vbm1lc3NhZ2U9dD0+e3N3aXRjaCh0LmRhdGEuYWN0aW9uKXtjYXNlInVwZGF0ZXMiOnRoaXMudXBkYXRlc0Zyb21QaHlzaWNzKHQuZGF0YS5kaWNlQnVmZmVyKTticmVhaztkZWZhdWx0OmNvbnNvbGUuZXJyb3IoImFjdGlvbiBmcm9tIHBoeXNpY3NXb3JrZXIgbm90IGZvdW5kIGluIG9mZnNjcmVlbiB3b3JrZXIiKTticmVha319fXVwZGF0ZUNvbmZpZyhlKXtjb25zdCB0PXRoaXMuY29uZmlnO3RoaXMuY29uZmlnPWUsdC5lbmFibGVTaGFkb3dzIT09dGhpcy5jb25maWcuZW5hYmxlU2hhZG93cyYmKE9iamVjdC52YWx1ZXMoWSh0aGlzLEF0KSkuZm9yRWFjaChpPT5pLmRpc3Bvc2UoKSksbHQodGhpcyxBdCxCcih7ZW5hYmxlU2hhZG93czp0aGlzLmNvbmZpZy5lbmFibGVTaGFkb3dzfSkpKSx0LnNjYWxlIT09dGhpcy5jb25maWcuc2NhbGUmJk9iamVjdC52YWx1ZXMoWSh0aGlzLFhlKSkuZm9yRWFjaCgoe21lc2g6aX0pPT57aSYmKGkuc2NhbGluZz1uZXcgcCh0aGlzLmNvbmZpZy5zY2FsZSx0aGlzLmNvbmZpZy5zY2FsZSx0aGlzLmNvbmZpZy5zY2FsZSkpfSksdC5zaGFkb3dUcmFuc3BhcmVuY3khPT10aGlzLmNvbmZpZy5zaGFkb3dUcmFuc3BhcmVuY3kmJihZKHRoaXMsQXQpLmRpcmVjdGlvbmFsLnNoYWRvd0dlbmVyYXRvci5kYXJrbmVzcz10aGlzLmNvbmZpZy5zaGFkb3dUcmFuc3BhcmVuY3kpLHQubGlnaHRJbnRlbnNpdHkhPT10aGlzLmNvbmZpZy5saWdodEludGVuc2l0eSYmKFkodGhpcyxBdCkuZGlyZWN0aW9uYWwuaW50ZW5zaXR5PS42NSp0aGlzLmNvbmZpZy5saWdodEludGVuc2l0eSxZKHRoaXMsQXQpLmhlbWlzcGhlcmljLmludGVuc2l0eT0uNCp0aGlzLmNvbmZpZy5saWdodEludGVuc2l0eSl9cmVuZGVyKGUpe1kodGhpcyxUdCkucnVuUmVuZGVyTG9vcCh0aGlzLnJlbmRlckxvb3AuYmluZCh0aGlzKSksWSh0aGlzLGd0KS5wb3N0TWVzc2FnZSh7YWN0aW9uOiJyZXN1bWVTaW11bGF0aW9uIixuZXdTdGFydFBvaW50OmV9KX1yZW5kZXJMb29wKCl7WSh0aGlzLEZ0KSYmWSh0aGlzLEZ0KT09PU9iamVjdC5rZXlzKFkodGhpcyxYZSkpLmxlbmd0aD8oWSh0aGlzLFR0KS5zdG9wUmVuZGVyTG9vcCgpLFkodGhpcyxndCkucG9zdE1lc3NhZ2Uoe2FjdGlvbjoic3RvcFNpbXVsYXRpb24ifSksdGhpcy5vblJvbGxDb21wbGV0ZSgpKTpZKHRoaXMsSmUpLnJlbmRlcigpfWFzeW5jIGxvYWRUaGVtZShlKXtjb25zdHt0aGVtZTp0LGJhc2VQYXRoOmksbWF0ZXJpYWw6cyxtZXNoRmlsZVBhdGg6cixtZXNoTmFtZTpufT1lO2lmKGF3YWl0IFkodGhpcyxXaSkubG9hZCh7dGhlbWU6dCxiYXNlUGF0aDppLG1hdGVyaWFsOnN9KSwhT2JqZWN0LmtleXMoWSh0aGlzLHppKSkuaW5jbHVkZXMobikpe1kodGhpcyx6aSlbbl09cjtjb25zdCBhPWF3YWl0IFB0LmxvYWRNb2RlbHMoe21lc2hGaWxlUGF0aDpyLG1lc2hOYW1lOm59LFkodGhpcyxKZSkpO2lmKCFhKXRocm93IG5ldyBFcnJvcigiTm8gY29sbGlkZXJzIHJldHVybmVkIGZyb20gdGhlIDNEIG1lc2ggZmlsZS4gTG93IHBvbHkgY29sbGlkZXJzIGFyZSBleHBlY3RlZCB0byBiZSBpbiB0aGUgc2FtZSBmaWxlIGFzIHRoZSBoaWdoIHBvbHkgZGljZSBhbmQgdGhlIG1lc2ggbmFtZSBjb250YWlucyB0aGUgd29yZCAnY29sbGlkZXInIik7WSh0aGlzLGd0KS5wb3N0TWVzc2FnZSh7YWN0aW9uOiJsb2FkTW9kZWxzIixvcHRpb25zOntjb2xsaWRlcnM6YSxtZXNoTmFtZTpufX0pfXRoaXMub25UaGVtZUxvYWRlZCh7aWQ6dH0pfWNsZWFyKCl7IU9iamVjdC5rZXlzKFkodGhpcyxYZSkpLmxlbmd0aCYmIVkodGhpcyxGdCl8fCh0aGlzLmRpY2VCdWZmZXJWaWV3LmJ5dGVMZW5ndGgmJnRoaXMuZGljZUJ1ZmZlclZpZXcuZmlsbCgwKSxZKHRoaXMsUmkpLmZvckVhY2goZT0+Y2xlYXJUaW1lb3V0KGUpKSxZKHRoaXMsVHQpLnN0b3BSZW5kZXJMb29wKCksT2JqZWN0LnZhbHVlcyhZKHRoaXMsWGUpKS5mb3JFYWNoKGU9PntlLm1lc2gmJmUubWVzaC5kaXNwb3NlKCl9KSxsdCh0aGlzLFhlLHt9KSxsdCh0aGlzLEFpLDApLGx0KHRoaXMsRnQsMCksWSh0aGlzLEplKS5yZW5kZXIoKSl9YWRkKGUpe1B0LmxvYWREaWUoZSxZKHRoaXMsSmUpKS50aGVuKHQ9PntZKHRoaXMsUmkpLnB1c2goc2V0VGltZW91dCgoKT0+e3pyKHRoaXMsdXMsR3IpLmNhbGwodGhpcyx0KX0seWkodGhpcyxBaSkuXysrKnRoaXMuY29uZmlnLmRlbGF5KSl9KX1hZGROb25EaWUoZSl7WSh0aGlzLFR0KS5hY3RpdmVSZW5kZXJMb29wcy5sZW5ndGg9PT0wJiZ0aGlzLnJlbmRlcighMSk7Y29uc3R7aWQ6dCx2YWx1ZTppLC4uLnN9PWUscj17aWQ6dCx2YWx1ZTppLGNvbmZpZzpzfTtZKHRoaXMsWGUpW3RdPXIsc2V0VGltZW91dCgoKT0+e1kodGhpcyxSaSkucHVzaChzZXRUaW1lb3V0KCgpPT57dGhpcy5oYW5kbGVBc2xlZXAocil9LHlpKHRoaXMsQWkpLl8rKyp0aGlzLmNvbmZpZy5kZWxheSkpfSwxMCl9cmVtb3ZlKGUpe2NvbnN0IHQ9WSh0aGlzLFhlKVtlLmlkXTt0Lmhhc093blByb3BlcnR5KCJkMTBJbnN0YW5jZSIpJiYoWSh0aGlzLFhlKVt0LmQxMEluc3RhbmNlLmlkXS5tZXNoJiYoWSh0aGlzLFhlKVt0LmQxMEluc3RhbmNlLmlkXS5tZXNoLmRpc3Bvc2UoKSxZKHRoaXMsZ3QpLnBvc3RNZXNzYWdlKHthY3Rpb246InJlbW92ZURpZSIsaWQ6dC5kMTBJbnN0YW5jZS5pZH0pKSxkZWxldGUgWSh0aGlzLFhlKVt0LmQxMEluc3RhbmNlLmlkXSx5aSh0aGlzLEZ0KS5fLS0pLFkodGhpcyxYZSlbZS5pZF0ubWVzaCYmWSh0aGlzLFhlKVtlLmlkXS5tZXNoLmRpc3Bvc2UoKSxkZWxldGUgWSh0aGlzLFhlKVtlLmlkXSx5aSh0aGlzLEZ0KS5fLS0sWSh0aGlzLEplKS5yZW5kZXIoKSx0aGlzLm9uRGllUmVtb3ZlZChlLnJvbGxJZCl9dXBkYXRlc0Zyb21QaHlzaWNzKGUpe3RoaXMuZGljZUJ1ZmZlclZpZXc9bmV3IEZsb2F0MzJBcnJheShlKTtsZXQgdD0xO2ZvcihsZXQgaT0wLHM9dGhpcy5kaWNlQnVmZmVyVmlld1swXTtpPHM7aSsrKXtpZighT2JqZWN0LmtleXMoWSh0aGlzLFhlKSkubGVuZ3RoKWNvbnRpbnVlO2NvbnN0IHI9WSh0aGlzLFhlKVtgJHt0aGlzLmRpY2VCdWZmZXJWaWV3W3RdfWBdO2lmKCFyKXtjb25zb2xlLmxvZygiRXJyb3I6IGRpZSBub3QgYXZhaWxhYmxlIGluIHNjZW5lIHRvIGFuaW1hdGUiKTticmVha31pZih0aGlzLmRpY2VCdWZmZXJWaWV3W3QrMV09PT0tMSl0aGlzLmhhbmRsZUFzbGVlcChyKTtlbHNle2NvbnN0IG49dGhpcy5kaWNlQnVmZmVyVmlld1t0KzFdLGE9dGhpcy5kaWNlQnVmZmVyVmlld1t0KzJdLG89dGhpcy5kaWNlQnVmZmVyVmlld1t0KzNdLGg9dGhpcy5kaWNlQnVmZmVyVmlld1t0KzRdLGw9dGhpcy5kaWNlQnVmZmVyVmlld1t0KzVdLHU9dGhpcy5kaWNlQnVmZmVyVmlld1t0KzZdLGQ9dGhpcy5kaWNlQnVmZmVyVmlld1t0KzddO3IubWVzaC5wb3NpdGlvbi5zZXQobixhLG8pLHIubWVzaC5yb3RhdGlvblF1YXRlcm5pb24uc2V0KGgsbCx1LGQpfXQ9dCs4fXJlcXVlc3RBbmltYXRpb25GcmFtZSgoKT0+e1kodGhpcyxndCkucG9zdE1lc3NhZ2Uoe2FjdGlvbjoic3RlcFNpbXVsYXRpb24iLGRpY2VCdWZmZXI6dGhpcy5kaWNlQnVmZmVyVmlldy5idWZmZXJ9LFt0aGlzLmRpY2VCdWZmZXJWaWV3LmJ1ZmZlcl0pfSl9YXN5bmMgaGFuZGxlQXNsZWVwKGUpe3ZhciB0LGk7aWYoZS5hc2xlZXA9ITAsYXdhaXQgUHQuZ2V0Um9sbFJlc3VsdChlLFkodGhpcyxKZSkpLGUuZDEwSW5zdGFuY2V8fGUuZGllUGFyZW50KXtpZigodD1lPT1udWxsP3ZvaWQgMDplLmQxMEluc3RhbmNlKSE9bnVsbCYmdC5hc2xlZXB8fChpPWU9PW51bGw/dm9pZCAwOmUuZGllUGFyZW50KSE9bnVsbCYmaS5hc2xlZXApe2NvbnN0IHM9ZS5jb25maWcuc2lkZXM9PT0xMDA/ZTplLmRpZVBhcmVudCxyPWUuY29uZmlnLnNpZGVzPT09MTA/ZTplLmQxMEluc3RhbmNlO3IudmFsdWU9PT0wJiZzLnZhbHVlPT09MD9zLnZhbHVlPTEwMDpzLnZhbHVlPXMudmFsdWUrci52YWx1ZSx0aGlzLm9uUm9sbFJlc3VsdCh7cm9sbElkOnMuY29uZmlnLnJvbGxJZCx2YWx1ZTpzLnZhbHVlfSl9fWVsc2UgZS5jb25maWcuc2lkZXM9PT0xMCYmZS52YWx1ZT09PTAmJihlLnZhbHVlPTEwKSx0aGlzLm9uUm9sbFJlc3VsdCh7cm9sbElkOmUuY29uZmlnLnJvbGxJZCx2YWx1ZTplLnZhbHVlfSk7eWkodGhpcyxGdCkuXysrfXJlc2l6ZShlKXtjb25zdCB0PVkodGhpcyxNdCkud2lkdGg9ZS53aWR0aCxpPVkodGhpcyxNdCkuaGVpZ2h0PWUuaGVpZ2h0O1kodGhpcyxWaSkuY3JlYXRlKHthc3BlY3Q6dC9pfSksWSh0aGlzLFR0KS5yZXNpemUoKX19WGU9bmV3IFdlYWtNYXAsQWk9bmV3IFdlYWtNYXAsRnQ9bmV3IFdlYWtNYXAsUmk9bmV3IFdlYWtNYXAsTXQ9bmV3IFdlYWtNYXAsVHQ9bmV3IFdlYWtNYXAsSmU9bmV3IFdlYWtNYXAsY3M9bmV3IFdlYWtNYXAsQXQ9bmV3IFdlYWtNYXAsVmk9bmV3IFdlYWtNYXAsV2k9bmV3IFdlYWtNYXAsZ3Q9bmV3IFdlYWtNYXAsemk9bmV3IFdlYWtNYXAsdXM9bmV3IFdlYWtTZXQsR3I9YXN5bmMgZnVuY3Rpb24oZSl7WSh0aGlzLFR0KS5hY3RpdmVSZW5kZXJMb29wcy5sZW5ndGg9PT0wJiZ0aGlzLnJlbmRlcihlLm5ld1N0YXJ0UG9pbnQpO2NvbnN0IHQ9ey4uLmUsYXNzZXRQYXRoOnRoaXMuY29uZmlnLmFzc2V0UGF0aCxlbmFibGVTaGFkb3dzOnRoaXMuY29uZmlnLmVuYWJsZVNoYWRvd3Msc2NhbGU6dGhpcy5jb25maWcuc2NhbGUsbGlnaHRzOlkodGhpcyxBdCl9LGk9bmV3IFB0KHQsWSh0aGlzLEplKSk7cmV0dXJuIFkodGhpcyxYZSlbaS5pZF09aSxZKHRoaXMsZ3QpLnBvc3RNZXNzYWdlKHthY3Rpb246ImFkZERpZSIsb3B0aW9uczp7c2lkZXM6ZS5zaWRlcyxzY2FsZTp0aGlzLmNvbmZpZy5zY2FsZSxpZDppLmlkLG5ld1N0YXJ0UG9pbnQ6ZS5uZXdTdGFydFBvaW50LHRoZW1lOmUudGhlbWUsbWVzaE5hbWU6ZS5tZXNoTmFtZX19KSxlLnNpZGVzPT09MTAwJiZlLmRhdGEhPT0ic2luZ2xlIiYmKGkuZDEwSW5zdGFuY2U9YXdhaXQgUHQubG9hZERpZSh7Li4udCxkaWVUeXBlOiJkMTAiLHNpZGVzOjEwLGlkOmkuaWQrMWU0fSxZKHRoaXMsSmUpKS50aGVuKHM9Pntjb25zdCByPW5ldyBQdChzLFkodGhpcyxKZSkpO3JldHVybiByLmRpZVBhcmVudD1pLHJ9KSxZKHRoaXMsWGUpW2Ake2kuZDEwSW5zdGFuY2UuaWR9YF09aS5kMTBJbnN0YW5jZSxZKHRoaXMsZ3QpLnBvc3RNZXNzYWdlKHthY3Rpb246ImFkZERpZSIsb3B0aW9uczp7c2lkZXM6MTAsc2NhbGU6dGhpcy5jb25maWcuc2NhbGUsaWQ6aS5kMTBJbnN0YW5jZS5pZCx0aGVtZTplLnRoZW1lLG1lc2hOYW1lOmUubWVzaE5hbWV9fSkpLGl9O2xldCBEdDtzZWxmLm9ubWVzc2FnZT1hc3luYyBjPT57c3dpdGNoKGMuZGF0YS5hY3Rpb24pe2Nhc2Uicm9sbERpZSI6RHQucGh5c2ljc1dvcmtlclBvcnQucG9zdE1lc3NhZ2Uoe2FjdGlvbjoicm9sbCJ9KTticmVhaztjYXNlImFkZERpZSI6RHQuYWRkKGMuZGF0YS5vcHRpb25zKTticmVhaztjYXNlImFkZE5vbkRpZSI6RHQuYWRkTm9uRGllKGMuZGF0YS5vcHRpb25zKTticmVhaztjYXNlImxvYWRUaGVtZSI6YXdhaXQgRHQubG9hZFRoZW1lKGMuZGF0YS5vcHRpb25zKS5jYXRjaChlPT5jb25zb2xlLmVycm9yKGUpKTticmVhaztjYXNlImNsZWFyRGljZSI6RHQuY2xlYXIoKTticmVhaztjYXNlInJlbW92ZURpZSI6RHQucmVtb3ZlKGMuZGF0YS5vcHRpb25zKTticmVhaztjYXNlInJlc2l6ZSI6RHQucmVzaXplKGMuZGF0YS5vcHRpb25zKTticmVhaztjYXNlImluaXQiOkR0PW5ldyBGbCh7Li4uYy5kYXRhLG9uSW5pdENvbXBsZXRlOigpPT57c2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOiJpbml0LWNvbXBsZXRlIn0pfSxvblRoZW1lTG9hZGVkOih7aWQ6ZX0pPT57c2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOiJ0aGVtZS1sb2FkZWQiLGlkOmV9KX0sb25Sb2xsUmVzdWx0Oih7cm9sbElkOmUsdmFsdWU6dH0pPT57c2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOiJyb2xsLXJlc3VsdCIsZGllOntyb2xsSWQ6ZSx2YWx1ZTp0fX0pfSxvblJvbGxDb21wbGV0ZTooKT0+e3NlbGYucG9zdE1lc3NhZ2Uoe2FjdGlvbjoicm9sbC1jb21wbGV0ZSJ9KX0sb25EaWVSZW1vdmVkOmU9PntzZWxmLnBvc3RNZXNzYWdlKHthY3Rpb246ImRpZS1yZW1vdmVkIixyb2xsSWQ6ZX0pfX0pO2JyZWFrO2Nhc2UidXBkYXRlQ29uZmlnIjpEdC51cGRhdGVDb25maWcoYy5kYXRhLm9wdGlvbnMpO2JyZWFrO2Nhc2UiY29ubmVjdCI6RHQuY29ubmVjdChjLmRhdGEucG9ydCksc2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOiJjb25uZWN0LWNvbXBsZXRlIn0pO2JyZWFrO2RlZmF1bHQ6Y29uc29sZS5lcnJvcigiYWN0aW9uIG5vdCBmb3VuZCBpbiBvZmZzY3JlZW4gd29ya2VyIil9fX0pKCk7Cg==",zs=typeof window<"u"&&window.Blob&&new Blob([atob(nd)],{type:"text/javascript;charset=utf-8"});function _d(){const Z=zs&&(window.URL||window.webkitURL).createObjectURL(zs);try{return Z?new Worker(Z):new Worker("data:application/javascript;base64,"+nd)}finally{Z&&(window.URL||window.webkitURL).revokeObjectURL(Z)}}var It,de,ss,Zd;class Dd{constructor(l){Ea(this,ss),yt(this,"initialized",!1),yt(this,"offscreenWorkerInit",!1),yt(this,"themeLoadedInit",!1),yt(this,"pendingThemePromises",{}),Ea(this,It,void 0),Ea(this,de,void 0),yt(this,"onRollResult",()=>{}),yt(this,"onRollComplete",()=>{}),this.onInitComplete=l.onInitComplete,Ts(this,It,l.canvas.transferControlToOffscreen()),Ts(this,de,new _d),Ze(this,de).init=new Promise((e,t)=>{this.offscreenWorkerInit=e}),this.initialized=wd(this,ss,Zd).call(this,l)}connect(l){Ze(this,de).postMessage({action:"connect",port:l},[l])}updateConfig(l){Ze(this,de).postMessage({action:"updateConfig",options:l})}resize(l){Ze(this,de).postMessage({action:"resize",options:l})}async loadTheme(l){return new Promise((e,t)=>{if(Object.keys(this.pendingThemePromises).includes(l.theme))return e();this.pendingThemePromises[l.theme]=e,Ze(this,de).postMessage({action:"loadTheme",options:l})}).catch(e=>console.error(e))}clear(){Ze(this,de).postMessage({action:"clearDice"})}add(l){Ze(this,de).postMessage({action:"addDie",options:l})}addNonDie(l){Ze(this,de).postMessage({action:"addNonDie",options:l})}remove(l){Ze(this,de).postMessage({action:"removeDie",options:l})}}It=new WeakMap,de=new WeakMap,ss=new WeakSet,Zd=async function(Z){return Ze(this,de).postMessage({action:"init",canvas:Ze(this,It),width:Z.canvas.clientWidth,height:Z.canvas.clientHeight,options:Z.options},[Ze(this,It)]),Ze(this,de).onmessage=l=>{switch(l.data.action){case"init-complete":this.offscreenWorkerInit();break;case"connect-complete":break;case"theme-loaded":l.data.id&&this.pendingThemePromises[l.data.id](l.data.id);break;case"roll-result":this.onRollResult(l.data.die);break;case"roll-complete":this.onRollComplete();break;case"die-removed":this.onDieRemoved(l.data.rollId);break}},await Ze(this,de).init,this.onInitComplete(!0),!0};const jd=Object.freeze(Object.defineProperty({__proto__:null,default:Dd},Symbol.toStringTag,{value:"Module"}));var Ad=Object.defineProperty,Od=(Z,l,e)=>l in Z?Ad(Z,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):Z[l]=e,Le=(Z,l,e)=>(Od(Z,typeof l!="symbol"?l+"":l,e),e),Xs=(Z,l,e)=>{if(!l.has(Z))throw TypeError("Cannot "+e)},w=(Z,l,e)=>(Xs(Z,l,"read from private field"),e?e.call(Z):l.get(Z)),ne=(Z,l,e)=>{if(l.has(Z))throw TypeError("Cannot add the same private member more than once");l instanceof WeakSet?l.add(Z):l.set(Z,e)},oe=(Z,l,e,t)=>(Xs(Z,l,"write to private field"),t?t.call(Z,e):l.set(Z,e),e),gt=(Z,l,e,t)=>({set _(a){oe(Z,l,a,e)},get _(){return w(Z,l,t)}}),qd=(Z,l,e)=>(Xs(Z,l,"access private method"),e);class dl{static WithinEpsilon(l,e,t=1401298e-51){return Math.abs(l-e)<=t}static ToHex(l){const e=l.toString(16);return l<=15?("0"+e).toUpperCase():e.toUpperCase()}static Sign(l){return l=+l,l===0||isNaN(l)?l:l>0?1:-1}static Clamp(l,e=0,t=1){return Math.min(t,Math.max(e,l))}static Log2(l){return Math.log(l)*Math.LOG2E}static ILog2(l){if(Math.log2)return Math.floor(Math.log2(l));if(l<0)return NaN;if(l===0)return-1/0;let e=0;if(l<1){for(;l<1;)e++,l=l*2;e=-e}else if(l>1)for(;l>1;)e++,l=Math.floor(l/2);return e}static Repeat(l,e){return l-Math.floor(l/e)*e}static Normalize(l,e,t){return(l-e)/(t-e)}static Denormalize(l,e,t){return l*(t-e)+e}static DeltaAngle(l,e){let t=dl.Repeat(e-l,360);return t>180&&(t-=360),t}static PingPong(l,e){const t=dl.Repeat(l,e*2);return e-Math.abs(t-e)}static SmoothStep(l,e,t){let a=dl.Clamp(t);return a=-2*a*a*a+3*a*a,e*a+l*(1-a)}static MoveTowards(l,e,t){let a=0;return Math.abs(e-l)<=t?a=e:a=l+dl.Sign(e-l)*t,a}static MoveTowardsAngle(l,e,t){const a=dl.DeltaAngle(l,e);let s=0;return-t<a&&a<t?s=e:(e=l+a,s=dl.MoveTowards(l,e,t)),s}static Lerp(l,e,t){return l+(e-l)*t}static LerpAngle(l,e,t){let a=dl.Repeat(e-l,360);return a>180&&(a-=360),l+a*dl.Clamp(t)}static InverseLerp(l,e,t){let a=0;return l!=e?a=dl.Clamp((t-l)/(e-l)):a=0,a}static Hermite(l,e,t,a,s){const d=s*s,i=s*d,c=2*i-3*d+1,n=-2*i+3*d,h=i-2*d+s,m=i-d;return l*c+t*n+e*h+a*m}static Hermite1stDerivative(l,e,t,a,s){const d=s*s;return(d-s)*6*l+(3*d-4*s+1)*e+(-d+s)*6*t+(3*d-2*s)*a}static RandomRange(l,e){return l===e?l:Math.random()*(e-l)+l}static RangeToPercent(l,e,t){return(l-e)/(t-e)}static PercentToRange(l,e,t){return(t-e)*l+e}static NormalizeRadians(l){return l-=dl.TwoPi*Math.floor((l+Math.PI)/dl.TwoPi),l}static HCF(l,e){const t=l%e;return t===0?e:dl.HCF(e,t)}}dl.TwoPi=Math.PI*2;const Ut=1/2.2,ft=2.2,Sl=.001;class _l{static BuildArray(l,e){const t=[];for(let a=0;a<l;++a)t.push(e());return t}static BuildTuple(l,e){return _l.BuildArray(l,e)}}function $d(Z,l,e){const t=Z[l];if(typeof t!="function")return null;const a=function(){const s=Z.length,d=a.previous.apply(Z,arguments);return e(l,s),d};return t.next=a,a.previous=t,Z[l]=a,()=>{const s=a.previous;if(!s)return;const d=a.next;d?(s.next=d,d.previous=s):(s.next=void 0,Z[l]=s),a.next=void 0,a.previous=void 0}}const li=["push","splice","pop","shift","unshift"];function hd(Z,l){const e=li.map(t=>$d(Z,t,l));return()=>{e.forEach(t=>{t==null||t()})}}const md={};function ce(Z,l){md[Z]=l}function Gt(Z){return md[Z]}class kl{static SetMatrixPrecision(l){if(kl.MatrixTrackPrecisionChange=!1,l&&!kl.MatrixUse64Bits&&kl.MatrixTrackedMatrices)for(let e=0;e<kl.MatrixTrackedMatrices.length;++e){const t=kl.MatrixTrackedMatrices[e],a=t._m;t._m=new Array(16);for(let s=0;s<16;++s)t._m[s]=a[s]}kl.MatrixUse64Bits=l,kl.MatrixCurrentType=kl.MatrixUse64Bits?Array:Float32Array,kl.MatrixTrackedMatrices=null}}kl.MatrixUse64Bits=!1;kl.MatrixTrackPrecisionChange=!0;kl.MatrixCurrentType=Float32Array;kl.MatrixTrackedMatrices=[];class bl{static get LastCreatedEngine(){return this.Instances.length===0?null:this.Instances[this.Instances.length-1]}static get LastCreatedScene(){return this._LastCreatedScene}}bl.Instances=new Array;bl._LastCreatedScene=null;bl.UseFallbackTexture=!0;bl.FallbackTexture="";const ie=Z=>parseInt(Z.toString().replace(/\W/g,""));class Wl{constructor(l=0,e=0){this.x=l,this.y=e}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){const l=ie(this.x),e=ie(this.y);let t=l;return t=t*397^e,t}toArray(l,e=0){return l[e]=this.x,l[e+1]=this.y,this}fromArray(l,e=0){return Wl.FromArrayToRef(l,e,this),this}asArray(){const l=new Array;return this.toArray(l,0),l}copyFrom(l){return this.x=l.x,this.y=l.y,this}copyFromFloats(l,e){return this.x=l,this.y=e,this}set(l,e){return this.copyFromFloats(l,e)}add(l){return new this.constructor(this.x+l.x,this.y+l.y)}addToRef(l,e){return e.x=this.x+l.x,e.y=this.y+l.y,e}addInPlace(l){return this.x+=l.x,this.y+=l.y,this}addVector3(l){return new this.constructor(this.x+l.x,this.y+l.y)}subtract(l){return new this.constructor(this.x-l.x,this.y-l.y)}subtractToRef(l,e){return e.x=this.x-l.x,e.y=this.y-l.y,e}subtractInPlace(l){return this.x-=l.x,this.y-=l.y,this}multiplyInPlace(l){return this.x*=l.x,this.y*=l.y,this}multiply(l){return new this.constructor(this.x*l.x,this.y*l.y)}multiplyToRef(l,e){return e.x=this.x*l.x,e.y=this.y*l.y,e}multiplyByFloats(l,e){return new this.constructor(this.x*l,this.y*e)}divide(l){return new this.constructor(this.x/l.x,this.y/l.y)}divideToRef(l,e){return e.x=this.x/l.x,e.y=this.y/l.y,e}divideInPlace(l){return this.divideToRef(l,this)}negate(){return new this.constructor(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(l){return l.copyFromFloats(this.x*-1,this.y*-1)}scaleInPlace(l){return this.x*=l,this.y*=l,this}scale(l){const e=new this.constructor(0,0);return this.scaleToRef(l,e),e}scaleToRef(l,e){return e.x=this.x*l,e.y=this.y*l,e}scaleAndAddToRef(l,e){return e.x+=this.x*l,e.y+=this.y*l,e}equals(l){return l&&this.x===l.x&&this.y===l.y}equalsWithEpsilon(l,e=Sl){return l&&dl.WithinEpsilon(this.x,l.x,e)&&dl.WithinEpsilon(this.y,l.y,e)}floor(){return new this.constructor(Math.floor(this.x),Math.floor(this.y))}fract(){return new this.constructor(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotateToRef(l,e){const t=Math.cos(l),a=Math.sin(l);return e.x=t*this.x-a*this.y,e.y=a*this.x+t*this.y,e}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return Wl.NormalizeToRef(this,this),this}clone(){return new this.constructor(this.x,this.y)}static Zero(){return new Wl(0,0)}static One(){return new Wl(1,1)}static get ZeroReadOnly(){return Wl._ZeroReadOnly}static FromArray(l,e=0){return new Wl(l[e],l[e+1])}static FromArrayToRef(l,e,t){return t.x=l[e],t.y=l[e+1],t}static CatmullRom(l,e,t,a,s){const d=s*s,i=s*d,c=.5*(2*e.x+(-l.x+t.x)*s+(2*l.x-5*e.x+4*t.x-a.x)*d+(-l.x+3*e.x-3*t.x+a.x)*i),n=.5*(2*e.y+(-l.y+t.y)*s+(2*l.y-5*e.y+4*t.y-a.y)*d+(-l.y+3*e.y-3*t.y+a.y)*i);return new l.constructor(c,n)}static Clamp(l,e,t){let a=l.x;a=a>t.x?t.x:a,a=a<e.x?e.x:a;let s=l.y;return s=s>t.y?t.y:s,s=s<e.y?e.y:s,new l.constructor(a,s)}static Hermite(l,e,t,a,s){const d=s*s,i=s*d,c=2*i-3*d+1,n=-2*i+3*d,h=i-2*d+s,m=i-d,o=l.x*c+t.x*n+e.x*h+a.x*m,b=l.y*c+t.y*n+e.y*h+a.y*m;return new l.constructor(o,b)}static Hermite1stDerivative(l,e,t,a,s){const d=new l.constructor;return this.Hermite1stDerivativeToRef(l,e,t,a,s,d),d}static Hermite1stDerivativeToRef(l,e,t,a,s,d){const i=s*s;return d.x=(i-s)*6*l.x+(3*i-4*s+1)*e.x+(-i+s)*6*t.x+(3*i-2*s)*a.x,d.y=(i-s)*6*l.y+(3*i-4*s+1)*e.y+(-i+s)*6*t.y+(3*i-2*s)*a.y,d}static Lerp(l,e,t){const a=l.x+(e.x-l.x)*t,s=l.y+(e.y-l.y)*t;return new l.constructor(a,s)}static Dot(l,e){return l.x*e.x+l.y*e.y}static Normalize(l){const e=new l.constructor;return this.NormalizeToRef(l,e),e}static NormalizeToRef(l,e){const t=l.length();return t===0||(e.x=l.x/t,e.y=l.y/t),e}static Minimize(l,e){const t=l.x<e.x?l.x:e.x,a=l.y<e.y?l.y:e.y;return new l.constructor(t,a)}static Maximize(l,e){const t=l.x>e.x?l.x:e.x,a=l.y>e.y?l.y:e.y;return new l.constructor(t,a)}static Transform(l,e){const t=new l.constructor;return Wl.TransformToRef(l,e,t),t}static TransformToRef(l,e,t){const a=e.m,s=l.x*a[0]+l.y*a[4]+a[12],d=l.x*a[1]+l.y*a[5]+a[13];return t.x=s,t.y=d,t}static PointInTriangle(l,e,t,a){const s=.5*(-t.y*a.x+e.y*(-t.x+a.x)+e.x*(t.y-a.y)+t.x*a.y),d=s<0?-1:1,i=(e.y*a.x-e.x*a.y+(a.y-e.y)*l.x+(e.x-a.x)*l.y)*d,c=(e.x*t.y-e.y*t.x+(e.y-t.y)*l.x+(t.x-e.x)*l.y)*d;return i>0&&c>0&&i+c<2*s*d}static Distance(l,e){return Math.sqrt(Wl.DistanceSquared(l,e))}static DistanceSquared(l,e){const t=l.x-e.x,a=l.y-e.y;return t*t+a*a}static Center(l,e){const t=new l.constructor;return Wl.CenterToRef(l,e,t)}static CenterToRef(l,e,t){return t.copyFromFloats((l.x+e.x)/2,(l.y+e.y)/2)}static DistanceOfPointFromSegment(l,e,t){const a=Wl.DistanceSquared(e,t);if(a===0)return Wl.Distance(l,e);const s=t.subtract(e),d=Math.max(0,Math.min(1,Wl.Dot(l.subtract(e),s)/a)),i=e.add(s.multiplyByFloats(d,d));return Wl.Distance(l,i)}}Wl._ZeroReadOnly=Wl.Zero();class r{constructor(l=0,e=0,t=0){this._isDirty=!0,this._x=l,this._y=e,this._z=t}get x(){return this._x}set x(l){this._x=l,this._isDirty=!0}get y(){return this._y}set y(l){this._y=l,this._isDirty=!0}get z(){return this._z}set z(l){this._z=l,this._isDirty=!0}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z}}`}getClassName(){return"Vector3"}getHashCode(){const l=ie(this._x),e=ie(this._y),t=ie(this._z);let a=l;return a=a*397^e,a=a*397^t,a}asArray(){const l=[];return this.toArray(l,0),l}toArray(l,e=0){return l[e]=this._x,l[e+1]=this._y,l[e+2]=this._z,this}fromArray(l,e=0){return r.FromArrayToRef(l,e,this),this}toQuaternion(){return _.RotationYawPitchRoll(this._y,this._x,this._z)}addInPlace(l){return this.addInPlaceFromFloats(l._x,l._y,l._z)}addInPlaceFromFloats(l,e,t){return this.x+=l,this.y+=e,this.z+=t,this}add(l){return new this.constructor(this._x+l._x,this._y+l._y,this._z+l._z)}addToRef(l,e){return e.copyFromFloats(this._x+l._x,this._y+l._y,this._z+l._z)}subtractInPlace(l){return this.x-=l._x,this.y-=l._y,this.z-=l._z,this}subtract(l){return new this.constructor(this._x-l._x,this._y-l._y,this._z-l._z)}subtractToRef(l,e){return this.subtractFromFloatsToRef(l._x,l._y,l._z,e)}subtractFromFloats(l,e,t){return new this.constructor(this._x-l,this._y-e,this._z-t)}subtractFromFloatsToRef(l,e,t,a){return a.copyFromFloats(this._x-l,this._y-e,this._z-t)}negate(){return new this.constructor(-this._x,-this._y,-this._z)}negateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}negateToRef(l){return l.copyFromFloats(this._x*-1,this._y*-1,this._z*-1)}scaleInPlace(l){return this.x*=l,this.y*=l,this.z*=l,this}scale(l){return new this.constructor(this._x*l,this._y*l,this._z*l)}scaleToRef(l,e){return e.copyFromFloats(this._x*l,this._y*l,this._z*l)}getNormalToRef(l){const e=this.length();let t=Math.acos(this.y/e);const a=Math.atan2(this.z,this.x);t>Math.PI/2?t-=Math.PI/2:t+=Math.PI/2;const s=e*Math.sin(t)*Math.cos(a),d=e*Math.cos(t),i=e*Math.sin(t)*Math.sin(a);return l.set(s,d,i),l}applyRotationQuaternionToRef(l,e){const t=l.w*this.x+l.y*this.z-l.z*this.y,a=l.w*this.y+l.z*this.x-l.x*this.z,s=l.w*this.z+l.x*this.y-l.y*this.x,d=-l.x*this.x-l.y*this.y-l.z*this.z;return e.x=t*l.w+d*-l.x+a*-l.z-s*-l.y,e.y=a*l.w+d*-l.y+s*-l.x-t*-l.z,e.z=s*l.w+d*-l.z+t*-l.y-a*-l.x,e}applyRotationQuaternionInPlace(l){return this.applyRotationQuaternionToRef(l,this)}applyRotationQuaternion(l){return this.applyRotationQuaternionToRef(l,new this.constructor)}scaleAndAddToRef(l,e){return e.addInPlaceFromFloats(this._x*l,this._y*l,this._z*l)}projectOnPlane(l,e){const t=new this.constructor;return this.projectOnPlaneToRef(l,e,t),t}projectOnPlaneToRef(l,e,t){const a=l.normal,s=l.d,d=P.Vector3[0];this.subtractToRef(e,d),d.normalize();const i=r.Dot(d,a);if(Math.abs(i)<Math.pow(10,-10))t.setAll(1/0);else{const c=-(r.Dot(e,a)+s)/i,n=d.scaleInPlace(c);e.addToRef(n,t)}return t}equals(l){return l&&this._x===l._x&&this._y===l._y&&this._z===l._z}equalsWithEpsilon(l,e=Sl){return l&&dl.WithinEpsilon(this._x,l._x,e)&&dl.WithinEpsilon(this._y,l._y,e)&&dl.WithinEpsilon(this._z,l._z,e)}equalsToFloats(l,e,t){return this._x===l&&this._y===e&&this._z===t}multiplyInPlace(l){return this.x*=l._x,this.y*=l._y,this.z*=l._z,this}multiply(l){return this.multiplyByFloats(l._x,l._y,l._z)}multiplyToRef(l,e){return e.copyFromFloats(this._x*l._x,this._y*l._y,this._z*l._z)}multiplyByFloats(l,e,t){return new this.constructor(this._x*l,this._y*e,this._z*t)}divide(l){return new this.constructor(this._x/l._x,this._y/l._y,this._z/l._z)}divideToRef(l,e){return e.copyFromFloats(this._x/l._x,this._y/l._y,this._z/l._z)}divideInPlace(l){return this.divideToRef(l,this)}minimizeInPlace(l){return this.minimizeInPlaceFromFloats(l._x,l._y,l._z)}maximizeInPlace(l){return this.maximizeInPlaceFromFloats(l._x,l._y,l._z)}minimizeInPlaceFromFloats(l,e,t){return l<this._x&&(this.x=l),e<this._y&&(this.y=e),t<this._z&&(this.z=t),this}maximizeInPlaceFromFloats(l,e,t){return l>this._x&&(this.x=l),e>this._y&&(this.y=e),t>this._z&&(this.z=t),this}isNonUniformWithinEpsilon(l){const e=Math.abs(this._x),t=Math.abs(this._y);if(!dl.WithinEpsilon(e,t,l))return!0;const a=Math.abs(this._z);return!dl.WithinEpsilon(e,a,l)||!dl.WithinEpsilon(t,a,l)}get isNonUniform(){const l=Math.abs(this._x),e=Math.abs(this._y);if(l!==e)return!0;const t=Math.abs(this._z);return l!==t}floor(){return new this.constructor(Math.floor(this._x),Math.floor(this._y),Math.floor(this._z))}fract(){return new this.constructor(this._x-Math.floor(this._x),this._y-Math.floor(this._y),this._z-Math.floor(this._z))}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}lengthSquared(){return this._x*this._x+this._y*this._y+this._z*this._z}get hasAZeroComponent(){return this._x*this._y*this._z===0}normalize(){return this.normalizeFromLength(this.length())}reorderInPlace(l){return l=l.toLowerCase(),l==="xyz"?this:(P.Vector3[0].copyFrom(this),["x","y","z"].forEach((e,t)=>{this[e]=P.Vector3[0][l[t]]}),this)}rotateByQuaternionToRef(l,e){return l.toRotationMatrix(P.Matrix[0]),r.TransformCoordinatesToRef(this,P.Matrix[0],e),e}rotateByQuaternionAroundPointToRef(l,e,t){return this.subtractToRef(e,P.Vector3[0]),P.Vector3[0].rotateByQuaternionToRef(l,P.Vector3[0]),e.addToRef(P.Vector3[0],t),t}cross(l){const e=new this.constructor;return r.CrossToRef(this,l,e)}normalizeFromLength(l){return l===0||l===1?this:this.scaleInPlace(1/l)}normalizeToNew(){const l=new this.constructor(0,0,0);return this.normalizeToRef(l),l}normalizeToRef(l){const e=this.length();return e===0||e===1?l.copyFromFloats(this._x,this._y,this._z):this.scaleToRef(1/e,l)}clone(){return new this.constructor(this._x,this._y,this._z)}copyFrom(l){return this.copyFromFloats(l._x,l._y,l._z)}copyFromFloats(l,e,t){return this.x=l,this.y=e,this.z=t,this}set(l,e,t){return this.copyFromFloats(l,e,t)}setAll(l){return this.x=this.y=this.z=l,this}static GetClipFactor(l,e,t,a){const s=r.Dot(l,t)-a,d=r.Dot(e,t)-a;return s/(s-d)}static GetAngleBetweenVectors(l,e,t){const a=l.normalizeToRef(P.Vector3[1]),s=e.normalizeToRef(P.Vector3[2]);let d=r.Dot(a,s);d=dl.Clamp(d,-1,1);const i=Math.acos(d),c=P.Vector3[3];return r.CrossToRef(a,s,c),r.Dot(c,t)>0?isNaN(i)?0:i:isNaN(i)?-Math.PI:-Math.acos(d)}static GetAngleBetweenVectorsOnPlane(l,e,t){P.Vector3[0].copyFrom(l);const a=P.Vector3[0];P.Vector3[1].copyFrom(e);const s=P.Vector3[1];P.Vector3[2].copyFrom(t);const d=P.Vector3[2],i=P.Vector3[3],c=P.Vector3[4];a.normalize(),s.normalize(),d.normalize(),r.CrossToRef(d,a,i),r.CrossToRef(i,d,c);const n=Math.atan2(r.Dot(s,i),r.Dot(s,c));return dl.NormalizeRadians(n)}static PitchYawRollToMoveBetweenPointsToRef(l,e,t){const a=f.Vector3[0];return e.subtractToRef(l,a),t.y=Math.atan2(a.x,a.z)||0,t.x=Math.atan2(Math.sqrt(a.x**2+a.z**2),a.y)||0,t.z=0,t}static PitchYawRollToMoveBetweenPoints(l,e){const t=r.Zero();return r.PitchYawRollToMoveBetweenPointsToRef(l,e,t)}static SlerpToRef(l,e,t,a){t=dl.Clamp(t,0,1);const s=P.Vector3[0],d=P.Vector3[1];s.copyFrom(l);const i=s.length();s.normalizeFromLength(i),d.copyFrom(e);const c=d.length();d.normalizeFromLength(c);const n=r.Dot(s,d);let h,m;if(n<1-Sl){const o=Math.acos(n),b=1/Math.sin(o);h=Math.sin((1-t)*o)*b,m=Math.sin(t*o)*b}else h=1-t,m=t;return s.scaleInPlace(h),d.scaleInPlace(m),a.copyFrom(s).addInPlace(d),a.scaleInPlace(dl.Lerp(i,c,t)),a}static SmoothToRef(l,e,t,a,s){return r.SlerpToRef(l,e,a===0?1:t/a,s),s}static FromArray(l,e=0){return new r(l[e],l[e+1],l[e+2])}static FromFloatArray(l,e){return r.FromArray(l,e)}static FromArrayToRef(l,e,t){return t.x=l[e],t.y=l[e+1],t.z=l[e+2],t}static FromFloatArrayToRef(l,e,t){return r.FromArrayToRef(l,e,t)}static FromFloatsToRef(l,e,t,a){return a.copyFromFloats(l,e,t),a}static Zero(){return new r(0,0,0)}static One(){return new r(1,1,1)}static Up(){return new r(0,1,0)}static get UpReadOnly(){return r._UpReadOnly}static get DownReadOnly(){return r._DownReadOnly}static get RightReadOnly(){return r._RightReadOnly}static get LeftReadOnly(){return r._LeftReadOnly}static get LeftHandedForwardReadOnly(){return r._LeftHandedForwardReadOnly}static get RightHandedForwardReadOnly(){return r._RightHandedForwardReadOnly}static get ZeroReadOnly(){return r._ZeroReadOnly}static Down(){return new r(0,-1,0)}static Forward(l=!1){return new r(0,0,l?-1:1)}static Backward(l=!1){return new r(0,0,l?1:-1)}static Right(){return new r(1,0,0)}static Left(){return new r(-1,0,0)}static TransformCoordinates(l,e){const t=r.Zero();return r.TransformCoordinatesToRef(l,e,t),t}static TransformCoordinatesToRef(l,e,t){return r.TransformCoordinatesFromFloatsToRef(l._x,l._y,l._z,e,t),t}static TransformCoordinatesFromFloatsToRef(l,e,t,a,s){const d=a.m,i=l*d[0]+e*d[4]+t*d[8]+d[12],c=l*d[1]+e*d[5]+t*d[9]+d[13],n=l*d[2]+e*d[6]+t*d[10]+d[14],h=1/(l*d[3]+e*d[7]+t*d[11]+d[15]);return s.x=i*h,s.y=c*h,s.z=n*h,s}static TransformNormal(l,e){const t=r.Zero();return r.TransformNormalToRef(l,e,t),t}static TransformNormalToRef(l,e,t){return this.TransformNormalFromFloatsToRef(l._x,l._y,l._z,e,t),t}static TransformNormalFromFloatsToRef(l,e,t,a,s){const d=a.m;return s.x=l*d[0]+e*d[4]+t*d[8],s.y=l*d[1]+e*d[5]+t*d[9],s.z=l*d[2]+e*d[6]+t*d[10],s}static CatmullRom(l,e,t,a,s){const d=s*s,i=s*d,c=.5*(2*e._x+(-l._x+t._x)*s+(2*l._x-5*e._x+4*t._x-a._x)*d+(-l._x+3*e._x-3*t._x+a._x)*i),n=.5*(2*e._y+(-l._y+t._y)*s+(2*l._y-5*e._y+4*t._y-a._y)*d+(-l._y+3*e._y-3*t._y+a._y)*i),h=.5*(2*e._z+(-l._z+t._z)*s+(2*l._z-5*e._z+4*t._z-a._z)*d+(-l._z+3*e._z-3*t._z+a._z)*i);return new l.constructor(c,n,h)}static Clamp(l,e,t){const a=new l.constructor;return r.ClampToRef(l,e,t,a),a}static ClampToRef(l,e,t,a){let s=l._x;s=s>t._x?t._x:s,s=s<e._x?e._x:s;let d=l._y;d=d>t._y?t._y:d,d=d<e._y?e._y:d;let i=l._z;return i=i>t._z?t._z:i,i=i<e._z?e._z:i,a.copyFromFloats(s,d,i),a}static CheckExtends(l,e,t){e.minimizeInPlace(l),t.maximizeInPlace(l)}static Hermite(l,e,t,a,s){const d=s*s,i=s*d,c=2*i-3*d+1,n=-2*i+3*d,h=i-2*d+s,m=i-d,o=l._x*c+t._x*n+e._x*h+a._x*m,b=l._y*c+t._y*n+e._y*h+a._y*m,u=l._z*c+t._z*n+e._z*h+a._z*m;return new l.constructor(o,b,u)}static Hermite1stDerivative(l,e,t,a,s){const d=new l.constructor;return this.Hermite1stDerivativeToRef(l,e,t,a,s,d),d}static Hermite1stDerivativeToRef(l,e,t,a,s,d){const i=s*s;return d.x=(i-s)*6*l.x+(3*i-4*s+1)*e.x+(-i+s)*6*t.x+(3*i-2*s)*a.x,d.y=(i-s)*6*l.y+(3*i-4*s+1)*e.y+(-i+s)*6*t.y+(3*i-2*s)*a.y,d.z=(i-s)*6*l.z+(3*i-4*s+1)*e.z+(-i+s)*6*t.z+(3*i-2*s)*a.z,d}static Lerp(l,e,t){const a=new l.constructor(0,0,0);return r.LerpToRef(l,e,t,a),a}static LerpToRef(l,e,t,a){return a.x=l._x+(e._x-l._x)*t,a.y=l._y+(e._y-l._y)*t,a.z=l._z+(e._z-l._z)*t,a}static Dot(l,e){return l._x*e._x+l._y*e._y+l._z*e._z}static Cross(l,e){const t=new l.constructor;return r.CrossToRef(l,e,t),t}static CrossToRef(l,e,t){const a=l._y*e._z-l._z*e._y,s=l._z*e._x-l._x*e._z,d=l._x*e._y-l._y*e._x;return t.copyFromFloats(a,s,d),t}static Normalize(l){const e=r.Zero();return r.NormalizeToRef(l,e),e}static NormalizeToRef(l,e){return l.normalizeToRef(e),e}static Project(l,e,t,a){const s=new l.constructor;return r.ProjectToRef(l,e,t,a,s),s}static ProjectToRef(l,e,t,a,s){const d=a.width,i=a.height,c=a.x,n=a.y,h=P.Matrix[1];Y.FromValuesToRef(d/2,0,0,0,0,-i/2,0,0,0,0,.5,0,c+d/2,i/2+n,.5,1,h);const m=P.Matrix[0];return e.multiplyToRef(t,m),m.multiplyToRef(h,m),r.TransformCoordinatesToRef(l,m,s),s}static Reflect(l,e){return this.ReflectToRef(l,e,new r)}static ReflectToRef(l,e,t){const a=f.Vector3[0];return a.copyFrom(e).scaleInPlace(2*r.Dot(l,e)),t.copyFrom(l).subtractInPlace(a)}static _UnprojectFromInvertedMatrixToRef(l,e,t){r.TransformCoordinatesToRef(l,e,t);const a=e.m,s=l._x*a[3]+l._y*a[7]+l._z*a[11]+a[15];return dl.WithinEpsilon(s,1)&&t.scaleInPlace(1/s),t}static UnprojectFromTransform(l,e,t,a,s){return this.Unproject(l,e,t,a,s,Y.IdentityReadOnly)}static Unproject(l,e,t,a,s,d){const i=new l.constructor;return r.UnprojectToRef(l,e,t,a,s,d,i),i}static UnprojectToRef(l,e,t,a,s,d,i){return r.UnprojectFloatsToRef(l._x,l._y,l._z,e,t,a,s,d,i),i}static UnprojectFloatsToRef(l,e,t,a,s,d,i,c,n){var h;const m=P.Matrix[0];d.multiplyToRef(i,m),m.multiplyToRef(c,m),m.invert();const o=P.Vector3[0];return o.x=l/a*2-1,o.y=-(e/s*2-1),!((h=bl.LastCreatedEngine)===null||h===void 0)&&h.isNDCHalfZRange?o.z=t:o.z=2*t-1,r._UnprojectFromInvertedMatrixToRef(o,m,n),n}static Minimize(l,e){const t=new l.constructor;return t.copyFrom(l),t.minimizeInPlace(e),t}static Maximize(l,e){const t=new l.constructor;return t.copyFrom(l),t.maximizeInPlace(e),t}static Distance(l,e){return Math.sqrt(r.DistanceSquared(l,e))}static DistanceSquared(l,e){const t=l._x-e._x,a=l._y-e._y,s=l._z-e._z;return t*t+a*a+s*s}static ProjectOnTriangleToRef(l,e,t,a,s){const d=P.Vector3[0],i=P.Vector3[1],c=P.Vector3[2],n=P.Vector3[3],h=P.Vector3[4];t.subtractToRef(e,d),a.subtractToRef(e,i),a.subtractToRef(t,c);const m=d.length(),o=i.length(),b=c.length();if(m<Sl||o<Sl||b<Sl)return s.copyFrom(e),r.Distance(l,e);l.subtractToRef(e,h),r.CrossToRef(d,i,n);const u=n.length();if(u<Sl)return s.copyFrom(e),r.Distance(l,e);n.normalizeFromLength(u);let V=h.length();if(V<Sl)return s.copyFrom(e),0;h.normalizeFromLength(V);const G=r.Dot(n,h),p=P.Vector3[5],y=P.Vector3[6];p.copyFrom(n).scaleInPlace(-V*G),y.copyFrom(l).addInPlace(p);const L=P.Vector3[4],N=P.Vector3[5],J=P.Vector3[7],R=P.Vector3[8];L.copyFrom(d).scaleInPlace(1/m),R.copyFrom(i).scaleInPlace(1/o),L.addInPlace(R).scaleInPlace(-1),N.copyFrom(d).scaleInPlace(-1/m),R.copyFrom(c).scaleInPlace(1/b),N.addInPlace(R).scaleInPlace(-1),J.copyFrom(c).scaleInPlace(-1/b),R.copyFrom(i).scaleInPlace(-1/o),J.addInPlace(R).scaleInPlace(-1);const S=P.Vector3[9];let T;S.copyFrom(y).subtractInPlace(e),r.CrossToRef(L,S,R),T=r.Dot(R,n);const k=T;S.copyFrom(y).subtractInPlace(t),r.CrossToRef(N,S,R),T=r.Dot(R,n);const g=T;S.copyFrom(y).subtractInPlace(a),r.CrossToRef(J,S,R),T=r.Dot(R,n);const ll=T,ol=P.Vector3[10];let ml,el;k>0&&g<0?(ol.copyFrom(d),ml=e,el=t):g>0&&ll<0?(ol.copyFrom(c),ml=t,el=a):(ol.copyFrom(i).scaleInPlace(-1),ml=a,el=e);const Jl=P.Vector3[9],xl=P.Vector3[4];if(ml.subtractToRef(y,R),el.subtractToRef(y,Jl),r.CrossToRef(R,Jl,xl),!(r.Dot(xl,n)<0))return s.copyFrom(y),Math.abs(V*G);const zl=P.Vector3[5];r.CrossToRef(ol,xl,zl),zl.normalize();const Hl=P.Vector3[9];Hl.copyFrom(ml).subtractInPlace(y);const Al=Hl.length();if(Al<Sl)return s.copyFrom(ml),r.Distance(l,ml);Hl.normalizeFromLength(Al);const Ye=r.Dot(zl,Hl),Dl=P.Vector3[7];Dl.copyFrom(y).addInPlace(zl.scaleInPlace(Al*Ye)),R.copyFrom(Dl).subtractInPlace(ml),V=ol.length(),ol.normalizeFromLength(V);let Ae=r.Dot(R,ol)/Math.max(V,Sl);return Ae=dl.Clamp(Ae,0,1),Dl.copyFrom(ml).addInPlace(ol.scaleInPlace(Ae*V)),s.copyFrom(Dl),r.Distance(l,Dl)}static Center(l,e){return r.CenterToRef(l,e,r.Zero())}static CenterToRef(l,e,t){return t.copyFromFloats((l._x+e._x)/2,(l._y+e._y)/2,(l._z+e._z)/2)}static RotationFromAxis(l,e,t){const a=new l.constructor;return r.RotationFromAxisToRef(l,e,t,a),a}static RotationFromAxisToRef(l,e,t,a){const s=P.Quaternion[0];return _.RotationQuaternionFromAxisToRef(l,e,t,s),s.toEulerAnglesToRef(a),a}}r._UpReadOnly=r.Up();r._DownReadOnly=r.Down();r._LeftHandedForwardReadOnly=r.Forward(!1);r._RightHandedForwardReadOnly=r.Forward(!0);r._RightReadOnly=r.Right();r._LeftReadOnly=r.Left();r._ZeroReadOnly=r.Zero();class Fl{constructor(l=0,e=0,t=0,a=0){this.x=l,this.y=e,this.z=t,this.w=a}toString(){return`{X: ${this.x} Y: ${this.y} Z: ${this.z} W: ${this.w}}`}getClassName(){return"Vector4"}getHashCode(){const l=ie(this.x),e=ie(this.y),t=ie(this.z),a=ie(this.w);let s=l;return s=s*397^e,s=s*397^t,s=s*397^a,s}asArray(){const l=new Array;return this.toArray(l,0),l}toArray(l,e){return e===void 0&&(e=0),l[e]=this.x,l[e+1]=this.y,l[e+2]=this.z,l[e+3]=this.w,this}fromArray(l,e=0){return Fl.FromArrayToRef(l,e,this),this}addInPlace(l){return this.x+=l.x,this.y+=l.y,this.z+=l.z,this.w+=l.w,this}add(l){return new this.constructor(this.x+l.x,this.y+l.y,this.z+l.z,this.w+l.w)}addToRef(l,e){return e.x=this.x+l.x,e.y=this.y+l.y,e.z=this.z+l.z,e.w=this.w+l.w,e}subtractInPlace(l){return this.x-=l.x,this.y-=l.y,this.z-=l.z,this.w-=l.w,this}subtract(l){return new this.constructor(this.x-l.x,this.y-l.y,this.z-l.z,this.w-l.w)}subtractToRef(l,e){return e.x=this.x-l.x,e.y=this.y-l.y,e.z=this.z-l.z,e.w=this.w-l.w,e}subtractFromFloats(l,e,t,a){return new this.constructor(this.x-l,this.y-e,this.z-t,this.w-a)}subtractFromFloatsToRef(l,e,t,a,s){return s.x=this.x-l,s.y=this.y-e,s.z=this.z-t,s.w=this.w-a,s}negate(){return new this.constructor(-this.x,-this.y,-this.z,-this.w)}negateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this.w*=-1,this}negateToRef(l){return l.copyFromFloats(this.x*-1,this.y*-1,this.z*-1,this.w*-1)}scaleInPlace(l){return this.x*=l,this.y*=l,this.z*=l,this.w*=l,this}scale(l){return new this.constructor(this.x*l,this.y*l,this.z*l,this.w*l)}scaleToRef(l,e){return e.x=this.x*l,e.y=this.y*l,e.z=this.z*l,e.w=this.w*l,e}scaleAndAddToRef(l,e){return e.x+=this.x*l,e.y+=this.y*l,e.z+=this.z*l,e.w+=this.w*l,e}equals(l){return l&&this.x===l.x&&this.y===l.y&&this.z===l.z&&this.w===l.w}equalsWithEpsilon(l,e=Sl){return l&&dl.WithinEpsilon(this.x,l.x,e)&&dl.WithinEpsilon(this.y,l.y,e)&&dl.WithinEpsilon(this.z,l.z,e)&&dl.WithinEpsilon(this.w,l.w,e)}equalsToFloats(l,e,t,a){return this.x===l&&this.y===e&&this.z===t&&this.w===a}multiplyInPlace(l){return this.x*=l.x,this.y*=l.y,this.z*=l.z,this.w*=l.w,this}multiply(l){return new this.constructor(this.x*l.x,this.y*l.y,this.z*l.z,this.w*l.w)}multiplyToRef(l,e){return e.x=this.x*l.x,e.y=this.y*l.y,e.z=this.z*l.z,e.w=this.w*l.w,e}multiplyByFloats(l,e,t,a){return new this.constructor(this.x*l,this.y*e,this.z*t,this.w*a)}divide(l){return new this.constructor(this.x/l.x,this.y/l.y,this.z/l.z,this.w/l.w)}divideToRef(l,e){return e.x=this.x/l.x,e.y=this.y/l.y,e.z=this.z/l.z,e.w=this.w/l.w,e}divideInPlace(l){return this.divideToRef(l,this)}minimizeInPlace(l){return l.x<this.x&&(this.x=l.x),l.y<this.y&&(this.y=l.y),l.z<this.z&&(this.z=l.z),l.w<this.w&&(this.w=l.w),this}maximizeInPlace(l){return l.x>this.x&&(this.x=l.x),l.y>this.y&&(this.y=l.y),l.z>this.z&&(this.z=l.z),l.w>this.w&&(this.w=l.w),this}floor(){return new this.constructor(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fract(){return new this.constructor(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){const l=this.length();return l===0?this:this.scaleInPlace(1/l)}toVector3(){return new r(this.x,this.y,this.z)}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copyFrom(l){return this.x=l.x,this.y=l.y,this.z=l.z,this.w=l.w,this}copyFromFloats(l,e,t,a){return this.x=l,this.y=e,this.z=t,this.w=a,this}set(l,e,t,a){return this.copyFromFloats(l,e,t,a)}setAll(l){return this.x=this.y=this.z=this.w=l,this}static FromArray(l,e){return e||(e=0),new Fl(l[e],l[e+1],l[e+2],l[e+3])}static FromArrayToRef(l,e,t){return t.x=l[e],t.y=l[e+1],t.z=l[e+2],t.w=l[e+3],t}static FromFloatArrayToRef(l,e,t){return Fl.FromArrayToRef(l,e,t),t}static FromFloatsToRef(l,e,t,a,s){return s.x=l,s.y=e,s.z=t,s.w=a,s}static Zero(){return new Fl(0,0,0,0)}static One(){return new Fl(1,1,1,1)}static get ZeroReadOnly(){return Fl._ZeroReadOnly}static Normalize(l){const e=Fl.Zero();return Fl.NormalizeToRef(l,e),e}static NormalizeToRef(l,e){return e.copyFrom(l),e.normalize(),e}static Minimize(l,e){const t=new l.constructor;return t.copyFrom(l),t.minimizeInPlace(e),t}static Maximize(l,e){const t=new l.constructor;return t.copyFrom(l),t.maximizeInPlace(e),t}static Distance(l,e){return Math.sqrt(Fl.DistanceSquared(l,e))}static DistanceSquared(l,e){const t=l.x-e.x,a=l.y-e.y,s=l.z-e.z,d=l.w-e.w;return t*t+a*a+s*s+d*d}static Center(l,e){return Fl.CenterToRef(l,e,Fl.Zero())}static CenterToRef(l,e,t){return t.copyFromFloats((l.x+e.x)/2,(l.y+e.y)/2,(l.z+e.z)/2,(l.w+e.w)/2)}static TransformCoordinates(l,e){const t=Fl.Zero();return Fl.TransformCoordinatesToRef(l,e,t),t}static TransformCoordinatesToRef(l,e,t){return Fl.TransformCoordinatesFromFloatsToRef(l._x,l._y,l._z,e,t),t}static TransformCoordinatesFromFloatsToRef(l,e,t,a,s){const d=a.m,i=l*d[0]+e*d[4]+t*d[8]+d[12],c=l*d[1]+e*d[5]+t*d[9]+d[13],n=l*d[2]+e*d[6]+t*d[10]+d[14],h=l*d[3]+e*d[7]+t*d[11]+d[15];return s.x=i,s.y=c,s.z=n,s.w=h,s}static TransformNormal(l,e){const t=new l.constructor;return Fl.TransformNormalToRef(l,e,t),t}static TransformNormalToRef(l,e,t){const a=e.m,s=l.x*a[0]+l.y*a[4]+l.z*a[8],d=l.x*a[1]+l.y*a[5]+l.z*a[9],i=l.x*a[2]+l.y*a[6]+l.z*a[10];return t.x=s,t.y=d,t.z=i,t.w=l.w,t}static TransformNormalFromFloatsToRef(l,e,t,a,s,d){const i=s.m;return d.x=l*i[0]+e*i[4]+t*i[8],d.y=l*i[1]+e*i[5]+t*i[9],d.z=l*i[2]+e*i[6]+t*i[10],d.w=a,d}static FromVector3(l,e=0){return new Fl(l._x,l._y,l._z,e)}}Fl._ZeroReadOnly=Fl.Zero();class _{constructor(l=0,e=0,t=0,a=1){this._isDirty=!0,this._x=l,this._y=e,this._z=t,this._w=a}get x(){return this._x}set x(l){this._x=l,this._isDirty=!0}get y(){return this._y}set y(l){this._y=l,this._isDirty=!0}get z(){return this._z}set z(l){this._z=l,this._isDirty=!0}get w(){return this._w}set w(l){this._w=l,this._isDirty=!0}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z} W: ${this._w}}`}getClassName(){return"Quaternion"}getHashCode(){const l=ie(this._x),e=ie(this._y),t=ie(this._z),a=ie(this._w);let s=l;return s=s*397^e,s=s*397^t,s=s*397^a,s}asArray(){return[this._x,this._y,this._z,this._w]}toArray(l,e=0){return l[e]=this.x,l[e+1]=this.y,l[e+2]=this.z,l[e+3]=this.w,this}equals(l){return l&&this._x===l._x&&this._y===l._y&&this._z===l._z&&this._w===l._w}equalsWithEpsilon(l,e=Sl){return l&&dl.WithinEpsilon(this._x,l._x,e)&&dl.WithinEpsilon(this._y,l._y,e)&&dl.WithinEpsilon(this._z,l._z,e)&&dl.WithinEpsilon(this._w,l._w,e)}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copyFrom(l){return this.x=l._x,this.y=l._y,this.z=l._z,this.w=l._w,this}copyFromFloats(l,e,t,a){return this.x=l,this.y=e,this.z=t,this.w=a,this}set(l,e,t,a){return this.copyFromFloats(l,e,t,a)}add(l){return new this.constructor(this._x+l._x,this._y+l._y,this._z+l._z,this._w+l._w)}addInPlace(l){return this._x+=l._x,this._y+=l._y,this._z+=l._z,this._w+=l._w,this}subtract(l){return new this.constructor(this._x-l._x,this._y-l._y,this._z-l._z,this._w-l._w)}subtractInPlace(l){return this._x-=l._x,this._y-=l._y,this._z-=l._z,this._w-=l._w,this}scale(l){return new this.constructor(this._x*l,this._y*l,this._z*l,this._w*l)}scaleToRef(l,e){return e.x=this._x*l,e.y=this._y*l,e.z=this._z*l,e.w=this._w*l,e}scaleInPlace(l){return this.x*=l,this.y*=l,this.z*=l,this.w*=l,this}scaleAndAddToRef(l,e){return e.x+=this._x*l,e.y+=this._y*l,e.z+=this._z*l,e.w+=this._w*l,e}multiply(l){const e=new this.constructor(0,0,0,1);return this.multiplyToRef(l,e),e}multiplyToRef(l,e){const t=this._x*l._w+this._y*l._z-this._z*l._y+this._w*l._x,a=-this._x*l._z+this._y*l._w+this._z*l._x+this._w*l._y,s=this._x*l._y-this._y*l._x+this._z*l._w+this._w*l._z,d=-this._x*l._x-this._y*l._y-this._z*l._z+this._w*l._w;return e.copyFromFloats(t,a,s,d),e}multiplyInPlace(l){return this.multiplyToRef(l,this),this}conjugateToRef(l){return l.copyFromFloats(-this._x,-this._y,-this._z,this._w),l}conjugateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}conjugate(){return new this.constructor(-this._x,-this._y,-this._z,this._w)}invert(){const l=this.conjugate(),e=this.lengthSquared();return e==0||e==1||l.scaleInPlace(1/e),l}invertInPlace(){this.conjugateInPlace();const l=this.lengthSquared();return l==0||l==1?this:(this.scaleInPlace(1/l),this)}lengthSquared(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this.lengthSquared())}normalize(){const l=this.length();if(l===0)return this;const e=1/l;return this.scaleInPlace(e),this}normalizeToNew(){const l=this.length();if(l===0)return this.clone();const e=1/l;return this.scale(e)}toEulerAngles(){const l=r.Zero();return this.toEulerAnglesToRef(l),l}toEulerAnglesToRef(l){const e=this._z,t=this._x,a=this._y,s=this._w,d=a*e-t*s,i=.4999999;if(d<-i)l.y=2*Math.atan2(a,s),l.x=Math.PI/2,l.z=0;else if(d>i)l.y=2*Math.atan2(a,s),l.x=-Math.PI/2,l.z=0;else{const c=s*s,n=e*e,h=t*t,m=a*a;l.z=Math.atan2(2*(t*a+e*s),-n-h+m+c),l.x=Math.asin(-2*d),l.y=Math.atan2(2*(e*t+a*s),n-h-m+c)}return l}toRotationMatrix(l){return Y.FromQuaternionToRef(this,l),l}fromRotationMatrix(l){return _.FromRotationMatrixToRef(l,this),this}static FromRotationMatrix(l){const e=new _;return _.FromRotationMatrixToRef(l,e),e}static FromRotationMatrixToRef(l,e){const t=l.m,a=t[0],s=t[4],d=t[8],i=t[1],c=t[5],n=t[9],h=t[2],m=t[6],o=t[10],b=a+c+o;let u;return b>0?(u=.5/Math.sqrt(b+1),e.w=.25/u,e.x=(m-n)*u,e.y=(d-h)*u,e.z=(i-s)*u):a>c&&a>o?(u=2*Math.sqrt(1+a-c-o),e.w=(m-n)/u,e.x=.25*u,e.y=(s+i)/u,e.z=(d+h)/u):c>o?(u=2*Math.sqrt(1+c-a-o),e.w=(d-h)/u,e.x=(s+i)/u,e.y=.25*u,e.z=(n+m)/u):(u=2*Math.sqrt(1+o-a-c),e.w=(i-s)/u,e.x=(d+h)/u,e.y=(n+m)/u,e.z=.25*u),e}static Dot(l,e){return l._x*e._x+l._y*e._y+l._z*e._z+l._w*e._w}static AreClose(l,e,t=.1){const a=_.Dot(l,e);return 1-a*a<=t}static SmoothToRef(l,e,t,a,s){let d=a===0?1:t/a;return d=dl.Clamp(d,0,1),_.SlerpToRef(l,e,d,s),s}static Zero(){return new _(0,0,0,0)}static Inverse(l){return new l.constructor(-l._x,-l._y,-l._z,l._w)}static InverseToRef(l,e){return e.set(-l._x,-l._y,-l._z,l._w),e}static Identity(){return new _(0,0,0,1)}static IsIdentity(l){return l&&l._x===0&&l._y===0&&l._z===0&&l._w===1}static RotationAxis(l,e){return _.RotationAxisToRef(l,e,new _)}static RotationAxisToRef(l,e,t){const a=Math.sin(e/2);return l.normalize(),t.w=Math.cos(e/2),t.x=l._x*a,t.y=l._y*a,t.z=l._z*a,t}static FromArray(l,e){return e||(e=0),new _(l[e],l[e+1],l[e+2],l[e+3])}static FromArrayToRef(l,e,t){return t.x=l[e],t.y=l[e+1],t.z=l[e+2],t.w=l[e+3],t}static FromEulerAngles(l,e,t){const a=new _;return _.RotationYawPitchRollToRef(e,l,t,a),a}static FromEulerAnglesToRef(l,e,t,a){return _.RotationYawPitchRollToRef(e,l,t,a),a}static FromEulerVector(l){const e=new _;return _.RotationYawPitchRollToRef(l._y,l._x,l._z,e),e}static FromEulerVectorToRef(l,e){return _.RotationYawPitchRollToRef(l._y,l._x,l._z,e),e}static FromUnitVectorsToRef(l,e,t){const a=r.Dot(l,e)+1;return a<Sl?Math.abs(l.x)>Math.abs(l.z)?t.set(-l.y,l.x,0,0):t.set(0,-l.z,l.y,0):(r.CrossToRef(l,e,f.Vector3[0]),t.set(f.Vector3[0].x,f.Vector3[0].y,f.Vector3[0].z,a)),t.normalize()}static RotationYawPitchRoll(l,e,t){const a=new _;return _.RotationYawPitchRollToRef(l,e,t,a),a}static RotationYawPitchRollToRef(l,e,t,a){const s=t*.5,d=e*.5,i=l*.5,c=Math.sin(s),n=Math.cos(s),h=Math.sin(d),m=Math.cos(d),o=Math.sin(i),b=Math.cos(i);return a.x=b*h*n+o*m*c,a.y=o*m*n-b*h*c,a.z=b*m*c-o*h*n,a.w=b*m*n+o*h*c,a}static RotationAlphaBetaGamma(l,e,t){const a=new _;return _.RotationAlphaBetaGammaToRef(l,e,t,a),a}static RotationAlphaBetaGammaToRef(l,e,t,a){const s=(t+l)*.5,d=(t-l)*.5,i=e*.5;return a.x=Math.cos(d)*Math.sin(i),a.y=Math.sin(d)*Math.sin(i),a.z=Math.sin(s)*Math.cos(i),a.w=Math.cos(s)*Math.cos(i),a}static RotationQuaternionFromAxis(l,e,t){const a=new _(0,0,0,0);return _.RotationQuaternionFromAxisToRef(l,e,t,a),a}static RotationQuaternionFromAxisToRef(l,e,t,a){const s=P.Matrix[0];return Y.FromXYZAxesToRef(l.normalize(),e.normalize(),t.normalize(),s),_.FromRotationMatrixToRef(s,a),a}static FromLookDirectionLH(l,e){const t=new _;return _.FromLookDirectionLHToRef(l,e,t),t}static FromLookDirectionLHToRef(l,e,t){const a=P.Matrix[0];return Y.LookDirectionLHToRef(l,e,a),_.FromRotationMatrixToRef(a,t),t}static FromLookDirectionRH(l,e){const t=new _;return _.FromLookDirectionRHToRef(l,e,t),t}static FromLookDirectionRHToRef(l,e,t){const a=P.Matrix[0];return Y.LookDirectionRHToRef(l,e,a),_.FromRotationMatrixToRef(a,t)}static Slerp(l,e,t){const a=_.Identity();return _.SlerpToRef(l,e,t,a),a}static SlerpToRef(l,e,t,a){let s,d,i=l._x*e._x+l._y*e._y+l._z*e._z+l._w*e._w,c=!1;if(i<0&&(c=!0,i=-i),i>.999999)d=1-t,s=c?-t:t;else{const n=Math.acos(i),h=1/Math.sin(n);d=Math.sin((1-t)*n)*h,s=c?-Math.sin(t*n)*h:Math.sin(t*n)*h}return a.x=d*l._x+s*e._x,a.y=d*l._y+s*e._y,a.z=d*l._z+s*e._z,a.w=d*l._w+s*e._w,a}static Hermite(l,e,t,a,s){const d=s*s,i=s*d,c=2*i-3*d+1,n=-2*i+3*d,h=i-2*d+s,m=i-d,o=l._x*c+t._x*n+e._x*h+a._x*m,b=l._y*c+t._y*n+e._y*h+a._y*m,u=l._z*c+t._z*n+e._z*h+a._z*m,V=l._w*c+t._w*n+e._w*h+a._w*m;return new l.constructor(o,b,u,V)}static Hermite1stDerivative(l,e,t,a,s){const d=new l.constructor;return this.Hermite1stDerivativeToRef(l,e,t,a,s,d),d}static Hermite1stDerivativeToRef(l,e,t,a,s,d){const i=s*s;return d.x=(i-s)*6*l.x+(3*i-4*s+1)*e.x+(-i+s)*6*t.x+(3*i-2*s)*a.x,d.y=(i-s)*6*l.y+(3*i-4*s+1)*e.y+(-i+s)*6*t.y+(3*i-2*s)*a.y,d.z=(i-s)*6*l.z+(3*i-4*s+1)*e.z+(-i+s)*6*t.z+(3*i-2*s)*a.z,d.w=(i-s)*6*l.w+(3*i-4*s+1)*e.w+(-i+s)*6*t.w+(3*i-2*s)*a.w,d}}class Y{constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this.updateFlag=-1,kl.MatrixTrackPrecisionChange&&kl.MatrixTrackedMatrices.push(this),this._m=new kl.MatrixCurrentType(16),this.markAsUpdated()}static get Use64Bits(){return kl.MatrixUse64Bits}get m(){return this._m}markAsUpdated(){this.updateFlag=Y._UpdateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}_updateIdentityStatus(l,e=!1,t=!1,a=!0){this._isIdentity=l,this._isIdentity3x2=l||t,this._isIdentityDirty=this._isIdentity?!1:e,this._isIdentity3x2Dirty=this._isIdentity3x2?!1:a}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const l=this._m;this._isIdentity=l[0]===1&&l[1]===0&&l[2]===0&&l[3]===0&&l[4]===0&&l[5]===1&&l[6]===0&&l[7]===0&&l[8]===0&&l[9]===0&&l[10]===1&&l[11]===0&&l[12]===0&&l[13]===0&&l[14]===0&&l[15]===1}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,this._m[0]!==1||this._m[5]!==1||this._m[15]!==1?this._isIdentity3x2=!1:this._m[1]!==0||this._m[2]!==0||this._m[3]!==0||this._m[4]!==0||this._m[6]!==0||this._m[7]!==0||this._m[8]!==0||this._m[9]!==0||this._m[10]!==0||this._m[11]!==0||this._m[12]!==0||this._m[13]!==0||this._m[14]!==0?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(this._isIdentity===!0)return 1;const l=this._m,e=l[0],t=l[1],a=l[2],s=l[3],d=l[4],i=l[5],c=l[6],n=l[7],h=l[8],m=l[9],o=l[10],b=l[11],u=l[12],V=l[13],G=l[14],p=l[15],y=o*p-G*b,L=m*p-V*b,N=m*G-V*o,J=h*p-u*b,R=h*G-o*u,S=h*V-u*m,T=+(i*y-c*L+n*N),k=-(d*y-c*J+n*R),g=+(d*L-i*J+n*S),ll=-(d*N-i*R+c*S);return e*T+t*k+a*g+s*ll}toArray(){return this._m}asArray(){return this._m}invert(){return this.invertToRef(this),this}reset(){return Y.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(l){const e=new this.constructor;return this.addToRef(l,e),e}addToRef(l,e){const t=this._m,a=e._m,s=l.m;for(let d=0;d<16;d++)a[d]=t[d]+s[d];return e.markAsUpdated(),e}addToSelf(l){const e=this._m,t=l.m;for(let a=0;a<16;a++)e[a]+=t[a];return this.markAsUpdated(),this}invertToRef(l){if(this._isIdentity===!0)return Y.IdentityToRef(l),l;const e=this._m,t=e[0],a=e[1],s=e[2],d=e[3],i=e[4],c=e[5],n=e[6],h=e[7],m=e[8],o=e[9],b=e[10],u=e[11],V=e[12],G=e[13],p=e[14],y=e[15],L=b*y-p*u,N=o*y-G*u,J=o*p-G*b,R=m*y-V*u,S=m*p-b*V,T=m*G-V*o,k=+(c*L-n*N+h*J),g=-(i*L-n*R+h*S),ll=+(i*N-c*R+h*T),ol=-(i*J-c*S+n*T),ml=t*k+a*g+s*ll+d*ol;if(ml===0)return l.copyFrom(this),l;const el=1/ml,Jl=n*y-p*h,xl=c*y-G*h,zl=c*p-G*n,Hl=i*y-V*h,Al=i*p-V*n,Ye=i*G-V*c,Dl=n*u-b*h,Ae=c*u-o*h,qt=c*b-o*n,$t=i*u-m*h,la=i*b-m*n,ea=i*o-m*c,Ma=-(a*L-s*N+d*J),ga=+(t*L-s*R+d*S),Ca=-(t*N-a*R+d*T),va=+(t*J-a*S+s*T),ka=+(a*Jl-s*xl+d*zl),Ha=-(t*Jl-s*Hl+d*Al),ge=+(t*xl-a*Hl+d*Ye),Ce=-(t*zl-a*Al+s*Ye),ve=-(a*Dl-s*Ae+d*qt),ke=+(t*Dl-s*$t+d*la),Td=-(t*Ae-a*$t+d*ea),zd=+(t*qt-a*la+s*ea);return Y.FromValuesToRef(k*el,Ma*el,ka*el,ve*el,g*el,ga*el,Ha*el,ke*el,ll*el,Ca*el,ge*el,Td*el,ol*el,va*el,Ce*el,zd*el,l),l}addAtIndex(l,e){return this._m[l]+=e,this.markAsUpdated(),this}multiplyAtIndex(l,e){return this._m[l]*=e,this.markAsUpdated(),this}setTranslationFromFloats(l,e,t){return this._m[12]=l,this._m[13]=e,this._m[14]=t,this.markAsUpdated(),this}addTranslationFromFloats(l,e,t){return this._m[12]+=l,this._m[13]+=e,this._m[14]+=t,this.markAsUpdated(),this}setTranslation(l){return this.setTranslationFromFloats(l._x,l._y,l._z)}getTranslation(){return new r(this._m[12],this._m[13],this._m[14])}getTranslationToRef(l){return l.x=this._m[12],l.y=this._m[13],l.z=this._m[14],l}removeRotationAndScaling(){const l=this.m;return Y.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,l[12],l[13],l[14],l[15],this),this._updateIdentityStatus(l[12]===0&&l[13]===0&&l[14]===0&&l[15]===1),this}multiply(l){const e=new this.constructor;return this.multiplyToRef(l,e),e}copyFrom(l){l.copyToArray(this._m);const e=l;return this.updateFlag=e.updateFlag,this._updateIdentityStatus(e._isIdentity,e._isIdentityDirty,e._isIdentity3x2,e._isIdentity3x2Dirty),this}copyToArray(l,e=0){const t=this._m;return l[e]=t[0],l[e+1]=t[1],l[e+2]=t[2],l[e+3]=t[3],l[e+4]=t[4],l[e+5]=t[5],l[e+6]=t[6],l[e+7]=t[7],l[e+8]=t[8],l[e+9]=t[9],l[e+10]=t[10],l[e+11]=t[11],l[e+12]=t[12],l[e+13]=t[13],l[e+14]=t[14],l[e+15]=t[15],this}multiplyToRef(l,e){return this._isIdentity?(e.copyFrom(l),e):l._isIdentity?(e.copyFrom(this),e):(this.multiplyToArray(l,e._m,0),e.markAsUpdated(),e)}multiplyToArray(l,e,t){const a=this._m,s=l.m,d=a[0],i=a[1],c=a[2],n=a[3],h=a[4],m=a[5],o=a[6],b=a[7],u=a[8],V=a[9],G=a[10],p=a[11],y=a[12],L=a[13],N=a[14],J=a[15],R=s[0],S=s[1],T=s[2],k=s[3],g=s[4],ll=s[5],ol=s[6],ml=s[7],el=s[8],Jl=s[9],xl=s[10],zl=s[11],Hl=s[12],Al=s[13],Ye=s[14],Dl=s[15];return e[t]=d*R+i*g+c*el+n*Hl,e[t+1]=d*S+i*ll+c*Jl+n*Al,e[t+2]=d*T+i*ol+c*xl+n*Ye,e[t+3]=d*k+i*ml+c*zl+n*Dl,e[t+4]=h*R+m*g+o*el+b*Hl,e[t+5]=h*S+m*ll+o*Jl+b*Al,e[t+6]=h*T+m*ol+o*xl+b*Ye,e[t+7]=h*k+m*ml+o*zl+b*Dl,e[t+8]=u*R+V*g+G*el+p*Hl,e[t+9]=u*S+V*ll+G*Jl+p*Al,e[t+10]=u*T+V*ol+G*xl+p*Ye,e[t+11]=u*k+V*ml+G*zl+p*Dl,e[t+12]=y*R+L*g+N*el+J*Hl,e[t+13]=y*S+L*ll+N*Jl+J*Al,e[t+14]=y*T+L*ol+N*xl+J*Ye,e[t+15]=y*k+L*ml+N*zl+J*Dl,this}equals(l){const e=l;if(!e)return!1;if((this._isIdentity||e._isIdentity)&&!this._isIdentityDirty&&!e._isIdentityDirty)return this._isIdentity&&e._isIdentity;const t=this.m,a=e.m;return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]&&t[9]===a[9]&&t[10]===a[10]&&t[11]===a[11]&&t[12]===a[12]&&t[13]===a[13]&&t[14]===a[14]&&t[15]===a[15]}clone(){const l=new this.constructor;return l.copyFrom(this),l}getClassName(){return"Matrix"}getHashCode(){let l=ie(this._m[0]);for(let e=1;e<16;e++)l=l*397^ie(this._m[e]);return l}decomposeToTransformNode(l){return l.rotationQuaternion=l.rotationQuaternion||new _,this.decompose(l.scaling,l.rotationQuaternion,l.position)}decompose(l,e,t,a){if(this._isIdentity)return t&&t.setAll(0),l&&l.setAll(1),e&&e.copyFromFloats(0,0,0,1),!0;const s=this._m;if(t&&t.copyFromFloats(s[12],s[13],s[14]),l=l||P.Vector3[0],l.x=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]),l.y=Math.sqrt(s[4]*s[4]+s[5]*s[5]+s[6]*s[6]),l.z=Math.sqrt(s[8]*s[8]+s[9]*s[9]+s[10]*s[10]),a){const d=a.scaling.x<0?-1:1,i=a.scaling.y<0?-1:1,c=a.scaling.z<0?-1:1;l.x*=d,l.y*=i,l.z*=c}else this.determinant()<=0&&(l.y*=-1);if(l._x===0||l._y===0||l._z===0)return e&&e.copyFromFloats(0,0,0,1),!1;if(e){const d=1/l._x,i=1/l._y,c=1/l._z;Y.FromValuesToRef(s[0]*d,s[1]*d,s[2]*d,0,s[4]*i,s[5]*i,s[6]*i,0,s[8]*c,s[9]*c,s[10]*c,0,0,0,0,1,P.Matrix[0]),_.FromRotationMatrixToRef(P.Matrix[0],e)}return!0}getRow(l){if(l<0||l>3)return null;const e=l*4;return new Fl(this._m[e+0],this._m[e+1],this._m[e+2],this._m[e+3])}getRowToRef(l,e){if(l>=0&&l<3){const t=l*4;e.x=this._m[t+0],e.y=this._m[t+1],e.z=this._m[t+2],e.w=this._m[t+3]}return e}setRow(l,e){return this.setRowFromFloats(l,e.x,e.y,e.z,e.w)}transpose(){const l=new this.constructor;return Y.TransposeToRef(this,l),l}transposeToRef(l){return Y.TransposeToRef(this,l),l}setRowFromFloats(l,e,t,a,s){if(l<0||l>3)return this;const d=l*4;return this._m[d+0]=e,this._m[d+1]=t,this._m[d+2]=a,this._m[d+3]=s,this.markAsUpdated(),this}scale(l){const e=new this.constructor;return this.scaleToRef(l,e),e}scaleToRef(l,e){for(let t=0;t<16;t++)e._m[t]=this._m[t]*l;return e.markAsUpdated(),e}scaleAndAddToRef(l,e){for(let t=0;t<16;t++)e._m[t]+=this._m[t]*l;return e.markAsUpdated(),e}toNormalMatrix(l){const e=P.Matrix[0];this.invertToRef(e),e.transposeToRef(l);const t=l._m;return Y.FromValuesToRef(t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,0,0,0,1,l),l}getRotationMatrix(){const l=new this.constructor;return this.getRotationMatrixToRef(l),l}getRotationMatrixToRef(l){const e=P.Vector3[0];if(!this.decompose(e))return Y.IdentityToRef(l),l;const t=this._m,a=1/e._x,s=1/e._y,d=1/e._z;return Y.FromValuesToRef(t[0]*a,t[1]*a,t[2]*a,0,t[4]*s,t[5]*s,t[6]*s,0,t[8]*d,t[9]*d,t[10]*d,0,0,0,0,1,l),l}toggleModelMatrixHandInPlace(){const l=this._m;return l[2]*=-1,l[6]*=-1,l[8]*=-1,l[9]*=-1,l[14]*=-1,this.markAsUpdated(),this}toggleProjectionMatrixHandInPlace(){const l=this._m;return l[8]*=-1,l[9]*=-1,l[10]*=-1,l[11]*=-1,this.markAsUpdated(),this}static FromArray(l,e=0){const t=new Y;return Y.FromArrayToRef(l,e,t),t}static FromArrayToRef(l,e,t){for(let a=0;a<16;a++)t._m[a]=l[a+e];return t.markAsUpdated(),t}static FromFloat32ArrayToRefScaled(l,e,t,a){for(let s=0;s<16;s++)a._m[s]=l[s+e]*t;return a.markAsUpdated(),a}static get IdentityReadOnly(){return Y._IdentityReadOnly}static FromValuesToRef(l,e,t,a,s,d,i,c,n,h,m,o,b,u,V,G,p){const y=p._m;y[0]=l,y[1]=e,y[2]=t,y[3]=a,y[4]=s,y[5]=d,y[6]=i,y[7]=c,y[8]=n,y[9]=h,y[10]=m,y[11]=o,y[12]=b,y[13]=u,y[14]=V,y[15]=G,p.markAsUpdated()}static FromValues(l,e,t,a,s,d,i,c,n,h,m,o,b,u,V,G){const p=new Y,y=p._m;return y[0]=l,y[1]=e,y[2]=t,y[3]=a,y[4]=s,y[5]=d,y[6]=i,y[7]=c,y[8]=n,y[9]=h,y[10]=m,y[11]=o,y[12]=b,y[13]=u,y[14]=V,y[15]=G,p.markAsUpdated(),p}static Compose(l,e,t){const a=new Y;return Y.ComposeToRef(l,e,t,a),a}static ComposeToRef(l,e,t,a){const s=a._m,d=e._x,i=e._y,c=e._z,n=e._w,h=d+d,m=i+i,o=c+c,b=d*h,u=d*m,V=d*o,G=i*m,p=i*o,y=c*o,L=n*h,N=n*m,J=n*o,R=l._x,S=l._y,T=l._z;return s[0]=(1-(G+y))*R,s[1]=(u+J)*R,s[2]=(V-N)*R,s[3]=0,s[4]=(u-J)*S,s[5]=(1-(b+y))*S,s[6]=(p+L)*S,s[7]=0,s[8]=(V+N)*T,s[9]=(p-L)*T,s[10]=(1-(b+G))*T,s[11]=0,s[12]=t._x,s[13]=t._y,s[14]=t._z,s[15]=1,a.markAsUpdated(),a}static Identity(){const l=Y.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return l._updateIdentityStatus(!0),l}static IdentityToRef(l){return Y.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,l),l._updateIdentityStatus(!0),l}static Zero(){const l=Y.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return l._updateIdentityStatus(!1),l}static RotationX(l){const e=new Y;return Y.RotationXToRef(l,e),e}static Invert(l){const e=new l.constructor;return l.invertToRef(e),e}static RotationXToRef(l,e){const t=Math.sin(l),a=Math.cos(l);return Y.FromValuesToRef(1,0,0,0,0,a,t,0,0,-t,a,0,0,0,0,1,e),e._updateIdentityStatus(a===1&&t===0),e}static RotationY(l){const e=new Y;return Y.RotationYToRef(l,e),e}static RotationYToRef(l,e){const t=Math.sin(l),a=Math.cos(l);return Y.FromValuesToRef(a,0,-t,0,0,1,0,0,t,0,a,0,0,0,0,1,e),e._updateIdentityStatus(a===1&&t===0),e}static RotationZ(l){const e=new Y;return Y.RotationZToRef(l,e),e}static RotationZToRef(l,e){const t=Math.sin(l),a=Math.cos(l);return Y.FromValuesToRef(a,t,0,0,-t,a,0,0,0,0,1,0,0,0,0,1,e),e._updateIdentityStatus(a===1&&t===0),e}static RotationAxis(l,e){const t=new Y;return Y.RotationAxisToRef(l,e,t),t}static RotationAxisToRef(l,e,t){const a=Math.sin(-e),s=Math.cos(-e),d=1-s;l.normalize();const i=t._m;return i[0]=l._x*l._x*d+s,i[1]=l._x*l._y*d-l._z*a,i[2]=l._x*l._z*d+l._y*a,i[3]=0,i[4]=l._y*l._x*d+l._z*a,i[5]=l._y*l._y*d+s,i[6]=l._y*l._z*d-l._x*a,i[7]=0,i[8]=l._z*l._x*d-l._y*a,i[9]=l._z*l._y*d+l._x*a,i[10]=l._z*l._z*d+s,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,t.markAsUpdated(),t}static RotationAlignToRef(l,e,t){const a=r.Dot(e,l),s=t._m;if(a<-1+Sl)s[0]=-1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0;else{const d=r.Cross(e,l),i=1/(1+a);s[0]=d._x*d._x*i+a,s[1]=d._y*d._x*i-d._z,s[2]=d._z*d._x*i+d._y,s[3]=0,s[4]=d._x*d._y*i+d._z,s[5]=d._y*d._y*i+a,s[6]=d._z*d._y*i-d._x,s[7]=0,s[8]=d._x*d._z*i-d._y,s[9]=d._y*d._z*i+d._x,s[10]=d._z*d._z*i+a,s[11]=0}return s[12]=0,s[13]=0,s[14]=0,s[15]=1,t.markAsUpdated(),t}static RotationYawPitchRoll(l,e,t){const a=new Y;return Y.RotationYawPitchRollToRef(l,e,t,a),a}static RotationYawPitchRollToRef(l,e,t,a){return _.RotationYawPitchRollToRef(l,e,t,P.Quaternion[0]),P.Quaternion[0].toRotationMatrix(a),a}static Scaling(l,e,t){const a=new Y;return Y.ScalingToRef(l,e,t,a),a}static ScalingToRef(l,e,t,a){return Y.FromValuesToRef(l,0,0,0,0,e,0,0,0,0,t,0,0,0,0,1,a),a._updateIdentityStatus(l===1&&e===1&&t===1),a}static Translation(l,e,t){const a=new Y;return Y.TranslationToRef(l,e,t,a),a}static TranslationToRef(l,e,t,a){return Y.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,l,e,t,1,a),a._updateIdentityStatus(l===0&&e===0&&t===0),a}static Lerp(l,e,t){const a=new l.constructor;return Y.LerpToRef(l,e,t,a),a}static LerpToRef(l,e,t,a){const s=a._m,d=l.m,i=e.m;for(let c=0;c<16;c++)s[c]=d[c]*(1-t)+i[c]*t;return a.markAsUpdated(),a}static DecomposeLerp(l,e,t){const a=new l.constructor;return Y.DecomposeLerpToRef(l,e,t,a),a}static DecomposeLerpToRef(l,e,t,a){const s=P.Vector3[0],d=P.Quaternion[0],i=P.Vector3[1];l.decompose(s,d,i);const c=P.Vector3[2],n=P.Quaternion[1],h=P.Vector3[3];e.decompose(c,n,h);const m=P.Vector3[4];r.LerpToRef(s,c,t,m);const o=P.Quaternion[2];_.SlerpToRef(d,n,t,o);const b=P.Vector3[5];return r.LerpToRef(i,h,t,b),Y.ComposeToRef(m,o,b,a),a}static LookAtLH(l,e,t){const a=new Y;return Y.LookAtLHToRef(l,e,t,a),a}static LookAtLHToRef(l,e,t,a){const s=P.Vector3[0],d=P.Vector3[1],i=P.Vector3[2];e.subtractToRef(l,i),i.normalize(),r.CrossToRef(t,i,s);const c=s.lengthSquared();c===0?s.x=1:s.normalizeFromLength(Math.sqrt(c)),r.CrossToRef(i,s,d),d.normalize();const n=-r.Dot(s,l),h=-r.Dot(d,l),m=-r.Dot(i,l);Y.FromValuesToRef(s._x,d._x,i._x,0,s._y,d._y,i._y,0,s._z,d._z,i._z,0,n,h,m,1,a)}static LookAtRH(l,e,t){const a=new Y;return Y.LookAtRHToRef(l,e,t,a),a}static LookAtRHToRef(l,e,t,a){const s=P.Vector3[0],d=P.Vector3[1],i=P.Vector3[2];l.subtractToRef(e,i),i.normalize(),r.CrossToRef(t,i,s);const c=s.lengthSquared();c===0?s.x=1:s.normalizeFromLength(Math.sqrt(c)),r.CrossToRef(i,s,d),d.normalize();const n=-r.Dot(s,l),h=-r.Dot(d,l),m=-r.Dot(i,l);return Y.FromValuesToRef(s._x,d._x,i._x,0,s._y,d._y,i._y,0,s._z,d._z,i._z,0,n,h,m,1,a),a}static LookDirectionLH(l,e){const t=new Y;return Y.LookDirectionLHToRef(l,e,t),t}static LookDirectionLHToRef(l,e,t){const a=P.Vector3[0];a.copyFrom(l),a.scaleInPlace(-1);const s=P.Vector3[1];return r.CrossToRef(e,a,s),Y.FromValuesToRef(s._x,s._y,s._z,0,e._x,e._y,e._z,0,a._x,a._y,a._z,0,0,0,0,1,t),t}static LookDirectionRH(l,e){const t=new Y;return Y.LookDirectionRHToRef(l,e,t),t}static LookDirectionRHToRef(l,e,t){const a=P.Vector3[2];return r.CrossToRef(e,l,a),Y.FromValuesToRef(a._x,a._y,a._z,0,e._x,e._y,e._z,0,l._x,l._y,l._z,0,0,0,0,1,t),t}static OrthoLH(l,e,t,a,s){const d=new Y;return Y.OrthoLHToRef(l,e,t,a,d,s),d}static OrthoLHToRef(l,e,t,a,s,d){const i=t,c=a,n=2/l,h=2/e,m=2/(c-i),o=-(c+i)/(c-i);return Y.FromValuesToRef(n,0,0,0,0,h,0,0,0,0,m,0,0,0,o,1,s),d&&s.multiplyToRef(Oe,s),s._updateIdentityStatus(n===1&&h===1&&m===1&&o===0),s}static OrthoOffCenterLH(l,e,t,a,s,d,i){const c=new Y;return Y.OrthoOffCenterLHToRef(l,e,t,a,s,d,c,i),c}static OrthoOffCenterLHToRef(l,e,t,a,s,d,i,c){const n=s,h=d,m=2/(e-l),o=2/(a-t),b=2/(h-n),u=-(h+n)/(h-n),V=(l+e)/(l-e),G=(a+t)/(t-a);return Y.FromValuesToRef(m,0,0,0,0,o,0,0,0,0,b,0,V,G,u,1,i),c&&i.multiplyToRef(Oe,i),i.markAsUpdated(),i}static OrthoOffCenterRH(l,e,t,a,s,d,i){const c=new Y;return Y.OrthoOffCenterRHToRef(l,e,t,a,s,d,c,i),c}static OrthoOffCenterRHToRef(l,e,t,a,s,d,i,c){return Y.OrthoOffCenterLHToRef(l,e,t,a,s,d,i,c),i._m[10]*=-1,i}static PerspectiveLH(l,e,t,a,s,d=0){const i=new Y,c=t,n=a,h=2*c/l,m=2*c/e,o=(n+c)/(n-c),b=-2*n*c/(n-c),u=Math.tan(d);return Y.FromValuesToRef(h,0,0,0,0,m,0,u,0,0,o,1,0,0,b,0,i),s&&i.multiplyToRef(Oe,i),i._updateIdentityStatus(!1),i}static PerspectiveFovLH(l,e,t,a,s,d=0,i=!1){const c=new Y;return Y.PerspectiveFovLHToRef(l,e,t,a,c,!0,s,d,i),c}static PerspectiveFovLHToRef(l,e,t,a,s,d=!0,i,c=0,n=!1){const h=t,m=a,o=1/Math.tan(l*.5),b=d?o/e:o,u=d?o:o*e,V=n&&h===0?-1:m!==0?(m+h)/(m-h):1,G=n&&h===0?2*m:m!==0?-2*m*h/(m-h):-2*h,p=Math.tan(c);return Y.FromValuesToRef(b,0,0,0,0,u,0,p,0,0,V,1,0,0,G,0,s),i&&s.multiplyToRef(Oe,s),s._updateIdentityStatus(!1),s}static PerspectiveFovReverseLHToRef(l,e,t,a,s,d=!0,i,c=0){const n=1/Math.tan(l*.5),h=d?n/e:n,m=d?n:n*e,o=Math.tan(c);return Y.FromValuesToRef(h,0,0,0,0,m,0,o,0,0,-t,1,0,0,1,0,s),i&&s.multiplyToRef(Oe,s),s._updateIdentityStatus(!1),s}static PerspectiveFovRH(l,e,t,a,s,d=0,i=!1){const c=new Y;return Y.PerspectiveFovRHToRef(l,e,t,a,c,!0,s,d,i),c}static PerspectiveFovRHToRef(l,e,t,a,s,d=!0,i,c=0,n=!1){const h=t,m=a,o=1/Math.tan(l*.5),b=d?o/e:o,u=d?o:o*e,V=n&&h===0?1:m!==0?-(m+h)/(m-h):-1,G=n&&h===0?2*m:m!==0?-2*m*h/(m-h):-2*h,p=Math.tan(c);return Y.FromValuesToRef(b,0,0,0,0,u,0,p,0,0,V,-1,0,0,G,0,s),i&&s.multiplyToRef(Oe,s),s._updateIdentityStatus(!1),s}static PerspectiveFovReverseRHToRef(l,e,t,a,s,d=!0,i,c=0){const n=1/Math.tan(l*.5),h=d?n/e:n,m=d?n:n*e,o=Math.tan(c);return Y.FromValuesToRef(h,0,0,0,0,m,0,o,0,0,-t,-1,0,0,-1,0,s),i&&s.multiplyToRef(Oe,s),s._updateIdentityStatus(!1),s}static PerspectiveFovWebVRToRef(l,e,t,a,s=!1,d,i=0){const c=s?-1:1,n=Math.tan(l.upDegrees*Math.PI/180),h=Math.tan(l.downDegrees*Math.PI/180),m=Math.tan(l.leftDegrees*Math.PI/180),o=Math.tan(l.rightDegrees*Math.PI/180),b=2/(m+o),u=2/(n+h),V=Math.tan(i),G=a._m;return G[0]=b,G[1]=G[2]=G[3]=G[4]=0,G[5]=u,G[6]=0,G[7]=V,G[8]=(m-o)*b*.5,G[9]=-((n-h)*u*.5),G[10]=-t/(e-t),G[11]=1*c,G[12]=G[13]=G[15]=0,G[14]=-(2*t*e)/(t-e),d&&a.multiplyToRef(Oe,a),a.markAsUpdated(),a}static GetFinalMatrix(l,e,t,a,s,d){const i=l.width,c=l.height,n=l.x,h=l.y,m=Y.FromValues(i/2,0,0,0,0,-c/2,0,0,0,0,d-s,0,n+i/2,c/2+h,s,1),o=new e.constructor;return e.multiplyToRef(t,o),o.multiplyToRef(a,o),o.multiplyToRef(m,o)}static GetAsMatrix2x2(l){const e=l.m,t=[e[0],e[1],e[4],e[5]];return kl.MatrixUse64Bits?t:new Float32Array(t)}static GetAsMatrix3x3(l){const e=l.m,t=[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10]];return kl.MatrixUse64Bits?t:new Float32Array(t)}static Transpose(l){const e=new l.constructor;return Y.TransposeToRef(l,e),e}static TransposeToRef(l,e){const t=e._m,a=l.m;return t[0]=a[0],t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=a[1],t[5]=a[5],t[6]=a[9],t[7]=a[13],t[8]=a[2],t[9]=a[6],t[10]=a[10],t[11]=a[14],t[12]=a[3],t[13]=a[7],t[14]=a[11],t[15]=a[15],e.markAsUpdated(),e._updateIdentityStatus(l._isIdentity,l._isIdentityDirty),e}static Reflection(l){const e=new Y;return Y.ReflectionToRef(l,e),e}static ReflectionToRef(l,e){l.normalize();const t=l.normal.x,a=l.normal.y,s=l.normal.z,d=-2*t,i=-2*a,c=-2*s;return Y.FromValuesToRef(d*t+1,i*t,c*t,0,d*a,i*a+1,c*a,0,d*s,i*s,c*s+1,0,d*l.d,i*l.d,c*l.d,1,e),e}static FromXYZAxesToRef(l,e,t,a){return Y.FromValuesToRef(l._x,l._y,l._z,0,e._x,e._y,e._z,0,t._x,t._y,t._z,0,0,0,0,1,a),a}static FromQuaternionToRef(l,e){const t=l._x*l._x,a=l._y*l._y,s=l._z*l._z,d=l._x*l._y,i=l._z*l._w,c=l._z*l._x,n=l._y*l._w,h=l._y*l._z,m=l._x*l._w;return e._m[0]=1-2*(a+s),e._m[1]=2*(d+i),e._m[2]=2*(c-n),e._m[3]=0,e._m[4]=2*(d-i),e._m[5]=1-2*(s+t),e._m[6]=2*(h+m),e._m[7]=0,e._m[8]=2*(c+n),e._m[9]=2*(h-m),e._m[10]=1-2*(a+t),e._m[11]=0,e._m[12]=0,e._m[13]=0,e._m[14]=0,e._m[15]=1,e.markAsUpdated(),e}}Y._UpdateFlagSeed=0;Y._IdentityReadOnly=Y.Identity();class P{}P.Vector3=_l.BuildTuple(11,r.Zero);P.Matrix=_l.BuildTuple(2,Y.Identity);P.Quaternion=_l.BuildTuple(3,_.Zero);class f{}f.Vector2=_l.BuildTuple(3,Wl.Zero);f.Vector3=_l.BuildTuple(13,r.Zero);f.Vector4=_l.BuildTuple(3,Fl.Zero);f.Quaternion=_l.BuildTuple(2,_.Zero);f.Matrix=_l.BuildTuple(8,Y.Identity);ce("BABYLON.Vector2",Wl);ce("BABYLON.Vector3",r);ce("BABYLON.Vector4",Fl);ce("BABYLON.Matrix",Y);const Oe=Y.FromValues(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1);class ei{constructor(l,e=!1,t,a){this.initialize(l,e,t,a)}initialize(l,e=!1,t,a){return this.mask=l,this.skipNextObservers=e,this.target=t,this.currentTarget=a,this}}class ti{constructor(l,e,t=null){this.callback=l,this.mask=e,this.scope=t,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}class z{constructor(l){this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._eventState=new ei(0),l&&(this._onObserverAdded=l)}static FromPromise(l,e){const t=new z;return l.then(a=>{t.notifyObservers(a)}).catch(a=>{if(e)e.notifyObservers(a);else throw a}),t}get observers(){return this._observers}add(l,e=-1,t=!1,a=null,s=!1){if(!l)return null;const d=new ti(l,e,a);return d.unregisterOnNextCall=s,t?this._observers.unshift(d):this._observers.push(d),this._onObserverAdded&&this._onObserverAdded(d),d}addOnce(l){return this.add(l,void 0,void 0,void 0,!0)}remove(l){return l&&this._observers.indexOf(l)!==-1?(this._deferUnregister(l),!0):!1}removeCallback(l,e){for(let t=0;t<this._observers.length;t++){const a=this._observers[t];if(!a._willBeUnregistered&&a.callback===l&&(!e||e===a.scope))return this._deferUnregister(a),!0}return!1}_deferUnregister(l){this._numObserversMarkedAsDeleted++,l.unregisterOnNextCall=!1,l._willBeUnregistered=!0,setTimeout(()=>{this._remove(l)},0)}_remove(l){if(!l)return!1;const e=this._observers.indexOf(l);return e!==-1?(this._numObserversMarkedAsDeleted--,this._observers.splice(e,1),!0):!1}makeObserverTopPriority(l){this._remove(l),this._observers.unshift(l)}makeObserverBottomPriority(l){this._remove(l),this._observers.push(l)}notifyObservers(l,e=-1,t,a,s){if(!this._observers.length)return!0;const d=this._eventState;d.mask=e,d.target=t,d.currentTarget=a,d.skipNextObservers=!1,d.lastReturnValue=l,d.userInfo=s;for(const i of this._observers)if(!i._willBeUnregistered&&(i.mask&e&&(i.unregisterOnNextCall&&this._deferUnregister(i),i.scope?d.lastReturnValue=i.callback.apply(i.scope,[l,d]):d.lastReturnValue=i.callback(l,d)),d.skipNextObservers))return!1;return!0}notifyObserver(l,e,t=-1){if(l._willBeUnregistered)return;const a=this._eventState;a.mask=t,a.skipNextObservers=!1,l.unregisterOnNextCall&&this._deferUnregister(l),l.callback(e,a)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const l=new z;return l._observers=this._observers.slice(0),l}hasSpecificMask(l=-1){for(const e of this._observers)if(e.mask&l||e.mask===l)return!0;return!1}}class ai{constructor(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}get wrapU(){return this._cachedWrapU}set wrapU(l){this._cachedWrapU=l}get wrapV(){return this._cachedWrapV}set wrapV(l){this._cachedWrapV=l}get wrapR(){return this._cachedWrapR}set wrapR(l){this._cachedWrapR=l}get anisotropicFilteringLevel(){return this._cachedAnisotropicFilteringLevel}set anisotropicFilteringLevel(l){this._cachedAnisotropicFilteringLevel=l}get comparisonFunction(){return this._comparisonFunction}set comparisonFunction(l){this._comparisonFunction=l}get useMipMaps(){return this._useMipMaps}set useMipMaps(l){this._useMipMaps=l}setParameters(l=1,e=1,t=1,a=1,s=2,d=0){return this._cachedWrapU=l,this._cachedWrapV=e,this._cachedWrapR=t,this._cachedAnisotropicFilteringLevel=a,this.samplingMode=s,this._comparisonFunction=d,this}compareSampler(l){return this._cachedWrapU===l._cachedWrapU&&this._cachedWrapV===l._cachedWrapV&&this._cachedWrapR===l._cachedWrapR&&this._cachedAnisotropicFilteringLevel===l._cachedAnisotropicFilteringLevel&&this.samplingMode===l.samplingMode&&this._comparisonFunction===l._comparisonFunction&&this._useMipMaps===l._useMipMaps}}var Cl;(function(Z){Z[Z.Unknown=0]="Unknown",Z[Z.Url=1]="Url",Z[Z.Temp=2]="Temp",Z[Z.Raw=3]="Raw",Z[Z.Dynamic=4]="Dynamic",Z[Z.RenderTarget=5]="RenderTarget",Z[Z.MultiRenderTarget=6]="MultiRenderTarget",Z[Z.Cube=7]="Cube",Z[Z.CubeRaw=8]="CubeRaw",Z[Z.CubePrefiltered=9]="CubePrefiltered",Z[Z.Raw3D=10]="Raw3D",Z[Z.Raw2DArray=11]="Raw2DArray",Z[Z.DepthStencil=12]="DepthStencil",Z[Z.CubeRawRGBD=13]="CubeRawRGBD",Z[Z.Depth=14]="Depth"})(Cl||(Cl={}));class Qe extends ai{constructor(l,e,t=!1){super(),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new z,this.onErrorObservable=new z,this.onRebuildCallback=null,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=Cl.Unknown,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._cachedCoordinatesMode=null,this._isDisabled=!1,this._compression=null,this._sphericalPolynomial=null,this._sphericalPolynomialPromise=null,this._sphericalPolynomialComputed=!1,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._useSRGBBuffer=!1,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._hardwareTexture=null,this._maxLodLevel=null,this._references=1,this._gammaSpace=null,this._engine=l,this._source=e,this._uniqueId=Qe._Counter++,t||(this._hardwareTexture=l._createHardwareTexture())}get useMipMaps(){return this.generateMipMaps}set useMipMaps(l){this.generateMipMaps=l}get uniqueId(){return this._uniqueId}_setUniqueId(l){this._uniqueId=l}getEngine(){return this._engine}get source(){return this._source}incrementReferences(){this._references++}updateSize(l,e,t=1){this._engine.updateTextureDimensions(this,l,e,t),this.width=l,this.height=e,this.depth=t,this.baseWidth=l,this.baseHeight=e,this.baseDepth=t,this._size=l*e*t}_rebuild(){var l;if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){const t=this.onRebuildCallback(this),a=s=>{s._swapAndDie(this,!1),this.isReady=t.isReady};t.isAsync?t.proxy.then(a):a(t.proxy);return}let e;switch(this.source){case Cl.Temp:break;case Cl.Url:e=this._engine.createTexture((l=this._originalUrl)!==null&&l!==void 0?l:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,t=>{t._swapAndDie(this,!1),this.isReady=!0},null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer);return;case Cl.Raw:e=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,void 0,this._useSRGBBuffer),e._swapAndDie(this,!1),this.isReady=!0;break;case Cl.Raw3D:e=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),e._swapAndDie(this,!1),this.isReady=!0;break;case Cl.Raw2DArray:e=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),e._swapAndDie(this,!1),this.isReady=!0;break;case Cl.Dynamic:e=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode),e._swapAndDie(this,!1),this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);break;case Cl.Cube:e=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,()=>{e._swapAndDie(this,!1),this.isReady=!0},null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer);return;case Cl.CubeRaw:e=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),e._swapAndDie(this,!1),this.isReady=!0;break;case Cl.CubeRawRGBD:return;case Cl.CubePrefiltered:e=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,t=>{t&&t._swapAndDie(this,!1),this.isReady=!0},null,this.format,this._extension),e._sphericalPolynomial=this._sphericalPolynomial;return}}_swapAndDie(l,e=!0){var t;(t=this._hardwareTexture)===null||t===void 0||t.setUsage(l._source,this.generateMipMaps,this.isCube,this.width,this.height),l._hardwareTexture=this._hardwareTexture,e&&(l._isRGBD=this._isRGBD),this._lodTextureHigh&&(l._lodTextureHigh&&l._lodTextureHigh.dispose(),l._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(l._lodTextureMid&&l._lodTextureMid.dispose(),l._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(l._lodTextureLow&&l._lodTextureLow.dispose(),l._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(l._irradianceTexture&&l._irradianceTexture.dispose(),l._irradianceTexture=this._irradianceTexture);const a=this._engine.getLoadedTexturesCache();let s=a.indexOf(this);s!==-1&&a.splice(s,1),s=a.indexOf(l),s===-1&&a.push(l)}dispose(){this._references--,this.onLoadedObservable.clear(),this.onErrorObservable.clear(),this._references===0&&(this._engine._releaseTexture(this),this._hardwareTexture=null)}}Qe._Counter=0;function jl(){return typeof window<"u"}function od(){return typeof navigator<"u"}function Qt(){return typeof document<"u"}function us(Z){let l="",e=Z.firstChild;for(;e;)e.nodeType===3&&(l+=e.textContent),e=e.nextSibling;return l}const ds={IsWindowObjectExist:jl,IsNavigatorAvailable:od,IsDocumentAvailable:Qt,GetDOMTextContent:us};function O(Z){return`${Z} needs to be imported before as it contains a side-effect required by your code.`}class M{static _CheckLimit(l,e){let t=M._LogLimitOutputs[l];return t?t.current++:(t={limit:e,current:1},M._LogLimitOutputs[l]=t),t.current<=t.limit}static _GenerateLimitMessage(l,e=1){var t;const a=M._LogLimitOutputs[l];if(!a||!M.MessageLimitReached)return;const s=this._Levels[e];a.current===a.limit&&M[s.name](M.MessageLimitReached.replace(/%LIMIT%/g,""+a.limit).replace(/%TYPE%/g,(t=s.name)!==null&&t!==void 0?t:""))}static _AddLogEntry(l){M._LogCache=l+M._LogCache,M.OnNewCacheEntry&&M.OnNewCacheEntry(l)}static _FormatMessage(l){const e=a=>a<10?"0"+a:""+a,t=new Date;return"["+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"]: "+l}static _LogDisabled(l,e){}static _LogEnabled(l=1,e,t){if(t!==void 0&&!M._CheckLimit(e,t))return;const a=M._FormatMessage(e),s=this._Levels[l];s.logFunc&&s.logFunc("BJS - "+a);const d=`<div style='color:${s.color}'>${a}</div><br>`;M._AddLogEntry(d),M._GenerateLimitMessage(e,l)}static get LogCache(){return M._LogCache}static ClearLogCache(){M._LogCache="",M._LogLimitOutputs={},M.errorsCount=0}static set LogLevels(l){M.Log=M._LogDisabled,M.Warn=M._LogDisabled,M.Error=M._LogDisabled,[M.MessageLogLevel,M.WarningLogLevel,M.ErrorLogLevel].forEach(e=>{if((l&e)===e){const t=this._Levels[e];M[t.name]=M._LogEnabled.bind(M,e)}})}}M.NoneLogLevel=0;M.MessageLogLevel=1;M.WarningLogLevel=2;M.ErrorLogLevel=4;M.AllLogLevel=7;M.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.";M._LogCache="";M._LogLimitOutputs={};M._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}];M.errorsCount=0;M.Log=M._LogEnabled.bind(M,M.MessageLogLevel);M.Warn=M._LogEnabled.bind(M,M.WarningLogLevel);M.Error=M._LogEnabled.bind(M,M.ErrorLogLevel);const si="attribute",di="varying";class Et{constructor(){this.children=[]}isValid(l){return!0}process(l,e){var t,a,s,d,i,c;let n="";if(this.line){let h=this.line;const m=e.processor;if(m){m.lineProcessor&&(h=m.lineProcessor(h,e.isFragment,e.processingContext));const o=(a=(t=e.processor)===null||t===void 0?void 0:t.attributeKeywordName)!==null&&a!==void 0?a:si,b=e.isFragment&&!((s=e.processor)===null||s===void 0)&&s.varyingFragmentKeywordName?(d=e.processor)===null||d===void 0?void 0:d.varyingFragmentKeywordName:!e.isFragment&&!((i=e.processor)===null||i===void 0)&&i.varyingVertexKeywordName?(c=e.processor)===null||c===void 0?void 0:c.varyingVertexKeywordName:di;!e.isFragment&&m.attributeProcessor&&this.line.startsWith(o)?h=m.attributeProcessor(this.line,l,e.processingContext):m.varyingProcessor&&this.line.startsWith(b)?h=m.varyingProcessor(this.line,e.isFragment,l,e.processingContext):m.uniformProcessor&&m.uniformRegexp&&m.uniformRegexp.test(this.line)?e.lookForClosingBracketForUniformBuffer||(h=m.uniformProcessor(this.line,e.isFragment,l,e.processingContext)):m.uniformBufferProcessor&&m.uniformBufferRegexp&&m.uniformBufferRegexp.test(this.line)?e.lookForClosingBracketForUniformBuffer||(h=m.uniformBufferProcessor(this.line,e.isFragment,e.processingContext),e.lookForClosingBracketForUniformBuffer=!0):m.textureProcessor&&m.textureRegexp&&m.textureRegexp.test(this.line)?h=m.textureProcessor(this.line,e.isFragment,l,e.processingContext):(m.uniformProcessor||m.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!e.lookForClosingBracketForUniformBuffer&&(/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?m.uniformProcessor&&(h=m.uniformProcessor(this.line,e.isFragment,l,e.processingContext)):m.uniformBufferProcessor&&(h=m.uniformBufferProcessor(this.line,e.isFragment,e.processingContext),e.lookForClosingBracketForUniformBuffer=!0)),e.lookForClosingBracketForUniformBuffer&&this.line.indexOf("}")!==-1&&(e.lookForClosingBracketForUniformBuffer=!1,m.endOfUniformBufferProcessor&&(h=m.endOfUniformBufferProcessor(this.line,e.isFragment,e.processingContext)))}n+=h+`\r
`}return this.children.forEach(h=>{n+=h.process(l,e)}),this.additionalDefineKey&&(l[this.additionalDefineKey]=this.additionalDefineValue||"true"),n}}class ii{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(l){this._lines.length=0;for(const e of l){if(e[0]==="#"){this._lines.push(e);continue}if(e.trim().startsWith("//")){this._lines.push(e);continue}const t=e.split(";");for(let a=0;a<t.length;a++){let s=t[a];s=s.trim(),s&&this._lines.push(s+(a!==t.length-1?";":""))}}}}class Ka extends Et{process(l,e){for(let t=0;t<this.children.length;t++){const a=this.children[t];if(a.isValid(l))return a.process(l,e)}return""}}class ci extends Et{isValid(l){return this.testExpression.isTrue(l)}}class te{isTrue(l){return!0}static postfixToInfix(l){const e=[];for(const t of l)if(te._OperatorPriority[t]===void 0)e.push(t);else{const a=e[e.length-1],s=e[e.length-2];e.length-=2,e.push(`(${s}${t}${a})`)}return e[e.length-1]}static infixToPostfix(l){const e=[];let t=-1;const a=()=>{n=n.trim(),n!==""&&(e.push(n),n="")},s=h=>{t<te._Stack.length-1&&(te._Stack[++t]=h)},d=()=>te._Stack[t],i=()=>t===-1?"!!INVALID EXPRESSION!!":te._Stack[t--];let c=0,n="";for(;c<l.length;){const h=l.charAt(c),m=c<l.length-1?l.substr(c,2):"";if(h==="(")n="",s(h);else if(h===")"){for(a();t!==-1&&d()!=="(";)e.push(i());i()}else if(te._OperatorPriority[m]>1){for(a();t!==-1&&te._OperatorPriority[d()]>=te._OperatorPriority[m];)e.push(i());s(m),c++}else n+=h;c++}for(a();t!==-1;)d()==="("?i():e.push(i());return e}}te._OperatorPriority={")":0,"(":1,"||":2,"&&":3};te._Stack=["","","","","","","","","","","","","","","","","","","",""];class ta extends te{constructor(l,e=!1){super(),this.define=l,this.not=e}isTrue(l){let e=l[this.define]!==void 0;return this.not&&(e=!e),e}}class ni extends te{isTrue(l){return this.leftOperand.isTrue(l)||this.rightOperand.isTrue(l)}}class Zi extends te{isTrue(l){return this.leftOperand.isTrue(l)&&this.rightOperand.isTrue(l)}}class hi extends te{constructor(l,e,t){super(),this.define=l,this.operand=e,this.testValue=t}isTrue(l){let e=l[this.define];e===void 0&&(e=this.define);let t=!1;const a=parseInt(e),s=parseInt(this.testValue);switch(this.operand){case">":t=a>s;break;case"<":t=a<s;break;case"<=":t=a<=s;break;case">=":t=a>=s;break;case"==":t=a===s;break}return t}}var wl;(function(Z){Z[Z.GLSL=0]="GLSL",Z[Z.WGSL=1]="WGSL"})(wl||(wl={}));const mi=/defined\s*?\((.+?)\)/g,Ba=/defined\s*?\[(.+?)\]/g,Ms=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g;class ot{static Initialize(l){l.processor&&l.processor.initializeShaders&&l.processor.initializeShaders(l.processingContext)}static Process(l,e,t,a){var s;!((s=e.processor)===null||s===void 0)&&s.preProcessShaderCode&&(l=e.processor.preProcessShaderCode(l,e.isFragment)),this._ProcessIncludes(l,e,d=>{e.processCodeAfterIncludes&&(d=e.processCodeAfterIncludes(e.isFragment?"fragment":"vertex",d));const i=this._ProcessShaderConversion(d,e,a);t(i,d)})}static PreProcess(l,e,t,a){var s;!((s=e.processor)===null||s===void 0)&&s.preProcessShaderCode&&(l=e.processor.preProcessShaderCode(l,e.isFragment)),this._ProcessIncludes(l,e,d=>{e.processCodeAfterIncludes&&(d=e.processCodeAfterIncludes(e.isFragment?"fragment":"vertex",d));const i=this._ApplyPreProcessing(d,e,a);t(i,d)})}static Finalize(l,e,t){return!t.processor||!t.processor.finalizeShaders?{vertexCode:l,fragmentCode:e}:t.processor.finalizeShaders(l,e,t.processingContext)}static _ProcessPrecision(l,e){var t;if(!((t=e.processor)===null||t===void 0)&&t.noPrecision)return l;const a=e.shouldUseHighPrecisionShader;return l.indexOf("precision highp float")===-1?a?l=`precision highp float;
`+l:l=`precision mediump float;
`+l:a||(l=l.replace("precision highp float","precision mediump float")),l}static _ExtractOperation(l){const e=/defined\((.+)\)/.exec(l);if(e&&e.length)return new ta(e[1].trim(),l[0]==="!");const t=["==",">=","<=","<",">"];let a="",s=0;for(a of t)if(s=l.indexOf(a),s>-1)break;if(s===-1)return new ta(l);const d=l.substring(0,s).trim(),i=l.substring(s+a.length).trim();return new hi(d,a,i)}static _BuildSubExpression(l){l=l.replace(mi,"defined[$1]");const e=te.infixToPostfix(l),t=[];for(const s of e)if(s!=="||"&&s!=="&&")t.push(s);else if(t.length>=2){let d=t[t.length-1],i=t[t.length-2];t.length-=2;const c=s=="&&"?new Zi:new ni;typeof d=="string"&&(d=d.replace(Ba,"defined($1)")),typeof i=="string"&&(i=i.replace(Ba,"defined($1)")),c.leftOperand=typeof i=="string"?this._ExtractOperation(i):i,c.rightOperand=typeof d=="string"?this._ExtractOperation(d):d,t.push(c)}let a=t[t.length-1];return typeof a=="string"&&(a=a.replace(Ba,"defined($1)")),typeof a=="string"?this._ExtractOperation(a):a}static _BuildExpression(l,e){const t=new ci,a=l.substring(0,e);let s=l.substring(e);return s=s.substring(0,(s.indexOf("//")+1||s.length+1)-1).trim(),a==="#ifdef"?t.testExpression=new ta(s):a==="#ifndef"?t.testExpression=new ta(s,!0):t.testExpression=this._BuildSubExpression(s),t}static _MoveCursorWithinIf(l,e,t){let a=l.currentLine;for(;this._MoveCursor(l,t);){a=l.currentLine;const s=a.substring(0,5).toLowerCase();if(s==="#else"){const d=new Et;e.children.push(d),this._MoveCursor(l,d);return}else if(s==="#elif"){const d=this._BuildExpression(a,5);e.children.push(d),t=d}}}static _MoveCursor(l,e){for(;l.canRead;){l.lineIndex++;const t=l.currentLine,a=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/.exec(t);if(a&&a.length)switch(a[0]){case"#ifdef":{const s=new Ka;e.children.push(s);const d=this._BuildExpression(t,6);s.children.push(d),this._MoveCursorWithinIf(l,s,d);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const s=new Ka;e.children.push(s);const d=this._BuildExpression(t,7);s.children.push(d),this._MoveCursorWithinIf(l,s,d);break}case"#if":{const s=new Ka,d=this._BuildExpression(t,3);e.children.push(s),s.children.push(d),this._MoveCursorWithinIf(l,s,d);break}}else{const s=new Et;if(s.line=t,e.children.push(s),t[0]==="#"&&t[1]==="d"){const d=t.replace(";","").split(" ");s.additionalDefineKey=d[1],d.length===3&&(s.additionalDefineValue=d[2])}}}return!1}static _EvaluatePreProcessors(l,e,t){const a=new Et,s=new ii;return s.lineIndex=-1,s.lines=l.split(`
`),this._MoveCursor(s,a),a.process(e,t)}static _PreparePreProcessors(l,e){var t;const a=l.defines,s={};for(const d of a){const i=d.replace("#define","").replace(";","").trim().split(" ");s[i[0]]=i.length>1?i[1]:""}return((t=l.processor)===null||t===void 0?void 0:t.shaderLanguage)===wl.GLSL&&(s.GL_ES="true"),s.__VERSION__=l.version,s[l.platformName]="true",e._getGlobalDefines(s),s}static _ProcessShaderConversion(l,e,t){let a=this._ProcessPrecision(l,e);if(!e.processor||e.processor.shaderLanguage===wl.GLSL&&a.indexOf("#version 3")!==-1&&(a=a.replace("#version 300 es",""),!e.processor.parseGLES3))return a;const s=e.defines,d=this._PreparePreProcessors(e,t);return e.processor.preProcessor&&(a=e.processor.preProcessor(a,s,e.isFragment,e.processingContext)),a=this._EvaluatePreProcessors(a,d,e),e.processor.postProcessor&&(a=e.processor.postProcessor(a,s,e.isFragment,e.processingContext,t)),t._features.needShaderCodeInlining&&(a=t.inlineShaderCode(a)),a}static _ApplyPreProcessing(l,e,t){var a,s;let d=l;const i=e.defines,c=this._PreparePreProcessors(e,t);return!((a=e.processor)===null||a===void 0)&&a.preProcessor&&(d=e.processor.preProcessor(d,i,e.isFragment,e.processingContext)),d=this._EvaluatePreProcessors(d,c,e),!((s=e.processor)===null||s===void 0)&&s.postProcessor&&(d=e.processor.postProcessor(d,i,e.isFragment,e.processingContext,t)),t._features.needShaderCodeInlining&&(d=t.inlineShaderCode(d)),d}static _ProcessIncludes(l,e,t){let a=Ms.exec(l),s=new String(l),d=!1;for(;a!=null;){let i=a[1];if(i.indexOf("__decl__")!==-1&&(i=i.replace(/__decl__/,""),e.supportsUniformBuffers&&(i=i.replace(/Vertex/,"Ubo"),i=i.replace(/Fragment/,"Ubo")),i=i+"Declaration"),e.includesShadersStore[i]){let c=e.includesShadersStore[i];if(a[2]){const n=a[3].split(",");for(let h=0;h<n.length;h+=2){const m=new RegExp(n[h],"g"),o=n[h+1];c=c.replace(m,o)}}if(a[4]){const n=a[5];if(n.indexOf("..")!==-1){const h=n.split(".."),m=parseInt(h[0]);let o=parseInt(h[1]),b=c.slice(0);c="",isNaN(o)&&(o=e.indexParameters[h[1]]);for(let u=m;u<o;u++)e.supportsUniformBuffers||(b=b.replace(/light\{X\}.(\w*)/g,(V,G)=>G+"{X}")),c+=b.replace(/\{X\}/g,u.toString())+`
`}else e.supportsUniformBuffers||(c=c.replace(/light\{X\}.(\w*)/g,(h,m)=>m+"{X}")),c=c.replace(/\{X\}/g,n)}s=s.replace(a[0],c),d=d||c.indexOf("#include<")>=0||c.indexOf("#include <")>=0}else{const c=e.shadersRepository+"ShadersInclude/"+i+".fx";ot._FileToolsLoadFile(c,n=>{e.includesShadersStore[i]=n,this._ProcessIncludes(s,e,t)});return}a=Ms.exec(l)}d?this._ProcessIncludes(s.toString(),e,t):t(s)}static _FileToolsLoadFile(l,e,t,a,s,d){throw O("FileTools")}}class H{static GetShadersRepository(l=wl.GLSL){return l===wl.GLSL?H.ShadersRepository:H.ShadersRepositoryWGSL}static GetShadersStore(l=wl.GLSL){return l===wl.GLSL?H.ShadersStore:H.ShadersStoreWGSL}static GetIncludesShadersStore(l=wl.GLSL){return l===wl.GLSL?H.IncludesShadersStore:H.IncludesShadersStoreWGSL}}H.ShadersRepository="src/Shaders/";H.ShadersStore={};H.IncludesShadersStore={};H.ShadersRepositoryWGSL="src/ShadersWGSL/";H.ShadersStoreWGSL={};H.IncludesShadersStoreWGSL={};class Tl{constructor(l,e,t,a=null,s,d=null,i=null,c=null,n=null,h,m="",o=wl.GLSL){var b,u,V;this.name=null,this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new z,this.onErrorObservable=new z,this._onBindObservable=null,this._wasPreviouslyReady=!1,this._forceRebindOnNextCall=!1,this._wasPreviouslyUsingInstances=null,this._isDisposed=!1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this.name=l,this._key=m;let G,p=null;if(e.attributes){const k=e;if(this._engine=t,this._attributesNames=k.attributes,this._uniformsNames=k.uniformsNames.concat(k.samplers),this._samplerList=k.samplers.slice(),this.defines=k.defines,this.onError=k.onError,this.onCompiled=k.onCompiled,this._fallbacks=k.fallbacks,this._indexParameters=k.indexParameters,this._transformFeedbackVaryings=k.transformFeedbackVaryings||null,this._multiTarget=!!k.multiTarget,this._shaderLanguage=(b=k.shaderLanguage)!==null&&b!==void 0?b:wl.GLSL,k.uniformBuffersNames){this._uniformBuffersNamesList=k.uniformBuffersNames.slice();for(let g=0;g<k.uniformBuffersNames.length;g++)this._uniformBuffersNames[k.uniformBuffersNames[g]]=g}p=(u=k.processFinalCode)!==null&&u!==void 0?u:null,G=(V=k.processCodeAfterIncludes)!==null&&V!==void 0?V:void 0}else this._engine=s,this.defines=d??"",this._uniformsNames=t.concat(a),this._samplerList=a?a.slice():[],this._attributesNames=e,this._uniformBuffersNamesList=[],this._shaderLanguage=o,this.onError=n,this.onCompiled=c,this._indexParameters=h,this._fallbacks=i;this._attributeLocationByName={},this.uniqueId=Tl._UniqueIdSeed++;let y,L;const N=jl()?this._engine.getHostDocument():null;l.vertexSource?y="source:"+l.vertexSource:l.vertexElement?(y=N?N.getElementById(l.vertexElement):null,y||(y=l.vertexElement)):y=l.vertex||l,l.fragmentSource?L="source:"+l.fragmentSource:l.fragmentElement?(L=N?N.getElementById(l.fragmentElement):null,L||(L=l.fragmentElement)):L=l.fragment||l,this._processingContext=this._engine._getShaderProcessingContext(this._shaderLanguage);let J={defines:this.defines.split(`
`),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:H.GetShadersRepository(this._shaderLanguage),includesShadersStore:H.GetIncludesShadersStore(this._shaderLanguage),version:(this._engine.version*100).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:G};const R=[void 0,void 0],S=()=>{if(R[0]&&R[1]){J.isFragment=!0;const[k,g]=R;ot.Process(g,J,(ll,ol)=>{this._fragmentSourceCodeBeforeMigration=ol,p&&(ll=p("fragment",ll));const ml=ot.Finalize(k,ll,J);this._useFinalCode(ml.vertexCode,ml.fragmentCode,l)},this._engine)}};this._loadShader(y,"Vertex","",k=>{ot.Initialize(J),ot.Process(k,J,(g,ll)=>{this._rawVertexSourceCode=k,this._vertexSourceCodeBeforeMigration=ll,p&&(g=p("vertex",g)),R[0]=g,S()},this._engine)}),this._loadShader(L,"Fragment","Pixel",k=>{this._rawFragmentSourceCode=k,R[1]=k,S()}),J=null;const T=function(k){return function(){return this._pipelineContext&&this._pipelineContext[k].apply(this._pipelineContext,arguments),this}};["Int?","UInt?","IntArray?","UIntArray?","Array?","Color?","Vector?","Float?","Matrices","Matrix","Matrix3x3","Matrix2x2","Quaternion","DirectColor4"].forEach(k=>{const g=`set${k}`;g.endsWith("?")?["",2,3,4].forEach(ll=>{this[g.slice(0,-1)+ll]=this[g.slice(0,-1)+ll]||T(g.slice(0,-1)+ll).bind(this)}):this[g]=this[g]||T(g).bind(this)})}static get ShadersRepository(){return H.ShadersRepository}static set ShadersRepository(l){H.ShadersRepository=l}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new z),this._onBindObservable}_useFinalCode(l,e,t){if(t){const a=t.vertexElement||t.vertex||t.spectorName||t,s=t.fragmentElement||t.fragment||t.spectorName||t;this._vertexSourceCode=(this._shaderLanguage===wl.WGSL?"//":"")+"#define SHADER_NAME vertex:"+a+`
`+l,this._fragmentSourceCode=(this._shaderLanguage===wl.WGSL?"//":"")+"#define SHADER_NAME fragment:"+s+`
`+e}else this._vertexSourceCode=l,this._fragmentSourceCode=e;this._prepareEffect()}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return this._isReady?!0:this._pipelineContext?this._pipelineContext.isReady:!1}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(l){return this._attributes[l]}getAttributeLocationByName(l){return this._attributeLocationByName[l]}getAttributesCount(){return this._attributes.length}getUniformIndex(l){return this._uniformsNames.indexOf(l)}getUniform(l){return this._uniforms[l]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}executeWhenCompiled(l){if(this.isReady()){l(this);return}this.onCompileObservable.add(e=>{l(e)}),(!this._pipelineContext||this._pipelineContext.isAsync)&&setTimeout(()=>{this._checkIsReady(null)},16)}_checkIsReady(l){try{if(this._isReadyInternal())return}catch(e){this._processCompilationErrors(e,l);return}this._isDisposed||setTimeout(()=>{this._checkIsReady(l)},16)}_loadShader(l,e,t,a){if(typeof HTMLElement<"u"&&l instanceof HTMLElement){const i=us(l);a(i);return}if(l.substr(0,7)==="source:"){a(l.substr(7));return}if(l.substr(0,7)==="base64:"){const i=window.atob(l.substr(7));a(i);return}const s=H.GetShadersStore(this._shaderLanguage);if(s[l+e+"Shader"]){a(s[l+e+"Shader"]);return}if(t&&s[l+t+"Shader"]){a(s[l+t+"Shader"]);return}let d;l[0]==="."||l[0]==="/"||l.indexOf("http")>-1?d=l:d=H.GetShadersRepository(this._shaderLanguage)+l,this._engine._loadFile(d+"."+e.toLowerCase()+".fx",a)}get vertexSourceCode(){var l,e;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(e=(l=this._pipelineContext)===null||l===void 0?void 0:l._getVertexShaderCode())!==null&&e!==void 0?e:this._vertexSourceCode}get fragmentSourceCode(){var l,e;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(e=(l=this._pipelineContext)===null||l===void 0?void 0:l._getFragmentShaderCode())!==null&&e!==void 0?e:this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}_rebuildProgram(l,e,t,a){this._isReady=!1,this._vertexSourceCodeOverride=l,this._fragmentSourceCodeOverride=e,this.onError=(s,d)=>{a&&a(d)},this.onCompiled=()=>{const s=this.getEngine().scenes;if(s)for(let d=0;d<s.length;d++)s[d].markAllMaterialsAsDirty(63);this._pipelineContext._handlesSpectorRebuildCallback(t)},this._fallbacks=null,this._prepareEffect()}_prepareEffect(){const l=this._attributesNames,e=this.defines,t=this._pipelineContext;this._isReady=!1;try{const a=this._engine;this._pipelineContext=a.createPipelineContext(this._processingContext),this._pipelineContext._name=this._key;const s=this._rebuildProgram.bind(this);this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?a._preparePipelineContext(this._pipelineContext,this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,!0,this._rawVertexSourceCode,this._rawFragmentSourceCode,s,null,this._transformFeedbackVaryings,this._key):a._preparePipelineContext(this._pipelineContext,this._vertexSourceCode,this._fragmentSourceCode,!1,this._rawVertexSourceCode,this._rawFragmentSourceCode,s,e,this._transformFeedbackVaryings,this._key),a._executeWhenRenderingStateIsCompiled(this._pipelineContext,()=>{if(this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,l,this._attributes),l)for(let d=0;d<l.length;d++){const i=l[d];this._attributeLocationByName[i]=this._attributes[d]}a.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),t&&this.getEngine()._deletePipelineContext(t)}),this._pipelineContext.isAsync&&this._checkIsReady(t)}catch(a){this._processCompilationErrors(a,t)}}_getShaderCodeAndErrorLine(l,e,t){const a=t?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let s=null;if(e&&l){const d=e.match(a);if(d&&d.length===2){const i=parseInt(d[1]),c=l.split(`
`,-1);c.length>=i&&(s=`Offending line [${i}] in ${t?"fragment":"vertex"} code: ${c[i-1]}`)}}return[l,s]}_processCompilationErrors(l,e=null){var t,a,s;this._compilationError=l.message;const d=this._attributesNames,i=this._fallbacks;if(M.Error("Unable to compile effect:"),M.Error("Uniforms: "+this._uniformsNames.map(function(n){return" "+n})),M.Error("Attributes: "+d.map(function(n){return" "+n})),M.Error(`Defines:\r
`+this.defines),Tl.LogShaderCodeOnCompilationError){let n=null,h=null,m=null;!((t=this._pipelineContext)===null||t===void 0)&&t._getVertexShaderCode()&&([m,n]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),m&&(M.Error("Vertex code:"),M.Error(m))),!((a=this._pipelineContext)===null||a===void 0)&&a._getFragmentShaderCode()&&([m,h]=this._getShaderCodeAndErrorLine((s=this._pipelineContext)===null||s===void 0?void 0:s._getFragmentShaderCode(),this._compilationError,!0),m&&(M.Error("Fragment code:"),M.Error(m))),n&&M.Error(n),h&&M.Error(h)}M.Error("Error: "+this._compilationError);const c=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this)};e&&(this._pipelineContext=e,this._isReady=!0,c()),i?(this._pipelineContext=null,i.hasMoreFallbacks?(this._allFallbacksProcessed=!1,M.Error("Trying next fallback."),this.defines=i.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,c(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,e||c())}get isSupported(){return this._compilationError===""}_bindTexture(l,e){this._engine._bindTexture(this._samplers[l],e,l)}setTexture(l,e){this._engine.setTexture(this._samplers[l],this._uniforms[l],e,l)}setDepthStencilTexture(l,e){this._engine.setDepthStencilTexture(this._samplers[l],this._uniforms[l],e,l)}setTextureArray(l,e){const t=l+"Ex";if(this._samplerList.indexOf(t+"0")===-1){const a=this._samplerList.indexOf(l);for(let d=1;d<e.length;d++){const i=t+(d-1).toString();this._samplerList.splice(a+d,0,i)}let s=0;for(const d of this._samplerList)this._samplers[d]=s,s+=1}this._engine.setTextureArray(this._samplers[l],this._uniforms[l],e,l)}setTextureFromPostProcess(l,e){this._engine.setTextureFromPostProcess(this._samplers[l],e,l)}setTextureFromPostProcessOutput(l,e){this._engine.setTextureFromPostProcessOutput(this._samplers[l],e,l)}bindUniformBuffer(l,e){const t=this._uniformBuffersNames[e];t===void 0||Tl._BaseCache[t]===l&&this._engine._features.useUBOBindingCache||(Tl._BaseCache[t]=l,this._engine.bindUniformBufferBase(l,t,e))}bindUniformBlock(l,e){this._engine.bindUniformBlock(this._pipelineContext,l,e)}setFloatArray(l,e){return this._pipelineContext.setArray(l,e),this}setFloatArray2(l,e){return this._pipelineContext.setArray2(l,e),this}setFloatArray3(l,e){return this._pipelineContext.setArray3(l,e),this}setFloatArray4(l,e){return this._pipelineContext.setArray4(l,e),this}setBool(l,e){return this._pipelineContext.setInt(l,e?1:0),this}dispose(){var l;(l=this._pipelineContext)===null||l===void 0||l.dispose(),this._engine._releaseEffect(this),this._isDisposed=!0}static RegisterShader(l,e,t,a=wl.GLSL){e&&(H.GetShadersStore(a)[`${l}PixelShader`]=e),t&&(H.GetShadersStore(a)[`${l}VertexShader`]=t)}static ResetCache(){Tl._BaseCache={}}}Tl.LogShaderCodeOnCompilationError=!0;Tl._UniqueIdSeed=0;Tl._BaseCache={};Tl.ShadersStore=H.ShadersStore;Tl.IncludesShadersStore=H.IncludesShadersStore;class oi{constructor(l=!0){this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,l&&this.reset()}get isDirty(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}get zOffset(){return this._zOffset}set zOffset(l){this._zOffset!==l&&(this._zOffset=l,this._isZOffsetDirty=!0)}get zOffsetUnits(){return this._zOffsetUnits}set zOffsetUnits(l){this._zOffsetUnits!==l&&(this._zOffsetUnits=l,this._isZOffsetDirty=!0)}get cullFace(){return this._cullFace}set cullFace(l){this._cullFace!==l&&(this._cullFace=l,this._isCullFaceDirty=!0)}get cull(){return this._cull}set cull(l){this._cull!==l&&(this._cull=l,this._isCullDirty=!0)}get depthFunc(){return this._depthFunc}set depthFunc(l){this._depthFunc!==l&&(this._depthFunc=l,this._isDepthFuncDirty=!0)}get depthMask(){return this._depthMask}set depthMask(l){this._depthMask!==l&&(this._depthMask=l,this._isDepthMaskDirty=!0)}get depthTest(){return this._depthTest}set depthTest(l){this._depthTest!==l&&(this._depthTest=l,this._isDepthTestDirty=!0)}get frontFace(){return this._frontFace}set frontFace(l){this._frontFace!==l&&(this._frontFace=l,this._isFrontFaceDirty=!0)}reset(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1}apply(l){this.isDirty&&(this._isCullDirty&&(this.cull?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(l.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(l.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(l.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(l.enable(l.POLYGON_OFFSET_FILL),l.polygonOffset(this.zOffset,this.zOffsetUnits)):l.disable(l.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(l.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}}class Be{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=Be.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=Be.KEEP,this.opDepthFail=Be.KEEP,this.opStencilDepthPass=Be.REPLACE}get stencilFunc(){return this.func}set stencilFunc(l){this.func=l}get stencilFuncRef(){return this.funcRef}set stencilFuncRef(l){this.funcRef=l}get stencilFuncMask(){return this.funcMask}set stencilFuncMask(l){this.funcMask=l}get stencilOpStencilFail(){return this.opStencilFail}set stencilOpStencilFail(l){this.opStencilFail=l}get stencilOpDepthFail(){return this.opDepthFail}set stencilOpDepthFail(l){this.opDepthFail=l}get stencilOpStencilDepthPass(){return this.opStencilDepthPass}set stencilOpStencilDepthPass(l){this.opStencilDepthPass=l}get stencilMask(){return this.mask}set stencilMask(l){this.mask=l}get stencilTest(){return this.enabled}set stencilTest(l){this.enabled=l}}Be.ALWAYS=519;Be.KEEP=7680;Be.REPLACE=7681;class bi{constructor(){this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}get isDirty(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}get alphaBlend(){return this._alphaBlend}set alphaBlend(l){this._alphaBlend!==l&&(this._alphaBlend=l,this._isAlphaBlendDirty=!0)}setAlphaBlendConstants(l,e,t,a){this._blendConstants[0]===l&&this._blendConstants[1]===e&&this._blendConstants[2]===t&&this._blendConstants[3]===a||(this._blendConstants[0]=l,this._blendConstants[1]=e,this._blendConstants[2]=t,this._blendConstants[3]=a,this._isBlendConstantsDirty=!0)}setAlphaBlendFunctionParameters(l,e,t,a){this._blendFunctionParameters[0]===l&&this._blendFunctionParameters[1]===e&&this._blendFunctionParameters[2]===t&&this._blendFunctionParameters[3]===a||(this._blendFunctionParameters[0]=l,this._blendFunctionParameters[1]=e,this._blendFunctionParameters[2]=t,this._blendFunctionParameters[3]=a,this._isBlendFunctionParametersDirty=!0)}setAlphaEquationParameters(l,e){this._blendEquationParameters[0]===l&&this._blendEquationParameters[1]===e||(this._blendEquationParameters[0]=l,this._blendEquationParameters[1]=e,this._isBlendEquationParametersDirty=!0)}reset(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1}apply(l){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?l.enable(l.BLEND):l.disable(l.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(l.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(l.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(l.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}}class Xi{constructor(){this.shaderLanguage=wl.GLSL}postProcessor(l,e,t,a,s){if(!s.getCaps().drawBuffersExtension){const d=/#extension.+GL_EXT_draw_buffers.+(enable|require)/g;l=l.replace(d,"")}return l}}class ui{constructor(){this.shaderLanguage=wl.GLSL}attributeProcessor(l){return l.replace("attribute","in")}varyingProcessor(l,e){return l.replace("varying",e?"in":"out")}postProcessor(l,e,t){const a=l.search(/#extension.+GL_EXT_draw_buffers.+require/)!==-1,s=/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g;if(l=l.replace(s,""),l=l.replace(/texture2D\s*\(/g,"texture("),t)l=l.replace(/texture2DLodEXT\s*\(/g,"textureLod("),l=l.replace(/textureCubeLodEXT\s*\(/g,"textureLod("),l=l.replace(/textureCube\s*\(/g,"texture("),l=l.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),l=l.replace(/gl_FragColor/g,"glFragColor"),l=l.replace(/gl_FragData/g,"glFragData"),l=l.replace(/void\s+?main\s*\(/g,(a?"":`layout(location = 0) out vec4 glFragColor;
`)+"void main(");else if(e.indexOf("#define MULTIVIEW")!==-1)return`#extension GL_OVR_multiview2 : require
layout (num_views = 2) in;
`+l;return l}}class jt{constructor(){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=jt._Counter++}get underlyingResource(){return null}}jt._Counter=0;class Pt extends jt{constructor(l){super(),this._buffer=l}get underlyingResource(){return this._buffer}}const ri=["Int","Int2","Int3","Int4","UInt","UInt2","UInt3","UInt4","Vector2","Vector3","Vector4","Float2","Float","Float3","Float4","Quaternion","Color3","Color4","DirectColor4"];class Gi{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null;const l=[],e=function(){l.length=0,Array.prototype.push.apply(l,arguments),l[0]=this._uniforms[l[0]]},t=a=>{const s=ri.includes(a.substring(3))&&"FloatN";if(s){const d=this[`_cache${s}`];return function(){const i=this.engine[a];e.apply(this,arguments),d.apply(this,arguments)&&(i.apply(this.engine,l)||(this._valueCache[arguments[0]]=null))}}else return function(){const d=this.engine[a];e.apply(this,arguments),arguments[1]!==void 0&&(this._valueCache[arguments[0]]=null,d.apply(this.engine,l))}};["Int?","UInt?","IntArray?","UIntArray?","Array?","Float?","Matrices","Matrix3x3","Matrix2x2"].forEach(a=>{const s=`set${a}`;this[s]||(s.endsWith("?")?["",2,3,4].forEach(d=>{this[s.slice(0,-1)+d]=this[s.slice(0,-1)+d]||t(s.slice(0,-1)+d).bind(this)}):this[s]=this[s]||t(s).bind(this))})}get isAsync(){return this.isParallelCompiled}get isReady(){return this.program?this.isParallelCompiled?this.engine._isRenderingStateCompiled(this):!0:!1}_handlesSpectorRebuildCallback(l){l&&this.program&&l(this.program)}_fillEffectInformation(l,e,t,a,s,d,i,c){const n=this.engine;if(n.supportsUniformBuffers)for(const m in e)l.bindUniformBlock(m,e[m]);this.engine.getUniforms(this,t).forEach((m,o)=>{a[t[o]]=m}),this._uniforms=a;let h;for(h=0;h<s.length;h++)l.getUniform(s[h])==null&&(s.splice(h,1),h--);s.forEach((m,o)=>{d[m]=o});for(const m of n.getAttributes(this,i))c.push(m)}dispose(){this._uniforms={}}_cacheMatrix(l,e){const t=this._valueCache[l],a=e.updateFlag;return t!==void 0&&t===a?!1:(this._valueCache[l]=a,!0)}_cacheFloatN(l,e,t,a,s){let d=this._valueCache[arguments[0]];if(!d||d.length!==arguments.length-1)return d=Array.prototype.slice.call(arguments,1),this._valueCache[arguments[0]]=d,!0;let i=!1;for(let c=0;c<d.length;++c)d[c]!==arguments[c+1]&&(d[c]=arguments[c+1],i=!0);return i}_cacheFloat2(l,e,t){return this._cacheFloatN(l,e,t)}_cacheFloat3(l,e,t,a){return this._cacheFloatN(l,e,t,a)}_cacheFloat4(l,e,t,a,s){return this._cacheFloatN(l,e,t,a,s)}setMatrix(l,e){this._cacheMatrix(l,e)&&(this.engine.setMatrices(this._uniforms[l],e.toArray())||(this._valueCache[l]=null))}setVector2(l,e){this.setFloat2(l,e.x,e.y)}setVector3(l,e){this.setFloat3(l,e.x,e.y,e.z)}setVector4(l,e){this.setFloat4(l,e.x,e.y,e.z,e.w)}setQuaternion(l,e){this.setFloat4(l,e.x,e.y,e.z,e.w)}setColor3(l,e){this.setFloat3(l,e.r,e.g,e.b)}setColor4(l,e,t){this.setFloat4(l,e.r,e.g,e.b,t)}setDirectColor4(l,e){this.setFloat4(l,e.r,e.g,e.b,e.a)}_getVertexShaderCode(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null}}class bd{constructor(l=null,e){if(this._MSAARenderBuffer=null,this._context=e,!l&&(l=e.createTexture(),!l))throw new Error("Unable to create webGL texture");this.set(l)}get underlyingResource(){return this._webGLTexture}setUsage(){}set(l){this._webGLTexture=l}reset(){this._webGLTexture=null,this._MSAARenderBuffer=null}release(){this._MSAARenderBuffer&&(this._context.deleteRenderbuffer(this._MSAARenderBuffer),this._MSAARenderBuffer=null),this._webGLTexture&&this._context.deleteTexture(this._webGLTexture),this.reset()}}class Mt{constructor(l,e=!0){this.effect=null,this.defines=null,this.drawContext=l.createDrawContext(),e&&(this.materialContext=l.createMaterialContext())}static IsWrapper(l){return l.getPipelineContext===void 0}static GetEffect(l){return l.getPipelineContext===void 0?l.effect:l}setEffect(l,e,t=!0){var a;this.effect=l,e!==void 0&&(this.defines=e),t&&((a=this.drawContext)===null||a===void 0||a.reset())}dispose(){var l;(l=this.drawContext)===null||l===void 0||l.dispose()}}class Vi{constructor(l=!0){this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,l&&this.reset()}get isDirty(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}get func(){return this._func}set func(l){this._func!==l&&(this._func=l,this._isStencilFuncDirty=!0)}get funcRef(){return this._funcRef}set funcRef(l){this._funcRef!==l&&(this._funcRef=l,this._isStencilFuncDirty=!0)}get funcMask(){return this._funcMask}set funcMask(l){this._funcMask!==l&&(this._funcMask=l,this._isStencilFuncDirty=!0)}get opStencilFail(){return this._opStencilFail}set opStencilFail(l){this._opStencilFail!==l&&(this._opStencilFail=l,this._isStencilOpDirty=!0)}get opDepthFail(){return this._opDepthFail}set opDepthFail(l){this._opDepthFail!==l&&(this._opDepthFail=l,this._isStencilOpDirty=!0)}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(l){this._opStencilDepthPass!==l&&(this._opStencilDepthPass=l,this._isStencilOpDirty=!0)}get mask(){return this._mask}set mask(l){this._mask!==l&&(this._mask=l,this._isStencilMaskDirty=!0)}get enabled(){return this._enabled}set enabled(l){this._enabled!==l&&(this._enabled=l,this._isStencilTestDirty=!0)}reset(){var l;this.stencilMaterial=void 0,(l=this.stencilGlobal)===null||l===void 0||l.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0}apply(l){var e;if(!l)return;const t=!this.useStencilGlobalOnly&&!!(!((e=this.stencilMaterial)===null||e===void 0)&&e.enabled);this.enabled=t?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=t?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=t?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=t?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=t?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=t?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=t?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=t?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(l.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(l.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(l.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}}class bt{static get Now(){return ds.IsWindowObjectExist()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}class Ri{}class Zl{constructor(l,e,t,a){this._name="WebGL",this.forcePOTTextures=!1,this.isFullscreen=!1,this.cullBackFaces=null,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this.validateShaderPrograms=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this.disableUniformBuffers=!1,this.onDisposeObservable=new z,this._frameId=0,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._webGLVersion=1,this._windowIsBackground=!1,this._highPrecisionShadersAllowed=!0,this._badOS=!1,this._badDesktopOS=!1,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this.onContextLostObservable=new z,this.onContextRestoredObservable=new z,this._contextWasLost=!1,this._doNotHandleContextLost=!1,this.disableVertexArrayObjects=!1,this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new oi,this._stencilStateComposer=new Vi,this._stencilState=new Be,this._alphaState=new bi,this._alphaMode=1,this._alphaEquation=0,this._internalTexturesCache=new Array,this._renderTargetWrapperCache=new Array,this._activeChannel=0,this._currentTextureChannel=-1,this._boundTexturesCache={},this._compiledEffects={},this._vertexAttribArraysEnabled=[],this._uintIndicesCurrentlySet=!1,this._currentBoundBuffer=new Array,this._currentFramebuffer=null,this._dummyFramebuffer=null,this._currentBufferPointers=new Array,this._currentInstanceLocations=new Array,this._currentInstanceBuffers=new Array,this._vaoRecordInProgress=!1,this._mustWipeVertexAttributes=!1,this._nextFreeTextureSlots=new Array,this._maxSimultaneousTextures=0,this._maxMSAASamplesOverride=null,this._activeRequests=new Array,this.adaptToDeviceRatio=!1,this._lastDevicePixelRatio=1,this._transformTextureUrl=null,this.hostInformation={isMobile:!1},this.premultipliedAlpha=!0,this.onBeforeTextureInitObservable=new z,this._isWebGPU=!1,this._snapshotRenderingMode=0,this._useExactSrgbConversions=!1,this._viewportCached={x:0,y:0,z:0,w:0},this._unpackFlipYCached=null,this.enableUnpackFlipYCached=!0,this._boundUniforms={},this.startTime=bt.Now;let s=null;if(t=t||{},this._creationOptions=t,this.adaptToDeviceRatio=a??!1,this._stencilStateComposer.stencilGlobal=this._stencilState,kl.SetMatrixPrecision(!!t.useHighPrecisionMatrix),!l)return;if(a=a||t.adaptToDeviceRatio||!1,l.getContext){if(s=l,this._renderingCanvas=s,e!==void 0&&(t.antialias=e),t.deterministicLockstep===void 0&&(t.deterministicLockstep=!1),t.lockstepMaxSteps===void 0&&(t.lockstepMaxSteps=4),t.timeStep===void 0&&(t.timeStep=1/60),t.preserveDrawingBuffer===void 0&&(t.preserveDrawingBuffer=!1),t.audioEngine===void 0&&(t.audioEngine=!0),t.audioEngineOptions!==void 0&&t.audioEngineOptions.audioContext!==void 0&&(this._audioContext=t.audioEngineOptions.audioContext),t.audioEngineOptions!==void 0&&t.audioEngineOptions.audioDestination!==void 0&&(this._audioDestination=t.audioEngineOptions.audioDestination),t.stencil===void 0&&(t.stencil=!0),t.premultipliedAlpha===!1&&(this.premultipliedAlpha=!1),t.xrCompatible===void 0&&(t.xrCompatible=!0),t.useExactSrgbConversions!==void 0&&(this._useExactSrgbConversions=t.useExactSrgbConversions),this._doNotHandleContextLost=!!t.doNotHandleContextLost,navigator&&navigator.userAgent){this._checkForMobile=()=>{const h=navigator.userAgent;this.hostInformation.isMobile=h.indexOf("Mobile")!==-1||h.indexOf("Mac")!==-1&&Qt()&&"ontouchend"in document},this._checkForMobile(),jl()&&window.addEventListener("resize",this._checkForMobile);const n=navigator.userAgent;for(const h of Zl.ExceptionList){const m=h.key,o=h.targets;if(new RegExp(m).test(n)){if(h.capture&&h.captureConstraint){const b=h.capture,u=h.captureConstraint,V=new RegExp(b).exec(n);if(V&&V.length>0&&parseInt(V[V.length-1])>=u)continue}for(const b of o)switch(b){case"uniformBuffer":this.disableUniformBuffers=!0;break;case"vao":this.disableVertexArrayObjects=!0;break;case"antialias":t.antialias=!1;break;case"maxMSAASamples":this._maxMSAASamplesOverride=1;break}}}}if(this._doNotHandleContextLost||(this._onContextLost=n=>{n.preventDefault(),this._contextWasLost=!0,M.Warn("WebGL context lost."),this.onContextLostObservable.notifyObservers(this)},this._onContextRestored=()=>{this._restoreEngineAfterContextLost(this._initGLContext.bind(this))},s.addEventListener("webglcontextlost",this._onContextLost,!1),s.addEventListener("webglcontextrestored",this._onContextRestored,!1),t.powerPreference="high-performance"),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this._badDesktopOS&&(t.xrCompatible=!1),!t.disableWebGL2Support)try{this._gl=s.getContext("webgl2",t)||s.getContext("experimental-webgl2",t),this._gl&&(this._webGLVersion=2,this._shaderPlatformName="WEBGL2",this._gl.deleteQuery||(this._webGLVersion=1,this._shaderPlatformName="WEBGL1"))}catch{}if(!this._gl){if(!s)throw new Error("The provided canvas is null or undefined.");try{this._gl=s.getContext("webgl",t)||s.getContext("experimental-webgl",t)}catch{throw new Error("WebGL not supported")}}if(!this._gl)throw new Error("WebGL not supported")}else{this._gl=l,this._renderingCanvas=this._gl.canvas,this._gl.renderbufferStorageMultisample?(this._webGLVersion=2,this._shaderPlatformName="WEBGL2"):this._shaderPlatformName="WEBGL1";const n=this._gl.getContextAttributes();n&&(t.stencil=n.stencil)}this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),t.useHighPrecisionFloats!==void 0&&(this._highPrecisionShadersAllowed=t.useHighPrecisionFloats);const d=jl()&&window.devicePixelRatio||1,i=t.limitDeviceRatio||d;this._hardwareScalingLevel=a?1/Math.min(i,d):1,this._lastDevicePixelRatio=d,this.resize(),this._isStencilEnable=!!t.stencil,this._initGLContext(),this._initFeatures();for(let n=0;n<this._caps.maxVertexAttribs;n++)this._currentBufferPointers[n]=new Ri;this._shaderProcessor=this.webGLVersion>1?new ui:new Xi,this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent);const c=`Babylon.js v${Zl.Version}`;console.log(c+` - ${this.description}`),this._renderingCanvas&&this._renderingCanvas.setAttribute&&this._renderingCanvas.setAttribute("data-engine",c)}static get NpmPackage(){return"babylonjs@5.43.0"}static get Version(){return"5.43.0"}get description(){let l=this.name+this.webGLVersion;return this._caps.parallelShaderCompile&&(l+=" - Parallel shader compilation"),l}get name(){return this._name}set name(l){this._name=l}get version(){return this._webGLVersion}static get ShadersRepository(){return Tl.ShadersRepository}static set ShadersRepository(l){Tl.ShadersRepository=l}_getShaderProcessor(l){return this._shaderProcessor}get useReverseDepthBuffer(){return this._useReverseDepthBuffer}set useReverseDepthBuffer(l){l!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=l,l?this._depthCullingState.depthFunc=518:this._depthCullingState.depthFunc=515)}get frameId(){return this._frameId}get supportsUniformBuffers(){return this.webGLVersion>1&&!this.disableUniformBuffers}getCreationOptions(){return this._creationOptions}get _shouldUseHighPrecisionShader(){return!!(this._caps.highPrecisionShaderSupported&&this._highPrecisionShadersAllowed)}get needPOTTextures(){return this._webGLVersion<2||this.forcePOTTextures}get activeRenderLoops(){return this._activeRenderLoops}get doNotHandleContextLost(){return this._doNotHandleContextLost}set doNotHandleContextLost(l){this._doNotHandleContextLost=l}get _supportsHardwareTextureRescaling(){return!1}set framebufferDimensionsObject(l){this._framebufferDimensionsObject=l}get currentViewport(){return this._cachedViewport}get emptyTexture(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture}get emptyTexture3D(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D}get emptyTexture2DArray(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray}get emptyCubeTexture(){if(!this._emptyCubeTexture){const l=new Uint8Array(4),e=[l,l,l,l,l,l];this._emptyCubeTexture=this.createRawCubeTexture(e,1,5,0,!1,!1,1)}return this._emptyCubeTexture}get isWebGPU(){return this._isWebGPU}get shaderPlatformName(){return this._shaderPlatformName}get snapshotRendering(){return!1}set snapshotRendering(l){}get snapshotRenderingMode(){return this._snapshotRenderingMode}set snapshotRenderingMode(l){this._snapshotRenderingMode=l}get useExactSrgbConversions(){return this._useExactSrgbConversions}snapshotRenderingReset(){this.snapshotRendering=!1}static _CreateCanvas(l,e){if(typeof document>"u")return new OffscreenCanvas(l,e);const t=document.createElement("canvas");return t.width=l,t.height=e,t}createCanvas(l,e){return Zl._CreateCanvas(l,e)}createCanvasImage(){return document.createElement("img")}_restoreEngineAfterContextLost(l){setTimeout(async()=>{var e;this._dummyFramebuffer=null;const t=this._depthCullingState.depthTest,a=this._depthCullingState.depthFunc,s=this._depthCullingState.depthMask,d=this._stencilState.stencilTest;await l(),this.wipeCaches(!0),this._rebuildEffects(),(e=this._rebuildComputeEffects)===null||e===void 0||e.call(this),this._rebuildBuffers(),this._rebuildInternalTextures(),this._rebuildRenderTargetWrappers(),this.wipeCaches(!0),this._depthCullingState.depthTest=t,this._depthCullingState.depthFunc=a,this._depthCullingState.depthMask=s,this._stencilState.stencilTest=d,M.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1},0)}_sharedInit(l,e,t){this._renderingCanvas=l}_getShaderProcessingContext(l){return null}_rebuildInternalTextures(){const l=this._internalTexturesCache.slice();for(const e of l)e._rebuild()}_rebuildRenderTargetWrappers(){const l=this._renderTargetWrapperCache.slice();for(const e of l)e._rebuild()}_rebuildEffects(){for(const l in this._compiledEffects){const e=this._compiledEffects[l];e._pipelineContext=null,e._wasPreviouslyReady=!1,e._prepareEffect()}Tl.ResetCache()}areAllEffectsReady(){for(const l in this._compiledEffects)if(!this._compiledEffects[l].isReady())return!1;return!0}_rebuildBuffers(){for(const l of this._uniformBuffers)l._rebuild();for(const l of this._storageBuffers)l._rebuild()}_initGLContext(){var l;this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile")||void 0,standardDerivatives:this._webGLVersion>1||this._gl.getExtension("OES_standard_derivatives")!==null,maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:this._gl.getExtension("WEBGL_compressed_texture_s3tc_srgb")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc_srgb"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||this._gl.getExtension("OES_element_index_uint")!==null,fragmentDepthSupported:this._webGLVersion>1||this._gl.getExtension("EXT_frag_depth")!==null,highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),supportOcclusionQuery:this._webGLVersion>1,canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float")),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1,canUseGLInstanceID:this._webGLVersion>1,canUseGLVertexID:this._webGLVersion>1,supportComputeShaders:!1,supportSRGBBuffers:!1,supportTransformFeedbacks:this._webGLVersion>1,textureMaxLevel:this._webGLVersion>1,texture2DArrayMaxLayerCount:this._webGLVersion>1?256:128},this._glVersion=this._gl.getParameter(this._gl.VERSION);const e=this._gl.getExtension("WEBGL_debug_renderer_info");if(e!=null&&(this._glRenderer=this._gl.getParameter(e.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(e.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor=this._gl.getParameter(this._gl.VENDOR)||"Unknown vendor"),this._glRenderer||(this._glRenderer=this._gl.getParameter(this._gl.RENDERER)||"Unknown renderer"),this._gl.HALF_FLOAT_OES!==36193&&(this._gl.HALF_FLOAT_OES=36193),this._gl.RGBA16F!==34842&&(this._gl.RGBA16F=34842),this._gl.RGBA32F!==34836&&(this._gl.RGBA32F=34836),this._gl.DEPTH24_STENCIL8!==35056&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(this._webGLVersion===1&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=((l=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT))!==null&&l!==void 0?l:0)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!!(this._caps.textureFloat&&this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!!(this._caps.textureFloat&&this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._caps.astc&&(this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR),this._caps.bptc&&(this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT),this._caps.s3tc_srgb&&(this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),this._caps.etc2&&(this._gl.COMPRESSED_SRGB8_ETC2=this._caps.etc2.COMPRESSED_SRGB8_ETC2,this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC),this._webGLVersion>1&&this._gl.HALF_FLOAT_OES!==5131&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=this._maxMSAASamplesOverride!==null?this._maxMSAASamplesOverride:this._gl.getParameter(this._gl.MAX_SAMPLES);else{const t=this._gl.getExtension("WEBGL_draw_buffers");if(t!==null){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=t.drawBuffersWEBGL.bind(t),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(let a=0;a<16;a++)this._gl["COLOR_ATTACHMENT"+a+"_WEBGL"]=t["COLOR_ATTACHMENT"+a+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{const t=this._gl.getExtension("WEBGL_depth_texture");t!=null&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=t.UNSIGNED_INT_24_8_WEBGL)}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{const t=this._gl.getExtension("OES_vertex_array_object");t!=null&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=t.createVertexArrayOES.bind(t),this._gl.bindVertexArray=t.bindVertexArrayOES.bind(t),this._gl.deleteVertexArray=t.deleteVertexArrayOES.bind(t))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{const t=this._gl.getExtension("ANGLE_instanced_arrays");t!=null?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=t.drawArraysInstancedANGLE.bind(t),this._gl.drawElementsInstanced=t.drawElementsInstancedANGLE.bind(t),this._gl.vertexAttribDivisor=t.vertexAttribDivisorANGLE.bind(t)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){const t=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),a=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);t&&a&&(this._caps.highPrecisionShaderSupported=t.precision!==0&&a.precision!==0)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{const t=this._gl.getExtension("EXT_blend_minmax");t!=null&&(this._caps.blendMinMax=!0,this._gl.MAX=t.MAX_EXT,this._gl.MIN=t.MIN_EXT)}if(!this._caps.supportSRGBBuffers){if(this._webGLVersion>1)this._caps.supportSRGBBuffers=!0;else{const t=this._gl.getExtension("EXT_sRGB");t!=null&&(this._caps.supportSRGBBuffers=!0,this._gl.SRGB=t.SRGB_EXT,this._gl.SRGB8=t.SRGB_ALPHA_EXT,this._gl.SRGB8_ALPHA8=t.SRGB_ALPHA_EXT)}this._caps.supportSRGBBuffers=this._caps.supportSRGBBuffers&&!!(this._creationOptions&&this._creationOptions.forceSRGBBufferSupportState)}this._depthCullingState.depthTest=!0,this._depthCullingState.depthFunc=this._gl.LEQUAL,this._depthCullingState.depthMask=!0,this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(let t=0;t<this._maxSimultaneousTextures;t++)this._nextFreeTextureSlots.push(t)}_initFeatures(){this._features={forceBitmapOverHTMLImageElement:!1,supportRenderAndCopyToLodForFloatTextures:this._webGLVersion!==1,supportDepthStencilTexture:this._webGLVersion!==1,supportShadowSamplers:this._webGLVersion!==1,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:this._webGLVersion!==1,trackUbosInFrame:!1,checkUbosContentBeforeUpload:!1,supportCSM:this._webGLVersion!==1,basisNeedsPOT:this._webGLVersion===1,support3DTextures:this._webGLVersion!==1,needTypeSuffixInShaderConstants:this._webGLVersion!==1,supportMSAA:this._webGLVersion!==1,supportSSAO2:this._webGLVersion!==1,supportExtendedTextureFormats:this._webGLVersion!==1,supportSwitchCaseInShader:this._webGLVersion!==1,supportSyncTextureRead:!0,needsInvertingBitmap:!0,useUBOBindingCache:!0,needShaderCodeInlining:!1,needToAlwaysBindUniformBuffers:!1,supportRenderPasses:!1,supportSpriteInstancing:!0,_collectUbosUpdatedInFrame:!1}}get webGLVersion(){return this._webGLVersion}getClassName(){return"ThinEngine"}get isStencilEnable(){return this._isStencilEnable}_prepareWorkingCanvas(){if(this._workingCanvas)return;this._workingCanvas=this.createCanvas(1,1);const l=this._workingCanvas.getContext("2d");l&&(this._workingContext=l)}resetTextureCache(){for(const l in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,l)&&(this._boundTexturesCache[l]=null);this._currentTextureChannel=-1}getInfo(){return this.getGlInfo()}getGlInfo(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}}setHardwareScalingLevel(l){this._hardwareScalingLevel=l,this.resize()}getHardwareScalingLevel(){return this._hardwareScalingLevel}getLoadedTexturesCache(){return this._internalTexturesCache}getCaps(){return this._caps}stopRenderLoop(l){if(!l){this._activeRenderLoops=[];return}const e=this._activeRenderLoops.indexOf(l);e>=0&&this._activeRenderLoops.splice(e,1)}_renderLoop(){if(!this._contextWasLost){let l=!0;if(!this.renderEvenInBackground&&this._windowIsBackground&&(l=!1),l){this.beginFrame();for(let e=0;e<this._activeRenderLoops.length;e++){const t=this._activeRenderLoops[e];t()}this.endFrame()}}this._activeRenderLoops.length>0?this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1}getRenderingCanvas(){return this._renderingCanvas}getAudioContext(){return this._audioContext}getAudioDestination(){return this._audioDestination}getHostWindow(){return jl()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null}getRenderWidth(l=!1){return!l&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth}getRenderHeight(l=!1){return!l&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight}_queueNewFrame(l,e){return Zl.QueueNewFrame(l,e)}runRenderLoop(l){this._activeRenderLoops.indexOf(l)===-1&&(this._activeRenderLoops.push(l),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._boundRenderFunction=this._renderLoop.bind(this),this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))}clear(l,e,t,a=!1){const s=this.stencilStateComposer.useStencilGlobalOnly;this.stencilStateComposer.useStencilGlobalOnly=!0,this.applyStates(),this.stencilStateComposer.useStencilGlobalOnly=s;let d=0;e&&l&&(this._gl.clearColor(l.r,l.g,l.b,l.a!==void 0?l.a:1),d|=this._gl.COLOR_BUFFER_BIT),t&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GEQUAL,this._gl.clearDepth(0)):this._gl.clearDepth(1),d|=this._gl.DEPTH_BUFFER_BIT),a&&(this._gl.clearStencil(0),d|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(d)}_viewport(l,e,t,a){(l!==this._viewportCached.x||e!==this._viewportCached.y||t!==this._viewportCached.z||a!==this._viewportCached.w)&&(this._viewportCached.x=l,this._viewportCached.y=e,this._viewportCached.z=t,this._viewportCached.w=a,this._gl.viewport(l,e,t,a))}setViewport(l,e,t){const a=e||this.getRenderWidth(),s=t||this.getRenderHeight(),d=l.x||0,i=l.y||0;this._cachedViewport=l,this._viewport(d*a,i*s,a*l.width,s*l.height)}beginFrame(){}endFrame(){this._badOS&&this.flushFramebuffer(),this._frameId++}resize(l=!1){let e,t;if(this.adaptToDeviceRatio){const a=jl()&&window.devicePixelRatio||1,s=this._lastDevicePixelRatio/a;this._lastDevicePixelRatio=a,this._hardwareScalingLevel*=s}jl()?(e=this._renderingCanvas?this._renderingCanvas.clientWidth||this._renderingCanvas.width:window.innerWidth,t=this._renderingCanvas?this._renderingCanvas.clientHeight||this._renderingCanvas.height:window.innerHeight):(e=this._renderingCanvas?this._renderingCanvas.width:100,t=this._renderingCanvas?this._renderingCanvas.height:100),this.setSize(e/this._hardwareScalingLevel,t/this._hardwareScalingLevel,l)}setSize(l,e,t=!1){return!this._renderingCanvas||(l=l|0,e=e|0,!t&&this._renderingCanvas.width===l&&this._renderingCanvas.height===e)?!1:(this._renderingCanvas.width=l,this._renderingCanvas.height=e,!0)}bindFramebuffer(l,e=0,t,a,s,d=0,i=0){var c,n,h,m,o;const b=l;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=l,this._bindUnboundFramebuffer(b._MSAAFramebuffer?b._MSAAFramebuffer:b._framebuffer);const u=this._gl;l.is2DArray?u.framebufferTextureLayer(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,(c=l.texture._hardwareTexture)===null||c===void 0?void 0:c.underlyingResource,d,i):l.isCube&&u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_CUBE_MAP_POSITIVE_X+e,(n=l.texture._hardwareTexture)===null||n===void 0?void 0:n.underlyingResource,d);const V=l._depthStencilTexture;if(V){const G=l._depthStencilTextureWithStencil?u.DEPTH_STENCIL_ATTACHMENT:u.DEPTH_ATTACHMENT;l.is2DArray?u.framebufferTextureLayer(u.FRAMEBUFFER,G,(h=V._hardwareTexture)===null||h===void 0?void 0:h.underlyingResource,d,i):l.isCube?u.framebufferTexture2D(u.FRAMEBUFFER,G,u.TEXTURE_CUBE_MAP_POSITIVE_X+e,(m=V._hardwareTexture)===null||m===void 0?void 0:m.underlyingResource,d):u.framebufferTexture2D(u.FRAMEBUFFER,G,u.TEXTURE_2D,(o=V._hardwareTexture)===null||o===void 0?void 0:o.underlyingResource,d)}this._cachedViewport&&!s?this.setViewport(this._cachedViewport,t,a):(t||(t=l.width,d&&(t=t/Math.pow(2,d))),a||(a=l.height,d&&(a=a/Math.pow(2,d))),this._viewport(0,0,t,a)),this.wipeCaches()}setState(l,e=0,t,a=!1,s,d,i=0){var c,n;(this._depthCullingState.cull!==l||t)&&(this._depthCullingState.cull=l);const h=!((n=(c=this.cullBackFaces)!==null&&c!==void 0?c:s)!==null&&n!==void 0)||n?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==h||t)&&(this._depthCullingState.cullFace=h),this.setZOffset(e),this.setZOffsetUnits(i);const m=a?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==m||t)&&(this._depthCullingState.frontFace=m),this._stencilStateComposer.stencilMaterial=d}getDepthBuffer(){return this._depthCullingState.depthTest}setDepthBuffer(l){this._depthCullingState.depthTest=l}setZOffset(l){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-l:l}getZOffset(){const l=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-l:l}setZOffsetUnits(l){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-l:l}getZOffsetUnits(){const l=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-l:l}_bindUnboundFramebuffer(l){this._currentFramebuffer!==l&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,l),this._currentFramebuffer=l)}_currentFrameBufferIsDefaultFrameBuffer(){return this._currentFramebuffer===null}generateMipmaps(l){this._bindTextureDirectly(this._gl.TEXTURE_2D,l,!0),this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)}unBindFramebuffer(l,e=!1,t){var a;const s=l;this._currentRenderTarget=null;const d=this._gl;if(s._MSAAFramebuffer){if(l.isMulti){this.unBindMultiColorAttachmentFramebuffer(l,e,t);return}d.bindFramebuffer(d.READ_FRAMEBUFFER,s._MSAAFramebuffer),d.bindFramebuffer(d.DRAW_FRAMEBUFFER,s._framebuffer),d.blitFramebuffer(0,0,l.width,l.height,0,0,l.width,l.height,d.COLOR_BUFFER_BIT,d.NEAREST)}!((a=l.texture)===null||a===void 0)&&a.generateMipMaps&&!e&&!l.isCube&&this.generateMipmaps(l.texture),t&&(s._MSAAFramebuffer&&this._bindUnboundFramebuffer(s._framebuffer),t()),this._bindUnboundFramebuffer(null)}flushFramebuffer(){this._gl.flush()}restoreDefaultFramebuffer(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null),this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()}_resetVertexBufferBinding(){this.bindArrayBuffer(null),this._cachedVertexBuffers=null}createVertexBuffer(l){return this._createVertexBuffer(l,this._gl.STATIC_DRAW)}_createVertexBuffer(l,e){const t=this._gl.createBuffer();if(!t)throw new Error("Unable to create vertex buffer");const a=new Pt(t);return this.bindArrayBuffer(a),l instanceof Array?this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(l),e):this._gl.bufferData(this._gl.ARRAY_BUFFER,l,e),this._resetVertexBufferBinding(),a.references=1,a}createDynamicVertexBuffer(l){return this._createVertexBuffer(l,this._gl.DYNAMIC_DRAW)}_resetIndexBufferBinding(){this.bindIndexBuffer(null),this._cachedIndexBuffer=null}createIndexBuffer(l,e){const t=this._gl.createBuffer(),a=new Pt(t);if(!t)throw new Error("Unable to create index buffer");this.bindIndexBuffer(a);const s=this._normalizeIndexData(l);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,s,e?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),a.references=1,a.is32Bits=s.BYTES_PER_ELEMENT===4,a}_normalizeIndexData(l){if(l.BYTES_PER_ELEMENT===2)return l;if(this._caps.uintIndices){if(l instanceof Uint32Array)return l;for(let e=0;e<l.length;e++)if(l[e]>=65535)return new Uint32Array(l);return new Uint16Array(l)}return new Uint16Array(l)}bindArrayBuffer(l){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(l,this._gl.ARRAY_BUFFER)}bindUniformBlock(l,e,t){const a=l.program,s=this._gl.getUniformBlockIndex(a,e);this._gl.uniformBlockBinding(a,s,t)}bindIndexBuffer(l){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(l,this._gl.ELEMENT_ARRAY_BUFFER)}_bindBuffer(l,e){(this._vaoRecordInProgress||this._currentBoundBuffer[e]!==l)&&(this._gl.bindBuffer(e,l?l.underlyingResource:null),this._currentBoundBuffer[e]=l)}updateArrayBuffer(l){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,l)}_vertexAttribPointer(l,e,t,a,s,d,i){const c=this._currentBufferPointers[e];if(!c)return;let n=!1;c.active?(c.buffer!==l&&(c.buffer=l,n=!0),c.size!==t&&(c.size=t,n=!0),c.type!==a&&(c.type=a,n=!0),c.normalized!==s&&(c.normalized=s,n=!0),c.stride!==d&&(c.stride=d,n=!0),c.offset!==i&&(c.offset=i,n=!0)):(n=!0,c.active=!0,c.index=e,c.size=t,c.type=a,c.normalized=s,c.stride=d,c.offset=i,c.buffer=l),(n||this._vaoRecordInProgress)&&(this.bindArrayBuffer(l),a===this._gl.UNSIGNED_INT||a===this._gl.INT?this._gl.vertexAttribIPointer(e,t,a,d,i):this._gl.vertexAttribPointer(e,t,a,s,d,i))}_bindIndexBufferWithCache(l){l!=null&&this._cachedIndexBuffer!==l&&(this._cachedIndexBuffer=l,this.bindIndexBuffer(l),this._uintIndicesCurrentlySet=l.is32Bits)}_bindVertexBuffersAttributes(l,e,t){const a=e.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.unbindAllAttributes();for(let s=0;s<a.length;s++){const d=e.getAttributeLocation(s);if(d>=0){const i=a[s];let c=null;if(t&&(c=t[i]),c||(c=l[i]),!c)continue;this._gl.enableVertexAttribArray(d),this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[d]=!0);const n=c.getBuffer();n&&(this._vertexAttribPointer(n,d,c.getSize(),c.type,c.normalized,c.byteStride,c.byteOffset),c.getIsInstanced()&&(this._gl.vertexAttribDivisor(d,c.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(d),this._currentInstanceBuffers.push(n))))}}}recordVertexArrayObject(l,e,t,a){const s=this._gl.createVertexArray();if(!s)throw new Error("Unable to create VAO");return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(s),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(l,t,a),this.bindIndexBuffer(e),this._vaoRecordInProgress=!1,this._gl.bindVertexArray(null),s}bindVertexArrayObject(l,e){this._cachedVertexArrayObject!==l&&(this._cachedVertexArrayObject=l,this._gl.bindVertexArray(l),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=e!=null&&e.is32Bits,this._mustWipeVertexAttributes=!0)}bindBuffersDirectly(l,e,t,a,s){if(this._cachedVertexBuffers!==l||this._cachedEffectForVertexBuffers!==s){this._cachedVertexBuffers=l,this._cachedEffectForVertexBuffers=s;const d=s.getAttributesCount();this._unbindVertexArrayObject(),this.unbindAllAttributes();let i=0;for(let c=0;c<d;c++)if(c<t.length){const n=s.getAttributeLocation(c);n>=0&&(this._gl.enableVertexAttribArray(n),this._vertexAttribArraysEnabled[n]=!0,this._vertexAttribPointer(l,n,t[c],this._gl.FLOAT,!1,a,i)),i+=t[c]*4}}this._bindIndexBufferWithCache(e)}_unbindVertexArrayObject(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))}bindBuffers(l,e,t,a){(this._cachedVertexBuffers!==l||this._cachedEffectForVertexBuffers!==t)&&(this._cachedVertexBuffers=l,this._cachedEffectForVertexBuffers=t,this._bindVertexBuffersAttributes(l,t,a)),this._bindIndexBufferWithCache(e)}unbindInstanceAttributes(){let l;for(let e=0,t=this._currentInstanceLocations.length;e<t;e++){const a=this._currentInstanceBuffers[e];l!=a&&a.references&&(l=a,this.bindArrayBuffer(a));const s=this._currentInstanceLocations[e];this._gl.vertexAttribDivisor(s,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0}releaseVertexArrayObject(l){this._gl.deleteVertexArray(l)}_releaseBuffer(l){return l.references--,l.references===0?(this._deleteBuffer(l),!0):!1}_deleteBuffer(l){this._gl.deleteBuffer(l.underlyingResource)}updateAndBindInstancesBuffer(l,e,t){if(this.bindArrayBuffer(l),e&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e),t[0].index!==void 0)this.bindInstancesBuffer(l,t,!0);else for(let a=0;a<4;a++){const s=t[a];this._vertexAttribArraysEnabled[s]||(this._gl.enableVertexAttribArray(s),this._vertexAttribArraysEnabled[s]=!0),this._vertexAttribPointer(l,s,4,this._gl.FLOAT,!1,64,a*16),this._gl.vertexAttribDivisor(s,1),this._currentInstanceLocations.push(s),this._currentInstanceBuffers.push(l)}}bindInstancesBuffer(l,e,t=!0){this.bindArrayBuffer(l);let a=0;if(t)for(let s=0;s<e.length;s++){const d=e[s];a+=d.attributeSize*4}for(let s=0;s<e.length;s++){const d=e[s];d.index===void 0&&(d.index=this._currentEffect.getAttributeLocationByName(d.attributeName)),!(d.index<0)&&(this._vertexAttribArraysEnabled[d.index]||(this._gl.enableVertexAttribArray(d.index),this._vertexAttribArraysEnabled[d.index]=!0),this._vertexAttribPointer(l,d.index,d.attributeSize,d.attributeType||this._gl.FLOAT,d.normalized||!1,a,d.offset),this._gl.vertexAttribDivisor(d.index,d.divisor===void 0?1:d.divisor),this._currentInstanceLocations.push(d.index),this._currentInstanceBuffers.push(l))}}disableInstanceAttributeByName(l){if(!this._currentEffect)return;const e=this._currentEffect.getAttributeLocationByName(l);this.disableInstanceAttribute(e)}disableInstanceAttribute(l){let e=!1,t;for(;(t=this._currentInstanceLocations.indexOf(l))!==-1;)this._currentInstanceLocations.splice(t,1),this._currentInstanceBuffers.splice(t,1),e=!0,t=this._currentInstanceLocations.indexOf(l);e&&(this._gl.vertexAttribDivisor(l,0),this.disableAttributeByIndex(l))}disableAttributeByIndex(l){this._gl.disableVertexAttribArray(l),this._vertexAttribArraysEnabled[l]=!1,this._currentBufferPointers[l].active=!1}draw(l,e,t,a){this.drawElementsType(l?0:1,e,t,a)}drawPointClouds(l,e,t){this.drawArraysType(2,l,e,t)}drawUnIndexed(l,e,t,a){this.drawArraysType(l?0:1,e,t,a)}drawElementsType(l,e,t,a){this.applyStates(),this._reportDrawCall();const s=this._drawMode(l),d=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,i=this._uintIndicesCurrentlySet?4:2;a?this._gl.drawElementsInstanced(s,t,d,e*i,a):this._gl.drawElements(s,t,d,e*i)}drawArraysType(l,e,t,a){this.applyStates(),this._reportDrawCall();const s=this._drawMode(l);a?this._gl.drawArraysInstanced(s,e,t,a):this._gl.drawArrays(s,e,t)}_drawMode(l){switch(l){case 0:return this._gl.TRIANGLES;case 2:return this._gl.POINTS;case 1:return this._gl.LINES;case 3:return this._gl.POINTS;case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN;default:return this._gl.TRIANGLES}}_reportDrawCall(){}_releaseEffect(l){this._compiledEffects[l._key]&&delete this._compiledEffects[l._key];const e=l.getPipelineContext();e&&this._deletePipelineContext(e)}_deletePipelineContext(l){const e=l;e&&e.program&&(e.program.__SPECTOR_rebuildProgram=null,this._gl.deleteProgram(e.program))}_getGlobalDefines(l){if(l){this.isNDCHalfZRange?l.IS_NDC_HALF_ZRANGE="":delete l.IS_NDC_HALF_ZRANGE,this.useReverseDepthBuffer?l.USE_REVERSE_DEPTHBUFFER="":delete l.USE_REVERSE_DEPTHBUFFER,this.useExactSrgbConversions?l.USE_EXACT_SRGB_CONVERSIONS="":delete l.USE_EXACT_SRGB_CONVERSIONS;return}else{let e="";return this.isNDCHalfZRange&&(e+="#define IS_NDC_HALF_ZRANGE"),this.useReverseDepthBuffer&&(e&&(e+=`
`),e+="#define USE_REVERSE_DEPTHBUFFER"),this.useExactSrgbConversions&&(e&&(e+=`
`),e+="#define USE_EXACT_SRGB_CONVERSIONS"),e}}createEffect(l,e,t,a,s,d,i,c,n,h=wl.GLSL){var m;const o=l.vertexElement||l.vertex||l.vertexToken||l.vertexSource||l,b=l.fragmentElement||l.fragment||l.fragmentToken||l.fragmentSource||l,u=this._getGlobalDefines();let V=(m=s??e.defines)!==null&&m!==void 0?m:"";u&&(V+=u);const G=o+"+"+b+"@"+V;if(this._compiledEffects[G]){const y=this._compiledEffects[G];return i&&y.isReady()&&i(y),y}const p=new Tl(l,e,t,a,this,s,d,i,c,n,G,h);return this._compiledEffects[G]=p,p}static _ConcatenateShader(l,e,t=""){return t+(e?e+`
`:"")+l}_compileShader(l,e,t,a){return this._compileRawShader(Zl._ConcatenateShader(l,t,a),e)}_compileRawShader(l,e){const t=this._gl,a=t.createShader(e==="vertex"?t.VERTEX_SHADER:t.FRAGMENT_SHADER);if(!a){let s=t.NO_ERROR,d=t.NO_ERROR;for(;(d=t.getError())!==t.NO_ERROR;)s=d;throw new Error(`Something went wrong while creating a gl ${e} shader object. gl error=${s}, gl isContextLost=${t.isContextLost()}, _contextWasLost=${this._contextWasLost}`)}return t.shaderSource(a,l),t.compileShader(a),a}_getShaderSource(l){return this._gl.getShaderSource(l)}createRawShaderProgram(l,e,t,a,s=null){a=a||this._gl;const d=this._compileRawShader(e,"vertex"),i=this._compileRawShader(t,"fragment");return this._createShaderProgram(l,d,i,a,s)}createShaderProgram(l,e,t,a,s,d=null){s=s||this._gl;const i=this._webGLVersion>1?`#version 300 es
#define WEBGL2 
`:"",c=this._compileShader(e,"vertex",a,i),n=this._compileShader(t,"fragment",a,i);return this._createShaderProgram(l,c,n,s,d)}inlineShaderCode(l){return l}createPipelineContext(l){const e=new Gi;return e.engine=this,this._caps.parallelShaderCompile&&(e.isParallelCompiled=!0),e}createMaterialContext(){}createDrawContext(){}_createShaderProgram(l,e,t,a,s=null){const d=a.createProgram();if(l.program=d,!d)throw new Error("Unable to create program");return a.attachShader(d,e),a.attachShader(d,t),a.linkProgram(d),l.context=a,l.vertexShader=e,l.fragmentShader=t,l.isParallelCompiled||this._finalizePipelineContext(l),d}_finalizePipelineContext(l){const e=l.context,t=l.vertexShader,a=l.fragmentShader,s=l.program;if(!e.getProgramParameter(s,e.LINK_STATUS)){if(!this._gl.getShaderParameter(t,this._gl.COMPILE_STATUS)){const i=this._gl.getShaderInfoLog(t);if(i)throw l.vertexCompilationError=i,new Error("VERTEX SHADER "+i)}if(!this._gl.getShaderParameter(a,this._gl.COMPILE_STATUS)){const i=this._gl.getShaderInfoLog(a);if(i)throw l.fragmentCompilationError=i,new Error("FRAGMENT SHADER "+i)}const d=e.getProgramInfoLog(s);if(d)throw l.programLinkError=d,new Error(d)}if(this.validateShaderPrograms&&(e.validateProgram(s),!e.getProgramParameter(s,e.VALIDATE_STATUS))){const d=e.getProgramInfoLog(s);if(d)throw l.programValidationError=d,new Error(d)}e.deleteShader(t),e.deleteShader(a),l.vertexShader=void 0,l.fragmentShader=void 0,l.onCompiled&&(l.onCompiled(),l.onCompiled=void 0)}_preparePipelineContext(l,e,t,a,s,d,i,c,n,h){const m=l;a?m.program=this.createRawShaderProgram(m,e,t,void 0,n):m.program=this.createShaderProgram(m,e,t,c,void 0,n),m.program.__SPECTOR_rebuildProgram=i}_isRenderingStateCompiled(l){const e=l;return this._gl.getProgramParameter(e.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)?(this._finalizePipelineContext(e),!0):!1}_executeWhenRenderingStateIsCompiled(l,e){const t=l;if(!t.isParallelCompiled){e();return}const a=t.onCompiled;a?t.onCompiled=()=>{a(),e()}:t.onCompiled=e}getUniforms(l,e){const t=new Array,a=l;for(let s=0;s<e.length;s++)t.push(this._gl.getUniformLocation(a.program,e[s]));return t}getAttributes(l,e){const t=[],a=l;for(let s=0;s<e.length;s++)try{t.push(this._gl.getAttribLocation(a.program,e[s]))}catch{t.push(-1)}return t}enableEffect(l){l=l!==null&&Mt.IsWrapper(l)?l.effect:l,!(!l||l===this._currentEffect)&&(this._stencilStateComposer.stencilMaterial=void 0,l=l,this.bindSamplers(l),this._currentEffect=l,l.onBind&&l.onBind(l),l._onBindObservable&&l._onBindObservable.notifyObservers(l))}setInt(l,e){return l?(this._gl.uniform1i(l,e),!0):!1}setInt2(l,e,t){return l?(this._gl.uniform2i(l,e,t),!0):!1}setInt3(l,e,t,a){return l?(this._gl.uniform3i(l,e,t,a),!0):!1}setInt4(l,e,t,a,s){return l?(this._gl.uniform4i(l,e,t,a,s),!0):!1}setIntArray(l,e){return l?(this._gl.uniform1iv(l,e),!0):!1}setIntArray2(l,e){return!l||e.length%2!==0?!1:(this._gl.uniform2iv(l,e),!0)}setIntArray3(l,e){return!l||e.length%3!==0?!1:(this._gl.uniform3iv(l,e),!0)}setIntArray4(l,e){return!l||e.length%4!==0?!1:(this._gl.uniform4iv(l,e),!0)}setUInt(l,e){return l?(this._gl.uniform1ui(l,e),!0):!1}setUInt2(l,e,t){return l?(this._gl.uniform2ui(l,e,t),!0):!1}setUInt3(l,e,t,a){return l?(this._gl.uniform3ui(l,e,t,a),!0):!1}setUInt4(l,e,t,a,s){return l?(this._gl.uniform4ui(l,e,t,a,s),!0):!1}setUIntArray(l,e){return l?(this._gl.uniform1uiv(l,e),!0):!1}setUIntArray2(l,e){return!l||e.length%2!==0?!1:(this._gl.uniform2uiv(l,e),!0)}setUIntArray3(l,e){return!l||e.length%3!==0?!1:(this._gl.uniform3uiv(l,e),!0)}setUIntArray4(l,e){return!l||e.length%4!==0?!1:(this._gl.uniform4uiv(l,e),!0)}setArray(l,e){return!l||e.length<1?!1:(this._gl.uniform1fv(l,e),!0)}setArray2(l,e){return!l||e.length%2!==0?!1:(this._gl.uniform2fv(l,e),!0)}setArray3(l,e){return!l||e.length%3!==0?!1:(this._gl.uniform3fv(l,e),!0)}setArray4(l,e){return!l||e.length%4!==0?!1:(this._gl.uniform4fv(l,e),!0)}setMatrices(l,e){return l?(this._gl.uniformMatrix4fv(l,!1,e),!0):!1}setMatrix3x3(l,e){return l?(this._gl.uniformMatrix3fv(l,!1,e),!0):!1}setMatrix2x2(l,e){return l?(this._gl.uniformMatrix2fv(l,!1,e),!0):!1}setFloat(l,e){return l?(this._gl.uniform1f(l,e),!0):!1}setFloat2(l,e,t){return l?(this._gl.uniform2f(l,e,t),!0):!1}setFloat3(l,e,t,a){return l?(this._gl.uniform3f(l,e,t,a),!0):!1}setFloat4(l,e,t,a,s){return l?(this._gl.uniform4f(l,e,t,a,s),!0):!1}applyStates(){if(this._depthCullingState.apply(this._gl),this._stencilStateComposer.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;const l=this._colorWrite;this._gl.colorMask(l,l,l,l)}}setColorWrite(l){l!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=l)}getColorWrite(){return this._colorWrite}get depthCullingState(){return this._depthCullingState}get alphaState(){return this._alphaState}get stencilState(){return this._stencilState}get stencilStateComposer(){return this._stencilStateComposer}clearInternalTexturesCache(){this._internalTexturesCache.length=0}wipeCaches(l){this.preventCacheWipeBetweenFrames&&!l||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),l&&(this._currentProgram=null,this.resetTextureCache(),this._stencilStateComposer.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=1,this._alphaEquation=0,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))}_getSamplingParameters(l,e){const t=this._gl;let a=t.NEAREST,s=t.NEAREST;switch(l){case 11:a=t.LINEAR,e?s=t.LINEAR_MIPMAP_NEAREST:s=t.LINEAR;break;case 3:a=t.LINEAR,e?s=t.LINEAR_MIPMAP_LINEAR:s=t.LINEAR;break;case 8:a=t.NEAREST,e?s=t.NEAREST_MIPMAP_LINEAR:s=t.NEAREST;break;case 4:a=t.NEAREST,e?s=t.NEAREST_MIPMAP_NEAREST:s=t.NEAREST;break;case 5:a=t.NEAREST,e?s=t.LINEAR_MIPMAP_NEAREST:s=t.LINEAR;break;case 6:a=t.NEAREST,e?s=t.LINEAR_MIPMAP_LINEAR:s=t.LINEAR;break;case 7:a=t.NEAREST,s=t.LINEAR;break;case 1:a=t.NEAREST,s=t.NEAREST;break;case 9:a=t.LINEAR,e?s=t.NEAREST_MIPMAP_NEAREST:s=t.NEAREST;break;case 10:a=t.LINEAR,e?s=t.NEAREST_MIPMAP_LINEAR:s=t.NEAREST;break;case 2:a=t.LINEAR,s=t.LINEAR;break;case 12:a=t.LINEAR,s=t.NEAREST;break}return{min:s,mag:a}}_createTexture(){const l=this._gl.createTexture();if(!l)throw new Error("Unable to create texture");return l}_createHardwareTexture(){return new bd(this._createTexture(),this._gl)}_createInternalTexture(l,e,t=!0,a=Cl.Unknown){var s;let d=!1,i=0,c=3,n=5,h=!1,m=1;e!==void 0&&typeof e=="object"?(d=!!e.generateMipMaps,i=e.type===void 0?0:e.type,c=e.samplingMode===void 0?3:e.samplingMode,n=e.format===void 0?5:e.format,h=e.useSRGBBuffer===void 0?!1:e.useSRGBBuffer,m=(s=e.samples)!==null&&s!==void 0?s:1):d=!!e,h&&(h=this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU)),(i===1&&!this._caps.textureFloatLinearFiltering||i===2&&!this._caps.textureHalfFloatLinearFiltering)&&(c=1),i===1&&!this._caps.textureFloat&&(i=0,M.Warn("Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE"));const o=this._gl,b=new Qe(this,a),u=l.width||l,V=l.height||l,G=l.layers||0,p=this._getSamplingParameters(c,d),y=G!==0?o.TEXTURE_2D_ARRAY:o.TEXTURE_2D,L=this._getRGBABufferInternalSizedFormat(i,n,h),N=this._getInternalFormat(n),J=this._getWebGLTextureType(i);return this._bindTextureDirectly(y,b),G!==0?(b.is2DArray=!0,o.texImage3D(y,0,L,u,V,G,0,N,J,null)):o.texImage2D(y,0,L,u,V,0,N,J,null),o.texParameteri(y,o.TEXTURE_MAG_FILTER,p.mag),o.texParameteri(y,o.TEXTURE_MIN_FILTER,p.min),o.texParameteri(y,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(y,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),d&&this._gl.generateMipmap(y),this._bindTextureDirectly(y,null),b._useSRGBBuffer=h,b.baseWidth=u,b.baseHeight=V,b.width=u,b.height=V,b.depth=G,b.isReady=!0,b.samples=m,b.generateMipMaps=d,b.samplingMode=c,b.type=i,b.format=n,this._internalTexturesCache.push(b),b}_getUseSRGBBuffer(l,e){return l&&this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU||e)}_createTextureBase(l,e,t,a,s=3,d=null,i=null,c,n,h=null,m=null,o=null,b=null,u,V,G){l=l||"";const p=l.substr(0,5)==="data:",y=l.substr(0,5)==="blob:",L=p&&l.indexOf(";base64,")!==-1,N=m||new Qe(this,Cl.Url),J=l;this._transformTextureUrl&&!L&&!m&&!h&&(l=this._transformTextureUrl(l)),J!==l&&(N._originalUrl=J);const R=l.lastIndexOf(".");let S=b||(R>-1?l.substring(R).toLowerCase():""),T=null;S.indexOf("?")>-1&&(S=S.split("?")[0]);for(const ll of Zl._TextureLoaders)if(ll.canLoad(S,u)){T=ll;break}a&&a.addPendingData(N),N.url=l,N.generateMipMaps=!e,N.samplingMode=s,N.invertY=t,N._useSRGBBuffer=this._getUseSRGBBuffer(!!G,e),this._doNotHandleContextLost||(N._buffer=h);let k=null;d&&!m&&(k=N.onLoadedObservable.add(d)),m||this._internalTexturesCache.push(N);const g=(ll,ol)=>{a&&a.removePendingData(N),l===J?(k&&N.onLoadedObservable.remove(k),bl.UseFallbackTexture&&this._createTextureBase(bl.FallbackTexture,e,N.invertY,a,s,null,i,c,n,h,N),ll=(ll||"Unknown error")+(bl.UseFallbackTexture?" - Fallback texture was used":""),N.onErrorObservable.notifyObservers({message:ll,exception:ol}),i&&i(ll,ol)):(M.Warn(`Failed to load ${l}, falling back to ${J}`),this._createTextureBase(J,e,N.invertY,a,s,d,i,c,n,h,N,o,b,u,V,G))};if(T){const ll=ol=>{T.loadData(ol,N,(ml,el,Jl,xl,zl,Hl)=>{Hl?g("TextureLoader failed to load data"):c(N,S,a,{width:ml,height:el},N.invertY,!Jl,xl,()=>(zl(),!1),s)},V)};h?h instanceof ArrayBuffer?ll(new Uint8Array(h)):ArrayBuffer.isView(h)?ll(h):i&&i("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(l,ol=>ll(new Uint8Array(ol)),void 0,a?a.offlineProvider:void 0,!0,(ol,ml)=>{g("Unable to load "+(ol&&ol.responseURL,ml))})}else{const ll=ol=>{y&&!this._doNotHandleContextLost&&(N._buffer=ol),c(N,S,a,ol,N.invertY,e,!1,n,s)};!p||L?h&&(typeof h.decoding=="string"||h.close)?ll(h):Zl._FileToolsLoadImage(l,ll,g,a?a.offlineProvider:null,u,N.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):typeof h=="string"||h instanceof ArrayBuffer||ArrayBuffer.isView(h)||h instanceof Blob?Zl._FileToolsLoadImage(h,ll,g,a?a.offlineProvider:null,u,N.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):h&&ll(h)}return N}createTexture(l,e,t,a,s=3,d=null,i=null,c=null,n=null,h=null,m=null,o,b,u,V){return this._createTextureBase(l,e,t,a,s,d,i,this._prepareWebGLTexture.bind(this),(G,p,y,L,N,J)=>{const R=this._gl,S=y.width===G&&y.height===p,T=h?this._getInternalFormat(h,N._useSRGBBuffer):L===".jpg"&&!N._useSRGBBuffer?R.RGB:N._useSRGBBuffer?R.SRGB8_ALPHA8:R.RGBA;let k=h?this._getInternalFormat(h):L===".jpg"&&!N._useSRGBBuffer?R.RGB:R.RGBA;if(N._useSRGBBuffer&&this.webGLVersion===1&&(k=T),S)return R.texImage2D(R.TEXTURE_2D,0,T,k,R.UNSIGNED_BYTE,y),!1;const g=this._caps.maxTextureSize;if(y.width>g||y.height>g||!this._supportsHardwareTextureRescaling)return this._prepareWorkingCanvas(),!this._workingCanvas||!this._workingContext||(this._workingCanvas.width=G,this._workingCanvas.height=p,this._workingContext.drawImage(y,0,0,y.width,y.height,0,0,G,p),R.texImage2D(R.TEXTURE_2D,0,T,k,R.UNSIGNED_BYTE,this._workingCanvas),N.width=G,N.height=p),!1;{const ll=new Qe(this,Cl.Temp);this._bindTextureDirectly(R.TEXTURE_2D,ll,!0),R.texImage2D(R.TEXTURE_2D,0,T,k,R.UNSIGNED_BYTE,y),this._rescaleTexture(ll,N,a,T,()=>{this._releaseTexture(ll),this._bindTextureDirectly(R.TEXTURE_2D,N,!0),J()})}return!0},c,n,h,m,o,b,V)}static _FileToolsLoadImage(l,e,t,a,s,d){throw O("FileTools")}_rescaleTexture(l,e,t,a,s){}createRawTexture(l,e,t,a,s,d,i,c=null,n=0,h=0,m=!1){throw O("Engine.RawTexture")}createRawCubeTexture(l,e,t,a,s,d,i,c=null){throw O("Engine.RawTexture")}createRawTexture3D(l,e,t,a,s,d,i,c,n=null,h=0){throw O("Engine.RawTexture")}createRawTexture2DArray(l,e,t,a,s,d,i,c,n=null,h=0){throw O("Engine.RawTexture")}_unpackFlipY(l){this._unpackFlipYCached!==l&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,l?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=l))}_getUnpackAlignement(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)}_getTextureTarget(l){return l.isCube?this._gl.TEXTURE_CUBE_MAP:l.is3D?this._gl.TEXTURE_3D:l.is2DArray||l.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D}updateTextureSamplingMode(l,e,t=!1){const a=this._getTextureTarget(e),s=this._getSamplingParameters(l,e.generateMipMaps||t);this._setTextureParameterInteger(a,this._gl.TEXTURE_MAG_FILTER,s.mag,e),this._setTextureParameterInteger(a,this._gl.TEXTURE_MIN_FILTER,s.min),t&&(e.generateMipMaps=!0,this._gl.generateMipmap(a)),this._bindTextureDirectly(a,null),e.samplingMode=l}updateTextureDimensions(l,e,t,a=1){}updateTextureWrappingMode(l,e,t=null,a=null){const s=this._getTextureTarget(l);e!==null&&(this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(e),l),l._cachedWrapU=e),t!==null&&(this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(t),l),l._cachedWrapV=t),(l.is2DArray||l.is3D)&&a!==null&&(this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(a),l),l._cachedWrapR=a),this._bindTextureDirectly(s,null)}_setupDepthStencilTexture(l,e,t,a,s,d=1){const i=e.width||e,c=e.height||e,n=e.layers||0;l.baseWidth=i,l.baseHeight=c,l.width=i,l.height=c,l.is2DArray=n>0,l.depth=n,l.isReady=!0,l.samples=d,l.generateMipMaps=!1,l.samplingMode=a?2:1,l.type=0,l._comparisonFunction=s;const h=this._gl,m=this._getTextureTarget(l),o=this._getSamplingParameters(l.samplingMode,!1);h.texParameteri(m,h.TEXTURE_MAG_FILTER,o.mag),h.texParameteri(m,h.TEXTURE_MIN_FILTER,o.min),h.texParameteri(m,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(m,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),this.webGLVersion>1&&(s===0?(h.texParameteri(m,h.TEXTURE_COMPARE_FUNC,515),h.texParameteri(m,h.TEXTURE_COMPARE_MODE,h.NONE)):(h.texParameteri(m,h.TEXTURE_COMPARE_FUNC,s),h.texParameteri(m,h.TEXTURE_COMPARE_MODE,h.COMPARE_REF_TO_TEXTURE)))}_uploadCompressedDataToTextureDirectly(l,e,t,a,s,d=0,i=0){const c=this._gl;let n=c.TEXTURE_2D;if(l.isCube&&(n=c.TEXTURE_CUBE_MAP_POSITIVE_X+d),l._useSRGBBuffer)switch(e){case 37492:case 36196:this._caps.etc2?e=c.COMPRESSED_SRGB8_ETC2:l._useSRGBBuffer=!1;break;case 37496:this._caps.etc2?e=c.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l._useSRGBBuffer=!1;break;case 36492:e=c.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;break;case 37808:e=c.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case 33776:this._caps.s3tc_srgb?e=c.COMPRESSED_SRGB_S3TC_DXT1_EXT:l._useSRGBBuffer=!1;break;case 33777:this._caps.s3tc_srgb?e=c.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:l._useSRGBBuffer=!1;break;case 33779:this._caps.s3tc_srgb?e=c.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:l._useSRGBBuffer=!1;break;default:l._useSRGBBuffer=!1;break}this._gl.compressedTexImage2D(n,i,e,t,a,0,s)}_uploadDataToTextureDirectly(l,e,t=0,a=0,s,d=!1){const i=this._gl,c=this._getWebGLTextureType(l.type),n=this._getInternalFormat(l.format),h=s===void 0?this._getRGBABufferInternalSizedFormat(l.type,l.format,l._useSRGBBuffer):this._getInternalFormat(s,l._useSRGBBuffer);this._unpackFlipY(l.invertY);let m=i.TEXTURE_2D;l.isCube&&(m=i.TEXTURE_CUBE_MAP_POSITIVE_X+t);const o=Math.round(Math.log(l.width)*Math.LOG2E),b=Math.round(Math.log(l.height)*Math.LOG2E),u=d?l.width:Math.pow(2,Math.max(o-a,0)),V=d?l.height:Math.pow(2,Math.max(b-a,0));i.texImage2D(m,a,h,u,V,0,n,c,e)}updateTextureData(l,e,t,a,s,d,i=0,c=0,n=!1){const h=this._gl,m=this._getWebGLTextureType(l.type),o=this._getInternalFormat(l.format);this._unpackFlipY(l.invertY);let b=h.TEXTURE_2D,u=h.TEXTURE_2D;l.isCube&&(u=h.TEXTURE_CUBE_MAP_POSITIVE_X+i,b=h.TEXTURE_CUBE_MAP),this._bindTextureDirectly(b,l,!0),h.texSubImage2D(u,c,t,a,s,d,o,m,e),n&&this._gl.generateMipmap(u),this._bindTextureDirectly(b,null)}_uploadArrayBufferViewToTexture(l,e,t=0,a=0){const s=this._gl,d=l.isCube?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D;this._bindTextureDirectly(d,l,!0),this._uploadDataToTextureDirectly(l,e,t,a),this._bindTextureDirectly(d,null,!0)}_prepareWebGLTextureContinuation(l,e,t,a,s){const d=this._gl;if(!d)return;const i=this._getSamplingParameters(s,!t);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,i.mag),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,i.min),!t&&!a&&d.generateMipmap(d.TEXTURE_2D),this._bindTextureDirectly(d.TEXTURE_2D,null),e&&e.removePendingData(l),l.onLoadedObservable.notifyObservers(l),l.onLoadedObservable.clear()}_prepareWebGLTexture(l,e,t,a,s,d,i,c,n=3){const h=this.getCaps().maxTextureSize,m=Math.min(h,this.needPOTTextures?Zl.GetExponentOfTwo(a.width,h):a.width),o=Math.min(h,this.needPOTTextures?Zl.GetExponentOfTwo(a.height,h):a.height),b=this._gl;if(b){if(!l._hardwareTexture){t&&t.removePendingData(l);return}this._bindTextureDirectly(b.TEXTURE_2D,l,!0),this._unpackFlipY(s===void 0?!0:!!s),l.baseWidth=a.width,l.baseHeight=a.height,l.width=m,l.height=o,l.isReady=!0,!c(m,o,a,e,l,()=>{this._prepareWebGLTextureContinuation(l,t,d,i,n)})&&this._prepareWebGLTextureContinuation(l,t,d,i,n)}}_setupFramebufferDepthAttachments(l,e,t,a,s=1){const d=this._gl;if(l&&e)return this._createRenderBuffer(t,a,s,d.DEPTH_STENCIL,d.DEPTH24_STENCIL8,d.DEPTH_STENCIL_ATTACHMENT);if(e){let i=d.DEPTH_COMPONENT16;return this._webGLVersion>1&&(i=d.DEPTH_COMPONENT32F),this._createRenderBuffer(t,a,s,i,i,d.DEPTH_ATTACHMENT)}return l?this._createRenderBuffer(t,a,s,d.STENCIL_INDEX8,d.STENCIL_INDEX8,d.STENCIL_ATTACHMENT):null}_createRenderBuffer(l,e,t,a,s,d,i=!0){const c=this._gl.createRenderbuffer();return this._updateRenderBuffer(c,l,e,t,a,s,d,i)}_updateRenderBuffer(l,e,t,a,s,d,i,c=!0){const n=this._gl;return n.bindRenderbuffer(n.RENDERBUFFER,l),a>1&&n.renderbufferStorageMultisample?n.renderbufferStorageMultisample(n.RENDERBUFFER,a,d,e,t):n.renderbufferStorage(n.RENDERBUFFER,s,e,t),n.framebufferRenderbuffer(n.FRAMEBUFFER,i,n.RENDERBUFFER,l),c&&n.bindRenderbuffer(n.RENDERBUFFER,null),l}_releaseTexture(l){var e;this._deleteTexture((e=l._hardwareTexture)===null||e===void 0?void 0:e.underlyingResource),this.unbindAllTextures();const t=this._internalTexturesCache.indexOf(l);t!==-1&&this._internalTexturesCache.splice(t,1),l._lodTextureHigh&&l._lodTextureHigh.dispose(),l._lodTextureMid&&l._lodTextureMid.dispose(),l._lodTextureLow&&l._lodTextureLow.dispose(),l._irradianceTexture&&l._irradianceTexture.dispose()}_releaseRenderTargetWrapper(l){const e=this._renderTargetWrapperCache.indexOf(l);e!==-1&&this._renderTargetWrapperCache.splice(e,1)}_deleteTexture(l){l&&this._gl.deleteTexture(l)}_setProgram(l){this._currentProgram!==l&&(this._gl.useProgram(l),this._currentProgram=l)}bindSamplers(l){const e=l.getPipelineContext();this._setProgram(e.program);const t=l.getSamplers();for(let a=0;a<t.length;a++){const s=l.getUniform(t[a]);s&&(this._boundUniforms[a]=s)}this._currentEffect=null}_activateCurrentTexture(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)}_bindTextureDirectly(l,e,t=!1,a=!1){var s,d;let i=!1;const c=e&&e._associatedChannel>-1;if(t&&c&&(this._activeChannel=e._associatedChannel),this._boundTexturesCache[this._activeChannel]!==e||a){if(this._activateCurrentTexture(),e&&e.isMultiview)throw console.error(l,e),"_bindTextureDirectly called with a multiview texture!";this._gl.bindTexture(l,(d=(s=e==null?void 0:e._hardwareTexture)===null||s===void 0?void 0:s.underlyingResource)!==null&&d!==void 0?d:null),this._boundTexturesCache[this._activeChannel]=e,e&&(e._associatedChannel=this._activeChannel)}else t&&(i=!0,this._activateCurrentTexture());return c&&!t&&this._bindSamplerUniformToChannel(e._associatedChannel,this._activeChannel),i}_bindTexture(l,e,t){if(l===void 0)return;e&&(e._associatedChannel=l),this._activeChannel=l;const a=e?this._getTextureTarget(e):this._gl.TEXTURE_2D;this._bindTextureDirectly(a,e)}unbindAllTextures(){for(let l=0;l<this._maxSimultaneousTextures;l++)this._activeChannel=l,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))}setTexture(l,e,t,a){l!==void 0&&(e&&(this._boundUniforms[l]=e),this._setTexture(l,t))}_bindSamplerUniformToChannel(l,e){const t=this._boundUniforms[l];!t||t._currentState===e||(this._gl.uniform1i(t,e),t._currentState=e)}_getTextureWrapMode(l){switch(l){case 1:return this._gl.REPEAT;case 0:return this._gl.CLAMP_TO_EDGE;case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT}_setTexture(l,e,t=!1,a=!1,s=""){if(!e)return this._boundTexturesCache[l]!=null&&(this._activeChannel=l,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(e.video)this._activeChannel=l,e.update();else if(e.delayLoadState===4)return e.delayLoad(),!1;let d;a?d=e.depthStencilTexture:e.isReady()?d=e.getInternalTexture():e.isCube?d=this.emptyCubeTexture:e.is3D?d=this.emptyTexture3D:e.is2DArray?d=this.emptyTexture2DArray:d=this.emptyTexture,!t&&d&&(d._associatedChannel=l);let i=!0;this._boundTexturesCache[l]===d&&(t||this._bindSamplerUniformToChannel(d._associatedChannel,l),i=!1),this._activeChannel=l;const c=this._getTextureTarget(d);if(i&&this._bindTextureDirectly(c,d,t),d&&!d.isMultiview){if(d.isCube&&d._cachedCoordinatesMode!==e.coordinatesMode){d._cachedCoordinatesMode=e.coordinatesMode;const n=e.coordinatesMode!==3&&e.coordinatesMode!==5?1:0;e.wrapU=n,e.wrapV=n}d._cachedWrapU!==e.wrapU&&(d._cachedWrapU=e.wrapU,this._setTextureParameterInteger(c,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(e.wrapU),d)),d._cachedWrapV!==e.wrapV&&(d._cachedWrapV=e.wrapV,this._setTextureParameterInteger(c,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(e.wrapV),d)),d.is3D&&d._cachedWrapR!==e.wrapR&&(d._cachedWrapR=e.wrapR,this._setTextureParameterInteger(c,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(e.wrapR),d)),this._setAnisotropicLevel(c,d,e.anisotropicFilteringLevel)}return!0}setTextureArray(l,e,t,a){if(!(l===void 0||!e)){(!this._textureUnits||this._textureUnits.length!==t.length)&&(this._textureUnits=new Int32Array(t.length));for(let s=0;s<t.length;s++){const d=t[s].getInternalTexture();d?(this._textureUnits[s]=l+s,d._associatedChannel=l+s):this._textureUnits[s]=-1}this._gl.uniform1iv(e,this._textureUnits);for(let s=0;s<t.length;s++)this._setTexture(this._textureUnits[s],t[s],!0)}}_setAnisotropicLevel(l,e,t){const a=this._caps.textureAnisotropicFilterExtension;e.samplingMode!==11&&e.samplingMode!==3&&e.samplingMode!==2&&(t=1),a&&e._cachedAnisotropicFilteringLevel!==t&&(this._setTextureParameterFloat(l,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t,this._caps.maxAnisotropy),e),e._cachedAnisotropicFilteringLevel=t)}_setTextureParameterFloat(l,e,t,a){this._bindTextureDirectly(l,a,!0,!0),this._gl.texParameterf(l,e,t)}_setTextureParameterInteger(l,e,t,a){a&&this._bindTextureDirectly(l,a,!0,!0),this._gl.texParameteri(l,e,t)}unbindAllAttributes(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(let l=0;l<this._caps.maxVertexAttribs;l++)this.disableAttributeByIndex(l);return}for(let l=0,e=this._vertexAttribArraysEnabled.length;l<e;l++)l>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[l]||this.disableAttributeByIndex(l)}releaseEffects(){for(const l in this._compiledEffects){const e=this._compiledEffects[l].getPipelineContext();this._deletePipelineContext(e)}this._compiledEffects={}}dispose(){var l;this.stopRenderLoop(),this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer),this.releaseEffects(),(l=this.releaseComputeEffects)===null||l===void 0||l.call(this),this.unbindAllAttributes(),this._boundUniforms={},jl()&&this._renderingCanvas&&(this._doNotHandleContextLost||(this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored)),window.removeEventListener("resize",this._checkForMobile)),this._workingCanvas=null,this._workingContext=null,this._currentBufferPointers.length=0,this._renderingCanvas=null,this._currentProgram=null,this._boundRenderFunction=null,Tl.ResetCache();for(const e of this._activeRequests)e.abort();this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()}attachContextLostEvent(l){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",l,!1)}attachContextRestoredEvent(l){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",l,!1)}getError(){return this._gl.getError()}_canRenderToFloatFramebuffer(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)}_canRenderToHalfFloatFramebuffer(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)}_canRenderToFramebuffer(l){const e=this._gl;for(;e.getError()!==e.NO_ERROR;);let t=!0;const a=e.createTexture();e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(l),1,1,0,e.RGBA,this._getWebGLTextureType(l),null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);const s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0);const d=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t=t&&d===e.FRAMEBUFFER_COMPLETE,t=t&&e.getError()===e.NO_ERROR,t&&(e.clear(e.COLOR_BUFFER_BIT),t=t&&e.getError()===e.NO_ERROR),t){e.bindFramebuffer(e.FRAMEBUFFER,null);const i=e.RGBA,c=e.UNSIGNED_BYTE,n=new Uint8Array(4);e.readPixels(0,0,1,1,i,c,n),t=t&&e.getError()===e.NO_ERROR}for(e.deleteTexture(a),e.deleteFramebuffer(s),e.bindFramebuffer(e.FRAMEBUFFER,null);!t&&e.getError()!==e.NO_ERROR;);return t}_getWebGLTextureType(l){if(this._webGLVersion===1){switch(l){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;case 0:return this._gl.UNSIGNED_BYTE;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(l){case 3:return this._gl.BYTE;case 0:return this._gl.UNSIGNED_BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE}_getInternalFormat(l,e=!1){let t=e?this._gl.SRGB8_ALPHA8:this._gl.RGBA;switch(l){case 0:t=this._gl.ALPHA;break;case 1:t=this._gl.LUMINANCE;break;case 2:t=this._gl.LUMINANCE_ALPHA;break;case 6:t=this._gl.RED;break;case 7:t=this._gl.RG;break;case 4:t=e?this._gl.SRGB:this._gl.RGB;break;case 5:t=e?this._gl.SRGB8_ALPHA8:this._gl.RGBA;break}if(this._webGLVersion>1)switch(l){case 8:t=this._gl.RED_INTEGER;break;case 9:t=this._gl.RG_INTEGER;break;case 10:t=this._gl.RGB_INTEGER;break;case 11:t=this._gl.RGBA_INTEGER;break}return t}_getRGBABufferInternalSizedFormat(l,e,t=!1){if(this._webGLVersion===1){if(e!==void 0)switch(e){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return t?this._gl.SRGB:this._gl.RGB}return this._gl.RGBA}switch(l){case 3:switch(e){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(e){case 6:return this._gl.R8;case 7:return this._gl.RG8;case 4:return t?this._gl.SRGB8:this._gl.RGB8;case 5:return t?this._gl.SRGB8_ALPHA8:this._gl.RGBA8;case 8:return this._gl.R8UI;case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(e){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;case 11:return this._gl.RGBA16I;default:return this._gl.RGBA16I}case 5:switch(e){case 8:return this._gl.R16UI;case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;case 11:return this._gl.RGBA16UI;default:return this._gl.RGBA16UI}case 6:switch(e){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;case 11:return this._gl.RGBA32I;default:return this._gl.RGBA32I}case 7:switch(e){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;case 11:return this._gl.RGBA32UI;default:return this._gl.RGBA32UI}case 1:switch(e){case 6:return this._gl.R32F;case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;case 5:return this._gl.RGBA32F;default:return this._gl.RGBA32F}case 2:switch(e){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;case 5:return this._gl.RGBA16F;default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:switch(e){case 5:return this._gl.RGB10_A2;case 11:return this._gl.RGB10_A2UI;default:return this._gl.RGB10_A2}}return t?this._gl.SRGB8_ALPHA8:this._gl.RGBA8}_getRGBAMultiSampleBufferFormat(l){return l===1?this._gl.RGBA32F:l===2?this._gl.RGBA16F:this._gl.RGBA8}_loadFile(l,e,t,a,s,d){const i=Zl._FileToolsLoadFile(l,e,t,a,s,d);return this._activeRequests.push(i),i.onCompleteObservable.add(c=>{this._activeRequests.splice(this._activeRequests.indexOf(c),1)}),i}static _FileToolsLoadFile(l,e,t,a,s,d){throw O("FileTools")}readPixels(l,e,t,a,s=!0,d=!0){const i=s?4:3,c=s?this._gl.RGBA:this._gl.RGB,n=new Uint8Array(a*t*i);return d&&this.flushFramebuffer(),this._gl.readPixels(l,e,t,a,c,this._gl.UNSIGNED_BYTE,n),Promise.resolve(n)}static get IsSupportedAsync(){return Promise.resolve(this.isSupported())}static get IsSupported(){return this.isSupported()}static isSupported(){if(this._HasMajorPerformanceCaveat!==null)return!this._HasMajorPerformanceCaveat;if(this._IsSupported===null)try{const l=this._CreateCanvas(1,1),e=l.getContext("webgl")||l.getContext("experimental-webgl");this._IsSupported=e!=null&&!!window.WebGLRenderingContext}catch{this._IsSupported=!1}return this._IsSupported}static get HasMajorPerformanceCaveat(){if(this._HasMajorPerformanceCaveat===null)try{const l=this._CreateCanvas(1,1),e=l.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||l.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!e}catch{this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat}static CeilingPOT(l){return l--,l|=l>>1,l|=l>>2,l|=l>>4,l|=l>>8,l|=l>>16,l++,l}static FloorPOT(l){return l=l|l>>1,l=l|l>>2,l=l|l>>4,l=l|l>>8,l=l|l>>16,l-(l>>1)}static NearestPOT(l){const e=Zl.CeilingPOT(l),t=Zl.FloorPOT(l);return e-l>l-t?t:e}static GetExponentOfTwo(l,e,t=2){let a;switch(t){case 1:a=Zl.FloorPOT(l);break;case 2:a=Zl.NearestPOT(l);break;case 3:default:a=Zl.CeilingPOT(l);break}return Math.min(a,e)}static QueueNewFrame(l,e){if(jl()){const{requestPostAnimationFrame:t,requestAnimationFrame:a}=e||window;if(typeof t=="function")return t(l);if(typeof a=="function")return a(l)}else if(typeof requestAnimationFrame=="function")return requestAnimationFrame(l);return setTimeout(l,16)}getHostDocument(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:Qt()?document:null}}Zl.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:".*AppleWebKit.*(15.4).*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]},{key:".*(15.4).*AppleWebKit.*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]}];Zl._TextureLoaders=[];Zl.CollisionsEpsilon=.001;Zl._IsSupported=null;Zl._HasMajorPerformanceCaveat=null;class Wi{constructor(l=30){this._enabled=!0,this._rollingFrameTime=new pi(l)}sampleFrame(l=bt.Now){if(this._enabled){if(this._lastFrameTimeMs!=null){const e=l-this._lastFrameTimeMs;this._rollingFrameTime.add(e)}this._lastFrameTimeMs=l}}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){const l=this._rollingFrameTime.history(0);return l===0?0:1e3/l}get isSaturated(){return this._rollingFrameTime.isSaturated()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}get isEnabled(){return this._enabled}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class pi{constructor(l){this._samples=new Array(l),this.reset()}add(l){let e;if(this.isSaturated()){const t=this._samples[this._pos];e=t-this.average,this.average-=e/(this._sampleCount-1),this._m2-=e*(t-this.average)}else this._sampleCount++;e=l-this.average,this.average+=e/this._sampleCount,this._m2+=e*(l-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=l,this._pos++,this._pos%=this._samples.length}history(l){if(l>=this._sampleCount||l>=this._samples.length)return 0;const e=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(e-l)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(l){const e=this._samples.length;return(l%e+e)%e}}class fe{constructor(){this._startMonitoringTime=0,this._min=0,this._max=0,this._average=0,this._lastSecAverage=0,this._current=0,this._totalValueCount=0,this._totalAccumulated=0,this._lastSecAccumulated=0,this._lastSecTime=0,this._lastSecValueCount=0}get min(){return this._min}get max(){return this._max}get average(){return this._average}get lastSecAverage(){return this._lastSecAverage}get current(){return this._current}get total(){return this._totalAccumulated}get count(){return this._totalValueCount}fetchNewFrame(){this._totalValueCount++,this._current=0,this._lastSecValueCount++}addCount(l,e){fe.Enabled&&(this._current+=l,e&&this._fetchResult())}beginMonitoring(){fe.Enabled&&(this._startMonitoringTime=bt.Now)}endMonitoring(l=!0){if(!fe.Enabled)return;l&&this.fetchNewFrame();const e=bt.Now;this._current=e-this._startMonitoringTime,l&&this._fetchResult()}_fetchResult(){this._totalAccumulated+=this._current,this._lastSecAccumulated+=this._current,this._min=Math.min(this._min,this._current),this._max=Math.max(this._max,this._current),this._average=this._totalAccumulated/this._totalValueCount;const l=bt.Now;l-this._lastSecTime>1e3&&(this._lastSecAverage=this._lastSecAccumulated/this._lastSecValueCount,this._lastSecTime=l,this._lastSecAccumulated=0,this._lastSecValueCount=0)}}fe.Enabled=!0;Zl.prototype.setAlphaConstants=function(Z,l,e,t){this._alphaState.setAlphaBlendConstants(Z,l,e,t)};Zl.prototype.setAlphaMode=function(Z,l=!1){if(this._alphaMode!==Z){switch(Z){case 0:this._alphaState.alphaBlend=!1;break;case 7:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 8:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 2:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 6:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 1:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 3:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 4:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 5:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 9:this._alphaState.setAlphaBlendFunctionParameters(this._gl.CONSTANT_COLOR,this._gl.ONE_MINUS_CONSTANT_COLOR,this._gl.CONSTANT_ALPHA,this._gl.ONE_MINUS_CONSTANT_ALPHA),this._alphaState.alphaBlend=!0;break;case 10:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 11:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 12:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 13:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE_MINUS_DST_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 14:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 15:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 16:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 17:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break}l||(this.depthCullingState.depthMask=Z===0),this._alphaMode=Z}};Zl.prototype.getAlphaMode=function(){return this._alphaMode};Zl.prototype.setAlphaEquation=function(Z){if(this._alphaEquation!==Z){switch(Z){case 0:this._alphaState.setAlphaEquationParameters(32774,32774);break;case 1:this._alphaState.setAlphaEquationParameters(32778,32778);break;case 2:this._alphaState.setAlphaEquationParameters(32779,32779);break;case 3:this._alphaState.setAlphaEquationParameters(32776,32776);break;case 4:this._alphaState.setAlphaEquationParameters(32775,32775);break;case 5:this._alphaState.setAlphaEquationParameters(32775,32774);break}this._alphaEquation=Z}};Zl.prototype.getAlphaEquation=function(){return this._alphaEquation};function yi(Z,l,e=!1,t){switch(Z){case 3:{const s=l instanceof ArrayBuffer?new Int8Array(l):new Int8Array(l);return t&&s.set(new Int8Array(t)),s}case 0:{const s=l instanceof ArrayBuffer?new Uint8Array(l):new Uint8Array(l);return t&&s.set(new Uint8Array(t)),s}case 4:{const s=l instanceof ArrayBuffer?new Int16Array(l):new Int16Array(e?l/2:l);return t&&s.set(new Int16Array(t)),s}case 5:case 8:case 9:case 10:case 2:{const s=l instanceof ArrayBuffer?new Uint16Array(l):new Uint16Array(e?l/2:l);return t&&s.set(new Uint16Array(t)),s}case 6:{const s=l instanceof ArrayBuffer?new Int32Array(l):new Int32Array(e?l/4:l);return t&&s.set(new Int32Array(t)),s}case 7:case 11:case 12:case 13:case 14:case 15:{const s=l instanceof ArrayBuffer?new Uint32Array(l):new Uint32Array(e?l/4:l);return t&&s.set(new Uint32Array(t)),s}case 1:{const s=l instanceof ArrayBuffer?new Float32Array(l):new Float32Array(e?l/4:l);return t&&s.set(new Float32Array(t)),s}}const a=l instanceof ArrayBuffer?new Uint8Array(l):new Uint8Array(l);return t&&a.set(new Uint8Array(t)),a}Zl.prototype._readTexturePixelsSync=function(Z,l,e,t=-1,a=0,s=null,d=!0,i=!1,c=0,n=0){var h,m;const o=this._gl;if(!o)throw new Error("Engine does not have gl rendering context.");if(!this._dummyFramebuffer){const u=o.createFramebuffer();if(!u)throw new Error("Unable to create dummy framebuffer");this._dummyFramebuffer=u}o.bindFramebuffer(o.FRAMEBUFFER,this._dummyFramebuffer),t>-1?o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+t,(h=Z._hardwareTexture)===null||h===void 0?void 0:h.underlyingResource,a):o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,(m=Z._hardwareTexture)===null||m===void 0?void 0:m.underlyingResource,a);let b=Z.type!==void 0?this._getWebGLTextureType(Z.type):o.UNSIGNED_BYTE;if(i)s||(s=yi(Z.type,4*l*e));else switch(b){case o.UNSIGNED_BYTE:s||(s=new Uint8Array(4*l*e)),b=o.UNSIGNED_BYTE;break;default:s||(s=new Float32Array(4*l*e)),b=o.FLOAT;break}return d&&this.flushFramebuffer(),o.readPixels(c,n,l,e,o.RGBA,b,s),o.bindFramebuffer(o.FRAMEBUFFER,this._currentFramebuffer),s};Zl.prototype._readTexturePixels=function(Z,l,e,t=-1,a=0,s=null,d=!0,i=!1,c=0,n=0){return Promise.resolve(this._readTexturePixelsSync(Z,l,e,t,a,s,d,i,c,n))};Zl.prototype.updateDynamicIndexBuffer=function(Z,l,e=0){this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null,this.bindIndexBuffer(Z);let t;Z.is32Bits?t=l instanceof Uint32Array?l:new Uint32Array(l):t=l instanceof Uint16Array?l:new Uint16Array(l),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,t,this._gl.DYNAMIC_DRAW),this._resetIndexBufferBinding()};Zl.prototype.updateDynamicVertexBuffer=function(Z,l,e,t){this.bindArrayBuffer(Z),e===void 0&&(e=0);const a=l.byteLength||l.length;t===void 0||t>=a&&e===0?l instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,e,new Float32Array(l)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,e,l):l instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(l).subarray(e,e+t)):(l instanceof ArrayBuffer?l=new Uint8Array(l,e,t):l=new Uint8Array(l.buffer,l.byteOffset+e,t),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,l)),this._resetVertexBufferBinding()};class x extends Zl{constructor(l,e,t,a=!1){if(super(l,e,t,a),this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.scenes=new Array,this._virtualScenes=new Array,this.onNewSceneAddedObservable=new z,this.postProcesses=new Array,this.isPointerLock=!1,this.onResizeObservable=new z,this.onCanvasBlurObservable=new z,this.onCanvasFocusObservable=new z,this.onCanvasPointerOutObservable=new z,this.onBeginFrameObservable=new z,this.customAnimationFrameRequester=null,this.onEndFrameObservable=new z,this.onBeforeShaderCompilationObservable=new z,this.onAfterShaderCompilationObservable=new z,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this._fps=60,this._deltaTime=0,this._drawCalls=new fe,this.canvasTabIndex=1,this.disablePerformanceMonitorInBackground=!1,this._performanceMonitor=new Wi,this._compatibilityMode=!0,this.currentRenderPassId=0,this._renderPassNames=["main"],x.Instances.push(this),!!l){if(this._features.supportRenderPasses=!0,t=this._creationOptions,l.getContext){const s=l;this._sharedInit(s,!!t.doNotHandleTouchAction,t.audioEngine),Qt()&&(this._onFullscreenChange=()=>{this.isFullscreen=!!document.fullscreenElement,this.isFullscreen&&this._pointerLockRequested&&s&&x._RequestPointerlock(s)},document.addEventListener("fullscreenchange",this._onFullscreenChange,!1),document.addEventListener("webkitfullscreenchange",this._onFullscreenChange,!1),this._onPointerLockChange=()=>{this.isPointerLock=document.pointerLockElement===s},document.addEventListener("pointerlockchange",this._onPointerLockChange,!1),document.addEventListener("webkitpointerlockchange",this._onPointerLockChange,!1),!x.audioEngine&&t.audioEngine&&x.AudioEngineFactory&&(x.audioEngine=x.AudioEngineFactory(this.getRenderingCanvas(),this.getAudioContext(),this.getAudioDestination()))),this._connectVREvents(),this.enableOfflineSupport=x.OfflineProviderFactory!==void 0,this._deterministicLockstep=!!t.deterministicLockstep,this._lockstepMaxSteps=t.lockstepMaxSteps||0,this._timeStep=t.timeStep||1/60}this._prepareVRComponent(),t.autoEnableWebVR&&this.initWebVR()}}static get NpmPackage(){return Zl.NpmPackage}static get Version(){return Zl.Version}static get Instances(){return bl.Instances}static get LastCreatedEngine(){return bl.LastCreatedEngine}static get LastCreatedScene(){return bl.LastCreatedScene}_createImageBitmapFromSource(l,e){return new Promise((t,a)=>{const s=new Image;s.onload=()=>{s.decode().then(()=>{this.createImageBitmap(s,e).then(d=>{t(d)})})},s.onerror=()=>{a(`Error loading image ${s.src}`)},s.src=l})}createImageBitmap(l,e){return createImageBitmap(l,e)}resizeImageBitmap(l,e,t){const a=this.createCanvas(e,t).getContext("2d");if(!a)throw new Error("Unable to get 2d context for resizeImageBitmap");return a.drawImage(l,0,0),a.getImageData(0,0,e,t).data}static MarkAllMaterialsAsDirty(l,e){for(let t=0;t<x.Instances.length;t++){const a=x.Instances[t];for(let s=0;s<a.scenes.length;s++)a.scenes[s].markAllMaterialsAsDirty(l,e)}}static DefaultLoadingScreenFactory(l){throw O("LoadingScreen")}get _supportsHardwareTextureRescaling(){return!!x._RescalePostProcessFactory}get performanceMonitor(){return this._performanceMonitor}get compatibilityMode(){return this._compatibilityMode}set compatibilityMode(l){this._compatibilityMode=!0}getInputElement(){return this._renderingCanvas}_initGLContext(){super._initGLContext(),this._rescalePostProcess=null}_sharedInit(l,e,t){super._sharedInit(l,e,t),this._onCanvasFocus=()=>{this.onCanvasFocusObservable.notifyObservers(this)},this._onCanvasBlur=()=>{this.onCanvasBlurObservable.notifyObservers(this)},this._onCanvasContextMenu=s=>{this.disableContextMenu&&s.preventDefault()},l.addEventListener("focus",this._onCanvasFocus),l.addEventListener("blur",this._onCanvasBlur),l.addEventListener("contextmenu",this._onCanvasContextMenu),this._onBlur=()=>{this.disablePerformanceMonitorInBackground&&this._performanceMonitor.disable(),this._windowIsBackground=!0},this._onFocus=()=>{this.disablePerformanceMonitorInBackground&&this._performanceMonitor.enable(),this._windowIsBackground=!1},this._onCanvasPointerOut=s=>{document.elementFromPoint(s.clientX,s.clientY)!==l&&this.onCanvasPointerOutObservable.notifyObservers(s)};const a=this.getHostWindow();a&&typeof a.addEventListener=="function"&&(a.addEventListener("blur",this._onBlur),a.addEventListener("focus",this._onFocus)),l.addEventListener("pointerout",this._onCanvasPointerOut),e||this._disableTouchAction(),!x.audioEngine&&t&&x.AudioEngineFactory&&(x.audioEngine=x.AudioEngineFactory(this.getRenderingCanvas(),this.getAudioContext(),this.getAudioDestination()))}getAspectRatio(l,e=!1){const t=l.viewport;return this.getRenderWidth(e)*t.width/(this.getRenderHeight(e)*t.height)}getScreenAspectRatio(){return this.getRenderWidth(!0)/this.getRenderHeight(!0)}getRenderingCanvasClientRect(){return this._renderingCanvas?this._renderingCanvas.getBoundingClientRect():null}getInputElementClientRect(){return this._renderingCanvas?this.getInputElement().getBoundingClientRect():null}isDeterministicLockStep(){return this._deterministicLockstep}getLockstepMaxSteps(){return this._lockstepMaxSteps}getTimeStep(){return this._timeStep*1e3}generateMipMapsForCubemap(l,e=!0){if(l.generateMipMaps){const t=this._gl;this._bindTextureDirectly(t.TEXTURE_CUBE_MAP,l,!0),t.generateMipmap(t.TEXTURE_CUBE_MAP),e&&this._bindTextureDirectly(t.TEXTURE_CUBE_MAP,null)}}getDepthWrite(){return this._depthCullingState.depthMask}setDepthWrite(l){this._depthCullingState.depthMask=l}getStencilBuffer(){return this._stencilState.stencilTest}setStencilBuffer(l){this._stencilState.stencilTest=l}getStencilMask(){return this._stencilState.stencilMask}setStencilMask(l){this._stencilState.stencilMask=l}getStencilFunction(){return this._stencilState.stencilFunc}getStencilFunctionReference(){return this._stencilState.stencilFuncRef}getStencilFunctionMask(){return this._stencilState.stencilFuncMask}setStencilFunction(l){this._stencilState.stencilFunc=l}setStencilFunctionReference(l){this._stencilState.stencilFuncRef=l}setStencilFunctionMask(l){this._stencilState.stencilFuncMask=l}getStencilOperationFail(){return this._stencilState.stencilOpStencilFail}getStencilOperationDepthFail(){return this._stencilState.stencilOpDepthFail}getStencilOperationPass(){return this._stencilState.stencilOpStencilDepthPass}setStencilOperationFail(l){this._stencilState.stencilOpStencilFail=l}setStencilOperationDepthFail(l){this._stencilState.stencilOpDepthFail=l}setStencilOperationPass(l){this._stencilState.stencilOpStencilDepthPass=l}setDitheringState(l){l?this._gl.enable(this._gl.DITHER):this._gl.disable(this._gl.DITHER)}setRasterizerState(l){l?this._gl.disable(this._gl.RASTERIZER_DISCARD):this._gl.enable(this._gl.RASTERIZER_DISCARD)}getDepthFunction(){return this._depthCullingState.depthFunc}setDepthFunction(l){this._depthCullingState.depthFunc=l}setDepthFunctionToGreater(){this.setDepthFunction(516)}setDepthFunctionToGreaterOrEqual(){this.setDepthFunction(518)}setDepthFunctionToLess(){this.setDepthFunction(513)}setDepthFunctionToLessOrEqual(){this.setDepthFunction(515)}cacheStencilState(){this._cachedStencilBuffer=this.getStencilBuffer(),this._cachedStencilFunction=this.getStencilFunction(),this._cachedStencilMask=this.getStencilMask(),this._cachedStencilOperationPass=this.getStencilOperationPass(),this._cachedStencilOperationFail=this.getStencilOperationFail(),this._cachedStencilOperationDepthFail=this.getStencilOperationDepthFail(),this._cachedStencilReference=this.getStencilFunctionReference()}restoreStencilState(){this.setStencilFunction(this._cachedStencilFunction),this.setStencilMask(this._cachedStencilMask),this.setStencilBuffer(this._cachedStencilBuffer),this.setStencilOperationPass(this._cachedStencilOperationPass),this.setStencilOperationFail(this._cachedStencilOperationFail),this.setStencilOperationDepthFail(this._cachedStencilOperationDepthFail),this.setStencilFunctionReference(this._cachedStencilReference)}setDirectViewport(l,e,t,a){const s=this._cachedViewport;return this._cachedViewport=null,this._viewport(l,e,t,a),s}scissorClear(l,e,t,a,s){this.enableScissor(l,e,t,a),this.clear(s,!0,!0,!0),this.disableScissor()}enableScissor(l,e,t,a){const s=this._gl;s.enable(s.SCISSOR_TEST),s.scissor(l,e,t,a)}disableScissor(){const l=this._gl;l.disable(l.SCISSOR_TEST)}_reportDrawCall(l=1){this._drawCalls.addCount(l,!1)}initWebVR(){throw O("WebVRCamera")}_prepareVRComponent(){}_connectVREvents(l,e){}_submitVRFrame(){}disableVR(){}isVRPresenting(){return!1}_requestVRFrame(){}_loadFileAsync(l,e,t){return new Promise((a,s)=>{this._loadFile(l,d=>{a(d)},void 0,e,t,(d,i)=>{s(i)})})}getVertexShaderSource(l){const e=this._gl.getAttachedShaders(l);return e?this._gl.getShaderSource(e[0]):null}getFragmentShaderSource(l){const e=this._gl.getAttachedShaders(l);return e?this._gl.getShaderSource(e[1]):null}setDepthStencilTexture(l,e,t,a){l!==void 0&&(e&&(this._boundUniforms[l]=e),!t||!t.depthStencilTexture?this._setTexture(l,null,void 0,void 0,a):this._setTexture(l,t,!1,!0,a))}setTextureFromPostProcess(l,e,t){var a;let s=null;e&&(e._textures.data[e._currentRenderTextureInd]?s=e._textures.data[e._currentRenderTextureInd]:e._forcedOutputTexture&&(s=e._forcedOutputTexture)),this._bindTexture(l,(a=s==null?void 0:s.texture)!==null&&a!==void 0?a:null,t)}setTextureFromPostProcessOutput(l,e,t){var a,s;this._bindTexture(l,(s=(a=e==null?void 0:e._outputTexture)===null||a===void 0?void 0:a.texture)!==null&&s!==void 0?s:null,t)}_rebuildBuffers(){for(const l of this.scenes)l.resetCachedMaterial(),l._rebuildGeometries(),l._rebuildTextures();for(const l of this._virtualScenes)l.resetCachedMaterial(),l._rebuildGeometries(),l._rebuildTextures();super._rebuildBuffers()}_renderFrame(){for(let l=0;l<this._activeRenderLoops.length;l++){const e=this._activeRenderLoops[l];e()}}_renderLoop(){if(!this._contextWasLost){let l=!0;!this.renderEvenInBackground&&this._windowIsBackground&&(l=!1),l&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}this._activeRenderLoops.length>0?this.customAnimationFrameRequester?(this.customAnimationFrameRequester.requestID=this._queueNewFrame(this.customAnimationFrameRequester.renderFunction||this._boundRenderFunction,this.customAnimationFrameRequester),this._frameHandler=this.customAnimationFrameRequester.requestID):this.isVRPresenting()?this._requestVRFrame():this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1}_renderViews(){return!1}switchFullscreen(l){this.isFullscreen?this.exitFullscreen():this.enterFullscreen(l)}enterFullscreen(l){this.isFullscreen||(this._pointerLockRequested=l,this._renderingCanvas&&x._RequestFullscreen(this._renderingCanvas))}exitFullscreen(){this.isFullscreen&&x._ExitFullscreen()}enterPointerlock(){this._renderingCanvas&&x._RequestPointerlock(this._renderingCanvas)}exitPointerlock(){x._ExitPointerlock()}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this),super.beginFrame()}endFrame(){super.endFrame(),this._submitVRFrame(),this.onEndFrameObservable.notifyObservers(this)}resize(l=!1){this.isVRPresenting()||super.resize(l)}setSize(l,e,t=!1){if(!this._renderingCanvas||!super.setSize(l,e,t))return!1;if(this.scenes){for(let a=0;a<this.scenes.length;a++){const s=this.scenes[a];for(let d=0;d<s.cameras.length;d++){const i=s.cameras[d];i._currentRenderId=0}}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}_deletePipelineContext(l){const e=l;e&&e.program&&e.transformFeedback&&(this.deleteTransformFeedback(e.transformFeedback),e.transformFeedback=null),super._deletePipelineContext(l)}createShaderProgram(l,e,t,a,s,d=null){s=s||this._gl,this.onBeforeShaderCompilationObservable.notifyObservers(this);const i=super.createShaderProgram(l,e,t,a,s,d);return this.onAfterShaderCompilationObservable.notifyObservers(this),i}_createShaderProgram(l,e,t,a,s=null){const d=a.createProgram();if(l.program=d,!d)throw new Error("Unable to create program");if(a.attachShader(d,e),a.attachShader(d,t),this.webGLVersion>1&&s){const i=this.createTransformFeedback();this.bindTransformFeedback(i),this.setTranformFeedbackVaryings(d,s),l.transformFeedback=i}return a.linkProgram(d),this.webGLVersion>1&&s&&this.bindTransformFeedback(null),l.context=a,l.vertexShader=e,l.fragmentShader=t,l.isParallelCompiled||this._finalizePipelineContext(l),d}_releaseTexture(l){super._releaseTexture(l)}_releaseRenderTargetWrapper(l){super._releaseRenderTargetWrapper(l),this.scenes.forEach(e=>{e.postProcesses.forEach(t=>{t._outputTexture===l&&(t._outputTexture=null)}),e.cameras.forEach(t=>{t._postProcesses.forEach(a=>{a&&a._outputTexture===l&&(a._outputTexture=null)})})})}getRenderPassNames(){return this._renderPassNames}getCurrentRenderPassName(){return this._renderPassNames[this.currentRenderPassId]}createRenderPassId(l){const e=++x._RenderPassIdCounter;return this._renderPassNames[e]=l??"NONAME",e}releaseRenderPassId(l){this._renderPassNames[l]=void 0;for(let e=0;e<this.scenes.length;++e){const t=this.scenes[e];for(let a=0;a<t.meshes.length;++a){const s=t.meshes[a];if(s.subMeshes)for(let d=0;d<s.subMeshes.length;++d)s.subMeshes[d]._removeDrawWrapper(l)}}}_rescaleTexture(l,e,t,a,s){this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);const d=this.createRenderTargetTexture({width:e.width,height:e.height},{generateMipMaps:!1,type:0,samplingMode:2,generateDepthBuffer:!1,generateStencilBuffer:!1});!this._rescalePostProcess&&x._RescalePostProcessFactory&&(this._rescalePostProcess=x._RescalePostProcessFactory(this)),this._rescalePostProcess&&(this._rescalePostProcess.externalTextureSamplerBinding=!0,this._rescalePostProcess.getEffect().executeWhenCompiled(()=>{this._rescalePostProcess.onApply=function(c){c._bindTexture("textureSampler",l)};let i=t;i||(i=this.scenes[this.scenes.length-1]),i.postProcessManager.directRender([this._rescalePostProcess],d,!0),this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0),this._gl.copyTexImage2D(this._gl.TEXTURE_2D,0,a,0,0,e.width,e.height,0),this.unBindFramebuffer(d),d.dispose(),s&&s()}))}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}wrapWebGLTexture(l){const e=new bd(l,this._gl),t=new Qe(this,Cl.Unknown,!0);return t._hardwareTexture=e,t.isReady=!0,t}_uploadImageToTexture(l,e,t=0,a=0){const s=this._gl,d=this._getWebGLTextureType(l.type),i=this._getInternalFormat(l.format),c=this._getRGBABufferInternalSizedFormat(l.type,i),n=l.isCube?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D;this._bindTextureDirectly(n,l,!0),this._unpackFlipY(l.invertY);let h=s.TEXTURE_2D;l.isCube&&(h=s.TEXTURE_CUBE_MAP_POSITIVE_X+t),s.texImage2D(h,a,c,i,d,e),this._bindTextureDirectly(n,null,!0)}updateTextureComparisonFunction(l,e){if(this.webGLVersion===1){M.Error("WebGL 1 does not support texture comparison.");return}const t=this._gl;l.isCube?(this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,l,!0),e===0?(t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_COMPARE_FUNC,515),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_COMPARE_MODE,t.NONE)):(t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_COMPARE_FUNC,e),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null)):(this._bindTextureDirectly(this._gl.TEXTURE_2D,l,!0),e===0?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_COMPARE_FUNC,515),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_COMPARE_MODE,t.NONE)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_COMPARE_FUNC,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)),l._comparisonFunction=e}createInstancesBuffer(l){const e=this._gl.createBuffer();if(!e)throw new Error("Unable to create instance buffer");const t=new Pt(e);return t.capacity=l,this.bindArrayBuffer(t),this._gl.bufferData(this._gl.ARRAY_BUFFER,l,this._gl.DYNAMIC_DRAW),t.references=1,t}deleteInstancesBuffer(l){this._gl.deleteBuffer(l)}_clientWaitAsync(l,e=0,t=10){const a=this._gl;return new Promise((s,d)=>{const i=()=>{const c=a.clientWaitSync(l,e,0);if(c==a.WAIT_FAILED){d();return}if(c==a.TIMEOUT_EXPIRED){setTimeout(i,t);return}s()};i()})}_readPixelsAsync(l,e,t,a,s,d,i){if(this._webGLVersion<2)throw new Error("_readPixelsAsync only work on WebGL2+");const c=this._gl,n=c.createBuffer();c.bindBuffer(c.PIXEL_PACK_BUFFER,n),c.bufferData(c.PIXEL_PACK_BUFFER,i.byteLength,c.STREAM_READ),c.readPixels(l,e,t,a,s,d,0),c.bindBuffer(c.PIXEL_PACK_BUFFER,null);const h=c.fenceSync(c.SYNC_GPU_COMMANDS_COMPLETE,0);return h?(c.flush(),this._clientWaitAsync(h,0,10).then(()=>(c.deleteSync(h),c.bindBuffer(c.PIXEL_PACK_BUFFER,n),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,i),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),c.deleteBuffer(n),i))):null}dispose(){for(this.hideLoadingUI(),this.onNewSceneAddedObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(this._rescalePostProcess&&this._rescalePostProcess.dispose();this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();x.Instances.length===1&&x.audioEngine&&(x.audioEngine.dispose(),x.audioEngine=null),this.disableVR();const l=this.getHostWindow();l&&typeof l.removeEventListener=="function"&&(l.removeEventListener("blur",this._onBlur),l.removeEventListener("focus",this._onFocus)),this._renderingCanvas&&(this._renderingCanvas.removeEventListener("focus",this._onCanvasFocus),this._renderingCanvas.removeEventListener("blur",this._onCanvasBlur),this._renderingCanvas.removeEventListener("pointerout",this._onCanvasPointerOut),this._renderingCanvas.removeEventListener("contextmenu",this._onCanvasContextMenu)),Qt()&&(document.removeEventListener("fullscreenchange",this._onFullscreenChange),document.removeEventListener("mozfullscreenchange",this._onFullscreenChange),document.removeEventListener("webkitfullscreenchange",this._onFullscreenChange),document.removeEventListener("msfullscreenchange",this._onFullscreenChange),document.removeEventListener("pointerlockchange",this._onPointerLockChange),document.removeEventListener("mspointerlockchange",this._onPointerLockChange),document.removeEventListener("mozpointerlockchange",this._onPointerLockChange),document.removeEventListener("webkitpointerlockchange",this._onPointerLockChange)),super.dispose();const e=x.Instances.indexOf(this);e>=0&&x.Instances.splice(e,1),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()}_disableTouchAction(){!this._renderingCanvas||!this._renderingCanvas.setAttribute||(this._renderingCanvas.setAttribute("touch-action","none"),this._renderingCanvas.style.touchAction="none",this._renderingCanvas.style.webkitTapHighlightColor="transparent")}displayLoadingUI(){if(!jl())return;const l=this.loadingScreen;l&&l.displayLoadingUI()}hideLoadingUI(){if(!jl())return;const l=this._loadingScreen;l&&l.hideLoadingUI()}get loadingScreen(){return!this._loadingScreen&&this._renderingCanvas&&(this._loadingScreen=x.DefaultLoadingScreenFactory(this._renderingCanvas)),this._loadingScreen}set loadingScreen(l){this._loadingScreen=l}set loadingUIText(l){this.loadingScreen.loadingUIText=l}set loadingUIBackgroundColor(l){this.loadingScreen.loadingUIBackgroundColor=l}createVideoElement(l){return document.createElement("video")}static _RequestPointerlock(l){l.requestPointerLock&&(l.requestPointerLock(),l.focus())}static _ExitPointerlock(){document.exitPointerLock&&document.exitPointerLock()}static _RequestFullscreen(l){const e=l.requestFullscreen||l.webkitRequestFullscreen;e&&e.call(l)}static _ExitFullscreen(){const l=document;document.exitFullscreen?document.exitFullscreen():l.webkitCancelFullScreen&&l.webkitCancelFullScreen()}getFontOffset(l){const e=document.createElement("span");e.innerHTML="Hg",e.setAttribute("style",`font: ${l} !important`);const t=document.createElement("div");t.style.display="inline-block",t.style.width="1px",t.style.height="0px",t.style.verticalAlign="bottom";const a=document.createElement("div");a.style.whiteSpace="nowrap",a.appendChild(e),a.appendChild(t),document.body.appendChild(a);let s=0,d=0;try{d=t.getBoundingClientRect().top-e.getBoundingClientRect().top,t.style.verticalAlign="baseline",s=t.getBoundingClientRect().top-e.getBoundingClientRect().top}finally{document.body.removeChild(a)}return{ascent:s,height:d,descent:d-s}}}x.ALPHA_DISABLE=0;x.ALPHA_ADD=1;x.ALPHA_COMBINE=2;x.ALPHA_SUBTRACT=3;x.ALPHA_MULTIPLY=4;x.ALPHA_MAXIMIZED=5;x.ALPHA_ONEONE=6;x.ALPHA_PREMULTIPLIED=7;x.ALPHA_PREMULTIPLIED_PORTERDUFF=8;x.ALPHA_INTERPOLATE=9;x.ALPHA_SCREENMODE=10;x.DELAYLOADSTATE_NONE=0;x.DELAYLOADSTATE_LOADED=1;x.DELAYLOADSTATE_LOADING=2;x.DELAYLOADSTATE_NOTLOADED=4;x.NEVER=512;x.ALWAYS=519;x.LESS=513;x.EQUAL=514;x.LEQUAL=515;x.GREATER=516;x.GEQUAL=518;x.NOTEQUAL=517;x.KEEP=7680;x.REPLACE=7681;x.INCR=7682;x.DECR=7683;x.INVERT=5386;x.INCR_WRAP=34055;x.DECR_WRAP=34056;x.TEXTURE_CLAMP_ADDRESSMODE=0;x.TEXTURE_WRAP_ADDRESSMODE=1;x.TEXTURE_MIRROR_ADDRESSMODE=2;x.TEXTUREFORMAT_ALPHA=0;x.TEXTUREFORMAT_LUMINANCE=1;x.TEXTUREFORMAT_LUMINANCE_ALPHA=2;x.TEXTUREFORMAT_RGB=4;x.TEXTUREFORMAT_RGBA=5;x.TEXTUREFORMAT_RED=6;x.TEXTUREFORMAT_R=6;x.TEXTUREFORMAT_RG=7;x.TEXTUREFORMAT_RED_INTEGER=8;x.TEXTUREFORMAT_R_INTEGER=8;x.TEXTUREFORMAT_RG_INTEGER=9;x.TEXTUREFORMAT_RGB_INTEGER=10;x.TEXTUREFORMAT_RGBA_INTEGER=11;x.TEXTURETYPE_UNSIGNED_BYTE=0;x.TEXTURETYPE_UNSIGNED_INT=0;x.TEXTURETYPE_FLOAT=1;x.TEXTURETYPE_HALF_FLOAT=2;x.TEXTURETYPE_BYTE=3;x.TEXTURETYPE_SHORT=4;x.TEXTURETYPE_UNSIGNED_SHORT=5;x.TEXTURETYPE_INT=6;x.TEXTURETYPE_UNSIGNED_INTEGER=7;x.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8;x.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9;x.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10;x.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11;x.TEXTURETYPE_UNSIGNED_INT_24_8=12;x.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13;x.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14;x.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15;x.TEXTURE_NEAREST_SAMPLINGMODE=1;x.TEXTURE_BILINEAR_SAMPLINGMODE=2;x.TEXTURE_TRILINEAR_SAMPLINGMODE=3;x.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8;x.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11;x.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3;x.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4;x.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5;x.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6;x.TEXTURE_NEAREST_LINEAR=7;x.TEXTURE_NEAREST_NEAREST=1;x.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9;x.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10;x.TEXTURE_LINEAR_LINEAR=2;x.TEXTURE_LINEAR_NEAREST=12;x.TEXTURE_EXPLICIT_MODE=0;x.TEXTURE_SPHERICAL_MODE=1;x.TEXTURE_PLANAR_MODE=2;x.TEXTURE_CUBIC_MODE=3;x.TEXTURE_PROJECTION_MODE=4;x.TEXTURE_SKYBOX_MODE=5;x.TEXTURE_INVCUBIC_MODE=6;x.TEXTURE_EQUIRECTANGULAR_MODE=7;x.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8;x.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9;x.SCALEMODE_FLOOR=1;x.SCALEMODE_NEAREST=2;x.SCALEMODE_CEILING=3;x._RescalePostProcessFactory=null;x._RenderPassIdCounter=0;Zl.prototype._debugPushGroup=function(Z,l){};Zl.prototype._debugPopGroup=function(Z){};Zl.prototype._debugInsertMarker=function(Z,l){};Zl.prototype._debugFlushPendingCommands=function(){};function Yi(Z){return new x(Z,!0,{preserveDrawingBuffer:!0,stencil:!0})}class al{constructor(l=0,e=0,t=0){this.r=l,this.g=e,this.b=t}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let l=this.r*255|0;return l=l*397^(this.g*255|0),l=l*397^(this.b*255|0),l}toArray(l,e=0){return l[e]=this.r,l[e+1]=this.g,l[e+2]=this.b,this}fromArray(l,e=0){return al.FromArrayToRef(l,e,this),this}toColor4(l=1){return new Gl(this.r,this.g,this.b,l)}asArray(){return[this.r,this.g,this.b]}toLuminance(){return this.r*.3+this.g*.59+this.b*.11}multiply(l){return new al(this.r*l.r,this.g*l.g,this.b*l.b)}multiplyToRef(l,e){return e.r=this.r*l.r,e.g=this.g*l.g,e.b=this.b*l.b,this}equals(l){return l&&this.r===l.r&&this.g===l.g&&this.b===l.b}equalsFloats(l,e,t){return this.r===l&&this.g===e&&this.b===t}scale(l){return new al(this.r*l,this.g*l,this.b*l)}scaleInPlace(l){return this.r*=l,this.g*=l,this.b*=l,this}scaleToRef(l,e){return e.r=this.r*l,e.g=this.g*l,e.b=this.b*l,this}scaleAndAddToRef(l,e){return e.r+=this.r*l,e.g+=this.g*l,e.b+=this.b*l,this}clampToRef(l=0,e=1,t){return t.r=dl.Clamp(this.r,l,e),t.g=dl.Clamp(this.g,l,e),t.b=dl.Clamp(this.b,l,e),this}add(l){return new al(this.r+l.r,this.g+l.g,this.b+l.b)}addToRef(l,e){return e.r=this.r+l.r,e.g=this.g+l.g,e.b=this.b+l.b,this}subtract(l){return new al(this.r-l.r,this.g-l.g,this.b-l.b)}subtractToRef(l,e){return e.r=this.r-l.r,e.g=this.g-l.g,e.b=this.b-l.b,this}clone(){return new al(this.r,this.g,this.b)}copyFrom(l){return this.r=l.r,this.g=l.g,this.b=l.b,this}copyFromFloats(l,e,t){return this.r=l,this.g=e,this.b=t,this}set(l,e,t){return this.copyFromFloats(l,e,t)}toHexString(){const l=Math.round(this.r*255),e=Math.round(this.g*255),t=Math.round(this.b*255);return"#"+dl.ToHex(l)+dl.ToHex(e)+dl.ToHex(t)}toLinearSpace(){const l=new al;return this.toLinearSpaceToRef(l),l}toHSV(){const l=new al;return this.toHSVToRef(l),l}toHSVToRef(l){const e=this.r,t=this.g,a=this.b,s=Math.max(e,t,a),d=Math.min(e,t,a);let i=0,c=0;const n=s,h=s-d;s!==0&&(c=h/s),s!=d&&(s==e?(i=(t-a)/h,t<a&&(i+=6)):s==t?i=(a-e)/h+2:s==a&&(i=(e-t)/h+4),i*=60),l.r=i,l.g=c,l.b=n}toLinearSpaceToRef(l){return l.r=Math.pow(this.r,ft),l.g=Math.pow(this.g,ft),l.b=Math.pow(this.b,ft),this}toGammaSpace(){const l=new al;return this.toGammaSpaceToRef(l),l}toGammaSpaceToRef(l){return l.r=Math.pow(this.r,Ut),l.g=Math.pow(this.g,Ut),l.b=Math.pow(this.b,Ut),this}static HSVtoRGBToRef(l,e,t,a){const s=t*e,d=l/60,i=s*(1-Math.abs(d%2-1));let c=0,n=0,h=0;d>=0&&d<=1?(c=s,n=i):d>=1&&d<=2?(c=i,n=s):d>=2&&d<=3?(n=s,h=i):d>=3&&d<=4?(n=i,h=s):d>=4&&d<=5?(c=i,h=s):d>=5&&d<=6&&(c=s,h=i);const m=t-s;a.set(c+m,n+m,h+m)}static FromHSV(l,e,t){const a=new al(0,0,0);return al.HSVtoRGBToRef(l,e,t,a),a}static FromHexString(l){if(l.substring(0,1)!=="#"||l.length!==7)return new al(0,0,0);const e=parseInt(l.substring(1,3),16),t=parseInt(l.substring(3,5),16),a=parseInt(l.substring(5,7),16);return al.FromInts(e,t,a)}static FromArray(l,e=0){return new al(l[e],l[e+1],l[e+2])}static FromArrayToRef(l,e=0,t){t.r=l[e],t.g=l[e+1],t.b=l[e+2]}static FromInts(l,e,t){return new al(l/255,e/255,t/255)}static Lerp(l,e,t){const a=new al(0,0,0);return al.LerpToRef(l,e,t,a),a}static LerpToRef(l,e,t,a){a.r=l.r+(e.r-l.r)*t,a.g=l.g+(e.g-l.g)*t,a.b=l.b+(e.b-l.b)*t}static Hermite(l,e,t,a,s){const d=s*s,i=s*d,c=2*i-3*d+1,n=-2*i+3*d,h=i-2*d+s,m=i-d,o=l.r*c+t.r*n+e.r*h+a.r*m,b=l.g*c+t.g*n+e.g*h+a.g*m,u=l.b*c+t.b*n+e.b*h+a.b*m;return new al(o,b,u)}static Hermite1stDerivative(l,e,t,a,s){const d=al.Black();return this.Hermite1stDerivativeToRef(l,e,t,a,s,d),d}static Hermite1stDerivativeToRef(l,e,t,a,s,d){const i=s*s;d.r=(i-s)*6*l.r+(3*i-4*s+1)*e.r+(-i+s)*6*t.r+(3*i-2*s)*a.r,d.g=(i-s)*6*l.g+(3*i-4*s+1)*e.g+(-i+s)*6*t.g+(3*i-2*s)*a.g,d.b=(i-s)*6*l.b+(3*i-4*s+1)*e.b+(-i+s)*6*t.b+(3*i-2*s)*a.b}static Red(){return new al(1,0,0)}static Green(){return new al(0,1,0)}static Blue(){return new al(0,0,1)}static Black(){return new al(0,0,0)}static get BlackReadOnly(){return al._BlackReadOnly}static White(){return new al(1,1,1)}static Purple(){return new al(.5,0,.5)}static Magenta(){return new al(1,0,1)}static Yellow(){return new al(1,1,0)}static Gray(){return new al(.5,.5,.5)}static Teal(){return new al(0,1,1)}static Random(){return new al(Math.random(),Math.random(),Math.random())}}al._BlackReadOnly=al.Black();let Gl=class{constructor(Z=0,l=0,e=0,t=1){this.r=Z,this.g=l,this.b=e,this.a=t}addInPlace(Z){return this.r+=Z.r,this.g+=Z.g,this.b+=Z.b,this.a+=Z.a,this}asArray(){return[this.r,this.g,this.b,this.a]}toArray(Z,l=0){return Z[l]=this.r,Z[l+1]=this.g,Z[l+2]=this.b,Z[l+3]=this.a,this}fromArray(Z,l=0){return Gl.FromArrayToRef(Z,l,this),this}equals(Z){return Z&&this.r===Z.r&&this.g===Z.g&&this.b===Z.b&&this.a===Z.a}add(Z){return new Gl(this.r+Z.r,this.g+Z.g,this.b+Z.b,this.a+Z.a)}subtract(Z){return new Gl(this.r-Z.r,this.g-Z.g,this.b-Z.b,this.a-Z.a)}subtractToRef(Z,l){return l.r=this.r-Z.r,l.g=this.g-Z.g,l.b=this.b-Z.b,l.a=this.a-Z.a,this}scale(Z){return new Gl(this.r*Z,this.g*Z,this.b*Z,this.a*Z)}scaleInPlace(Z){return this.r*=Z,this.g*=Z,this.b*=Z,this.a*=Z,this}scaleToRef(Z,l){return l.r=this.r*Z,l.g=this.g*Z,l.b=this.b*Z,l.a=this.a*Z,this}scaleAndAddToRef(Z,l){return l.r+=this.r*Z,l.g+=this.g*Z,l.b+=this.b*Z,l.a+=this.a*Z,this}clampToRef(Z=0,l=1,e){return e.r=dl.Clamp(this.r,Z,l),e.g=dl.Clamp(this.g,Z,l),e.b=dl.Clamp(this.b,Z,l),e.a=dl.Clamp(this.a,Z,l),this}multiply(Z){return new Gl(this.r*Z.r,this.g*Z.g,this.b*Z.b,this.a*Z.a)}multiplyToRef(Z,l){return l.r=this.r*Z.r,l.g=this.g*Z.g,l.b=this.b*Z.b,l.a=this.a*Z.a,l}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let Z=this.r*255|0;return Z=Z*397^(this.g*255|0),Z=Z*397^(this.b*255|0),Z=Z*397^(this.a*255|0),Z}clone(){return new Gl(this.r,this.g,this.b,this.a)}copyFrom(Z){return this.r=Z.r,this.g=Z.g,this.b=Z.b,this.a=Z.a,this}copyFromFloats(Z,l,e,t){return this.r=Z,this.g=l,this.b=e,this.a=t,this}set(Z,l,e,t){return this.copyFromFloats(Z,l,e,t)}toHexString(Z=!1){const l=Math.round(this.r*255),e=Math.round(this.g*255),t=Math.round(this.b*255);if(Z)return"#"+dl.ToHex(l)+dl.ToHex(e)+dl.ToHex(t);const a=Math.round(this.a*255);return"#"+dl.ToHex(l)+dl.ToHex(e)+dl.ToHex(t)+dl.ToHex(a)}toLinearSpace(){const Z=new Gl;return this.toLinearSpaceToRef(Z),Z}toLinearSpaceToRef(Z){return Z.r=Math.pow(this.r,ft),Z.g=Math.pow(this.g,ft),Z.b=Math.pow(this.b,ft),Z.a=this.a,this}toGammaSpace(){const Z=new Gl;return this.toGammaSpaceToRef(Z),Z}toGammaSpaceToRef(Z){return Z.r=Math.pow(this.r,Ut),Z.g=Math.pow(this.g,Ut),Z.b=Math.pow(this.b,Ut),Z.a=this.a,this}static FromHexString(Z){if(Z.substring(0,1)!=="#"||Z.length!==9&&Z.length!==7)return new Gl(0,0,0,0);const l=parseInt(Z.substring(1,3),16),e=parseInt(Z.substring(3,5),16),t=parseInt(Z.substring(5,7),16),a=Z.length===9?parseInt(Z.substring(7,9),16):255;return Gl.FromInts(l,e,t,a)}static Lerp(Z,l,e){const t=new Gl(0,0,0,0);return Gl.LerpToRef(Z,l,e,t),t}static LerpToRef(Z,l,e,t){t.r=Z.r+(l.r-Z.r)*e,t.g=Z.g+(l.g-Z.g)*e,t.b=Z.b+(l.b-Z.b)*e,t.a=Z.a+(l.a-Z.a)*e}static Hermite(Z,l,e,t,a){const s=a*a,d=a*s,i=2*d-3*s+1,c=-2*d+3*s,n=d-2*s+a,h=d-s,m=Z.r*i+e.r*c+l.r*n+t.r*h,o=Z.g*i+e.g*c+l.g*n+t.g*h,b=Z.b*i+e.b*c+l.b*n+t.b*h,u=Z.a*i+e.a*c+l.a*n+t.a*h;return new Gl(m,o,b,u)}static Hermite1stDerivative(Z,l,e,t,a){const s=new Gl;return this.Hermite1stDerivativeToRef(Z,l,e,t,a,s),s}static Hermite1stDerivativeToRef(Z,l,e,t,a,s){const d=a*a;s.r=(d-a)*6*Z.r+(3*d-4*a+1)*l.r+(-d+a)*6*e.r+(3*d-2*a)*t.r,s.g=(d-a)*6*Z.g+(3*d-4*a+1)*l.g+(-d+a)*6*e.g+(3*d-2*a)*t.g,s.b=(d-a)*6*Z.b+(3*d-4*a+1)*l.b+(-d+a)*6*e.b+(3*d-2*a)*t.b,s.a=(d-a)*6*Z.a+(3*d-4*a+1)*l.a+(-d+a)*6*e.a+(3*d-2*a)*t.a}static FromColor3(Z,l=1){return new Gl(Z.r,Z.g,Z.b,l)}static FromArray(Z,l=0){return new Gl(Z[l],Z[l+1],Z[l+2],Z[l+3])}static FromArrayToRef(Z,l=0,e){e.r=Z[l],e.g=Z[l+1],e.b=Z[l+2],e.a=Z[l+3]}static FromInts(Z,l,e,t){return new Gl(Z/255,l/255,e/255,t/255)}static CheckColors4(Z,l){if(Z.length===l*3){const e=[];for(let t=0;t<Z.length;t+=3){const a=t/3*4;e[a]=Z[t],e[a+1]=Z[t+1],e[a+2]=Z[t+2],e[a+3]=1}return e}return Z}};class Jt{}Jt.Color3=_l.BuildArray(3,al.Black);Jt.Color4=_l.BuildArray(3,()=>new Gl(0,0,0,0));ce("BABYLON.Color3",al);ce("BABYLON.Color4",Gl);const gs=(Z,l)=>!Z||Z.getClassName&&Z.getClassName()==="Mesh"?null:Z.getClassName&&Z.getClassName()==="SubMesh"?Z.clone(l):Z.clone?Z.clone():null;function Ni(Z){const l=[];do Object.getOwnPropertyNames(Z).forEach(function(e){l.indexOf(e)===-1&&l.push(e)});while(Z=Object.getPrototypeOf(Z));return l}class rs{static DeepCopy(l,e,t,a){const s=Ni(l);for(const d of s){if(d[0]==="_"&&(!a||a.indexOf(d)===-1)||d.endsWith("Observable")||t&&t.indexOf(d)!==-1)continue;const i=l[d],c=typeof i;if(c!=="function")try{if(c==="object")if(i instanceof Array){if(e[d]=[],i.length>0)if(typeof i[0]=="object")for(let n=0;n<i.length;n++){const h=gs(i[n],e);e[d].indexOf(h)===-1&&e[d].push(h)}else e[d]=i.slice(0)}else e[d]=gs(i,e);else e[d]=i}catch(n){M.Warn(n.message)}}}}function Fi(){return typeof _native<"u"&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest}class ue{constructor(){this._xhr=Fi(),this._requestURL=""}_injectCustomRequestHeaders(){if(!this._shouldSkipRequestModifications(this._requestURL))for(const l in ue.CustomRequestHeaders){const e=ue.CustomRequestHeaders[l];e&&this._xhr.setRequestHeader(l,e)}}_shouldSkipRequestModifications(l){return ue.SkipRequestModificationForBabylonCDN&&(l.includes("preview.babylonjs.com")||l.includes("cdn.babylonjs.com"))}get onprogress(){return this._xhr.onprogress}set onprogress(l){this._xhr.onprogress=l}get readyState(){return this._xhr.readyState}get status(){return this._xhr.status}get statusText(){return this._xhr.statusText}get response(){return this._xhr.response}get responseURL(){return this._xhr.responseURL}get responseText(){return this._xhr.responseText}get responseType(){return this._xhr.responseType}set responseType(l){this._xhr.responseType=l}get timeout(){return this._xhr.timeout}set timeout(l){this._xhr.timeout=l}addEventListener(l,e,t){this._xhr.addEventListener(l,e,t)}removeEventListener(l,e,t){this._xhr.removeEventListener(l,e,t)}abort(){this._xhr.abort()}send(l){ue.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(l)}open(l,e){for(const t of ue.CustomRequestModifiers){if(this._shouldSkipRequestModifications(e))return;t(this._xhr,e)}return e=e.replace("file:http:","http:"),e=e.replace("file:https:","https:"),this._requestURL=e,this._xhr.open(l,e,!0)}setRequestHeader(l,e){this._xhr.setRequestHeader(l,e)}getResponseHeader(l){return this._xhr.getResponseHeader(l)}}ue.CustomRequestHeaders={};ue.CustomRequestModifiers=new Array;ue.SkipRequestModificationForBabylonCDN=!0;class Kt{}Kt.FilesToLoad={};class Si{static ExponentialBackoff(l=3,e=500){return(t,a,s)=>a.status!==0||s>=l||t.indexOf("file:")!==-1?-1:Math.pow(2,s)*e}}class Tt extends Error{}Tt._setPrototypeOf=Object.setPrototypeOf||((Z,l)=>(Z.__proto__=l,Z));const Xt={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002};class Pe extends Tt{constructor(l,e,t){super(l),this.errorCode=e,this.innerError=t,this.name="RuntimeError",Tt._setPrototypeOf(this,Pe.prototype)}}const Xd=Z=>{const l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let e="",t,a,s,d,i,c,n,h=0;const m=ArrayBuffer.isView(Z)?new Uint8Array(Z.buffer,Z.byteOffset,Z.byteLength):new Uint8Array(Z);for(;h<m.length;)t=m[h++],a=h<m.length?m[h++]:Number.NaN,s=h<m.length?m[h++]:Number.NaN,d=t>>2,i=(t&3)<<4|a>>4,c=(a&15)<<2|s>>6,n=s&63,isNaN(a)?c=n=64:isNaN(s)&&(n=64),e+=l.charAt(d)+l.charAt(i)+l.charAt(c)+l.charAt(n);return e},ud=Z=>atob(Z),Li=Z=>{const l=ud(Z),e=l.length,t=new Uint8Array(new ArrayBuffer(e));for(let a=0;a<e;a++)t[a]=l.charCodeAt(a);return t.buffer};class Va{static SetImmediate(l){jl()&&window.setImmediate?window.setImmediate(l):setTimeout(l,1)}}const rd=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i);class Ra extends Pe{constructor(l,e){super(l,Xt.LoadFileError),this.name="LoadFileError",Tt._setPrototypeOf(this,Ra.prototype),e instanceof ue?this.request=e:this.file=e}}class Wa extends Pe{constructor(l,e){super(l,Xt.RequestFileError),this.request=e,this.name="RequestFileError",Tt._setPrototypeOf(this,Wa.prototype)}}class Gs extends Pe{constructor(l,e){super(l,Xt.ReadFileError),this.file=e,this.name="ReadFileError",Tt._setPrototypeOf(this,Gs.prototype)}}const Pl={DefaultRetryStrategy:Si.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:Z=>Z},Gd=Z=>(Z=Z.replace(/#/gm,"%23"),Z),Vs=(Z,l)=>{if(!(Z&&Z.indexOf("data:")===0)&&Pl.CorsBehavior)if(typeof Pl.CorsBehavior=="string"||Pl.CorsBehavior instanceof String)l.crossOrigin=Pl.CorsBehavior;else{const e=Pl.CorsBehavior(Z);e&&(l.crossOrigin=e)}},Rs=(Z,l,e,t,a="",s)=>{var d;let i,c=!1;Z instanceof ArrayBuffer||ArrayBuffer.isView(Z)?typeof Blob<"u"&&typeof URL<"u"?(i=URL.createObjectURL(new Blob([Z],{type:a})),c=!0):i=`data:${a};base64,`+Xd(Z):Z instanceof Blob?(i=URL.createObjectURL(Z),c=!0):(i=Gd(Z),i=Pl.PreprocessUrl(Z));const n=bl.LastCreatedEngine,h=R=>{if(e){const S=i||Z.toString();e(`Error while trying to load image: ${S.indexOf("http")===0||S.length<=128?S:S.slice(0,128)+"..."}`,R)}};if(typeof Image>"u"||(d=n==null?void 0:n._features.forceBitmapOverHTMLImageElement)!==null&&d!==void 0&&d)return at(i,R=>{n.createImageBitmap(new Blob([R],{type:a}),{premultiplyAlpha:"none",...s}).then(S=>{l(S),c&&URL.revokeObjectURL(i)}).catch(S=>{e&&e("Error while trying to load image: "+Z,S)})},void 0,t||void 0,!0,(R,S)=>{h(S)}),null;const m=new Image;Vs(i,m);const o=[],b=()=>{o.forEach(R=>{R.target.addEventListener(R.name,R.handler)})},u=()=>{o.forEach(R=>{R.target.removeEventListener(R.name,R.handler)}),o.length=0},V=()=>{u(),l(m),c&&m.src&&URL.revokeObjectURL(m.src)},G=R=>{u(),h(R),c&&m.src&&URL.revokeObjectURL(m.src)},p=R=>{u();const S=new Error(`CSP violation of policy ${R.effectiveDirective} ${R.blockedURI}. Current policy is ${R.originalPolicy}`);bl.UseFallbackTexture=!1,h(S),c&&m.src&&URL.revokeObjectURL(m.src),m.src=""};o.push({target:m,name:"load",handler:V}),o.push({target:m,name:"error",handler:G}),o.push({target:document,name:"securitypolicyviolation",handler:p}),b();const y=i.substring(0,5)==="blob:",L=i.substring(0,5)==="data:",N=()=>{y||L?m.src=i:at(i,(R,S,T)=>{const k=!a&&T?T:a,g=new Blob([R],{type:k}),ll=URL.createObjectURL(g);c=!0,m.src=ll},void 0,t||void 0,!0,(R,S)=>{h(S)})},J=()=>{t&&t.loadImage(i,m)};if(!y&&!L&&t&&t.enableTexturesOffline)t.open(J,N);else{if(i.indexOf("file:")!==-1){const R=decodeURIComponent(i.substring(5).toLowerCase());if(Kt.FilesToLoad[R]&&typeof URL<"u"){try{let S;try{S=URL.createObjectURL(Kt.FilesToLoad[R])}catch{S=URL.createObjectURL(Kt.FilesToLoad[R])}m.src=S,c=!0}catch{m.src=""}return m}}N()}return m},wt=(Z,l,e,t,a)=>{const s=new FileReader,d={onCompleteObservable:new z,abort:()=>s.abort()};return s.onloadend=()=>d.onCompleteObservable.notifyObservers(d),a&&(s.onerror=()=>{a(new Gs(`Unable to read ${Z.name}`,Z))}),s.onload=i=>{l(i.target.result)},e&&(s.onprogress=e),t?s.readAsArrayBuffer(Z):s.readAsText(Z),d},at=(Z,l,e,t,a,s,d)=>{if(Z.name)return wt(Z,l,e,a,s?h=>{s(void 0,h)}:void 0);const i=Z;if(i.indexOf("file:")!==-1){let h=decodeURIComponent(i.substring(5).toLowerCase());h.indexOf("./")===0&&(h=h.substring(2));const m=Kt.FilesToLoad[h];if(m)return wt(m,l,e,a,s?o=>s(void 0,new Ra(o.message,o.file)):void 0)}const{match:c,type:n}=Ji(i);if(c){const h={onCompleteObservable:new z,abort:()=>()=>{}};try{const m=a?ys(i):Rd(i);l(m,void 0,n)}catch(m){s?s(void 0,m):M.Error(m.message||"Failed to parse the Data URL")}return Va.SetImmediate(()=>{h.onCompleteObservable.notifyObservers(h)}),h}return Ws(i,(h,m)=>{l(h,m==null?void 0:m.responseURL,m==null?void 0:m.getResponseHeader("content-type"))},e,t,a,s?h=>{s(h.request,new Ra(h.message,h.request))}:void 0,d)},Ws=(Z,l,e,t,a,s,d)=>{Z=Gd(Z),Z=Pl.PreprocessUrl(Z);const i=Pl.BaseUrl+Z;let c=!1;const n={onCompleteObservable:new z,abort:()=>c=!0},h=()=>{let m=new ue,o=null,b;const u=()=>{m&&(e&&m.removeEventListener("progress",e),b&&m.removeEventListener("readystatechange",b),m.removeEventListener("loadend",V))};let V=()=>{u(),n.onCompleteObservable.notifyObservers(n),n.onCompleteObservable.clear(),e=void 0,b=null,V=null,s=void 0,d=void 0,l=void 0};n.abort=()=>{c=!0,V&&V(),m&&m.readyState!==(XMLHttpRequest.DONE||4)&&m.abort(),o!==null&&(clearTimeout(o),o=null),m=null};const G=y=>{const L=y.message||"Unknown error";s&&m?s(new Wa(L,m)):M.Error(L)},p=y=>{if(m){if(m.open("GET",i),d)try{d(m)}catch(L){G(L);return}a&&(m.responseType="arraybuffer"),e&&m.addEventListener("progress",e),V&&m.addEventListener("loadend",V),b=()=>{if(!(c||!m)&&m.readyState===(XMLHttpRequest.DONE||4)){if(b&&m.removeEventListener("readystatechange",b),m.status>=200&&m.status<300||m.status===0&&(!jl()||Vd())){try{l&&l(a?m.response:m.responseText,m)}catch(J){G(J)}return}const L=Pl.DefaultRetryStrategy;if(L){const J=L(i,m,y);if(J!==-1){u(),m=new ue,o=setTimeout(()=>p(y+1),J);return}}const N=new Wa("Error status: "+m.status+" "+m.statusText+" - Unable to load "+i,m);s&&s(N)}},m.addEventListener("readystatechange",b),m.send()}};p(0)};if(t&&t.enableSceneOffline){const m=b=>{b&&b.status>400?s&&s(b):h()},o=()=>{t&&t.loadFile(Pl.BaseUrl+Z,b=>{!c&&l&&l(b),n.onCompleteObservable.notifyObservers(n)},e?b=>{!c&&e&&e(b)}:void 0,m,a)};t.open(o,m)}else h();return n},Vd=()=>typeof location<"u"&&location.protocol==="file:",ps=Z=>rd.test(Z),Ji=Z=>{const l=rd.exec(Z);return l===null||l.length===0?{match:!1,type:""}:{match:!0,type:l[0].replace("data:","").replace("base64,","")}};function ys(Z){return Li(Z.split(",")[1])}const Rd=Z=>ud(Z.split(",")[1]),xi=()=>{Zl._FileToolsLoadImage=Rs,Zl._FileToolsLoadFile=at,ot._FileToolsLoadFile=at};xi();let Ct;const Ui=(Z,l,e,t,a,s,d,i,c,n)=>{Ct={DecodeBase64UrlToBinary:Z,DecodeBase64UrlToString:l,DefaultRetryStrategy:e.DefaultRetryStrategy,BaseUrl:e.BaseUrl,CorsBehavior:e.CorsBehavior,PreprocessUrl:e.PreprocessUrl,IsBase64DataUrl:t,IsFileURL:a,LoadFile:s,LoadImage:d,ReadFile:i,RequestFile:c,SetCorsBehavior:n},Object.defineProperty(Ct,"DefaultRetryStrategy",{get:function(){return e.DefaultRetryStrategy},set:function(h){e.DefaultRetryStrategy=h}}),Object.defineProperty(Ct,"BaseUrl",{get:function(){return e.BaseUrl},set:function(h){e.BaseUrl=h}}),Object.defineProperty(Ct,"PreprocessUrl",{get:function(){return e.PreprocessUrl},set:function(h){e.PreprocessUrl=h}}),Object.defineProperty(Ct,"CorsBehavior",{get:function(){return e.CorsBehavior},set:function(h){e.CorsBehavior=h}})};Ui(ys,Rd,Pl,ps,Vd,at,Rs,wt,Ws,Vs);class Bt{static Instantiate(l){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[l])return this.RegisteredExternalClasses[l];const e=Gt(l);if(e)return e;M.Warn(l+" not found, you may have missed an import.");const t=l.split(".");let a=window||this;for(let s=0,d=t.length;s<d;s++)a=a[t[s]];return typeof a!="function"?null:a}}Bt.RegisteredExternalClasses={};function Wd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,Z=>{const l=Math.random()*16|0;return(Z==="x"?l:l&3|8).toString(16)})}class Q{static get BaseUrl(){return Pl.BaseUrl}static set BaseUrl(l){Pl.BaseUrl=l}static get DefaultRetryStrategy(){return Pl.DefaultRetryStrategy}static set DefaultRetryStrategy(l){Pl.DefaultRetryStrategy=l}static get CorsBehavior(){return Pl.CorsBehavior}static set CorsBehavior(l){Pl.CorsBehavior=l}static get UseFallbackTexture(){return bl.UseFallbackTexture}static set UseFallbackTexture(l){bl.UseFallbackTexture=l}static get RegisteredExternalClasses(){return Bt.RegisteredExternalClasses}static set RegisteredExternalClasses(l){Bt.RegisteredExternalClasses=l}static get fallbackTexture(){return bl.FallbackTexture}static set fallbackTexture(l){bl.FallbackTexture=l}static FetchToRef(l,e,t,a,s,d){const i=Math.abs(l)*t%t|0,c=Math.abs(e)*a%a|0,n=(i+c*t)*4;d.r=s[n]/255,d.g=s[n+1]/255,d.b=s[n+2]/255,d.a=s[n+3]/255}static Mix(l,e,t){return l*(1-t)+e*t}static Instantiate(l){return Bt.Instantiate(l)}static SetImmediate(l){Va.SetImmediate(l)}static IsExponentOfTwo(l){let e=1;do e*=2;while(e<l);return e===l}static FloatRound(l){return Math.fround?Math.fround(l):(Q._TmpFloatArray[0]=l,Q._TmpFloatArray[0])}static GetFilename(l){const e=l.lastIndexOf("/");return e<0?l:l.substring(e+1)}static GetFolderPath(l,e=!1){const t=l.lastIndexOf("/");return t<0?e?l:"":l.substring(0,t+1)}static ToDegrees(l){return l*180/Math.PI}static ToRadians(l){return l*Math.PI/180}static SmoothAngleChange(l,e,t=.9){const a=this.ToRadians(l),s=this.ToRadians(e);return this.ToDegrees(Math.atan2((1-t)*Math.sin(s)+t*Math.sin(a),(1-t)*Math.cos(s)+t*Math.cos(a)))}static MakeArray(l,e){return e!==!0&&(l===void 0||l==null)?null:Array.isArray(l)?l:[l]}static GetPointerPrefix(l){let e="pointer";return jl()&&!window.PointerEvent&&(e="mouse"),l._badDesktopOS&&!l._badOS&&!(document&&"ontouchend"in document)&&(e="mouse"),e}static SetCorsBehavior(l,e){Vs(l,e)}static SetReferrerPolicyBehavior(l,e){e.referrerPolicy=l}static CleanUrl(l){return l=l.replace(/#/gm,"%23"),l}static get PreprocessUrl(){return Pl.PreprocessUrl}static set PreprocessUrl(l){Pl.PreprocessUrl=l}static LoadImage(l,e,t,a,s,d){return Rs(l,e,t,a,s,d)}static LoadFile(l,e,t,a,s,d){return at(l,e,t,a,s,d)}static LoadFileAsync(l,e=!0){return new Promise((t,a)=>{at(l,s=>{t(s)},void 0,void 0,e,(s,d)=>{a(d)})})}static LoadScript(l,e,t,a){if(typeof importScripts=="function"){try{importScripts(l),e()}catch(i){t==null||t(`Unable to load script '${l}' in worker`,i)}return}else if(!jl()){t==null||t(`Cannot load script '${l}' outside of a window or a worker`);return}const s=document.getElementsByTagName("head")[0],d=document.createElement("script");d.setAttribute("type","text/javascript"),d.setAttribute("src",l),a&&(d.id=a),d.onload=()=>{e&&e()},d.onerror=i=>{t&&t(`Unable to load script '${l}'`,i)},s.appendChild(d)}static LoadScriptAsync(l){return new Promise((e,t)=>{this.LoadScript(l,()=>{e()},(a,s)=>{t(s||new Error(a))})})}static ReadFileAsDataURL(l,e,t){const a=new FileReader,s={onCompleteObservable:new z,abort:()=>a.abort()};return a.onloadend=()=>{s.onCompleteObservable.notifyObservers(s)},a.onload=d=>{e(d.target.result)},a.onprogress=t,a.readAsDataURL(l),s}static ReadFile(l,e,t,a,s){return wt(l,e,t,a,s)}static FileAsURL(l){const e=new Blob([l]);return window.URL.createObjectURL(e)}static Format(l,e=2){return l.toFixed(e)}static DeepCopy(l,e,t,a){rs.DeepCopy(l,e,t,a)}static IsEmpty(l){for(const e in l)if(Object.prototype.hasOwnProperty.call(l,e))return!1;return!0}static RegisterTopRootEvents(l,e){for(let t=0;t<e.length;t++){const a=e[t];l.addEventListener(a.name,a.handler,!1);try{window.parent&&window.parent.addEventListener(a.name,a.handler,!1)}catch{}}}static UnregisterTopRootEvents(l,e){for(let t=0;t<e.length;t++){const a=e[t];l.removeEventListener(a.name,a.handler);try{l.parent&&l.parent.removeEventListener(a.name,a.handler)}catch{}}}static async DumpFramebuffer(l,e,t,a,s="image/png",d){throw O("DumpTools")}static DumpData(l,e,t,a,s="image/png",d,i=!1,c=!1,n){throw O("DumpTools")}static DumpDataAsync(l,e,t,a="image/png",s,d=!1,i=!1,c){throw O("DumpTools")}static ToBlob(l,e,t="image/png",a){l.toBlob||(l.toBlob=function(s,d,i){setTimeout(()=>{const c=atob(this.toDataURL(d,i).split(",")[1]),n=c.length,h=new Uint8Array(n);for(let m=0;m<n;m++)h[m]=c.charCodeAt(m);s(new Blob([h]))})}),l.toBlob(function(s){e(s)},t,a)}static DownloadBlob(l,e){if("download"in document.createElement("a")){if(!e){const t=new Date;e="screenshot_"+((t.getFullYear()+"-"+(t.getMonth()+1)).slice(2)+"-"+t.getDate()+"_"+t.getHours()+"-"+("0"+t.getMinutes()).slice(-2))+".png"}Q.Download(l,e)}else if(l&&typeof URL<"u"){const t=URL.createObjectURL(l),a=window.open("");if(!a)return;const s=a.document.createElement("img");s.onload=function(){URL.revokeObjectURL(t)},s.src=t,a.document.body.appendChild(s)}}static EncodeScreenshotCanvasData(l,e,t="image/png",a,s){if(e){const d=l.toDataURL(t,s);e(d)}else this.ToBlob(l,function(d){d&&Q.DownloadBlob(d,a)},t,s)}static Download(l,e){if(typeof URL>"u")return;const t=window.URL.createObjectURL(l),a=document.createElement("a");document.body.appendChild(a),a.style.display="none",a.href=t,a.download=e,a.addEventListener("click",()=>{a.parentElement&&a.parentElement.removeChild(a)}),a.click(),window.URL.revokeObjectURL(t)}static BackCompatCameraNoPreventDefault(l){return typeof l[0]=="boolean"?l[0]:typeof l[1]=="boolean"?l[1]:!1}static CreateScreenshot(l,e,t,a,s="image/png"){throw O("ScreenshotTools")}static CreateScreenshotAsync(l,e,t,a="image/png"){throw O("ScreenshotTools")}static CreateScreenshotUsingRenderTarget(l,e,t,a,s="image/png",d=1,i=!1,c){throw O("ScreenshotTools")}static CreateScreenshotUsingRenderTargetAsync(l,e,t,a="image/png",s=1,d=!1,i){throw O("ScreenshotTools")}static RandomId(){return Wd()}static IsBase64(l){return ps(l)}static DecodeBase64(l){return ys(l)}static get errorsCount(){return M.errorsCount}static Log(l){M.Log(l)}static Warn(l){M.Warn(l)}static Error(l){M.Error(l)}static get LogCache(){return M.LogCache}static ClearLogCache(){M.ClearLogCache()}static set LogLevels(l){M.LogLevels=l}static set PerformanceLogLevel(l){if((l&Q.PerformanceUserMarkLogLevel)===Q.PerformanceUserMarkLogLevel){Q.StartPerformanceCounter=Q._StartUserMark,Q.EndPerformanceCounter=Q._EndUserMark;return}if((l&Q.PerformanceConsoleLogLevel)===Q.PerformanceConsoleLogLevel){Q.StartPerformanceCounter=Q._StartPerformanceConsole,Q.EndPerformanceCounter=Q._EndPerformanceConsole;return}Q.StartPerformanceCounter=Q._StartPerformanceCounterDisabled,Q.EndPerformanceCounter=Q._EndPerformanceCounterDisabled}static _StartPerformanceCounterDisabled(l,e){}static _EndPerformanceCounterDisabled(l,e){}static _StartUserMark(l,e=!0){if(!Q._Performance){if(!jl())return;Q._Performance=window.performance}!e||!Q._Performance.mark||Q._Performance.mark(l+"-Begin")}static _EndUserMark(l,e=!0){!e||!Q._Performance.mark||(Q._Performance.mark(l+"-End"),Q._Performance.measure(l,l+"-Begin",l+"-End"))}static _StartPerformanceConsole(l,e=!0){e&&(Q._StartUserMark(l,e),console.time&&console.time(l))}static _EndPerformanceConsole(l,e=!0){e&&(Q._EndUserMark(l,e),console.timeEnd(l))}static get Now(){return bt.Now}static GetClassName(l,e=!1){let t=null;return!e&&l.getClassName?t=l.getClassName():(l instanceof Object&&(t=(e?l:Object.getPrototypeOf(l)).constructor.__bjsclassName__),t||(t=typeof l)),t}static First(l,e){for(const t of l)if(e(t))return t;return null}static getFullClassName(l,e=!1){let t=null,a=null;if(!e&&l.getClassName)t=l.getClassName();else{if(l instanceof Object){const s=e?l:Object.getPrototypeOf(l);t=s.constructor.__bjsclassName__,a=s.constructor.__bjsmoduleName__}t||(t=typeof l)}return t?(a!=null?a+".":"")+t:null}static DelayAsync(l){return new Promise(e=>{setTimeout(()=>{e()},l)})}static IsSafari(){return od()?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}}Q.UseCustomRequestHeaders=!1;Q.CustomRequestHeaders=ue.CustomRequestHeaders;Q._TmpFloatArray=new Float32Array(1);Q.GetDOMTextContent=us;Q.GetAbsoluteUrl=typeof document=="object"?Z=>{const l=document.createElement("a");return l.href=Z,l.href}:typeof URL=="function"&&typeof location=="object"?Z=>new URL(Z,location.origin).href:()=>{throw new Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")};Q.NoneLogLevel=M.NoneLogLevel;Q.MessageLogLevel=M.MessageLogLevel;Q.WarningLogLevel=M.WarningLogLevel;Q.ErrorLogLevel=M.ErrorLogLevel;Q.AllLogLevel=M.AllLogLevel;Q.IsWindowObjectExist=jl;Q.PerformanceNoneLogLevel=0;Q.PerformanceUserMarkLogLevel=1;Q.PerformanceConsoleLogLevel=2;Q.StartPerformanceCounter=Q._StartPerformanceCounterDisabled;Q.EndPerformanceCounter=Q._EndPerformanceCounterDisabled;class pa{constructor(l,e,t,a=0){this.iterations=l,this.index=a-1,this._done=!1,this._fn=e,this._successCallback=t}executeNext(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}breakLoop(){this._done=!0,this._successCallback()}static Run(l,e,t,a=0){const s=new pa(l,e,t,a);return s.executeNext(),s}static SyncAsyncForLoop(l,e,t,a,s,d=0){return pa.Run(Math.ceil(l/e),i=>{s&&s()?i.breakLoop():setTimeout(()=>{for(let c=0;c<e;++c){const n=i.index*e+c;if(n>=l)break;if(t(n),s&&s()){i.breakLoop();break}}i.executeNext()},d)},a)}}bl.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z";class ql{constructor(l){this.length=0,this.data=new Array(l),this._id=ql._GlobalId++}push(l){this.data[this.length++]=l,this.length>this.data.length&&(this.data.length*=2)}forEach(l){for(let e=0;e<this.length;e++)l(this.data[e])}sort(l){this.data.sort(l)}reset(){this.length=0}dispose(){this.reset(),this.data&&(this.data.length=0)}concat(l){if(l.length!==0){this.length+l.length>this.data.length&&(this.data.length=(this.length+l.length)*2);for(let e=0;e<l.length;e++)this.data[this.length++]=(l.data||l)[e]}}indexOf(l){const e=this.data.indexOf(l);return e>=this.length?-1:e}contains(l){return this.indexOf(l)!==-1}}ql._GlobalId=0;class Zt extends ql{constructor(){super(...arguments),this._duplicateId=0}push(l){super.push(l),l.__smartArrayFlags||(l.__smartArrayFlags={}),l.__smartArrayFlags[this._id]=this._duplicateId}pushNoDuplicate(l){return l.__smartArrayFlags&&l.__smartArrayFlags[this._id]===this._duplicateId?!1:(this.push(l),!0)}reset(){super.reset(),this._duplicateId++}concatWithNoDuplicate(l){if(l.length!==0){this.length+l.length>this.data.length&&(this.data.length=(this.length+l.length)*2);for(let e=0;e<l.length;e++){const t=(l.data||l)[e];this.pushNoDuplicate(t)}}}}class Cs{constructor(){this._count=0,this._data={}}copyFrom(l){this.clear(),l.forEach((e,t)=>this.add(e,t))}get(l){const e=this._data[l];if(e!==void 0)return e}getOrAddWithFactory(l,e){let t=this.get(l);return t!==void 0||(t=e(l),t&&this.add(l,t)),t}getOrAdd(l,e){const t=this.get(l);return t!==void 0?t:(this.add(l,e),e)}contains(l){return this._data[l]!==void 0}add(l,e){return this._data[l]!==void 0?!1:(this._data[l]=e,++this._count,!0)}set(l,e){return this._data[l]===void 0?!1:(this._data[l]=e,!0)}getAndRemove(l){const e=this.get(l);return e!==void 0?(delete this._data[l],--this._count,e):null}remove(l){return this.contains(l)?(delete this._data[l],--this._count,!0):!1}clear(){this._data={},this._count=0}get count(){return this._count}forEach(l){for(const e in this._data){const t=this._data[e];l(e,t)}}first(l){for(const e in this._data){const t=this._data[e],a=l(e,t);if(a)return a}return null}}class mt{static Eval(l,e){return l.match(/\([^()]*\)/g)?l=l.replace(/\([^()]*\)/g,t=>(t=t.slice(1,t.length-1),mt._HandleParenthesisContent(t,e))):l=mt._HandleParenthesisContent(l,e),l==="true"?!0:l==="false"?!1:mt.Eval(l,e)}static _HandleParenthesisContent(l,e){e=e||(s=>s==="true");let t;const a=l.split("||");for(const s in a)if(Object.prototype.hasOwnProperty.call(a,s)){let d=mt._SimplifyNegation(a[s].trim());const i=d.split("&&");if(i.length>1)for(let c=0;c<i.length;++c){const n=mt._SimplifyNegation(i[c].trim());if(n!=="true"&&n!=="false"?n[0]==="!"?t=!e(n.substring(1)):t=e(n):t=n==="true",!t){d="false";break}}if(t||d==="true"){t=!0;break}d!=="true"&&d!=="false"?d[0]==="!"?t=!e(d.substring(1)):t=e(d):t=d==="true"}return t?"true":"false"}static _SimplifyNegation(l){return l=l.replace(/^[\s!]+/,e=>(e=e.replace(/[\s]/g,()=>""),e.length%2?"!":"")),l=l.trim(),l==="!true"?l="false":l==="!false"&&(l="true"),l}}class ul{static EnableFor(l){l._tags=l._tags||{},l.hasTags=()=>ul.HasTags(l),l.addTags=e=>ul.AddTagsTo(l,e),l.removeTags=e=>ul.RemoveTagsFrom(l,e),l.matchesTagsQuery=e=>ul.MatchesQuery(l,e)}static DisableFor(l){delete l._tags,delete l.hasTags,delete l.addTags,delete l.removeTags,delete l.matchesTagsQuery}static HasTags(l){if(!l._tags)return!1;const e=l._tags;for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1}static GetTags(l,e=!0){if(!l._tags)return null;if(e){const t=[];for(const a in l._tags)Object.prototype.hasOwnProperty.call(l._tags,a)&&l._tags[a]===!0&&t.push(a);return t.join(" ")}else return l._tags}static AddTagsTo(l,e){!e||typeof e!="string"||e.split(" ").forEach(function(t){ul._AddTagTo(l,t)})}static _AddTagTo(l,e){e=e.trim(),!(e===""||e==="true"||e==="false")&&(e.match(/[\s]/)||e.match(/^([!]|([|]|[&]){2})/)||(ul.EnableFor(l),l._tags[e]=!0))}static RemoveTagsFrom(l,e){if(!ul.HasTags(l))return;const t=e.split(" ");for(const a in t)ul._RemoveTagFrom(l,t[a])}static _RemoveTagFrom(l,e){delete l._tags[e]}static MatchesQuery(l,e){return e===void 0?!0:e===""?ul.HasTags(l):mt.Eval(e,t=>ul.HasTags(l)&&l._tags[t])}}class Sa{constructor(){this.rootNodes=new Array,this.cameras=new Array,this.lights=new Array,this.meshes=new Array,this.skeletons=new Array,this.particleSystems=new Array,this.animations=[],this.animationGroups=new Array,this.multiMaterials=new Array,this.materials=new Array,this.morphTargetManagers=new Array,this.geometries=new Array,this.transformNodes=new Array,this.actionManagers=new Array,this.textures=new Array,this._environmentTexture=null,this.postProcesses=new Array}static AddParser(l,e){this._BabylonFileParsers[l]=e}static GetParser(l){return this._BabylonFileParsers[l]?this._BabylonFileParsers[l]:null}static AddIndividualParser(l,e){this._IndividualBabylonFileParsers[l]=e}static GetIndividualParser(l){return this._IndividualBabylonFileParsers[l]?this._IndividualBabylonFileParsers[l]:null}static Parse(l,e,t,a){for(const s in this._BabylonFileParsers)Object.prototype.hasOwnProperty.call(this._BabylonFileParsers,s)&&this._BabylonFileParsers[s](l,e,t,a)}get environmentTexture(){return this._environmentTexture}set environmentTexture(l){this._environmentTexture=l}getNodes(){let l=new Array;return l=l.concat(this.meshes),l=l.concat(this.lights),l=l.concat(this.cameras),l=l.concat(this.transformNodes),this.skeletons.forEach(e=>l=l.concat(e.bones)),l}}Sa._BabylonFileParsers={};Sa._IndividualBabylonFileParsers={};function W(Z,l,e,t){var a=arguments.length,s=a<3?l:t===null?t=Object.getOwnPropertyDescriptor(l,e):t,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(Z,l,e,t);else for(var i=Z.length-1;i>=0;i--)(d=Z[i])&&(s=(a<3?d(s):a>3?d(l,e,s):d(l,e))||s);return a>3&&s&&Object.defineProperty(l,e,s),s}const ha={},aa={},vs=function(Z,l,e){const t=Z();ul&&ul.AddTagsTo(t,l.tags);const a=is(t);for(const s in a){const d=a[s],i=l[s],c=d.type;if(i!=null&&(s!=="uniqueId"||il.AllowLoadingUniqueId))switch(c){case 0:case 6:case 11:t[s]=i;break;case 1:t[s]=e||i.isRenderTarget?i:i.clone();break;case 2:case 3:case 4:case 5:case 7:case 10:case 12:t[s]=e?i:i.clone();break}}return t};function fi(Z){const l=Z.getClassName();return ha[l]||(ha[l]={}),ha[l]}function is(Z){const l=Z.getClassName();if(aa[l])return aa[l];aa[l]={};const e=aa[l];let t=Z,a=l;for(;a;){const s=ha[a];for(const c in s)e[c]=s[c];let d,i=!1;do{if(d=Object.getPrototypeOf(t),!d.getClassName){i=!0;break}if(d.getClassName()!==a)break;t=d}while(d);if(i)break;a=d.getClassName(),t=d}return e}function ze(Z,l){return(e,t)=>{const a=fi(e);a[t]||(a[t]={type:Z,sourceName:l})}}function Ti(Z,l=null){return(e,t)=>{const a=l||"_"+t;Object.defineProperty(e,t,{get:function(){return this[a]},set:function(s){typeof this.equals=="function"&&this.equals(s)||this[a]!==s&&(this[a]=s,e[Z].apply(this))},enumerable:!0,configurable:!0})}}function pl(Z,l=null){return Ti(Z,l)}function F(Z){return ze(0,Z)}function ye(Z){return ze(1,Z)}function Rt(Z){return ze(2,Z)}function At(Z){return ze(3,Z)}function zi(Z){return ze(4,Z)}function _e(Z){return ze(5,Z)}function Mi(Z){return ze(6,Z)}function gi(Z){return ze(7,Z)}function pd(Z){return ze(8,Z)}function Ci(Z){return ze(10,Z)}class il{static AppendSerializedAnimations(l,e){if(l.animations){e.animations=[];for(let t=0;t<l.animations.length;t++){const a=l.animations[t];e.animations.push(a.serialize())}}}static Serialize(l,e){e||(e={}),ul&&(e.tags=ul.GetTags(l));const t=is(l);for(const a in t){const s=t[a],d=s.sourceName||a,i=s.type,c=l[a];if(c!=null&&(a!=="uniqueId"||il.AllowLoadingUniqueId))switch(i){case 0:e[d]=c;break;case 1:e[d]=c.serialize();break;case 2:e[d]=c.asArray();break;case 3:e[d]=c.serialize();break;case 4:e[d]=c.asArray();break;case 5:e[d]=c.asArray();break;case 6:e[d]=c.id;break;case 7:e[d]=c.serialize();break;case 8:e[d]=c.asArray();break;case 9:e[d]=c.serialize();break;case 10:e[d]=c.asArray();break;case 11:e[d]=c.id;break;case 12:e[d]=c.asArray();break}}return e}static Parse(l,e,t,a=null){const s=l();a||(a=""),ul&&ul.AddTagsTo(s,e.tags);const d=is(s);for(const i in d){const c=d[i],n=e[c.sourceName||i],h=c.type;if(n!=null&&(i!=="uniqueId"||il.AllowLoadingUniqueId)){const m=s;switch(h){case 0:m[i]=n;break;case 1:t&&(m[i]=il._TextureParser(n,t,a));break;case 2:m[i]=al.FromArray(n);break;case 3:m[i]=il._FresnelParametersParser(n);break;case 4:m[i]=Wl.FromArray(n);break;case 5:m[i]=r.FromArray(n);break;case 6:t&&(m[i]=t.getLastMeshById(n));break;case 7:m[i]=il._ColorCurvesParser(n);break;case 8:m[i]=Gl.FromArray(n);break;case 9:m[i]=il._ImageProcessingConfigurationParser(n);break;case 10:m[i]=_.FromArray(n);break;case 11:t&&(m[i]=t.getCameraById(n));break;case 12:m[i]=Y.FromArray(n);break}}}return s}static Clone(l,e){return vs(l,e,!1)}static Instanciate(l,e){return vs(l,e,!0)}}il.AllowLoadingUniqueId=!1;il._ImageProcessingConfigurationParser=Z=>{throw O("ImageProcessingConfiguration")};il._FresnelParametersParser=Z=>{throw O("FresnelParameters")};il._ColorCurvesParser=Z=>{throw O("ColorCurves")};il._TextureParser=(Z,l,e)=>{throw O("Texture")};function st(Z,l,e,t){const a=e.value;e.value=(...s)=>{let d=a;if(typeof _native<"u"&&_native[l]){const i=_native[l];t?d=(...c)=>t(...c)?i(...c):a(...c):d=i}return Z[l]=d,d(...s)}}st.filter=function(Z){return(l,e,t)=>st(l,e,t,Z)};class Ys{constructor(l){if(this._keys=[],this._isDirty=!0,this._areLightsDirty=!0,this._areLightsDisposed=!1,this._areAttributesDirty=!0,this._areTexturesDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!0,this._areImageProcessingDirty=!0,this._normals=!1,this._uvs=!1,this._needNormals=!1,this._needUVs=!1,this._externalProperties=l,l)for(const e in l)Object.prototype.hasOwnProperty.call(l,e)&&this._setDefaultValue(e)}get isDirty(){return this._isDirty}markAsProcessed(){this._isDirty=!1,this._areAttributesDirty=!1,this._areTexturesDirty=!1,this._areFresnelDirty=!1,this._areLightsDirty=!1,this._areLightsDisposed=!1,this._areMiscDirty=!1,this._arePrePassDirty=!1,this._areImageProcessingDirty=!1}markAsUnprocessed(){this._isDirty=!0}markAllAsDirty(){this._areTexturesDirty=!0,this._areAttributesDirty=!0,this._areLightsDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._areImageProcessingDirty=!0,this._isDirty=!0}markAsImageProcessingDirty(){this._areImageProcessingDirty=!0,this._isDirty=!0}markAsLightDirty(l=!1){this._areLightsDirty=!0,this._areLightsDisposed=this._areLightsDisposed||l,this._isDirty=!0}markAsAttributesDirty(){this._areAttributesDirty=!0,this._isDirty=!0}markAsTexturesDirty(){this._areTexturesDirty=!0,this._isDirty=!0}markAsFresnelDirty(){this._areFresnelDirty=!0,this._isDirty=!0}markAsMiscDirty(){this._areMiscDirty=!0,this._isDirty=!0}markAsPrePassDirty(){this._arePrePassDirty=!0,this._isDirty=!0}rebuild(){this._keys.length=0;for(const l of Object.keys(this))l[0]!=="_"&&this._keys.push(l);if(this._externalProperties)for(const l in this._externalProperties)this._keys.indexOf(l)===-1&&this._keys.push(l)}isEqual(l){if(this._keys.length!==l._keys.length)return!1;for(let e=0;e<this._keys.length;e++){const t=this._keys[e];if(this[t]!==l[t])return!1}return!0}cloneTo(l){this._keys.length!==l._keys.length&&(l._keys=this._keys.slice(0));for(let e=0;e<this._keys.length;e++){const t=this._keys[e];l[t]=this[t]}}reset(){this._keys.forEach(l=>this._setDefaultValue(l))}_setDefaultValue(l){var e,t,a,s,d;const i=(a=(t=(e=this._externalProperties)===null||e===void 0?void 0:e[l])===null||t===void 0?void 0:t.type)!==null&&a!==void 0?a:typeof this[l],c=(d=(s=this._externalProperties)===null||s===void 0?void 0:s[l])===null||d===void 0?void 0:d.default;switch(i){case"number":this[l]=c??0;break;case"string":this[l]=c??"";break;default:this[l]=c??!1;break}}toString(){let l="";for(let e=0;e<this._keys.length;e++){const t=this._keys[e],a=this[t];switch(typeof a){case"number":case"string":l+="#define "+t+" "+a+`
`;break;default:a&&(l+="#define "+t+`
`);break}}return l}}class Yl{constructor(){this._dirty=!0,this._tempColor=new Gl(0,0,0,0),this._globalCurve=new Gl(0,0,0,0),this._highlightsCurve=new Gl(0,0,0,0),this._midtonesCurve=new Gl(0,0,0,0),this._shadowsCurve=new Gl(0,0,0,0),this._positiveCurve=new Gl(0,0,0,0),this._negativeCurve=new Gl(0,0,0,0),this._globalHue=30,this._globalDensity=0,this._globalSaturation=0,this._globalExposure=0,this._highlightsHue=30,this._highlightsDensity=0,this._highlightsSaturation=0,this._highlightsExposure=0,this._midtonesHue=30,this._midtonesDensity=0,this._midtonesSaturation=0,this._midtonesExposure=0,this._shadowsHue=30,this._shadowsDensity=0,this._shadowsSaturation=0,this._shadowsExposure=0}get globalHue(){return this._globalHue}set globalHue(l){this._globalHue=l,this._dirty=!0}get globalDensity(){return this._globalDensity}set globalDensity(l){this._globalDensity=l,this._dirty=!0}get globalSaturation(){return this._globalSaturation}set globalSaturation(l){this._globalSaturation=l,this._dirty=!0}get globalExposure(){return this._globalExposure}set globalExposure(l){this._globalExposure=l,this._dirty=!0}get highlightsHue(){return this._highlightsHue}set highlightsHue(l){this._highlightsHue=l,this._dirty=!0}get highlightsDensity(){return this._highlightsDensity}set highlightsDensity(l){this._highlightsDensity=l,this._dirty=!0}get highlightsSaturation(){return this._highlightsSaturation}set highlightsSaturation(l){this._highlightsSaturation=l,this._dirty=!0}get highlightsExposure(){return this._highlightsExposure}set highlightsExposure(l){this._highlightsExposure=l,this._dirty=!0}get midtonesHue(){return this._midtonesHue}set midtonesHue(l){this._midtonesHue=l,this._dirty=!0}get midtonesDensity(){return this._midtonesDensity}set midtonesDensity(l){this._midtonesDensity=l,this._dirty=!0}get midtonesSaturation(){return this._midtonesSaturation}set midtonesSaturation(l){this._midtonesSaturation=l,this._dirty=!0}get midtonesExposure(){return this._midtonesExposure}set midtonesExposure(l){this._midtonesExposure=l,this._dirty=!0}get shadowsHue(){return this._shadowsHue}set shadowsHue(l){this._shadowsHue=l,this._dirty=!0}get shadowsDensity(){return this._shadowsDensity}set shadowsDensity(l){this._shadowsDensity=l,this._dirty=!0}get shadowsSaturation(){return this._shadowsSaturation}set shadowsSaturation(l){this._shadowsSaturation=l,this._dirty=!0}get shadowsExposure(){return this._shadowsExposure}set shadowsExposure(l){this._shadowsExposure=l,this._dirty=!0}getClassName(){return"ColorCurves"}static Bind(l,e,t="vCameraColorCurvePositive",a="vCameraColorCurveNeutral",s="vCameraColorCurveNegative"){l._dirty&&(l._dirty=!1,l._getColorGradingDataToRef(l._globalHue,l._globalDensity,l._globalSaturation,l._globalExposure,l._globalCurve),l._getColorGradingDataToRef(l._highlightsHue,l._highlightsDensity,l._highlightsSaturation,l._highlightsExposure,l._tempColor),l._tempColor.multiplyToRef(l._globalCurve,l._highlightsCurve),l._getColorGradingDataToRef(l._midtonesHue,l._midtonesDensity,l._midtonesSaturation,l._midtonesExposure,l._tempColor),l._tempColor.multiplyToRef(l._globalCurve,l._midtonesCurve),l._getColorGradingDataToRef(l._shadowsHue,l._shadowsDensity,l._shadowsSaturation,l._shadowsExposure,l._tempColor),l._tempColor.multiplyToRef(l._globalCurve,l._shadowsCurve),l._highlightsCurve.subtractToRef(l._midtonesCurve,l._positiveCurve),l._midtonesCurve.subtractToRef(l._shadowsCurve,l._negativeCurve)),e&&(e.setFloat4(t,l._positiveCurve.r,l._positiveCurve.g,l._positiveCurve.b,l._positiveCurve.a),e.setFloat4(a,l._midtonesCurve.r,l._midtonesCurve.g,l._midtonesCurve.b,l._midtonesCurve.a),e.setFloat4(s,l._negativeCurve.r,l._negativeCurve.g,l._negativeCurve.b,l._negativeCurve.a))}static PrepareUniforms(l){l.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")}_getColorGradingDataToRef(l,e,t,a,s){l!=null&&(l=Yl._Clamp(l,0,360),e=Yl._Clamp(e,-100,100),t=Yl._Clamp(t,-100,100),a=Yl._Clamp(a,-100,100),e=Yl._ApplyColorGradingSliderNonlinear(e),e*=.5,a=Yl._ApplyColorGradingSliderNonlinear(a),e<0&&(e*=-1,l=(l+180)%360),Yl._FromHSBToRef(l,e,50+.25*a,s),s.scaleToRef(2,s),s.a=1+.01*t)}static _ApplyColorGradingSliderNonlinear(l){l/=100;let e=Math.abs(l);return e=Math.pow(e,2),l<0&&(e*=-1),e*=100,e}static _FromHSBToRef(l,e,t,a){let s=Yl._Clamp(l,0,360);const d=Yl._Clamp(e/100,0,1),i=Yl._Clamp(t/100,0,1);if(d===0)a.r=i,a.g=i,a.b=i;else{s/=60;const c=Math.floor(s),n=s-c,h=i*(1-d),m=i*(1-d*n),o=i*(1-d*(1-n));switch(c){case 0:a.r=i,a.g=o,a.b=h;break;case 1:a.r=m,a.g=i,a.b=h;break;case 2:a.r=h,a.g=i,a.b=o;break;case 3:a.r=h,a.g=m,a.b=i;break;case 4:a.r=o,a.g=h,a.b=i;break;default:a.r=i,a.g=h,a.b=m;break}}a.a=1}static _Clamp(l,e,t){return Math.min(Math.max(l,e),t)}clone(){return il.Clone(()=>new Yl,this)}serialize(){return il.Serialize(this)}static Parse(l){return il.Parse(()=>new Yl,l,null,null)}}W([F()],Yl.prototype,"_globalHue",void 0);W([F()],Yl.prototype,"_globalDensity",void 0);W([F()],Yl.prototype,"_globalSaturation",void 0);W([F()],Yl.prototype,"_globalExposure",void 0);W([F()],Yl.prototype,"_highlightsHue",void 0);W([F()],Yl.prototype,"_highlightsDensity",void 0);W([F()],Yl.prototype,"_highlightsSaturation",void 0);W([F()],Yl.prototype,"_highlightsExposure",void 0);W([F()],Yl.prototype,"_midtonesHue",void 0);W([F()],Yl.prototype,"_midtonesDensity",void 0);W([F()],Yl.prototype,"_midtonesSaturation",void 0);W([F()],Yl.prototype,"_midtonesExposure",void 0);il._ColorCurvesParser=Yl.Parse;class rl{constructor(){this.colorCurves=new Yl,this._colorCurvesEnabled=!1,this._colorGradingEnabled=!1,this._colorGradingWithGreenDepth=!0,this._colorGradingBGR=!0,this._exposure=1,this._toneMappingEnabled=!1,this._toneMappingType=rl.TONEMAPPING_STANDARD,this._contrast=1,this.vignetteStretch=0,this.vignetteCenterX=0,this.vignetteCenterY=0,this.vignetteWeight=1.5,this.vignetteColor=new Gl(0,0,0,0),this.vignetteCameraFov=.5,this._vignetteBlendMode=rl.VIGNETTEMODE_MULTIPLY,this._vignetteEnabled=!1,this._ditheringEnabled=!1,this._ditheringIntensity=1/255,this._skipFinalColorClamp=!1,this._applyByPostProcess=!1,this._isEnabled=!0,this.onUpdateParameters=new z}get colorCurvesEnabled(){return this._colorCurvesEnabled}set colorCurvesEnabled(l){this._colorCurvesEnabled!==l&&(this._colorCurvesEnabled=l,this._updateParameters())}get colorGradingTexture(){return this._colorGradingTexture}set colorGradingTexture(l){this._colorGradingTexture!==l&&(this._colorGradingTexture=l,this._updateParameters())}get colorGradingEnabled(){return this._colorGradingEnabled}set colorGradingEnabled(l){this._colorGradingEnabled!==l&&(this._colorGradingEnabled=l,this._updateParameters())}get colorGradingWithGreenDepth(){return this._colorGradingWithGreenDepth}set colorGradingWithGreenDepth(l){this._colorGradingWithGreenDepth!==l&&(this._colorGradingWithGreenDepth=l,this._updateParameters())}get colorGradingBGR(){return this._colorGradingBGR}set colorGradingBGR(l){this._colorGradingBGR!==l&&(this._colorGradingBGR=l,this._updateParameters())}get exposure(){return this._exposure}set exposure(l){this._exposure!==l&&(this._exposure=l,this._updateParameters())}get toneMappingEnabled(){return this._toneMappingEnabled}set toneMappingEnabled(l){this._toneMappingEnabled!==l&&(this._toneMappingEnabled=l,this._updateParameters())}get toneMappingType(){return this._toneMappingType}set toneMappingType(l){this._toneMappingType!==l&&(this._toneMappingType=l,this._updateParameters())}get contrast(){return this._contrast}set contrast(l){this._contrast!==l&&(this._contrast=l,this._updateParameters())}get vignetteCentreY(){return this.vignetteCenterY}set vignetteCentreY(l){this.vignetteCenterY=l}get vignetteCentreX(){return this.vignetteCenterX}set vignetteCentreX(l){this.vignetteCenterX=l}get vignetteBlendMode(){return this._vignetteBlendMode}set vignetteBlendMode(l){this._vignetteBlendMode!==l&&(this._vignetteBlendMode=l,this._updateParameters())}get vignetteEnabled(){return this._vignetteEnabled}set vignetteEnabled(l){this._vignetteEnabled!==l&&(this._vignetteEnabled=l,this._updateParameters())}get ditheringEnabled(){return this._ditheringEnabled}set ditheringEnabled(l){this._ditheringEnabled!==l&&(this._ditheringEnabled=l,this._updateParameters())}get ditheringIntensity(){return this._ditheringIntensity}set ditheringIntensity(l){this._ditheringIntensity!==l&&(this._ditheringIntensity=l,this._updateParameters())}get skipFinalColorClamp(){return this._skipFinalColorClamp}set skipFinalColorClamp(l){this._skipFinalColorClamp!==l&&(this._skipFinalColorClamp=l,this._updateParameters())}get applyByPostProcess(){return this._applyByPostProcess}set applyByPostProcess(l){this._applyByPostProcess!==l&&(this._applyByPostProcess=l,this._updateParameters())}get isEnabled(){return this._isEnabled}set isEnabled(l){this._isEnabled!==l&&(this._isEnabled=l,this._updateParameters())}_updateParameters(){this.onUpdateParameters.notifyObservers(this)}getClassName(){return"ImageProcessingConfiguration"}static PrepareUniforms(l,e){e.EXPOSURE&&l.push("exposureLinear"),e.CONTRAST&&l.push("contrast"),e.COLORGRADING&&l.push("colorTransformSettings"),(e.VIGNETTE||e.DITHER)&&l.push("vInverseScreenSize"),e.VIGNETTE&&(l.push("vignetteSettings1"),l.push("vignetteSettings2")),e.COLORCURVES&&Yl.PrepareUniforms(l),e.DITHER&&l.push("ditherIntensity")}static PrepareSamplers(l,e){e.COLORGRADING&&l.push("txColorTransform")}prepareDefines(l,e=!1){if(e!==this.applyByPostProcess||!this._isEnabled){l.VIGNETTE=!1,l.TONEMAPPING=!1,l.TONEMAPPING_ACES=!1,l.CONTRAST=!1,l.EXPOSURE=!1,l.COLORCURVES=!1,l.COLORGRADING=!1,l.COLORGRADING3D=!1,l.DITHER=!1,l.IMAGEPROCESSING=!1,l.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,l.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess&&this._isEnabled;return}switch(l.VIGNETTE=this.vignetteEnabled,l.VIGNETTEBLENDMODEMULTIPLY=this.vignetteBlendMode===rl._VIGNETTEMODE_MULTIPLY,l.VIGNETTEBLENDMODEOPAQUE=!l.VIGNETTEBLENDMODEMULTIPLY,l.TONEMAPPING=this.toneMappingEnabled,this._toneMappingType){case rl.TONEMAPPING_ACES:l.TONEMAPPING_ACES=!0;break;default:l.TONEMAPPING_ACES=!1;break}l.CONTRAST=this.contrast!==1,l.EXPOSURE=this.exposure!==1,l.COLORCURVES=this.colorCurvesEnabled&&!!this.colorCurves,l.COLORGRADING=this.colorGradingEnabled&&!!this.colorGradingTexture,l.COLORGRADING?l.COLORGRADING3D=this.colorGradingTexture.is3D:l.COLORGRADING3D=!1,l.SAMPLER3DGREENDEPTH=this.colorGradingWithGreenDepth,l.SAMPLER3DBGRMAP=this.colorGradingBGR,l.DITHER=this._ditheringEnabled,l.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess,l.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,l.IMAGEPROCESSING=l.VIGNETTE||l.TONEMAPPING||l.CONTRAST||l.EXPOSURE||l.COLORCURVES||l.COLORGRADING||l.DITHER}isReady(){return!this.colorGradingEnabled||!this.colorGradingTexture||this.colorGradingTexture.isReady()}bind(l,e){if(this._colorCurvesEnabled&&this.colorCurves&&Yl.Bind(this.colorCurves,l),this._vignetteEnabled||this._ditheringEnabled){const t=1/l.getEngine().getRenderWidth(),a=1/l.getEngine().getRenderHeight();if(l.setFloat2("vInverseScreenSize",t,a),this._ditheringEnabled&&l.setFloat("ditherIntensity",.5*this._ditheringIntensity),this._vignetteEnabled){const s=e??a/t;let d=Math.tan(this.vignetteCameraFov*.5),i=d*s;const c=Math.sqrt(i*d);i=Q.Mix(i,c,this.vignetteStretch),d=Q.Mix(d,c,this.vignetteStretch),l.setFloat4("vignetteSettings1",i,d,-i*this.vignetteCenterX,-d*this.vignetteCenterY);const n=-2*this.vignetteWeight;l.setFloat4("vignetteSettings2",this.vignetteColor.r,this.vignetteColor.g,this.vignetteColor.b,n)}}if(l.setFloat("exposureLinear",this.exposure),l.setFloat("contrast",this.contrast),this.colorGradingTexture){l.setTexture("txColorTransform",this.colorGradingTexture);const t=this.colorGradingTexture.getSize().height;l.setFloat4("colorTransformSettings",(t-1)/t,.5/t,t,this.colorGradingTexture.level)}}clone(){return il.Clone(()=>new rl,this)}serialize(){return il.Serialize(this)}static Parse(l){const e=il.Parse(()=>new rl,l,null,null);return l.vignetteCentreX!==void 0&&(e.vignetteCenterX=l.vignetteCentreX),l.vignetteCentreY!==void 0&&(e.vignetteCenterY=l.vignetteCentreY),e}static get VIGNETTEMODE_MULTIPLY(){return this._VIGNETTEMODE_MULTIPLY}static get VIGNETTEMODE_OPAQUE(){return this._VIGNETTEMODE_OPAQUE}}rl.TONEMAPPING_STANDARD=0;rl.TONEMAPPING_ACES=1;rl._VIGNETTEMODE_MULTIPLY=0;rl._VIGNETTEMODE_OPAQUE=1;W([gi()],rl.prototype,"colorCurves",void 0);W([F()],rl.prototype,"_colorCurvesEnabled",void 0);W([ye("colorGradingTexture")],rl.prototype,"_colorGradingTexture",void 0);W([F()],rl.prototype,"_colorGradingEnabled",void 0);W([F()],rl.prototype,"_colorGradingWithGreenDepth",void 0);W([F()],rl.prototype,"_colorGradingBGR",void 0);W([F()],rl.prototype,"_exposure",void 0);W([F()],rl.prototype,"_toneMappingEnabled",void 0);W([F()],rl.prototype,"_toneMappingType",void 0);W([F()],rl.prototype,"_contrast",void 0);W([F()],rl.prototype,"vignetteStretch",void 0);W([F()],rl.prototype,"vignetteCenterX",void 0);W([F()],rl.prototype,"vignetteCenterY",void 0);W([F()],rl.prototype,"vignetteWeight",void 0);W([pd()],rl.prototype,"vignetteColor",void 0);W([F()],rl.prototype,"vignetteCameraFov",void 0);W([F()],rl.prototype,"_vignetteBlendMode",void 0);W([F()],rl.prototype,"_vignetteEnabled",void 0);W([F()],rl.prototype,"_ditheringEnabled",void 0);W([F()],rl.prototype,"_ditheringIntensity",void 0);W([F()],rl.prototype,"_skipFinalColorClamp",void 0);W([F()],rl.prototype,"_applyByPostProcess",void 0);W([F()],rl.prototype,"_isEnabled",void 0);il._ImageProcessingConfigurationParser=rl.Parse;Zl.prototype.createUniformBuffer=function(Z){const l=this._gl.createBuffer();if(!l)throw new Error("Unable to create uniform buffer");const e=new Pt(l);return this.bindUniformBuffer(e),Z instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,Z,this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(Z),this._gl.STATIC_DRAW),this.bindUniformBuffer(null),e.references=1,e};Zl.prototype.createDynamicUniformBuffer=function(Z){const l=this._gl.createBuffer();if(!l)throw new Error("Unable to create dynamic uniform buffer");const e=new Pt(l);return this.bindUniformBuffer(e),Z instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,Z,this._gl.DYNAMIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(Z),this._gl.DYNAMIC_DRAW),this.bindUniformBuffer(null),e.references=1,e};Zl.prototype.updateUniformBuffer=function(Z,l,e,t){this.bindUniformBuffer(Z),e===void 0&&(e=0),t===void 0?l instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,e,l):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,e,new Float32Array(l)):l instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,l.subarray(e,e+t)):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,new Float32Array(l).subarray(e,e+t)),this.bindUniformBuffer(null)};Zl.prototype.bindUniformBuffer=function(Z){this._gl.bindBuffer(this._gl.UNIFORM_BUFFER,Z?Z.underlyingResource:null)};Zl.prototype.bindUniformBufferBase=function(Z,l,e){this._gl.bindBufferBase(this._gl.UNIFORM_BUFFER,l,Z?Z.underlyingResource:null)};Zl.prototype.bindUniformBlock=function(Z,l,e){const t=Z.program,a=this._gl.getUniformBlockIndex(t,l);a!==4294967295&&this._gl.uniformBlockBinding(t,a,e)};class I{constructor(l,e,t,a,s=!1){this._valueCache={},this._engine=l,this._noUBO=!l.supportsUniformBuffers||s,this._dynamic=t,this._name=a??"no-name",this._data=e||[],this._uniformLocations={},this._uniformSizes={},this._uniformArraySizes={},this._uniformLocationPointer=0,this._needSync=!1,this._engine._features.trackUbosInFrame&&(this._buffers=[],this._bufferIndex=-1,this._createBufferOnWrite=!1,this._currentFrameId=0),this._noUBO?(this.updateMatrix3x3=this._updateMatrix3x3ForEffect,this.updateMatrix2x2=this._updateMatrix2x2ForEffect,this.updateFloat=this._updateFloatForEffect,this.updateFloat2=this._updateFloat2ForEffect,this.updateFloat3=this._updateFloat3ForEffect,this.updateFloat4=this._updateFloat4ForEffect,this.updateFloatArray=this._updateFloatArrayForEffect,this.updateArray=this._updateArrayForEffect,this.updateIntArray=this._updateIntArrayForEffect,this.updateUIntArray=this._updateUIntArrayForEffect,this.updateMatrix=this._updateMatrixForEffect,this.updateMatrices=this._updateMatricesForEffect,this.updateVector3=this._updateVector3ForEffect,this.updateVector4=this._updateVector4ForEffect,this.updateColor3=this._updateColor3ForEffect,this.updateColor4=this._updateColor4ForEffect,this.updateDirectColor4=this._updateDirectColor4ForEffect,this.updateInt=this._updateIntForEffect,this.updateInt2=this._updateInt2ForEffect,this.updateInt3=this._updateInt3ForEffect,this.updateInt4=this._updateInt4ForEffect,this.updateUInt=this._updateUIntForEffect,this.updateUInt2=this._updateUInt2ForEffect,this.updateUInt3=this._updateUInt3ForEffect,this.updateUInt4=this._updateUInt4ForEffect):(this._engine._uniformBuffers.push(this),this.updateMatrix3x3=this._updateMatrix3x3ForUniform,this.updateMatrix2x2=this._updateMatrix2x2ForUniform,this.updateFloat=this._updateFloatForUniform,this.updateFloat2=this._updateFloat2ForUniform,this.updateFloat3=this._updateFloat3ForUniform,this.updateFloat4=this._updateFloat4ForUniform,this.updateFloatArray=this._updateFloatArrayForUniform,this.updateArray=this._updateArrayForUniform,this.updateIntArray=this._updateIntArrayForUniform,this.updateUIntArray=this._updateUIntArrayForUniform,this.updateMatrix=this._updateMatrixForUniform,this.updateMatrices=this._updateMatricesForUniform,this.updateVector3=this._updateVector3ForUniform,this.updateVector4=this._updateVector4ForUniform,this.updateColor3=this._updateColor3ForUniform,this.updateColor4=this._updateColor4ForUniform,this.updateDirectColor4=this._updateDirectColor4ForUniform,this.updateInt=this._updateIntForUniform,this.updateInt2=this._updateInt2ForUniform,this.updateInt3=this._updateInt3ForUniform,this.updateInt4=this._updateInt4ForUniform,this.updateUInt=this._updateUIntForUniform,this.updateUInt2=this._updateUInt2ForUniform,this.updateUInt3=this._updateUInt3ForUniform,this.updateUInt4=this._updateUInt4ForUniform)}get useUbo(){return!this._noUBO}get isSync(){return!this._needSync}isDynamic(){return this._dynamic!==void 0}getData(){return this._bufferData}getBuffer(){return this._buffer}_fillAlignment(l){let e;if(l<=2?e=l:e=4,this._uniformLocationPointer%e!==0){const t=this._uniformLocationPointer;this._uniformLocationPointer+=e-this._uniformLocationPointer%e;const a=this._uniformLocationPointer-t;for(let s=0;s<a;s++)this._data.push(0)}}addUniform(l,e,t=0){if(this._noUBO||this._uniformLocations[l]!==void 0)return;let a;if(t>0){if(e instanceof Array)throw"addUniform should not be use with Array in UBO: "+l;if(this._fillAlignment(4),this._uniformArraySizes[l]={strideSize:e,arraySize:t},e==16)e=e*t;else{const s=(4-e)*t;e=e*t+s}a=[];for(let s=0;s<e;s++)a.push(0)}else{if(e instanceof Array)a=e,e=a.length;else{e=e,a=[];for(let s=0;s<e;s++)a.push(0)}this._fillAlignment(e)}this._uniformSizes[l]=e,this._uniformLocations[l]=this._uniformLocationPointer,this._uniformLocationPointer+=e;for(let s=0;s<e;s++)this._data.push(a[s]);this._needSync=!0}addMatrix(l,e){this.addUniform(l,Array.prototype.slice.call(e.toArray()))}addFloat2(l,e,t){const a=[e,t];this.addUniform(l,a)}addFloat3(l,e,t,a){const s=[e,t,a];this.addUniform(l,s)}addColor3(l,e){const t=[e.r,e.g,e.b];this.addUniform(l,t)}addColor4(l,e,t){const a=[e.r,e.g,e.b,t];this.addUniform(l,a)}addVector3(l,e){const t=[e.x,e.y,e.z];this.addUniform(l,t)}addMatrix3x3(l){this.addUniform(l,12)}addMatrix2x2(l){this.addUniform(l,8)}create(){this._noUBO||this._buffer||(this._fillAlignment(4),this._bufferData=new Float32Array(this._data),this._rebuild(),this._needSync=!0)}_rebuild(){this._noUBO||!this._bufferData||(this._dynamic?this._buffer=this._engine.createDynamicUniformBuffer(this._bufferData):this._buffer=this._engine.createUniformBuffer(this._bufferData),this._engine._features.trackUbosInFrame&&(this._buffers.push([this._buffer,this._engine._features.checkUbosContentBeforeUpload?this._bufferData.slice():void 0]),this._bufferIndex=this._buffers.length-1,this._createBufferOnWrite=!1))}get _numBuffers(){return this._buffers.length}get _indexBuffer(){return this._bufferIndex}get name(){return this._name}_buffersEqual(l,e){for(let t=0;t<l.length;++t)if(l[t]!==e[t])return!1;return!0}_copyBuffer(l,e){for(let t=0;t<l.length;++t)e[t]=l[t]}update(){if(!this._noUBO){if(this.bindUniformBuffer(),!this._buffer){this.create();return}if(!this._dynamic&&!this._needSync){this._createBufferOnWrite=this._engine._features.trackUbosInFrame;return}if(this._buffers&&this._buffers.length>1&&this._buffers[this._bufferIndex][1])if(this._buffersEqual(this._bufferData,this._buffers[this._bufferIndex][1])){this._needSync=!1,this._createBufferOnWrite=this._engine._features.trackUbosInFrame;return}else this._copyBuffer(this._bufferData,this._buffers[this._bufferIndex][1]);this._engine.updateUniformBuffer(this._buffer,this._bufferData),this._engine._features._collectUbosUpdatedInFrame&&(I._UpdatedUbosInFrame[this._name]||(I._UpdatedUbosInFrame[this._name]=0),I._UpdatedUbosInFrame[this._name]++),this._needSync=!1,this._createBufferOnWrite=this._engine._features.trackUbosInFrame}}_createNewBuffer(){this._bufferIndex+1<this._buffers.length?(this._bufferIndex++,this._buffer=this._buffers[this._bufferIndex][0],this._createBufferOnWrite=!1,this._needSync=!0):this._rebuild()}_checkNewFrame(){this._engine._features.trackUbosInFrame&&this._currentFrameId!==this._engine.frameId&&(this._currentFrameId=this._engine.frameId,this._createBufferOnWrite=!1,this._buffers&&this._buffers.length>0?(this._needSync=this._bufferIndex!==0,this._bufferIndex=0,this._buffer=this._buffers[this._bufferIndex][0]):this._bufferIndex=-1)}updateUniform(l,e,t){this._checkNewFrame();let a=this._uniformLocations[l];if(a===void 0){if(this._buffer){M.Error("Cannot add an uniform after UBO has been created.");return}this.addUniform(l,t),a=this._uniformLocations[l]}if(this._buffer||this.create(),this._dynamic)for(let s=0;s<t;s++)this._bufferData[a+s]=e[s];else{let s=!1;for(let d=0;d<t;d++)(t===16&&!this._engine._features.uniformBufferHardCheckMatrix||this._bufferData[a+d]!==Q.FloatRound(e[d]))&&(s=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[a+d]=e[d]);this._needSync=this._needSync||s}}updateUniformArray(l,e,t){this._checkNewFrame();const a=this._uniformLocations[l];if(a===void 0){M.Error("Cannot add an uniform Array dynamically. Please, add it using addUniform and make sure that uniform buffers are supported by the current engine.");return}this._buffer||this.create();const s=this._uniformArraySizes[l];if(this._dynamic)for(let d=0;d<t;d++)this._bufferData[a+d]=e[d];else{let d=!1,i=0,c=0;for(let n=0;n<t;n++)if(this._bufferData[a+c*4+i]!==Q.FloatRound(e[n])&&(d=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[a+c*4+i]=e[n]),i++,i===s.strideSize){for(;i<4;i++)this._bufferData[a+c*4+i]=0;i=0,c++}this._needSync=this._needSync||d}}_cacheMatrix(l,e){this._checkNewFrame();const t=this._valueCache[l],a=e.updateFlag;return t!==void 0&&t===a?!1:(this._valueCache[l]=a,!0)}_updateMatrix3x3ForUniform(l,e){for(let t=0;t<3;t++)I._TempBuffer[t*4]=e[t*3],I._TempBuffer[t*4+1]=e[t*3+1],I._TempBuffer[t*4+2]=e[t*3+2],I._TempBuffer[t*4+3]=0;this.updateUniform(l,I._TempBuffer,12)}_updateMatrix3x3ForEffect(l,e){this._currentEffect.setMatrix3x3(l,e)}_updateMatrix2x2ForEffect(l,e){this._currentEffect.setMatrix2x2(l,e)}_updateMatrix2x2ForUniform(l,e){for(let t=0;t<2;t++)I._TempBuffer[t*4]=e[t*2],I._TempBuffer[t*4+1]=e[t*2+1],I._TempBuffer[t*4+2]=0,I._TempBuffer[t*4+3]=0;this.updateUniform(l,I._TempBuffer,8)}_updateFloatForEffect(l,e){this._currentEffect.setFloat(l,e)}_updateFloatForUniform(l,e){I._TempBuffer[0]=e,this.updateUniform(l,I._TempBuffer,1)}_updateFloat2ForEffect(l,e,t,a=""){this._currentEffect.setFloat2(l+a,e,t)}_updateFloat2ForUniform(l,e,t){I._TempBuffer[0]=e,I._TempBuffer[1]=t,this.updateUniform(l,I._TempBuffer,2)}_updateFloat3ForEffect(l,e,t,a,s=""){this._currentEffect.setFloat3(l+s,e,t,a)}_updateFloat3ForUniform(l,e,t,a){I._TempBuffer[0]=e,I._TempBuffer[1]=t,I._TempBuffer[2]=a,this.updateUniform(l,I._TempBuffer,3)}_updateFloat4ForEffect(l,e,t,a,s,d=""){this._currentEffect.setFloat4(l+d,e,t,a,s)}_updateFloat4ForUniform(l,e,t,a,s){I._TempBuffer[0]=e,I._TempBuffer[1]=t,I._TempBuffer[2]=a,I._TempBuffer[3]=s,this.updateUniform(l,I._TempBuffer,4)}_updateFloatArrayForEffect(l,e){this._currentEffect.setFloatArray(l,e)}_updateFloatArrayForUniform(l,e){this.updateUniformArray(l,e,e.length)}_updateArrayForEffect(l,e){this._currentEffect.setArray(l,e)}_updateArrayForUniform(l,e){this.updateUniformArray(l,e,e.length)}_updateIntArrayForEffect(l,e){this._currentEffect.setIntArray(l,e)}_updateIntArrayForUniform(l,e){I._TempBufferInt32View.set(e),this.updateUniformArray(l,I._TempBuffer,e.length)}_updateUIntArrayForEffect(l,e){this._currentEffect.setUIntArray(l,e)}_updateUIntArrayForUniform(l,e){I._TempBufferUInt32View.set(e),this.updateUniformArray(l,I._TempBuffer,e.length)}_updateMatrixForEffect(l,e){this._currentEffect.setMatrix(l,e)}_updateMatrixForUniform(l,e){this._cacheMatrix(l,e)&&this.updateUniform(l,e.toArray(),16)}_updateMatricesForEffect(l,e){this._currentEffect.setMatrices(l,e)}_updateMatricesForUniform(l,e){this.updateUniform(l,e,e.length)}_updateVector3ForEffect(l,e){this._currentEffect.setVector3(l,e)}_updateVector3ForUniform(l,e){I._TempBuffer[0]=e.x,I._TempBuffer[1]=e.y,I._TempBuffer[2]=e.z,this.updateUniform(l,I._TempBuffer,3)}_updateVector4ForEffect(l,e){this._currentEffect.setVector4(l,e)}_updateVector4ForUniform(l,e){I._TempBuffer[0]=e.x,I._TempBuffer[1]=e.y,I._TempBuffer[2]=e.z,I._TempBuffer[3]=e.w,this.updateUniform(l,I._TempBuffer,4)}_updateColor3ForEffect(l,e,t=""){this._currentEffect.setColor3(l+t,e)}_updateColor3ForUniform(l,e){I._TempBuffer[0]=e.r,I._TempBuffer[1]=e.g,I._TempBuffer[2]=e.b,this.updateUniform(l,I._TempBuffer,3)}_updateColor4ForEffect(l,e,t,a=""){this._currentEffect.setColor4(l+a,e,t)}_updateDirectColor4ForEffect(l,e,t=""){this._currentEffect.setDirectColor4(l+t,e)}_updateColor4ForUniform(l,e,t){I._TempBuffer[0]=e.r,I._TempBuffer[1]=e.g,I._TempBuffer[2]=e.b,I._TempBuffer[3]=t,this.updateUniform(l,I._TempBuffer,4)}_updateDirectColor4ForUniform(l,e){I._TempBuffer[0]=e.r,I._TempBuffer[1]=e.g,I._TempBuffer[2]=e.b,I._TempBuffer[3]=e.a,this.updateUniform(l,I._TempBuffer,4)}_updateIntForEffect(l,e,t=""){this._currentEffect.setInt(l+t,e)}_updateIntForUniform(l,e){I._TempBufferInt32View[0]=e,this.updateUniform(l,I._TempBuffer,1)}_updateInt2ForEffect(l,e,t,a=""){this._currentEffect.setInt2(l+a,e,t)}_updateInt2ForUniform(l,e,t){I._TempBufferInt32View[0]=e,I._TempBufferInt32View[1]=t,this.updateUniform(l,I._TempBuffer,2)}_updateInt3ForEffect(l,e,t,a,s=""){this._currentEffect.setInt3(l+s,e,t,a)}_updateInt3ForUniform(l,e,t,a){I._TempBufferInt32View[0]=e,I._TempBufferInt32View[1]=t,I._TempBufferInt32View[2]=a,this.updateUniform(l,I._TempBuffer,3)}_updateInt4ForEffect(l,e,t,a,s,d=""){this._currentEffect.setInt4(l+d,e,t,a,s)}_updateInt4ForUniform(l,e,t,a,s){I._TempBufferInt32View[0]=e,I._TempBufferInt32View[1]=t,I._TempBufferInt32View[2]=a,I._TempBufferInt32View[3]=s,this.updateUniform(l,I._TempBuffer,4)}_updateUIntForEffect(l,e,t=""){this._currentEffect.setUInt(l+t,e)}_updateUIntForUniform(l,e){I._TempBufferUInt32View[0]=e,this.updateUniform(l,I._TempBuffer,1)}_updateUInt2ForEffect(l,e,t,a=""){this._currentEffect.setUInt2(l+a,e,t)}_updateUInt2ForUniform(l,e,t){I._TempBufferUInt32View[0]=e,I._TempBufferUInt32View[1]=t,this.updateUniform(l,I._TempBuffer,2)}_updateUInt3ForEffect(l,e,t,a,s=""){this._currentEffect.setUInt3(l+s,e,t,a)}_updateUInt3ForUniform(l,e,t,a){I._TempBufferUInt32View[0]=e,I._TempBufferUInt32View[1]=t,I._TempBufferUInt32View[2]=a,this.updateUniform(l,I._TempBuffer,3)}_updateUInt4ForEffect(l,e,t,a,s,d=""){this._currentEffect.setUInt4(l+d,e,t,a,s)}_updateUInt4ForUniform(l,e,t,a,s){I._TempBufferUInt32View[0]=e,I._TempBufferUInt32View[1]=t,I._TempBufferUInt32View[2]=a,I._TempBufferUInt32View[3]=s,this.updateUniform(l,I._TempBuffer,4)}setTexture(l,e){this._currentEffect.setTexture(l,e)}updateUniformDirectly(l,e){this.updateUniform(l,e,e.length),this.update()}bindToEffect(l,e){this._currentEffect=l,this._currentEffectName=e}bindUniformBuffer(){!this._noUBO&&this._buffer&&this._currentEffect&&this._currentEffect.bindUniformBuffer(this._buffer,this._currentEffectName)}unbindEffect(){this._currentEffect=void 0,this._currentEffectName=void 0}setDataBuffer(l){if(!this._buffers)return this._buffer===l;for(let e=0;e<this._buffers.length;++e)if(this._buffers[e][0]===l)return this._bufferIndex=e,this._buffer=l,this._createBufferOnWrite=!1,this._currentEffect=void 0,!0;return!1}dispose(){if(this._noUBO)return;const l=this._engine._uniformBuffers,e=l.indexOf(this);if(e!==-1&&(l[e]=l[l.length-1],l.pop()),this._engine._features.trackUbosInFrame&&this._buffers)for(let t=0;t<this._buffers.length;++t){const a=this._buffers[t][0];this._engine._releaseBuffer(a)}else this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)}}I._UpdatedUbosInFrame={};I._MAX_UNIFORM_SIZE=256;I._TempBuffer=new Float32Array(I._MAX_UNIFORM_SIZE);I._TempBufferInt32View=new Int32Array(I._TempBuffer.buffer);I._TempBufferUInt32View=new Uint32Array(I._TempBuffer.buffer);class ya{constructor(l,e,t,a=0,s=!1,d=!1,i=!1,c){this._isAlreadyOwned=!1,l.getScene?this._engine=l.getScene().getEngine():this._engine=l,this._updatable=t,this._instanced=d,this._divisor=c||1,e instanceof jt?(this._data=null,this._buffer=e):(this._data=e,this._buffer=null),this.byteStride=i?a:a*Float32Array.BYTES_PER_ELEMENT,s||this.create()}createVertexBuffer(l,e,t,a,s,d=!1,i){const c=d?e:e*Float32Array.BYTES_PER_ELEMENT,n=a?d?a:a*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new X(this._engine,this,l,this._updatable,!0,n,s===void 0?this._instanced:s,c,t,void 0,void 0,!0,this._divisor||i)}isUpdatable(){return this._updatable}getData(){return this._data}getBuffer(){return this._buffer}getStrideSize(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT}create(l=null){!l&&this._buffer||(l=l||this._data,l&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,l),this._data=l):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(l),this._data=l):this._buffer=this._engine.createVertexBuffer(l)))}_rebuild(){this._buffer=null,this.create(this._data)}update(l){this.create(l)}updateDirectly(l,e,t,a=!1){this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,l,a?e:e*Float32Array.BYTES_PER_ELEMENT,t?t*this.byteStride:void 0),e===0&&t===void 0?this._data=l:this._data=null)}_increaseReferences(){if(this._buffer){if(!this._isAlreadyOwned){this._isAlreadyOwned=!0;return}this._buffer.references++}}dispose(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null,this._data=null)}}class X{constructor(l,e,t,a,s,d,i,c,n,h,m=!1,o=!1,b=1,u=!1){if(e instanceof ya?(this._buffer=e,this._ownsBuffer=u):(this._buffer=new ya(l,e,a,d,s,i,o),this._ownsBuffer=!0),this.uniqueId=X._Counter++,this._kind=t,h==null){const G=this.getData();this.type=X.FLOAT,G instanceof Int8Array?this.type=X.BYTE:G instanceof Uint8Array?this.type=X.UNSIGNED_BYTE:G instanceof Int16Array?this.type=X.SHORT:G instanceof Uint16Array?this.type=X.UNSIGNED_SHORT:G instanceof Int32Array?this.type=X.INT:G instanceof Uint32Array&&(this.type=X.UNSIGNED_INT)}else this.type=h;const V=X.GetTypeByteLength(this.type);o?(this._size=n||(d?d/V:X.DeduceStride(t)),this.byteStride=d||this._buffer.byteStride||this._size*V,this.byteOffset=c||0):(this._size=n||d||X.DeduceStride(t),this.byteStride=d?d*V:this._buffer.byteStride||this._size*V,this.byteOffset=(c||0)*V),this.normalized=m,this._instanced=i!==void 0?i:!1,this._instanceDivisor=i?b:0,this._computeHashCode()}get instanceDivisor(){return this._instanceDivisor}set instanceDivisor(l){const e=l!=0;this._instanceDivisor=l,e!==this._instanced&&(this._instanced=e,this._computeHashCode())}_computeHashCode(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)}_rebuild(){this._buffer&&this._buffer._rebuild()}getKind(){return this._kind}isUpdatable(){return this._buffer.isUpdatable()}getData(){return this._buffer.getData()}getFloatData(l,e){const t=this.getData();if(!t)return null;const a=this.getSize()*X.GetTypeByteLength(this.type),s=l*this.getSize();if(this.type!==X.FLOAT||this.byteStride!==a){const d=new Float32Array(s);return this.forEach(s,(i,c)=>d[c]=i),d}if(!(t instanceof Array||t instanceof Float32Array)||this.byteOffset!==0||t.length!==s)if(t instanceof Array){const d=this.byteOffset/4;return t.slice(d,d+s)}else{if(t instanceof ArrayBuffer)return new Float32Array(t,this.byteOffset,s);{let d=t.byteOffset+this.byteOffset;if(e){const c=new Float32Array(s),n=new Float32Array(t.buffer,d,s);return c.set(n),c}const i=d%4;return i&&(d=Math.max(0,d-i)),new Float32Array(t.buffer,d,s)}}return e?t.slice():t}getBuffer(){return this._buffer.getBuffer()}getStrideSize(){return this.byteStride/X.GetTypeByteLength(this.type)}getOffset(){return this.byteOffset/X.GetTypeByteLength(this.type)}getSize(l=!1){return l?this._size*X.GetTypeByteLength(this.type):this._size}getIsInstanced(){return this._instanced}getInstanceDivisor(){return this._instanceDivisor}create(l){this._buffer.create(l)}update(l){this._buffer.update(l)}updateDirectly(l,e,t=!1){this._buffer.updateDirectly(l,e,void 0,t)}dispose(){this._ownsBuffer&&this._buffer.dispose()}forEach(l,e){X.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,l,this.normalized,e)}static DeduceStride(l){switch(l){case X.UVKind:case X.UV2Kind:case X.UV3Kind:case X.UV4Kind:case X.UV5Kind:case X.UV6Kind:return 2;case X.NormalKind:case X.PositionKind:return 3;case X.ColorKind:case X.MatricesIndicesKind:case X.MatricesIndicesExtraKind:case X.MatricesWeightsKind:case X.MatricesWeightsExtraKind:case X.TangentKind:return 4;default:throw new Error("Invalid kind '"+l+"'")}}static GetTypeByteLength(l){switch(l){case X.BYTE:case X.UNSIGNED_BYTE:return 1;case X.SHORT:case X.UNSIGNED_SHORT:return 2;case X.INT:case X.UNSIGNED_INT:case X.FLOAT:return 4;default:throw new Error(`Invalid type '${l}'`)}}static ForEach(l,e,t,a,s,d,i,c){if(l instanceof Array){let n=e/4;const h=t/4;for(let m=0;m<d;m+=a){for(let o=0;o<a;o++)c(l[n+o],m+o);n+=h}}else{const n=l instanceof ArrayBuffer?new DataView(l):new DataView(l.buffer,l.byteOffset,l.byteLength),h=X.GetTypeByteLength(s);for(let m=0;m<d;m+=a){let o=e;for(let b=0;b<a;b++){const u=X._GetFloatValue(n,s,o,i);c(u,m+b),o+=h}e+=t}}}static _GetFloatValue(l,e,t,a){switch(e){case X.BYTE:{let s=l.getInt8(t);return a&&(s=Math.max(s/127,-1)),s}case X.UNSIGNED_BYTE:{let s=l.getUint8(t);return a&&(s=s/255),s}case X.SHORT:{let s=l.getInt16(t,!0);return a&&(s=Math.max(s/32767,-1)),s}case X.UNSIGNED_SHORT:{let s=l.getUint16(t,!0);return a&&(s=s/65535),s}case X.INT:return l.getInt32(t,!0);case X.UNSIGNED_INT:return l.getUint32(t,!0);case X.FLOAT:return l.getFloat32(t,!0);default:throw new Error(`Invalid component type ${e}`)}}}X._Counter=0;X.BYTE=5120;X.UNSIGNED_BYTE=5121;X.SHORT=5122;X.UNSIGNED_SHORT=5123;X.INT=5124;X.UNSIGNED_INT=5125;X.FLOAT=5126;X.PositionKind="position";X.NormalKind="normal";X.TangentKind="tangent";X.UVKind="uv";X.UV2Kind="uv2";X.UV3Kind="uv3";X.UV4Kind="uv4";X.UV5Kind="uv5";X.UV6Kind="uv6";X.ColorKind="color";X.ColorInstanceKind="instanceColor";X.MatricesIndicesKind="matricesIndices";X.MatricesWeightsKind="matricesWeights";X.MatricesIndicesExtraKind="matricesIndicesExtra";X.MatricesWeightsExtraKind="matricesWeightsExtra";class we{constructor(){this.hit=!1,this.distance=0,this.pickedPoint=null,this.pickedMesh=null,this.bu=0,this.bv=0,this.faceId=-1,this.subMeshFaceId=-1,this.subMeshId=0,this.pickedSprite=null,this.thinInstanceIndex=-1,this.ray=null,this.originMesh=null,this.aimTransform=null,this.gripTransform=null}getNormal(l=!1,e=!0){if(!this.pickedMesh||e&&!this.pickedMesh.isVerticesDataPresent(X.NormalKind))return null;const t=this.pickedMesh.getIndices();if(!t)return null;let a;if(e){const d=this.pickedMesh.getVerticesData(X.NormalKind);let i=r.FromArray(d,t[this.faceId*3]*3),c=r.FromArray(d,t[this.faceId*3+1]*3),n=r.FromArray(d,t[this.faceId*3+2]*3);i=i.scale(this.bu),c=c.scale(this.bv),n=n.scale(1-this.bu-this.bv),a=new r(i.x+c.x+n.x,i.y+c.y+n.y,i.z+c.z+n.z)}else{const d=this.pickedMesh.getVerticesData(X.PositionKind),i=r.FromArray(d,t[this.faceId*3]*3),c=r.FromArray(d,t[this.faceId*3+1]*3),n=r.FromArray(d,t[this.faceId*3+2]*3),h=i.subtract(c),m=n.subtract(c);a=r.Cross(h,m)}const s=(d,i)=>{let c=d.getWorldMatrix();d.nonUniformScaling&&(f.Matrix[0].copyFrom(c),c=f.Matrix[0],c.setTranslationFromFloats(0,0,0),c.invert(),c.transposeToRef(f.Matrix[1]),c=f.Matrix[1]),r.TransformNormalToRef(i,c,i)};if(l&&s(this.pickedMesh,a),this.ray){const d=f.Vector3[0].copyFrom(a);l||s(this.pickedMesh,d),r.Dot(d,this.ray.direction)>0&&a.negateInPlace()}return a.normalize(),a}getTextureCoordinates(){if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(X.UVKind))return null;const l=this.pickedMesh.getIndices();if(!l)return null;const e=this.pickedMesh.getVerticesData(X.UVKind);if(!e)return null;let t=Wl.FromArray(e,l[this.faceId*3]*2),a=Wl.FromArray(e,l[this.faceId*3+1]*2),s=Wl.FromArray(e,l[this.faceId*3+2]*2);return t=t.scale(this.bu),a=a.scale(this.bv),s=s.scale(1-this.bu-this.bv),new Wl(t.x+a.x+s.x,t.y+a.y+s.y)}}class Il{constructor(l,e,t,a,s,d){this.source=l,this.pointerX=e,this.pointerY=t,this.meshUnderPointer=a,this.sourceEvent=s,this.additionalData=d}static CreateNew(l,e,t){const a=l.getScene();return new Il(l,a.pointerX,a.pointerY,a.meshUnderPointer||l,e,t)}static CreateNewFromSprite(l,e,t,a){return new Il(l,e.pointerX,e.pointerY,e.meshUnderPointer,t,a)}static CreateNewFromScene(l,e){return new Il(null,l.pointerX,l.pointerY,l.meshUnderPointer,e)}static CreateNewFromPrimitive(l,e,t,a){return new Il(l,e.x,e.y,null,t,a)}}class Ya{constructor(l){this._vertexBuffers={},this._scene=l}_prepareBuffers(){if(this._vertexBuffers[X.PositionKind])return;const l=[];l.push(1,1),l.push(-1,1),l.push(-1,-1),l.push(1,-1),this._vertexBuffers[X.PositionKind]=new X(this._scene.getEngine(),l,X.PositionKind,!1,!1,2),this._buildIndexBuffer()}_buildIndexBuffer(){const l=[];l.push(0),l.push(1),l.push(2),l.push(0),l.push(2),l.push(3),this._indexBuffer=this._scene.getEngine().createIndexBuffer(l)}_rebuild(){const l=this._vertexBuffers[X.PositionKind];l&&(l._rebuild(),this._buildIndexBuffer())}_prepareFrame(l=null,e=null){const t=this._scene.activeCamera;return!t||(e=e||t._postProcesses.filter(a=>a!=null),!e||e.length===0||!this._scene.postProcessesEnabled)?!1:(e[0].activate(t,l,e!=null),!0)}directRender(l,e=null,t=!1,a=0,s=0,d=!1){var i;const c=this._scene.getEngine();for(let n=0;n<l.length;n++){n<l.length-1?l[n+1].activate(this._scene.activeCamera,e==null?void 0:e.texture):(e?c.bindFramebuffer(e,a,void 0,void 0,t,s):d||c.restoreDefaultFramebuffer(),(i=c._debugInsertMarker)===null||i===void 0||i.call(c,`post process ${l[n].name} output`));const h=l[n],m=h.apply();m&&(h.onBeforeRenderObservable.notifyObservers(m),this._prepareBuffers(),c.bindBuffers(this._vertexBuffers,this._indexBuffer,m),c.drawElementsType(0,0,6),h.onAfterRenderObservable.notifyObservers(m))}c.setDepthBuffer(!0),c.setDepthWrite(!0)}_finalizeFrame(l,e,t,a,s=!1){var d;const i=this._scene.activeCamera;if(!i||(a=a||i._postProcesses.filter(n=>n!=null),a.length===0||!this._scene.postProcessesEnabled))return;const c=this._scene.getEngine();for(let n=0,h=a.length;n<h;n++){const m=a[n];if(n<h-1?m._outputTexture=a[n+1].activate(i,e==null?void 0:e.texture):(e?(c.bindFramebuffer(e,t,void 0,void 0,s),m._outputTexture=e):(c.restoreDefaultFramebuffer(),m._outputTexture=null),(d=c._debugInsertMarker)===null||d===void 0||d.call(c,`post process ${a[n].name} output`)),l)break;const o=m.apply();o&&(m.onBeforeRenderObservable.notifyObservers(o),this._prepareBuffers(),c.bindBuffers(this._vertexBuffers,this._indexBuffer,o),c.drawElementsType(0,0,6),m.onAfterRenderObservable.notifyObservers(o))}c.setDepthBuffer(!0),c.setDepthWrite(!0),c.setAlphaMode(0)}dispose(){const l=this._vertexBuffers[X.PositionKind];l&&(l.dispose(),this._vertexBuffers[X.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)}}class Fe{constructor(l,e,t=null,a=null,s=null){this.index=l,this._opaqueSubMeshes=new ql(256),this._transparentSubMeshes=new ql(256),this._alphaTestSubMeshes=new ql(256),this._depthOnlySubMeshes=new ql(256),this._particleSystems=new ql(256),this._spriteManagers=new ql(256),this._empty=!0,this._edgesRenderers=new Zt(16),this._scene=e,this.opaqueSortCompareFn=t,this.alphaTestSortCompareFn=a,this.transparentSortCompareFn=s}set opaqueSortCompareFn(l){l?this._opaqueSortCompareFn=l:this._opaqueSortCompareFn=Fe.PainterSortCompare,this._renderOpaque=this._renderOpaqueSorted}set alphaTestSortCompareFn(l){l?this._alphaTestSortCompareFn=l:this._alphaTestSortCompareFn=Fe.PainterSortCompare,this._renderAlphaTest=this._renderAlphaTestSorted}set transparentSortCompareFn(l){l?this._transparentSortCompareFn=l:this._transparentSortCompareFn=Fe.defaultTransparentSortCompare,this._renderTransparent=this._renderTransparentSorted}render(l,e,t,a){if(l){l(this._opaqueSubMeshes,this._alphaTestSubMeshes,this._transparentSubMeshes,this._depthOnlySubMeshes);return}const s=this._scene.getEngine();this._depthOnlySubMeshes.length!==0&&(s.setColorWrite(!1),this._renderAlphaTest(this._depthOnlySubMeshes),s.setColorWrite(!0)),this._opaqueSubMeshes.length!==0&&this._renderOpaque(this._opaqueSubMeshes),this._alphaTestSubMeshes.length!==0&&this._renderAlphaTest(this._alphaTestSubMeshes);const d=s.getStencilBuffer();if(s.setStencilBuffer(!1),e&&this._renderSprites(),t&&this._renderParticles(a),this.onBeforeTransparentRendering&&this.onBeforeTransparentRendering(),this._transparentSubMeshes.length!==0||this._scene.useOrderIndependentTransparency){if(s.setStencilBuffer(d),this._scene.useOrderIndependentTransparency){const i=this._scene.depthPeelingRenderer.render(this._transparentSubMeshes);i.length&&this._renderTransparent(i)}else this._renderTransparent(this._transparentSubMeshes);s.setAlphaMode(0)}if(s.setStencilBuffer(!1),this._edgesRenderers.length){for(let i=0;i<this._edgesRenderers.length;i++)this._edgesRenderers.data[i].render();s.setAlphaMode(0)}s.setStencilBuffer(d)}_renderOpaqueSorted(l){return Fe._RenderSorted(l,this._opaqueSortCompareFn,this._scene.activeCamera,!1)}_renderAlphaTestSorted(l){return Fe._RenderSorted(l,this._alphaTestSortCompareFn,this._scene.activeCamera,!1)}_renderTransparentSorted(l){return Fe._RenderSorted(l,this._transparentSortCompareFn,this._scene.activeCamera,!0)}static _RenderSorted(l,e,t,a){let s=0,d;const i=t?t.globalPosition:Fe._ZeroVector;if(a)for(;s<l.length;s++)d=l.data[s],d._alphaIndex=d.getMesh().alphaIndex,d._distanceToCamera=r.Distance(d.getBoundingInfo().boundingSphere.centerWorld,i);const c=l.length===l.data.length?l.data:l.data.slice(0,l.length);e&&c.sort(e);const n=c[0].getMesh().getScene();for(s=0;s<c.length;s++)if(d=c[s],!(n._activeMeshesFrozenButKeepClipping&&!d.isInFrustum(n._frustumPlanes))){if(a){const h=d.getMaterial();if(h&&h.needDepthPrePass){const m=h.getScene().getEngine();m.setColorWrite(!1),m.setAlphaMode(0),d.render(!1),m.setColorWrite(!0)}}d.render(a)}}static defaultTransparentSortCompare(l,e){return l._alphaIndex>e._alphaIndex?1:l._alphaIndex<e._alphaIndex?-1:Fe.backToFrontSortCompare(l,e)}static backToFrontSortCompare(l,e){return l._distanceToCamera<e._distanceToCamera?1:l._distanceToCamera>e._distanceToCamera?-1:0}static frontToBackSortCompare(l,e){return l._distanceToCamera<e._distanceToCamera?-1:l._distanceToCamera>e._distanceToCamera?1:0}static PainterSortCompare(l,e){const t=l.getMesh(),a=e.getMesh();return t.material&&a.material?t.material.uniqueId-a.material.uniqueId:t.uniqueId-a.uniqueId}prepare(){this._opaqueSubMeshes.reset(),this._transparentSubMeshes.reset(),this._alphaTestSubMeshes.reset(),this._depthOnlySubMeshes.reset(),this._particleSystems.reset(),this.prepareSprites(),this._edgesRenderers.reset(),this._empty=!0}prepareSprites(){this._spriteManagers.reset()}dispose(){this._opaqueSubMeshes.dispose(),this._transparentSubMeshes.dispose(),this._alphaTestSubMeshes.dispose(),this._depthOnlySubMeshes.dispose(),this._particleSystems.dispose(),this._spriteManagers.dispose(),this._edgesRenderers.dispose()}dispatch(l,e,t){e===void 0&&(e=l.getMesh()),t===void 0&&(t=l.getMaterial()),t!=null&&(t.needAlphaBlendingForMesh(e)?this._transparentSubMeshes.push(l):t.needAlphaTesting()?(t.needDepthPrePass&&this._depthOnlySubMeshes.push(l),this._alphaTestSubMeshes.push(l)):(t.needDepthPrePass&&this._depthOnlySubMeshes.push(l),this._opaqueSubMeshes.push(l)),e._renderingGroup=this,e._edgesRenderer&&e._edgesRenderer.isEnabled&&this._edgesRenderers.pushNoDuplicate(e._edgesRenderer),this._empty=!1)}dispatchSprites(l){this._spriteManagers.push(l),this._empty=!1}dispatchParticles(l){this._particleSystems.push(l),this._empty=!1}_renderParticles(l){if(this._particleSystems.length===0)return;const e=this._scene.activeCamera;this._scene.onBeforeParticlesRenderingObservable.notifyObservers(this._scene);for(let t=0;t<this._particleSystems.length;t++){const a=this._particleSystems.data[t];if((e&&e.layerMask&a.layerMask)===0)continue;const s=a.emitter;(!s.position||!l||l.indexOf(s)!==-1)&&this._scene._activeParticles.addCount(a.render(),!1)}this._scene.onAfterParticlesRenderingObservable.notifyObservers(this._scene)}_renderSprites(){if(!this._scene.spritesEnabled||this._spriteManagers.length===0)return;const l=this._scene.activeCamera;this._scene.onBeforeSpritesRenderingObservable.notifyObservers(this._scene);for(let e=0;e<this._spriteManagers.length;e++){const t=this._spriteManagers.data[e];(l&&l.layerMask&t.layerMask)!==0&&t.render()}this._scene.onAfterSpritesRenderingObservable.notifyObservers(this._scene)}}Fe._ZeroVector=r.Zero();class vi{}class El{constructor(l){this._useSceneAutoClearSetup=!1,this._renderingGroups=new Array,this._autoClearDepthStencil={},this._customOpaqueSortCompareFn={},this._customAlphaTestSortCompareFn={},this._customTransparentSortCompareFn={},this._renderingGroupInfo=new vi,this._maintainStateBetweenFrames=!1,this._scene=l;for(let e=El.MIN_RENDERINGGROUPS;e<El.MAX_RENDERINGGROUPS;e++)this._autoClearDepthStencil[e]={autoClear:!0,depth:!0,stencil:!0}}get maintainStateBetweenFrames(){return this._maintainStateBetweenFrames}set maintainStateBetweenFrames(l){if(l!==this._maintainStateBetweenFrames&&(this._maintainStateBetweenFrames=l,!this._maintainStateBetweenFrames)){for(const e of this._scene.meshes)if(e.subMeshes)for(const t of e.subMeshes)t._wasDispatched=!1;for(const e of this._scene.spriteManagers)e._wasDispatched=!1;for(const e of this._scene.particleSystems)e._wasDispatched=!1}}getRenderingGroup(l){const e=l||0;return this._prepareRenderingGroup(e),this._renderingGroups[e]}_clearDepthStencilBuffer(l=!0,e=!0){this._depthStencilBufferAlreadyCleaned||(this._scene.getEngine().clear(null,!1,l,e),this._depthStencilBufferAlreadyCleaned=!0)}render(l,e,t,a){const s=this._renderingGroupInfo;if(s.scene=this._scene,s.camera=this._scene.activeCamera,this._scene.spriteManagers&&a)for(let d=0;d<this._scene.spriteManagers.length;d++){const i=this._scene.spriteManagers[d];this.dispatchSprites(i)}for(let d=El.MIN_RENDERINGGROUPS;d<El.MAX_RENDERINGGROUPS;d++){this._depthStencilBufferAlreadyCleaned=d===El.MIN_RENDERINGGROUPS;const i=this._renderingGroups[d];if(!i||i._empty)continue;const c=Math.pow(2,d);if(s.renderingGroupId=d,this._scene.onBeforeRenderingGroupObservable.notifyObservers(s,c),El.AUTOCLEAR){const n=this._useSceneAutoClearSetup?this._scene.getAutoClearDepthStencilSetup(d):this._autoClearDepthStencil[d];n&&n.autoClear&&this._clearDepthStencilBuffer(n.depth,n.stencil)}for(const n of this._scene._beforeRenderingGroupDrawStage)n.action(d);i.render(l,a,t,e);for(const n of this._scene._afterRenderingGroupDrawStage)n.action(d);this._scene.onAfterRenderingGroupObservable.notifyObservers(s,c)}}reset(){if(!this.maintainStateBetweenFrames)for(let l=El.MIN_RENDERINGGROUPS;l<El.MAX_RENDERINGGROUPS;l++){const e=this._renderingGroups[l];e&&e.prepare()}}resetSprites(){if(!this.maintainStateBetweenFrames)for(let l=El.MIN_RENDERINGGROUPS;l<El.MAX_RENDERINGGROUPS;l++){const e=this._renderingGroups[l];e&&e.prepareSprites()}}dispose(){this.freeRenderingGroups(),this._renderingGroups.length=0,this._renderingGroupInfo=null}freeRenderingGroups(){for(let l=El.MIN_RENDERINGGROUPS;l<El.MAX_RENDERINGGROUPS;l++){const e=this._renderingGroups[l];e&&e.dispose()}}_prepareRenderingGroup(l){this._renderingGroups[l]===void 0&&(this._renderingGroups[l]=new Fe(l,this._scene,this._customOpaqueSortCompareFn[l],this._customAlphaTestSortCompareFn[l],this._customTransparentSortCompareFn[l]))}dispatchSprites(l){this.maintainStateBetweenFrames&&l._wasDispatched||(l._wasDispatched=!0,this.getRenderingGroup(l.renderingGroupId).dispatchSprites(l))}dispatchParticles(l){this.maintainStateBetweenFrames&&l._wasDispatched||(l._wasDispatched=!0,this.getRenderingGroup(l.renderingGroupId).dispatchParticles(l))}dispatch(l,e,t){e===void 0&&(e=l.getMesh()),!(this.maintainStateBetweenFrames&&l._wasDispatched)&&(l._wasDispatched=!0,this.getRenderingGroup(e.renderingGroupId).dispatch(l,e,t))}setRenderingOrder(l,e=null,t=null,a=null){if(this._customOpaqueSortCompareFn[l]=e,this._customAlphaTestSortCompareFn[l]=t,this._customTransparentSortCompareFn[l]=a,this._renderingGroups[l]){const s=this._renderingGroups[l];s.opaqueSortCompareFn=this._customOpaqueSortCompareFn[l],s.alphaTestSortCompareFn=this._customAlphaTestSortCompareFn[l],s.transparentSortCompareFn=this._customTransparentSortCompareFn[l]}}setRenderingAutoClearDepthStencil(l,e,t=!0,a=!0){this._autoClearDepthStencil[l]={autoClear:e,depth:t,stencil:a}}getAutoClearDepthStencilSetup(l){return this._autoClearDepthStencil[l]}}El.MAX_RENDERINGGROUPS=4;El.MIN_RENDERINGGROUPS=0;El.AUTOCLEAR=!0;class D{}D.NAME_EFFECTLAYER="EffectLayer";D.NAME_LAYER="Layer";D.NAME_LENSFLARESYSTEM="LensFlareSystem";D.NAME_BOUNDINGBOXRENDERER="BoundingBoxRenderer";D.NAME_PARTICLESYSTEM="ParticleSystem";D.NAME_GAMEPAD="Gamepad";D.NAME_SIMPLIFICATIONQUEUE="SimplificationQueue";D.NAME_GEOMETRYBUFFERRENDERER="GeometryBufferRenderer";D.NAME_PREPASSRENDERER="PrePassRenderer";D.NAME_DEPTHRENDERER="DepthRenderer";D.NAME_DEPTHPEELINGRENDERER="DepthPeelingRenderer";D.NAME_POSTPROCESSRENDERPIPELINEMANAGER="PostProcessRenderPipelineManager";D.NAME_SPRITE="Sprite";D.NAME_SUBSURFACE="SubSurface";D.NAME_OUTLINERENDERER="Outline";D.NAME_PROCEDURALTEXTURE="ProceduralTexture";D.NAME_SHADOWGENERATOR="ShadowGenerator";D.NAME_OCTREE="Octree";D.NAME_PHYSICSENGINE="PhysicsEngine";D.NAME_AUDIO="Audio";D.NAME_FLUIDRENDERER="FluidRenderer";D.STEP_ISREADYFORMESH_EFFECTLAYER=0;D.STEP_BEFOREEVALUATEACTIVEMESH_BOUNDINGBOXRENDERER=0;D.STEP_EVALUATESUBMESH_BOUNDINGBOXRENDERER=0;D.STEP_PREACTIVEMESH_BOUNDINGBOXRENDERER=0;D.STEP_CAMERADRAWRENDERTARGET_EFFECTLAYER=1;D.STEP_BEFORECAMERADRAW_PREPASS=0;D.STEP_BEFORECAMERADRAW_EFFECTLAYER=1;D.STEP_BEFORECAMERADRAW_LAYER=2;D.STEP_BEFORERENDERTARGETDRAW_PREPASS=0;D.STEP_BEFORERENDERTARGETDRAW_LAYER=1;D.STEP_BEFORERENDERINGMESH_PREPASS=0;D.STEP_BEFORERENDERINGMESH_OUTLINE=1;D.STEP_AFTERRENDERINGMESH_PREPASS=0;D.STEP_AFTERRENDERINGMESH_OUTLINE=1;D.STEP_AFTERRENDERINGGROUPDRAW_EFFECTLAYER_DRAW=0;D.STEP_AFTERRENDERINGGROUPDRAW_BOUNDINGBOXRENDERER=1;D.STEP_BEFORECAMERAUPDATE_SIMPLIFICATIONQUEUE=0;D.STEP_BEFORECAMERAUPDATE_GAMEPAD=1;D.STEP_BEFORECLEAR_PROCEDURALTEXTURE=0;D.STEP_BEFORECLEAR_PREPASS=1;D.STEP_BEFORERENDERTARGETCLEAR_PREPASS=0;D.STEP_AFTERRENDERTARGETDRAW_PREPASS=0;D.STEP_AFTERRENDERTARGETDRAW_LAYER=1;D.STEP_AFTERCAMERADRAW_PREPASS=0;D.STEP_AFTERCAMERADRAW_EFFECTLAYER=1;D.STEP_AFTERCAMERADRAW_LENSFLARESYSTEM=2;D.STEP_AFTERCAMERADRAW_EFFECTLAYER_DRAW=3;D.STEP_AFTERCAMERADRAW_LAYER=4;D.STEP_AFTERCAMERADRAW_FLUIDRENDERER=5;D.STEP_AFTERCAMERAPOSTPROCESS_LAYER=0;D.STEP_AFTERRENDERTARGETPOSTPROCESS_LAYER=0;D.STEP_AFTERRENDER_AUDIO=0;D.STEP_GATHERRENDERTARGETS_DEPTHRENDERER=0;D.STEP_GATHERRENDERTARGETS_GEOMETRYBUFFERRENDERER=1;D.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR=2;D.STEP_GATHERRENDERTARGETS_POSTPROCESSRENDERPIPELINEMANAGER=3;D.STEP_GATHERACTIVECAMERARENDERTARGETS_DEPTHRENDERER=0;D.STEP_GATHERACTIVECAMERARENDERTARGETS_FLUIDRENDERER=1;D.STEP_POINTERMOVE_SPRITE=0;D.STEP_POINTERDOWN_SPRITE=0;D.STEP_POINTERUP_SPRITE=0;class Ll extends Array{constructor(l){super(...l)}static Create(){return Object.create(Ll.prototype)}registerStep(l,e,t){let a=0,s=Number.MAX_VALUE;for(;a<this.length&&(s=this[a].index,!(l<s));a++);this.splice(a,0,{index:l,component:e,action:t.bind(e)})}clear(){this.length=0}}class Rl{}Rl.POINTERDOWN=1;Rl.POINTERUP=2;Rl.POINTERMOVE=4;Rl.POINTERWHEEL=8;Rl.POINTERPICK=16;Rl.POINTERTAP=32;Rl.POINTERDOUBLETAP=64;class yd{constructor(l,e){this.type=l,this.event=e}}class ki extends yd{constructor(l,e,t,a){super(l,e),this.ray=null,this.originalPickingInfo=null,this.skipOnPointerObservable=!1,this.localPosition=new Wl(t,a)}}class nt extends yd{constructor(l,e,t,a=null){super(l,e),this._pickInfo=t,this._inputManager=a}get pickInfo(){return this._pickInfo||this._generatePickInfo(),this._pickInfo}_generatePickInfo(){this._inputManager&&(this._pickInfo=this._inputManager._pickMove(this.event.pointerId),this._inputManager._setRayOnPointerInfo(this._pickInfo,this.event),this._inputManager=null)}}class be{constructor(){this.hoverCursor="",this.actions=new Array,this.isRecursive=!1}static get HasTriggers(){for(const l in be.Triggers)if(Object.prototype.hasOwnProperty.call(be.Triggers,l))return!0;return!1}static get HasPickTriggers(){for(const l in be.Triggers)if(Object.prototype.hasOwnProperty.call(be.Triggers,l)){const e=parseInt(l);if(e>=1&&e<=7)return!0}return!1}static HasSpecificTrigger(l){for(const e in be.Triggers)if(Object.prototype.hasOwnProperty.call(be.Triggers,e)&&parseInt(e)===l)return!0;return!1}}be.Triggers={};class Na{}Na.KEYDOWN=1;Na.KEYUP=2;class cs{constructor(l,e){this.type=l,this.event=e}}class ks extends cs{constructor(l,e){super(l,e),this.type=l,this.event=e,this.skipOnKeyboardObservable=!1}get skipOnPointerObservable(){return this.skipOnKeyboardObservable}set skipOnPointerObservable(l){this.skipOnKeyboardObservable=l}}var K;(function(Z){Z[Z.Generic=0]="Generic",Z[Z.Keyboard=1]="Keyboard",Z[Z.Mouse=2]="Mouse",Z[Z.Touch=3]="Touch",Z[Z.DualShock=4]="DualShock",Z[Z.Xbox=5]="Xbox",Z[Z.Switch=6]="Switch",Z[Z.DualSense=7]="DualSense"})(K||(K={}));var A;(function(Z){Z[Z.Horizontal=0]="Horizontal",Z[Z.Vertical=1]="Vertical",Z[Z.LeftClick=2]="LeftClick",Z[Z.MiddleClick=3]="MiddleClick",Z[Z.RightClick=4]="RightClick",Z[Z.BrowserBack=5]="BrowserBack",Z[Z.BrowserForward=6]="BrowserForward",Z[Z.MouseWheelX=7]="MouseWheelX",Z[Z.MouseWheelY=8]="MouseWheelY",Z[Z.MouseWheelZ=9]="MouseWheelZ",Z[Z.Move=12]="Move"})(A||(A={}));var Fa;(function(Z){Z[Z.Horizontal=0]="Horizontal",Z[Z.Vertical=1]="Vertical",Z[Z.LeftClick=2]="LeftClick",Z[Z.MiddleClick=3]="MiddleClick",Z[Z.RightClick=4]="RightClick",Z[Z.BrowserBack=5]="BrowserBack",Z[Z.BrowserForward=6]="BrowserForward",Z[Z.MouseWheelX=7]="MouseWheelX",Z[Z.MouseWheelY=8]="MouseWheelY",Z[Z.MouseWheelZ=9]="MouseWheelZ",Z[Z.DeltaHorizontal=10]="DeltaHorizontal",Z[Z.DeltaVertical=11]="DeltaVertical"})(Fa||(Fa={}));var Hs;(function(Z){Z[Z.Cross=0]="Cross",Z[Z.Circle=1]="Circle",Z[Z.Square=2]="Square",Z[Z.Triangle=3]="Triangle",Z[Z.L1=4]="L1",Z[Z.R1=5]="R1",Z[Z.L2=6]="L2",Z[Z.R2=7]="R2",Z[Z.Share=8]="Share",Z[Z.Options=9]="Options",Z[Z.L3=10]="L3",Z[Z.R3=11]="R3",Z[Z.DPadUp=12]="DPadUp",Z[Z.DPadDown=13]="DPadDown",Z[Z.DPadLeft=14]="DPadLeft",Z[Z.DPadRight=15]="DPadRight",Z[Z.Home=16]="Home",Z[Z.TouchPad=17]="TouchPad",Z[Z.LStickXAxis=18]="LStickXAxis",Z[Z.LStickYAxis=19]="LStickYAxis",Z[Z.RStickXAxis=20]="RStickXAxis",Z[Z.RStickYAxis=21]="RStickYAxis"})(Hs||(Hs={}));var Is;(function(Z){Z[Z.Cross=0]="Cross",Z[Z.Circle=1]="Circle",Z[Z.Square=2]="Square",Z[Z.Triangle=3]="Triangle",Z[Z.L1=4]="L1",Z[Z.R1=5]="R1",Z[Z.L2=6]="L2",Z[Z.R2=7]="R2",Z[Z.Create=8]="Create",Z[Z.Options=9]="Options",Z[Z.L3=10]="L3",Z[Z.R3=11]="R3",Z[Z.DPadUp=12]="DPadUp",Z[Z.DPadDown=13]="DPadDown",Z[Z.DPadLeft=14]="DPadLeft",Z[Z.DPadRight=15]="DPadRight",Z[Z.Home=16]="Home",Z[Z.TouchPad=17]="TouchPad",Z[Z.LStickXAxis=18]="LStickXAxis",Z[Z.LStickYAxis=19]="LStickYAxis",Z[Z.RStickXAxis=20]="RStickXAxis",Z[Z.RStickYAxis=21]="RStickYAxis"})(Is||(Is={}));var Es;(function(Z){Z[Z.A=0]="A",Z[Z.B=1]="B",Z[Z.X=2]="X",Z[Z.Y=3]="Y",Z[Z.LB=4]="LB",Z[Z.RB=5]="RB",Z[Z.LT=6]="LT",Z[Z.RT=7]="RT",Z[Z.Back=8]="Back",Z[Z.Start=9]="Start",Z[Z.LS=10]="LS",Z[Z.RS=11]="RS",Z[Z.DPadUp=12]="DPadUp",Z[Z.DPadDown=13]="DPadDown",Z[Z.DPadLeft=14]="DPadLeft",Z[Z.DPadRight=15]="DPadRight",Z[Z.Home=16]="Home",Z[Z.LStickXAxis=17]="LStickXAxis",Z[Z.LStickYAxis=18]="LStickYAxis",Z[Z.RStickXAxis=19]="RStickXAxis",Z[Z.RStickYAxis=20]="RStickYAxis"})(Es||(Es={}));var Ks;(function(Z){Z[Z.B=0]="B",Z[Z.A=1]="A",Z[Z.Y=2]="Y",Z[Z.X=3]="X",Z[Z.L=4]="L",Z[Z.R=5]="R",Z[Z.ZL=6]="ZL",Z[Z.ZR=7]="ZR",Z[Z.Minus=8]="Minus",Z[Z.Plus=9]="Plus",Z[Z.LS=10]="LS",Z[Z.RS=11]="RS",Z[Z.DPadUp=12]="DPadUp",Z[Z.DPadDown=13]="DPadDown",Z[Z.DPadLeft=14]="DPadLeft",Z[Z.DPadRight=15]="DPadRight",Z[Z.Home=16]="Home",Z[Z.Capture=17]="Capture",Z[Z.LStickXAxis=18]="LStickXAxis",Z[Z.LStickYAxis=19]="LStickYAxis",Z[Z.RStickXAxis=20]="RStickXAxis",Z[Z.RStickYAxis=21]="RStickYAxis"})(Ks||(Ks={}));var Bs;(function(Z){Z[Z.PointerMove=0]="PointerMove",Z[Z.PointerDown=1]="PointerDown",Z[Z.PointerUp=2]="PointerUp"})(Bs||(Bs={}));class La{}La.DOM_DELTA_PIXEL=0;La.DOM_DELTA_LINE=1;La.DOM_DELTA_PAGE=2;class ht{static CreateDeviceEvent(l,e,t,a,s,d){switch(l){case K.Keyboard:return this._CreateKeyboardEvent(t,a,s,d);case K.Mouse:if(t===A.MouseWheelX||t===A.MouseWheelY||t===A.MouseWheelZ)return this._CreateWheelEvent(l,e,t,a,s,d);case K.Touch:return this._CreatePointerEvent(l,e,t,a,s,d);default:throw`Unable to generate event for device ${K[l]}`}}static _CreatePointerEvent(l,e,t,a,s,d){const i=this._CreateMouseEvent(l,e,t,a,s,d);return l===K.Mouse?(i.deviceType=K.Mouse,i.pointerId=1,i.pointerType="mouse"):(i.deviceType=K.Touch,i.pointerId=e,i.pointerType="touch"),t===A.Move?i.type="pointermove":t>=A.LeftClick&&t<=A.RightClick&&(i.type=a===1?"pointerdown":"pointerup",i.button=t-2),i}static _CreateWheelEvent(l,e,t,a,s,d){const i=this._CreateMouseEvent(l,e,t,a,s,d);switch(i.type="wheel",i.deltaMode=La.DOM_DELTA_PIXEL,i.deltaX=0,i.deltaY=0,i.deltaZ=0,t){case A.MouseWheelX:i.deltaX=a;break;case A.MouseWheelY:i.deltaY=a;break;case A.MouseWheelZ:i.deltaZ=a;break}return i}static _CreateMouseEvent(l,e,t,a,s,d){const i=this._CreateEvent(d),c=s.pollInput(l,e,A.Horizontal),n=s.pollInput(l,e,A.Vertical);return d?(i.movementX=0,i.movementY=0,i.offsetX=i.movementX-d.getBoundingClientRect().x,i.offsetY=i.movementY-d.getBoundingClientRect().y):(i.movementX=s.pollInput(l,e,Fa.DeltaHorizontal),i.movementY=s.pollInput(l,e,Fa.DeltaVertical),i.offsetX=0,i.offsetY=0),this._CheckNonCharacterKeys(i,s),i.clientX=c,i.clientY=n,i.x=c,i.y=n,i.deviceType=l,i.deviceSlot=e,i.inputIndex=t,i}static _CreateKeyboardEvent(l,e,t,a){const s=this._CreateEvent(a);return this._CheckNonCharacterKeys(s,t),s.deviceType=K.Keyboard,s.deviceSlot=0,s.inputIndex=l,s.type=e===1?"keydown":"keyup",s.key=String.fromCharCode(l),s.keyCode=l,s}static _CheckNonCharacterKeys(l,e){const t=e.isDeviceAvailable(K.Keyboard),a=t&&e.pollInput(K.Keyboard,0,18)===1,s=t&&e.pollInput(K.Keyboard,0,17)===1,d=t&&(e.pollInput(K.Keyboard,0,91)===1||e.pollInput(K.Keyboard,0,92)===1||e.pollInput(K.Keyboard,0,93)===1),i=t&&e.pollInput(K.Keyboard,0,16)===1;l.altKey=a,l.ctrlKey=s,l.metaKey=d,l.shiftKey=i}static _CreateEvent(l){const e={};return e.preventDefault=()=>{},e.target=l,e}}class Hi{constructor(l,e,t){this._nativeInput=_native.DeviceInputSystem?new _native.DeviceInputSystem(l,e,(a,s,d,i)=>{const c=ht.CreateDeviceEvent(a,s,d,i,this);t(a,s,c)}):this._createDummyNativeInput()}pollInput(l,e,t){return this._nativeInput.pollInput(l,e,t)}isDeviceAvailable(l){return l===K.Mouse||l===K.Touch}dispose(){this._nativeInput.dispose()}_createDummyNativeInput(){return{pollInput:()=>0,isDeviceAvailable:()=>!1,dispose:()=>{}}}}const Qs=255,Ps=Object.keys(A).length/2;class Ii{constructor(l,e,t,a){this._inputs=[],this._keyboardActive=!1,this._pointerActive=!1,this._usingSafari=Q.IsSafari(),this._usingMacOS=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),this._keyboardDownEvent=s=>{},this._keyboardUpEvent=s=>{},this._keyboardBlurEvent=s=>{},this._pointerMoveEvent=s=>{},this._pointerDownEvent=s=>{},this._pointerUpEvent=s=>{},this._pointerCancelEvent=s=>{},this._pointerWheelEvent=s=>{},this._pointerBlurEvent=s=>{},this._eventsAttached=!1,this._mouseId=-1,this._isUsingFirefox=ds.IsNavigatorAvailable()&&navigator.userAgent&&navigator.userAgent.indexOf("Firefox")!==-1,this._maxTouchPoints=0,this._pointerInputClearObserver=null,this._gamepadConnectedEvent=s=>{},this._gamepadDisconnectedEvent=s=>{},this._eventPrefix=Q.GetPointerPrefix(l),this._engine=l,this._onDeviceConnected=e,this._onDeviceDisconnected=t,this._onInputChanged=a,this._enableEvents(),this._usingMacOS&&(this._metaKeys=[]),this._engine._onEngineViewChanged||(this._engine._onEngineViewChanged=()=>{this._enableEvents()})}pollInput(l,e,t){const a=this._inputs[l][e];if(!a)throw`Unable to find device ${K[l]}`;l>=K.DualShock&&l<=K.DualSense&&this._updateDevice(l,e,t);const s=a[t];if(s===void 0)throw`Unable to find input ${t} for device ${K[l]} in slot ${e}`;return t===A.Move&&Q.Warn("Unable to provide information for PointerInput.Move.  Try using PointerInput.Horizontal or PointerInput.Vertical for move data."),s}isDeviceAvailable(l){return this._inputs[l]!==void 0}dispose(){this._onDeviceConnected=()=>{},this._onDeviceDisconnected=()=>{},this._onInputChanged=()=>{},delete this._engine._onEngineViewChanged,this._elementToAttachTo&&this._disableEvents()}_enableEvents(){const l=this===null||this===void 0?void 0:this._engine.getInputElement();if(l&&(!this._eventsAttached||this._elementToAttachTo!==l)){if(this._disableEvents(),this._inputs){for(const e of this._inputs)if(e)for(const t in e){const a=+t,s=e[a];if(s)for(let d=0;d<s.length;d++)s[d]=0}}this._elementToAttachTo=l,this._elementToAttachTo.tabIndex=this._elementToAttachTo.tabIndex!==-1?this._elementToAttachTo.tabIndex:this._engine.canvasTabIndex,this._handleKeyActions(),this._handlePointerActions(),this._handleGamepadActions(),this._eventsAttached=!0,this._checkForConnectedDevices()}}_disableEvents(){this._elementToAttachTo&&(this._elementToAttachTo.removeEventListener("blur",this._keyboardBlurEvent),this._elementToAttachTo.removeEventListener("blur",this._pointerBlurEvent),this._elementToAttachTo.removeEventListener("keydown",this._keyboardDownEvent),this._elementToAttachTo.removeEventListener("keyup",this._keyboardUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"move",this._pointerMoveEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"down",this._pointerDownEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"up",this._pointerUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent),this._elementToAttachTo.removeEventListener(this._wheelEventName,this._pointerWheelEvent),window.removeEventListener("gamepadconnected",this._gamepadConnectedEvent),window.removeEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)),this._pointerInputClearObserver&&this._engine.onEndFrameObservable.remove(this._pointerInputClearObserver),this._eventsAttached=!1}_checkForConnectedDevices(){if(navigator.getGamepads){const l=navigator.getGamepads();for(const e of l)e&&this._addGamePad(e)}typeof matchMedia=="function"&&matchMedia("(pointer:fine)").matches&&this._addPointerDevice(K.Mouse,0,0,0)}_addGamePad(l){const e=this._getGamepadDeviceType(l.id),t=l.index;this._gamepads=this._gamepads||new Array(l.index+1),this._registerDevice(e,t,l.buttons.length+l.axes.length),this._gamepads[t]=e}_addPointerDevice(l,e,t,a){this._pointerActive||(this._pointerActive=!0),this._registerDevice(l,e,Ps);const s=this._inputs[l][e];s[0]=t,s[1]=a}_registerDevice(l,e,t){if(e===void 0)throw`Unable to register device ${K[l]} to undefined slot.`;if(this._inputs[l]||(this._inputs[l]={}),!this._inputs[l][e]){const a=new Array(t);a.fill(0),this._inputs[l][e]=a,this._onDeviceConnected(l,e)}}_unregisterDevice(l,e){this._inputs[l][e]&&(delete this._inputs[l][e],this._onDeviceDisconnected(l,e))}_handleKeyActions(){this._keyboardDownEvent=l=>{this._keyboardActive||(this._keyboardActive=!0,this._registerDevice(K.Keyboard,0,Qs));const e=this._inputs[K.Keyboard][0];if(e){e[l.keyCode]=1;const t=l;t.inputIndex=l.keyCode,this._usingMacOS&&l.metaKey&&l.key!=="Meta"&&(this._metaKeys.includes(l.keyCode)||this._metaKeys.push(l.keyCode)),this._onInputChanged(K.Keyboard,0,t)}},this._keyboardUpEvent=l=>{this._keyboardActive||(this._keyboardActive=!0,this._registerDevice(K.Keyboard,0,Qs));const e=this._inputs[K.Keyboard][0];if(e){e[l.keyCode]=0;const t=l;if(t.inputIndex=l.keyCode,this._usingMacOS&&l.key==="Meta"&&this._metaKeys.length>0){for(const a of this._metaKeys){const s=ht.CreateDeviceEvent(K.Keyboard,0,a,0,this,this._elementToAttachTo);e[a]=0,this._onInputChanged(K.Keyboard,0,s)}this._metaKeys.splice(0,this._metaKeys.length)}this._onInputChanged(K.Keyboard,0,t)}},this._keyboardBlurEvent=()=>{if(this._keyboardActive){const l=this._inputs[K.Keyboard][0];for(let e=0;e<l.length;e++)if(l[e]!==0){l[e]=0;const t=ht.CreateDeviceEvent(K.Keyboard,0,e,0,this,this._elementToAttachTo);this._onInputChanged(K.Keyboard,0,t)}this._usingMacOS&&this._metaKeys.splice(0,this._metaKeys.length)}},this._elementToAttachTo.addEventListener("keydown",this._keyboardDownEvent),this._elementToAttachTo.addEventListener("keyup",this._keyboardUpEvent),this._elementToAttachTo.addEventListener("blur",this._keyboardBlurEvent)}_handlePointerActions(){this._maxTouchPoints=ds.IsNavigatorAvailable()&&navigator.maxTouchPoints||2,this._activeTouchIds||(this._activeTouchIds=new Array(this._maxTouchPoints));for(let t=0;t<this._maxTouchPoints;t++)this._activeTouchIds[t]=-1;this._pointerMoveEvent=t=>{const a=this._getPointerType(t),s=a===K.Mouse?0:this._activeTouchIds.indexOf(t.pointerId);this._inputs[a]||(this._inputs[a]={}),this._inputs[a][s]||this._addPointerDevice(a,s,t.clientX,t.clientY);const d=this._inputs[a][s];if(d){const i=t;i.inputIndex=A.Move,d[A.Horizontal]=t.clientX,d[A.Vertical]=t.clientY,this._onInputChanged(a,s,i),!this._usingSafari&&t.button!==-1&&(i.inputIndex=t.button+2,d[t.button+2]=d[t.button+2]?0:1,this._onInputChanged(a,s,i))}},this._pointerDownEvent=t=>{const a=this._getPointerType(t);let s=a===K.Mouse?0:t.pointerId;if(a===K.Touch){const i=this._activeTouchIds.indexOf(-1);if(i>=0)s=i,this._activeTouchIds[i]=t.pointerId;else{Q.Warn(`Max number of touches exceeded.  Ignoring touches in excess of ${this._maxTouchPoints}`);return}}this._inputs[a]||(this._inputs[a]={}),this._inputs[a][s]?a===K.Touch&&this._onDeviceConnected(a,s):this._addPointerDevice(a,s,t.clientX,t.clientY);const d=this._inputs[a][s];if(d){const i=d[A.Horizontal],c=d[A.Vertical];if(a===K.Mouse){if(this._mouseId===-1&&(t.pointerId===void 0?this._mouseId=this._isUsingFirefox?0:1:this._mouseId=t.pointerId),!document.pointerLockElement)try{this._elementToAttachTo.setPointerCapture(this._mouseId)}catch{}}else if(t.pointerId&&!document.pointerLockElement)try{this._elementToAttachTo.setPointerCapture(t.pointerId)}catch{}d[A.Horizontal]=t.clientX,d[A.Vertical]=t.clientY,d[t.button+2]=1;const n=t;n.inputIndex=t.button+2,this._onInputChanged(a,s,n),(i!==t.clientX||c!==t.clientY)&&(n.inputIndex=A.Move,this._onInputChanged(a,s,n))}},this._pointerUpEvent=t=>{var a,s,d,i,c;const n=this._getPointerType(t),h=n===K.Mouse?0:this._activeTouchIds.indexOf(t.pointerId);if(n===K.Touch){if(h===-1)return;this._activeTouchIds[h]=-1}const m=(a=this._inputs[n])===null||a===void 0?void 0:a[h];if(m&&m[t.button+2]!==0){const o=m[A.Horizontal],b=m[A.Vertical];m[A.Horizontal]=t.clientX,m[A.Vertical]=t.clientY,m[t.button+2]=0;const u=t;(o!==t.clientX||b!==t.clientY)&&(u.inputIndex=A.Move,this._onInputChanged(n,h,u)),u.inputIndex=t.button+2,n===K.Mouse&&this._mouseId>=0&&!((d=(s=this._elementToAttachTo).hasPointerCapture)===null||d===void 0)&&d.call(s,this._mouseId)?this._elementToAttachTo.releasePointerCapture(this._mouseId):t.pointerId&&!((c=(i=this._elementToAttachTo).hasPointerCapture)===null||c===void 0)&&c.call(i,t.pointerId)&&this._elementToAttachTo.releasePointerCapture(t.pointerId),this._onInputChanged(n,h,u),n===K.Touch&&this._onDeviceDisconnected(n,h)}},this._pointerCancelEvent=t=>{var a,s,d,i;if(t.pointerType==="mouse"){const c=this._inputs[K.Mouse][0];this._mouseId>=0&&!((s=(a=this._elementToAttachTo).hasPointerCapture)===null||s===void 0)&&s.call(a,this._mouseId)&&this._elementToAttachTo.releasePointerCapture(this._mouseId);for(let n=A.LeftClick;n<=A.BrowserForward;n++)if(c[n]===1){c[n]=0;const h=ht.CreateDeviceEvent(K.Mouse,0,n,0,this,this._elementToAttachTo);this._onInputChanged(K.Mouse,0,h)}}else{const c=this._activeTouchIds.indexOf(t.pointerId);!((i=(d=this._elementToAttachTo).hasPointerCapture)===null||i===void 0)&&i.call(d,t.pointerId)&&this._elementToAttachTo.releasePointerCapture(t.pointerId),this._inputs[K.Touch][c][A.LeftClick]=0;const n=ht.CreateDeviceEvent(K.Touch,c,A.LeftClick,0,this,this._elementToAttachTo);this._onInputChanged(K.Touch,c,n),this._activeTouchIds[c]=-1,this._onDeviceDisconnected(K.Touch,c)}},this._wheelEventName="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll";let l=!1;const e=function(){};try{const t=Object.defineProperty({},"passive",{get:function(){l=!0}});this._elementToAttachTo.addEventListener("test",e,t),this._elementToAttachTo.removeEventListener("test",e,t)}catch{}this._pointerBlurEvent=()=>{var t,a,s,d,i;if(this.isDeviceAvailable(K.Mouse)){const c=this._inputs[K.Mouse][0];this._mouseId>=0&&!((a=(t=this._elementToAttachTo).hasPointerCapture)===null||a===void 0)&&a.call(t,this._mouseId)&&this._elementToAttachTo.releasePointerCapture(this._mouseId);for(let n=A.LeftClick;n<=A.BrowserForward;n++)if(c[n]===1){c[n]=0;const h=ht.CreateDeviceEvent(K.Mouse,0,n,0,this,this._elementToAttachTo);this._onInputChanged(K.Mouse,0,h)}}if(this.isDeviceAvailable(K.Touch)){const c=this._inputs[K.Touch];for(let n=0;n<this._activeTouchIds.length;n++){const h=this._activeTouchIds[n];if(!((d=(s=this._elementToAttachTo).hasPointerCapture)===null||d===void 0)&&d.call(s,h)&&this._elementToAttachTo.releasePointerCapture(h),h!==-1&&((i=c[n])===null||i===void 0?void 0:i[A.LeftClick])===1){c[n][A.LeftClick]=0;const m=ht.CreateDeviceEvent(K.Touch,n,A.LeftClick,0,this,this._elementToAttachTo);this._onInputChanged(K.Touch,n,m),this._activeTouchIds[n]=-1,this._onDeviceDisconnected(K.Touch,n)}}}},this._pointerWheelEvent=t=>{const a=K.Mouse,s=0;this._inputs[a]||(this._inputs[a]=[]),this._inputs[a][s]||(this._pointerActive=!0,this._registerDevice(a,s,Ps));const d=this._inputs[a][s];if(d){d[A.MouseWheelX]=t.deltaX||0,d[A.MouseWheelY]=t.deltaY||t.wheelDelta||0,d[A.MouseWheelZ]=t.deltaZ||0;const i=t;d[A.MouseWheelX]!==0&&(i.inputIndex=A.MouseWheelX,this._onInputChanged(a,s,i)),d[A.MouseWheelY]!==0&&(i.inputIndex=A.MouseWheelY,this._onInputChanged(a,s,i)),d[A.MouseWheelZ]!==0&&(i.inputIndex=A.MouseWheelZ,this._onInputChanged(a,s,i))}},this._elementToAttachTo.addEventListener(this._eventPrefix+"move",this._pointerMoveEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"down",this._pointerDownEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"up",this._pointerUpEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent),this._elementToAttachTo.addEventListener("blur",this._pointerBlurEvent),this._elementToAttachTo.addEventListener(this._wheelEventName,this._pointerWheelEvent,l?{passive:!1}:!1),this._pointerInputClearObserver=this._engine.onEndFrameObservable.add(()=>{if(this.isDeviceAvailable(K.Mouse)){const t=this._inputs[K.Mouse][0];t[A.MouseWheelX]=0,t[A.MouseWheelY]=0,t[A.MouseWheelZ]=0}})}_handleGamepadActions(){this._gamepadConnectedEvent=l=>{this._addGamePad(l.gamepad)},this._gamepadDisconnectedEvent=l=>{if(this._gamepads){const e=this._getGamepadDeviceType(l.gamepad.id),t=l.gamepad.index;this._unregisterDevice(e,t),delete this._gamepads[t]}},window.addEventListener("gamepadconnected",this._gamepadConnectedEvent),window.addEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)}_updateDevice(l,e,t){const a=navigator.getGamepads()[e];if(a&&l===this._gamepads[e]){const s=this._inputs[l][e];t>=a.buttons.length?s[t]=a.axes[t-a.buttons.length].valueOf():s[t]=a.buttons[t].value}}_getGamepadDeviceType(l){return l.indexOf("054c")!==-1?l.indexOf("0ce6")!==-1?K.DualSense:K.DualShock:l.indexOf("Xbox One")!==-1||l.search("Xbox 360")!==-1||l.search("xinput")!==-1?K.Xbox:l.indexOf("057e")!==-1?K.Switch:K.Generic}_getPointerType(l){let e=K.Mouse;return(l.pointerType==="touch"||l.pointerType==="pen"||l.touches)&&(e=K.Touch),e}}class ws{constructor(l,e,t=0){this.deviceType=e,this.deviceSlot=t,this.onInputChangedObservable=new z,this._deviceInputSystem=l}getInput(l){return this._deviceInputSystem.pollInput(this.deviceType,this.deviceSlot,l)}}class Ei{constructor(l){this._registeredManagers=new Array,this._refCount=0,this.registerManager=d=>{for(let i=0;i<this._devices.length;i++){const c=this._devices[i];for(const n in c){const h=+n;d._addDevice(new ws(this._deviceInputSystem,i,h))}}this._registeredManagers.push(d)},this.unregisterManager=d=>{const i=this._registeredManagers.indexOf(d);i>-1&&this._registeredManagers.splice(i,1)};const e=Object.keys(K).length/2;this._devices=new Array(e);const t=(d,i)=>{this._devices[d]||(this._devices[d]=new Array),this._devices[d][i]||(this._devices[d][i]=i);for(const c of this._registeredManagers){const n=new ws(this._deviceInputSystem,d,i);c._addDevice(n)}},a=(d,i)=>{var c;!((c=this._devices[d])===null||c===void 0)&&c[i]&&delete this._devices[d][i];for(const n of this._registeredManagers)n._removeDevice(d,i)},s=(d,i,c)=>{if(c)for(const n of this._registeredManagers)n._onInputChanged(d,i,c)};typeof _native<"u"?this._deviceInputSystem=new Hi(t,a,s):this._deviceInputSystem=new Ii(l,t,a,s)}dispose(){this._deviceInputSystem.dispose()}}class Ki{constructor(l){const e=Object.keys(K).length/2;this._devices=new Array(e),this._firstDevice=new Array(e),this._engine=l,this._engine._deviceSourceManager||(this._engine._deviceSourceManager=new Ei(l)),this._engine._deviceSourceManager._refCount++,this.onDeviceConnectedObservable=new z(t=>{for(const a of this._devices)if(a)for(const s of a)s&&this.onDeviceConnectedObservable.notifyObserver(t,s)}),this.onDeviceDisconnectedObservable=new z,this._engine._deviceSourceManager.registerManager(this),this._onDisposeObserver=l.onDisposeObservable.add(()=>{this.dispose()})}getDeviceSource(l,e){if(e===void 0){if(this._firstDevice[l]===void 0)return null;e=this._firstDevice[l]}return!this._devices[l]||this._devices[l][e]===void 0?null:this._devices[l][e]}getDeviceSources(l){return this._devices[l]?this._devices[l].filter(e=>!!e):[]}dispose(){this.onDeviceConnectedObservable.clear(),this.onDeviceDisconnectedObservable.clear(),this._engine._deviceSourceManager&&(this._engine._deviceSourceManager.unregisterManager(this),--this._engine._deviceSourceManager._refCount<1&&(this._engine._deviceSourceManager.dispose(),delete this._engine._deviceSourceManager)),this._engine.onDisposeObservable.remove(this._onDisposeObserver)}_addDevice(l){this._devices[l.deviceType]||(this._devices[l.deviceType]=new Array),this._devices[l.deviceType][l.deviceSlot]||(this._devices[l.deviceType][l.deviceSlot]=l,this._updateFirstDevices(l.deviceType)),this.onDeviceConnectedObservable.notifyObservers(l)}_removeDevice(l,e){var t,a;const s=(t=this._devices[l])===null||t===void 0?void 0:t[e];this.onDeviceDisconnectedObservable.notifyObservers(s),!((a=this._devices[l])===null||a===void 0)&&a[e]&&delete this._devices[l][e],this._updateFirstDevices(l)}_onInputChanged(l,e,t){var a,s;(s=(a=this._devices[l])===null||a===void 0?void 0:a[e])===null||s===void 0||s.onInputChangedObservable.notifyObservers(t)}_updateFirstDevices(l){switch(l){case K.Keyboard:case K.Mouse:this._firstDevice[l]=0;break;case K.Touch:case K.DualSense:case K.DualShock:case K.Xbox:case K.Switch:case K.Generic:{delete this._firstDevice[l];const e=this._devices[l];if(e){for(let t=0;t<e.length;t++)if(e[t]){this._firstDevice[l]=t;break}}break}}}}class _s{constructor(){this._singleClick=!1,this._doubleClick=!1,this._hasSwiped=!1,this._ignore=!1}get singleClick(){return this._singleClick}get doubleClick(){return this._doubleClick}get hasSwiped(){return this._hasSwiped}get ignore(){return this._ignore}set singleClick(l){this._singleClick=l}set doubleClick(l){this._doubleClick=l}set hasSwiped(l){this._hasSwiped=l}set ignore(l){this._ignore=l}}class fl{constructor(l){this._alreadyAttached=!1,this._meshPickProceed=!1,this._currentPickResult=null,this._previousPickResult=null,this._totalPointersPressed=0,this._doubleClickOccured=!1,this._isSwiping=!1,this._swipeButtonPressed=-1,this._skipPointerTap=!1,this._pointerX=0,this._pointerY=0,this._startingPointerPosition=new Wl(0,0),this._previousStartingPointerPosition=new Wl(0,0),this._startingPointerTime=0,this._previousStartingPointerTime=0,this._pointerCaptures={},this._meshUnderPointerId={},this._movePointerInfo=null,this._cameraObserverCount=0,this._deviceSourceManager=null,this._scene=l||bl.LastCreatedScene,this._scene}get meshUnderPointer(){return this._movePointerInfo&&(this._movePointerInfo._generatePickInfo(),this._movePointerInfo=null),this._pointerOverMesh}getMeshUnderPointerByPointerId(l){return this._meshUnderPointerId[l]||null}get unTranslatedPointer(){return new Wl(this._unTranslatedPointerX,this._unTranslatedPointerY)}get pointerX(){return this._pointerX}set pointerX(l){this._pointerX=l}get pointerY(){return this._pointerY}set pointerY(l){this._pointerY=l}_updatePointerPosition(l){const e=this._scene.getEngine().getInputElementClientRect();e&&(this._pointerX=l.clientX-e.left,this._pointerY=l.clientY-e.top,this._unTranslatedPointerX=this._pointerX,this._unTranslatedPointerY=this._pointerY)}_processPointerMove(l,e){const t=this._scene,a=t.getEngine(),s=a.getInputElement();s&&(s.tabIndex=a.canvasTabIndex,t.doNotHandleCursors||(s.style.cursor=t.defaultCursor)),this._setCursorAndPointerOverMesh(l,e.pointerId,t);for(const c of t._pointerMoveStage){const n=!!(l!=null&&l.pickedMesh);l=c.action(this._unTranslatedPointerX,this._unTranslatedPointerY,l,n,s)}const d=e.inputIndex>=A.MouseWheelX&&e.inputIndex<=A.MouseWheelZ?Rl.POINTERWHEEL:Rl.POINTERMOVE;t.onPointerMove&&(l=l||this._pickMove(e.pointerId),t.onPointerMove(e,l,d));let i;l?(i=new nt(d,e,l),this._setRayOnPointerInfo(l,e)):(i=new nt(d,e,null,this),this._movePointerInfo=i),t.onPointerObservable.hasObservers()&&t.onPointerObservable.notifyObservers(i,d)}_setRayOnPointerInfo(l,e){const t=this._scene;l&&t._pickingAvailable&&(l.ray||(l.ray=t.createPickingRay(e.offsetX,e.offsetY,Y.Identity(),t.activeCamera)))}_addCameraPointerObserver(l,e){return this._cameraObserverCount++,this._scene.onPointerObservable.add(l,e)}_removeCameraPointerObserver(l){return this._cameraObserverCount--,this._scene.onPointerObservable.remove(l)}_checkForPicking(){return!!(this._scene.onPointerObservable.observers.length>this._cameraObserverCount||this._scene.onPointerPick)}_checkPrePointerObservable(l,e,t){const a=this._scene,s=new ki(t,e,this._unTranslatedPointerX,this._unTranslatedPointerY);return l&&(s.originalPickingInfo=l,s.ray=l.ray,l.originMesh&&(s.nearInteractionPickingInfo=l)),a.onPrePointerObservable.notifyObservers(s,t),!!s.skipOnPointerObservable}_pickMove(l){const e=this._scene,t=e.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,e.pointerMovePredicate,!1,e.cameraToUseForPointers,e.pointerMoveTrianglePredicate);return this._setCursorAndPointerOverMesh(t,l,e),t}_setCursorAndPointerOverMesh(l,e,t){const a=t.getEngine().getInputElement();if(l!=null&&l.pickedMesh){if(this.setPointerOverMesh(l.pickedMesh,e,l),!t.doNotHandleCursors&&a&&this._pointerOverMesh){const s=this._pointerOverMesh._getActionManagerForTrigger();s&&s.hasPointerTriggers&&(a.style.cursor=s.hoverCursor||t.hoverCursor)}}else this.setPointerOverMesh(null,e,l)}simulatePointerMove(l,e){const t=new PointerEvent("pointermove",e);t.inputIndex=A.Move,!this._checkPrePointerObservable(l,t,Rl.POINTERMOVE)&&this._processPointerMove(l,t)}simulatePointerDown(l,e){const t=new PointerEvent("pointerdown",e);t.inputIndex=t.button+2,!this._checkPrePointerObservable(l,t,Rl.POINTERDOWN)&&this._processPointerDown(l,t)}_processPointerDown(l,e){const t=this._scene;if(l!=null&&l.pickedMesh){this._pickedDownMesh=l.pickedMesh;const d=l.pickedMesh._getActionManagerForTrigger();if(d){if(d.hasPickTriggers)switch(d.processTrigger(5,Il.CreateNew(l.pickedMesh,e)),e.button){case 0:d.processTrigger(2,Il.CreateNew(l.pickedMesh,e));break;case 1:d.processTrigger(4,Il.CreateNew(l.pickedMesh,e));break;case 2:d.processTrigger(3,Il.CreateNew(l.pickedMesh,e));break}d.hasSpecificTrigger(8)&&window.setTimeout(()=>{const i=t.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,c=>c.isPickable&&c.isVisible&&c.isReady()&&c.actionManager&&c.actionManager.hasSpecificTrigger(8)&&c===this._pickedDownMesh,!1,t.cameraToUseForPointers);i!=null&&i.pickedMesh&&d&&this._totalPointersPressed!==0&&Date.now()-this._startingPointerTime>fl.LongPressDelay&&!this._isPointerSwiping()&&(this._startingPointerTime=0,d.processTrigger(8,Il.CreateNew(i.pickedMesh,e)))},fl.LongPressDelay)}}else for(const d of t._pointerDownStage)l=d.action(this._unTranslatedPointerX,this._unTranslatedPointerY,l,e,!1);let a;const s=Rl.POINTERDOWN;l?(t.onPointerDown&&t.onPointerDown(e,l,s),a=new nt(s,e,l),this._setRayOnPointerInfo(l,e)):a=new nt(s,e,null,this),t.onPointerObservable.hasObservers()&&t.onPointerObservable.notifyObservers(a,s)}_isPointerSwiping(){return this._isSwiping}simulatePointerUp(l,e,t){const a=new PointerEvent("pointerup",e);a.inputIndex=A.Move;const s=new _s;t?s.doubleClick=!0:s.singleClick=!0,!this._checkPrePointerObservable(l,a,Rl.POINTERUP)&&this._processPointerUp(l,a,s)}_processPointerUp(l,e,t){const a=this._scene;if(l!=null&&l.pickedMesh){if(this._pickedUpMesh=l.pickedMesh,this._pickedDownMesh===this._pickedUpMesh&&(a.onPointerPick&&a.onPointerPick(e,l),t.singleClick&&!t.ignore&&a.onPointerObservable.observers.length>this._cameraObserverCount)){const d=Rl.POINTERPICK,i=new nt(d,e,l);this._setRayOnPointerInfo(l,e),a.onPointerObservable.notifyObservers(i,d)}const s=l.pickedMesh._getActionManagerForTrigger();if(s&&!t.ignore){s.processTrigger(7,Il.CreateNew(l.pickedMesh,e,l)),!t.hasSwiped&&t.singleClick&&s.processTrigger(1,Il.CreateNew(l.pickedMesh,e,l));const d=l.pickedMesh._getActionManagerForTrigger(6);t.doubleClick&&d&&d.processTrigger(6,Il.CreateNew(l.pickedMesh,e,l))}}else if(!t.ignore)for(const s of a._pointerUpStage)l=s.action(this._unTranslatedPointerX,this._unTranslatedPointerY,l,e,t.doubleClick);if(this._pickedDownMesh&&this._pickedDownMesh!==this._pickedUpMesh){const s=this._pickedDownMesh._getActionManagerForTrigger(16);s&&s.processTrigger(16,Il.CreateNew(this._pickedDownMesh,e))}if(!t.ignore){const s=new nt(Rl.POINTERUP,e,l);if(this._setRayOnPointerInfo(l,e),a.onPointerObservable.notifyObservers(s,Rl.POINTERUP),a.onPointerUp&&a.onPointerUp(e,l,Rl.POINTERUP),!t.hasSwiped&&!this._skipPointerTap){let d=0;if(t.singleClick?d=Rl.POINTERTAP:t.doubleClick&&(d=Rl.POINTERDOUBLETAP),d){const i=new nt(d,e,l);a.onPointerObservable.hasObservers()&&a.onPointerObservable.hasSpecificMask(d)&&a.onPointerObservable.notifyObservers(i,d)}}}}isPointerCaptured(l=0){return this._pointerCaptures[l]}attachControl(l=!0,e=!0,t=!0,a=null){const s=this._scene,d=s.getEngine();a||(a=d.getInputElement()),this._alreadyAttached&&this.detachControl(),a&&(this._alreadyAttachedTo=a),this._deviceSourceManager=new Ki(d),this._initActionManager=i=>{if(!this._meshPickProceed){const c=s.skipPointerUpPicking||s._registeredActions===0&&!this._checkForPicking()&&!s.onPointerUp?null:s.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,s.pointerUpPredicate,!1,s.cameraToUseForPointers);this._currentPickResult=c,c&&(i=c.hit&&c.pickedMesh?c.pickedMesh._getActionManagerForTrigger():null),this._meshPickProceed=!0}return i},this._delayedSimpleClick=(i,c,n)=>{(Date.now()-this._previousStartingPointerTime>fl.DoubleClickDelay&&!this._doubleClickOccured||i!==this._previousButtonPressed)&&(this._doubleClickOccured=!1,c.singleClick=!0,c.ignore=!1,n(c,this._currentPickResult))},this._initClickEvent=(i,c,n,h)=>{const m=new _s;this._currentPickResult=null;let o=null,b=i.hasSpecificMask(Rl.POINTERPICK)||c.hasSpecificMask(Rl.POINTERPICK)||i.hasSpecificMask(Rl.POINTERTAP)||c.hasSpecificMask(Rl.POINTERTAP)||i.hasSpecificMask(Rl.POINTERDOUBLETAP)||c.hasSpecificMask(Rl.POINTERDOUBLETAP);!b&&be&&(o=this._initActionManager(o,m),o&&(b=o.hasPickTriggers));let u=!1;if(b){const V=n.button;if(m.hasSwiped=this._isPointerSwiping(),!m.hasSwiped){let G=!fl.ExclusiveDoubleClickMode;G||(G=!i.hasSpecificMask(Rl.POINTERDOUBLETAP)&&!c.hasSpecificMask(Rl.POINTERDOUBLETAP),G&&!be.HasSpecificTrigger(6)&&(o=this._initActionManager(o,m),o&&(G=!o.hasSpecificTrigger(6)))),G?(Date.now()-this._previousStartingPointerTime>fl.DoubleClickDelay||V!==this._previousButtonPressed)&&(m.singleClick=!0,h(m,this._currentPickResult),u=!0):(this._previousDelayedSimpleClickTimeout=this._delayedSimpleClickTimeout,this._delayedSimpleClickTimeout=window.setTimeout(this._delayedSimpleClick.bind(this,V,m,h),fl.DoubleClickDelay));let p=i.hasSpecificMask(Rl.POINTERDOUBLETAP)||c.hasSpecificMask(Rl.POINTERDOUBLETAP);!p&&be.HasSpecificTrigger(6)&&(o=this._initActionManager(o,m),o&&(p=o.hasSpecificTrigger(6))),p&&(V===this._previousButtonPressed&&Date.now()-this._previousStartingPointerTime<fl.DoubleClickDelay&&!this._doubleClickOccured?(!m.hasSwiped&&!this._isPointerSwiping()?(this._previousStartingPointerTime=0,this._doubleClickOccured=!0,m.doubleClick=!0,m.ignore=!1,fl.ExclusiveDoubleClickMode&&this._previousDelayedSimpleClickTimeout&&clearTimeout(this._previousDelayedSimpleClickTimeout),this._previousDelayedSimpleClickTimeout=this._delayedSimpleClickTimeout,h(m,this._currentPickResult)):(this._doubleClickOccured=!1,this._previousStartingPointerTime=this._startingPointerTime,this._previousStartingPointerPosition.x=this._startingPointerPosition.x,this._previousStartingPointerPosition.y=this._startingPointerPosition.y,this._previousButtonPressed=V,fl.ExclusiveDoubleClickMode?(this._previousDelayedSimpleClickTimeout&&clearTimeout(this._previousDelayedSimpleClickTimeout),this._previousDelayedSimpleClickTimeout=this._delayedSimpleClickTimeout,h(m,this._previousPickResult)):h(m,this._currentPickResult)),u=!0):(this._doubleClickOccured=!1,this._previousStartingPointerTime=this._startingPointerTime,this._previousStartingPointerPosition.x=this._startingPointerPosition.x,this._previousStartingPointerPosition.y=this._startingPointerPosition.y,this._previousButtonPressed=V))}}u||h(m,this._currentPickResult)},this._onPointerMove=i=>{if(i.pointerId===void 0&&(i.pointerId=0),this._updatePointerPosition(i),!this._isSwiping&&this._swipeButtonPressed!==-1&&(this._isSwiping=Math.abs(this._startingPointerPosition.x-this._pointerX)>fl.DragMovementThreshold||Math.abs(this._startingPointerPosition.y-this._pointerY)>fl.DragMovementThreshold),this._checkPrePointerObservable(null,i,i.inputIndex>=A.MouseWheelX&&i.inputIndex<=A.MouseWheelZ?Rl.POINTERWHEEL:Rl.POINTERMOVE)||!s.cameraToUseForPointers&&!s.activeCamera)return;if(s.skipPointerMovePicking){this._processPointerMove(new we,i);return}s.pointerMovePredicate||(s.pointerMovePredicate=n=>n.isPickable&&n.isVisible&&n.isReady()&&n.isEnabled()&&(n.enablePointerMoveEvents||s.constantlyUpdateMeshUnderPointer||n._getActionManagerForTrigger()!==null)&&(!s.cameraToUseForPointers||(s.cameraToUseForPointers.layerMask&n.layerMask)!==0));const c=s._registeredActions>0?this._pickMove(i.pointerId):null;this._processPointerMove(c,i)},this._onPointerDown=i=>{if(this._totalPointersPressed++,this._pickedDownMesh=null,this._meshPickProceed=!1,i.pointerId===void 0&&(i.pointerId=0),this._updatePointerPosition(i),this._swipeButtonPressed===-1&&(this._swipeButtonPressed=i.button),s.preventDefaultOnPointerDown&&a&&(i.preventDefault(),a.focus()),this._startingPointerPosition.x=this._pointerX,this._startingPointerPosition.y=this._pointerY,this._startingPointerTime=Date.now(),this._checkPrePointerObservable(null,i,Rl.POINTERDOWN)||!s.cameraToUseForPointers&&!s.activeCamera)return;this._pointerCaptures[i.pointerId]=!0,s.pointerDownPredicate||(s.pointerDownPredicate=n=>n.isPickable&&n.isVisible&&n.isReady()&&n.isEnabled()&&(!s.cameraToUseForPointers||(s.cameraToUseForPointers.layerMask&n.layerMask)!==0)),this._pickedDownMesh=null;let c;s.skipPointerDownPicking||s._registeredActions===0&&!this._checkForPicking()&&!s.onPointerDown?c=new we:c=s.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,s.pointerDownPredicate,!1,s.cameraToUseForPointers),this._processPointerDown(c,i)},this._onPointerUp=i=>{this._totalPointersPressed!==0&&(this._totalPointersPressed--,this._pickedUpMesh=null,this._meshPickProceed=!1,i.pointerId===void 0&&(i.pointerId=0),this._updatePointerPosition(i),s.preventDefaultOnPointerUp&&a&&(i.preventDefault(),a.focus()),this._initClickEvent(s.onPrePointerObservable,s.onPointerObservable,i,(c,n)=>{if(s.onPrePointerObservable.hasObservers()&&(this._skipPointerTap=!1,!c.ignore)){if(this._checkPrePointerObservable(null,i,Rl.POINTERUP)){this._swipeButtonPressed===i.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1);return}c.hasSwiped||(c.singleClick&&s.onPrePointerObservable.hasSpecificMask(Rl.POINTERTAP)&&this._checkPrePointerObservable(null,i,Rl.POINTERTAP)&&(this._skipPointerTap=!0),c.doubleClick&&s.onPrePointerObservable.hasSpecificMask(Rl.POINTERDOUBLETAP)&&this._checkPrePointerObservable(null,i,Rl.POINTERDOUBLETAP)&&(this._skipPointerTap=!0))}this._pointerCaptures[i.pointerId]=!1,!(!s.cameraToUseForPointers&&!s.activeCamera)&&(s.pointerUpPredicate||(s.pointerUpPredicate=h=>h.isPickable&&h.isVisible&&h.isReady()&&h.isEnabled()&&(!s.cameraToUseForPointers||(s.cameraToUseForPointers.layerMask&h.layerMask)!==0)),!this._meshPickProceed&&(be&&be.HasTriggers||this._checkForPicking()||s.onPointerUp)&&this._initActionManager(null,c),n||(n=this._currentPickResult),this._processPointerUp(n,i,c),this._previousPickResult=this._currentPickResult,this._swipeButtonPressed===i.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1))}))},this._onKeyDown=i=>{const c=Na.KEYDOWN;if(s.onPreKeyboardObservable.hasObservers()){const n=new ks(c,i);if(s.onPreKeyboardObservable.notifyObservers(n,c),n.skipOnKeyboardObservable)return}if(s.onKeyboardObservable.hasObservers()){const n=new cs(c,i);s.onKeyboardObservable.notifyObservers(n,c)}s.actionManager&&s.actionManager.processTrigger(14,Il.CreateNewFromScene(s,i))},this._onKeyUp=i=>{const c=Na.KEYUP;if(s.onPreKeyboardObservable.hasObservers()){const n=new ks(c,i);if(s.onPreKeyboardObservable.notifyObservers(n,c),n.skipOnKeyboardObservable)return}if(s.onKeyboardObservable.hasObservers()){const n=new cs(c,i);s.onKeyboardObservable.notifyObservers(n,c)}s.actionManager&&s.actionManager.processTrigger(15,Il.CreateNewFromScene(s,i))},this._deviceSourceManager.onDeviceConnectedObservable.add(i=>{i.deviceType===K.Mouse?i.onInputChangedObservable.add(c=>{c.inputIndex===A.LeftClick||c.inputIndex===A.MiddleClick||c.inputIndex===A.RightClick||c.inputIndex===A.BrowserBack||c.inputIndex===A.BrowserForward?e&&i.getInput(c.inputIndex)===1?this._onPointerDown(c):l&&i.getInput(c.inputIndex)===0&&this._onPointerUp(c):t&&(c.inputIndex===A.Move?this._onPointerMove(c):(c.inputIndex===A.MouseWheelX||c.inputIndex===A.MouseWheelY||c.inputIndex===A.MouseWheelZ)&&this._onPointerMove(c))}):i.deviceType===K.Touch?i.onInputChangedObservable.add(c=>{c.inputIndex===A.LeftClick&&(e&&i.getInput(c.inputIndex)===1?this._onPointerDown(c):l&&i.getInput(c.inputIndex)===0&&this._onPointerUp(c)),t&&c.inputIndex===A.Move&&this._onPointerMove(c)}):i.deviceType===K.Keyboard&&i.onInputChangedObservable.add(c=>{c.type==="keydown"?this._onKeyDown(c):c.type==="keyup"&&this._onKeyUp(c)})}),this._alreadyAttached=!0}detachControl(){this._alreadyAttached&&(this._deviceSourceManager.dispose(),this._deviceSourceManager=null,this._alreadyAttachedTo&&!this._scene.doNotHandleCursors&&(this._alreadyAttachedTo.style.cursor=this._scene.defaultCursor),this._alreadyAttached=!1,this._alreadyAttachedTo=null)}setPointerOverMesh(l,e=0,t){if(this._meshUnderPointerId[e]===l&&(!l||!l._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting))return;const a=this._meshUnderPointerId[e];let s;a&&(s=a._getActionManagerForTrigger(10),s&&s.processTrigger(10,Il.CreateNew(a,void 0,{pointerId:e}))),l?(this._meshUnderPointerId[e]=l,this._pointerOverMesh=l,s=l._getActionManagerForTrigger(9),s&&s.processTrigger(9,Il.CreateNew(l,void 0,{pointerId:e,pickResult:t}))):(delete this._meshUnderPointerId[e],this._pointerOverMesh=null)}getPointerOverMesh(){return this.meshUnderPointer}_invalidateMesh(l){this._pointerOverMesh===l&&(this._pointerOverMesh=null),this._pickedDownMesh===l&&(this._pickedDownMesh=null),this._pickedUpMesh===l&&(this._pickedUpMesh=null);for(const e in this._meshUnderPointerId)this._meshUnderPointerId[e]===l&&delete this._meshUnderPointerId[e]}}fl.DragMovementThreshold=10;fl.LongPressDelay=500;fl.DoubleClickDelay=300;fl.ExclusiveDoubleClickMode=!1;class Se{constructor(l,e,t,a){this.normal=new r(l,e,t),this.d=a}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new Se(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let l=this.normal.getHashCode();return l=l*397^(this.d|0),l}normalize(){const l=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z);let e=0;return l!==0&&(e=1/l),this.normal.x*=e,this.normal.y*=e,this.normal.z*=e,this.d*=e,this}transform(l){const e=Se._TmpMatrix;l.invertToRef(e);const t=e.m,a=this.normal.x,s=this.normal.y,d=this.normal.z,i=this.d,c=a*t[0]+s*t[1]+d*t[2]+i*t[3],n=a*t[4]+s*t[5]+d*t[6]+i*t[7],h=a*t[8]+s*t[9]+d*t[10]+i*t[11],m=a*t[12]+s*t[13]+d*t[14]+i*t[15];return new Se(c,n,h,m)}dotCoordinate(l){return this.normal.x*l.x+this.normal.y*l.y+this.normal.z*l.z+this.d}copyFromPoints(l,e,t){const a=e.x-l.x,s=e.y-l.y,d=e.z-l.z,i=t.x-l.x,c=t.y-l.y,n=t.z-l.z,h=s*n-d*c,m=d*i-a*n,o=a*c-s*i,b=Math.sqrt(h*h+m*m+o*o);let u;return b!==0?u=1/b:u=0,this.normal.x=h*u,this.normal.y=m*u,this.normal.z=o*u,this.d=-(this.normal.x*l.x+this.normal.y*l.y+this.normal.z*l.z),this}isFrontFacingTo(l,e){return r.Dot(this.normal,l)<=e}signedDistanceTo(l){return r.Dot(l,this.normal)+this.d}static FromArray(l){return new Se(l[0],l[1],l[2],l[3])}static FromPoints(l,e,t){const a=new Se(0,0,0,0);return a.copyFromPoints(l,e,t),a}static FromPositionAndNormal(l,e){const t=new Se(0,0,0,0);return e.normalize(),t.normal=e,t.d=-(e.x*l.x+e.y*l.y+e.z*l.z),t}static SignedDistanceToPlaneFromPositionAndNormal(l,e,t){const a=-(e.x*l.x+e.y*l.y+e.z*l.z);return r.Dot(t,e)+a}}Se._TmpMatrix=Y.Identity();class We{static GetPlanes(l){const e=[];for(let t=0;t<6;t++)e.push(new Se(0,0,0,0));return We.GetPlanesToRef(l,e),e}static GetNearPlaneToRef(l,e){const t=l.m;e.normal.x=t[3]+t[2],e.normal.y=t[7]+t[6],e.normal.z=t[11]+t[10],e.d=t[15]+t[14],e.normalize()}static GetFarPlaneToRef(l,e){const t=l.m;e.normal.x=t[3]-t[2],e.normal.y=t[7]-t[6],e.normal.z=t[11]-t[10],e.d=t[15]-t[14],e.normalize()}static GetLeftPlaneToRef(l,e){const t=l.m;e.normal.x=t[3]+t[0],e.normal.y=t[7]+t[4],e.normal.z=t[11]+t[8],e.d=t[15]+t[12],e.normalize()}static GetRightPlaneToRef(l,e){const t=l.m;e.normal.x=t[3]-t[0],e.normal.y=t[7]-t[4],e.normal.z=t[11]-t[8],e.d=t[15]-t[12],e.normalize()}static GetTopPlaneToRef(l,e){const t=l.m;e.normal.x=t[3]-t[1],e.normal.y=t[7]-t[5],e.normal.z=t[11]-t[9],e.d=t[15]-t[13],e.normalize()}static GetBottomPlaneToRef(l,e){const t=l.m;e.normal.x=t[3]+t[1],e.normal.y=t[7]+t[5],e.normal.z=t[11]+t[9],e.d=t[15]+t[13],e.normalize()}static GetPlanesToRef(l,e){We.GetNearPlaneToRef(l,e[0]),We.GetFarPlaneToRef(l,e[1]),We.GetLeftPlaneToRef(l,e[2]),We.GetRightPlaneToRef(l,e[3]),We.GetTopPlaneToRef(l,e[4]),We.GetBottomPlaneToRef(l,e[5])}}class Yd{static get UniqueId(){const l=this._UniqueIdCounter;return this._UniqueIdCounter++,l}}Yd._UniqueIdCounter=1;class Vl{static CompareLightsPriority(l,e){return l.shadowEnabled!==e.shadowEnabled?(e.shadowEnabled?1:0)-(l.shadowEnabled?1:0):e.renderPriority-l.renderPriority}}Vl.FALLOFF_DEFAULT=0;Vl.FALLOFF_PHYSICAL=1;Vl.FALLOFF_GLTF=2;Vl.FALLOFF_STANDARD=3;Vl.LIGHTMAP_DEFAULT=0;Vl.LIGHTMAP_SPECULAR=1;Vl.LIGHTMAP_SHADOWSONLY=2;Vl.INTENSITYMODE_AUTOMATIC=0;Vl.INTENSITYMODE_LUMINOUSPOWER=1;Vl.INTENSITYMODE_LUMINOUSINTENSITY=2;Vl.INTENSITYMODE_ILLUMINANCE=3;Vl.INTENSITYMODE_LUMINANCE=4;Vl.LIGHTTYPEID_POINTLIGHT=0;Vl.LIGHTTYPEID_DIRECTIONALLIGHT=1;Vl.LIGHTTYPEID_SPOTLIGHT=2;Vl.LIGHTTYPEID_HEMISPHERICLIGHT=3;var Te;(function(Z){Z[Z.BackwardCompatible=0]="BackwardCompatible",Z[Z.Intermediate=1]="Intermediate",Z[Z.Aggressive=2]="Aggressive"})(Te||(Te={}));class sl extends Sa{constructor(l,e){super(),this._inputManager=new fl(this),this.cameraToUseForPointers=null,this._isScene=!0,this._blockEntityCollection=!1,this.autoClear=!0,this.autoClearDepthAndStencil=!0,this.clearColor=new Gl(.2,.2,.3,1),this.ambientColor=new al(0,0,0),this.environmentIntensity=1,this._performancePriority=Te.BackwardCompatible,this._forceWireframe=!1,this._skipFrustumClipping=!1,this._forcePointsCloud=!1,this.animationsEnabled=!0,this._animationPropertiesOverride=null,this.useConstantAnimationDeltaTime=!1,this.constantlyUpdateMeshUnderPointer=!1,this.hoverCursor="pointer",this.defaultCursor="",this.doNotHandleCursors=!1,this.preventDefaultOnPointerDown=!0,this.preventDefaultOnPointerUp=!0,this.metadata=null,this.reservedDataStore=null,this.disableOfflineSupportExceptionRules=new Array,this.onDisposeObservable=new z,this._onDisposeObserver=null,this.onBeforeRenderObservable=new z,this._onBeforeRenderObserver=null,this.onAfterRenderObservable=new z,this.onAfterRenderCameraObservable=new z,this._onAfterRenderObserver=null,this.onBeforeAnimationsObservable=new z,this.onAfterAnimationsObservable=new z,this.onBeforeDrawPhaseObservable=new z,this.onAfterDrawPhaseObservable=new z,this.onReadyObservable=new z,this.onBeforeCameraRenderObservable=new z,this._onBeforeCameraRenderObserver=null,this.onAfterCameraRenderObservable=new z,this._onAfterCameraRenderObserver=null,this.onBeforeActiveMeshesEvaluationObservable=new z,this.onAfterActiveMeshesEvaluationObservable=new z,this.onBeforeParticlesRenderingObservable=new z,this.onAfterParticlesRenderingObservable=new z,this.onDataLoadedObservable=new z,this.onNewCameraAddedObservable=new z,this.onCameraRemovedObservable=new z,this.onNewLightAddedObservable=new z,this.onLightRemovedObservable=new z,this.onNewGeometryAddedObservable=new z,this.onGeometryRemovedObservable=new z,this.onNewTransformNodeAddedObservable=new z,this.onTransformNodeRemovedObservable=new z,this.onNewMeshAddedObservable=new z,this.onMeshRemovedObservable=new z,this.onNewSkeletonAddedObservable=new z,this.onSkeletonRemovedObservable=new z,this.onNewMaterialAddedObservable=new z,this.onNewMultiMaterialAddedObservable=new z,this.onMaterialRemovedObservable=new z,this.onMultiMaterialRemovedObservable=new z,this.onNewTextureAddedObservable=new z,this.onTextureRemovedObservable=new z,this.onBeforeRenderTargetsRenderObservable=new z,this.onAfterRenderTargetsRenderObservable=new z,this.onBeforeStepObservable=new z,this.onAfterStepObservable=new z,this.onActiveCameraChanged=new z,this.onActiveCamerasChanged=new z,this.onBeforeRenderingGroupObservable=new z,this.onAfterRenderingGroupObservable=new z,this.onMeshImportedObservable=new z,this.onAnimationFileImportedObservable=new z,this._registeredForLateAnimationBindings=new Zt(256),this.skipPointerMovePicking=!1,this.skipPointerDownPicking=!1,this.skipPointerUpPicking=!1,this.onPrePointerObservable=new z,this.onPointerObservable=new z,this.onPreKeyboardObservable=new z,this.onKeyboardObservable=new z,this._useRightHandedSystem=!1,this._timeAccumulator=0,this._currentStepId=0,this._currentInternalStep=0,this._fogEnabled=!0,this._fogMode=sl.FOGMODE_NONE,this.fogColor=new al(.2,.2,.3),this.fogDensity=.1,this.fogStart=0,this.fogEnd=1e3,this.needsPreviousWorldMatrices=!1,this._shadowsEnabled=!0,this._lightsEnabled=!0,this._unObserveActiveCameras=null,this._texturesEnabled=!0,this.physicsEnabled=!0,this.particlesEnabled=!0,this.spritesEnabled=!0,this._skeletonsEnabled=!0,this.lensFlaresEnabled=!0,this.collisionsEnabled=!0,this.gravity=new r(0,-9.807,0),this.postProcessesEnabled=!0,this.renderTargetsEnabled=!0,this.dumpNextRenderTargets=!1,this.customRenderTargets=new Array,this.importedMeshesFiles=new Array,this.probesEnabled=!0,this._meshesForIntersections=new Zt(256),this.proceduralTexturesEnabled=!0,this._totalVertices=new fe,this._activeIndices=new fe,this._activeParticles=new fe,this._activeBones=new fe,this._animationTime=0,this.animationTimeScale=1,this._renderId=0,this._frameId=0,this._executeWhenReadyTimeoutId=null,this._intermediateRendering=!1,this._defaultFrameBufferCleared=!1,this._viewUpdateFlag=-1,this._projectionUpdateFlag=-1,this._toBeDisposed=new Array(256),this._activeRequests=new Array,this._pendingData=new Array,this._isDisposed=!1,this.dispatchAllSubMeshesOfActiveMeshes=!1,this._activeMeshes=new ql(256),this._processedMaterials=new ql(256),this._renderTargets=new Zt(256),this._materialsRenderTargets=new Zt(256),this._activeParticleSystems=new ql(256),this._activeSkeletons=new Zt(32),this._softwareSkinnedMeshes=new Zt(32),this._activeAnimatables=new Array,this._transformMatrix=Y.Zero(),this.requireLightSorting=!1,this._components=[],this._serializableComponents=[],this._transientComponents=[],this._beforeCameraUpdateStage=Ll.Create(),this._beforeClearStage=Ll.Create(),this._beforeRenderTargetClearStage=Ll.Create(),this._gatherRenderTargetsStage=Ll.Create(),this._gatherActiveCameraRenderTargetsStage=Ll.Create(),this._isReadyForMeshStage=Ll.Create(),this._beforeEvaluateActiveMeshStage=Ll.Create(),this._evaluateSubMeshStage=Ll.Create(),this._preActiveMeshStage=Ll.Create(),this._cameraDrawRenderTargetStage=Ll.Create(),this._beforeCameraDrawStage=Ll.Create(),this._beforeRenderTargetDrawStage=Ll.Create(),this._beforeRenderingGroupDrawStage=Ll.Create(),this._beforeRenderingMeshStage=Ll.Create(),this._afterRenderingMeshStage=Ll.Create(),this._afterRenderingGroupDrawStage=Ll.Create(),this._afterCameraDrawStage=Ll.Create(),this._afterCameraPostProcessStage=Ll.Create(),this._afterRenderTargetDrawStage=Ll.Create(),this._afterRenderTargetPostProcessStage=Ll.Create(),this._afterRenderStage=Ll.Create(),this._pointerMoveStage=Ll.Create(),this._pointerDownStage=Ll.Create(),this._pointerUpStage=Ll.Create(),this._geometriesByUniqueId=null,this._defaultMeshCandidates={data:[],length:0},this._defaultSubMeshCandidates={data:[],length:0},this._preventFreeActiveMeshesAndRenderingGroups=!1,this._activeMeshesFrozen=!1,this._activeMeshesFrozenButKeepClipping=!1,this._skipEvaluateActiveMeshesCompletely=!1,this._allowPostProcessClearColor=!0,this.getDeterministicFrameTime=()=>this._engine.getTimeStep(),this._registeredActions=0,this._blockMaterialDirtyMechanism=!1,this._perfCollector=null,this.activeCameras=new Array;const t={useGeometryUniqueIdsMap:!0,useMaterialMeshMap:!0,useClonedMeshMap:!0,virtual:!1,...e};this._engine=l||bl.LastCreatedEngine,t.virtual?this._engine._virtualScenes.push(this):(bl._LastCreatedScene=this,this._engine.scenes.push(this)),this._uid=null,this._renderingManager=new El(this),Ya&&(this.postProcessManager=new Ya(this)),jl()&&this.attachControl(),this._createUbo(),rl&&(this._imageProcessingConfiguration=new rl),this.setDefaultCandidateProviders(),t.useGeometryUniqueIdsMap&&(this._geometriesByUniqueId={}),this.useMaterialMeshMap=t.useMaterialMeshMap,this.useClonedMeshMap=t.useClonedMeshMap,(!e||!e.virtual)&&this._engine.onNewSceneAddedObservable.notifyObservers(this)}static DefaultMaterialFactory(l){throw O("StandardMaterial")}static CollisionCoordinatorFactory(){throw O("DefaultCollisionCoordinator")}get environmentTexture(){return this._environmentTexture}set environmentTexture(l){this._environmentTexture!==l&&(this._environmentTexture=l,this.markAllMaterialsAsDirty(1))}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}get performancePriority(){return this._performancePriority}set performancePriority(l){if(l!==this._performancePriority)switch(this._performancePriority=l,l){case Te.BackwardCompatible:this.skipFrustumClipping=!1,this._renderingManager.maintainStateBetweenFrames=!1,this.skipPointerMovePicking=!1,this.autoClear=!0;break;case Te.Intermediate:this.skipFrustumClipping=!1,this._renderingManager.maintainStateBetweenFrames=!1,this.skipPointerMovePicking=!0,this.autoClear=!1;break;case Te.Aggressive:this.skipFrustumClipping=!0,this._renderingManager.maintainStateBetweenFrames=!0,this.skipPointerMovePicking=!0,this.autoClear=!1;break}}set forceWireframe(l){this._forceWireframe!==l&&(this._forceWireframe=l,this.markAllMaterialsAsDirty(16))}get forceWireframe(){return this._forceWireframe}set skipFrustumClipping(l){this._skipFrustumClipping!==l&&(this._skipFrustumClipping=l)}get skipFrustumClipping(){return this._skipFrustumClipping}set forcePointsCloud(l){this._forcePointsCloud!==l&&(this._forcePointsCloud=l,this.markAllMaterialsAsDirty(16))}get forcePointsCloud(){return this._forcePointsCloud}get animationPropertiesOverride(){return this._animationPropertiesOverride}set animationPropertiesOverride(l){this._animationPropertiesOverride=l}set onDispose(l){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(l)}set beforeRender(l){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),l&&(this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(l))}set afterRender(l){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),l&&(this._onAfterRenderObserver=this.onAfterRenderObservable.add(l))}set beforeCameraRender(l){this._onBeforeCameraRenderObserver&&this.onBeforeCameraRenderObservable.remove(this._onBeforeCameraRenderObserver),this._onBeforeCameraRenderObserver=this.onBeforeCameraRenderObservable.add(l)}set afterCameraRender(l){this._onAfterCameraRenderObserver&&this.onAfterCameraRenderObservable.remove(this._onAfterCameraRenderObserver),this._onAfterCameraRenderObserver=this.onAfterCameraRenderObservable.add(l)}get unTranslatedPointer(){return this._inputManager.unTranslatedPointer}static get DragMovementThreshold(){return fl.DragMovementThreshold}static set DragMovementThreshold(l){fl.DragMovementThreshold=l}static get LongPressDelay(){return fl.LongPressDelay}static set LongPressDelay(l){fl.LongPressDelay=l}static get DoubleClickDelay(){return fl.DoubleClickDelay}static set DoubleClickDelay(l){fl.DoubleClickDelay=l}static get ExclusiveDoubleClickMode(){return fl.ExclusiveDoubleClickMode}static set ExclusiveDoubleClickMode(l){fl.ExclusiveDoubleClickMode=l}bindEyePosition(l,e="vEyePosition",t=!1){var a;const s=this._forcedViewPosition?this._forcedViewPosition:this._mirroredCameraPosition?this._mirroredCameraPosition:(a=this.activeCamera.globalPosition)!==null&&a!==void 0?a:this.activeCamera.devicePosition,d=this.useRightHandedSystem===(this._mirroredCameraPosition!=null);return f.Vector4[0].set(s.x,s.y,s.z,d?-1:1),l&&(t?l.setFloat3(e,f.Vector4[0].x,f.Vector4[0].y,f.Vector4[0].z):l.setVector4(e,f.Vector4[0])),f.Vector4[0]}finalizeSceneUbo(){const l=this.getSceneUniformBuffer(),e=this.bindEyePosition(null);return l.updateFloat4("vEyePosition",e.x,e.y,e.z,e.w),l.update(),l}set useRightHandedSystem(l){this._useRightHandedSystem!==l&&(this._useRightHandedSystem=l,this.markAllMaterialsAsDirty(16))}get useRightHandedSystem(){return this._useRightHandedSystem}setStepId(l){this._currentStepId=l}getStepId(){return this._currentStepId}getInternalStep(){return this._currentInternalStep}set fogEnabled(l){this._fogEnabled!==l&&(this._fogEnabled=l,this.markAllMaterialsAsDirty(16))}get fogEnabled(){return this._fogEnabled}set fogMode(l){this._fogMode!==l&&(this._fogMode=l,this.markAllMaterialsAsDirty(16))}get fogMode(){return this._fogMode}get prePass(){return!!this.prePassRenderer&&this.prePassRenderer.defaultRT.enabled}set shadowsEnabled(l){this._shadowsEnabled!==l&&(this._shadowsEnabled=l,this.markAllMaterialsAsDirty(2))}get shadowsEnabled(){return this._shadowsEnabled}set lightsEnabled(l){this._lightsEnabled!==l&&(this._lightsEnabled=l,this.markAllMaterialsAsDirty(2))}get lightsEnabled(){return this._lightsEnabled}get activeCameras(){return this._activeCameras}set activeCameras(l){this._unObserveActiveCameras&&(this._unObserveActiveCameras(),this._unObserveActiveCameras=null),l&&(this._unObserveActiveCameras=hd(l,()=>{this.onActiveCamerasChanged.notifyObservers(this)})),this._activeCameras=l}get activeCamera(){return this._activeCamera}set activeCamera(l){l!==this._activeCamera&&(this._activeCamera=l,this.onActiveCameraChanged.notifyObservers(this))}get defaultMaterial(){return this._defaultMaterial||(this._defaultMaterial=sl.DefaultMaterialFactory(this)),this._defaultMaterial}set defaultMaterial(l){this._defaultMaterial=l}set texturesEnabled(l){this._texturesEnabled!==l&&(this._texturesEnabled=l,this.markAllMaterialsAsDirty(1))}get texturesEnabled(){return this._texturesEnabled}set skeletonsEnabled(l){this._skeletonsEnabled!==l&&(this._skeletonsEnabled=l,this.markAllMaterialsAsDirty(8))}get skeletonsEnabled(){return this._skeletonsEnabled}get collisionCoordinator(){return this._collisionCoordinator||(this._collisionCoordinator=sl.CollisionCoordinatorFactory(),this._collisionCoordinator.init(this)),this._collisionCoordinator}get renderingManager(){return this._renderingManager}get frustumPlanes(){return this._frustumPlanes}_registerTransientComponents(){if(this._transientComponents.length>0){for(const l of this._transientComponents)l.register();this._transientComponents.length=0}}_addComponent(l){this._components.push(l),this._transientComponents.push(l);const e=l;e.addFromContainer&&e.serialize&&this._serializableComponents.push(e)}_getComponent(l){for(const e of this._components)if(e.name===l)return e;return null}getClassName(){return"Scene"}_getDefaultMeshCandidates(){return this._defaultMeshCandidates.data=this.meshes,this._defaultMeshCandidates.length=this.meshes.length,this._defaultMeshCandidates}_getDefaultSubMeshCandidates(l){return this._defaultSubMeshCandidates.data=l.subMeshes,this._defaultSubMeshCandidates.length=l.subMeshes.length,this._defaultSubMeshCandidates}setDefaultCandidateProviders(){this.getActiveMeshCandidates=this._getDefaultMeshCandidates.bind(this),this.getActiveSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this),this.getIntersectingSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this),this.getCollidingSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this)}get meshUnderPointer(){return this._inputManager.meshUnderPointer}get pointerX(){return this._inputManager.pointerX}set pointerX(l){this._inputManager.pointerX=l}get pointerY(){return this._inputManager.pointerY}set pointerY(l){this._inputManager.pointerY=l}getCachedMaterial(){return this._cachedMaterial}getCachedEffect(){return this._cachedEffect}getCachedVisibility(){return this._cachedVisibility}isCachedMaterialInvalid(l,e,t=1){return this._cachedEffect!==e||this._cachedMaterial!==l||this._cachedVisibility!==t}getEngine(){return this._engine}getTotalVertices(){return this._totalVertices.current}get totalVerticesPerfCounter(){return this._totalVertices}getActiveIndices(){return this._activeIndices.current}get totalActiveIndicesPerfCounter(){return this._activeIndices}getActiveParticles(){return this._activeParticles.current}get activeParticlesPerfCounter(){return this._activeParticles}getActiveBones(){return this._activeBones.current}get activeBonesPerfCounter(){return this._activeBones}getActiveMeshes(){return this._activeMeshes}getAnimationRatio(){return this._animationRatio!==void 0?this._animationRatio:1}getRenderId(){return this._renderId}getFrameId(){return this._frameId}incrementRenderId(){this._renderId++}_createUbo(){this.setSceneUniformBuffer(this.createSceneUniformBuffer())}simulatePointerMove(l,e){return this._inputManager.simulatePointerMove(l,e),this}simulatePointerDown(l,e){return this._inputManager.simulatePointerDown(l,e),this}simulatePointerUp(l,e,t){return this._inputManager.simulatePointerUp(l,e,t),this}isPointerCaptured(l=0){return this._inputManager.isPointerCaptured(l)}attachControl(l=!0,e=!0,t=!0){this._inputManager.attachControl(l,e,t)}detachControl(){this._inputManager.detachControl()}isReady(l=!0){if(this._isDisposed)return!1;let e;const t=this.getEngine();let a=!0;for(this._pendingData.length>0&&(a=!1),l&&(this._processedMaterials.reset(),this._materialsRenderTargets.reset()),e=0;e<this.meshes.length;e++){const s=this.meshes[e];if(!s.subMeshes||s.subMeshes.length===0)continue;if(!s.isReady(!0)){a=!1;continue}const d=s.hasThinInstances||s.getClassName()==="InstancedMesh"||s.getClassName()==="InstancedLinesMesh"||t.getCaps().instancedArrays&&s.instances.length>0;for(const c of this._isReadyForMeshStage)c.action(s,d)||(a=!1);if(!l)continue;const i=s.material||this.defaultMaterial;if(i)if(i._storeEffectOnSubMeshes)for(const c of s.subMeshes){const n=c.getMaterial();n&&n.hasRenderTargetTextures&&n.getRenderTargetTextures!=null&&this._processedMaterials.indexOf(n)===-1&&(this._processedMaterials.push(n),this._materialsRenderTargets.concatWithNoDuplicate(n.getRenderTargetTextures()))}else i.hasRenderTargetTextures&&i.getRenderTargetTextures!=null&&this._processedMaterials.indexOf(i)===-1&&(this._processedMaterials.push(i),this._materialsRenderTargets.concatWithNoDuplicate(i.getRenderTargetTextures()))}if(!a||!t.areAllEffectsReady())return!1;if(l){for(e=0;e<this._materialsRenderTargets.length;++e)if(!this._materialsRenderTargets.data[e].isReadyForRendering())return!1}for(e=0;e<this.geometries.length;e++)if(this.geometries[e].delayLoadState===2)return!1;if(this.activeCameras&&this.activeCameras.length>0){for(const s of this.activeCameras)if(!s.isReady(!0))return!1}else if(this.activeCamera&&!this.activeCamera.isReady(!0))return!1;for(const s of this.particleSystems)if(!s.isReady())return!1;return!0}resetCachedMaterial(){this._cachedMaterial=null,this._cachedEffect=null,this._cachedVisibility=null}registerBeforeRender(l){this.onBeforeRenderObservable.add(l)}unregisterBeforeRender(l){this.onBeforeRenderObservable.removeCallback(l)}registerAfterRender(l){this.onAfterRenderObservable.add(l)}unregisterAfterRender(l){this.onAfterRenderObservable.removeCallback(l)}_executeOnceBeforeRender(l){const e=()=>{l(),setTimeout(()=>{this.unregisterBeforeRender(e)})};this.registerBeforeRender(e)}executeOnceBeforeRender(l,e){e!==void 0?setTimeout(()=>{this._executeOnceBeforeRender(l)},e):this._executeOnceBeforeRender(l)}addPendingData(l){this._pendingData.push(l)}removePendingData(l){const e=this.isLoading,t=this._pendingData.indexOf(l);t!==-1&&this._pendingData.splice(t,1),e&&!this.isLoading&&this.onDataLoadedObservable.notifyObservers(this)}getWaitingItemsCount(){return this._pendingData.length}get isLoading(){return this._pendingData.length>0}executeWhenReady(l,e=!1){this.onReadyObservable.addOnce(l),this._executeWhenReadyTimeoutId===null&&this._checkIsReady(e)}whenReadyAsync(l=!1){return new Promise(e=>{this.executeWhenReady(()=>{e()},l)})}_checkIsReady(l=!1){if(this._registerTransientComponents(),this.isReady(l)){this.onReadyObservable.notifyObservers(this),this.onReadyObservable.clear(),this._executeWhenReadyTimeoutId=null;return}if(this._isDisposed){this.onReadyObservable.clear(),this._executeWhenReadyTimeoutId=null;return}this._executeWhenReadyTimeoutId=setTimeout(()=>{this.incrementRenderId(),this._checkIsReady(l)},100)}get animatables(){return this._activeAnimatables}resetLastAnimationTimeFrame(){this._animationTimeLast=bt.Now}getViewMatrix(){return this._viewMatrix}getProjectionMatrix(){return this._projectionMatrix}getTransformMatrix(){return this._transformMatrix}setTransformMatrix(l,e,t,a){!t&&!a&&this._multiviewSceneUbo&&(this._multiviewSceneUbo.dispose(),this._multiviewSceneUbo=null),!(this._viewUpdateFlag===l.updateFlag&&this._projectionUpdateFlag===e.updateFlag)&&(this._viewUpdateFlag=l.updateFlag,this._projectionUpdateFlag=e.updateFlag,this._viewMatrix=l,this._projectionMatrix=e,this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._frustumPlanes?We.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=We.GetPlanes(this._transformMatrix),this._multiviewSceneUbo&&this._multiviewSceneUbo.useUbo?this._updateMultiviewUbo(t,a):this._sceneUbo.useUbo&&(this._sceneUbo.updateMatrix("viewProjection",this._transformMatrix),this._sceneUbo.updateMatrix("view",this._viewMatrix),this._sceneUbo.updateMatrix("projection",this._projectionMatrix)))}getSceneUniformBuffer(){return this._multiviewSceneUbo?this._multiviewSceneUbo:this._sceneUbo}createSceneUniformBuffer(l){const e=new I(this._engine,void 0,!1,l??"scene");return e.addUniform("viewProjection",16),e.addUniform("view",16),e.addUniform("projection",16),e.addUniform("vEyePosition",4),e}setSceneUniformBuffer(l){this._sceneUbo=l,this._viewUpdateFlag=-1,this._projectionUpdateFlag=-1}getUniqueId(){return Yd.UniqueId}addMesh(l,e=!1){this._blockEntityCollection||(this.meshes.push(l),l._resyncLightSources(),l.parent||l._addToSceneRootNodes(),this.onNewMeshAddedObservable.notifyObservers(l),e&&l.getChildMeshes().forEach(t=>{this.addMesh(t)}))}removeMesh(l,e=!1){const t=this.meshes.indexOf(l);return t!==-1&&(this.meshes[t]=this.meshes[this.meshes.length-1],this.meshes.pop(),l.parent||l._removeFromSceneRootNodes()),this._inputManager._invalidateMesh(l),this.onMeshRemovedObservable.notifyObservers(l),e&&l.getChildMeshes().forEach(a=>{this.removeMesh(a)}),t}addTransformNode(l){this._blockEntityCollection||l.getScene()===this&&l._indexInSceneTransformNodesArray!==-1||(l._indexInSceneTransformNodesArray=this.transformNodes.length,this.transformNodes.push(l),l.parent||l._addToSceneRootNodes(),this.onNewTransformNodeAddedObservable.notifyObservers(l))}removeTransformNode(l){const e=l._indexInSceneTransformNodesArray;if(e!==-1){if(e!==this.transformNodes.length-1){const t=this.transformNodes[this.transformNodes.length-1];this.transformNodes[e]=t,t._indexInSceneTransformNodesArray=e}l._indexInSceneTransformNodesArray=-1,this.transformNodes.pop(),l.parent||l._removeFromSceneRootNodes()}return this.onTransformNodeRemovedObservable.notifyObservers(l),e}removeSkeleton(l){const e=this.skeletons.indexOf(l);return e!==-1&&(this.skeletons.splice(e,1),this.onSkeletonRemovedObservable.notifyObservers(l),this._executeActiveContainerCleanup(this._activeSkeletons)),e}removeMorphTargetManager(l){const e=this.morphTargetManagers.indexOf(l);return e!==-1&&this.morphTargetManagers.splice(e,1),e}removeLight(l){const e=this.lights.indexOf(l);if(e!==-1){for(const t of this.meshes)t._removeLightSource(l,!1);this.lights.splice(e,1),this.sortLightsByPriority(),l.parent||l._removeFromSceneRootNodes()}return this.onLightRemovedObservable.notifyObservers(l),e}removeCamera(l){const e=this.cameras.indexOf(l);if(e!==-1&&(this.cameras.splice(e,1),l.parent||l._removeFromSceneRootNodes()),this.activeCameras){const t=this.activeCameras.indexOf(l);t!==-1&&this.activeCameras.splice(t,1)}return this.activeCamera===l&&(this.cameras.length>0?this.activeCamera=this.cameras[0]:this.activeCamera=null),this.onCameraRemovedObservable.notifyObservers(l),e}removeParticleSystem(l){const e=this.particleSystems.indexOf(l);return e!==-1&&(this.particleSystems.splice(e,1),this._executeActiveContainerCleanup(this._activeParticleSystems)),e}removeAnimation(l){const e=this.animations.indexOf(l);return e!==-1&&this.animations.splice(e,1),e}stopAnimation(l,e,t){}removeAnimationGroup(l){const e=this.animationGroups.indexOf(l);return e!==-1&&this.animationGroups.splice(e,1),e}removeMultiMaterial(l){const e=this.multiMaterials.indexOf(l);return e!==-1&&this.multiMaterials.splice(e,1),this.onMultiMaterialRemovedObservable.notifyObservers(l),e}removeMaterial(l){const e=l._indexInSceneMaterialArray;if(e!==-1&&e<this.materials.length){if(e!==this.materials.length-1){const t=this.materials[this.materials.length-1];this.materials[e]=t,t._indexInSceneMaterialArray=e}l._indexInSceneMaterialArray=-1,this.materials.pop()}return this.onMaterialRemovedObservable.notifyObservers(l),e}removeActionManager(l){const e=this.actionManagers.indexOf(l);return e!==-1&&this.actionManagers.splice(e,1),e}removeTexture(l){const e=this.textures.indexOf(l);return e!==-1&&this.textures.splice(e,1),this.onTextureRemovedObservable.notifyObservers(l),e}addLight(l){if(!this._blockEntityCollection){this.lights.push(l),this.sortLightsByPriority(),l.parent||l._addToSceneRootNodes();for(const e of this.meshes)e.lightSources.indexOf(l)===-1&&(e.lightSources.push(l),e._resyncLightSources());this.onNewLightAddedObservable.notifyObservers(l)}}sortLightsByPriority(){this.requireLightSorting&&this.lights.sort(Vl.CompareLightsPriority)}addCamera(l){this._blockEntityCollection||(this.cameras.push(l),this.onNewCameraAddedObservable.notifyObservers(l),l.parent||l._addToSceneRootNodes())}addSkeleton(l){this._blockEntityCollection||(this.skeletons.push(l),this.onNewSkeletonAddedObservable.notifyObservers(l))}addParticleSystem(l){this._blockEntityCollection||this.particleSystems.push(l)}addAnimation(l){this._blockEntityCollection||this.animations.push(l)}addAnimationGroup(l){this._blockEntityCollection||this.animationGroups.push(l)}addMultiMaterial(l){this._blockEntityCollection||(this.multiMaterials.push(l),this.onNewMultiMaterialAddedObservable.notifyObservers(l))}addMaterial(l){this._blockEntityCollection||l.getScene()===this&&l._indexInSceneMaterialArray!==-1||(l._indexInSceneMaterialArray=this.materials.length,this.materials.push(l),this.onNewMaterialAddedObservable.notifyObservers(l))}addMorphTargetManager(l){this._blockEntityCollection||this.morphTargetManagers.push(l)}addGeometry(l){this._blockEntityCollection||(this._geometriesByUniqueId&&(this._geometriesByUniqueId[l.uniqueId]=this.geometries.length),this.geometries.push(l))}addActionManager(l){this.actionManagers.push(l)}addTexture(l){this._blockEntityCollection||(this.textures.push(l),this.onNewTextureAddedObservable.notifyObservers(l))}switchActiveCamera(l,e=!0){this._engine.getInputElement()&&(this.activeCamera&&this.activeCamera.detachControl(),this.activeCamera=l,e&&l.attachControl())}setActiveCameraById(l){const e=this.getCameraById(l);return e?(this.activeCamera=e,e):null}setActiveCameraByName(l){const e=this.getCameraByName(l);return e?(this.activeCamera=e,e):null}getAnimationGroupByName(l){for(let e=0;e<this.animationGroups.length;e++)if(this.animationGroups[e].name===l)return this.animationGroups[e];return null}_getMaterial(l,e){for(let t=0;t<this.materials.length;t++){const a=this.materials[t];if(e(a))return a}if(l)for(let t=0;t<this.multiMaterials.length;t++){const a=this.multiMaterials[t];if(e(a))return a}return null}getMaterialByUniqueID(l,e=!1){return this._getMaterial(e,t=>t.uniqueId===l)}getMaterialById(l,e=!1){return this._getMaterial(e,t=>t.id===l)}getMaterialByName(l,e=!1){return this._getMaterial(e,t=>t.name===l)}getLastMaterialById(l,e=!1){for(let t=this.materials.length-1;t>=0;t--)if(this.materials[t].id===l)return this.materials[t];if(e){for(let t=this.multiMaterials.length-1;t>=0;t--)if(this.multiMaterials[t].id===l)return this.multiMaterials[t]}return null}getTextureByUniqueId(l){for(let e=0;e<this.textures.length;e++)if(this.textures[e].uniqueId===l)return this.textures[e];return null}getTextureByName(l){for(let e=0;e<this.textures.length;e++)if(this.textures[e].name===l)return this.textures[e];return null}getCameraById(l){for(let e=0;e<this.cameras.length;e++)if(this.cameras[e].id===l)return this.cameras[e];return null}getCameraByUniqueId(l){for(let e=0;e<this.cameras.length;e++)if(this.cameras[e].uniqueId===l)return this.cameras[e];return null}getCameraByName(l){for(let e=0;e<this.cameras.length;e++)if(this.cameras[e].name===l)return this.cameras[e];return null}getBoneById(l){for(let e=0;e<this.skeletons.length;e++){const t=this.skeletons[e];for(let a=0;a<t.bones.length;a++)if(t.bones[a].id===l)return t.bones[a]}return null}getBoneByName(l){for(let e=0;e<this.skeletons.length;e++){const t=this.skeletons[e];for(let a=0;a<t.bones.length;a++)if(t.bones[a].name===l)return t.bones[a]}return null}getLightByName(l){for(let e=0;e<this.lights.length;e++)if(this.lights[e].name===l)return this.lights[e];return null}getLightById(l){for(let e=0;e<this.lights.length;e++)if(this.lights[e].id===l)return this.lights[e];return null}getLightByUniqueId(l){for(let e=0;e<this.lights.length;e++)if(this.lights[e].uniqueId===l)return this.lights[e];return null}getParticleSystemById(l){for(let e=0;e<this.particleSystems.length;e++)if(this.particleSystems[e].id===l)return this.particleSystems[e];return null}getGeometryById(l){for(let e=0;e<this.geometries.length;e++)if(this.geometries[e].id===l)return this.geometries[e];return null}_getGeometryByUniqueId(l){if(this._geometriesByUniqueId){const e=this._geometriesByUniqueId[l];if(e!==void 0)return this.geometries[e]}else for(let e=0;e<this.geometries.length;e++)if(this.geometries[e].uniqueId===l)return this.geometries[e];return null}pushGeometry(l,e){return!e&&this._getGeometryByUniqueId(l.uniqueId)?!1:(this.addGeometry(l),this.onNewGeometryAddedObservable.notifyObservers(l),!0)}removeGeometry(l){let e;if(this._geometriesByUniqueId){if(e=this._geometriesByUniqueId[l.uniqueId],e===void 0)return!1}else if(e=this.geometries.indexOf(l),e<0)return!1;if(e!==this.geometries.length-1){const t=this.geometries[this.geometries.length-1];t&&(this.geometries[e]=t,this._geometriesByUniqueId&&(this._geometriesByUniqueId[t.uniqueId]=e))}return this._geometriesByUniqueId&&(this._geometriesByUniqueId[l.uniqueId]=void 0),this.geometries.pop(),this.onGeometryRemovedObservable.notifyObservers(l),!0}getGeometries(){return this.geometries}getMeshById(l){for(let e=0;e<this.meshes.length;e++)if(this.meshes[e].id===l)return this.meshes[e];return null}getMeshesById(l){return this.meshes.filter(function(e){return e.id===l})}getTransformNodeById(l){for(let e=0;e<this.transformNodes.length;e++)if(this.transformNodes[e].id===l)return this.transformNodes[e];return null}getTransformNodeByUniqueId(l){for(let e=0;e<this.transformNodes.length;e++)if(this.transformNodes[e].uniqueId===l)return this.transformNodes[e];return null}getTransformNodesById(l){return this.transformNodes.filter(function(e){return e.id===l})}getMeshByUniqueId(l){for(let e=0;e<this.meshes.length;e++)if(this.meshes[e].uniqueId===l)return this.meshes[e];return null}getLastMeshById(l){for(let e=this.meshes.length-1;e>=0;e--)if(this.meshes[e].id===l)return this.meshes[e];return null}getLastEntryById(l){let e;for(e=this.meshes.length-1;e>=0;e--)if(this.meshes[e].id===l)return this.meshes[e];for(e=this.transformNodes.length-1;e>=0;e--)if(this.transformNodes[e].id===l)return this.transformNodes[e];for(e=this.cameras.length-1;e>=0;e--)if(this.cameras[e].id===l)return this.cameras[e];for(e=this.lights.length-1;e>=0;e--)if(this.lights[e].id===l)return this.lights[e];return null}getNodeById(l){const e=this.getMeshById(l);if(e)return e;const t=this.getTransformNodeById(l);if(t)return t;const a=this.getLightById(l);if(a)return a;const s=this.getCameraById(l);return s||this.getBoneById(l)||null}getNodeByName(l){const e=this.getMeshByName(l);if(e)return e;const t=this.getTransformNodeByName(l);if(t)return t;const a=this.getLightByName(l);if(a)return a;const s=this.getCameraByName(l);return s||this.getBoneByName(l)||null}getMeshByName(l){for(let e=0;e<this.meshes.length;e++)if(this.meshes[e].name===l)return this.meshes[e];return null}getTransformNodeByName(l){for(let e=0;e<this.transformNodes.length;e++)if(this.transformNodes[e].name===l)return this.transformNodes[e];return null}getLastSkeletonById(l){for(let e=this.skeletons.length-1;e>=0;e--)if(this.skeletons[e].id===l)return this.skeletons[e];return null}getSkeletonByUniqueId(l){for(let e=0;e<this.skeletons.length;e++)if(this.skeletons[e].uniqueId===l)return this.skeletons[e];return null}getSkeletonById(l){for(let e=0;e<this.skeletons.length;e++)if(this.skeletons[e].id===l)return this.skeletons[e];return null}getSkeletonByName(l){for(let e=0;e<this.skeletons.length;e++)if(this.skeletons[e].name===l)return this.skeletons[e];return null}getMorphTargetManagerById(l){for(let e=0;e<this.morphTargetManagers.length;e++)if(this.morphTargetManagers[e].uniqueId===l)return this.morphTargetManagers[e];return null}getMorphTargetById(l){for(let e=0;e<this.morphTargetManagers.length;++e){const t=this.morphTargetManagers[e];for(let a=0;a<t.numTargets;++a){const s=t.getTarget(a);if(s.id===l)return s}}return null}getMorphTargetByName(l){for(let e=0;e<this.morphTargetManagers.length;++e){const t=this.morphTargetManagers[e];for(let a=0;a<t.numTargets;++a){const s=t.getTarget(a);if(s.name===l)return s}}return null}getPostProcessByName(l){for(let e=0;e<this.postProcesses.length;++e){const t=this.postProcesses[e];if(t.name===l)return t}return null}isActiveMesh(l){return this._activeMeshes.indexOf(l)!==-1}get uid(){return this._uid||(this._uid=Q.RandomId()),this._uid}addExternalData(l,e){return this._externalData||(this._externalData=new Cs),this._externalData.add(l,e)}getExternalData(l){return this._externalData?this._externalData.get(l):null}getOrAddExternalDataWithFactory(l,e){return this._externalData||(this._externalData=new Cs),this._externalData.getOrAddWithFactory(l,e)}removeExternalData(l){return this._externalData.remove(l)}_evaluateSubMesh(l,e,t,a){if(a||l.isInFrustum(this._frustumPlanes)){for(const d of this._evaluateSubMeshStage)d.action(e,l);const s=l.getMaterial();s!=null&&(s.hasRenderTargetTextures&&s.getRenderTargetTextures!=null&&this._processedMaterials.indexOf(s)===-1&&(this._processedMaterials.push(s),this._materialsRenderTargets.concatWithNoDuplicate(s.getRenderTargetTextures())),this._renderingManager.dispatch(l,e,s))}}freeProcessedMaterials(){this._processedMaterials.dispose()}get blockfreeActiveMeshesAndRenderingGroups(){return this._preventFreeActiveMeshesAndRenderingGroups}set blockfreeActiveMeshesAndRenderingGroups(l){this._preventFreeActiveMeshesAndRenderingGroups!==l&&(l&&(this.freeActiveMeshes(),this.freeRenderingGroups()),this._preventFreeActiveMeshesAndRenderingGroups=l)}freeActiveMeshes(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._activeMeshes.dispose(),this.activeCamera&&this.activeCamera._activeMeshes&&this.activeCamera._activeMeshes.dispose(),this.activeCameras))for(let l=0;l<this.activeCameras.length;l++){const e=this.activeCameras[l];e&&e._activeMeshes&&e._activeMeshes.dispose()}}freeRenderingGroups(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._renderingManager&&this._renderingManager.freeRenderingGroups(),this.textures))for(let l=0;l<this.textures.length;l++){const e=this.textures[l];e&&e.renderList&&e.freeRenderingGroups()}}_isInIntermediateRendering(){return this._intermediateRendering}freezeActiveMeshes(l=!1,e,t,a=!0,s=!1){return this.executeWhenReady(()=>{if(!this.activeCamera){t&&t("No active camera found");return}if(this._frustumPlanes||this.updateTransformMatrix(),this._evaluateActiveMeshes(),this._activeMeshesFrozen=!0,this._activeMeshesFrozenButKeepClipping=s,this._skipEvaluateActiveMeshesCompletely=l,a)for(let d=0;d<this._activeMeshes.length;d++)this._activeMeshes.data[d]._freeze();e&&e()}),this}unfreezeActiveMeshes(){for(let l=0;l<this.meshes.length;l++){const e=this.meshes[l];e._internalAbstractMeshDataInfo&&(e._internalAbstractMeshDataInfo._isActive=!1)}for(let l=0;l<this._activeMeshes.length;l++)this._activeMeshes.data[l]._unFreeze();return this._activeMeshesFrozen=!1,this}_executeActiveContainerCleanup(l){!(this._engine.snapshotRendering&&this._engine.snapshotRenderingMode===1)&&this._activeMeshesFrozen&&this._activeMeshes.length||this.onBeforeRenderObservable.addOnce(()=>l.dispose())}_evaluateActiveMeshes(){var l;if(this._engine.snapshotRendering&&this._engine.snapshotRenderingMode===1){this._activeMeshes.length>0&&((l=this.activeCamera)===null||l===void 0||l._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset());return}if(this._activeMeshesFrozen&&this._activeMeshes.length){if(!this._skipEvaluateActiveMeshesCompletely){const a=this._activeMeshes.length;for(let s=0;s<a;s++)this._activeMeshes.data[s].computeWorldMatrix()}if(this._activeParticleSystems){const a=this._activeParticleSystems.length;for(let s=0;s<a;s++)this._activeParticleSystems.data[s].animate()}this._renderingManager.resetSprites();return}if(!this.activeCamera)return;this.onBeforeActiveMeshesEvaluationObservable.notifyObservers(this),this.activeCamera._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset(),this._materialsRenderTargets.reset();for(const a of this._beforeEvaluateActiveMeshStage)a.action();const e=this.getActiveMeshCandidates(),t=e.length;for(let a=0;a<t;a++){const s=e.data[a];if(s._internalAbstractMeshDataInfo._currentLODIsUpToDate=!1,s.isBlocked||(this._totalVertices.addCount(s.getTotalVertices(),!1),!s.isReady()||!s.isEnabled()||s.scaling.hasAZeroComponent))continue;s.computeWorldMatrix(),s.actionManager&&s.actionManager.hasSpecificTriggers2(12,13)&&this._meshesForIntersections.pushNoDuplicate(s);let d=this.customLODSelector?this.customLODSelector(s,this.activeCamera):s.getLOD(this.activeCamera);if(s._internalAbstractMeshDataInfo._currentLOD=d,s._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0,d!=null&&(d!==s&&d.billboardMode!==0&&d.computeWorldMatrix(),s._preActivate(),s.isVisible&&s.visibility>0&&s.layerMask&this.activeCamera.layerMask&&(this._skipFrustumClipping||s.alwaysSelectAsActiveMesh||s.isInFrustum(this._frustumPlanes)))){this._activeMeshes.push(s),this.activeCamera._activeMeshes.push(s),d!==s&&d._activate(this._renderId,!1);for(const i of this._preActiveMeshStage)i.action(s);s._activate(this._renderId,!1)&&(s.isAnInstance?s._internalAbstractMeshDataInfo._actAsRegularMesh&&(d=s):d._internalAbstractMeshDataInfo._onlyForInstances=!1,d._internalAbstractMeshDataInfo._isActive=!0,this._activeMesh(s,d)),s._postActivate()}}if(this.particlesEnabled){this.onBeforeParticlesRenderingObservable.notifyObservers(this);for(let a=0;a<this.particleSystems.length;a++){const s=this.particleSystems[a];if(!s.isStarted()||!s.emitter)continue;const d=s.emitter;(!d.position||d.isEnabled())&&(this._activeParticleSystems.push(s),s.animate(),this._renderingManager.dispatchParticles(s))}this.onAfterParticlesRenderingObservable.notifyObservers(this)}}_activeMesh(l,e){this._skeletonsEnabled&&e.skeleton!==null&&e.skeleton!==void 0&&(this._activeSkeletons.pushNoDuplicate(e.skeleton)&&(e.skeleton.prepare(),this._activeBones.addCount(e.skeleton.bones.length,!1)),e.computeBonesUsingShaders||this._softwareSkinnedMeshes.pushNoDuplicate(e));let t=l.hasInstances||l.isAnInstance||this.dispatchAllSubMeshesOfActiveMeshes||this._skipFrustumClipping||e.alwaysSelectAsActiveMesh;if(e&&e.subMeshes&&e.subMeshes.length>0){const a=this.getActiveSubMeshCandidates(e),s=a.length;t=t||s===1;for(let d=0;d<s;d++){const i=a.data[d];this._evaluateSubMesh(i,e,l,t)}}}updateTransformMatrix(l){if(this.activeCamera)if(this.activeCamera._renderingMultiview){const e=this.activeCamera._rigCameras[0],t=this.activeCamera._rigCameras[1];this.setTransformMatrix(e.getViewMatrix(),e.getProjectionMatrix(l),t.getViewMatrix(),t.getProjectionMatrix(l))}else this.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix(l))}_bindFrameBuffer(l,e=!0){l&&l._multiviewTexture?l._multiviewTexture._bindFrameBuffer():l&&l.outputRenderTarget?l.outputRenderTarget._bindFrameBuffer():this._engine._currentFrameBufferIsDefaultFrameBuffer()||this._engine.restoreDefaultFramebuffer(),e&&this._clearFrameBuffer(l)}_clearFrameBuffer(l){if(!(l&&l._multiviewTexture))if(l&&l.outputRenderTarget&&!l._renderingMultiview){const e=l.outputRenderTarget;e.onClearObservable.hasObservers()?e.onClearObservable.notifyObservers(this._engine):e.skipInitialClear||(this.autoClear&&this._engine.clear(e.clearColor||this.clearColor,!e._cleared,!0,!0),e._cleared=!0)}else this._defaultFrameBufferCleared?this._engine.clear(null,!1,!0,!0):(this._defaultFrameBufferCleared=!0,this._clear())}_renderForCamera(l,e,t=!0){var a,s,d;if(l&&l._skipRendering)return;const i=this._engine;if(this._activeCamera=l,!this.activeCamera)throw new Error("Active camera not set");if(i.setViewport(this.activeCamera.viewport),this.resetCachedMaterial(),this._renderId++,!this.prePass&&t){let n=!0;l._renderingMultiview&&l.outputRenderTarget&&(n=l.outputRenderTarget.skipInitialClear,this.autoClear&&(l.outputRenderTarget.skipInitialClear=!1)),this._bindFrameBuffer(this._activeCamera),l._renderingMultiview&&l.outputRenderTarget&&(l.outputRenderTarget.skipInitialClear=n)}this.updateTransformMatrix(),this.onBeforeCameraRenderObservable.notifyObservers(this.activeCamera),this._evaluateActiveMeshes();for(let n=0;n<this._softwareSkinnedMeshes.length;n++){const h=this._softwareSkinnedMeshes.data[n];h.applySkeleton(h.skeleton)}this.onBeforeRenderTargetsRenderObservable.notifyObservers(this),this._renderTargets.concatWithNoDuplicate(this._materialsRenderTargets),l.customRenderTargets&&l.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(l.customRenderTargets),e&&e.customRenderTargets&&e.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(e.customRenderTargets),this.environmentTexture&&this.environmentTexture.isRenderTarget&&this._renderTargets.pushNoDuplicate(this.environmentTexture);for(const n of this._gatherActiveCameraRenderTargetsStage)n.action(this._renderTargets);let c=!1;if(this.renderTargetsEnabled){if(this._intermediateRendering=!0,this._renderTargets.length>0){Q.StartPerformanceCounter("Render targets",this._renderTargets.length>0);for(let n=0;n<this._renderTargets.length;n++){const h=this._renderTargets.data[n];if(h._shouldRender()){this._renderId++;const m=h.activeCamera&&h.activeCamera!==this.activeCamera;h.render(m,this.dumpNextRenderTargets),c=!0}}Q.EndPerformanceCounter("Render targets",this._renderTargets.length>0),this._renderId++}for(const n of this._cameraDrawRenderTargetStage)c=n.action(this.activeCamera)||c;this._intermediateRendering=!1}this._engine.currentRenderPassId=(d=(s=(a=l.outputRenderTarget)===null||a===void 0?void 0:a.renderPassId)!==null&&s!==void 0?s:l.renderPassId)!==null&&d!==void 0?d:0,c&&!this.prePass&&this._bindFrameBuffer(this._activeCamera,!1),this.onAfterRenderTargetsRenderObservable.notifyObservers(this),this.postProcessManager&&!l._multiviewTexture&&!this.prePass&&this.postProcessManager._prepareFrame();for(const n of this._beforeCameraDrawStage)n.action(this.activeCamera);this.onBeforeDrawPhaseObservable.notifyObservers(this),i.snapshotRendering&&i.snapshotRenderingMode===1&&this.finalizeSceneUbo(),this._renderingManager.render(null,null,!0,!0),this.onAfterDrawPhaseObservable.notifyObservers(this);for(const n of this._afterCameraDrawStage)n.action(this.activeCamera);if(this.postProcessManager&&!l._multiviewTexture){const n=l.outputRenderTarget?l.outputRenderTarget.renderTarget:void 0;this.postProcessManager._finalizeFrame(l.isIntermediate,n)}for(const n of this._afterCameraPostProcessStage)n.action(this.activeCamera);this._renderTargets.reset(),this.onAfterCameraRenderObservable.notifyObservers(this.activeCamera)}_processSubCameras(l,e=!0){if(l.cameraRigMode===0||l._renderingMultiview){l._renderingMultiview&&!this._multiviewSceneUbo&&this._createMultiviewUbo(),this._renderForCamera(l,void 0,e),this.onAfterRenderCameraObservable.notifyObservers(l);return}if(l._useMultiviewToSingleView)this._renderMultiviewToSingleView(l);else{this.onBeforeCameraRenderObservable.notifyObservers(l);for(let t=0;t<l._rigCameras.length;t++)this._renderForCamera(l._rigCameras[t],l)}this._activeCamera=l,this.updateTransformMatrix(),this.onAfterRenderCameraObservable.notifyObservers(l)}_checkIntersections(){for(let l=0;l<this._meshesForIntersections.length;l++){const e=this._meshesForIntersections.data[l];if(e.actionManager)for(let t=0;e.actionManager&&t<e.actionManager.actions.length;t++){const a=e.actionManager.actions[t];if(a.trigger===12||a.trigger===13){const s=a.getTriggerParameter(),d=s.mesh?s.mesh:s,i=d.intersectsMesh(e,s.usePreciseIntersection),c=e._intersectionsInProgress.indexOf(d);i&&c===-1?a.trigger===12?(a._executeCurrent(Il.CreateNew(e,void 0,d)),e._intersectionsInProgress.push(d)):a.trigger===13&&e._intersectionsInProgress.push(d):!i&&c>-1&&(a.trigger===13&&a._executeCurrent(Il.CreateNew(e,void 0,d)),(!e.actionManager.hasSpecificTrigger(13,n=>{const h=n.mesh?n.mesh:n;return d===h})||a.trigger===13)&&e._intersectionsInProgress.splice(c,1))}}}}_advancePhysicsEngineStep(l){}_animate(){}animate(){if(this._engine.isDeterministicLockStep()){let l=Math.max(sl.MinDeltaTime,Math.min(this._engine.getDeltaTime(),sl.MaxDeltaTime))+this._timeAccumulator;const e=this._engine.getTimeStep(),t=1e3/e/1e3;let a=0;const s=this._engine.getLockstepMaxSteps();let d=Math.floor(l/e);for(d=Math.min(d,s);l>0&&a<d;)this.onBeforeStepObservable.notifyObservers(this),this._animationRatio=e*t,this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(e),this.onAfterStepObservable.notifyObservers(this),this._currentStepId++,a++,l-=e;this._timeAccumulator=l<0?0:l}else{const l=this.useConstantAnimationDeltaTime?16:Math.max(sl.MinDeltaTime,Math.min(this._engine.getDeltaTime(),sl.MaxDeltaTime));this._animationRatio=l*(60/1e3),this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(l)}}_clear(){(this.autoClearDepthAndStencil||this.autoClear)&&this._engine.clear(this.clearColor,this.autoClear||this.forceWireframe||this.forcePointsCloud,this.autoClearDepthAndStencil,this.autoClearDepthAndStencil)}_checkCameraRenderTarget(l){var e;if(l!=null&&l.outputRenderTarget&&!(l!=null&&l.isRigCamera)&&(l.outputRenderTarget._cleared=!1),!((e=l==null?void 0:l.rigCameras)===null||e===void 0)&&e.length)for(let t=0;t<l.rigCameras.length;++t){const a=l.rigCameras[t].outputRenderTarget;a&&(a._cleared=!1)}}resetDrawCache(l){if(this.meshes)for(const e of this.meshes)e.resetDrawCache(l)}render(l=!0,e=!1){var t,a,s;if(this.isDisposed)return;this.onReadyObservable.hasObservers()&&this._executeWhenReadyTimeoutId===null&&this._checkIsReady(),this._frameId++,this._defaultFrameBufferCleared=!1,this._checkCameraRenderTarget(this.activeCamera),!((t=this.activeCameras)===null||t===void 0)&&t.length&&this.activeCameras.forEach(this._checkCameraRenderTarget),this._registerTransientComponents(),this._activeParticles.fetchNewFrame(),this._totalVertices.fetchNewFrame(),this._activeIndices.fetchNewFrame(),this._activeBones.fetchNewFrame(),this._meshesForIntersections.reset(),this.resetCachedMaterial(),this.onBeforeAnimationsObservable.notifyObservers(this),this.actionManager&&this.actionManager.processTrigger(11),e||this.animate();for(const c of this._beforeCameraUpdateStage)c.action();if(l){if(this.activeCameras&&this.activeCameras.length>0)for(let c=0;c<this.activeCameras.length;c++){const n=this.activeCameras[c];if(n.update(),n.cameraRigMode!==0)for(let h=0;h<n._rigCameras.length;h++)n._rigCameras[h].update()}else if(this.activeCamera&&(this.activeCamera.update(),this.activeCamera.cameraRigMode!==0))for(let c=0;c<this.activeCamera._rigCameras.length;c++)this.activeCamera._rigCameras[c].update()}this.onBeforeRenderObservable.notifyObservers(this);const d=this.getEngine();this.onBeforeRenderTargetsRenderObservable.notifyObservers(this);const i=!((a=this.activeCameras)===null||a===void 0)&&a.length?this.activeCameras[0]:this.activeCamera;if(this.renderTargetsEnabled){Q.StartPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!0;for(let c=0;c<this.customRenderTargets.length;c++){const n=this.customRenderTargets[c];if(n._shouldRender()){if(this._renderId++,this.activeCamera=n.activeCamera||this.activeCamera,!this.activeCamera)throw new Error("Active camera not set");d.setViewport(this.activeCamera.viewport),this.updateTransformMatrix(),n.render(i!==this.activeCamera,this.dumpNextRenderTargets)}}Q.EndPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!1,this._renderId++}this._engine.currentRenderPassId=(s=i==null?void 0:i.renderPassId)!==null&&s!==void 0?s:0,this.activeCamera=i,this._activeCamera&&this._activeCamera.cameraRigMode!==22&&!this.prePass&&this._bindFrameBuffer(this._activeCamera,!1),this.onAfterRenderTargetsRenderObservable.notifyObservers(this);for(const c of this._beforeClearStage)c.action();this._clearFrameBuffer(this.activeCamera);for(const c of this._gatherRenderTargetsStage)c.action(this._renderTargets);if(this.activeCameras&&this.activeCameras.length>0)for(let c=0;c<this.activeCameras.length;c++)this._processSubCameras(this.activeCameras[c],c>0);else{if(!this.activeCamera)throw new Error("No camera defined");this._processSubCameras(this.activeCamera,!!this.activeCamera.outputRenderTarget)}this._checkIntersections();for(const c of this._afterRenderStage)c.action();if(this.afterRender&&this.afterRender(),this.onAfterRenderObservable.notifyObservers(this),this._toBeDisposed.length){for(let c=0;c<this._toBeDisposed.length;c++){const n=this._toBeDisposed[c];n&&n.dispose()}this._toBeDisposed.length=0}this.dumpNextRenderTargets&&(this.dumpNextRenderTargets=!1),this._activeBones.addCount(0,!0),this._activeIndices.addCount(0,!0),this._activeParticles.addCount(0,!0),this._engine.restoreDefaultFramebuffer()}freezeMaterials(){for(let l=0;l<this.materials.length;l++)this.materials[l].freeze()}unfreezeMaterials(){for(let l=0;l<this.materials.length;l++)this.materials[l].unfreeze()}dispose(){if(this.isDisposed)return;this.beforeRender=null,this.afterRender=null,this.metadata=null,this.skeletons.length=0,this.morphTargetManagers.length=0,this._transientComponents.length=0,this._isReadyForMeshStage.clear(),this._beforeEvaluateActiveMeshStage.clear(),this._evaluateSubMeshStage.clear(),this._preActiveMeshStage.clear(),this._cameraDrawRenderTargetStage.clear(),this._beforeCameraDrawStage.clear(),this._beforeRenderTargetDrawStage.clear(),this._beforeRenderingGroupDrawStage.clear(),this._beforeRenderingMeshStage.clear(),this._afterRenderingMeshStage.clear(),this._afterRenderingGroupDrawStage.clear(),this._afterCameraDrawStage.clear(),this._afterRenderTargetDrawStage.clear(),this._afterRenderStage.clear(),this._beforeCameraUpdateStage.clear(),this._beforeClearStage.clear(),this._gatherRenderTargetsStage.clear(),this._gatherActiveCameraRenderTargetsStage.clear(),this._pointerMoveStage.clear(),this._pointerDownStage.clear(),this._pointerUpStage.clear(),this.importedMeshesFiles=new Array,this.stopAllAnimations&&this.stopAllAnimations(),this.resetCachedMaterial(),this.activeCamera&&(this.activeCamera._activeMeshes.dispose(),this.activeCamera=null),this.activeCameras=null,this._activeMeshes.dispose(),this._renderingManager.dispose(),this._processedMaterials.dispose(),this._activeParticleSystems.dispose(),this._activeSkeletons.dispose(),this._softwareSkinnedMeshes.dispose(),this._renderTargets.dispose(),this._materialsRenderTargets.dispose(),this._registeredForLateAnimationBindings.dispose(),this._meshesForIntersections.dispose(),this._toBeDisposed.length=0;const l=this._activeRequests.slice();for(const a of l)a.abort();this._activeRequests.length=0;try{this.onDisposeObservable.notifyObservers(this)}catch(a){console.error("An error occurred while calling onDisposeObservable!",a)}if(this.onDisposeObservable.clear(),this.onBeforeRenderObservable.clear(),this.onAfterRenderObservable.clear(),this.onBeforeRenderTargetsRenderObservable.clear(),this.onAfterRenderTargetsRenderObservable.clear(),this.onAfterStepObservable.clear(),this.onBeforeStepObservable.clear(),this.onBeforeActiveMeshesEvaluationObservable.clear(),this.onAfterActiveMeshesEvaluationObservable.clear(),this.onBeforeParticlesRenderingObservable.clear(),this.onAfterParticlesRenderingObservable.clear(),this.onBeforeDrawPhaseObservable.clear(),this.onAfterDrawPhaseObservable.clear(),this.onBeforeAnimationsObservable.clear(),this.onAfterAnimationsObservable.clear(),this.onDataLoadedObservable.clear(),this.onBeforeRenderingGroupObservable.clear(),this.onAfterRenderingGroupObservable.clear(),this.onMeshImportedObservable.clear(),this.onBeforeCameraRenderObservable.clear(),this.onAfterCameraRenderObservable.clear(),this.onReadyObservable.clear(),this.onNewCameraAddedObservable.clear(),this.onCameraRemovedObservable.clear(),this.onNewLightAddedObservable.clear(),this.onLightRemovedObservable.clear(),this.onNewGeometryAddedObservable.clear(),this.onGeometryRemovedObservable.clear(),this.onNewTransformNodeAddedObservable.clear(),this.onTransformNodeRemovedObservable.clear(),this.onNewMeshAddedObservable.clear(),this.onMeshRemovedObservable.clear(),this.onNewSkeletonAddedObservable.clear(),this.onSkeletonRemovedObservable.clear(),this.onNewMaterialAddedObservable.clear(),this.onNewMultiMaterialAddedObservable.clear(),this.onMaterialRemovedObservable.clear(),this.onMultiMaterialRemovedObservable.clear(),this.onNewTextureAddedObservable.clear(),this.onTextureRemovedObservable.clear(),this.onPrePointerObservable.clear(),this.onPointerObservable.clear(),this.onPreKeyboardObservable.clear(),this.onKeyboardObservable.clear(),this.onActiveCameraChanged.clear(),this.detachControl(),this._engine.getInputElement())for(let a=0;a<this.cameras.length;a++)this.cameras[a].detachControl();this._disposeList(this.animationGroups),this._disposeList(this.lights),this._disposeList(this.meshes,a=>a.dispose(!0)),this._disposeList(this.transformNodes,a=>a.dispose(!0));const e=this.cameras;this._disposeList(e),this._defaultMaterial&&this._defaultMaterial.dispose(),this._disposeList(this.multiMaterials),this._disposeList(this.materials),this._disposeList(this.particleSystems),this._disposeList(this.postProcesses),this._disposeList(this.textures),this._disposeList(this.morphTargetManagers),this._sceneUbo.dispose(),this._multiviewSceneUbo&&this._multiviewSceneUbo.dispose(),this.postProcessManager.dispose(),this._disposeList(this._components);let t=this._engine.scenes.indexOf(this);t>-1&&this._engine.scenes.splice(t,1),bl._LastCreatedScene===this&&(this._engine.scenes.length>0?bl._LastCreatedScene=this._engine.scenes[this._engine.scenes.length-1]:bl._LastCreatedScene=null),t=this._engine._virtualScenes.indexOf(this),t>-1&&this._engine._virtualScenes.splice(t,1),this._engine.wipeCaches(!0),this._isDisposed=!0}_disposeList(l,e){const t=l.slice(0);e=e??(a=>a.dispose());for(const a of t)e(a);l.length=0}get isDisposed(){return this._isDisposed}clearCachedVertexData(){for(let l=0;l<this.meshes.length;l++){const e=this.meshes[l].geometry;e&&e.clearCachedData()}}cleanCachedTextureBuffer(){for(const l of this.textures)l._buffer&&(l._buffer=null)}getWorldExtends(l){const e=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t=new r(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return l=l||(()=>!0),this.meshes.filter(l).forEach(a=>{if(a.computeWorldMatrix(!0),!a.subMeshes||a.subMeshes.length===0||a.infiniteDistance)return;const s=a.getBoundingInfo(),d=s.boundingBox.minimumWorld,i=s.boundingBox.maximumWorld;r.CheckExtends(d,e,t),r.CheckExtends(i,e,t)}),{min:e,max:t}}createPickingRay(l,e,t,a,s=!1){throw O("Ray")}createPickingRayToRef(l,e,t,a,s,d=!1,i=!1){throw O("Ray")}createPickingRayInCameraSpace(l,e,t){throw O("Ray")}createPickingRayInCameraSpaceToRef(l,e,t,a){throw O("Ray")}get _pickingAvailable(){return!1}pick(l,e,t,a,s,d){return new we}pickWithBoundingInfo(l,e,t,a,s){return new we}pickWithRay(l,e,t,a){throw O("Ray")}multiPick(l,e,t,a,s){throw O("Ray")}multiPickWithRay(l,e,t){throw O("Ray")}setPointerOverMesh(l,e,t){this._inputManager.setPointerOverMesh(l,e,t)}getPointerOverMesh(){return this._inputManager.getPointerOverMesh()}_rebuildGeometries(){for(const l of this.geometries)l._rebuild();for(const l of this.meshes)l._rebuild();this.postProcessManager&&this.postProcessManager._rebuild();for(const l of this._components)l.rebuild();for(const l of this.particleSystems)l.rebuild();if(this.spriteManagers)for(const l of this.spriteManagers)l.rebuild()}_rebuildTextures(){for(const l of this.textures)l._rebuild();this.markAllMaterialsAsDirty(1)}_getByTags(l,e,t){if(e===void 0)return l;const a=[];t=t||(s=>{});for(const s in l){const d=l[s];ul&&ul.MatchesQuery(d,e)&&(a.push(d),t(d))}return a}getMeshesByTags(l,e){return this._getByTags(this.meshes,l,e)}getCamerasByTags(l,e){return this._getByTags(this.cameras,l,e)}getLightsByTags(l,e){return this._getByTags(this.lights,l,e)}getMaterialByTags(l,e){return this._getByTags(this.materials,l,e).concat(this._getByTags(this.multiMaterials,l,e))}getTransformNodesByTags(l,e){return this._getByTags(this.transformNodes,l,e)}setRenderingOrder(l,e=null,t=null,a=null){this._renderingManager.setRenderingOrder(l,e,t,a)}setRenderingAutoClearDepthStencil(l,e,t=!0,a=!0){this._renderingManager.setRenderingAutoClearDepthStencil(l,e,t,a)}getAutoClearDepthStencilSetup(l){return this._renderingManager.getAutoClearDepthStencilSetup(l)}get blockMaterialDirtyMechanism(){return this._blockMaterialDirtyMechanism}set blockMaterialDirtyMechanism(l){this._blockMaterialDirtyMechanism!==l&&(this._blockMaterialDirtyMechanism=l,l||this.markAllMaterialsAsDirty(63))}markAllMaterialsAsDirty(l,e){if(!this._blockMaterialDirtyMechanism)for(const t of this.materials)e&&!e(t)||t.markAsDirty(l)}_loadFile(l,e,t,a,s,d,i){const c=at(l,e,t,a?this.offlineProvider:void 0,s,d,i);return this._activeRequests.push(c),c.onCompleteObservable.add(n=>{this._activeRequests.splice(this._activeRequests.indexOf(n),1)}),c}_loadFileAsync(l,e,t,a,s){return new Promise((d,i)=>{this._loadFile(l,c=>{d(c)},e,t,a,(c,n)=>{i(n)},s)})}_requestFile(l,e,t,a,s,d,i){const c=Ws(l,e,t,a?this.offlineProvider:void 0,s,d,i);return this._activeRequests.push(c),c.onCompleteObservable.add(n=>{this._activeRequests.splice(this._activeRequests.indexOf(n),1)}),c}_requestFileAsync(l,e,t,a,s){return new Promise((d,i)=>{this._requestFile(l,c=>{d(c)},e,t,a,c=>{i(c)},s)})}_readFile(l,e,t,a,s){const d=wt(l,e,t,a,s);return this._activeRequests.push(d),d.onCompleteObservable.add(i=>{this._activeRequests.splice(this._activeRequests.indexOf(i),1)}),d}_readFileAsync(l,e,t){return new Promise((a,s)=>{this._readFile(l,d=>{a(d)},e,t,d=>{s(d)})})}getPerfCollector(){throw O("performanceViewerSceneExtension")}}sl.FOGMODE_NONE=0;sl.FOGMODE_EXP=1;sl.FOGMODE_EXP2=2;sl.FOGMODE_LINEAR=3;sl.MinDeltaTime=1;sl.MaxDeltaTime=1e3;sl.prototype.setActiveCameraByID=function(Z){return this.setActiveCameraById(Z)};sl.prototype.getLastMaterialByID=function(Z){return this.getLastMaterialById(Z)};sl.prototype.getMaterialByID=function(Z){return this.getMaterialById(Z)};sl.prototype.getTextureByUniqueID=function(Z){return this.getTextureByUniqueId(Z)};sl.prototype.getCameraByID=function(Z){return this.getCameraById(Z)};sl.prototype.getCameraByUniqueID=function(Z){return this.getCameraByUniqueId(Z)};sl.prototype.getBoneByID=function(Z){return this.getBoneById(Z)};sl.prototype.getLightByID=function(Z){return this.getLightById(Z)};sl.prototype.getLightByUniqueID=function(Z){return this.getLightByUniqueId(Z)};sl.prototype.getParticleSystemByID=function(Z){return this.getParticleSystemById(Z)};sl.prototype.getGeometryByID=function(Z){return this.getGeometryById(Z)};sl.prototype.getMeshByID=function(Z){return this.getMeshById(Z)};sl.prototype.getMeshesByID=function(Z){return this.getMeshesById(Z)};sl.prototype.getTransformNodeByID=function(Z){return this.getTransformNodeById(Z)};sl.prototype.getTransformNodeByUniqueID=function(Z){return this.getTransformNodeByUniqueId(Z)};sl.prototype.getTransformNodesByID=function(Z){return this.getTransformNodesById(Z)};sl.prototype.getMeshByUniqueID=function(Z){return this.getMeshByUniqueId(Z)};sl.prototype.getLastMeshByID=function(Z){return this.getLastMeshById(Z)};sl.prototype.getLastEntryByID=function(Z){return this.getLastEntryById(Z)};sl.prototype.getNodeByID=function(Z){return this.getNodeById(Z)};sl.prototype.getLastSkeletonByID=function(Z){return this.getLastSkeletonById(Z)};function ns(Z,l,e){try{const t=Z.next();t.done?l(t):t.value?t.value.then(()=>{t.value=void 0,l(t)},e):l(t)}catch(t){e(t)}}function Bi(Z=25){let l;return(e,t,a)=>{const s=performance.now();l===void 0||s-l>Z?(l=s,setTimeout(()=>{ns(e,t,a)},0)):ns(e,t,a)}}function Nd(Z,l,e,t,a){const s=()=>{let d;const i=c=>{c.done?e(c.value):d===void 0?d=!0:s()};do d=void 0,!a||!a.aborted?l(Z,i,t):t(new Error("Aborted")),d===void 0&&(d=!1);while(d)};s()}function Ns(Z,l){let e;return Nd(Z,ns,t=>e=t,t=>{throw t},l),e}function Qi(Z,l,e){return new Promise((t,a)=>{Nd(Z,l,t,a,e)})}function Pi(Z,l){return(...e)=>Ns(Z(...e),l)}class wi{constructor(){this._doNotSerialize=!1,this._isDisposed=!1,this._sceneRootNodesIndex=-1,this._isEnabled=!0,this._isParentEnabled=!0,this._isReady=!0,this._onEnabledStateChangedObservable=new z,this._onClonedObservable=new z}}class Bl{constructor(l,e=null){this._isDirty=!1,this._nodeDataStorage=new wi,this.state="",this.metadata=null,this.reservedDataStore=null,this._accessibilityTag=null,this.onAccessibilityTagChangedObservable=new z,this._parentContainer=null,this.animations=new Array,this._ranges={},this.onReady=null,this._currentRenderId=-1,this._parentUpdateId=-1,this._childUpdateId=-1,this._waitingParentId=null,this._waitingParentInstanceIndex=null,this._waitingParsedUniqueId=null,this._cache={},this._parentNode=null,this._children=null,this._worldMatrix=Y.Identity(),this._worldMatrixDeterminant=0,this._worldMatrixDeterminantIsDirty=!0,this._animationPropertiesOverride=null,this._isNode=!0,this.onDisposeObservable=new z,this._onDisposeObserver=null,this._behaviors=new Array,this.name=l,this.id=l,this._scene=e||bl.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._initCache()}static AddNodeConstructor(l,e){this._NodeConstructors[l]=e}static Construct(l,e,t,a){const s=this._NodeConstructors[l];return s?s(e,t,a):null}set accessibilityTag(l){this._accessibilityTag=l,this.onAccessibilityTagChangedObservable.notifyObservers(l)}get accessibilityTag(){return this._accessibilityTag}get doNotSerialize(){return this._nodeDataStorage._doNotSerialize?!0:this._parentNode?this._parentNode.doNotSerialize:!1}set doNotSerialize(l){this._nodeDataStorage._doNotSerialize=l}isDisposed(){return this._nodeDataStorage._isDisposed}set parent(l){if(this._parentNode===l)return;const e=this._parentNode;if(this._parentNode&&this._parentNode._children!==void 0&&this._parentNode._children!==null){const t=this._parentNode._children.indexOf(this);t!==-1&&this._parentNode._children.splice(t,1),!l&&!this._nodeDataStorage._isDisposed&&this._addToSceneRootNodes()}this._parentNode=l,this._parentNode&&((this._parentNode._children===void 0||this._parentNode._children===null)&&(this._parentNode._children=new Array),this._parentNode._children.push(this),e||this._removeFromSceneRootNodes()),this._syncParentEnabledState()}get parent(){return this._parentNode}_serializeAsParent(l){l.parentId=this.uniqueId}_addToSceneRootNodes(){this._nodeDataStorage._sceneRootNodesIndex===-1&&(this._nodeDataStorage._sceneRootNodesIndex=this._scene.rootNodes.length,this._scene.rootNodes.push(this))}_removeFromSceneRootNodes(){if(this._nodeDataStorage._sceneRootNodesIndex!==-1){const l=this._scene.rootNodes,e=l.length-1;l[this._nodeDataStorage._sceneRootNodesIndex]=l[e],l[this._nodeDataStorage._sceneRootNodesIndex]._nodeDataStorage._sceneRootNodesIndex=this._nodeDataStorage._sceneRootNodesIndex,this._scene.rootNodes.pop(),this._nodeDataStorage._sceneRootNodesIndex=-1}}get animationPropertiesOverride(){return this._animationPropertiesOverride?this._animationPropertiesOverride:this._scene.animationPropertiesOverride}set animationPropertiesOverride(l){this._animationPropertiesOverride=l}getClassName(){return"Node"}set onDispose(l){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(l)}get onEnabledStateChangedObservable(){return this._nodeDataStorage._onEnabledStateChangedObservable}get onClonedObservable(){return this._nodeDataStorage._onClonedObservable}getScene(){return this._scene}getEngine(){return this._scene.getEngine()}addBehavior(l,e=!1){return this._behaviors.indexOf(l)!==-1?this:(l.init(),this._scene.isLoading&&!e?this._scene.onDataLoadedObservable.addOnce(()=>{l.attach(this)}):l.attach(this),this._behaviors.push(l),this)}removeBehavior(l){const e=this._behaviors.indexOf(l);return e===-1?this:(this._behaviors[e].detach(),this._behaviors.splice(e,1),this)}get behaviors(){return this._behaviors}getBehaviorByName(l){for(const e of this._behaviors)if(e.name===l)return e;return null}getWorldMatrix(){return this._currentRenderId!==this._scene.getRenderId()&&this.computeWorldMatrix(),this._worldMatrix}_getWorldMatrixDeterminant(){return this._worldMatrixDeterminantIsDirty&&(this._worldMatrixDeterminantIsDirty=!1,this._worldMatrixDeterminant=this._worldMatrix.determinant()),this._worldMatrixDeterminant}get worldMatrixFromCache(){return this._worldMatrix}_initCache(){this._cache={},this._cache.parent=void 0}updateCache(l){!l&&this.isSynchronized()||(this._cache.parent=this.parent,this._updateCache())}_getActionManagerForTrigger(l,e=!0){return this.parent?this.parent._getActionManagerForTrigger(l,!1):null}_updateCache(l){}_isSynchronized(){return!0}_markSyncedWithParent(){this._parentNode&&(this._parentUpdateId=this._parentNode._childUpdateId)}isSynchronizedWithParent(){return this._parentNode?this._parentNode._isDirty||this._parentUpdateId!==this._parentNode._childUpdateId?!1:this._parentNode.isSynchronized():!0}isSynchronized(){return this._cache.parent!==this._parentNode?(this._cache.parent=this._parentNode,!1):this._parentNode&&!this.isSynchronizedWithParent()?!1:this._isSynchronized()}isReady(l=!1){return this._nodeDataStorage._isReady}markAsDirty(l){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}isEnabled(l=!0){return l===!1?this._nodeDataStorage._isEnabled:this._nodeDataStorage._isEnabled?this._nodeDataStorage._isParentEnabled:!1}_syncParentEnabledState(){this._nodeDataStorage._isParentEnabled=this._parentNode?this._parentNode.isEnabled():!0,this._children&&this._children.forEach(l=>{l._syncParentEnabledState()})}setEnabled(l){this._nodeDataStorage._isEnabled!==l&&(this._nodeDataStorage._isEnabled=l,this._syncParentEnabledState(),this._nodeDataStorage._onEnabledStateChangedObservable.notifyObservers(l))}isDescendantOf(l){return this.parent?this.parent===l?!0:this.parent.isDescendantOf(l):!1}_getDescendants(l,e=!1,t){if(this._children)for(let a=0;a<this._children.length;a++){const s=this._children[a];(!t||t(s))&&l.push(s),e||s._getDescendants(l,!1,t)}}getDescendants(l,e){const t=new Array;return this._getDescendants(t,l,e),t}getChildMeshes(l,e){const t=[];return this._getDescendants(t,l,a=>(!e||e(a))&&a.cullingStrategy!==void 0),t}getChildren(l,e=!0){return this.getDescendants(e,l)}_setReady(l){if(l!==this._nodeDataStorage._isReady){if(!l){this._nodeDataStorage._isReady=!1;return}this.onReady&&this.onReady(this),this._nodeDataStorage._isReady=!0}}getAnimationByName(l){for(let e=0;e<this.animations.length;e++){const t=this.animations[e];if(t.name===l)return t}return null}createAnimationRange(l,e,t){if(!this._ranges[l]){this._ranges[l]=Bl._AnimationRangeFactory(l,e,t);for(let a=0,s=this.animations.length;a<s;a++)this.animations[a]&&this.animations[a].createRange(l,e,t)}}deleteAnimationRange(l,e=!0){for(let t=0,a=this.animations.length;t<a;t++)this.animations[t]&&this.animations[t].deleteRange(l,e);this._ranges[l]=null}getAnimationRange(l){return this._ranges[l]||null}getAnimationRanges(){const l=[];let e;for(e in this._ranges)l.push(this._ranges[e]);return l}beginAnimation(l,e,t,a){const s=this.getAnimationRange(l);return s?this._scene.beginAnimation(this,s.from,s.to,e,t,a):null}serializeAnimationRanges(){const l=[];for(const e in this._ranges){const t=this._ranges[e];if(!t)continue;const a={};a.name=e,a.from=t.from,a.to=t.to,l.push(a)}return l}computeWorldMatrix(l){return this._worldMatrix||(this._worldMatrix=Y.Identity()),this._worldMatrix}dispose(l,e=!1){if(this._nodeDataStorage._isDisposed=!0,!l){const t=this.getDescendants(!0);for(const a of t)a.dispose(l,e)}this.parent?this.parent=null:this._removeFromSceneRootNodes(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onEnabledStateChangedObservable.clear(),this.onClonedObservable.clear();for(const t of this._behaviors)t.detach();this._behaviors.length=0,this.metadata=null}static ParseAnimationRanges(l,e,t){if(e.ranges)for(let a=0;a<e.ranges.length;a++){const s=e.ranges[a];l.createAnimationRange(s.name,s.from,s.to)}}getHierarchyBoundingVectors(l=!0,e=null){this.getScene().incrementRenderId(),this.computeWorldMatrix(!0);let t,a;const s=this;if(s.getBoundingInfo&&s.subMeshes){const d=s.getBoundingInfo();t=d.boundingBox.minimumWorld.clone(),a=d.boundingBox.maximumWorld.clone()}else t=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new r(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);if(l){const d=this.getDescendants(!1);for(const i of d){const c=i;if(c.computeWorldMatrix(!0),e&&!e(c)||!c.getBoundingInfo||c.getTotalVertices()===0)continue;const n=c.getBoundingInfo().boundingBox,h=n.minimumWorld,m=n.maximumWorld;r.CheckExtends(h,t,a),r.CheckExtends(m,t,a)}}return{min:t,max:a}}}Bl._AnimationRangeFactory=(Z,l,e)=>{throw O("AnimationRange")};Bl._NodeConstructors={};W([F()],Bl.prototype,"name",void 0);W([F()],Bl.prototype,"id",void 0);W([F()],Bl.prototype,"uniqueId",void 0);W([F()],Bl.prototype,"state",void 0);W([F()],Bl.prototype,"metadata",void 0);class _t{constructor(l,e,t,a){this.x=l,this.y=e,this.width=t,this.height=a}toGlobal(l,e){return new _t(this.x*l,this.y*e,this.width*l,this.height*e)}toGlobalToRef(l,e,t){return t.x=this.x*l,t.y=this.y*e,t.width=this.width*l,t.height=this.height*e,this}clone(){return new _t(this.x,this.y,this.width,this.height)}}class j extends Bl{constructor(l,e,t,a=!0){super(l,t),this._position=r.Zero(),this._upVector=r.Up(),this._orthoLeft=null,this._orthoRight=null,this._orthoBottom=null,this._orthoTop=null,this.fov=.8,this.projectionPlaneTilt=0,this.minZ=1,this.maxZ=1e4,this.inertia=.9,this._mode=j.PERSPECTIVE_CAMERA,this.isIntermediate=!1,this.viewport=new _t(0,0,1,1),this.layerMask=268435455,this.fovMode=j.FOVMODE_VERTICAL_FIXED,this.cameraRigMode=j.RIG_MODE_NONE,this.customRenderTargets=new Array,this.outputRenderTarget=null,this.onViewMatrixChangedObservable=new z,this.onProjectionMatrixChangedObservable=new z,this.onAfterCheckInputsObservable=new z,this.onRestoreStateObservable=new z,this.isRigCamera=!1,this._rigCameras=new Array,this._webvrViewMatrix=Y.Identity(),this._skipRendering=!1,this._projectionMatrix=new Y,this._postProcesses=new Array,this._activeMeshes=new ql(256),this._globalPosition=r.Zero(),this._computedViewMatrix=Y.Identity(),this._doNotComputeProjectionMatrix=!1,this._transformMatrix=Y.Zero(),this._refreshFrustumPlanes=!0,this._absoluteRotation=_.Identity(),this._isCamera=!0,this._isLeftCamera=!1,this._isRightCamera=!1,this.getScene().addCamera(this),a&&!this.getScene().activeCamera&&(this.getScene().activeCamera=this),this.position=e,this.renderPassId=this.getScene().getEngine().createRenderPassId(`Camera ${l}`)}get position(){return this._position}set position(l){this._position=l}set upVector(l){this._upVector=l}get upVector(){return this._upVector}get screenArea(){var l,e,t,a;let s=0,d=0;if(this.mode===j.PERSPECTIVE_CAMERA)this.fovMode===j.FOVMODE_VERTICAL_FIXED?(d=this.minZ*2*Math.tan(this.fov/2),s=this.getEngine().getAspectRatio(this)*d):(s=this.minZ*2*Math.tan(this.fov/2),d=s/this.getEngine().getAspectRatio(this));else{const i=this.getEngine().getRenderWidth()/2,c=this.getEngine().getRenderHeight()/2;s=((l=this.orthoRight)!==null&&l!==void 0?l:i)-((e=this.orthoLeft)!==null&&e!==void 0?e:-i),d=((t=this.orthoTop)!==null&&t!==void 0?t:c)-((a=this.orthoBottom)!==null&&a!==void 0?a:-c)}return s*d}set orthoLeft(l){this._orthoLeft=l;for(const e of this._rigCameras)e.orthoLeft=l}get orthoLeft(){return this._orthoLeft}set orthoRight(l){this._orthoRight=l;for(const e of this._rigCameras)e.orthoRight=l}get orthoRight(){return this._orthoRight}set orthoBottom(l){this._orthoBottom=l;for(const e of this._rigCameras)e.orthoBottom=l}get orthoBottom(){return this._orthoBottom}set orthoTop(l){this._orthoTop=l;for(const e of this._rigCameras)e.orthoTop=l}get orthoTop(){return this._orthoTop}set mode(l){this._mode=l;for(const e of this._rigCameras)e.mode=l}get mode(){return this._mode}storeState(){return this._stateStored=!0,this._storedFov=this.fov,this}_restoreStateValues(){return this._stateStored?(this.fov=this._storedFov,!0):!1}restoreState(){return this._restoreStateValues()?(this.onRestoreStateObservable.notifyObservers(this),!0):!1}getClassName(){return"Camera"}toString(l){let e="Name: "+this.name;if(e+=", type: "+this.getClassName(),this.animations)for(let t=0;t<this.animations.length;t++)e+=", animation[0]: "+this.animations[t].toString(l);return e}applyVerticalCorrection(){const l=this.absoluteRotation.toEulerAngles();this.projectionPlaneTilt=this._scene.useRightHandedSystem?-l.x:l.x}get globalPosition(){return this._globalPosition}getActiveMeshes(){return this._activeMeshes}isActiveMesh(l){return this._activeMeshes.indexOf(l)!==-1}isReady(l=!1){if(l){for(const e of this._postProcesses)if(e&&!e.isReady())return!1}return super.isReady(l)}_initCache(){super._initCache(),this._cache.position=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.upVector=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.mode=void 0,this._cache.minZ=void 0,this._cache.maxZ=void 0,this._cache.fov=void 0,this._cache.fovMode=void 0,this._cache.aspectRatio=void 0,this._cache.orthoLeft=void 0,this._cache.orthoRight=void 0,this._cache.orthoBottom=void 0,this._cache.orthoTop=void 0,this._cache.renderWidth=void 0,this._cache.renderHeight=void 0}_updateCache(l){l||super._updateCache(),this._cache.position.copyFrom(this.position),this._cache.upVector.copyFrom(this.upVector)}_isSynchronized(){return this._isSynchronizedViewMatrix()&&this._isSynchronizedProjectionMatrix()}_isSynchronizedViewMatrix(){return super._isSynchronized()?this._cache.position.equals(this.position)&&this._cache.upVector.equals(this.upVector)&&this.isSynchronizedWithParent():!1}_isSynchronizedProjectionMatrix(){let l=this._cache.mode===this.mode&&this._cache.minZ===this.minZ&&this._cache.maxZ===this.maxZ;if(!l)return!1;const e=this.getEngine();return this.mode===j.PERSPECTIVE_CAMERA?l=this._cache.fov===this.fov&&this._cache.fovMode===this.fovMode&&this._cache.aspectRatio===e.getAspectRatio(this)&&this._cache.projectionPlaneTilt===this.projectionPlaneTilt:l=this._cache.orthoLeft===this.orthoLeft&&this._cache.orthoRight===this.orthoRight&&this._cache.orthoBottom===this.orthoBottom&&this._cache.orthoTop===this.orthoTop&&this._cache.renderWidth===e.getRenderWidth()&&this._cache.renderHeight===e.getRenderHeight(),l}attachControl(l,e){}detachControl(l){}update(){this._checkInputs(),this.cameraRigMode!==j.RIG_MODE_NONE&&this._updateRigCameras()}_checkInputs(){this.onAfterCheckInputsObservable.notifyObservers(this)}get rigCameras(){return this._rigCameras}get rigPostProcess(){return this._rigPostProcess}_getFirstPostProcess(){for(let l=0;l<this._postProcesses.length;l++)if(this._postProcesses[l]!==null)return this._postProcesses[l];return null}_cascadePostProcessesToRigCams(){const l=this._getFirstPostProcess();l&&l.markTextureDirty();for(let e=0,t=this._rigCameras.length;e<t;e++){const a=this._rigCameras[e],s=a._rigPostProcess;s?(s.getEffectName()==="pass"&&(a.isIntermediate=this._postProcesses.length===0),a._postProcesses=this._postProcesses.slice(0).concat(s),s.markTextureDirty()):a._postProcesses=this._postProcesses.slice(0)}}attachPostProcess(l,e=null){return!l.isReusable()&&this._postProcesses.indexOf(l)>-1?(M.Error("You're trying to reuse a post process not defined as reusable."),0):(e==null||e<0?this._postProcesses.push(l):this._postProcesses[e]===null?this._postProcesses[e]=l:this._postProcesses.splice(e,0,l),this._cascadePostProcessesToRigCams(),this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty(),this._postProcesses.indexOf(l))}detachPostProcess(l){const e=this._postProcesses.indexOf(l);e!==-1&&(this._postProcesses[e]=null),this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty(),this._cascadePostProcessesToRigCams()}getWorldMatrix(){return this._isSynchronizedViewMatrix()?this._worldMatrix:(this.getViewMatrix(),this._worldMatrix)}_getViewMatrix(){return Y.Identity()}getViewMatrix(l){return!l&&this._isSynchronizedViewMatrix()?this._computedViewMatrix:(this.updateCache(),this._computedViewMatrix=this._getViewMatrix(),this._currentRenderId=this.getScene().getRenderId(),this._childUpdateId++,this._refreshFrustumPlanes=!0,this._cameraRigParams&&this._cameraRigParams.vrPreViewMatrix&&this._computedViewMatrix.multiplyToRef(this._cameraRigParams.vrPreViewMatrix,this._computedViewMatrix),this.parent&&this.parent.onViewMatrixChangedObservable&&this.parent.onViewMatrixChangedObservable.notifyObservers(this.parent),this.onViewMatrixChangedObservable.notifyObservers(this),this._computedViewMatrix.invertToRef(this._worldMatrix),this._computedViewMatrix)}freezeProjectionMatrix(l){this._doNotComputeProjectionMatrix=!0,l!==void 0&&(this._projectionMatrix=l)}unfreezeProjectionMatrix(){this._doNotComputeProjectionMatrix=!1}getProjectionMatrix(l){var e,t,a,s,d,i,c,n;if(this._doNotComputeProjectionMatrix||!l&&this._isSynchronizedProjectionMatrix())return this._projectionMatrix;this._cache.mode=this.mode,this._cache.minZ=this.minZ,this._cache.maxZ=this.maxZ,this._refreshFrustumPlanes=!0;const h=this.getEngine(),m=this.getScene(),o=h.useReverseDepthBuffer;if(this.mode===j.PERSPECTIVE_CAMERA){this._cache.fov=this.fov,this._cache.fovMode=this.fovMode,this._cache.aspectRatio=h.getAspectRatio(this),this._cache.projectionPlaneTilt=this.projectionPlaneTilt,this.minZ<=0&&(this.minZ=.1);let b;m.useRightHandedSystem?b=Y.PerspectiveFovRHToRef:b=Y.PerspectiveFovLHToRef,b(this.fov,h.getAspectRatio(this),o?this.maxZ:this.minZ,o?this.minZ:this.maxZ,this._projectionMatrix,this.fovMode===j.FOVMODE_VERTICAL_FIXED,h.isNDCHalfZRange,this.projectionPlaneTilt,o)}else{const b=h.getRenderWidth()/2,u=h.getRenderHeight()/2;m.useRightHandedSystem?Y.OrthoOffCenterRHToRef((e=this.orthoLeft)!==null&&e!==void 0?e:-b,(t=this.orthoRight)!==null&&t!==void 0?t:b,(a=this.orthoBottom)!==null&&a!==void 0?a:-u,(s=this.orthoTop)!==null&&s!==void 0?s:u,o?this.maxZ:this.minZ,o?this.minZ:this.maxZ,this._projectionMatrix,h.isNDCHalfZRange):Y.OrthoOffCenterLHToRef((d=this.orthoLeft)!==null&&d!==void 0?d:-b,(i=this.orthoRight)!==null&&i!==void 0?i:b,(c=this.orthoBottom)!==null&&c!==void 0?c:-u,(n=this.orthoTop)!==null&&n!==void 0?n:u,o?this.maxZ:this.minZ,o?this.minZ:this.maxZ,this._projectionMatrix,h.isNDCHalfZRange),this._cache.orthoLeft=this.orthoLeft,this._cache.orthoRight=this.orthoRight,this._cache.orthoBottom=this.orthoBottom,this._cache.orthoTop=this.orthoTop,this._cache.renderWidth=h.getRenderWidth(),this._cache.renderHeight=h.getRenderHeight()}return this.onProjectionMatrixChangedObservable.notifyObservers(this),this._projectionMatrix}getTransformationMatrix(){return this._computedViewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._transformMatrix}_updateFrustumPlanes(){this._refreshFrustumPlanes&&(this.getTransformationMatrix(),this._frustumPlanes?We.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=We.GetPlanes(this._transformMatrix),this._refreshFrustumPlanes=!1)}isInFrustum(l,e=!1){if(this._updateFrustumPlanes(),e&&this.rigCameras.length>0){let t=!1;return this.rigCameras.forEach(a=>{a._updateFrustumPlanes(),t=t||l.isInFrustum(a._frustumPlanes)}),t}else return l.isInFrustum(this._frustumPlanes)}isCompletelyInFrustum(l){return this._updateFrustumPlanes(),l.isCompletelyInFrustum(this._frustumPlanes)}getForwardRay(l=100,e,t){throw O("Ray")}getForwardRayToRef(l,e=100,t,a){throw O("Ray")}dispose(l,e=!1){for(this.onViewMatrixChangedObservable.clear(),this.onProjectionMatrixChangedObservable.clear(),this.onAfterCheckInputsObservable.clear(),this.onRestoreStateObservable.clear(),this.inputs&&this.inputs.clear(),this.getScene().stopAnimation(this),this.getScene().removeCamera(this);this._rigCameras.length>0;){const a=this._rigCameras.pop();a&&a.dispose()}if(this._parentContainer){const a=this._parentContainer.cameras.indexOf(this);a>-1&&this._parentContainer.cameras.splice(a,1),this._parentContainer=null}if(this._rigPostProcess)this._rigPostProcess.dispose(this),this._rigPostProcess=null,this._postProcesses.length=0;else if(this.cameraRigMode!==j.RIG_MODE_NONE)this._rigPostProcess=null,this._postProcesses.length=0;else{let a=this._postProcesses.length;for(;--a>=0;){const s=this._postProcesses[a];s&&s.dispose(this)}}let t=this.customRenderTargets.length;for(;--t>=0;)this.customRenderTargets[t].dispose();this.customRenderTargets.length=0,this._activeMeshes.dispose(),this.getScene().getEngine().releaseRenderPassId(this.renderPassId),super.dispose(l,e)}get isLeftCamera(){return this._isLeftCamera}get isRightCamera(){return this._isRightCamera}get leftCamera(){return this._rigCameras.length<1?null:this._rigCameras[0]}get rightCamera(){return this._rigCameras.length<2?null:this._rigCameras[1]}getLeftTarget(){return this._rigCameras.length<1?null:this._rigCameras[0].getTarget()}getRightTarget(){return this._rigCameras.length<2?null:this._rigCameras[1].getTarget()}setCameraRigMode(l,e){if(this.cameraRigMode!==l){for(;this._rigCameras.length>0;){const t=this._rigCameras.pop();t&&t.dispose()}if(this.cameraRigMode=l,this._cameraRigParams={},this._cameraRigParams.interaxialDistance=e.interaxialDistance||.0637,this._cameraRigParams.stereoHalfAngle=Q.ToRadians(this._cameraRigParams.interaxialDistance/.0637),this.cameraRigMode!==j.RIG_MODE_NONE){const t=this.createRigCamera(this.name+"_L",0);t&&(t._isLeftCamera=!0);const a=this.createRigCamera(this.name+"_R",1);a&&(a._isRightCamera=!0),t&&a&&(this._rigCameras.push(t),this._rigCameras.push(a))}this._setRigMode(e),this._cascadePostProcessesToRigCams(),this.update()}}_setRigMode(l){}_getVRProjectionMatrix(){return Y.PerspectiveFovLHToRef(this._cameraRigParams.vrMetrics.aspectRatioFov,this._cameraRigParams.vrMetrics.aspectRatio,this.minZ,this.maxZ,this._cameraRigParams.vrWorkMatrix,!0,this.getEngine().isNDCHalfZRange),this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrHMatrix,this._projectionMatrix),this._projectionMatrix}_updateCameraRotationMatrix(){}_updateWebVRCameraRotationMatrix(){}_getWebVRProjectionMatrix(){return Y.Identity()}_getWebVRViewMatrix(){return Y.Identity()}setCameraRigParameter(l,e){this._cameraRigParams||(this._cameraRigParams={}),this._cameraRigParams[l]=e,l==="interaxialDistance"&&(this._cameraRigParams.stereoHalfAngle=Q.ToRadians(e/.0637))}createRigCamera(l,e){return null}_updateRigCameras(){for(let l=0;l<this._rigCameras.length;l++)this._rigCameras[l].minZ=this.minZ,this._rigCameras[l].maxZ=this.maxZ,this._rigCameras[l].fov=this.fov,this._rigCameras[l].upVector.copyFrom(this.upVector);this.cameraRigMode===j.RIG_MODE_STEREOSCOPIC_ANAGLYPH&&(this._rigCameras[0].viewport=this._rigCameras[1].viewport=this.viewport)}_setupInputs(){}serialize(){const l=il.Serialize(this);return l.uniqueId=this.uniqueId,l.type=this.getClassName(),this.parent&&this.parent._serializeAsParent(l),this.inputs&&this.inputs.serialize(l),il.AppendSerializedAnimations(this,l),l.ranges=this.serializeAnimationRanges(),l.isEnabled=this.isEnabled(),l}clone(l,e=null){const t=il.Clone(j.GetConstructorFromName(this.getClassName(),l,this.getScene(),this.interaxialDistance,this.isStereoscopicSideBySide),this);return t.name=l,t.parent=e,this.onClonedObservable.notifyObservers(t),t}getDirection(l){const e=r.Zero();return this.getDirectionToRef(l,e),e}get absoluteRotation(){return this.getWorldMatrix().decompose(void 0,this._absoluteRotation),this._absoluteRotation}getDirectionToRef(l,e){r.TransformNormalToRef(l,this.getWorldMatrix(),e)}static GetConstructorFromName(l,e,t,a=0,s=!0){return Bl.Construct(l,e,t,{interaxial_distance:a,isStereoscopicSideBySide:s})||(()=>j._CreateDefaultParsedCamera(e,t))}computeWorldMatrix(){return this.getWorldMatrix()}static Parse(l,e){const t=l.type,a=j.GetConstructorFromName(t,l.name,e,l.interaxial_distance,l.isStereoscopicSideBySide),s=il.Parse(a,l,e);if(l.parentId!==void 0&&(s._waitingParentId=l.parentId),l.parentInstanceIndex!==void 0&&(s._waitingParentInstanceIndex=l.parentInstanceIndex),s.inputs&&(s.inputs.parse(l),s._setupInputs()),l.upVector&&(s.upVector=r.FromArray(l.upVector)),s.setPosition&&(s.position.copyFromFloats(0,0,0),s.setPosition(r.FromArray(l.position))),l.target&&s.setTarget&&s.setTarget(r.FromArray(l.target)),l.cameraRigMode){const d=l.interaxial_distance?{interaxialDistance:l.interaxial_distance}:{};s.setCameraRigMode(l.cameraRigMode,d)}if(l.animations){for(let d=0;d<l.animations.length;d++){const i=l.animations[d],c=Gt("BABYLON.Animation");c&&s.animations.push(c.Parse(i))}Bl.ParseAnimationRanges(s,l,e)}return l.autoAnimate&&e.beginAnimation(s,l.autoAnimateFrom,l.autoAnimateTo,l.autoAnimateLoop,l.autoAnimateSpeed||1),l.isEnabled!==void 0&&s.setEnabled(l.isEnabled),s}}j._CreateDefaultParsedCamera=(Z,l)=>{throw O("UniversalCamera")};j.PERSPECTIVE_CAMERA=0;j.ORTHOGRAPHIC_CAMERA=1;j.FOVMODE_VERTICAL_FIXED=0;j.FOVMODE_HORIZONTAL_FIXED=1;j.RIG_MODE_NONE=0;j.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10;j.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11;j.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12;j.RIG_MODE_STEREOSCOPIC_OVERUNDER=13;j.RIG_MODE_STEREOSCOPIC_INTERLACED=14;j.RIG_MODE_VR=20;j.RIG_MODE_WEBVR=21;j.RIG_MODE_CUSTOM=22;j.ForceAttachControlToAlwaysPreventDefault=!1;W([_e("position")],j.prototype,"_position",void 0);W([_e("upVector")],j.prototype,"_upVector",void 0);W([F()],j.prototype,"orthoLeft",null);W([F()],j.prototype,"orthoRight",null);W([F()],j.prototype,"orthoBottom",null);W([F()],j.prototype,"orthoTop",null);W([F()],j.prototype,"fov",void 0);W([F()],j.prototype,"projectionPlaneTilt",void 0);W([F()],j.prototype,"minZ",void 0);W([F()],j.prototype,"maxZ",void 0);W([F()],j.prototype,"inertia",void 0);W([F()],j.prototype,"mode",null);W([F()],j.prototype,"layerMask",void 0);W([F()],j.prototype,"fovMode",void 0);W([F()],j.prototype,"cameraRigMode",void 0);W([F()],j.prototype,"interaxialDistance",void 0);W([F()],j.prototype,"isStereoscopicSideBySide",void 0);class ${constructor(){this._applyTo=Pi(this._applyToCoroutine.bind(this))}set(l,e){switch(l.length||M.Warn(`Setting vertex data kind '${e}' with an empty array`),e){case X.PositionKind:this.positions=l;break;case X.NormalKind:this.normals=l;break;case X.TangentKind:this.tangents=l;break;case X.UVKind:this.uvs=l;break;case X.UV2Kind:this.uvs2=l;break;case X.UV3Kind:this.uvs3=l;break;case X.UV4Kind:this.uvs4=l;break;case X.UV5Kind:this.uvs5=l;break;case X.UV6Kind:this.uvs6=l;break;case X.ColorKind:this.colors=l;break;case X.MatricesIndicesKind:this.matricesIndices=l;break;case X.MatricesWeightsKind:this.matricesWeights=l;break;case X.MatricesIndicesExtraKind:this.matricesIndicesExtra=l;break;case X.MatricesWeightsExtraKind:this.matricesWeightsExtra=l;break}}applyToMesh(l,e){return this._applyTo(l,e,!1),this}applyToGeometry(l,e){return this._applyTo(l,e,!1),this}updateMesh(l){return this._update(l),this}updateGeometry(l){return this._update(l),this}*_applyToCoroutine(l,e=!1,t){return this.positions&&(l.setVerticesData(X.PositionKind,this.positions,e),t&&(yield)),this.normals&&(l.setVerticesData(X.NormalKind,this.normals,e),t&&(yield)),this.tangents&&(l.setVerticesData(X.TangentKind,this.tangents,e),t&&(yield)),this.uvs&&(l.setVerticesData(X.UVKind,this.uvs,e),t&&(yield)),this.uvs2&&(l.setVerticesData(X.UV2Kind,this.uvs2,e),t&&(yield)),this.uvs3&&(l.setVerticesData(X.UV3Kind,this.uvs3,e),t&&(yield)),this.uvs4&&(l.setVerticesData(X.UV4Kind,this.uvs4,e),t&&(yield)),this.uvs5&&(l.setVerticesData(X.UV5Kind,this.uvs5,e),t&&(yield)),this.uvs6&&(l.setVerticesData(X.UV6Kind,this.uvs6,e),t&&(yield)),this.colors&&(l.setVerticesData(X.ColorKind,this.colors,e),t&&(yield)),this.matricesIndices&&(l.setVerticesData(X.MatricesIndicesKind,this.matricesIndices,e),t&&(yield)),this.matricesWeights&&(l.setVerticesData(X.MatricesWeightsKind,this.matricesWeights,e),t&&(yield)),this.matricesIndicesExtra&&(l.setVerticesData(X.MatricesIndicesExtraKind,this.matricesIndicesExtra,e),t&&(yield)),this.matricesWeightsExtra&&(l.setVerticesData(X.MatricesWeightsExtraKind,this.matricesWeightsExtra,e),t&&(yield)),this.indices?(l.setIndices(this.indices,null,e),t&&(yield)):l.setIndices([],null),this}_update(l,e,t){return this.positions&&l.updateVerticesData(X.PositionKind,this.positions,e,t),this.normals&&l.updateVerticesData(X.NormalKind,this.normals,e,t),this.tangents&&l.updateVerticesData(X.TangentKind,this.tangents,e,t),this.uvs&&l.updateVerticesData(X.UVKind,this.uvs,e,t),this.uvs2&&l.updateVerticesData(X.UV2Kind,this.uvs2,e,t),this.uvs3&&l.updateVerticesData(X.UV3Kind,this.uvs3,e,t),this.uvs4&&l.updateVerticesData(X.UV4Kind,this.uvs4,e,t),this.uvs5&&l.updateVerticesData(X.UV5Kind,this.uvs5,e,t),this.uvs6&&l.updateVerticesData(X.UV6Kind,this.uvs6,e,t),this.colors&&l.updateVerticesData(X.ColorKind,this.colors,e,t),this.matricesIndices&&l.updateVerticesData(X.MatricesIndicesKind,this.matricesIndices,e,t),this.matricesWeights&&l.updateVerticesData(X.MatricesWeightsKind,this.matricesWeights,e,t),this.matricesIndicesExtra&&l.updateVerticesData(X.MatricesIndicesExtraKind,this.matricesIndicesExtra,e,t),this.matricesWeightsExtra&&l.updateVerticesData(X.MatricesWeightsExtraKind,this.matricesWeightsExtra,e,t),this.indices&&l.setIndices(this.indices,null),this}static _TransformVector3Coordinates(l,e,t=0,a=l.length){const s=f.Vector3[0],d=f.Vector3[1];for(let i=t;i<t+a;i+=3)r.FromArrayToRef(l,i,s),r.TransformCoordinatesToRef(s,e,d),l[i]=d.x,l[i+1]=d.y,l[i+2]=d.z}static _TransformVector3Normals(l,e,t=0,a=l.length){const s=f.Vector3[0],d=f.Vector3[1];for(let i=t;i<t+a;i+=3)r.FromArrayToRef(l,i,s),r.TransformNormalToRef(s,e,d),l[i]=d.x,l[i+1]=d.y,l[i+2]=d.z}static _TransformVector4Normals(l,e,t=0,a=l.length){const s=f.Vector4[0],d=f.Vector4[1];for(let i=t;i<t+a;i+=4)Fl.FromArrayToRef(l,i,s),Fl.TransformNormalToRef(s,e,d),l[i]=d.x,l[i+1]=d.y,l[i+2]=d.z,l[i+3]=d.w}static _FlipFaces(l,e=0,t=l.length){for(let a=e;a<e+t;a+=3){const s=l[a+1];l[a+1]=l[a+2],l[a+2]=s}}transform(l){const e=l.determinant()<0;return this.positions&&$._TransformVector3Coordinates(this.positions,l),this.normals&&$._TransformVector3Normals(this.normals,l),this.tangents&&$._TransformVector4Normals(this.tangents,l),e&&this.indices&&$._FlipFaces(this.indices),this}merge(l,e=!1,t=!1){const a=Array.isArray(l)?l.map(s=>[s,void 0]):[[l,void 0]];return Ns(this._mergeCoroutine(void 0,a,e,!1,t))}*_mergeCoroutine(l,e,t=!1,a,s){var d,i,c,n;this._validate();const h=e.map(b=>b[0]);for(const b of h)if(b._validate(),!this.normals!=!b.normals||!this.tangents!=!b.tangents||!this.uvs!=!b.uvs||!this.uvs2!=!b.uvs2||!this.uvs3!=!b.uvs3||!this.uvs4!=!b.uvs4||!this.uvs5!=!b.uvs5||!this.uvs6!=!b.uvs6||!this.colors!=!b.colors||!this.matricesIndices!=!b.matricesIndices||!this.matricesWeights!=!b.matricesWeights||!this.matricesIndicesExtra!=!b.matricesIndicesExtra||!this.matricesWeightsExtra!=!b.matricesWeightsExtra)throw new Error("Cannot merge vertex data that do not have the same set of attributes");const m=h.reduce((b,u)=>{var V,G;return b+((G=(V=u.indices)===null||V===void 0?void 0:V.length)!==null&&G!==void 0?G:0)},(i=(d=this.indices)===null||d===void 0?void 0:d.length)!==null&&i!==void 0?i:0);let o=s||h.some(b=>b.indices===this.indices)?(c=this.indices)===null||c===void 0?void 0:c.slice():this.indices;if(m>0){let b=(n=o==null?void 0:o.length)!==null&&n!==void 0?n:0;if(o||(o=new Array(m)),o.length!==m){if(Array.isArray(o))o.length=m;else{const V=t||o instanceof Uint32Array?new Uint32Array(m):new Uint16Array(m);V.set(o),o=V}l&&l.determinant()<0&&$._FlipFaces(o,0,b)}let u=this.positions?this.positions.length/3:0;for(const[V,G]of e)if(V.indices){for(let p=0;p<V.indices.length;p++)o[b+p]=V.indices[p]+u;G&&G.determinant()<0&&$._FlipFaces(o,b,V.indices.length),u+=V.positions.length/3,b+=V.indices.length,a&&(yield)}}return this.indices=o,this.positions=$._MergeElement(X.PositionKind,this.positions,l,e.map(b=>[b[0].positions,b[1]])),a&&(yield),this.normals=$._MergeElement(X.NormalKind,this.normals,l,e.map(b=>[b[0].normals,b[1]])),a&&(yield),this.tangents=$._MergeElement(X.TangentKind,this.tangents,l,e.map(b=>[b[0].tangents,b[1]])),a&&(yield),this.uvs=$._MergeElement(X.UVKind,this.uvs,l,e.map(b=>[b[0].uvs,b[1]])),a&&(yield),this.uvs2=$._MergeElement(X.UV2Kind,this.uvs2,l,e.map(b=>[b[0].uvs2,b[1]])),a&&(yield),this.uvs3=$._MergeElement(X.UV3Kind,this.uvs3,l,e.map(b=>[b[0].uvs3,b[1]])),a&&(yield),this.uvs4=$._MergeElement(X.UV4Kind,this.uvs4,l,e.map(b=>[b[0].uvs4,b[1]])),a&&(yield),this.uvs5=$._MergeElement(X.UV5Kind,this.uvs5,l,e.map(b=>[b[0].uvs5,b[1]])),a&&(yield),this.uvs6=$._MergeElement(X.UV6Kind,this.uvs6,l,e.map(b=>[b[0].uvs6,b[1]])),a&&(yield),this.colors=$._MergeElement(X.ColorKind,this.colors,l,e.map(b=>[b[0].colors,b[1]])),a&&(yield),this.matricesIndices=$._MergeElement(X.MatricesIndicesKind,this.matricesIndices,l,e.map(b=>[b[0].matricesIndices,b[1]])),a&&(yield),this.matricesWeights=$._MergeElement(X.MatricesWeightsKind,this.matricesWeights,l,e.map(b=>[b[0].matricesWeights,b[1]])),a&&(yield),this.matricesIndicesExtra=$._MergeElement(X.MatricesIndicesExtraKind,this.matricesIndicesExtra,l,e.map(b=>[b[0].matricesIndicesExtra,b[1]])),a&&(yield),this.matricesWeightsExtra=$._MergeElement(X.MatricesWeightsExtraKind,this.matricesWeightsExtra,l,e.map(b=>[b[0].matricesWeightsExtra,b[1]])),this}static _MergeElement(l,e,t,a){const s=a.filter(c=>c[0]!==null&&c[0]!==void 0);if(!e&&s.length==0)return e;if(!e)return this._MergeElement(l,s[0][0],s[0][1],s.slice(1));const d=s.reduce((c,n)=>c+n[0].length,e.length),i=l===X.PositionKind?$._TransformVector3Coordinates:l===X.NormalKind?$._TransformVector3Normals:l===X.TangentKind?$._TransformVector4Normals:()=>{};if(e instanceof Float32Array){const c=new Float32Array(d);c.set(e),t&&i(c,t,0,e.length);let n=e.length;for(const[h,m]of s)c.set(h,n),m&&i(c,m,n,h.length),n+=h.length;return c}else{const c=new Array(d);for(let h=0;h<e.length;h++)c[h]=e[h];t&&i(c,t,0,e.length);let n=e.length;for(const[h,m]of s){for(let o=0;o<h.length;o++)c[n+o]=h[o];m&&i(c,m,n,h.length),n+=h.length}return c}}_validate(){if(!this.positions)throw new Pe("Positions are required",Xt.MeshInvalidPositionsError);const l=(a,s)=>{const d=X.DeduceStride(a);if(s.length%d!==0)throw new Error("The "+a+"s array count must be a multiple of "+d);return s.length/d},e=l(X.PositionKind,this.positions),t=(a,s)=>{const d=l(a,s);if(d!==e)throw new Error("The "+a+"s element count ("+d+") does not match the positions count ("+e+")")};this.normals&&t(X.NormalKind,this.normals),this.tangents&&t(X.TangentKind,this.tangents),this.uvs&&t(X.UVKind,this.uvs),this.uvs2&&t(X.UV2Kind,this.uvs2),this.uvs3&&t(X.UV3Kind,this.uvs3),this.uvs4&&t(X.UV4Kind,this.uvs4),this.uvs5&&t(X.UV5Kind,this.uvs5),this.uvs6&&t(X.UV6Kind,this.uvs6),this.colors&&t(X.ColorKind,this.colors),this.matricesIndices&&t(X.MatricesIndicesKind,this.matricesIndices),this.matricesWeights&&t(X.MatricesWeightsKind,this.matricesWeights),this.matricesIndicesExtra&&t(X.MatricesIndicesExtraKind,this.matricesIndicesExtra),this.matricesWeightsExtra&&t(X.MatricesWeightsExtraKind,this.matricesWeightsExtra)}serialize(){const l={};return this.positions&&(l.positions=this.positions),this.normals&&(l.normals=this.normals),this.tangents&&(l.tangents=this.tangents),this.uvs&&(l.uvs=this.uvs),this.uvs2&&(l.uvs2=this.uvs2),this.uvs3&&(l.uvs3=this.uvs3),this.uvs4&&(l.uvs4=this.uvs4),this.uvs5&&(l.uvs5=this.uvs5),this.uvs6&&(l.uvs6=this.uvs6),this.colors&&(l.colors=this.colors),this.matricesIndices&&(l.matricesIndices=this.matricesIndices,l.matricesIndices._isExpanded=!0),this.matricesWeights&&(l.matricesWeights=this.matricesWeights),this.matricesIndicesExtra&&(l.matricesIndicesExtra=this.matricesIndicesExtra,l.matricesIndicesExtra._isExpanded=!0),this.matricesWeightsExtra&&(l.matricesWeightsExtra=this.matricesWeightsExtra),l.indices=this.indices,l}static ExtractFromMesh(l,e,t){return $._ExtractFrom(l,e,t)}static ExtractFromGeometry(l,e,t){return $._ExtractFrom(l,e,t)}static _ExtractFrom(l,e,t){const a=new $;return l.isVerticesDataPresent(X.PositionKind)&&(a.positions=l.getVerticesData(X.PositionKind,e,t)),l.isVerticesDataPresent(X.NormalKind)&&(a.normals=l.getVerticesData(X.NormalKind,e,t)),l.isVerticesDataPresent(X.TangentKind)&&(a.tangents=l.getVerticesData(X.TangentKind,e,t)),l.isVerticesDataPresent(X.UVKind)&&(a.uvs=l.getVerticesData(X.UVKind,e,t)),l.isVerticesDataPresent(X.UV2Kind)&&(a.uvs2=l.getVerticesData(X.UV2Kind,e,t)),l.isVerticesDataPresent(X.UV3Kind)&&(a.uvs3=l.getVerticesData(X.UV3Kind,e,t)),l.isVerticesDataPresent(X.UV4Kind)&&(a.uvs4=l.getVerticesData(X.UV4Kind,e,t)),l.isVerticesDataPresent(X.UV5Kind)&&(a.uvs5=l.getVerticesData(X.UV5Kind,e,t)),l.isVerticesDataPresent(X.UV6Kind)&&(a.uvs6=l.getVerticesData(X.UV6Kind,e,t)),l.isVerticesDataPresent(X.ColorKind)&&(a.colors=l.getVerticesData(X.ColorKind,e,t)),l.isVerticesDataPresent(X.MatricesIndicesKind)&&(a.matricesIndices=l.getVerticesData(X.MatricesIndicesKind,e,t)),l.isVerticesDataPresent(X.MatricesWeightsKind)&&(a.matricesWeights=l.getVerticesData(X.MatricesWeightsKind,e,t)),l.isVerticesDataPresent(X.MatricesIndicesExtraKind)&&(a.matricesIndicesExtra=l.getVerticesData(X.MatricesIndicesExtraKind,e,t)),l.isVerticesDataPresent(X.MatricesWeightsExtraKind)&&(a.matricesWeightsExtra=l.getVerticesData(X.MatricesWeightsExtraKind,e,t)),a.indices=l.getIndices(e,t),a}static CreateRibbon(l){throw O("ribbonBuilder")}static CreateBox(l){throw O("boxBuilder")}static CreateTiledBox(l){throw O("tiledBoxBuilder")}static CreateTiledPlane(l){throw O("tiledPlaneBuilder")}static CreateSphere(l){throw O("sphereBuilder")}static CreateCylinder(l){throw O("cylinderBuilder")}static CreateTorus(l){throw O("torusBuilder")}static CreateLineSystem(l){throw O("linesBuilder")}static CreateDashedLines(l){throw O("linesBuilder")}static CreateGround(l){throw O("groundBuilder")}static CreateTiledGround(l){throw O("groundBuilder")}static CreateGroundFromHeightMap(l){throw O("groundBuilder")}static CreatePlane(l){throw O("planeBuilder")}static CreateDisc(l){throw O("discBuilder")}static CreatePolygon(l,e,t,a,s,d,i){throw O("polygonBuilder")}static CreateIcoSphere(l){throw O("icoSphereBuilder")}static CreatePolyhedron(l){throw O("polyhedronBuilder")}static CreateCapsule(l={orientation:r.Up(),subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6}){throw O("capsuleBuilder")}static CreateTorusKnot(l){throw O("torusKnotBuilder")}static ComputeNormals(l,e,t,a){let s=0,d=0,i=0,c=0,n=0,h=0,m=0,o=0,b=0,u=0,V=0,G=0,p=0,y=0,L=0,N=0,J=0,R=0,S=0,T=0,k=!1,g=!1,ll=!1,ol=!1,ml=1,el=0,Jl=null;a&&(k=!!a.facetNormals,g=!!a.facetPositions,ll=!!a.facetPartitioning,ml=a.useRightHandedSystem===!0?-1:1,el=a.ratio||0,ol=!!a.depthSort,Jl=a.distanceTo,ol&&Jl===void 0&&(Jl=r.Zero()));let xl=0,zl=0,Hl=0,Al=0;for(ll&&a&&a.bbSize&&(xl=a.subDiv.X*el/a.bbSize.x,zl=a.subDiv.Y*el/a.bbSize.y,Hl=a.subDiv.Z*el/a.bbSize.z,Al=a.subDiv.max*a.subDiv.max,a.facetPartitioning.length=0),s=0;s<l.length;s++)t[s]=0;const Ye=e.length/3|0;for(s=0;s<Ye;s++){if(G=e[s*3]*3,p=G+1,y=G+2,L=e[s*3+1]*3,N=L+1,J=L+2,R=e[s*3+2]*3,S=R+1,T=R+2,d=l[G]-l[L],i=l[p]-l[N],c=l[y]-l[J],n=l[R]-l[L],h=l[S]-l[N],m=l[T]-l[J],o=ml*(i*m-c*h),b=ml*(c*n-d*m),u=ml*(d*h-i*n),V=Math.sqrt(o*o+b*b+u*u),V=V===0?1:V,o/=V,b/=V,u/=V,k&&a&&(a.facetNormals[s].x=o,a.facetNormals[s].y=b,a.facetNormals[s].z=u),g&&a&&(a.facetPositions[s].x=(l[G]+l[L]+l[R])/3,a.facetPositions[s].y=(l[p]+l[N]+l[S])/3,a.facetPositions[s].z=(l[y]+l[J]+l[T])/3),ll&&a){const Dl=Math.floor((a.facetPositions[s].x-a.bInfo.minimum.x*el)*xl),Ae=Math.floor((a.facetPositions[s].y-a.bInfo.minimum.y*el)*zl),qt=Math.floor((a.facetPositions[s].z-a.bInfo.minimum.z*el)*Hl),$t=Math.floor((l[G]-a.bInfo.minimum.x*el)*xl),la=Math.floor((l[p]-a.bInfo.minimum.y*el)*zl),ea=Math.floor((l[y]-a.bInfo.minimum.z*el)*Hl),Ma=Math.floor((l[L]-a.bInfo.minimum.x*el)*xl),ga=Math.floor((l[N]-a.bInfo.minimum.y*el)*zl),Ca=Math.floor((l[J]-a.bInfo.minimum.z*el)*Hl),va=Math.floor((l[R]-a.bInfo.minimum.x*el)*xl),ka=Math.floor((l[S]-a.bInfo.minimum.y*el)*zl),Ha=Math.floor((l[T]-a.bInfo.minimum.z*el)*Hl),ge=$t+a.subDiv.max*la+Al*ea,Ce=Ma+a.subDiv.max*ga+Al*Ca,ve=va+a.subDiv.max*ka+Al*Ha,ke=Dl+a.subDiv.max*Ae+Al*qt;a.facetPartitioning[ke]=a.facetPartitioning[ke]?a.facetPartitioning[ke]:new Array,a.facetPartitioning[ge]=a.facetPartitioning[ge]?a.facetPartitioning[ge]:new Array,a.facetPartitioning[Ce]=a.facetPartitioning[Ce]?a.facetPartitioning[Ce]:new Array,a.facetPartitioning[ve]=a.facetPartitioning[ve]?a.facetPartitioning[ve]:new Array,a.facetPartitioning[ge].push(s),Ce!=ge&&a.facetPartitioning[Ce].push(s),ve==Ce||ve==ge||a.facetPartitioning[ve].push(s),ke==ge||ke==Ce||ke==ve||a.facetPartitioning[ke].push(s)}if(ol&&a&&a.facetPositions){const Dl=a.depthSortedFacets[s];Dl.ind=s*3,Dl.sqDistance=r.DistanceSquared(a.facetPositions[s],Jl)}t[G]+=o,t[p]+=b,t[y]+=u,t[L]+=o,t[N]+=b,t[J]+=u,t[R]+=o,t[S]+=b,t[T]+=u}for(s=0;s<t.length/3;s++)o=t[s*3],b=t[s*3+1],u=t[s*3+2],V=Math.sqrt(o*o+b*b+u*u),V=V===0?1:V,o/=V,b/=V,u/=V,t[s*3]=o,t[s*3+1]=b,t[s*3+2]=u}static _ComputeSides(l,e,t,a,s,d,i){const c=t.length,n=a.length;let h,m;switch(l=l||$.DEFAULTSIDE,l){case $.FRONTSIDE:break;case $.BACKSIDE:for(h=0;h<c;h+=3){const o=t[h];t[h]=t[h+2],t[h+2]=o}for(m=0;m<n;m++)a[m]=-a[m];break;case $.DOUBLESIDE:{const o=e.length,b=o/3;for(let G=0;G<o;G++)e[o+G]=e[G];for(h=0;h<c;h+=3)t[h+c]=t[h+2]+b,t[h+1+c]=t[h+1]+b,t[h+2+c]=t[h]+b;for(m=0;m<n;m++)a[n+m]=-a[m];const u=s.length;let V=0;for(V=0;V<u;V++)s[V+u]=s[V];for(d=d||new Fl(0,0,1,1),i=i||new Fl(0,0,1,1),V=0,h=0;h<u/2;h++)s[V]=d.x+(d.z-d.x)*s[V],s[V+1]=d.y+(d.w-d.y)*s[V+1],s[V+u]=i.x+(i.z-i.x)*s[V+u],s[V+u+1]=i.y+(i.w-i.y)*s[V+u+1],V+=2;break}}}static ImportVertexData(l,e){const t=new $,a=l.positions;a&&t.set(a,X.PositionKind);const s=l.normals;s&&t.set(s,X.NormalKind);const d=l.tangents;d&&t.set(d,X.TangentKind);const i=l.uvs;i&&t.set(i,X.UVKind);const c=l.uv2s;c&&t.set(c,X.UV2Kind);const n=l.uv3s;n&&t.set(n,X.UV3Kind);const h=l.uv4s;h&&t.set(h,X.UV4Kind);const m=l.uv5s;m&&t.set(m,X.UV5Kind);const o=l.uv6s;o&&t.set(o,X.UV6Kind);const b=l.colors;b&&t.set(Gl.CheckColors4(b,a.length/3),X.ColorKind);const u=l.matricesIndices;u&&t.set(u,X.MatricesIndicesKind);const V=l.matricesWeights;V&&t.set(V,X.MatricesWeightsKind);const G=l.indices;G&&(t.indices=G),e.setAllVerticesData(t,l.updatable)}}$.FRONTSIDE=0;$.BACKSIDE=1;$.DOUBLESIDE=2;$.DEFAULTSIDE=0;W([st.filter((...[Z])=>!Array.isArray(Z))],$,"_TransformVector3Coordinates",null);W([st.filter((...[Z])=>!Array.isArray(Z))],$,"_TransformVector3Normals",null);W([st.filter((...[Z])=>!Array.isArray(Z))],$,"_TransformVector4Normals",null);W([st.filter((...[Z])=>!Array.isArray(Z))],$,"_FlipFaces",null);class Zs{constructor(l,e,t){this.bu=l,this.bv=e,this.distance=t,this.faceId=0,this.subMeshId=0}}class Ke{constructor(l,e,t){this.vectors=_l.BuildArray(8,r.Zero),this.center=r.Zero(),this.centerWorld=r.Zero(),this.extendSize=r.Zero(),this.extendSizeWorld=r.Zero(),this.directions=_l.BuildArray(3,r.Zero),this.vectorsWorld=_l.BuildArray(8,r.Zero),this.minimumWorld=r.Zero(),this.maximumWorld=r.Zero(),this.minimum=r.Zero(),this.maximum=r.Zero(),this._drawWrapperFront=null,this._drawWrapperBack=null,this.reConstruct(l,e,t)}reConstruct(l,e,t){const a=l.x,s=l.y,d=l.z,i=e.x,c=e.y,n=e.z,h=this.vectors;this.minimum.copyFromFloats(a,s,d),this.maximum.copyFromFloats(i,c,n),h[0].copyFromFloats(a,s,d),h[1].copyFromFloats(i,c,n),h[2].copyFromFloats(i,s,d),h[3].copyFromFloats(a,c,d),h[4].copyFromFloats(a,s,n),h[5].copyFromFloats(i,c,d),h[6].copyFromFloats(a,c,n),h[7].copyFromFloats(i,s,n),e.addToRef(l,this.center).scaleInPlace(.5),e.subtractToRef(l,this.extendSize).scaleInPlace(.5),this._worldMatrix=t||Y.IdentityReadOnly,this._update(this._worldMatrix)}scale(l){const e=Ke._TmpVector3,t=this.maximum.subtractToRef(this.minimum,e[0]),a=t.length();t.normalizeFromLength(a);const s=a*l,d=t.scaleInPlace(s*.5),i=this.center.subtractToRef(d,e[1]),c=this.center.addToRef(d,e[2]);return this.reConstruct(i,c,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(l){const e=this.minimumWorld,t=this.maximumWorld,a=this.directions,s=this.vectorsWorld,d=this.vectors;if(l.isIdentity()){e.copyFrom(this.minimum),t.copyFrom(this.maximum);for(let i=0;i<8;++i)s[i].copyFrom(d[i]);this.extendSizeWorld.copyFrom(this.extendSize),this.centerWorld.copyFrom(this.center)}else{e.setAll(Number.MAX_VALUE),t.setAll(-Number.MAX_VALUE);for(let i=0;i<8;++i){const c=s[i];r.TransformCoordinatesToRef(d[i],l,c),e.minimizeInPlace(c),t.maximizeInPlace(c)}t.subtractToRef(e,this.extendSizeWorld).scaleInPlace(.5),t.addToRef(e,this.centerWorld).scaleInPlace(.5)}r.FromArrayToRef(l.m,0,a[0]),r.FromArrayToRef(l.m,4,a[1]),r.FromArrayToRef(l.m,8,a[2]),this._worldMatrix=l}isInFrustum(l){return Ke.IsInFrustum(this.vectorsWorld,l)}isCompletelyInFrustum(l){return Ke.IsCompletelyInFrustum(this.vectorsWorld,l)}intersectsPoint(l){const e=this.minimumWorld,t=this.maximumWorld,a=e.x,s=e.y,d=e.z,i=t.x,c=t.y,n=t.z,h=l.x,m=l.y,o=l.z,b=-Sl;return!(i-h<b||b>h-a||c-m<b||b>m-s||n-o<b||b>o-d)}intersectsSphere(l){return Ke.IntersectsSphere(this.minimumWorld,this.maximumWorld,l.centerWorld,l.radiusWorld)}intersectsMinMax(l,e){const t=this.minimumWorld,a=this.maximumWorld,s=t.x,d=t.y,i=t.z,c=a.x,n=a.y,h=a.z,m=l.x,o=l.y,b=l.z,u=e.x,V=e.y,G=e.z;return!(c<m||s>u||n<o||d>V||h<b||i>G)}dispose(){var l,e;(l=this._drawWrapperFront)===null||l===void 0||l.dispose(),(e=this._drawWrapperBack)===null||e===void 0||e.dispose()}static Intersects(l,e){return l.intersectsMinMax(e.minimumWorld,e.maximumWorld)}static IntersectsSphere(l,e,t,a){const s=Ke._TmpVector3[0];return r.ClampToRef(t,l,e,s),r.DistanceSquared(t,s)<=a*a}static IsCompletelyInFrustum(l,e){for(let t=0;t<6;++t){const a=e[t];for(let s=0;s<8;++s)if(a.dotCoordinate(l[s])<0)return!1}return!0}static IsInFrustum(l,e){for(let t=0;t<6;++t){let a=!0;const s=e[t];for(let d=0;d<8;++d)if(s.dotCoordinate(l[d])>=0){a=!1;break}if(a)return!1}return!0}}Ke._TmpVector3=_l.BuildArray(3,r.Zero);class ut{constructor(l,e,t){this.center=r.Zero(),this.centerWorld=r.Zero(),this.minimum=r.Zero(),this.maximum=r.Zero(),this.reConstruct(l,e,t)}reConstruct(l,e,t){this.minimum.copyFrom(l),this.maximum.copyFrom(e);const a=r.Distance(l,e);e.addToRef(l,this.center).scaleInPlace(.5),this.radius=a*.5,this._update(t||Y.IdentityReadOnly)}scale(l){const e=this.radius*l,t=ut._TmpVector3,a=t[0].setAll(e),s=this.center.subtractToRef(a,t[1]),d=this.center.addToRef(a,t[2]);return this.reConstruct(s,d,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(l){if(l.isIdentity())this.centerWorld.copyFrom(this.center),this.radiusWorld=this.radius;else{r.TransformCoordinatesToRef(this.center,l,this.centerWorld);const e=ut._TmpVector3[0];r.TransformNormalFromFloatsToRef(1,1,1,l,e),this.radiusWorld=Math.max(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z))*this.radius}}isInFrustum(l){const e=this.centerWorld,t=this.radiusWorld;for(let a=0;a<6;a++)if(l[a].dotCoordinate(e)<=-t)return!1;return!0}isCenterInFrustum(l){const e=this.centerWorld;for(let t=0;t<6;t++)if(l[t].dotCoordinate(e)<0)return!1;return!0}intersectsPoint(l){const e=r.DistanceSquared(this.centerWorld,l);return!(this.radiusWorld*this.radiusWorld<e)}static Intersects(l,e){const t=r.DistanceSquared(l.centerWorld,e.centerWorld),a=l.radiusWorld+e.radiusWorld;return!(a*a<t)}static CreateFromCenterAndRadius(l,e,t){this._TmpVector3[0].copyFrom(l),this._TmpVector3[1].copyFromFloats(0,0,e),this._TmpVector3[2].copyFrom(l),this._TmpVector3[0].addInPlace(this._TmpVector3[1]),this._TmpVector3[2].subtractInPlace(this._TmpVector3[1]);const a=new ut(this._TmpVector3[0],this._TmpVector3[2]);return t?a._worldMatrix=t:a._worldMatrix=Y.Identity(),a}}ut._TmpVector3=_l.BuildArray(3,r.Zero);const Qa={min:0,max:0},Pa={min:0,max:0},Ds=(Z,l,e)=>{const t=r.Dot(l.centerWorld,Z),a=Math.abs(r.Dot(l.directions[0],Z))*l.extendSize.x,s=Math.abs(r.Dot(l.directions[1],Z))*l.extendSize.y,d=Math.abs(r.Dot(l.directions[2],Z))*l.extendSize.z,i=a+s+d;e.min=t-i,e.max=t+i},se=(Z,l,e)=>(Ds(Z,l,Qa),Ds(Z,e,Pa),!(Qa.min>Pa.max||Pa.min>Qa.max));class re{constructor(l,e,t){this._isLocked=!1,this.boundingBox=new Ke(l,e,t),this.boundingSphere=new ut(l,e,t)}reConstruct(l,e,t){this.boundingBox.reConstruct(l,e,t),this.boundingSphere.reConstruct(l,e,t)}get minimum(){return this.boundingBox.minimum}get maximum(){return this.boundingBox.maximum}get isLocked(){return this._isLocked}set isLocked(l){this._isLocked=l}update(l){this._isLocked||(this.boundingBox._update(l),this.boundingSphere._update(l))}centerOn(l,e){const t=re._TmpVector3[0].copyFrom(l).subtractInPlace(e),a=re._TmpVector3[1].copyFrom(l).addInPlace(e);return this.boundingBox.reConstruct(t,a,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(t,a,this.boundingBox.getWorldMatrix()),this}encapsulate(l){const e=r.Minimize(this.minimum,l),t=r.Maximize(this.maximum,l);return this.reConstruct(e,t,this.boundingBox.getWorldMatrix()),this}encapsulateBoundingInfo(l){return this.encapsulate(l.boundingBox.centerWorld.subtract(l.boundingBox.extendSizeWorld)),this.encapsulate(l.boundingBox.centerWorld.add(l.boundingBox.extendSizeWorld)),this}scale(l){return this.boundingBox.scale(l),this.boundingSphere.scale(l),this}isInFrustum(l,e=0){return(e===2||e===3)&&this.boundingSphere.isCenterInFrustum(l)?!0:this.boundingSphere.isInFrustum(l)?e===1||e===3?!0:this.boundingBox.isInFrustum(l):!1}get diagonalLength(){const l=this.boundingBox;return l.maximumWorld.subtractToRef(l.minimumWorld,re._TmpVector3[0]).length()}isCompletelyInFrustum(l){return this.boundingBox.isCompletelyInFrustum(l)}_checkCollision(l){return l._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}intersectsPoint(l){return!(!this.boundingSphere.centerWorld||!this.boundingSphere.intersectsPoint(l)||!this.boundingBox.intersectsPoint(l))}intersects(l,e){if(!ut.Intersects(this.boundingSphere,l.boundingSphere)||!Ke.Intersects(this.boundingBox,l.boundingBox))return!1;if(!e)return!0;const t=this.boundingBox,a=l.boundingBox;return!(!se(t.directions[0],t,a)||!se(t.directions[1],t,a)||!se(t.directions[2],t,a)||!se(a.directions[0],t,a)||!se(a.directions[1],t,a)||!se(a.directions[2],t,a)||!se(r.Cross(t.directions[0],a.directions[0]),t,a)||!se(r.Cross(t.directions[0],a.directions[1]),t,a)||!se(r.Cross(t.directions[0],a.directions[2]),t,a)||!se(r.Cross(t.directions[1],a.directions[0]),t,a)||!se(r.Cross(t.directions[1],a.directions[1]),t,a)||!se(r.Cross(t.directions[1],a.directions[2]),t,a)||!se(r.Cross(t.directions[2],a.directions[0]),t,a)||!se(r.Cross(t.directions[2],a.directions[1]),t,a)||!se(r.Cross(t.directions[2],a.directions[2]),t,a))}}re._TmpVector3=_l.BuildArray(2,r.Zero);class Ja{static extractMinAndMaxIndexed(l,e,t,a,s,d){for(let i=t;i<t+a;i++){const c=e[i]*3,n=l[c],h=l[c+1],m=l[c+2];s.minimizeInPlaceFromFloats(n,h,m),d.maximizeInPlaceFromFloats(n,h,m)}}static extractMinAndMax(l,e,t,a,s,d){for(let i=e,c=e*a;i<e+t;i++,c+=a){const n=l[c],h=l[c+1],m=l[c+2];s.minimizeInPlaceFromFloats(n,h,m),d.maximizeInPlaceFromFloats(n,h,m)}}}W([st.filter((...[Z,l])=>!Array.isArray(Z)&&!Array.isArray(l))],Ja,"extractMinAndMaxIndexed",null);W([st.filter((...[Z])=>!Array.isArray(Z))],Ja,"extractMinAndMax",null);function _i(Z,l,e,t,a=null){const s=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),d=new r(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return Ja.extractMinAndMaxIndexed(Z,l,e,t,s,d),a&&(s.x-=s.x*a.x+a.y,s.y-=s.y*a.x+a.y,s.z-=s.z*a.x+a.y,d.x+=d.x*a.x+a.y,d.y+=d.y*a.x+a.y,d.z+=d.z*a.x+a.y),{minimum:s,maximum:d}}function Fd(Z,l,e,t=null,a){const s=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),d=new r(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return a||(a=3),Ja.extractMinAndMax(Z,l,e,a,s,d),t&&(s.x-=s.x*t.x+t.y,s.y-=s.y*t.x+t.y,s.z-=s.z*t.x+t.y,d.x+=d.x*t.x+t.y,d.y+=d.y*t.x+t.y,d.z+=d.z*t.x+t.y),{minimum:s,maximum:d}}class pe{constructor(l,e,t,a,s,d,i,c=!0,n=!0){this.materialIndex=l,this.verticesStart=e,this.verticesCount=t,this.indexStart=a,this.indexCount=s,this._mainDrawWrapperOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._wasDispatched=!1,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=d,this._renderingMesh=i||d,n&&d.subMeshes.push(this),this._engine=this._mesh.getScene().getEngine(),this.resetDrawCache(),this._trianglePlanes=[],this._id=d.subMeshes.length-1,c&&(this.refreshBoundingInfo(),d.computeWorldMatrix(!0))}get materialDefines(){var l;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:(l=this._getDrawWrapper())===null||l===void 0?void 0:l.defines}set materialDefines(l){var e;const t=(e=this._mainDrawWrapperOverride)!==null&&e!==void 0?e:this._getDrawWrapper(void 0,!0);t.defines=l}_getDrawWrapper(l,e=!1){l=l??this._engine.currentRenderPassId;let t=this._drawWrappers[l];return!t&&e&&(this._drawWrappers[l]=t=new Mt(this._mesh.getScene().getEngine())),t}_removeDrawWrapper(l,e=!0){var t;e&&((t=this._drawWrappers[l])===null||t===void 0||t.dispose()),this._drawWrappers[l]=void 0}get effect(){var l,e;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:(e=(l=this._getDrawWrapper())===null||l===void 0?void 0:l.effect)!==null&&e!==void 0?e:null}get _drawWrapper(){var l;return(l=this._mainDrawWrapperOverride)!==null&&l!==void 0?l:this._getDrawWrapper(void 0,!0)}get _drawWrapperOverride(){return this._mainDrawWrapperOverride}_setMainDrawWrapperOverride(l){this._mainDrawWrapperOverride=l}setEffect(l,e=null,t,a=!0){const s=this._drawWrapper;s.setEffect(l,e,a),t!==void 0&&(s.materialContext=t),l||(s.defines=null,s.materialContext=void 0)}resetDrawCache(l){if(this._drawWrappers)if(l!==void 0){this._removeDrawWrapper(l);return}else for(const e of this._drawWrappers)e==null||e.dispose();this._drawWrappers=[]}static AddToMesh(l,e,t,a,s,d,i,c=!0){return new pe(l,e,t,a,s,d,i,c)}get IsGlobal(){return this.verticesStart===0&&this.verticesCount===this._mesh.getTotalVertices()&&this.indexStart===0&&this.indexCount===this._mesh.getTotalIndices()}getBoundingInfo(){return this.IsGlobal?this._mesh.getBoundingInfo():this._boundingInfo}setBoundingInfo(l){return this._boundingInfo=l,this}getMesh(){return this._mesh}getRenderingMesh(){return this._renderingMesh}getReplacementMesh(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null}getEffectiveMesh(){return(this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null)||this._renderingMesh}getMaterial(l=!0){var e;const t=(e=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId))!==null&&e!==void 0?e:this._renderingMesh.material;if(t){if(this._isMultiMaterial(t)){const a=t.getSubMaterial(this.materialIndex);return this._currentMaterial!==a&&(this._currentMaterial=a,this.resetDrawCache()),a}}else return l?this._mesh.getScene().defaultMaterial:null;return t}_isMultiMaterial(l){return l.getSubMaterial!==void 0}refreshBoundingInfo(l=null){if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.geometry)return this;if(l||(l=this._renderingMesh.getVerticesData(X.PositionKind)),!l)return this._boundingInfo=this._mesh.getBoundingInfo(),this;const e=this._renderingMesh.getIndices();let t;if(this.indexStart===0&&this.indexCount===e.length){const a=this._renderingMesh.getBoundingInfo();t={minimum:a.minimum.clone(),maximum:a.maximum.clone()}}else t=_i(l,e,this.indexStart,this.indexCount,this._renderingMesh.geometry.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(t.minimum,t.maximum):this._boundingInfo=new re(t.minimum,t.maximum),this}_checkCollision(l){return this.getBoundingInfo()._checkCollision(l)}updateBoundingInfo(l){let e=this.getBoundingInfo();return e||(this.refreshBoundingInfo(),e=this.getBoundingInfo()),e&&e.update(l),this}isInFrustum(l){const e=this.getBoundingInfo();return e?e.isInFrustum(l,this._mesh.cullingStrategy):!1}isCompletelyInFrustum(l){const e=this.getBoundingInfo();return e?e.isCompletelyInFrustum(l):!1}render(l){return this._renderingMesh.render(this,l,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}_getLinesIndexBuffer(l,e){if(!this._linesIndexBuffer){const t=[];for(let a=this.indexStart;a<this.indexStart+this.indexCount;a+=3)t.push(l[a],l[a+1],l[a+1],l[a+2],l[a+2],l[a]);this._linesIndexBuffer=e.createIndexBuffer(t),this._linesIndexCount=t.length}return this._linesIndexBuffer}canIntersects(l){const e=this.getBoundingInfo();return e?l.intersectsBox(e.boundingBox):!1}intersects(l,e,t,a,s){const d=this.getMaterial();if(!d)return null;let i=3,c=!1;switch(d.fillMode){case 3:case 5:case 6:case 8:return null;case 7:i=1,c=!0;break}return d.fillMode===4?t.length?this._intersectLines(l,e,t,this._mesh.intersectionThreshold,a):this._intersectUnIndexedLines(l,e,t,this._mesh.intersectionThreshold,a):!t.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(l,e,t,a,s):this._intersectTriangles(l,e,t,i,c,a,s)}_intersectLines(l,e,t,a,s){let d=null;for(let i=this.indexStart;i<this.indexStart+this.indexCount;i+=2){const c=e[t[i]],n=e[t[i+1]],h=l.intersectionSegment(c,n,a);if(!(h<0)&&(s||!d||h<d.distance)&&(d=new Zs(null,null,h),d.faceId=i/2,s))break}return d}_intersectUnIndexedLines(l,e,t,a,s){let d=null;for(let i=this.verticesStart;i<this.verticesStart+this.verticesCount;i+=2){const c=e[i],n=e[i+1],h=l.intersectionSegment(c,n,a);if(!(h<0)&&(s||!d||h<d.distance)&&(d=new Zs(null,null,h),d.faceId=i/2,s))break}return d}_intersectTriangles(l,e,t,a,s,d,i){let c=null,n=-1;for(let h=this.indexStart;h<this.indexStart+this.indexCount-(3-a);h+=a){n++;const m=t[h],o=t[h+1],b=t[h+2];if(s&&b===4294967295){h+=2;continue}const u=e[m],V=e[o],G=e[b];if(!u||!V||!G||i&&!i(u,V,G,l,m,o,b))continue;const p=l.intersectsTriangle(u,V,G);if(p){if(p.distance<0)continue;if((d||!c||p.distance<c.distance)&&(c=p,c.faceId=n,d))break}}return c}_intersectUnIndexedTriangles(l,e,t,a,s){let d=null;for(let i=this.verticesStart;i<this.verticesStart+this.verticesCount;i+=3){const c=e[i],n=e[i+1],h=e[i+2];if(s&&!s(c,n,h,l,-1,-1,-1))continue;const m=l.intersectsTriangle(c,n,h);if(m){if(m.distance<0)continue;if((a||!d||m.distance<d.distance)&&(d=m,d.faceId=i/3,a))break}}return d}_rebuild(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}clone(l,e){const t=new pe(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,l,e,!1);if(!this.IsGlobal){const a=this.getBoundingInfo();if(!a)return t;t._boundingInfo=new re(a.minimum,a.maximum)}return t}dispose(){this._linesIndexBuffer&&(this._mesh.getScene().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);const l=this._mesh.subMeshes.indexOf(this);this._mesh.subMeshes.splice(l,1),this.resetDrawCache()}getClassName(){return"SubMesh"}static CreateFromIndices(l,e,t,a,s,d=!0){let i=Number.MAX_VALUE,c=-Number.MAX_VALUE;const n=(s||a).getIndices();for(let h=e;h<e+t;h++){const m=n[h];m<i&&(i=m),m>c&&(c=m)}return new pe(l,i,c-i+1,e,t,a,s,d)}}class gl{static get ForceFullSceneLoadingForIncremental(){return gl._ForceFullSceneLoadingForIncremental}static set ForceFullSceneLoadingForIncremental(l){gl._ForceFullSceneLoadingForIncremental=l}static get ShowLoadingScreen(){return gl._ShowLoadingScreen}static set ShowLoadingScreen(l){gl._ShowLoadingScreen=l}static get loggingLevel(){return gl._LoggingLevel}static set loggingLevel(l){gl._LoggingLevel=l}static get CleanBoneMatrixWeights(){return gl._CleanBoneMatrixWeights}static set CleanBoneMatrixWeights(l){gl._CleanBoneMatrixWeights=l}}gl._ForceFullSceneLoadingForIncremental=!1;gl._ShowLoadingScreen=!0;gl._CleanBoneMatrixWeights=!1;gl._LoggingLevel=0;class Xe{}Xe.UseOpenGLOrientationForUV=!1;class he{constructor(l,e,t,a=!1,s=null){this.delayLoadState=0,this._totalVertices=0,this._isDisposed=!1,this._indexBufferIsUpdatable=!1,this._positionsCache=[],this._parentContainer=null,this.useBoundingInfoFromGeometry=!1,this._scene=e||bl.LastCreatedScene,this._scene&&(this.id=l,this.uniqueId=this._scene.getUniqueId(),this._engine=this._scene.getEngine(),this._meshes=[],this._vertexBuffers={},this._indices=[],this._updatable=a,t?this.setAllVerticesData(t,a):this._totalVertices=0,this._engine.getCaps().vertexArrayObject&&(this._vertexArrayObjects={}),s&&(this.applyToMesh(s),s.computeWorldMatrix(!0)))}get boundingBias(){return this._boundingBias}set boundingBias(l){this._boundingBias?this._boundingBias.copyFrom(l):this._boundingBias=l.clone(),this._updateBoundingInfo(!0,null)}static CreateGeometryForMesh(l){const e=new he(he.RandomId(),l.getScene());return e.applyToMesh(l),e}get meshes(){return this._meshes}get extend(){return this._extend}getScene(){return this._scene}getEngine(){return this._engine}isReady(){return this.delayLoadState===1||this.delayLoadState===0}get doNotSerialize(){for(let l=0;l<this._meshes.length;l++)if(!this._meshes[l].doNotSerialize)return!1;return!0}_rebuild(){this._vertexArrayObjects&&(this._vertexArrayObjects={}),this._meshes.length!==0&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable));for(const l in this._vertexBuffers)this._vertexBuffers[l]._rebuild()}setAllVerticesData(l,e){l.applyToGeometry(this,e),this._notifyUpdate()}setVerticesData(l,e,t=!1,a){t&&Array.isArray(e)&&(e=new Float32Array(e));const s=new X(this._engine,e,l,t,this._meshes.length===0,a);this.setVerticesBuffer(s)}removeVerticesData(l){this._vertexBuffers[l]&&(this._vertexBuffers[l].dispose(),delete this._vertexBuffers[l]),this._vertexArrayObjects&&this._disposeVertexArrayObjects()}setVerticesBuffer(l,e=null,t=!0){const a=l.getKind();this._vertexBuffers[a]&&t&&this._vertexBuffers[a].dispose(),l._buffer&&l._buffer._increaseReferences(),this._vertexBuffers[a]=l;const s=this._meshes,d=s.length;if(a===X.PositionKind){const i=l.getData();e!=null?this._totalVertices=e:i!=null&&(this._totalVertices=i.length/(l.type===X.BYTE?l.byteStride:l.byteStride/4)),this._updateExtend(i),this._resetPointsArrayCache();for(let c=0;c<d;c++){const n=s[c];n.buildBoundingInfo(this._extend.minimum,this._extend.maximum),n._createGlobalSubMesh(n.isUnIndexed),n.computeWorldMatrix(!0),n.synchronizeInstances()}}this._notifyUpdate(a)}updateVerticesDataDirectly(l,e,t,a=!1){const s=this.getVertexBuffer(l);s&&(s.updateDirectly(e,t,a),this._notifyUpdate(l))}updateVerticesData(l,e,t=!1){const a=this.getVertexBuffer(l);a&&(a.update(e),l===X.PositionKind&&this._updateBoundingInfo(t,e),this._notifyUpdate(l))}_updateBoundingInfo(l,e){if(l&&this._updateExtend(e),this._resetPointsArrayCache(),l){const t=this._meshes;for(const a of t){a.hasBoundingInfo?a.getBoundingInfo().reConstruct(this._extend.minimum,this._extend.maximum):a.buildBoundingInfo(this._extend.minimum,this._extend.maximum);const s=a.subMeshes;for(const d of s)d.refreshBoundingInfo()}}}_bind(l,e,t,a){if(!l)return;e===void 0&&(e=this._indexBuffer);const s=this.getVertexBuffers();if(!s)return;if(e!=this._indexBuffer||!this._vertexArrayObjects&&!a){this._engine.bindBuffers(s,e,l,t);return}const d=a||this._vertexArrayObjects;d[l.key]||(d[l.key]=this._engine.recordVertexArrayObject(s,e,l,t)),this._engine.bindVertexArrayObject(d[l.key],e)}getTotalVertices(){return this.isReady()?this._totalVertices:0}getVerticesData(l,e,t){const a=this.getVertexBuffer(l);return a?a.getFloatData(this._totalVertices,t||e&&this._meshes.length!==1):null}isVertexBufferUpdatable(l){const e=this._vertexBuffers[l];return e?e.isUpdatable():!1}getVertexBuffer(l){return this.isReady()?this._vertexBuffers[l]:null}getVertexBuffers(){return this.isReady()?this._vertexBuffers:null}isVerticesDataPresent(l){return this._vertexBuffers?this._vertexBuffers[l]!==void 0:this._delayInfo?this._delayInfo.indexOf(l)!==-1:!1}getVerticesDataKinds(){const l=[];let e;if(!this._vertexBuffers&&this._delayInfo)for(e in this._delayInfo)l.push(e);else for(e in this._vertexBuffers)l.push(e);return l}updateIndices(l,e,t=!1){if(this._indexBuffer)if(!this._indexBufferIsUpdatable)this.setIndices(l,null,!0);else{const a=l.length!==this._indices.length;if(t||(this._indices=l.slice()),this._engine.updateDynamicIndexBuffer(this._indexBuffer,l,e),a)for(const s of this._meshes)s._createGlobalSubMesh(!0)}}setIndices(l,e=null,t=!1){this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indices=l,this._indexBufferIsUpdatable=t,this._meshes.length!==0&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,t)),e!=null&&(this._totalVertices=e);for(const a of this._meshes)a._createGlobalSubMesh(!0),a.synchronizeInstances();this._notifyUpdate()}getTotalIndices(){return this.isReady()?this._indices.length:0}getIndices(l,e){if(!this.isReady())return null;const t=this._indices;return!e&&(!l||this._meshes.length===1)?t:t.slice()}getIndexBuffer(){return this.isReady()?this._indexBuffer:null}_releaseVertexArrayObject(l=null){!l||!this._vertexArrayObjects||this._vertexArrayObjects[l.key]&&(this._engine.releaseVertexArrayObject(this._vertexArrayObjects[l.key]),delete this._vertexArrayObjects[l.key])}releaseForMesh(l,e){const t=this._meshes,a=t.indexOf(l);a!==-1&&(t.splice(a,1),this._vertexArrayObjects&&l._invalidateInstanceVertexArrayObject(),l._geometry=null,t.length===0&&e&&this.dispose())}applyToMesh(l){if(l._geometry===this)return;const e=l._geometry;e&&e.releaseForMesh(l),this._vertexArrayObjects&&l._invalidateInstanceVertexArrayObject();const t=this._meshes;l._geometry=this,l._internalAbstractMeshDataInfo._positions=null,this._scene.pushGeometry(this),t.push(l),this.isReady()?this._applyToMesh(l):this._boundingInfo&&l.setBoundingInfo(this._boundingInfo)}_updateExtend(l=null){if(this.useBoundingInfoFromGeometry&&this._boundingInfo)this._extend={minimum:this._boundingInfo.minimum.clone(),maximum:this._boundingInfo.maximum.clone()};else{if(!l&&(l=this.getVerticesData(X.PositionKind),!l))return;this._extend=Fd(l,0,this._totalVertices,this.boundingBias,3)}}_applyToMesh(l){const e=this._meshes.length;for(const t in this._vertexBuffers)e===1&&this._vertexBuffers[t].create(),t===X.PositionKind&&(this._extend||this._updateExtend(),l.buildBoundingInfo(this._extend.minimum,this._extend.maximum),l._createGlobalSubMesh(l.isUnIndexed),l._updateBoundingInfo());e===1&&this._indices&&this._indices.length>0&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable)),l._syncGeometryWithMorphTargetManager(),l.synchronizeInstances()}_notifyUpdate(l){this.onGeometryUpdated&&this.onGeometryUpdated(this,l),this._vertexArrayObjects&&this._disposeVertexArrayObjects();for(const e of this._meshes)e._markSubMeshesAsAttributesDirty()}load(l,e){if(this.delayLoadState!==2){if(this.isReady()){e&&e();return}this.delayLoadState=2,this._queueLoad(l,e)}}_queueLoad(l,e){this.delayLoadingFile&&(l.addPendingData(this),l._loadFile(this.delayLoadingFile,t=>{if(!this._delayLoadingFunction)return;this._delayLoadingFunction(JSON.parse(t),this),this.delayLoadState=1,this._delayInfo=[],l.removePendingData(this);const a=this._meshes,s=a.length;for(let d=0;d<s;d++)this._applyToMesh(a[d]);e&&e()},void 0,!0))}toLeftHanded(){const l=this.getIndices(!1);if(l!=null&&l.length>0){for(let a=0;a<l.length;a+=3){const s=l[a+0];l[a+0]=l[a+2],l[a+2]=s}this.setIndices(l)}const e=this.getVerticesData(X.PositionKind,!1);if(e!=null&&e.length>0){for(let a=0;a<e.length;a+=3)e[a+2]=-e[a+2];this.setVerticesData(X.PositionKind,e,!1)}const t=this.getVerticesData(X.NormalKind,!1);if(t!=null&&t.length>0){for(let a=0;a<t.length;a+=3)t[a+2]=-t[a+2];this.setVerticesData(X.NormalKind,t,!1)}}_resetPointsArrayCache(){this._positions=null}_generatePointsArray(){if(this._positions)return!0;const l=this.getVerticesData(X.PositionKind);if(!l||l.length===0)return!1;for(let e=this._positionsCache.length*3,t=this._positionsCache.length;e<l.length;e+=3,++t)this._positionsCache[t]=r.FromArray(l,e);for(let e=0,t=0;e<l.length;e+=3,++t)this._positionsCache[t].set(l[0+e],l[1+e],l[2+e]);return this._positionsCache.length=l.length/3,this._positions=this._positionsCache,!0}isDisposed(){return this._isDisposed}_disposeVertexArrayObjects(){if(this._vertexArrayObjects){for(const t in this._vertexArrayObjects)this._engine.releaseVertexArrayObject(this._vertexArrayObjects[t]);this._vertexArrayObjects={};const l=this._meshes,e=l.length;for(let t=0;t<e;t++)l[t]._invalidateInstanceVertexArrayObject()}}dispose(){const l=this._meshes,e=l.length;let t;for(t=0;t<e;t++)this.releaseForMesh(l[t]);this._meshes.length=0,this._disposeVertexArrayObjects();for(const a in this._vertexBuffers)this._vertexBuffers[a].dispose();if(this._vertexBuffers={},this._totalVertices=0,this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null,this._indices=[],this.delayLoadState=0,this.delayLoadingFile=null,this._delayLoadingFunction=null,this._delayInfo=[],this._boundingInfo=null,this._scene.removeGeometry(this),this._parentContainer){const a=this._parentContainer.geometries.indexOf(this);a>-1&&this._parentContainer.geometries.splice(a,1),this._parentContainer=null}this._isDisposed=!0}copy(l){const e=new $;e.indices=[];const t=this.getIndices();if(t)for(let c=0;c<t.length;c++)e.indices.push(t[c]);let a=!1,s=!1,d;for(d in this._vertexBuffers){const c=this.getVerticesData(d);if(c&&(c instanceof Float32Array?e.set(new Float32Array(c),d):e.set(c.slice(0),d),!s)){const n=this.getVertexBuffer(d);n&&(a=n.isUpdatable(),s=!a)}}const i=new he(l,this._scene,e,a);i.delayLoadState=this.delayLoadState,i.delayLoadingFile=this.delayLoadingFile,i._delayLoadingFunction=this._delayLoadingFunction;for(d in this._delayInfo)i._delayInfo=i._delayInfo||[],i._delayInfo.push(d);return i._boundingInfo=new re(this._extend.minimum,this._extend.maximum),i}serialize(){const l={};return l.id=this.id,l.uniqueId=this.uniqueId,l.updatable=this._updatable,ul&&ul.HasTags(this)&&(l.tags=ul.GetTags(this)),l}_toNumberArray(l){return Array.isArray(l)?l:Array.prototype.slice.call(l)}clearCachedData(){this._indices=[],this._resetPointsArrayCache();for(const l in this._vertexBuffers)Object.prototype.hasOwnProperty.call(this._vertexBuffers,l)&&(this._vertexBuffers[l]._buffer._data=null)}serializeVerticeData(){const l=this.serialize();return this.isVerticesDataPresent(X.PositionKind)&&(l.positions=this._toNumberArray(this.getVerticesData(X.PositionKind)),this.isVertexBufferUpdatable(X.PositionKind)&&(l.positions._updatable=!0)),this.isVerticesDataPresent(X.NormalKind)&&(l.normals=this._toNumberArray(this.getVerticesData(X.NormalKind)),this.isVertexBufferUpdatable(X.NormalKind)&&(l.normals._updatable=!0)),this.isVerticesDataPresent(X.TangentKind)&&(l.tangents=this._toNumberArray(this.getVerticesData(X.TangentKind)),this.isVertexBufferUpdatable(X.TangentKind)&&(l.tangents._updatable=!0)),this.isVerticesDataPresent(X.UVKind)&&(l.uvs=this._toNumberArray(this.getVerticesData(X.UVKind)),this.isVertexBufferUpdatable(X.UVKind)&&(l.uvs._updatable=!0)),this.isVerticesDataPresent(X.UV2Kind)&&(l.uv2s=this._toNumberArray(this.getVerticesData(X.UV2Kind)),this.isVertexBufferUpdatable(X.UV2Kind)&&(l.uv2s._updatable=!0)),this.isVerticesDataPresent(X.UV3Kind)&&(l.uv3s=this._toNumberArray(this.getVerticesData(X.UV3Kind)),this.isVertexBufferUpdatable(X.UV3Kind)&&(l.uv3s._updatable=!0)),this.isVerticesDataPresent(X.UV4Kind)&&(l.uv4s=this._toNumberArray(this.getVerticesData(X.UV4Kind)),this.isVertexBufferUpdatable(X.UV4Kind)&&(l.uv4s._updatable=!0)),this.isVerticesDataPresent(X.UV5Kind)&&(l.uv5s=this._toNumberArray(this.getVerticesData(X.UV5Kind)),this.isVertexBufferUpdatable(X.UV5Kind)&&(l.uv5s._updatable=!0)),this.isVerticesDataPresent(X.UV6Kind)&&(l.uv6s=this._toNumberArray(this.getVerticesData(X.UV6Kind)),this.isVertexBufferUpdatable(X.UV6Kind)&&(l.uv6s._updatable=!0)),this.isVerticesDataPresent(X.ColorKind)&&(l.colors=this._toNumberArray(this.getVerticesData(X.ColorKind)),this.isVertexBufferUpdatable(X.ColorKind)&&(l.colors._updatable=!0)),this.isVerticesDataPresent(X.MatricesIndicesKind)&&(l.matricesIndices=this._toNumberArray(this.getVerticesData(X.MatricesIndicesKind)),l.matricesIndices._isExpanded=!0,this.isVertexBufferUpdatable(X.MatricesIndicesKind)&&(l.matricesIndices._updatable=!0)),this.isVerticesDataPresent(X.MatricesWeightsKind)&&(l.matricesWeights=this._toNumberArray(this.getVerticesData(X.MatricesWeightsKind)),this.isVertexBufferUpdatable(X.MatricesWeightsKind)&&(l.matricesWeights._updatable=!0)),l.indices=this._toNumberArray(this.getIndices()),l}static ExtractFromMesh(l,e){const t=l._geometry;return t?t.copy(e):null}static RandomId(){return Q.RandomId()}static _GetGeometryByLoadedUniqueId(l,e){for(let t=0;t<e.geometries.length;t++)if(e.geometries[t]._loadedUniqueId===l)return e.geometries[t];return null}static _ImportGeometry(l,e){const t=e.getScene(),a=l.geometryUniqueId,s=l.geometryId;if(a||s){const d=a?this._GetGeometryByLoadedUniqueId(a,t):t.getGeometryById(s);d&&d.applyToMesh(e)}else if(l instanceof ArrayBuffer){const d=e._binaryInfo;if(d.positionsAttrDesc&&d.positionsAttrDesc.count>0){const i=new Float32Array(l,d.positionsAttrDesc.offset,d.positionsAttrDesc.count);e.setVerticesData(X.PositionKind,i,!1)}if(d.normalsAttrDesc&&d.normalsAttrDesc.count>0){const i=new Float32Array(l,d.normalsAttrDesc.offset,d.normalsAttrDesc.count);e.setVerticesData(X.NormalKind,i,!1)}if(d.tangetsAttrDesc&&d.tangetsAttrDesc.count>0){const i=new Float32Array(l,d.tangetsAttrDesc.offset,d.tangetsAttrDesc.count);e.setVerticesData(X.TangentKind,i,!1)}if(d.uvsAttrDesc&&d.uvsAttrDesc.count>0){const i=new Float32Array(l,d.uvsAttrDesc.offset,d.uvsAttrDesc.count);if(Xe.UseOpenGLOrientationForUV)for(let c=1;c<i.length;c+=2)i[c]=1-i[c];e.setVerticesData(X.UVKind,i,!1)}if(d.uvs2AttrDesc&&d.uvs2AttrDesc.count>0){const i=new Float32Array(l,d.uvs2AttrDesc.offset,d.uvs2AttrDesc.count);if(Xe.UseOpenGLOrientationForUV)for(let c=1;c<i.length;c+=2)i[c]=1-i[c];e.setVerticesData(X.UV2Kind,i,!1)}if(d.uvs3AttrDesc&&d.uvs3AttrDesc.count>0){const i=new Float32Array(l,d.uvs3AttrDesc.offset,d.uvs3AttrDesc.count);if(Xe.UseOpenGLOrientationForUV)for(let c=1;c<i.length;c+=2)i[c]=1-i[c];e.setVerticesData(X.UV3Kind,i,!1)}if(d.uvs4AttrDesc&&d.uvs4AttrDesc.count>0){const i=new Float32Array(l,d.uvs4AttrDesc.offset,d.uvs4AttrDesc.count);if(Xe.UseOpenGLOrientationForUV)for(let c=1;c<i.length;c+=2)i[c]=1-i[c];e.setVerticesData(X.UV4Kind,i,!1)}if(d.uvs5AttrDesc&&d.uvs5AttrDesc.count>0){const i=new Float32Array(l,d.uvs5AttrDesc.offset,d.uvs5AttrDesc.count);if(Xe.UseOpenGLOrientationForUV)for(let c=1;c<i.length;c+=2)i[c]=1-i[c];e.setVerticesData(X.UV5Kind,i,!1)}if(d.uvs6AttrDesc&&d.uvs6AttrDesc.count>0){const i=new Float32Array(l,d.uvs6AttrDesc.offset,d.uvs6AttrDesc.count);if(Xe.UseOpenGLOrientationForUV)for(let c=1;c<i.length;c+=2)i[c]=1-i[c];e.setVerticesData(X.UV6Kind,i,!1)}if(d.colorsAttrDesc&&d.colorsAttrDesc.count>0){const i=new Float32Array(l,d.colorsAttrDesc.offset,d.colorsAttrDesc.count);e.setVerticesData(X.ColorKind,i,!1,d.colorsAttrDesc.stride)}if(d.matricesIndicesAttrDesc&&d.matricesIndicesAttrDesc.count>0){const i=new Int32Array(l,d.matricesIndicesAttrDesc.offset,d.matricesIndicesAttrDesc.count),c=[];for(let n=0;n<i.length;n++){const h=i[n];c.push(h&255),c.push((h&65280)>>8),c.push((h&16711680)>>16),c.push(h>>24&255)}e.setVerticesData(X.MatricesIndicesKind,c,!1)}if(d.matricesIndicesExtraAttrDesc&&d.matricesIndicesExtraAttrDesc.count>0){const i=new Int32Array(l,d.matricesIndicesExtraAttrDesc.offset,d.matricesIndicesExtraAttrDesc.count),c=[];for(let n=0;n<i.length;n++){const h=i[n];c.push(h&255),c.push((h&65280)>>8),c.push((h&16711680)>>16),c.push(h>>24&255)}e.setVerticesData(X.MatricesIndicesExtraKind,c,!1)}if(d.matricesWeightsAttrDesc&&d.matricesWeightsAttrDesc.count>0){const i=new Float32Array(l,d.matricesWeightsAttrDesc.offset,d.matricesWeightsAttrDesc.count);e.setVerticesData(X.MatricesWeightsKind,i,!1)}if(d.indicesAttrDesc&&d.indicesAttrDesc.count>0){const i=new Int32Array(l,d.indicesAttrDesc.offset,d.indicesAttrDesc.count);e.setIndices(i,null)}if(d.subMeshesAttrDesc&&d.subMeshesAttrDesc.count>0){const i=new Int32Array(l,d.subMeshesAttrDesc.offset,d.subMeshesAttrDesc.count*5);e.subMeshes=[];for(let c=0;c<d.subMeshesAttrDesc.count;c++){const n=i[c*5+0],h=i[c*5+1],m=i[c*5+2],o=i[c*5+3],b=i[c*5+4];pe.AddToMesh(n,h,m,o,b,e)}}}else if(l.positions&&l.normals&&l.indices){if(e.setVerticesData(X.PositionKind,l.positions,l.positions._updatable),e.setVerticesData(X.NormalKind,l.normals,l.normals._updatable),l.tangents&&e.setVerticesData(X.TangentKind,l.tangents,l.tangents._updatable),l.uvs&&e.setVerticesData(X.UVKind,l.uvs,l.uvs._updatable),l.uvs2&&e.setVerticesData(X.UV2Kind,l.uvs2,l.uvs2._updatable),l.uvs3&&e.setVerticesData(X.UV3Kind,l.uvs3,l.uvs3._updatable),l.uvs4&&e.setVerticesData(X.UV4Kind,l.uvs4,l.uvs4._updatable),l.uvs5&&e.setVerticesData(X.UV5Kind,l.uvs5,l.uvs5._updatable),l.uvs6&&e.setVerticesData(X.UV6Kind,l.uvs6,l.uvs6._updatable),l.colors&&e.setVerticesData(X.ColorKind,Gl.CheckColors4(l.colors,l.positions.length/3),l.colors._updatable),l.matricesIndices)if(l.matricesIndices._isExpanded)delete l.matricesIndices._isExpanded,e.setVerticesData(X.MatricesIndicesKind,l.matricesIndices,l.matricesIndices._updatable);else{const d=[];for(let i=0;i<l.matricesIndices.length;i++){const c=l.matricesIndices[i];d.push(c&255),d.push((c&65280)>>8),d.push((c&16711680)>>16),d.push(c>>24&255)}e.setVerticesData(X.MatricesIndicesKind,d,l.matricesIndices._updatable)}if(l.matricesIndicesExtra)if(l.matricesIndicesExtra._isExpanded)delete l.matricesIndices._isExpanded,e.setVerticesData(X.MatricesIndicesExtraKind,l.matricesIndicesExtra,l.matricesIndicesExtra._updatable);else{const d=[];for(let i=0;i<l.matricesIndicesExtra.length;i++){const c=l.matricesIndicesExtra[i];d.push(c&255),d.push((c&65280)>>8),d.push((c&16711680)>>16),d.push(c>>24&255)}e.setVerticesData(X.MatricesIndicesExtraKind,d,l.matricesIndicesExtra._updatable)}l.matricesWeights&&(he._CleanMatricesWeights(l,e),e.setVerticesData(X.MatricesWeightsKind,l.matricesWeights,l.matricesWeights._updatable)),l.matricesWeightsExtra&&e.setVerticesData(X.MatricesWeightsExtraKind,l.matricesWeightsExtra,l.matricesWeights._updatable),e.setIndices(l.indices,null)}if(l.subMeshes){e.subMeshes=[];for(let d=0;d<l.subMeshes.length;d++){const i=l.subMeshes[d];pe.AddToMesh(i.materialIndex,i.verticesStart,i.verticesCount,i.indexStart,i.indexCount,e)}}e._shouldGenerateFlatShading&&(e.convertToFlatShadedMesh(),e._shouldGenerateFlatShading=!1),e.computeWorldMatrix(!0),t.onMeshImportedObservable.notifyObservers(e)}static _CleanMatricesWeights(l,e){if(!gl.CleanBoneMatrixWeights)return;let t=0;if(l.skeletonId>-1){const h=e.getScene().getLastSkeletonById(l.skeletonId);if(!h)return;t=h.bones.length}else return;const a=e.getVerticesData(X.MatricesIndicesKind),s=e.getVerticesData(X.MatricesIndicesExtraKind),d=l.matricesWeights,i=l.matricesWeightsExtra,c=l.numBoneInfluencer,n=d.length;for(let h=0;h<n;h+=4){let m=0,o=-1;for(let b=0;b<4;b++){const u=d[h+b];m+=u,u<.001&&o<0&&(o=b)}if(i)for(let b=0;b<4;b++){const u=i[h+b];m+=u,u<.001&&o<0&&(o=b+4)}if((o<0||o>c-1)&&(o=c-1),m>.001){const b=1/m;for(let u=0;u<4;u++)d[h+u]*=b;if(i)for(let u=0;u<4;u++)i[h+u]*=b}else o>=4?(i[h+o-4]=1-m,s[h+o-4]=t):(d[h+o]=1-m,a[h+o]=t)}e.setVerticesData(X.MatricesIndicesKind,a),l.matricesWeightsExtra&&e.setVerticesData(X.MatricesIndicesExtraKind,s)}static Parse(l,e,t){const a=new he(l.id,e,void 0,l.updatable);return a._loadedUniqueId=l.uniqueId,ul&&ul.AddTagsTo(a,l.tags),l.delayLoadingFile?(a.delayLoadState=4,a.delayLoadingFile=t+l.delayLoadingFile,a._boundingInfo=new re(r.FromArray(l.boundingBoxMinimum),r.FromArray(l.boundingBoxMaximum)),a._delayInfo=[],l.hasUVs&&a._delayInfo.push(X.UVKind),l.hasUVs2&&a._delayInfo.push(X.UV2Kind),l.hasUVs3&&a._delayInfo.push(X.UV3Kind),l.hasUVs4&&a._delayInfo.push(X.UV4Kind),l.hasUVs5&&a._delayInfo.push(X.UV5Kind),l.hasUVs6&&a._delayInfo.push(X.UV6Kind),l.hasColors&&a._delayInfo.push(X.ColorKind),l.hasMatricesIndices&&a._delayInfo.push(X.MatricesIndicesKind),l.hasMatricesWeights&&a._delayInfo.push(X.MatricesWeightsKind),a._delayLoadingFunction=$.ImportVertexData):$.ImportVertexData(l,a),e.pushGeometry(a,!0),a}}var Ie;(function(Z){Z[Z.LOCAL=0]="LOCAL",Z[Z.WORLD=1]="WORLD",Z[Z.BONE=2]="BONE"})(Ie||(Ie={}));class Vt{}Vt.X=new r(1,0,0);Vt.Y=new r(0,1,0);Vt.Z=new r(0,0,1);var js;(function(Z){Z[Z.X=0]="X",Z[Z.Y=1]="Y",Z[Z.Z=2]="Z"})(js||(js={}));class q extends Bl{constructor(l,e=null,t=!0){super(l,e),this._forward=new r(0,0,1),this._up=new r(0,1,0),this._right=new r(1,0,0),this._position=r.Zero(),this._rotation=r.Zero(),this._rotationQuaternion=null,this._scaling=r.One(),this._transformToBoneReferal=null,this._isAbsoluteSynced=!1,this._billboardMode=q.BILLBOARDMODE_NONE,this._preserveParentRotationForBillboard=!1,this.scalingDeterminant=1,this._infiniteDistance=!1,this.ignoreNonUniformScaling=!1,this.reIntegrateRotationIntoRotationQuaternion=!1,this._poseMatrix=null,this._localMatrix=Y.Zero(),this._usePivotMatrix=!1,this._absolutePosition=r.Zero(),this._absoluteScaling=r.Zero(),this._absoluteRotationQuaternion=_.Identity(),this._pivotMatrix=Y.Identity(),this._postMultiplyPivotMatrix=!1,this._isWorldMatrixFrozen=!1,this._indexInSceneTransformNodesArray=-1,this.onAfterWorldMatrixUpdateObservable=new z,this._nonUniformScaling=!1,t&&this.getScene().addTransformNode(this)}get billboardMode(){return this._billboardMode}set billboardMode(l){this._billboardMode!==l&&(this._billboardMode=l)}get preserveParentRotationForBillboard(){return this._preserveParentRotationForBillboard}set preserveParentRotationForBillboard(l){l!==this._preserveParentRotationForBillboard&&(this._preserveParentRotationForBillboard=l)}get infiniteDistance(){return this._infiniteDistance}set infiniteDistance(l){this._infiniteDistance!==l&&(this._infiniteDistance=l)}getClassName(){return"TransformNode"}get position(){return this._position}set position(l){this._position=l,this._isDirty=!0}isUsingPivotMatrix(){return this._usePivotMatrix}get rotation(){return this._rotation}set rotation(l){this._rotation=l,this._rotationQuaternion=null,this._isDirty=!0}get scaling(){return this._scaling}set scaling(l){this._scaling=l,this._isDirty=!0}get rotationQuaternion(){return this._rotationQuaternion}set rotationQuaternion(l){this._rotationQuaternion=l,l&&this._rotation.setAll(0),this._isDirty=!0}get forward(){return r.TransformNormalFromFloatsToRef(0,0,this.getScene().useRightHandedSystem?-1:1,this.getWorldMatrix(),this._forward),this._forward.normalize()}get up(){return r.TransformNormalFromFloatsToRef(0,1,0,this.getWorldMatrix(),this._up),this._up.normalize()}get right(){return r.TransformNormalFromFloatsToRef(this.getScene().useRightHandedSystem?-1:1,0,0,this.getWorldMatrix(),this._right),this._right.normalize()}updatePoseMatrix(l){return this._poseMatrix?(this._poseMatrix.copyFrom(l),this):(this._poseMatrix=l.clone(),this)}getPoseMatrix(){return this._poseMatrix||(this._poseMatrix=Y.Identity()),this._poseMatrix}_isSynchronized(){const l=this._cache;return!(this._billboardMode!==l.billboardMode||this._billboardMode!==q.BILLBOARDMODE_NONE||l.pivotMatrixUpdated||this._infiniteDistance||this._position._isDirty||this._scaling._isDirty||this._rotationQuaternion&&this._rotationQuaternion._isDirty||this._rotation._isDirty)}_initCache(){super._initCache();const l=this._cache;l.localMatrixUpdated=!1,l.billboardMode=-1,l.infiniteDistance=!1}get absolutePosition(){return this.getAbsolutePosition()}get absoluteScaling(){return this._syncAbsoluteScalingAndRotation(),this._absoluteScaling}get absoluteRotationQuaternion(){return this._syncAbsoluteScalingAndRotation(),this._absoluteRotationQuaternion}setPreTransformMatrix(l){return this.setPivotMatrix(l,!1)}setPivotMatrix(l,e=!0){return this._pivotMatrix.copyFrom(l),this._usePivotMatrix=!this._pivotMatrix.isIdentity(),this._cache.pivotMatrixUpdated=!0,this._postMultiplyPivotMatrix=e,this._postMultiplyPivotMatrix&&(this._pivotMatrixInverse?this._pivotMatrix.invertToRef(this._pivotMatrixInverse):this._pivotMatrixInverse=Y.Invert(this._pivotMatrix)),this}getPivotMatrix(){return this._pivotMatrix}instantiateHierarchy(l=null,e,t){const a=this.clone("Clone of "+(this.name||this.id),l||this.parent,!0);a&&t&&t(this,a);for(const s of this.getChildTransformNodes(!0))s.instantiateHierarchy(a,e,t);return a}freezeWorldMatrix(l=null,e=!1){return l?e?(this._rotation.setAll(0),this._rotationQuaternion=this._rotationQuaternion||_.Identity(),l.decompose(this._scaling,this._rotationQuaternion,this._position),this.computeWorldMatrix(!0)):(this._worldMatrix=l,this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._afterComputeWorldMatrix()):(this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0)),this._isDirty=!1,this._isWorldMatrixFrozen=!0,this}unfreezeWorldMatrix(){return this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0),this}get isWorldMatrixFrozen(){return this._isWorldMatrixFrozen}getAbsolutePosition(){return this.computeWorldMatrix(),this._absolutePosition}setAbsolutePosition(l){if(!l)return this;let e,t,a;if(l.x===void 0){if(arguments.length<3)return this;e=arguments[0],t=arguments[1],a=arguments[2]}else e=l.x,t=l.y,a=l.z;if(this.parent){const s=f.Matrix[0];this.parent.getWorldMatrix().invertToRef(s),r.TransformCoordinatesFromFloatsToRef(e,t,a,s,this.position)}else this.position.x=e,this.position.y=t,this.position.z=a;return this._absolutePosition.copyFrom(l),this}setPositionWithLocalVector(l){return this.computeWorldMatrix(),this.position=r.TransformNormal(l,this._localMatrix),this}getPositionExpressedInLocalSpace(){this.computeWorldMatrix();const l=f.Matrix[0];return this._localMatrix.invertToRef(l),r.TransformNormal(this.position,l)}locallyTranslate(l){return this.computeWorldMatrix(!0),this.position=r.TransformCoordinates(l,this._localMatrix),this}lookAt(l,e=0,t=0,a=0,s=Ie.LOCAL){const d=q._LookAtVectorCache,i=s===Ie.LOCAL?this.position:this.getAbsolutePosition();if(l.subtractToRef(i,d),this.setDirection(d,e,t,a),s===Ie.WORLD&&this.parent)if(this.rotationQuaternion){const c=f.Matrix[0];this.rotationQuaternion.toRotationMatrix(c);const n=f.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(n),n.invert(),c.multiplyToRef(n,c),this.rotationQuaternion.fromRotationMatrix(c)}else{const c=f.Quaternion[0];_.FromEulerVectorToRef(this.rotation,c);const n=f.Matrix[0];c.toRotationMatrix(n);const h=f.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(h),h.invert(),n.multiplyToRef(h,n),c.fromRotationMatrix(n),c.toEulerAnglesToRef(this.rotation)}return this}getDirection(l){const e=r.Zero();return this.getDirectionToRef(l,e),e}getDirectionToRef(l,e){return r.TransformNormalToRef(l,this.getWorldMatrix(),e),this}setDirection(l,e=0,t=0,a=0){const s=-Math.atan2(l.z,l.x)+Math.PI/2,d=Math.sqrt(l.x*l.x+l.z*l.z),i=-Math.atan2(l.y,d);return this.rotationQuaternion?_.RotationYawPitchRollToRef(s+e,i+t,a,this.rotationQuaternion):(this.rotation.x=i+t,this.rotation.y=s+e,this.rotation.z=a),this}setPivotPoint(l,e=Ie.LOCAL){this.getScene().getRenderId()==0&&this.computeWorldMatrix(!0);const t=this.getWorldMatrix();if(e==Ie.WORLD){const a=f.Matrix[0];t.invertToRef(a),l=r.TransformCoordinates(l,a)}return this.setPivotMatrix(Y.Translation(-l.x,-l.y,-l.z),!0)}getPivotPoint(){const l=r.Zero();return this.getPivotPointToRef(l),l}getPivotPointToRef(l){return l.x=-this._pivotMatrix.m[12],l.y=-this._pivotMatrix.m[13],l.z=-this._pivotMatrix.m[14],this}getAbsolutePivotPoint(){const l=r.Zero();return this.getAbsolutePivotPointToRef(l),l}getAbsolutePivotPointToRef(l){return this.getPivotPointToRef(l),r.TransformCoordinatesToRef(l,this.getWorldMatrix(),l),this}markAsDirty(l){if(this._isDirty)return this;if(this._children)for(const e of this._children)e.markAsDirty(l);return super.markAsDirty(l)}setParent(l,e=!1,t=!1){if(!l&&!this.parent)return this;const a=f.Quaternion[0],s=f.Vector3[0],d=f.Vector3[1],i=f.Matrix[1];Y.IdentityToRef(i);const c=f.Matrix[0];this.computeWorldMatrix(!0);let n=this.rotationQuaternion;return n||(n=q._TmpRotation,_.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,n)),Y.ComposeToRef(this.scaling,n,this.position,c),this.parent&&c.multiplyToRef(this.parent.computeWorldMatrix(!0),c),l&&(l.computeWorldMatrix(!0).invertToRef(i),c.multiplyToRef(i,c)),c.decompose(d,a,s,e?this:void 0),this.rotationQuaternion?this.rotationQuaternion.copyFrom(a):a.toEulerAnglesToRef(this.rotation),this.scaling.copyFrom(d),this.position.copyFrom(s),this.parent=l,t&&this.setPivotMatrix(Y.Identity()),this}get nonUniformScaling(){return this._nonUniformScaling}_updateNonUniformScalingState(l){return this._nonUniformScaling===l?!1:(this._nonUniformScaling=l,!0)}attachToBone(l,e){return this._currentParentWhenAttachingToBone=this.parent,this._transformToBoneReferal=e,this.parent=l,l.getSkeleton().prepare(),l.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this}detachFromBone(l=!1){return this.parent?(this.parent.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this._transformToBoneReferal=null,l?this.parent=this._currentParentWhenAttachingToBone:this.parent=null,this):(l&&(this.parent=this._currentParentWhenAttachingToBone),this)}rotate(l,e,t){l.normalize(),this.rotationQuaternion||(this.rotationQuaternion=this.rotation.toQuaternion(),this.rotation.setAll(0));let a;if(!t||t===Ie.LOCAL)a=_.RotationAxisToRef(l,e,q._RotationAxisCache),this.rotationQuaternion.multiplyToRef(a,this.rotationQuaternion);else{if(this.parent){const s=f.Matrix[0];this.parent.getWorldMatrix().invertToRef(s),l=r.TransformNormal(l,s)}a=_.RotationAxisToRef(l,e,q._RotationAxisCache),a.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion)}return this}rotateAround(l,e,t){e.normalize(),this.rotationQuaternion||(this.rotationQuaternion=_.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),this.rotation.setAll(0));const a=f.Vector3[0],s=f.Vector3[1],d=f.Vector3[2],i=f.Quaternion[0],c=f.Matrix[0],n=f.Matrix[1],h=f.Matrix[2],m=f.Matrix[3];return l.subtractToRef(this.position,a),Y.TranslationToRef(a.x,a.y,a.z,c),Y.TranslationToRef(-a.x,-a.y,-a.z,n),Y.RotationAxisToRef(e,t,h),n.multiplyToRef(h,m),m.multiplyToRef(c,m),m.decompose(s,i,d),this.position.addInPlace(d),i.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion),this}translate(l,e,t){const a=l.scale(e);if(!t||t===Ie.LOCAL){const s=this.getPositionExpressedInLocalSpace().add(a);this.setPositionWithLocalVector(s)}else this.setAbsolutePosition(this.getAbsolutePosition().add(a));return this}addRotation(l,e,t){let a;this.rotationQuaternion?a=this.rotationQuaternion:(a=f.Quaternion[1],_.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,a));const s=f.Quaternion[0];return _.RotationYawPitchRollToRef(e,l,t,s),a.multiplyInPlace(s),this.rotationQuaternion||a.toEulerAnglesToRef(this.rotation),this}_getEffectiveParent(){return this.parent}computeWorldMatrix(l){if(this._isWorldMatrixFrozen&&!this._isDirty)return this._worldMatrix;const e=this.getScene().getRenderId();if(!this._isDirty&&!l&&(this._currentRenderId===e||this.isSynchronized()))return this._currentRenderId=e,this._worldMatrix;const t=this.getScene().activeCamera,a=(this._billboardMode&q.BILLBOARDMODE_USE_POSITION)!==0,s=this._billboardMode!==q.BILLBOARDMODE_NONE&&!this.preserveParentRotationForBillboard;this._updateCache();const d=this._cache;d.pivotMatrixUpdated=!1,d.billboardMode=this.billboardMode,d.infiniteDistance=this.infiniteDistance,d.parent=this._parentNode,this._currentRenderId=e,this._childUpdateId+=1,this._isDirty=!1,this._position._isDirty=!1,this._rotation._isDirty=!1,this._scaling._isDirty=!1;const i=this._getEffectiveParent(),c=q._TmpScaling;let n=this._position;if(this._infiniteDistance&&!this.parent&&t){const m=t.getWorldMatrix(),o=new r(m.m[12],m.m[13],m.m[14]);n=q._TmpTranslation,n.copyFromFloats(this._position.x+o.x,this._position.y+o.y,this._position.z+o.z)}c.copyFromFloats(this._scaling.x*this.scalingDeterminant,this._scaling.y*this.scalingDeterminant,this._scaling.z*this.scalingDeterminant);let h;if(this._rotationQuaternion?(this._rotationQuaternion._isDirty=!1,h=this._rotationQuaternion,this.reIntegrateRotationIntoRotationQuaternion&&this.rotation.lengthSquared()&&(this._rotationQuaternion.multiplyInPlace(_.RotationYawPitchRoll(this._rotation.y,this._rotation.x,this._rotation.z)),this._rotation.copyFromFloats(0,0,0))):(h=q._TmpRotation,_.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,h)),this._usePivotMatrix){const m=f.Matrix[1];Y.ScalingToRef(c.x,c.y,c.z,m);const o=f.Matrix[0];h.toRotationMatrix(o),this._pivotMatrix.multiplyToRef(m,f.Matrix[4]),f.Matrix[4].multiplyToRef(o,this._localMatrix),this._postMultiplyPivotMatrix&&this._localMatrix.multiplyToRef(this._pivotMatrixInverse,this._localMatrix),this._localMatrix.addTranslationFromFloats(n.x,n.y,n.z)}else Y.ComposeToRef(c,h,n,this._localMatrix);if(i&&i.getWorldMatrix){if(l&&i.computeWorldMatrix(l),s){this._transformToBoneReferal?i.getWorldMatrix().multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),f.Matrix[7]):f.Matrix[7].copyFrom(i.getWorldMatrix());const m=f.Vector3[5],o=f.Vector3[6],b=f.Quaternion[0];f.Matrix[7].decompose(o,b,m),Y.ScalingToRef(o.x,o.y,o.z,f.Matrix[7]),f.Matrix[7].setTranslation(m),q.BillboardUseParentOrientation&&(this._position.applyRotationQuaternionToRef(b,m),this._localMatrix.setTranslation(m)),this._localMatrix.multiplyToRef(f.Matrix[7],this._worldMatrix)}else this._transformToBoneReferal?(this._localMatrix.multiplyToRef(i.getWorldMatrix(),f.Matrix[6]),f.Matrix[6].multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),this._worldMatrix)):this._localMatrix.multiplyToRef(i.getWorldMatrix(),this._worldMatrix);this._markSyncedWithParent()}else this._worldMatrix.copyFrom(this._localMatrix);if(s&&t&&this.billboardMode&&!a){const m=f.Vector3[0];if(this._worldMatrix.getTranslationToRef(m),f.Matrix[1].copyFrom(t.getViewMatrix()),f.Matrix[1].setTranslationFromFloats(0,0,0),f.Matrix[1].invertToRef(f.Matrix[0]),(this.billboardMode&q.BILLBOARDMODE_ALL)!==q.BILLBOARDMODE_ALL){f.Matrix[0].decompose(void 0,f.Quaternion[0],void 0);const o=f.Vector3[1];f.Quaternion[0].toEulerAnglesToRef(o),(this.billboardMode&q.BILLBOARDMODE_X)!==q.BILLBOARDMODE_X&&(o.x=0),(this.billboardMode&q.BILLBOARDMODE_Y)!==q.BILLBOARDMODE_Y&&(o.y=0),(this.billboardMode&q.BILLBOARDMODE_Z)!==q.BILLBOARDMODE_Z&&(o.z=0),Y.RotationYawPitchRollToRef(o.y,o.x,o.z,f.Matrix[0])}this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(f.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(f.Vector3[0])}else if(s&&t&&this.billboardMode&&a){const m=f.Vector3[0];this._worldMatrix.getTranslationToRef(m);const o=t.globalPosition;this._worldMatrix.invertToRef(f.Matrix[1]);const b=f.Vector3[1];r.TransformCoordinatesToRef(o,f.Matrix[1],b),b.normalize();const u=-Math.atan2(b.z,b.x)+Math.PI/2,V=Math.sqrt(b.x*b.x+b.z*b.z),G=-Math.atan2(b.y,V);if(_.RotationYawPitchRollToRef(u,G,0,f.Quaternion[0]),(this.billboardMode&q.BILLBOARDMODE_ALL)!==q.BILLBOARDMODE_ALL){const p=f.Vector3[1];f.Quaternion[0].toEulerAnglesToRef(p),(this.billboardMode&q.BILLBOARDMODE_X)!==q.BILLBOARDMODE_X&&(p.x=0),(this.billboardMode&q.BILLBOARDMODE_Y)!==q.BILLBOARDMODE_Y&&(p.y=0),(this.billboardMode&q.BILLBOARDMODE_Z)!==q.BILLBOARDMODE_Z&&(p.z=0),Y.RotationYawPitchRollToRef(p.y,p.x,p.z,f.Matrix[0])}else Y.FromQuaternionToRef(f.Quaternion[0],f.Matrix[0]);this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(f.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(f.Vector3[0])}return this.ignoreNonUniformScaling?this._updateNonUniformScalingState(!1):this._scaling.isNonUniformWithinEpsilon(1e-6)?this._updateNonUniformScalingState(!0):i&&i._nonUniformScaling?this._updateNonUniformScalingState(i._nonUniformScaling):this._updateNonUniformScalingState(!1),this._afterComputeWorldMatrix(),this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._isAbsoluteSynced=!1,this.onAfterWorldMatrixUpdateObservable.notifyObservers(this),this._poseMatrix||(this._poseMatrix=Y.Invert(this._worldMatrix)),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix}resetLocalMatrix(l=!0){if(this.computeWorldMatrix(),l){const e=this.getChildren();for(let t=0;t<e.length;++t){const a=e[t];if(a){a.computeWorldMatrix();const s=f.Matrix[0];a._localMatrix.multiplyToRef(this._localMatrix,s);const d=f.Quaternion[0];s.decompose(a.scaling,d,a.position),a.rotationQuaternion?a.rotationQuaternion.copyFrom(d):d.toEulerAnglesToRef(a.rotation)}}}this.scaling.copyFromFloats(1,1,1),this.position.copyFromFloats(0,0,0),this.rotation.copyFromFloats(0,0,0),this.rotationQuaternion&&(this.rotationQuaternion=_.Identity()),this._worldMatrix=Y.Identity()}_afterComputeWorldMatrix(){}registerAfterWorldMatrixUpdate(l){return this.onAfterWorldMatrixUpdateObservable.add(l),this}unregisterAfterWorldMatrixUpdate(l){return this.onAfterWorldMatrixUpdateObservable.removeCallback(l),this}getPositionInCameraSpace(l=null){return l||(l=this.getScene().activeCamera),r.TransformCoordinates(this.getAbsolutePosition(),l.getViewMatrix())}getDistanceToCamera(l=null){return l||(l=this.getScene().activeCamera),this.getAbsolutePosition().subtract(l.globalPosition).length()}clone(l,e,t){const a=il.Clone(()=>new q(l,this.getScene()),this);if(a.name=l,a.id=l,e&&(a.parent=e),!t){const s=this.getDescendants(!0);for(let d=0;d<s.length;d++){const i=s[d];i.clone&&i.clone(l+"."+i.name,a)}}return a}serialize(l){const e=il.Serialize(this,l);return e.type=this.getClassName(),e.uniqueId=this.uniqueId,this.parent&&this.parent._serializeAsParent(e),e.localMatrix=this.getPivotMatrix().asArray(),e.isEnabled=this.isEnabled(),e}static Parse(l,e,t){const a=il.Parse(()=>new q(l.name,e),l,e,t);return l.localMatrix?a.setPreTransformMatrix(Y.FromArray(l.localMatrix)):l.pivotMatrix&&a.setPivotMatrix(Y.FromArray(l.pivotMatrix)),a.setEnabled(l.isEnabled),a._waitingParsedUniqueId=l.uniqueId,l.parentId!==void 0&&(a._waitingParentId=l.parentId),l.parentInstanceIndex!==void 0&&(a._waitingParentInstanceIndex=l.parentInstanceIndex),a}getChildTransformNodes(l,e){const t=[];return this._getDescendants(t,l,a=>(!e||e(a))&&a instanceof q),t}dispose(l,e=!1){if(this.getScene().stopAnimation(this),this.getScene().removeTransformNode(this),this._parentContainer){const t=this._parentContainer.transformNodes.indexOf(this);t>-1&&this._parentContainer.transformNodes.splice(t,1),this._parentContainer=null}if(this.onAfterWorldMatrixUpdateObservable.clear(),l){const t=this.getChildTransformNodes(!0);for(const a of t)a.parent=null,a.computeWorldMatrix(!0)}super.dispose(l,e)}normalizeToUnitCube(l=!0,e=!1,t){let a=null,s=null;e&&(this.rotationQuaternion?(s=this.rotationQuaternion.clone(),this.rotationQuaternion.copyFromFloats(0,0,0,1)):this.rotation&&(a=this.rotation.clone(),this.rotation.copyFromFloats(0,0,0)));const d=this.getHierarchyBoundingVectors(l,t),i=d.max.subtract(d.min),c=Math.max(i.x,i.y,i.z);if(c===0)return this;const n=1/c;return this.scaling.scaleInPlace(n),e&&(this.rotationQuaternion&&s?this.rotationQuaternion.copyFrom(s):this.rotation&&a&&this.rotation.copyFrom(a)),this}_syncAbsoluteScalingAndRotation(){this._isAbsoluteSynced||(this._worldMatrix.decompose(this._absoluteScaling,this._absoluteRotationQuaternion),this._isAbsoluteSynced=!0)}}q.BILLBOARDMODE_NONE=0;q.BILLBOARDMODE_X=1;q.BILLBOARDMODE_Y=2;q.BILLBOARDMODE_Z=4;q.BILLBOARDMODE_ALL=7;q.BILLBOARDMODE_USE_POSITION=128;q.BillboardUseParentOrientation=!1;q._TmpRotation=_.Zero();q._TmpScaling=r.Zero();q._TmpTranslation=r.Zero();q._LookAtVectorCache=new r(0,0,0);q._RotationAxisCache=new _;W([_e("position")],q.prototype,"_position",void 0);W([_e("rotation")],q.prototype,"_rotation",void 0);W([Ci("rotationQuaternion")],q.prototype,"_rotationQuaternion",void 0);W([_e("scaling")],q.prototype,"_scaling",void 0);W([F("billboardMode")],q.prototype,"_billboardMode",void 0);W([F()],q.prototype,"scalingDeterminant",void 0);W([F("infiniteDistance")],q.prototype,"_infiniteDistance",void 0);W([F()],q.prototype,"ignoreNonUniformScaling",void 0);W([F()],q.prototype,"reIntegrateRotationIntoRotationQuaternion",void 0);class Di{constructor(){this._checkCollisions=!1,this._collisionMask=-1,this._collisionGroup=-1,this._surroundingMeshes=null,this._collider=null,this._oldPositionForCollisions=new r(0,0,0),this._diffPositionForCollisions=new r(0,0,0),this._collisionResponse=!0}}class ji{constructor(){this.facetNb=0,this.partitioningSubdivisions=10,this.partitioningBBoxRatio=1.01,this.facetDataEnabled=!1,this.facetParameters={},this.bbSize=r.Zero(),this.subDiv={max:1,X:1,Y:1,Z:1},this.facetDepthSort=!1,this.facetDepthSortEnabled=!1}}class Ai{constructor(){this._hasVertexAlpha=!1,this._useVertexColors=!0,this._numBoneInfluencers=4,this._applyFog=!0,this._receiveShadows=!1,this._facetData=new ji,this._visibility=1,this._skeleton=null,this._layerMask=268435455,this._computeBonesUsingShaders=!0,this._isActive=!1,this._onlyForInstances=!1,this._isActiveIntermediate=!1,this._onlyForInstancesIntermediate=!1,this._actAsRegularMesh=!1,this._currentLOD=null,this._currentLODIsUpToDate=!1,this._collisionRetryCount=3,this._morphTargetManager=null,this._renderingGroupId=0,this._bakedVertexAnimationManager=null,this._material=null,this._positions=null,this._pointerOverDisableMeshTesting=!1,this._meshCollisionData=new Di,this._enableDistantPicking=!1}}class me extends q{constructor(l,e=null){switch(super(l,e,!1),this._internalAbstractMeshDataInfo=new Ai,this._waitingMaterialId=null,this.cullingStrategy=me.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY,this.onCollideObservable=new z,this.onCollisionPositionChangeObservable=new z,this.onMaterialChangedObservable=new z,this.definedFacingForward=!0,this._occlusionQuery=null,this._renderingGroup=null,this.alphaIndex=Number.MAX_VALUE,this.isVisible=!0,this.isPickable=!0,this.isNearPickable=!1,this.isNearGrabbable=!1,this.showSubMeshesBoundingBox=!1,this.isBlocker=!1,this.enablePointerMoveEvents=!1,this.outlineColor=al.Red(),this.outlineWidth=.02,this.overlayColor=al.Red(),this.overlayAlpha=.5,this.useOctreeForRenderingSelection=!0,this.useOctreeForPicking=!0,this.useOctreeForCollisions=!0,this.alwaysSelectAsActiveMesh=!1,this.doNotSyncBoundingInfo=!1,this.actionManager=null,this.ellipsoid=new r(.5,1,.5),this.ellipsoidOffset=new r(0,0,0),this.edgesWidth=1,this.edgesColor=new Gl(1,0,0,1),this._edgesRenderer=null,this._masterMesh=null,this._boundingInfo=null,this._boundingInfoIsDirty=!0,this._renderId=0,this._intersectionsInProgress=new Array,this._unIndexed=!1,this._lightSources=new Array,this._waitingData={lods:null,actions:null,freezeWorldMatrix:null},this._bonesTransformMatrices=null,this._transformMatrixTexture=null,this.onRebuildObservable=new z,this._onCollisionPositionChange=(t,a,s=null)=>{a.subtractToRef(this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions),this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions.length()>x.CollisionsEpsilon&&this.position.addInPlace(this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions),s&&this.onCollideObservable.notifyObservers(s),this.onCollisionPositionChangeObservable.notifyObservers(this.position)},e=this.getScene(),e.addMesh(this),this._resyncLightSources(),this._uniformBuffer=new I(this.getScene().getEngine(),void 0,void 0,l,!this.getScene().getEngine().isWebGPU),this._buildUniformLayout(),e.performancePriority){case Te.Aggressive:this.doNotSyncBoundingInfo=!0;case Te.Intermediate:this.alwaysSelectAsActiveMesh=!0,this.isPickable=!1;break}}static get BILLBOARDMODE_NONE(){return q.BILLBOARDMODE_NONE}static get BILLBOARDMODE_X(){return q.BILLBOARDMODE_X}static get BILLBOARDMODE_Y(){return q.BILLBOARDMODE_Y}static get BILLBOARDMODE_Z(){return q.BILLBOARDMODE_Z}static get BILLBOARDMODE_ALL(){return q.BILLBOARDMODE_ALL}static get BILLBOARDMODE_USE_POSITION(){return q.BILLBOARDMODE_USE_POSITION}get facetNb(){return this._internalAbstractMeshDataInfo._facetData.facetNb}get partitioningSubdivisions(){return this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions}set partitioningSubdivisions(l){this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions=l}get partitioningBBoxRatio(){return this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio}set partitioningBBoxRatio(l){this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio=l}get mustDepthSortFacets(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSort}set mustDepthSortFacets(l){this._internalAbstractMeshDataInfo._facetData.facetDepthSort=l}get facetDepthSortFrom(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom}set facetDepthSortFrom(l){this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom=l}get collisionRetryCount(){return this._internalAbstractMeshDataInfo._collisionRetryCount}set collisionRetryCount(l){this._internalAbstractMeshDataInfo._collisionRetryCount=l}get isFacetDataEnabled(){return this._internalAbstractMeshDataInfo._facetData.facetDataEnabled}get morphTargetManager(){return this._internalAbstractMeshDataInfo._morphTargetManager}set morphTargetManager(l){this._internalAbstractMeshDataInfo._morphTargetManager!==l&&(this._internalAbstractMeshDataInfo._morphTargetManager=l,this._syncGeometryWithMorphTargetManager())}get bakedVertexAnimationManager(){return this._internalAbstractMeshDataInfo._bakedVertexAnimationManager}set bakedVertexAnimationManager(l){this._internalAbstractMeshDataInfo._bakedVertexAnimationManager!==l&&(this._internalAbstractMeshDataInfo._bakedVertexAnimationManager=l,this._markSubMeshesAsAttributesDirty())}_syncGeometryWithMorphTargetManager(){}_updateNonUniformScalingState(l){return super._updateNonUniformScalingState(l)?(this._markSubMeshesAsMiscDirty(),!0):!1}set onCollide(l){this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver&&this.onCollideObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver),this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver=this.onCollideObservable.add(l)}set onCollisionPositionChange(l){this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver&&this.onCollisionPositionChangeObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver),this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver=this.onCollisionPositionChangeObservable.add(l)}get visibility(){return this._internalAbstractMeshDataInfo._visibility}set visibility(l){if(this._internalAbstractMeshDataInfo._visibility===l)return;const e=this._internalAbstractMeshDataInfo._visibility;this._internalAbstractMeshDataInfo._visibility=l,(e===1&&l!==1||e!==1&&l===1)&&this._markSubMeshesAsMiscDirty()}get pointerOverDisableMeshTesting(){return this._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting}set pointerOverDisableMeshTesting(l){this._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting=l}get renderingGroupId(){return this._internalAbstractMeshDataInfo._renderingGroupId}set renderingGroupId(l){this._internalAbstractMeshDataInfo._renderingGroupId=l}get material(){return this._internalAbstractMeshDataInfo._material}set material(l){this._internalAbstractMeshDataInfo._material!==l&&(this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=void 0),this._internalAbstractMeshDataInfo._material=l,l&&l.meshMap&&(l.meshMap[this.uniqueId]=this),this.onMaterialChangedObservable.hasObservers()&&this.onMaterialChangedObservable.notifyObservers(this),this.subMeshes&&(this.resetDrawCache(),this._unBindEffect()))}getMaterialForRenderPass(l){var e;return(e=this._internalAbstractMeshDataInfo._materialForRenderPass)===null||e===void 0?void 0:e[l]}setMaterialForRenderPass(l,e){this.resetDrawCache(l),this._internalAbstractMeshDataInfo._materialForRenderPass||(this._internalAbstractMeshDataInfo._materialForRenderPass=[]),this._internalAbstractMeshDataInfo._materialForRenderPass[l]=e}get receiveShadows(){return this._internalAbstractMeshDataInfo._receiveShadows}set receiveShadows(l){this._internalAbstractMeshDataInfo._receiveShadows!==l&&(this._internalAbstractMeshDataInfo._receiveShadows=l,this._markSubMeshesAsLightDirty())}get hasVertexAlpha(){return this._internalAbstractMeshDataInfo._hasVertexAlpha}set hasVertexAlpha(l){this._internalAbstractMeshDataInfo._hasVertexAlpha!==l&&(this._internalAbstractMeshDataInfo._hasVertexAlpha=l,this._markSubMeshesAsAttributesDirty(),this._markSubMeshesAsMiscDirty())}get useVertexColors(){return this._internalAbstractMeshDataInfo._useVertexColors}set useVertexColors(l){this._internalAbstractMeshDataInfo._useVertexColors!==l&&(this._internalAbstractMeshDataInfo._useVertexColors=l,this._markSubMeshesAsAttributesDirty())}get computeBonesUsingShaders(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders}set computeBonesUsingShaders(l){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==l&&(this._internalAbstractMeshDataInfo._computeBonesUsingShaders=l,this._markSubMeshesAsAttributesDirty())}get numBoneInfluencers(){return this._internalAbstractMeshDataInfo._numBoneInfluencers}set numBoneInfluencers(l){this._internalAbstractMeshDataInfo._numBoneInfluencers!==l&&(this._internalAbstractMeshDataInfo._numBoneInfluencers=l,this._markSubMeshesAsAttributesDirty())}get applyFog(){return this._internalAbstractMeshDataInfo._applyFog}set applyFog(l){this._internalAbstractMeshDataInfo._applyFog!==l&&(this._internalAbstractMeshDataInfo._applyFog=l,this._markSubMeshesAsMiscDirty())}get enableDistantPicking(){return this._internalAbstractMeshDataInfo._enableDistantPicking}set enableDistantPicking(l){this._internalAbstractMeshDataInfo._enableDistantPicking=l}get layerMask(){return this._internalAbstractMeshDataInfo._layerMask}set layerMask(l){l!==this._internalAbstractMeshDataInfo._layerMask&&(this._internalAbstractMeshDataInfo._layerMask=l,this._resyncLightSources())}get collisionMask(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask}set collisionMask(l){this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask=isNaN(l)?-1:l}get collisionResponse(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse}set collisionResponse(l){this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse=l}get collisionGroup(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup}set collisionGroup(l){this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup=isNaN(l)?-1:l}get surroundingMeshes(){return this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes}set surroundingMeshes(l){this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes=l}get lightSources(){return this._lightSources}get _positions(){return null}set skeleton(l){const e=this._internalAbstractMeshDataInfo._skeleton;e&&e.needInitialSkinMatrix&&e._unregisterMeshWithPoseMatrix(this),l&&l.needInitialSkinMatrix&&l._registerMeshWithPoseMatrix(this),this._internalAbstractMeshDataInfo._skeleton=l,this._internalAbstractMeshDataInfo._skeleton||(this._bonesTransformMatrices=null),this._markSubMeshesAsAttributesDirty()}get skeleton(){return this._internalAbstractMeshDataInfo._skeleton}_buildUniformLayout(){this._uniformBuffer.addUniform("world",16),this._uniformBuffer.addUniform("visibility",1),this._uniformBuffer.create()}transferToEffect(l){const e=this._uniformBuffer;e.updateMatrix("world",l),e.updateFloat("visibility",this._internalAbstractMeshDataInfo._visibility),e.update()}getMeshUniformBuffer(){return this._uniformBuffer}getClassName(){return"AbstractMesh"}toString(l){let e="Name: "+this.name+", isInstance: "+(this.getClassName()!=="InstancedMesh"?"YES":"NO");e+=", # of submeshes: "+(this.subMeshes?this.subMeshes.length:0);const t=this._internalAbstractMeshDataInfo._skeleton;return t&&(e+=", skeleton: "+t.name),l&&(e+=", billboard mode: "+["NONE","X","Y",null,"Z",null,null,"ALL"][this.billboardMode],e+=", freeze wrld mat: "+(this._isWorldMatrixFrozen||this._waitingData.freezeWorldMatrix?"YES":"NO")),e}_getEffectiveParent(){return this._masterMesh&&this.billboardMode!==q.BILLBOARDMODE_NONE?this._masterMesh:super._getEffectiveParent()}_getActionManagerForTrigger(l,e=!0){if(this.actionManager&&(e||this.actionManager.isRecursive))if(l){if(this.actionManager.hasSpecificTrigger(l))return this.actionManager}else return this.actionManager;return this.parent?this.parent._getActionManagerForTrigger(l,!1):null}_rebuild(l=!1){if(this.onRebuildObservable.notifyObservers(this),this._occlusionQuery!==null&&(this._occlusionQuery=null),!!this.subMeshes)for(const e of this.subMeshes)e._rebuild()}_resyncLightSources(){this._lightSources.length=0;for(const l of this.getScene().lights)l.isEnabled()&&l.canAffectMesh(this)&&this._lightSources.push(l);this._markSubMeshesAsLightDirty()}_resyncLightSource(l){const e=l.isEnabled()&&l.canAffectMesh(this),t=this._lightSources.indexOf(l);let a=!1;if(t===-1){if(!e)return;this._lightSources.push(l)}else{if(e)return;a=!0,this._lightSources.splice(t,1)}this._markSubMeshesAsLightDirty(a)}_unBindEffect(){for(const l of this.subMeshes)l.setEffect(null)}_removeLightSource(l,e){const t=this._lightSources.indexOf(l);t!==-1&&(this._lightSources.splice(t,1),this._markSubMeshesAsLightDirty(e))}_markSubMeshesAsDirty(l){if(this.subMeshes)for(const e of this.subMeshes)for(let t=0;t<e._drawWrappers.length;++t){const a=e._drawWrappers[t];!a||!a.defines||!a.defines.markAllAsDirty||l(a.defines)}}_markSubMeshesAsLightDirty(l=!1){this._markSubMeshesAsDirty(e=>e.markAsLightDirty(l))}_markSubMeshesAsAttributesDirty(){this._markSubMeshesAsDirty(l=>l.markAsAttributesDirty())}_markSubMeshesAsMiscDirty(){this._markSubMeshesAsDirty(l=>l.markAsMiscDirty())}markAsDirty(l){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}resetDrawCache(l){if(this.subMeshes)for(const e of this.subMeshes)e.resetDrawCache(l)}get isBlocked(){return!1}getLOD(l){return this}getTotalVertices(){return 0}getTotalIndices(){return 0}getIndices(){return null}getVerticesData(l){return null}setVerticesData(l,e,t,a){return this}updateVerticesData(l,e,t,a){return this}setIndices(l,e){return this}isVerticesDataPresent(l){return!1}getBoundingInfo(){return this._masterMesh?this._masterMesh.getBoundingInfo():(this._boundingInfoIsDirty&&(this._boundingInfoIsDirty=!1,this._updateBoundingInfo()),this._boundingInfo)}setBoundingInfo(l){return this._boundingInfo=l,this}get hasBoundingInfo(){return this._boundingInfo!==null}buildBoundingInfo(l,e,t){return this._boundingInfo=new re(l,e,t),this._boundingInfo}normalizeToUnitCube(l=!0,e=!1,t){return super.normalizeToUnitCube(l,e,t)}get useBones(){return this.skeleton&&this.getScene().skeletonsEnabled&&this.isVerticesDataPresent(X.MatricesIndicesKind)&&this.isVerticesDataPresent(X.MatricesWeightsKind)}_preActivate(){}_preActivateForIntermediateRendering(l){}_activate(l,e){return this._renderId=l,!0}_postActivate(){}_freeze(){}_unFreeze(){}getWorldMatrix(){return this._masterMesh&&this.billboardMode===q.BILLBOARDMODE_NONE?this._masterMesh.getWorldMatrix():super.getWorldMatrix()}_getWorldMatrixDeterminant(){return this._masterMesh?this._masterMesh._getWorldMatrixDeterminant():super._getWorldMatrixDeterminant()}get isAnInstance(){return!1}get hasInstances(){return!1}get hasThinInstances(){return!1}movePOV(l,e,t){return this.position.addInPlace(this.calcMovePOV(l,e,t)),this}calcMovePOV(l,e,t){const a=new Y;(this.rotationQuaternion?this.rotationQuaternion:_.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z)).toRotationMatrix(a);const s=r.Zero(),d=this.definedFacingForward?-1:1;return r.TransformCoordinatesFromFloatsToRef(l*d,e,t*d,a,s),s}rotatePOV(l,e,t){return this.rotation.addInPlace(this.calcRotatePOV(l,e,t)),this}calcRotatePOV(l,e,t){const a=this.definedFacingForward?1:-1;return new r(l*a,e,t*a)}refreshBoundingInfo(l=!1,e=!1){return this._boundingInfo&&this._boundingInfo.isLocked?this:(this._refreshBoundingInfo(this._getPositionData(l,e),null),this)}_refreshBoundingInfo(l,e){if(l){const t=Fd(l,0,this.getTotalVertices(),e);this._boundingInfo?this._boundingInfo.reConstruct(t.minimum,t.maximum):this._boundingInfo=new re(t.minimum,t.maximum)}if(this.subMeshes)for(let t=0;t<this.subMeshes.length;t++)this.subMeshes[t].refreshBoundingInfo(l);this._updateBoundingInfo()}_getData(l=!1,e=!1,t,a=X.PositionKind){if(t=t??this.getVerticesData(a).slice(),t&&e&&this.morphTargetManager){let s=0,d=0;for(let i=0;i<t.length;i++){for(let c=0;c<this.morphTargetManager.numTargets;c++){const n=this.morphTargetManager.getTarget(c),h=n.influence;if(h>0){const m=n.getPositions();m&&(t[i]+=(m[i]-t[i])*h)}}if(s++,a===X.PositionKind&&this._positions&&s===3){s=0;const c=d*3;this._positions[d++].copyFromFloats(t[c],t[c+1],t[c+2])}}}if(t&&l&&this.skeleton){const s=this.getVerticesData(X.MatricesIndicesKind),d=this.getVerticesData(X.MatricesWeightsKind);if(d&&s){const i=this.numBoneInfluencers>4,c=i?this.getVerticesData(X.MatricesIndicesExtraKind):null,n=i?this.getVerticesData(X.MatricesWeightsExtraKind):null,h=this.skeleton.getTransformMatrices(this),m=f.Vector3[0],o=f.Matrix[0],b=f.Matrix[1];let u=0;for(let V=0;V<t.length;V+=3,u+=4){o.reset();let G,p;for(G=0;G<4;G++)p=d[u+G],p>0&&(Y.FromFloat32ArrayToRefScaled(h,Math.floor(s[u+G]*16),p,b),o.addToSelf(b));if(i)for(G=0;G<4;G++)p=n[u+G],p>0&&(Y.FromFloat32ArrayToRefScaled(h,Math.floor(c[u+G]*16),p,b),o.addToSelf(b));a===X.NormalKind?r.TransformNormalFromFloatsToRef(t[V],t[V+1],t[V+2],o,m):r.TransformCoordinatesFromFloatsToRef(t[V],t[V+1],t[V+2],o,m),m.toArray(t,V),a===X.PositionKind&&this._positions&&this._positions[V/3].copyFrom(m)}}}return t}getNormalsData(l=!1,e=!1){return this._getData(l,e,null,X.NormalKind)}getPositionData(l=!1,e=!1,t){return this._getData(l,e,t,X.PositionKind)}_getPositionData(l,e){var t;let a=this.getVerticesData(X.PositionKind);if(this._internalAbstractMeshDataInfo._positions&&(this._internalAbstractMeshDataInfo._positions=null),a&&(l&&this.skeleton||e&&this.morphTargetManager)){if(a=a.slice(),this._generatePointsArray(),this._positions){const s=this._positions;this._internalAbstractMeshDataInfo._positions=new Array(s.length);for(let d=0;d<s.length;d++)this._internalAbstractMeshDataInfo._positions[d]=((t=s[d])===null||t===void 0?void 0:t.clone())||new r}return this.getPositionData(l,e,a)}return a}_updateBoundingInfo(){return this._boundingInfo?this._boundingInfo.update(this.worldMatrixFromCache):this._boundingInfo=new re(r.Zero(),r.Zero(),this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}_updateSubMeshesBoundingInfo(l){if(!this.subMeshes)return this;const e=this.subMeshes.length;for(let t=0;t<e;t++){const a=this.subMeshes[t];(e>1||!a.IsGlobal)&&a.updateBoundingInfo(l)}return this}_afterComputeWorldMatrix(){this.doNotSyncBoundingInfo||(this._boundingInfoIsDirty=!0)}isInFrustum(l){return this.getBoundingInfo().isInFrustum(l,this.cullingStrategy)}isCompletelyInFrustum(l){return this.getBoundingInfo().isCompletelyInFrustum(l)}intersectsMesh(l,e=!1,t){const a=this.getBoundingInfo(),s=l.getBoundingInfo();if(a.intersects(s,e))return!0;if(t){for(const d of this.getChildMeshes())if(d.intersectsMesh(l,e,!0))return!0}return!1}intersectsPoint(l){return this.getBoundingInfo().intersectsPoint(l)}get checkCollisions(){return this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions}set checkCollisions(l){this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions=l}get collider(){return this._internalAbstractMeshDataInfo._meshCollisionData._collider}moveWithCollisions(l){this.getAbsolutePosition().addToRef(this.ellipsoidOffset,this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions);const e=this.getScene().collisionCoordinator;return this._internalAbstractMeshDataInfo._meshCollisionData._collider||(this._internalAbstractMeshDataInfo._meshCollisionData._collider=e.createCollider()),this._internalAbstractMeshDataInfo._meshCollisionData._collider._radius=this.ellipsoid,e.getNewPosition(this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,l,this._internalAbstractMeshDataInfo._meshCollisionData._collider,this.collisionRetryCount,this,this._onCollisionPositionChange,this.uniqueId),this}_collideForSubMesh(l,e,t){var a;if(this._generatePointsArray(),!this._positions)return this;if(!l._lastColliderWorldVertices||!l._lastColliderTransformMatrix.equals(e)){l._lastColliderTransformMatrix=e.clone(),l._lastColliderWorldVertices=[],l._trianglePlanes=[];const s=l.verticesStart,d=l.verticesStart+l.verticesCount;for(let i=s;i<d;i++)l._lastColliderWorldVertices.push(r.TransformCoordinates(this._positions[i],e))}return t._collide(l._trianglePlanes,l._lastColliderWorldVertices,this.getIndices(),l.indexStart,l.indexStart+l.indexCount,l.verticesStart,!!l.getMaterial(),this,this._shouldConvertRHS(),((a=l.getMaterial())===null||a===void 0?void 0:a.fillMode)===7),this}_processCollisionsForSubMeshes(l,e){const t=this._scene.getCollidingSubMeshCandidates(this,l),a=t.length;for(let s=0;s<a;s++){const d=t.data[s];a>1&&!d._checkCollision(l)||this._collideForSubMesh(d,e,l)}return this}_shouldConvertRHS(){return!1}_checkCollision(l){if(!this.getBoundingInfo()._checkCollision(l))return this;const e=f.Matrix[0],t=f.Matrix[1];return Y.ScalingToRef(1/l._radius.x,1/l._radius.y,1/l._radius.z,e),this.worldMatrixFromCache.multiplyToRef(e,t),this._processCollisionsForSubMeshes(l,t),this}_generatePointsArray(){return!1}intersects(l,e,t,a=!1,s,d=!1){const i=new we,c=this.getClassName()==="InstancedLinesMesh"||this.getClassName()==="LinesMesh"?this.intersectionThreshold:0,n=this.getBoundingInfo();if(!this.subMeshes||!d&&(!l.intersectsSphere(n.boundingSphere,c)||!l.intersectsBox(n.boundingBox,c)))return i;if(a)return i.hit=!d,i.pickedMesh=d?null:this,i.distance=d?0:r.Distance(l.origin,n.boundingSphere.center),i.subMeshId=0,i;if(!this._generatePointsArray())return i;let h=null;const m=this._scene.getIntersectingSubMeshCandidates(this,l),o=m.length;let b=!1;for(let u=0;u<o;u++){const V=m.data[u].getMaterial();if(V&&(V.fillMode==7||V.fillMode==0||V.fillMode==1||V.fillMode==2||V.fillMode==4)){b=!0;break}}if(!b)return i.hit=!0,i.pickedMesh=this,i.distance=r.Distance(l.origin,n.boundingSphere.center),i.subMeshId=-1,i;for(let u=0;u<o;u++){const V=m.data[u];if(o>1&&!V.canIntersects(l))continue;const G=V.intersects(l,this._positions,this.getIndices(),e,t);if(G&&(e||!h||G.distance<h.distance)&&(h=G,h.subMeshId=u,e))break}if(h){const u=s??this.getWorldMatrix(),V=f.Vector3[0],G=f.Vector3[1];r.TransformCoordinatesToRef(l.origin,u,V),l.direction.scaleToRef(h.distance,G);const p=r.TransformNormal(G,u).addInPlace(V);return i.hit=!0,i.distance=r.Distance(V,p),i.pickedPoint=p,i.pickedMesh=this,i.bu=h.bu||0,i.bv=h.bv||0,i.subMeshFaceId=h.faceId,i.faceId=h.faceId+m.data[h.subMeshId].indexStart/(this.getClassName().indexOf("LinesMesh")!==-1?2:3),i.subMeshId=h.subMeshId,i}return i}clone(l,e,t){return null}releaseSubMeshes(){if(this.subMeshes)for(;this.subMeshes.length;)this.subMeshes[0].dispose();else this.subMeshes=new Array;return this}dispose(l,e=!1){let t;for(this._scene.useMaterialMeshMap&&this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=void 0),this.getScene().freeActiveMeshes(),this.getScene().freeRenderingGroups(),this.actionManager!==void 0&&this.actionManager!==null&&(this.actionManager.dispose(),this.actionManager=null),this._internalAbstractMeshDataInfo._skeleton=null,this._transformMatrixTexture&&(this._transformMatrixTexture.dispose(),this._transformMatrixTexture=null),t=0;t<this._intersectionsInProgress.length;t++){const s=this._intersectionsInProgress[t],d=s._intersectionsInProgress.indexOf(this);s._intersectionsInProgress.splice(d,1)}this._intersectionsInProgress.length=0,this.getScene().lights.forEach(s=>{let d=s.includedOnlyMeshes.indexOf(this);d!==-1&&s.includedOnlyMeshes.splice(d,1),d=s.excludedMeshes.indexOf(this),d!==-1&&s.excludedMeshes.splice(d,1);const i=s.getShadowGenerators();if(i){const c=i.values();for(let n=c.next();n.done!==!0;n=c.next()){const h=n.value.getShadowMap();h&&h.renderList&&(d=h.renderList.indexOf(this),d!==-1&&h.renderList.splice(d,1))}}}),(this.getClassName()!=="InstancedMesh"||this.getClassName()!=="InstancedLinesMesh")&&this.releaseSubMeshes();const a=this.getScene().getEngine();if(this._occlusionQuery!==null&&(this.isOcclusionQueryInProgress=!1,a.deleteQuery(this._occlusionQuery),this._occlusionQuery=null),a.wipeCaches(),this.getScene().removeMesh(this),this._parentContainer){const s=this._parentContainer.meshes.indexOf(this);s>-1&&this._parentContainer.meshes.splice(s,1),this._parentContainer=null}if(e&&this.material&&(this.material.getClassName()==="MultiMaterial"?this.material.dispose(!1,!0,!0):this.material.dispose(!1,!0)),!l)for(t=0;t<this.getScene().particleSystems.length;t++)this.getScene().particleSystems[t].emitter===this&&(this.getScene().particleSystems[t].dispose(),t--);this._internalAbstractMeshDataInfo._facetData.facetDataEnabled&&this.disableFacetData(),this._uniformBuffer.dispose(),this.onAfterWorldMatrixUpdateObservable.clear(),this.onCollideObservable.clear(),this.onCollisionPositionChangeObservable.clear(),this.onRebuildObservable.clear(),super.dispose(l,e)}addChild(l,e=!1){return l.setParent(this,e),this}removeChild(l,e=!1){return l.setParent(null,e),this}_initFacetData(){const l=this._internalAbstractMeshDataInfo._facetData;l.facetNormals||(l.facetNormals=new Array),l.facetPositions||(l.facetPositions=new Array),l.facetPartitioning||(l.facetPartitioning=new Array),l.facetNb=this.getIndices().length/3|0,l.partitioningSubdivisions=l.partitioningSubdivisions?l.partitioningSubdivisions:10,l.partitioningBBoxRatio=l.partitioningBBoxRatio?l.partitioningBBoxRatio:1.01;for(let e=0;e<l.facetNb;e++)l.facetNormals[e]=r.Zero(),l.facetPositions[e]=r.Zero();return l.facetDataEnabled=!0,this}updateFacetData(){const l=this._internalAbstractMeshDataInfo._facetData;l.facetDataEnabled||this._initFacetData();const e=this.getVerticesData(X.PositionKind),t=this.getIndices(),a=this.getVerticesData(X.NormalKind),s=this.getBoundingInfo();if(l.facetDepthSort&&!l.facetDepthSortEnabled){if(l.facetDepthSortEnabled=!0,t instanceof Uint16Array)l.depthSortedIndices=new Uint16Array(t);else if(t instanceof Uint32Array)l.depthSortedIndices=new Uint32Array(t);else{let i=!1;for(let c=0;c<t.length;c++)if(t[c]>65535){i=!0;break}i?l.depthSortedIndices=new Uint32Array(t):l.depthSortedIndices=new Uint16Array(t)}if(l.facetDepthSortFunction=function(i,c){return c.sqDistance-i.sqDistance},!l.facetDepthSortFrom){const i=this.getScene().activeCamera;l.facetDepthSortFrom=i?i.position:r.Zero()}l.depthSortedFacets=[];for(let i=0;i<l.facetNb;i++){const c={ind:i*3,sqDistance:0};l.depthSortedFacets.push(c)}l.invertedMatrix=Y.Identity(),l.facetDepthSortOrigin=r.Zero()}l.bbSize.x=s.maximum.x-s.minimum.x>Sl?s.maximum.x-s.minimum.x:Sl,l.bbSize.y=s.maximum.y-s.minimum.y>Sl?s.maximum.y-s.minimum.y:Sl,l.bbSize.z=s.maximum.z-s.minimum.z>Sl?s.maximum.z-s.minimum.z:Sl;let d=l.bbSize.x>l.bbSize.y?l.bbSize.x:l.bbSize.y;if(d=d>l.bbSize.z?d:l.bbSize.z,l.subDiv.max=l.partitioningSubdivisions,l.subDiv.X=Math.floor(l.subDiv.max*l.bbSize.x/d),l.subDiv.Y=Math.floor(l.subDiv.max*l.bbSize.y/d),l.subDiv.Z=Math.floor(l.subDiv.max*l.bbSize.z/d),l.subDiv.X=l.subDiv.X<1?1:l.subDiv.X,l.subDiv.Y=l.subDiv.Y<1?1:l.subDiv.Y,l.subDiv.Z=l.subDiv.Z<1?1:l.subDiv.Z,l.facetParameters.facetNormals=this.getFacetLocalNormals(),l.facetParameters.facetPositions=this.getFacetLocalPositions(),l.facetParameters.facetPartitioning=this.getFacetLocalPartitioning(),l.facetParameters.bInfo=s,l.facetParameters.bbSize=l.bbSize,l.facetParameters.subDiv=l.subDiv,l.facetParameters.ratio=this.partitioningBBoxRatio,l.facetParameters.depthSort=l.facetDepthSort,l.facetDepthSort&&l.facetDepthSortEnabled&&(this.computeWorldMatrix(!0),this._worldMatrix.invertToRef(l.invertedMatrix),r.TransformCoordinatesToRef(l.facetDepthSortFrom,l.invertedMatrix,l.facetDepthSortOrigin),l.facetParameters.distanceTo=l.facetDepthSortOrigin),l.facetParameters.depthSortedFacets=l.depthSortedFacets,a&&$.ComputeNormals(e,t,a,l.facetParameters),l.facetDepthSort&&l.facetDepthSortEnabled){l.depthSortedFacets.sort(l.facetDepthSortFunction);const i=l.depthSortedIndices.length/3|0;for(let c=0;c<i;c++){const n=l.depthSortedFacets[c].ind;l.depthSortedIndices[c*3]=t[n],l.depthSortedIndices[c*3+1]=t[n+1],l.depthSortedIndices[c*3+2]=t[n+2]}this.updateIndices(l.depthSortedIndices,void 0,!0)}return this}getFacetLocalNormals(){const l=this._internalAbstractMeshDataInfo._facetData;return l.facetNormals||this.updateFacetData(),l.facetNormals}getFacetLocalPositions(){const l=this._internalAbstractMeshDataInfo._facetData;return l.facetPositions||this.updateFacetData(),l.facetPositions}getFacetLocalPartitioning(){const l=this._internalAbstractMeshDataInfo._facetData;return l.facetPartitioning||this.updateFacetData(),l.facetPartitioning}getFacetPosition(l){const e=r.Zero();return this.getFacetPositionToRef(l,e),e}getFacetPositionToRef(l,e){const t=this.getFacetLocalPositions()[l],a=this.getWorldMatrix();return r.TransformCoordinatesToRef(t,a,e),this}getFacetNormal(l){const e=r.Zero();return this.getFacetNormalToRef(l,e),e}getFacetNormalToRef(l,e){const t=this.getFacetLocalNormals()[l];return r.TransformNormalToRef(t,this.getWorldMatrix(),e),this}getFacetsAtLocalCoordinates(l,e,t){const a=this.getBoundingInfo(),s=this._internalAbstractMeshDataInfo._facetData,d=Math.floor((l-a.minimum.x*s.partitioningBBoxRatio)*s.subDiv.X*s.partitioningBBoxRatio/s.bbSize.x),i=Math.floor((e-a.minimum.y*s.partitioningBBoxRatio)*s.subDiv.Y*s.partitioningBBoxRatio/s.bbSize.y),c=Math.floor((t-a.minimum.z*s.partitioningBBoxRatio)*s.subDiv.Z*s.partitioningBBoxRatio/s.bbSize.z);return d<0||d>s.subDiv.max||i<0||i>s.subDiv.max||c<0||c>s.subDiv.max?null:s.facetPartitioning[d+s.subDiv.max*i+s.subDiv.max*s.subDiv.max*c]}getClosestFacetAtCoordinates(l,e,t,a,s=!1,d=!0){const i=this.getWorldMatrix(),c=f.Matrix[5];i.invertToRef(c);const n=f.Vector3[8];r.TransformCoordinatesFromFloatsToRef(l,e,t,c,n);const h=this.getClosestFacetAtLocalCoordinates(n.x,n.y,n.z,a,s,d);return a&&r.TransformCoordinatesFromFloatsToRef(a.x,a.y,a.z,i,a),h}getClosestFacetAtLocalCoordinates(l,e,t,a,s=!1,d=!0){let i=null,c=0,n=0,h=0,m=0,o=0,b=0,u=0,V=0;const G=this.getFacetLocalPositions(),p=this.getFacetLocalNormals(),y=this.getFacetsAtLocalCoordinates(l,e,t);if(!y)return null;let L=Number.MAX_VALUE,N=L,J,R,S;for(let T=0;T<y.length;T++)J=y[T],R=p[J],S=G[J],m=(l-S.x)*R.x+(e-S.y)*R.y+(t-S.z)*R.z,(!s||s&&d&&m>=0||s&&!d&&m<=0)&&(m=R.x*S.x+R.y*S.y+R.z*S.z,o=-(R.x*l+R.y*e+R.z*t-m)/(R.x*R.x+R.y*R.y+R.z*R.z),b=l+R.x*o,u=e+R.y*o,V=t+R.z*o,c=b-l,n=u-e,h=V-t,N=c*c+n*n+h*h,N<L&&(L=N,i=J,a&&(a.x=b,a.y=u,a.z=V)));return i}getFacetDataParameters(){return this._internalAbstractMeshDataInfo._facetData.facetParameters}disableFacetData(){const l=this._internalAbstractMeshDataInfo._facetData;return l.facetDataEnabled&&(l.facetDataEnabled=!1,l.facetPositions=new Array,l.facetNormals=new Array,l.facetPartitioning=new Array,l.facetParameters=null,l.depthSortedIndices=new Uint32Array(0)),this}updateIndices(l,e,t=!1){return this}createNormals(l){const e=this.getVerticesData(X.PositionKind),t=this.getIndices();let a;return this.isVerticesDataPresent(X.NormalKind)?a=this.getVerticesData(X.NormalKind):a=[],$.ComputeNormals(e,t,a,{useRightHandedSystem:this.getScene().useRightHandedSystem}),this.setVerticesData(X.NormalKind,a,l),this}alignWithNormal(l,e){e||(e=Vt.Y);const t=f.Vector3[0],a=f.Vector3[1];return r.CrossToRef(e,l,a),r.CrossToRef(l,a,t),this.rotationQuaternion?_.RotationQuaternionFromAxisToRef(t,l,a,this.rotationQuaternion):r.RotationFromAxisToRef(t,l,a,this.rotation),this}_checkOcclusionQuery(){return!1}disableEdgesRendering(){throw O("EdgesRenderer")}enableEdgesRendering(l,e,t){throw O("EdgesRenderer")}getConnectedParticleSystems(){return this._scene.particleSystems.filter(l=>l.emitter===this)}}me.OCCLUSION_TYPE_NONE=0;me.OCCLUSION_TYPE_OPTIMISTIC=1;me.OCCLUSION_TYPE_STRICT=2;me.OCCLUSION_ALGORITHM_TYPE_ACCURATE=0;me.OCCLUSION_ALGORITHM_TYPE_CONSERVATIVE=1;me.CULLINGSTRATEGY_STANDARD=0;me.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1;me.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2;me.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3;ce("BABYLON.AbstractMesh",me);function xa(Z){Z.indexOf("vClipPlane")===-1&&Z.push("vClipPlane"),Z.indexOf("vClipPlane2")===-1&&Z.push("vClipPlane2"),Z.indexOf("vClipPlane3")===-1&&Z.push("vClipPlane3"),Z.indexOf("vClipPlane4")===-1&&Z.push("vClipPlane4"),Z.indexOf("vClipPlane5")===-1&&Z.push("vClipPlane5"),Z.indexOf("vClipPlane6")===-1&&Z.push("vClipPlane6")}function Fs(Z,l,e){var t,a,s,d,i,c;let n=!1,h=(t=Z.clipPlane)!==null&&t!==void 0?t:l.clipPlane;return n=Nt(h,e,"CLIPPLANE")||n,h=(a=Z.clipPlane2)!==null&&a!==void 0?a:l.clipPlane2,n=Nt(h,e,"CLIPPLANE2")||n,h=(s=Z.clipPlane3)!==null&&s!==void 0?s:l.clipPlane3,n=Nt(h,e,"CLIPPLANE3")||n,h=(d=Z.clipPlane4)!==null&&d!==void 0?d:l.clipPlane4,n=Nt(h,e,"CLIPPLANE4")||n,h=(i=Z.clipPlane5)!==null&&i!==void 0?i:l.clipPlane5,n=Nt(h,e,"CLIPPLANE5")||n,h=(c=Z.clipPlane6)!==null&&c!==void 0?c:l.clipPlane6,n=Nt(h,e,"CLIPPLANE6")||n,n}function Ua(Z,l,e){var t,a,s,d,i,c;let n=(t=l.clipPlane)!==null&&t!==void 0?t:e.clipPlane;Yt(Z,"vClipPlane",n),n=(a=l.clipPlane2)!==null&&a!==void 0?a:e.clipPlane2,Yt(Z,"vClipPlane2",n),n=(s=l.clipPlane3)!==null&&s!==void 0?s:e.clipPlane3,Yt(Z,"vClipPlane3",n),n=(d=l.clipPlane4)!==null&&d!==void 0?d:e.clipPlane4,Yt(Z,"vClipPlane4",n),n=(i=l.clipPlane5)!==null&&i!==void 0?i:e.clipPlane5,Yt(Z,"vClipPlane5",n),n=(c=l.clipPlane6)!==null&&c!==void 0?c:e.clipPlane6,Yt(Z,"vClipPlane6",n)}function Yt(Z,l,e){e&&Z.setFloat4(l,e.normal.x,e.normal.y,e.normal.z,e.d)}function Nt(Z,l,e){let t=!0;if(Z)if(Array.isArray(l)){const a="#define "+e;t=l.indexOf(a)!==-1,t||l.push(a)}else t=l[e],l[e]=!0;return!t}class tl{static BindSceneUniformBuffer(l,e){e.bindToEffect(l,"Scene")}static PrepareDefinesForMergedUV(l,e,t){e._needUVs=!0,e[t]=!0,l.optimizeUVAllocation&&l.getTextureMatrix().isIdentityAs3x2()?(e[t+"DIRECTUV"]=l.coordinatesIndex+1,e["MAINUV"+(l.coordinatesIndex+1)]=!0):e[t+"DIRECTUV"]=0}static BindTextureMatrix(l,e,t){const a=l.getTextureMatrix();e.updateMatrix(t+"Matrix",a)}static GetFogState(l,e){return e.fogEnabled&&l.applyFog&&e.fogMode!==sl.FOGMODE_NONE}static PrepareDefinesForMisc(l,e,t,a,s,d,i){i._areMiscDirty&&(i.LOGARITHMICDEPTH=t,i.POINTSIZE=a,i.FOG=s&&this.GetFogState(l,e),i.NONUNIFORMSCALING=l.nonUniformScaling,i.ALPHATEST=d)}static PrepareDefinesForCamera(l,e){let t=!1;if(l.activeCamera){const a=e.CAMERA_ORTHOGRAPHIC?1:0,s=e.CAMERA_PERSPECTIVE?1:0,d=l.activeCamera.mode===j.ORTHOGRAPHIC_CAMERA?1:0,i=l.activeCamera.mode===j.PERSPECTIVE_CAMERA?1:0;(a^d||s^i)&&(e.CAMERA_ORTHOGRAPHIC=d===1,e.CAMERA_PERSPECTIVE=i===1,t=!0)}return t}static PrepareDefinesForFrameBoundValues(l,e,t,a,s,d=null,i=!1){let c=tl.PrepareDefinesForCamera(l,a);d!==!1&&(c=Fs(t,l,a)),a.DEPTHPREPASS!==!e.getColorWrite()&&(a.DEPTHPREPASS=!a.DEPTHPREPASS,c=!0),a.INSTANCES!==s&&(a.INSTANCES=s,c=!0),a.THIN_INSTANCES!==i&&(a.THIN_INSTANCES=i,c=!0),c&&a.markAsUnprocessed()}static PrepareDefinesForBones(l,e){if(l.useBones&&l.computeBonesUsingShaders&&l.skeleton){e.NUM_BONE_INFLUENCERS=l.numBoneInfluencers;const t=e.BONETEXTURE!==void 0;if(l.skeleton.isUsingTextureForMatrices&&t)e.BONETEXTURE=!0;else{e.BonesPerMesh=l.skeleton.bones.length+1,e.BONETEXTURE=t?!1:void 0;const a=l.getScene().prePassRenderer;if(a&&a.enabled){const s=a.excludedSkinnedMesh.indexOf(l)===-1;e.BONES_VELOCITY_ENABLED=s}}}else e.NUM_BONE_INFLUENCERS=0,e.BonesPerMesh=0,e.BONETEXTURE!==void 0&&(e.BONETEXTURE=!1)}static PrepareDefinesForMorphTargets(l,e){const t=l.morphTargetManager;t?(e.MORPHTARGETS_UV=t.supportsUVs&&e.UV1,e.MORPHTARGETS_TANGENT=t.supportsTangents&&e.TANGENT,e.MORPHTARGETS_NORMAL=t.supportsNormals&&e.NORMAL,e.MORPHTARGETS=t.numInfluencers>0,e.NUM_MORPH_INFLUENCERS=t.numInfluencers,e.MORPHTARGETS_TEXTURE=t.isUsingTextureForTargets):(e.MORPHTARGETS_UV=!1,e.MORPHTARGETS_TANGENT=!1,e.MORPHTARGETS_NORMAL=!1,e.MORPHTARGETS=!1,e.NUM_MORPH_INFLUENCERS=0)}static PrepareDefinesForBakedVertexAnimation(l,e){const t=l.bakedVertexAnimationManager;e.BAKED_VERTEX_ANIMATION_TEXTURE=!!(t&&t.isEnabled)}static PrepareDefinesForAttributes(l,e,t,a,s=!1,d=!0,i=!0){if(!e._areAttributesDirty&&e._needNormals===e._normals&&e._needUVs===e._uvs)return!1;e._normals=e._needNormals,e._uvs=e._needUVs,e.NORMAL=e._needNormals&&l.isVerticesDataPresent(X.NormalKind),e._needNormals&&l.isVerticesDataPresent(X.TangentKind)&&(e.TANGENT=!0);for(let c=1;c<=6;++c)e["UV"+c]=e._needUVs?l.isVerticesDataPresent(`uv${c===1?"":c}`):!1;if(t){const c=l.useVertexColors&&l.isVerticesDataPresent(X.ColorKind);e.VERTEXCOLOR=c,e.VERTEXALPHA=l.hasVertexAlpha&&c&&d}return l.isVerticesDataPresent(X.ColorInstanceKind)&&(l.hasInstances||l.hasThinInstances)&&(e.INSTANCESCOLOR=!0),a&&this.PrepareDefinesForBones(l,e),s&&this.PrepareDefinesForMorphTargets(l,e),i&&this.PrepareDefinesForBakedVertexAnimation(l,e),!0}static PrepareDefinesForMultiview(l,e){if(l.activeCamera){const t=e.MULTIVIEW;e.MULTIVIEW=l.activeCamera.outputRenderTarget!==null&&l.activeCamera.outputRenderTarget.getViewCount()>1,e.MULTIVIEW!=t&&e.markAsUnprocessed()}}static PrepareDefinesForOIT(l,e,t){const a=e.ORDER_INDEPENDENT_TRANSPARENCY,s=e.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;e.ORDER_INDEPENDENT_TRANSPARENCY=l.useOrderIndependentTransparency&&t,e.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!l.getEngine().getCaps().textureFloatLinearFiltering,(a!==e.ORDER_INDEPENDENT_TRANSPARENCY||s!==e.ORDER_INDEPENDENT_TRANSPARENCY_16BITS)&&e.markAsUnprocessed()}static PrepareDefinesForPrePass(l,e,t){const a=e.PREPASS;if(!e._arePrePassDirty)return;const s=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"}];if(l.prePassRenderer&&l.prePassRenderer.enabled&&t){e.PREPASS=!0,e.SCENE_MRT_COUNT=l.prePassRenderer.mrtCount;for(let d=0;d<s.length;d++){const i=l.prePassRenderer.getIndex(s[d].type);i!==-1?(e[s[d].define]=!0,e[s[d].index]=i):e[s[d].define]=!1}}else{e.PREPASS=!1;for(let d=0;d<s.length;d++)e[s[d].define]=!1}e.PREPASS!=a&&(e.markAsUnprocessed(),e.markAsImageProcessingDirty())}static PrepareDefinesForLight(l,e,t,a,s,d,i){var c;switch(i.needNormals=!0,s["LIGHT"+a]===void 0&&(i.needRebuild=!0),s["LIGHT"+a]=!0,s["SPOTLIGHT"+a]=!1,s["HEMILIGHT"+a]=!1,s["POINTLIGHT"+a]=!1,s["DIRLIGHT"+a]=!1,t.prepareLightSpecificDefines(s,a),s["LIGHT_FALLOFF_PHYSICAL"+a]=!1,s["LIGHT_FALLOFF_GLTF"+a]=!1,s["LIGHT_FALLOFF_STANDARD"+a]=!1,t.falloffType){case Vl.FALLOFF_GLTF:s["LIGHT_FALLOFF_GLTF"+a]=!0;break;case Vl.FALLOFF_PHYSICAL:s["LIGHT_FALLOFF_PHYSICAL"+a]=!0;break;case Vl.FALLOFF_STANDARD:s["LIGHT_FALLOFF_STANDARD"+a]=!0;break}if(d&&!t.specular.equalsFloats(0,0,0)&&(i.specularEnabled=!0),s["SHADOW"+a]=!1,s["SHADOWCSM"+a]=!1,s["SHADOWCSMDEBUG"+a]=!1,s["SHADOWCSMNUM_CASCADES"+a]=!1,s["SHADOWCSMUSESHADOWMAXZ"+a]=!1,s["SHADOWCSMNOBLEND"+a]=!1,s["SHADOWCSM_RIGHTHANDED"+a]=!1,s["SHADOWPCF"+a]=!1,s["SHADOWPCSS"+a]=!1,s["SHADOWPOISSON"+a]=!1,s["SHADOWESM"+a]=!1,s["SHADOWCLOSEESM"+a]=!1,s["SHADOWCUBE"+a]=!1,s["SHADOWLOWQUALITY"+a]=!1,s["SHADOWMEDIUMQUALITY"+a]=!1,e&&e.receiveShadows&&l.shadowsEnabled&&t.shadowEnabled){const n=(c=t.getShadowGenerator(l.activeCamera))!==null&&c!==void 0?c:t.getShadowGenerator();if(n){const h=n.getShadowMap();h&&h.renderList&&h.renderList.length>0&&(i.shadowEnabled=!0,n.prepareDefines(s,a))}}t.lightmapMode!=Vl.LIGHTMAP_DEFAULT?(i.lightmapMode=!0,s["LIGHTMAPEXCLUDED"+a]=!0,s["LIGHTMAPNOSPECULAR"+a]=t.lightmapMode==Vl.LIGHTMAP_SHADOWSONLY):(s["LIGHTMAPEXCLUDED"+a]=!1,s["LIGHTMAPNOSPECULAR"+a]=!1)}static PrepareDefinesForLights(l,e,t,a,s=4,d=!1){if(!t._areLightsDirty)return t._needNormals;let i=0;const c={needNormals:t._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(l.lightsEnabled&&!d){for(const h of e.lightSources)if(this.PrepareDefinesForLight(l,e,h,i,t,a,c),i++,i===s)break}t.SPECULARTERM=c.specularEnabled,t.SHADOWS=c.shadowEnabled;for(let h=i;h<s;h++)t["LIGHT"+h]!==void 0&&(t["LIGHT"+h]=!1,t["HEMILIGHT"+h]=!1,t["POINTLIGHT"+h]=!1,t["DIRLIGHT"+h]=!1,t["SPOTLIGHT"+h]=!1,t["SHADOW"+h]=!1,t["SHADOWCSM"+h]=!1,t["SHADOWCSMDEBUG"+h]=!1,t["SHADOWCSMNUM_CASCADES"+h]=!1,t["SHADOWCSMUSESHADOWMAXZ"+h]=!1,t["SHADOWCSMNOBLEND"+h]=!1,t["SHADOWCSM_RIGHTHANDED"+h]=!1,t["SHADOWPCF"+h]=!1,t["SHADOWPCSS"+h]=!1,t["SHADOWPOISSON"+h]=!1,t["SHADOWESM"+h]=!1,t["SHADOWCLOSEESM"+h]=!1,t["SHADOWCUBE"+h]=!1,t["SHADOWLOWQUALITY"+h]=!1,t["SHADOWMEDIUMQUALITY"+h]=!1);const n=l.getEngine().getCaps();return t.SHADOWFLOAT===void 0&&(c.needRebuild=!0),t.SHADOWFLOAT=c.shadowEnabled&&(n.textureFloatRender&&n.textureFloatLinearFiltering||n.textureHalfFloatRender&&n.textureHalfFloatLinearFiltering),t.LIGHTMAPEXCLUDED=c.lightmapMode,c.needRebuild&&t.rebuild(),c.needNormals}static PrepareUniformsAndSamplersForLight(l,e,t,a,s=null,d=!1){s&&s.push("Light"+l),!d&&(e.push("vLightData"+l,"vLightDiffuse"+l,"vLightSpecular"+l,"vLightDirection"+l,"vLightFalloff"+l,"vLightGround"+l,"lightMatrix"+l,"shadowsInfo"+l,"depthValues"+l),t.push("shadowSampler"+l),t.push("depthSampler"+l),e.push("viewFrustumZ"+l,"cascadeBlendFactor"+l,"lightSizeUVCorrection"+l,"depthCorrection"+l,"penumbraDarkness"+l,"frustumLengths"+l),a&&(t.push("projectionLightSampler"+l),e.push("textureProjectionMatrix"+l)))}static PrepareUniformsAndSamplersList(l,e,t,a=4){let s,d=null;if(l.uniformsNames){const i=l;s=i.uniformsNames,d=i.uniformBuffersNames,e=i.samplers,t=i.defines,a=i.maxSimultaneousLights||0}else s=l,e||(e=[]);for(let i=0;i<a&&t["LIGHT"+i];i++)this.PrepareUniformsAndSamplersForLight(i,s,e,t["PROJECTEDLIGHTTEXTURE"+i],d);t.NUM_MORPH_INFLUENCERS&&s.push("morphTargetInfluences"),t.BAKED_VERTEX_ANIMATION_TEXTURE&&(s.push("bakedVertexAnimationSettings"),s.push("bakedVertexAnimationTextureSizeInverted"),s.push("bakedVertexAnimationTime"),e.push("bakedVertexAnimationTexture"))}static HandleFallbacksForShadows(l,e,t=4,a=0){let s=0;for(let d=0;d<t&&l["LIGHT"+d];d++)d>0&&(s=a+d,e.addFallback(s,"LIGHT"+d)),l.SHADOWS||(l["SHADOW"+d]&&e.addFallback(a,"SHADOW"+d),l["SHADOWPCF"+d]&&e.addFallback(a,"SHADOWPCF"+d),l["SHADOWPCSS"+d]&&e.addFallback(a,"SHADOWPCSS"+d),l["SHADOWPOISSON"+d]&&e.addFallback(a,"SHADOWPOISSON"+d),l["SHADOWESM"+d]&&e.addFallback(a,"SHADOWESM"+d),l["SHADOWCLOSEESM"+d]&&e.addFallback(a,"SHADOWCLOSEESM"+d));return s++}static PrepareAttributesForMorphTargetsInfluencers(l,e,t){this._TmpMorphInfluencers.NUM_MORPH_INFLUENCERS=t,this.PrepareAttributesForMorphTargets(l,e,this._TmpMorphInfluencers)}static PrepareAttributesForMorphTargets(l,e,t){const a=t.NUM_MORPH_INFLUENCERS;if(a>0&&bl.LastCreatedEngine){const s=bl.LastCreatedEngine.getCaps().maxVertexAttribs,d=e.morphTargetManager;if(d!=null&&d.isUsingTextureForTargets)return;const i=d&&d.supportsNormals&&t.NORMAL,c=d&&d.supportsTangents&&t.TANGENT,n=d&&d.supportsUVs&&t.UV1;for(let h=0;h<a;h++)l.push(X.PositionKind+h),i&&l.push(X.NormalKind+h),c&&l.push(X.TangentKind+h),n&&l.push(X.UVKind+"_"+h),l.length>s&&M.Error("Cannot add more vertex attributes for mesh "+e.name)}}static PrepareAttributesForBakedVertexAnimation(l,e,t){t.BAKED_VERTEX_ANIMATION_TEXTURE&&t.INSTANCES&&l.push("bakedVertexAnimationSettingsInstanced")}static PrepareAttributesForBones(l,e,t,a){t.NUM_BONE_INFLUENCERS>0&&(a.addCPUSkinningFallback(0,e),l.push(X.MatricesIndicesKind),l.push(X.MatricesWeightsKind),t.NUM_BONE_INFLUENCERS>4&&(l.push(X.MatricesIndicesExtraKind),l.push(X.MatricesWeightsExtraKind)))}static PrepareAttributesForInstances(l,e){(e.INSTANCES||e.THIN_INSTANCES)&&this.PushAttributesForInstances(l,!!e.PREPASS_VELOCITY),e.INSTANCESCOLOR&&l.push(X.ColorInstanceKind)}static PushAttributesForInstances(l,e=!1){l.push("world0"),l.push("world1"),l.push("world2"),l.push("world3"),e&&(l.push("previousWorld0"),l.push("previousWorld1"),l.push("previousWorld2"),l.push("previousWorld3"))}static BindLightProperties(l,e,t){l.transferToEffect(e,t+"")}static BindLight(l,e,t,a,s,d=!0){l._bindLight(e,t,a,s,d)}static BindLights(l,e,t,a,s=4){const d=Math.min(e.lightSources.length,s);for(let i=0;i<d;i++){const c=e.lightSources[i];this.BindLight(c,i,l,t,typeof a=="boolean"?a:a.SPECULARTERM,e.receiveShadows)}}static BindFogParameters(l,e,t,a=!1){l.fogEnabled&&e.applyFog&&l.fogMode!==sl.FOGMODE_NONE&&(t.setFloat4("vFogInfos",l.fogMode,l.fogStart,l.fogEnd,l.fogDensity),a?(l.fogColor.toLinearSpaceToRef(this._TempFogColor),t.setColor3("vFogColor",this._TempFogColor)):t.setColor3("vFogColor",l.fogColor))}static BindBonesParameters(l,e,t){if(!(!e||!l)&&(l.computeBonesUsingShaders&&e._bonesComputationForcedToCPU&&(l.computeBonesUsingShaders=!1),l.useBones&&l.computeBonesUsingShaders&&l.skeleton)){const a=l.skeleton;if(a.isUsingTextureForMatrices&&e.getUniformIndex("boneTextureWidth")>-1){const s=a.getTransformMatrixTexture(l);e.setTexture("boneSampler",s),e.setFloat("boneTextureWidth",4*(a.bones.length+1))}else{const s=a.getTransformMatrices(l);s&&(e.setMatrices("mBones",s),t&&l.getScene().prePassRenderer&&l.getScene().prePassRenderer.getIndex(2)&&(t.previousBones[l.uniqueId]||(t.previousBones[l.uniqueId]=s.slice()),e.setMatrices("mPreviousBones",t.previousBones[l.uniqueId]),tl._CopyBonesTransformationMatrices(s,t.previousBones[l.uniqueId])))}}}static _CopyBonesTransformationMatrices(l,e){return e.set(l),e}static BindMorphTargetParameters(l,e){const t=l.morphTargetManager;!l||!t||e.setFloatArray("morphTargetInfluences",t.influences)}static BindLogDepth(l,e,t){if(!l||l.LOGARITHMICDEPTH||l.indexOf&&l.indexOf("LOGARITHMICDEPTH")>=0){const a=t.activeCamera;a.mode===j.ORTHOGRAPHIC_CAMERA&&M.Error("Logarithmic depth is not compatible with orthographic cameras!",20),e.setFloat("logarithmicDepthConstant",2/(Math.log(a.maxZ+1)/Math.LN2))}}}tl._TmpMorphInfluencers={NUM_MORPH_INFLUENCERS:0};tl._TempFogColor=al.Black();class De{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=519,this.funcRef=1,this.funcMask=255,this.opStencilFail=7680,this.opDepthFail=7680,this.opStencilDepthPass=7681}get func(){return this._func}set func(l){this._func=l}get funcRef(){return this._funcRef}set funcRef(l){this._funcRef=l}get funcMask(){return this._funcMask}set funcMask(l){this._funcMask=l}get opStencilFail(){return this._opStencilFail}set opStencilFail(l){this._opStencilFail=l}get opDepthFail(){return this._opDepthFail}set opDepthFail(l){this._opDepthFail=l}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(l){this._opStencilDepthPass=l}get mask(){return this._mask}set mask(l){this._mask=l}get enabled(){return this._enabled}set enabled(l){this._enabled=l}getClassName(){return"MaterialStencilState"}copyTo(l){il.Clone(()=>l,this)}serialize(){return il.Serialize(this)}parse(l,e,t){il.Parse(()=>this,l,e,t)}}W([F()],De.prototype,"func",null);W([F()],De.prototype,"funcRef",null);W([F()],De.prototype,"funcMask",null);W([F()],De.prototype,"opStencilFail",null);W([F()],De.prototype,"opDepthFail",null);W([F()],De.prototype,"opStencilDepthPass",null);W([F()],De.prototype,"mask",null);W([F()],De.prototype,"enabled",null);var Ol;(function(Z){Z[Z.Created=1]="Created",Z[Z.Disposed=2]="Disposed",Z[Z.GetDefineNames=4]="GetDefineNames",Z[Z.PrepareUniformBuffer=8]="PrepareUniformBuffer",Z[Z.IsReadyForSubMesh=16]="IsReadyForSubMesh",Z[Z.PrepareDefines=32]="PrepareDefines",Z[Z.BindForSubMesh=64]="BindForSubMesh",Z[Z.PrepareEffect=128]="PrepareEffect",Z[Z.GetAnimatables=256]="GetAnimatables",Z[Z.GetActiveTextures=512]="GetActiveTextures",Z[Z.HasTexture=1024]="HasTexture",Z[Z.FillRenderTargetTextures=2048]="FillRenderTargetTextures",Z[Z.HasRenderTargetTextures=4096]="HasRenderTargetTextures",Z[Z.HardBindForSubMesh=8192]="HardBindForSubMesh"})(Ol||(Ol={}));class U{constructor(l,e,t){this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this._cullBackFaces=!0,this._blockDirtyMechanism=!1,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.onDisposeObservable=new z,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this.zOffsetUnits=0,this.stencil=new De,this._useUBO=!1,this._fillMode=U.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._parentContainer=null,this._uniformBufferLayoutBuilt=!1,this._eventInfo={},this._callbackPluginEventGeneric=()=>{},this._callbackPluginEventIsReadyForSubMesh=()=>{},this._callbackPluginEventPrepareDefines=()=>{},this._callbackPluginEventPrepareDefinesBeforeAttributes=()=>{},this._callbackPluginEventHardBindForSubMesh=()=>{},this._callbackPluginEventBindForSubMesh=()=>{},this._callbackPluginEventHasRenderTargetTextures=()=>{},this._callbackPluginEventFillRenderTargetTextures=()=>{},this._forceAlphaTest=!1,this._transparencyMode=null,this.name=l;const a=e||bl.LastCreatedScene;a&&(this._scene=a,this._dirtyCallbacks={},this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[63]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=l||Q.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new Mt(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._scene.useRightHandedSystem?this.sideOrientation=U.ClockWiseSideOrientation:this.sideOrientation=U.CounterClockWiseSideOrientation,this._uniformBuffer=new I(this._scene.getEngine(),void 0,void 0,l),this._useUBO=this.getScene().getEngine().supportsUniformBuffers,t||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),U.OnEventObservable.notifyObservers(this,Ol.Created))}get canRenderToMRT(){return!1}set alpha(l){if(this._alpha===l)return;const e=this._alpha;this._alpha=l,(e===1||l===1)&&this.markAsDirty(U.MiscDirtyFlag)}get alpha(){return this._alpha}set backFaceCulling(l){this._backFaceCulling!==l&&(this._backFaceCulling=l,this.markAsDirty(U.TextureDirtyFlag))}get backFaceCulling(){return this._backFaceCulling}set cullBackFaces(l){this._cullBackFaces!==l&&(this._cullBackFaces=l,this.markAsDirty(U.TextureDirtyFlag))}get cullBackFaces(){return this._cullBackFaces}get blockDirtyMechanism(){return this._blockDirtyMechanism}set blockDirtyMechanism(l){this._blockDirtyMechanism!==l&&(this._blockDirtyMechanism=l,l||this.markDirty())}atomicMaterialsUpdate(l){this.blockDirtyMechanism=!0;try{l(this)}finally{this.blockDirtyMechanism=!1}}get hasRenderTargetTextures(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}set onDispose(l){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(l)}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new z),this._onBindObservable}set onBind(l){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(l)}get onUnBindObservable(){return this._onUnBindObservable||(this._onUnBindObservable=new z),this._onUnBindObservable}get onEffectCreatedObservable(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new z),this._onEffectCreatedObservable}set alphaMode(l){this._alphaMode!==l&&(this._alphaMode=l,this.markAsDirty(U.TextureDirtyFlag))}get alphaMode(){return this._alphaMode}set needDepthPrePass(l){this._needDepthPrePass!==l&&(this._needDepthPrePass=l,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}get needDepthPrePass(){return this._needDepthPrePass}get isPrePassCapable(){return!1}set fogEnabled(l){this._fogEnabled!==l&&(this._fogEnabled=l,this.markAsDirty(U.MiscDirtyFlag))}get fogEnabled(){return this._fogEnabled}get wireframe(){switch(this._fillMode){case U.WireFrameFillMode:case U.LineListDrawMode:case U.LineLoopDrawMode:case U.LineStripDrawMode:return!0}return this._scene.forceWireframe}set wireframe(l){this.fillMode=l?U.WireFrameFillMode:U.TriangleFillMode}get pointsCloud(){switch(this._fillMode){case U.PointFillMode:case U.PointListDrawMode:return!0}return this._scene.forcePointsCloud}set pointsCloud(l){this.fillMode=l?U.PointFillMode:U.TriangleFillMode}get fillMode(){return this._fillMode}set fillMode(l){this._fillMode!==l&&(this._fillMode=l,this.markAsDirty(U.MiscDirtyFlag))}_getDrawWrapper(){return this._drawWrapper}_setDrawWrapper(l){this._drawWrapper=l}toString(l){return"Name: "+this.name}getClassName(){return"Material"}get _isMaterial(){return!0}get isFrozen(){return this.checkReadyOnlyOnce}freeze(){this.markDirty(),this.checkReadyOnlyOnce=!0}unfreeze(){this.markDirty(),this.checkReadyOnlyOnce=!1}isReady(l,e){return!0}isReadyForSubMesh(l,e,t){const a=e.materialDefines;return a?(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=a,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh):!1}getEffect(){return this._drawWrapper.effect}getScene(){return this._scene}get transparencyMode(){return this._transparencyMode}set transparencyMode(l){this._transparencyMode!==l&&(this._transparencyMode=l,this._forceAlphaTest=l===U.MATERIAL_ALPHATESTANDBLEND,this._markAllSubMeshesAsTexturesAndMiscDirty())}get _disableAlphaBlending(){return this._transparencyMode===U.MATERIAL_OPAQUE||this._transparencyMode===U.MATERIAL_ALPHATEST}needAlphaBlending(){return this._disableAlphaBlending?!1:this.alpha<1}needAlphaBlendingForMesh(l){return l.visibility<1?!0:this._disableAlphaBlending?!1:l.hasVertexAlpha||this.needAlphaBlending()}needAlphaTesting(){return!!this._forceAlphaTest}_shouldTurnAlphaTestOn(l){return!this.needAlphaBlendingForMesh(l)&&this.needAlphaTesting()}getAlphaTestTexture(){return null}markDirty(l=!1){const e=this.getScene().meshes;for(const t of e)if(t.subMeshes)for(const a of t.subMeshes)a.getMaterial()===this&&a.effect&&(a.effect._wasPreviouslyReady=!1,a.effect._wasPreviouslyUsingInstances=null,a.effect._forceRebindOnNextCall=l);l&&this.markAsDirty(U.AllDirtyFlag)}_preBind(l,e=null){const t=this._scene.getEngine(),a=(e??this.sideOrientation)===U.ClockWiseSideOrientation;return t.enableEffect(l||this._getDrawWrapper()),t.setState(this.backFaceCulling,this.zOffset,!1,a,this._scene._mirroredCameraPosition?!this.cullBackFaces:this.cullBackFaces,this.stencil,this.zOffsetUnits),a}bind(l,e){}buildUniformLayout(){const l=this._uniformBuffer;this._eventInfo.ubo=l,this._callbackPluginEventGeneric(Ol.PrepareUniformBuffer,this._eventInfo),l.create(),this._uniformBufferLayoutBuilt=!0}bindForSubMesh(l,e,t){const a=t.effect;a&&(this._eventInfo.subMesh=t,this._callbackPluginEventBindForSubMesh(this._eventInfo),a._forceRebindOnNextCall=!1)}bindOnlyWorldMatrix(l){}bindView(l){this._useUBO?this._needToBindSceneUbo=!0:l.setMatrix("view",this.getScene().getViewMatrix())}bindViewProjection(l){this._useUBO?this._needToBindSceneUbo=!0:(l.setMatrix("viewProjection",this.getScene().getTransformMatrix()),l.setMatrix("projection",this.getScene().getProjectionMatrix()))}bindEyePosition(l,e){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(l,e)}_afterBind(l,e=null){if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&e&&(this._needToBindSceneUbo=!1,tl.BindSceneUniformBuffer(e,this.getScene().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),l?this._scene._cachedVisibility=l.visibility:this._scene._cachedVisibility=1,this._onBindObservable&&l&&this._onBindObservable.notifyObservers(l),this.disableDepthWrite){const t=this._scene.getEngine();this._cachedDepthWriteState=t.getDepthWrite(),t.setDepthWrite(!1)}if(this.disableColorWrite){const t=this._scene.getEngine();this._cachedColorWriteState=t.getColorWrite(),t.setColorWrite(!1)}if(this.depthFunction!==0){const t=this._scene.getEngine();this._cachedDepthFunctionState=t.getDepthFunction()||0,t.setDepthFunction(this.depthFunction)}}unbind(){this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),this.depthFunction!==0&&this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState),this.disableDepthWrite&&this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState),this.disableColorWrite&&this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}getAnimatables(){return this._eventInfo.animatables=[],this._callbackPluginEventGeneric(Ol.GetAnimatables,this._eventInfo),this._eventInfo.animatables}getActiveTextures(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(Ol.GetActiveTextures,this._eventInfo),this._eventInfo.activeTextures}hasTexture(l){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=l,this._callbackPluginEventGeneric(Ol.HasTexture,this._eventInfo),this._eventInfo.hasTexture}clone(l){return null}getBindedMeshes(){if(this.meshMap){const l=new Array;for(const e in this.meshMap){const t=this.meshMap[e];t&&l.push(t)}return l}else return this._scene.meshes.filter(l=>l.material===this)}forceCompilation(l,e,t,a){const s={clipPlane:!1,useInstances:!1,...t},d=this.getScene(),i=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;const c=()=>{if(!this._scene||!this._scene.getEngine())return;const n=d.clipPlane;if(s.clipPlane&&(d.clipPlane=new Se(0,0,0,1)),this._storeEffectOnSubMeshes){let h=!0,m=null;if(l.subMeshes){const o=new pe(0,0,0,0,0,l,void 0,!1,!1);o.materialDefines&&(o.materialDefines._renderId=-1),this.isReadyForSubMesh(l,o,s.useInstances)||(o.effect&&o.effect.getCompilationError()&&o.effect.allFallbacksProcessed()?m=o.effect.getCompilationError():(h=!1,setTimeout(c,16)))}h&&(this.allowShaderHotSwapping=i,m&&a&&a(m),e&&e(this))}else this.isReady()?(this.allowShaderHotSwapping=i,e&&e(this)):setTimeout(c,16);s.clipPlane&&(d.clipPlane=n)};c()}forceCompilationAsync(l,e){return new Promise((t,a)=>{this.forceCompilation(l,()=>{t()},e,s=>{a(s)})})}markAsDirty(l){this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism||(U._DirtyCallbackArray.length=0,l&U.TextureDirtyFlag&&U._DirtyCallbackArray.push(U._TextureDirtyCallBack),l&U.LightDirtyFlag&&U._DirtyCallbackArray.push(U._LightsDirtyCallBack),l&U.FresnelDirtyFlag&&U._DirtyCallbackArray.push(U._FresnelDirtyCallBack),l&U.AttributesDirtyFlag&&U._DirtyCallbackArray.push(U._AttributeDirtyCallBack),l&U.MiscDirtyFlag&&U._DirtyCallbackArray.push(U._MiscDirtyCallBack),l&U.PrePassDirtyFlag&&U._DirtyCallbackArray.push(U._PrePassDirtyCallBack),U._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(U._RunDirtyCallBacks),this.getScene().resetCachedMaterial())}resetDrawCache(){const l=this.getScene().meshes;for(const e of l)if(e.subMeshes)for(const t of e.subMeshes)t.getMaterial()===this&&t.resetDrawCache()}_markAllSubMeshesAsDirty(l){if(this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const e=this.getScene().meshes;for(const t of e)if(t.subMeshes){for(const a of t.subMeshes)if(a.getMaterial(!1)===this)for(const s of a._drawWrappers)!s||!s.defines||!s.defines.markAllAsDirty||this._materialContext===s.materialContext&&l(s.defines)}}_markScenePrePassDirty(){if(this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const l=this.getScene().enablePrePassRenderer();l&&l.markAsDirty()}_markAllSubMeshesAsAllDirty(){this._markAllSubMeshesAsDirty(U._AllDirtyCallBack)}_markAllSubMeshesAsImageProcessingDirty(){this._markAllSubMeshesAsDirty(U._ImageProcessingDirtyCallBack)}_markAllSubMeshesAsTexturesDirty(){this._markAllSubMeshesAsDirty(U._TextureDirtyCallBack)}_markAllSubMeshesAsFresnelDirty(){this._markAllSubMeshesAsDirty(U._FresnelDirtyCallBack)}_markAllSubMeshesAsFresnelAndMiscDirty(){this._markAllSubMeshesAsDirty(U._FresnelAndMiscDirtyCallBack)}_markAllSubMeshesAsLightsDirty(){this._markAllSubMeshesAsDirty(U._LightsDirtyCallBack)}_markAllSubMeshesAsAttributesDirty(){this._markAllSubMeshesAsDirty(U._AttributeDirtyCallBack)}_markAllSubMeshesAsMiscDirty(){this._markAllSubMeshesAsDirty(U._MiscDirtyCallBack)}_markAllSubMeshesAsPrePassDirty(){this._markAllSubMeshesAsDirty(U._MiscDirtyCallBack)}_markAllSubMeshesAsTexturesAndMiscDirty(){this._markAllSubMeshesAsDirty(U._TextureAndMiscDirtyCallBack)}setPrePassRenderer(l){return!1}dispose(l,e,t){const a=this.getScene();if(a.stopAnimation(this),a.freeProcessedMaterials(),a.removeMaterial(this),this._eventInfo.forceDisposeTextures=e,this._callbackPluginEventGeneric(Ol.Disposed,this._eventInfo),this._parentContainer){const s=this._parentContainer.materials.indexOf(this);s>-1&&this._parentContainer.materials.splice(s,1),this._parentContainer=null}if(t!==!0)if(this.meshMap)for(const s in this.meshMap){const d=this.meshMap[s];d&&(d.material=null,this.releaseVertexArrayObject(d,l))}else{const s=a.meshes;for(const d of s)d.material===this&&!d.sourceMesh&&(d.material=null,this.releaseVertexArrayObject(d,l))}this._uniformBuffer.dispose(),l&&this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null),this.metadata=null,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear(),this._eventInfo&&(this._eventInfo={})}releaseVertexArrayObject(l,e){if(l.geometry){const t=l.geometry;if(this._storeEffectOnSubMeshes)for(const a of l.subMeshes)t._releaseVertexArrayObject(a.effect),e&&a.effect&&a.effect.dispose();else t._releaseVertexArrayObject(this._drawWrapper.effect)}}serialize(){const l=il.Serialize(this);return l.stencil=this.stencil.serialize(),l.uniqueId=this.uniqueId,l}static Parse(l,e,t){if(!l.customType)l.customType="BABYLON.StandardMaterial";else if(l.customType==="BABYLON.PBRMaterial"&&l.overloadedAlbedo&&(l.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return M.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null;const a=Q.Instantiate(l.customType).Parse(l,e,t);return a._loadedUniqueId=l.uniqueId,a}}U.TriangleFillMode=0;U.WireFrameFillMode=1;U.PointFillMode=2;U.PointListDrawMode=3;U.LineListDrawMode=4;U.LineLoopDrawMode=5;U.LineStripDrawMode=6;U.TriangleStripDrawMode=7;U.TriangleFanDrawMode=8;U.ClockWiseSideOrientation=0;U.CounterClockWiseSideOrientation=1;U.TextureDirtyFlag=1;U.LightDirtyFlag=2;U.FresnelDirtyFlag=4;U.AttributesDirtyFlag=8;U.MiscDirtyFlag=16;U.PrePassDirtyFlag=32;U.AllDirtyFlag=63;U.MATERIAL_OPAQUE=0;U.MATERIAL_ALPHATEST=1;U.MATERIAL_ALPHABLEND=2;U.MATERIAL_ALPHATESTANDBLEND=3;U.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0;U.MATERIAL_NORMALBLENDMETHOD_RNM=1;U.OnEventObservable=new z;U._AllDirtyCallBack=Z=>Z.markAllAsDirty();U._ImageProcessingDirtyCallBack=Z=>Z.markAsImageProcessingDirty();U._TextureDirtyCallBack=Z=>Z.markAsTexturesDirty();U._FresnelDirtyCallBack=Z=>Z.markAsFresnelDirty();U._MiscDirtyCallBack=Z=>Z.markAsMiscDirty();U._PrePassDirtyCallBack=Z=>Z.markAsPrePassDirty();U._LightsDirtyCallBack=Z=>Z.markAsLightDirty();U._AttributeDirtyCallBack=Z=>Z.markAsAttributesDirty();U._FresnelAndMiscDirtyCallBack=Z=>{U._FresnelDirtyCallBack(Z),U._MiscDirtyCallBack(Z)};U._TextureAndMiscDirtyCallBack=Z=>{U._TextureDirtyCallBack(Z),U._MiscDirtyCallBack(Z)};U._DirtyCallbackArray=[];U._RunDirtyCallBacks=Z=>{for(const l of U._DirtyCallbackArray)l(Z)};W([F()],U.prototype,"id",void 0);W([F()],U.prototype,"uniqueId",void 0);W([F()],U.prototype,"name",void 0);W([F()],U.prototype,"metadata",void 0);W([F()],U.prototype,"checkReadyOnEveryCall",void 0);W([F()],U.prototype,"checkReadyOnlyOnce",void 0);W([F()],U.prototype,"state",void 0);W([F("alpha")],U.prototype,"_alpha",void 0);W([F("backFaceCulling")],U.prototype,"_backFaceCulling",void 0);W([F("cullBackFaces")],U.prototype,"_cullBackFaces",void 0);W([F()],U.prototype,"sideOrientation",void 0);W([F("alphaMode")],U.prototype,"_alphaMode",void 0);W([F()],U.prototype,"_needDepthPrePass",void 0);W([F()],U.prototype,"disableDepthWrite",void 0);W([F()],U.prototype,"disableColorWrite",void 0);W([F()],U.prototype,"forceDepthWrite",void 0);W([F()],U.prototype,"depthFunction",void 0);W([F()],U.prototype,"separateCullingPass",void 0);W([F("fogEnabled")],U.prototype,"_fogEnabled",void 0);W([F()],U.prototype,"pointSize",void 0);W([F()],U.prototype,"zOffset",void 0);W([F()],U.prototype,"zOffsetUnits",void 0);W([F()],U.prototype,"pointsCloud",null);W([F()],U.prototype,"fillMode",null);W([F()],U.prototype,"transparencyMode",null);class zt extends U{constructor(l,e){super(l,e,!0),this._waitingSubMaterialsUniqueIds=[],this.getScene().multiMaterials.push(this),this.subMaterials=new Array,this._storeEffectOnSubMeshes=!0}get subMaterials(){return this._subMaterials}set subMaterials(l){this._subMaterials=l,this._hookArray(l)}getChildren(){return this.subMaterials}_hookArray(l){const e=l.push;l.push=(...a)=>{const s=e.apply(l,a);return this._markAllSubMeshesAsTexturesDirty(),s};const t=l.splice;l.splice=(a,s)=>{const d=t.apply(l,[a,s]);return this._markAllSubMeshesAsTexturesDirty(),d}}getSubMaterial(l){return l<0||l>=this.subMaterials.length?this.getScene().defaultMaterial:this.subMaterials[l]}getActiveTextures(){return super.getActiveTextures().concat(...this.subMaterials.map(l=>l?l.getActiveTextures():[]))}hasTexture(l){var e;if(super.hasTexture(l))return!0;for(let t=0;t<this.subMaterials.length;t++)if(!((e=this.subMaterials[t])===null||e===void 0)&&e.hasTexture(l))return!0;return!1}getClassName(){return"MultiMaterial"}isReadyForSubMesh(l,e,t){for(let a=0;a<this.subMaterials.length;a++){const s=this.subMaterials[a];if(s){if(s._storeEffectOnSubMeshes){if(!s.isReadyForSubMesh(l,e,t))return!1;continue}if(!s.isReady(l))return!1}}return!0}clone(l,e){const t=new zt(l,this.getScene());for(let a=0;a<this.subMaterials.length;a++){let s=null;const d=this.subMaterials[a];e&&d?s=d.clone(l+"-"+d.name):s=this.subMaterials[a],t.subMaterials.push(s)}return t}serialize(){const l={};l.name=this.name,l.id=this.id,l.uniqueId=this.uniqueId,ul&&(l.tags=ul.GetTags(this)),l.materialsUniqueIds=[],l.materials=[];for(let e=0;e<this.subMaterials.length;e++){const t=this.subMaterials[e];t?(l.materialsUniqueIds.push(t.uniqueId),l.materials.push(t.id)):(l.materialsUniqueIds.push(null),l.materials.push(null))}return l}dispose(l,e,t){const a=this.getScene();if(!a)return;if(t)for(let d=0;d<this.subMaterials.length;d++){const i=this.subMaterials[d];i&&i.dispose(l,e)}const s=a.multiMaterials.indexOf(this);s>=0&&a.multiMaterials.splice(s,1),super.dispose(l,e)}static ParseMultiMaterial(l,e){const t=new zt(l.name,e);return t.id=l.id,t._loadedUniqueId=l.uniqueId,ul&&ul.AddTagsTo(t,l.tags),l.materialsUniqueIds?t._waitingSubMaterialsUniqueIds=l.materialsUniqueIds:l.materials.forEach(a=>t.subMaterials.push(e.getLastMaterialById(a))),t}}ce("BABYLON.MultiMaterial",zt);class Oi{constructor(l,e){this.distanceOrScreenCoverage=l,this.mesh=e}}class qi{constructor(){this.visibleInstances={},this.batchCache=new As,this.batchCacheReplacementModeInFrozenMode=new As,this.instancesBufferSize=32*16*4}}class As{constructor(){this.mustReturn=!1,this.visibleInstances=new Array,this.renderSelf=new Array,this.hardwareInstancedRendering=new Array}}class $i{constructor(){this.instancesCount=0,this.matrixBuffer=null,this.previousMatrixBuffer=null,this.matrixBufferSize=32*16,this.matrixData=null,this.boundingVectors=[],this.worldMatrices=null}}class lc{constructor(){this._areNormalsFrozen=!1,this._source=null,this.meshMap=null,this._preActivateId=-1,this._LODLevels=new Array,this._useLODScreenCoverage=!1,this._effectiveMaterial=null,this._forcedInstanceCount=0}}class E extends me{constructor(l,e=null,t=null,a=null,s,d=!0){if(super(l,e),this._internalMeshDataInfo=new lc,this.delayLoadState=0,this.instances=new Array,this._creationDataStorage=null,this._geometry=null,this._instanceDataStorage=new qi,this._thinInstanceDataStorage=new $i,this._shouldGenerateFlatShading=!1,this._originalBuilderSideOrientation=E.DEFAULTSIDE,this.overrideMaterialSideOrientation=null,this.ignoreCameraMaxZ=!1,e=this.getScene(),this._onBeforeDraw=(i,c,n)=>{i&&n&&(this._uniformBuffer?this.transferToEffect(c):n.bindOnlyWorldMatrix(c))},a){if(a._geometry&&a._geometry.applyToMesh(this),rs.DeepCopy(a,this,["name","material","skeleton","instances","parent","uniqueId","source","metadata","morphTargetManager","hasInstances","worldMatrixInstancedBuffer","previousWorldMatrixInstancedBuffer","hasLODLevels","geometry","isBlocked","areNormalsFrozen","facetNb","isFacetDataEnabled","lightSources","useBones","isAnInstance","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","isWorldMatrixFrozen","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","cloneMeshMap","hasBoundingInfo"],["_poseMatrix"]),this._internalMeshDataInfo._source=a,e.useClonedMeshMap&&(a._internalMeshDataInfo.meshMap||(a._internalMeshDataInfo.meshMap={}),a._internalMeshDataInfo.meshMap[this.uniqueId]=this),this._originalBuilderSideOrientation=a._originalBuilderSideOrientation,this._creationDataStorage=a._creationDataStorage,a._ranges){const i=a._ranges;for(const c in i)Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&this.createAnimationRange(c,i[c].from,i[c].to)}if(a.metadata&&a.metadata.clone?this.metadata=a.metadata.clone():this.metadata=a.metadata,ul&&ul.HasTags(a)&&ul.AddTagsTo(this,ul.GetTags(a,!0)),this.setEnabled(a.isEnabled(!1)),this.parent=a.parent,this.setPivotMatrix(a.getPivotMatrix()),this.id=l+"."+a.id,this.material=a.material,!s){const i=a.getDescendants(!0);for(let c=0;c<i.length;c++){const n=i[c];n.clone&&n.clone(l+"."+n.name,this)}}if(a.morphTargetManager&&(this.morphTargetManager=a.morphTargetManager),e.getPhysicsEngine){const i=e.getPhysicsEngine();if(d&&i&&i.getPluginVersion()===1){const c=i.getImpostorForPhysicsObject(a);c&&(this.physicsImpostor=c.clone(this))}}for(let i=0;i<e.particleSystems.length;i++){const c=e.particleSystems[i];c.emitter===a&&c.clone(c.name,this)}this.skeleton=a.skeleton,this.refreshBoundingInfo(!0,!0),this.computeWorldMatrix(!0)}t!==null&&(this.parent=t),this._instanceDataStorage.hardwareInstancedRendering=this.getEngine().getCaps().instancedArrays,this._internalMeshDataInfo._onMeshReadyObserverAdded=i=>{i.unregisterOnNextCall=!0,this.isReady(!0)?this.onMeshReadyObservable.notifyObservers(this):this._internalMeshDataInfo._checkReadinessObserver||(this._internalMeshDataInfo._checkReadinessObserver=this._scene.onBeforeRenderObservable.add(()=>{this.isReady(!0)&&(this._scene.onBeforeRenderObservable.remove(this._internalMeshDataInfo._checkReadinessObserver),this._internalMeshDataInfo._checkReadinessObserver=null,this.onMeshReadyObservable.notifyObservers(this))}))},this.onMeshReadyObservable=new z(this._internalMeshDataInfo._onMeshReadyObserverAdded),a&&a.onClonedObservable.notifyObservers(this)}static _GetDefaultSideOrientation(l){return l||E.FRONTSIDE}get useLODScreenCoverage(){return this._internalMeshDataInfo._useLODScreenCoverage}set useLODScreenCoverage(l){this._internalMeshDataInfo._useLODScreenCoverage=l,this._sortLODLevels()}get computeBonesUsingShaders(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders}set computeBonesUsingShaders(l){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==l&&(l&&this._internalMeshDataInfo._sourcePositions&&(this.setVerticesData(X.PositionKind,this._internalMeshDataInfo._sourcePositions,!0),this._internalMeshDataInfo._sourceNormals&&this.setVerticesData(X.NormalKind,this._internalMeshDataInfo._sourceNormals,!0),this._internalMeshDataInfo._sourcePositions=null,this._internalMeshDataInfo._sourceNormals=null),this._internalAbstractMeshDataInfo._computeBonesUsingShaders=l,this._markSubMeshesAsAttributesDirty())}get onBeforeRenderObservable(){return this._internalMeshDataInfo._onBeforeRenderObservable||(this._internalMeshDataInfo._onBeforeRenderObservable=new z),this._internalMeshDataInfo._onBeforeRenderObservable}get onBeforeBindObservable(){return this._internalMeshDataInfo._onBeforeBindObservable||(this._internalMeshDataInfo._onBeforeBindObservable=new z),this._internalMeshDataInfo._onBeforeBindObservable}get onAfterRenderObservable(){return this._internalMeshDataInfo._onAfterRenderObservable||(this._internalMeshDataInfo._onAfterRenderObservable=new z),this._internalMeshDataInfo._onAfterRenderObservable}get onBetweenPassObservable(){return this._internalMeshDataInfo._onBetweenPassObservable||(this._internalMeshDataInfo._onBetweenPassObservable=new z),this._internalMeshDataInfo._onBetweenPassObservable}get onBeforeDrawObservable(){return this._internalMeshDataInfo._onBeforeDrawObservable||(this._internalMeshDataInfo._onBeforeDrawObservable=new z),this._internalMeshDataInfo._onBeforeDrawObservable}set onBeforeDraw(l){this._onBeforeDrawObserver&&this.onBeforeDrawObservable.remove(this._onBeforeDrawObserver),this._onBeforeDrawObserver=this.onBeforeDrawObservable.add(l)}get hasInstances(){return this.instances.length>0}get hasThinInstances(){var l;return((l=this._thinInstanceDataStorage.instancesCount)!==null&&l!==void 0?l:0)>0}get forcedInstanceCount(){return this._internalMeshDataInfo._forcedInstanceCount}set forcedInstanceCount(l){this._internalMeshDataInfo._forcedInstanceCount=l}get source(){return this._internalMeshDataInfo._source}get cloneMeshMap(){return this._internalMeshDataInfo.meshMap}get isUnIndexed(){return this._unIndexed}set isUnIndexed(l){this._unIndexed!==l&&(this._unIndexed=l,this._markSubMeshesAsAttributesDirty())}get worldMatrixInstancedBuffer(){return this._instanceDataStorage.instancesData}get previousWorldMatrixInstancedBuffer(){return this._instanceDataStorage.instancesPreviousData}get manualUpdateOfWorldMatrixInstancedBuffer(){return this._instanceDataStorage.manualUpdate}set manualUpdateOfWorldMatrixInstancedBuffer(l){this._instanceDataStorage.manualUpdate=l}get manualUpdateOfPreviousWorldMatrixInstancedBuffer(){return this._instanceDataStorage.previousManualUpdate}set manualUpdateOfPreviousWorldMatrixInstancedBuffer(l){this._instanceDataStorage.previousManualUpdate=l}get forceWorldMatrixInstancedBufferUpdate(){return this._instanceDataStorage.forceMatrixUpdates}set forceWorldMatrixInstancedBufferUpdate(l){this._instanceDataStorage.forceMatrixUpdates=l}instantiateHierarchy(l=null,e,t){const a=this.getTotalVertices()===0||e&&e.doNotInstantiate&&(e.doNotInstantiate===!0||e.doNotInstantiate(this))?this.clone("Clone of "+(this.name||this.id),l||this.parent,!0):this.createInstance("instance of "+(this.name||this.id));a.parent=l||this.parent,a.position=this.position.clone(),a.scaling=this.scaling.clone(),this.rotationQuaternion?a.rotationQuaternion=this.rotationQuaternion.clone():a.rotation=this.rotation.clone(),t&&t(this,a);for(const s of this.getChildTransformNodes(!0))s.getClassName()==="InstancedMesh"&&a.getClassName()==="Mesh"?s.instantiateHierarchy(a,{doNotInstantiate:e&&e.doNotInstantiate||!1,newSourcedMesh:a},t):s.instantiateHierarchy(a,e,t);return a}getClassName(){return"Mesh"}get _isMesh(){return!0}toString(l){let e=super.toString(l);if(e+=", n vertices: "+this.getTotalVertices(),e+=", parent: "+(this._waitingParentId?this._waitingParentId:this.parent?this.parent.name:"NONE"),this.animations)for(let t=0;t<this.animations.length;t++)e+=", animation[0]: "+this.animations[t].toString(l);if(l)if(this._geometry){const t=this.getIndices(),a=this.getVerticesData(X.PositionKind);a&&t&&(e+=", flat shading: "+(a.length/3===t.length?"YES":"NO"))}else e+=", flat shading: UNKNOWN";return e}_unBindEffect(){super._unBindEffect();for(const l of this.instances)l._unBindEffect()}get hasLODLevels(){return this._internalMeshDataInfo._LODLevels.length>0}getLODLevels(){return this._internalMeshDataInfo._LODLevels}_sortLODLevels(){const l=this._internalMeshDataInfo._useLODScreenCoverage?-1:1;this._internalMeshDataInfo._LODLevels.sort((e,t)=>e.distanceOrScreenCoverage<t.distanceOrScreenCoverage?l:e.distanceOrScreenCoverage>t.distanceOrScreenCoverage?-l:0)}addLODLevel(l,e){if(e&&e._masterMesh)return M.Warn("You cannot use a mesh as LOD level twice"),this;const t=new Oi(l,e);return this._internalMeshDataInfo._LODLevels.push(t),e&&(e._masterMesh=this),this._sortLODLevels(),this}getLODLevelAtDistance(l){const e=this._internalMeshDataInfo;for(let t=0;t<e._LODLevels.length;t++){const a=e._LODLevels[t];if(a.distanceOrScreenCoverage===l)return a.mesh}return null}removeLODLevel(l){const e=this._internalMeshDataInfo;for(let t=0;t<e._LODLevels.length;t++)e._LODLevels[t].mesh===l&&(e._LODLevels.splice(t,1),l&&(l._masterMesh=null));return this._sortLODLevels(),this}getLOD(l,e){const t=this._internalMeshDataInfo;if(!t._LODLevels||t._LODLevels.length===0)return this;const a=e||this.getBoundingInfo().boundingSphere,s=l.mode===j.ORTHOGRAPHIC_CAMERA?l.minZ:a.centerWorld.subtract(l.globalPosition).length();let d=s,i=1;if(t._useLODScreenCoverage){const c=l.screenArea;let n=a.radiusWorld*l.minZ/s;n=n*n*Math.PI,d=n/c,i=-1}if(i*t._LODLevels[t._LODLevels.length-1].distanceOrScreenCoverage>i*d)return this.onLODLevelSelection&&this.onLODLevelSelection(d,this,this),this;for(let c=0;c<t._LODLevels.length;c++){const n=t._LODLevels[c];if(i*n.distanceOrScreenCoverage<i*d){if(n.mesh){if(n.mesh.delayLoadState===4)return n.mesh._checkDelayState(),this;if(n.mesh.delayLoadState===2)return this;n.mesh._preActivate(),n.mesh._updateSubMeshesBoundingInfo(this.worldMatrixFromCache)}return this.onLODLevelSelection&&this.onLODLevelSelection(d,this,n.mesh),n.mesh}}return this.onLODLevelSelection&&this.onLODLevelSelection(d,this,this),this}get geometry(){return this._geometry}getTotalVertices(){return this._geometry===null||this._geometry===void 0?0:this._geometry.getTotalVertices()}getVerticesData(l,e,t){var a,s;if(!this._geometry)return null;let d=(s=(a=this._userInstancedBuffersStorage)===null||a===void 0?void 0:a.vertexBuffers[l])===null||s===void 0?void 0:s.getFloatData(this._geometry.getTotalVertices(),t||e&&this._geometry.meshes.length!==1);return d||(d=this._geometry.getVerticesData(l,e,t)),d}getVertexBuffer(l){var e,t;return this._geometry?(t=(e=this._userInstancedBuffersStorage)===null||e===void 0?void 0:e.vertexBuffers[l])!==null&&t!==void 0?t:this._geometry.getVertexBuffer(l):null}isVerticesDataPresent(l){var e;return this._geometry?((e=this._userInstancedBuffersStorage)===null||e===void 0?void 0:e.vertexBuffers[l])!==void 0||this._geometry.isVerticesDataPresent(l):this._delayInfo?this._delayInfo.indexOf(l)!==-1:!1}isVertexBufferUpdatable(l){var e,t;return this._geometry?((t=(e=this._userInstancedBuffersStorage)===null||e===void 0?void 0:e.vertexBuffers[l])===null||t===void 0?void 0:t.isUpdatable())||this._geometry.isVertexBufferUpdatable(l):this._delayInfo?this._delayInfo.indexOf(l)!==-1:!1}getVerticesDataKinds(){if(!this._geometry){const e=new Array;return this._delayInfo&&this._delayInfo.forEach(function(t){e.push(t)}),e}const l=this._geometry.getVerticesDataKinds();if(this._userInstancedBuffersStorage)for(const e in this._userInstancedBuffersStorage.vertexBuffers)l.push(e);return l}getTotalIndices(){return this._geometry?this._geometry.getTotalIndices():0}getIndices(l,e){return this._geometry?this._geometry.getIndices(l,e):[]}get isBlocked(){return this._masterMesh!==null&&this._masterMesh!==void 0}isReady(l=!1,e=!1){var t,a,s,d,i,c;if(this.delayLoadState===2||!super.isReady(l))return!1;if(!this.subMeshes||this.subMeshes.length===0||!l)return!0;const n=this.getEngine(),h=this.getScene(),m=e||n.getCaps().instancedArrays&&(this.instances.length>0||this.hasThinInstances);this.computeWorldMatrix();const o=this.material||h.defaultMaterial;if(o){if(o._storeEffectOnSubMeshes)for(const u of this.subMeshes){const V=u.getMaterial();if(V){if(V._storeEffectOnSubMeshes){if(!V.isReadyForSubMesh(this,u,m))return!1}else if(!V.isReady(this,m))return!1}}else if(!o.isReady(this,m))return!1}const b=n.currentRenderPassId;for(const u of this.lightSources){const V=u.getShadowGenerators();if(!V)continue;const G=V.values();for(let p=G.next();p.done!==!0;p=G.next()){const y=p.value;if(y&&(!(!((t=y.getShadowMap())===null||t===void 0)&&t.renderList)||!((a=y.getShadowMap())===null||a===void 0)&&a.renderList&&((d=(s=y.getShadowMap())===null||s===void 0?void 0:s.renderList)===null||d===void 0?void 0:d.indexOf(this))!==-1)){y.getShadowMap()&&(n.currentRenderPassId=y.getShadowMap().renderPassId);for(const L of this.subMeshes)if(!y.isReady(L,m,(c=(i=L.getMaterial())===null||i===void 0?void 0:i.needAlphaBlendingForMesh(this))!==null&&c!==void 0?c:!1))return n.currentRenderPassId=b,!1;n.currentRenderPassId=b}}}for(const u of this._internalMeshDataInfo._LODLevels)if(u.mesh&&!u.mesh.isReady(m))return!1;return!0}get areNormalsFrozen(){return this._internalMeshDataInfo._areNormalsFrozen}freezeNormals(){return this._internalMeshDataInfo._areNormalsFrozen=!0,this}unfreezeNormals(){return this._internalMeshDataInfo._areNormalsFrozen=!1,this}set overridenInstanceCount(l){this._instanceDataStorage.overridenInstanceCount=l}_preActivate(){const l=this._internalMeshDataInfo,e=this.getScene().getRenderId();return l._preActivateId===e?this:(l._preActivateId=e,this._instanceDataStorage.visibleInstances=null,this)}_preActivateForIntermediateRendering(l){return this._instanceDataStorage.visibleInstances&&(this._instanceDataStorage.visibleInstances.intermediateDefaultRenderId=l),this}_registerInstanceForRenderId(l,e){return this._instanceDataStorage.visibleInstances||(this._instanceDataStorage.visibleInstances={defaultRenderId:e,selfDefaultRenderId:this._renderId}),this._instanceDataStorage.visibleInstances[e]||(this._instanceDataStorage.previousRenderId!==void 0&&this._instanceDataStorage.isFrozen&&(this._instanceDataStorage.visibleInstances[this._instanceDataStorage.previousRenderId]=null),this._instanceDataStorage.previousRenderId=e,this._instanceDataStorage.visibleInstances[e]=new Array),this._instanceDataStorage.visibleInstances[e].push(l),this}_afterComputeWorldMatrix(){super._afterComputeWorldMatrix(),this.hasThinInstances&&(this.doNotSyncBoundingInfo||this.thinInstanceRefreshBoundingInfo(!1))}_postActivate(){this.edgesShareWithInstances&&this.edgesRenderer&&this.edgesRenderer.isEnabled&&this._renderingGroup&&(this._renderingGroup._edgesRenderers.pushNoDuplicate(this.edgesRenderer),this.edgesRenderer.customInstances.push(this.getWorldMatrix()))}refreshBoundingInfo(l=!1,e=!1){if(this.hasBoundingInfo&&this.getBoundingInfo().isLocked)return this;const t=this.geometry?this.geometry.boundingBias:null;return this._refreshBoundingInfo(this._getPositionData(l,e),t),this}_createGlobalSubMesh(l){const e=this.getTotalVertices();if(!e||!this.getIndices())return null;if(this.subMeshes&&this.subMeshes.length>0){const t=this.getIndices();if(!t)return null;const a=t.length;let s=!1;if(l)s=!0;else for(const d of this.subMeshes){if(d.indexStart+d.indexCount>a){s=!0;break}if(d.verticesStart+d.verticesCount>e){s=!0;break}}if(!s)return this.subMeshes[0]}return this.releaseSubMeshes(),new pe(0,0,e,0,this.getTotalIndices(),this)}subdivide(l){if(l<1)return;const e=this.getTotalIndices();let t=e/l|0,a=0;for(;t%3!==0;)t++;this.releaseSubMeshes();for(let s=0;s<l&&!(a>=e);s++)pe.CreateFromIndices(0,a,s===l-1?e-a:t,this),a+=t;this.synchronizeInstances()}setVerticesData(l,e,t=!1,a){if(this._geometry)this._geometry.setVerticesData(l,e,t,a);else{const s=new $;s.set(e,l);const d=this.getScene();new he(he.RandomId(),d,s,t,this)}return this}removeVerticesData(l){this._geometry&&this._geometry.removeVerticesData(l)}markVerticesDataAsUpdatable(l,e=!0){const t=this.getVertexBuffer(l);!t||t.isUpdatable()===e||this.setVerticesData(l,this.getVerticesData(l),e)}setVerticesBuffer(l,e=!0){return this._geometry||(this._geometry=he.CreateGeometryForMesh(this)),this._geometry.setVerticesBuffer(l,null,e),this}updateVerticesData(l,e,t,a){return this._geometry?(a?(this.makeGeometryUnique(),this.updateVerticesData(l,e,t,!1)):this._geometry.updateVerticesData(l,e,t),this):this}updateMeshPositions(l,e=!0){const t=this.getVerticesData(X.PositionKind);if(!t)return this;if(l(t),this.updateVerticesData(X.PositionKind,t,!1,!1),e){const a=this.getIndices(),s=this.getVerticesData(X.NormalKind);if(!s)return this;$.ComputeNormals(t,a,s),this.updateVerticesData(X.NormalKind,s,!1,!1)}return this}makeGeometryUnique(){if(!this._geometry)return this;if(this._geometry.meshes.length===1)return this;const l=this._geometry,e=this._geometry.copy(he.RandomId());return l.releaseForMesh(this,!0),e.applyToMesh(this),this}setIndices(l,e=null,t=!1){if(this._geometry)this._geometry.setIndices(l,e,t);else{const a=new $;a.indices=l;const s=this.getScene();new he(he.RandomId(),s,a,t,this)}return this}updateIndices(l,e,t=!1){return this._geometry?(this._geometry.updateIndices(l,e,t),this):this}toLeftHanded(){return this._geometry?(this._geometry.toLeftHanded(),this):this}_bind(l,e,t){if(!this._geometry)return this;const a=this.getScene().getEngine();this.morphTargetManager&&this.morphTargetManager.isUsingTextureForTargets&&this.morphTargetManager._bind(e);let s;if(this._unIndexed)s=null;else switch(t){case U.PointFillMode:s=null;break;case U.WireFrameFillMode:s=l._getLinesIndexBuffer(this.getIndices(),a);break;default:case U.TriangleFillMode:s=this._geometry.getIndexBuffer();break}return!this._userInstancedBuffersStorage||this.hasThinInstances?this._geometry._bind(e,s):this._geometry._bind(e,s,this._userInstancedBuffersStorage.vertexBuffers,this._userInstancedBuffersStorage.vertexArrayObjects),this}_draw(l,e,t){if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;this._internalMeshDataInfo._onBeforeDrawObservable&&this._internalMeshDataInfo._onBeforeDrawObservable.notifyObservers(this);const a=this.getScene().getEngine();return this._unIndexed||e==U.PointFillMode?a.drawArraysType(e,l.verticesStart,l.verticesCount,this.forcedInstanceCount||t):e==U.WireFrameFillMode?a.drawElementsType(e,0,l._linesIndexCount,this.forcedInstanceCount||t):a.drawElementsType(e,l.indexStart,l.indexCount,this.forcedInstanceCount||t),this}registerBeforeRender(l){return this.onBeforeRenderObservable.add(l),this}unregisterBeforeRender(l){return this.onBeforeRenderObservable.removeCallback(l),this}registerAfterRender(l){return this.onAfterRenderObservable.add(l),this}unregisterAfterRender(l){return this.onAfterRenderObservable.removeCallback(l),this}_getInstancesRenderList(l,e=!1){if(this._instanceDataStorage.isFrozen){if(e)return this._instanceDataStorage.batchCacheReplacementModeInFrozenMode.hardwareInstancedRendering[l]=!1,this._instanceDataStorage.batchCacheReplacementModeInFrozenMode.renderSelf[l]=!0,this._instanceDataStorage.batchCacheReplacementModeInFrozenMode;if(this._instanceDataStorage.previousBatch)return this._instanceDataStorage.previousBatch}const t=this.getScene(),a=t._isInIntermediateRendering(),s=a?this._internalAbstractMeshDataInfo._onlyForInstancesIntermediate:this._internalAbstractMeshDataInfo._onlyForInstances,d=this._instanceDataStorage.batchCache;if(d.mustReturn=!1,d.renderSelf[l]=e||!s&&this.isEnabled()&&this.isVisible,d.visibleInstances[l]=null,this._instanceDataStorage.visibleInstances&&!e){const i=this._instanceDataStorage.visibleInstances,c=t.getRenderId(),n=a?i.intermediateDefaultRenderId:i.defaultRenderId;d.visibleInstances[l]=i[c],!d.visibleInstances[l]&&n&&(d.visibleInstances[l]=i[n])}return d.hardwareInstancedRendering[l]=!e&&this._instanceDataStorage.hardwareInstancedRendering&&d.visibleInstances[l]!==null&&d.visibleInstances[l]!==void 0,this._instanceDataStorage.previousBatch=d,d}_renderWithInstances(l,e,t,a,s){var d;const i=t.visibleInstances[l._id],c=i?i.length:0,n=this._instanceDataStorage,h=n.instancesBufferSize;let m=n.instancesBuffer,o=n.instancesPreviousBuffer;const b=(c+1)*16*4;for(;n.instancesBufferSize<b;)n.instancesBufferSize*=2;(!n.instancesData||h!=n.instancesBufferSize)&&(n.instancesData=new Float32Array(n.instancesBufferSize/4)),(this._scene.needsPreviousWorldMatrices&&!n.instancesPreviousData||h!=n.instancesBufferSize)&&(n.instancesPreviousData=new Float32Array(n.instancesBufferSize/4));let u=0,V=0;const G=t.renderSelf[l._id],p=!m||h!==n.instancesBufferSize||this._scene.needsPreviousWorldMatrices&&!n.instancesPreviousBuffer;if(!this._instanceDataStorage.manualUpdate&&(!n.isFrozen||p)){const y=this.getWorldMatrix();if(G&&(this._scene.needsPreviousWorldMatrices&&(n.masterMeshPreviousWorldMatrix?(n.masterMeshPreviousWorldMatrix.copyToArray(n.instancesPreviousData,u),n.masterMeshPreviousWorldMatrix.copyFrom(y)):(n.masterMeshPreviousWorldMatrix=y.clone(),n.masterMeshPreviousWorldMatrix.copyToArray(n.instancesPreviousData,u))),y.copyToArray(n.instancesData,u),u+=16,V++),i){if(E.INSTANCEDMESH_SORT_TRANSPARENT&&this._scene.activeCamera&&!((d=l.getMaterial())===null||d===void 0)&&d.needAlphaBlendingForMesh(l.getRenderingMesh())){const L=this._scene.activeCamera.globalPosition;for(let N=0;N<i.length;N++){const J=i[N];J._distanceToCamera=r.Distance(J.getBoundingInfo().boundingSphere.centerWorld,L)}i.sort((N,J)=>N._distanceToCamera>J._distanceToCamera?-1:N._distanceToCamera<J._distanceToCamera?1:0)}for(let L=0;L<i.length;L++){const N=i[L],J=N.getWorldMatrix();J.copyToArray(n.instancesData,u),this._scene.needsPreviousWorldMatrices&&(N._previousWorldMatrix?(N._previousWorldMatrix.copyToArray(n.instancesPreviousData,u),N._previousWorldMatrix.copyFrom(J)):(N._previousWorldMatrix=J.clone(),N._previousWorldMatrix.copyToArray(n.instancesPreviousData,u))),u+=16,V++}}}else V=(G?1:0)+c;return p?(m&&m.dispose(),o&&o.dispose(),m=new ya(s,n.instancesData,!0,16,!1,!0),n.instancesBuffer=m,this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0}),this._userInstancedBuffersStorage.vertexBuffers.world0=m.createVertexBuffer("world0",0,4),this._userInstancedBuffersStorage.vertexBuffers.world1=m.createVertexBuffer("world1",4,4),this._userInstancedBuffersStorage.vertexBuffers.world2=m.createVertexBuffer("world2",8,4),this._userInstancedBuffersStorage.vertexBuffers.world3=m.createVertexBuffer("world3",12,4),this._scene.needsPreviousWorldMatrices&&(o=new ya(s,n.instancesPreviousData,!0,16,!1,!0),n.instancesPreviousBuffer=o,this._userInstancedBuffersStorage.vertexBuffers.previousWorld0=o.createVertexBuffer("previousWorld0",0,4),this._userInstancedBuffersStorage.vertexBuffers.previousWorld1=o.createVertexBuffer("previousWorld1",4,4),this._userInstancedBuffersStorage.vertexBuffers.previousWorld2=o.createVertexBuffer("previousWorld2",8,4),this._userInstancedBuffersStorage.vertexBuffers.previousWorld3=o.createVertexBuffer("previousWorld3",12,4)),this._invalidateInstanceVertexArrayObject()):(!this._instanceDataStorage.isFrozen||this._instanceDataStorage.forceMatrixUpdates)&&(m.updateDirectly(n.instancesData,0,V),this._scene.needsPreviousWorldMatrices&&(!this._instanceDataStorage.manualUpdate||this._instanceDataStorage.previousManualUpdate)&&o.updateDirectly(n.instancesPreviousData,0,V)),this._processInstancedBuffers(i,G),this.getScene()._activeIndices.addCount(l.indexCount*V,!1),s._currentDrawContext&&(s._currentDrawContext.useInstancing=!0),this._bind(l,a,e),this._draw(l,e,V),this._scene.needsPreviousWorldMatrices&&!p&&this._instanceDataStorage.manualUpdate&&(!this._instanceDataStorage.isFrozen||this._instanceDataStorage.forceMatrixUpdates)&&!this._instanceDataStorage.previousManualUpdate&&o.updateDirectly(n.instancesData,0,V),s.unbindInstanceAttributes(),this}_renderWithThinInstances(l,e,t,a){var s,d;const i=(d=(s=this._thinInstanceDataStorage)===null||s===void 0?void 0:s.instancesCount)!==null&&d!==void 0?d:0;this.getScene()._activeIndices.addCount(l.indexCount*i,!1),a._currentDrawContext&&(a._currentDrawContext.useInstancing=!0),this._bind(l,t,e),this._draw(l,e,i),this._scene.needsPreviousWorldMatrices&&!this._thinInstanceDataStorage.previousMatrixData&&this._thinInstanceDataStorage.matrixData&&(this._thinInstanceDataStorage.previousMatrixBuffer?this._thinInstanceDataStorage.previousMatrixBuffer.updateDirectly(this._thinInstanceDataStorage.matrixData,0,i):this._thinInstanceDataStorage.previousMatrixBuffer=this._thinInstanceCreateMatrixBuffer("previousWorld",this._thinInstanceDataStorage.matrixData,!1)),a.unbindInstanceAttributes()}_processInstancedBuffers(l,e){}_processRendering(l,e,t,a,s,d,i,c){const n=this.getScene(),h=n.getEngine();if(d&&e.getRenderingMesh().hasThinInstances)return this._renderWithThinInstances(e,a,t,h),this;if(d)this._renderWithInstances(e,a,s,t,h);else{h._currentDrawContext&&(h._currentDrawContext.useInstancing=!1);let m=0;s.renderSelf[e._id]&&(i&&i(!1,l.getWorldMatrix(),c),m++,this._draw(e,a,this._instanceDataStorage.overridenInstanceCount));const o=s.visibleInstances[e._id];if(o){const b=o.length;m+=b;for(let u=0;u<b;u++){const V=o[u].getWorldMatrix();i&&i(!0,V,c),this._draw(e,a)}}n._activeIndices.addCount(e.indexCount*m,!1)}return this}_rebuild(l=!1){if(this._instanceDataStorage.instancesBuffer&&(l&&this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null),this._userInstancedBuffersStorage){for(const e in this._userInstancedBuffersStorage.vertexBuffers){const t=this._userInstancedBuffersStorage.vertexBuffers[e];t&&(l&&t.dispose(),this._userInstancedBuffersStorage.vertexBuffers[e]=null)}this._userInstancedBuffersStorage.vertexArrayObjects&&(this._userInstancedBuffersStorage.vertexArrayObjects={})}this._internalMeshDataInfo._effectiveMaterial=null,super._rebuild(l)}_freeze(){if(this.subMeshes){for(let l=0;l<this.subMeshes.length;l++)this._getInstancesRenderList(l);this._internalMeshDataInfo._effectiveMaterial=null,this._instanceDataStorage.isFrozen=!0}}_unFreeze(){this._instanceDataStorage.isFrozen=!1,this._instanceDataStorage.previousBatch=null}render(l,e,t){var a,s,d;const i=this.getScene();if(this._internalAbstractMeshDataInfo._isActiveIntermediate?this._internalAbstractMeshDataInfo._isActiveIntermediate=!1:this._internalAbstractMeshDataInfo._isActive=!1,this._checkOcclusionQuery()&&!this._occlusionDataStorage.forceRenderingWhenOccluded)return this;const c=this._getInstancesRenderList(l._id,!!t);if(c.mustReturn)return this;if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;const n=i.getEngine();let h=0,m=null;this.ignoreCameraMaxZ&&i.activeCamera&&!i._isInIntermediateRendering()&&(h=i.activeCamera.maxZ,m=i.activeCamera,i.activeCamera.maxZ=0,i.updateTransformMatrix(!0)),this._internalMeshDataInfo._onBeforeRenderObservable&&this._internalMeshDataInfo._onBeforeRenderObservable.notifyObservers(this);const o=l.getRenderingMesh(),b=c.hardwareInstancedRendering[l._id]||o.hasThinInstances||!!this._userInstancedBuffersStorage&&!l.getMesh()._internalAbstractMeshDataInfo._actAsRegularMesh,u=this._instanceDataStorage,V=l.getMaterial();if(!V)return m&&(m.maxZ=h,i.updateTransformMatrix(!0)),this;if(!u.isFrozen||!this._internalMeshDataInfo._effectiveMaterial||this._internalMeshDataInfo._effectiveMaterial!==V){if(V._storeEffectOnSubMeshes){if(!V.isReadyForSubMesh(this,l,b))return m&&(m.maxZ=h,i.updateTransformMatrix(!0)),this}else if(!V.isReady(this,b))return m&&(m.maxZ=h,i.updateTransformMatrix(!0)),this;this._internalMeshDataInfo._effectiveMaterial=V}else if(V._storeEffectOnSubMeshes&&!(!((a=l.effect)===null||a===void 0)&&a._wasPreviouslyReady)||!V._storeEffectOnSubMeshes&&!(!((s=V.getEffect())===null||s===void 0)&&s._wasPreviouslyReady))return m&&(m.maxZ=h,i.updateTransformMatrix(!0)),this;e&&n.setAlphaMode(this._internalMeshDataInfo._effectiveMaterial.alphaMode);let G;this._internalMeshDataInfo._effectiveMaterial._storeEffectOnSubMeshes?G=l._drawWrapper:G=this._internalMeshDataInfo._effectiveMaterial._getDrawWrapper();const p=(d=G==null?void 0:G.effect)!==null&&d!==void 0?d:null;for(const T of i._beforeRenderingMeshStage)T.action(this,l,c,p);if(!G||!p)return m&&(m.maxZ=h,i.updateTransformMatrix(!0)),this;const y=t||this;let L;if(!u.isFrozen&&(this._internalMeshDataInfo._effectiveMaterial.backFaceCulling||this.overrideMaterialSideOrientation!==null)){const T=y._getWorldMatrixDeterminant();L=this.overrideMaterialSideOrientation,L==null&&(L=this._internalMeshDataInfo._effectiveMaterial.sideOrientation),T<0&&(L=L===U.ClockWiseSideOrientation?U.CounterClockWiseSideOrientation:U.ClockWiseSideOrientation),u.sideOrientation=L}else L=u.sideOrientation;const N=this._internalMeshDataInfo._effectiveMaterial._preBind(G,L);this._internalMeshDataInfo._effectiveMaterial.forceDepthWrite&&n.setDepthWrite(!0);const J=i.forcePointsCloud?U.PointFillMode:i.forceWireframe?U.WireFrameFillMode:this._internalMeshDataInfo._effectiveMaterial.fillMode;this._internalMeshDataInfo._onBeforeBindObservable&&this._internalMeshDataInfo._onBeforeBindObservable.notifyObservers(this),b||this._bind(l,p,J);const R=this._internalMeshDataInfo._effectiveMaterial,S=y.getWorldMatrix();R._storeEffectOnSubMeshes?R.bindForSubMesh(S,this,l):R.bind(S,this),!R.backFaceCulling&&R.separateCullingPass&&(n.setState(!0,R.zOffset,!1,!N,R.cullBackFaces,R.stencil,R.zOffsetUnits),this._processRendering(this,l,p,J,c,b,this._onBeforeDraw,this._internalMeshDataInfo._effectiveMaterial),n.setState(!0,R.zOffset,!1,N,R.cullBackFaces,R.stencil,R.zOffsetUnits),this._internalMeshDataInfo._onBetweenPassObservable&&this._internalMeshDataInfo._onBetweenPassObservable.notifyObservers(l)),this._processRendering(this,l,p,J,c,b,this._onBeforeDraw,this._internalMeshDataInfo._effectiveMaterial),this._internalMeshDataInfo._effectiveMaterial.unbind();for(const T of i._afterRenderingMeshStage)T.action(this,l,c,p);return this._internalMeshDataInfo._onAfterRenderObservable&&this._internalMeshDataInfo._onAfterRenderObservable.notifyObservers(this),m&&(m.maxZ=h,i.updateTransformMatrix(!0)),i.performancePriority===Te.Aggressive&&!u.isFrozen&&this._freeze(),this}cleanMatrixWeights(){this.isVerticesDataPresent(X.MatricesWeightsKind)&&(this.isVerticesDataPresent(X.MatricesWeightsExtraKind)?this._normalizeSkinWeightsAndExtra():this._normalizeSkinFourWeights())}_normalizeSkinFourWeights(){const l=this.getVerticesData(X.MatricesWeightsKind),e=l.length;for(let t=0;t<e;t+=4){const a=l[t]+l[t+1]+l[t+2]+l[t+3];if(a===0)l[t]=1;else{const s=1/a;l[t]*=s,l[t+1]*=s,l[t+2]*=s,l[t+3]*=s}}this.setVerticesData(X.MatricesWeightsKind,l)}_normalizeSkinWeightsAndExtra(){const l=this.getVerticesData(X.MatricesWeightsExtraKind),e=this.getVerticesData(X.MatricesWeightsKind),t=e.length;for(let a=0;a<t;a+=4){let s=e[a]+e[a+1]+e[a+2]+e[a+3];if(s+=l[a]+l[a+1]+l[a+2]+l[a+3],s===0)e[a]=1;else{const d=1/s;e[a]*=d,e[a+1]*=d,e[a+2]*=d,e[a+3]*=d,l[a]*=d,l[a+1]*=d,l[a+2]*=d,l[a+3]*=d}}this.setVerticesData(X.MatricesWeightsKind,e),this.setVerticesData(X.MatricesWeightsKind,l)}validateSkinning(){const l=this.getVerticesData(X.MatricesWeightsExtraKind),e=this.getVerticesData(X.MatricesWeightsKind);if(e===null||this.skeleton==null)return{skinned:!1,valid:!0,report:"not skinned"};const t=e.length;let a=0,s=0,d=0,i=0;const c=l===null?4:8,n=new Array;for(let G=0;G<=c;G++)n[G]=0;const h=.001;for(let G=0;G<t;G+=4){let p=e[G],y=p,L=y===0?0:1;for(let N=1;N<c;N++){const J=N<4?e[G+N]:l[G+N-4];J>p&&a++,J!==0&&L++,y+=J,p=J}if(n[L]++,L>d&&(d=L),y===0)s++;else{const N=1/y;let J=0;for(let R=0;R<c;R++)R<4?J+=Math.abs(e[G+R]-e[G+R]*N):J+=Math.abs(l[G+R-4]-l[G+R-4]*N);J>h&&i++}}const m=this.skeleton.bones.length,o=this.getVerticesData(X.MatricesIndicesKind),b=this.getVerticesData(X.MatricesIndicesExtraKind);let u=0;for(let G=0;G<t;G+=4)for(let p=0;p<c;p++){const y=p<4?o[G+p]:b[G+p-4];(y>=m||y<0)&&u++}const V="Number of Weights = "+t/4+`
Maximum influences = `+d+`
Missing Weights = `+s+`
Not Sorted = `+a+`
Not Normalized = `+i+`
WeightCounts = [`+n+`]
Number of bones = `+m+`
Bad Bone Indices = `+u;return{skinned:!0,valid:s===0&&i===0&&u===0,report:V}}_checkDelayState(){const l=this.getScene();return this._geometry?this._geometry.load(l):this.delayLoadState===4&&(this.delayLoadState=2,this._queueLoad(l)),this}_queueLoad(l){l.addPendingData(this);const e=this.delayLoadingFile.indexOf(".babylonbinarymeshdata")!==-1;return Q.LoadFile(this.delayLoadingFile,t=>{t instanceof ArrayBuffer?this._delayLoadingFunction(t,this):this._delayLoadingFunction(JSON.parse(t),this),this.instances.forEach(a=>{a.refreshBoundingInfo(),a._syncSubMeshes()}),this.delayLoadState=1,l.removePendingData(this)},()=>{},l.offlineProvider,e),this}isInFrustum(l){return this.delayLoadState===2||!super.isInFrustum(l)?!1:(this._checkDelayState(),!0)}setMaterialById(l){const e=this.getScene().materials;let t;for(t=e.length-1;t>-1;t--)if(e[t].id===l)return this.material=e[t],this;const a=this.getScene().multiMaterials;for(t=a.length-1;t>-1;t--)if(a[t].id===l)return this.material=a[t],this;return this}getAnimatables(){const l=new Array;return this.material&&l.push(this.material),this.skeleton&&l.push(this.skeleton),l}bakeTransformIntoVertices(l){if(!this.isVerticesDataPresent(X.PositionKind))return this;const e=this.subMeshes.splice(0);this._resetPointsArrayCache();let t=this.getVerticesData(X.PositionKind);const a=r.Zero();let s;for(s=0;s<t.length;s+=3)r.TransformCoordinatesFromFloatsToRef(t[s],t[s+1],t[s+2],l,a).toArray(t,s);if(this.setVerticesData(X.PositionKind,t,this.getVertexBuffer(X.PositionKind).isUpdatable()),this.isVerticesDataPresent(X.NormalKind)){for(t=this.getVerticesData(X.NormalKind),s=0;s<t.length;s+=3)r.TransformNormalFromFloatsToRef(t[s],t[s+1],t[s+2],l,a).normalize().toArray(t,s);this.setVerticesData(X.NormalKind,t,this.getVertexBuffer(X.NormalKind).isUpdatable())}return l.determinant()<0&&this.flipFaces(),this.releaseSubMeshes(),this.subMeshes=e,this}bakeCurrentTransformIntoVertices(l=!0){return this.bakeTransformIntoVertices(this.computeWorldMatrix(!0)),this.resetLocalMatrix(l),this}get _positions(){return this._internalAbstractMeshDataInfo._positions?this._internalAbstractMeshDataInfo._positions:this._geometry?this._geometry._positions:null}_resetPointsArrayCache(){return this._geometry&&this._geometry._resetPointsArrayCache(),this}_generatePointsArray(){return this._geometry?this._geometry._generatePointsArray():!1}clone(l="",e=null,t,a=!0){return new E(l,this.getScene(),e,this,t,a)}dispose(l,e=!1){this.morphTargetManager=null,this._geometry&&this._geometry.releaseForMesh(this,!0);const t=this._internalMeshDataInfo;if(t._onBeforeDrawObservable&&t._onBeforeDrawObservable.clear(),t._onBeforeBindObservable&&t._onBeforeBindObservable.clear(),t._onBeforeRenderObservable&&t._onBeforeRenderObservable.clear(),t._onAfterRenderObservable&&t._onAfterRenderObservable.clear(),t._onBetweenPassObservable&&t._onBetweenPassObservable.clear(),this._scene.useClonedMeshMap){if(t.meshMap)for(const a in t.meshMap){const s=t.meshMap[a];s&&(s._internalMeshDataInfo._source=null,t.meshMap[a]=void 0)}t._source&&t._source._internalMeshDataInfo.meshMap&&(t._source._internalMeshDataInfo.meshMap[this.uniqueId]=void 0)}else{const a=this.getScene().meshes;for(const s of a){const d=s;d._internalMeshDataInfo&&d._internalMeshDataInfo._source&&d._internalMeshDataInfo._source===this&&(d._internalMeshDataInfo._source=null)}}t._source=null,this._disposeInstanceSpecificData(),this._disposeThinInstanceSpecificData(),this._internalMeshDataInfo._checkReadinessObserver&&this._scene.onBeforeRenderObservable.remove(this._internalMeshDataInfo._checkReadinessObserver),super.dispose(l,e)}_disposeInstanceSpecificData(){}_disposeThinInstanceSpecificData(){}_invalidateInstanceVertexArrayObject(){}applyDisplacementMap(l,e,t,a,s,d,i=!1){const c=this.getScene(),n=h=>{const m=h.width,o=h.height,b=this.getEngine().createCanvas(m,o).getContext("2d");b.drawImage(h,0,0);const u=b.getImageData(0,0,m,o).data;this.applyDisplacementMapFromBuffer(u,m,o,e,t,s,d,i),a&&a(this)};return Q.LoadImage(l,n,()=>{},c.offlineProvider),this}applyDisplacementMapFromBuffer(l,e,t,a,s,d,i,c=!1){if(!this.isVerticesDataPresent(X.PositionKind)||!this.isVerticesDataPresent(X.NormalKind)||!this.isVerticesDataPresent(X.UVKind))return M.Warn("Cannot call applyDisplacementMap: Given mesh is not complete. Position, Normal or UV are missing"),this;const n=this.getVerticesData(X.PositionKind,!0,!0),h=this.getVerticesData(X.NormalKind),m=this.getVerticesData(X.UVKind);let o=r.Zero();const b=r.Zero(),u=Wl.Zero();d=d||Wl.Zero(),i=i||new Wl(1,1);for(let V=0;V<n.length;V+=3){r.FromArrayToRef(n,V,o),r.FromArrayToRef(h,V,b),Wl.FromArrayToRef(m,V/3*2,u);const G=Math.abs(u.x*i.x+d.x%1)*(e-1)%e|0,p=Math.abs(u.y*i.y+d.y%1)*(t-1)%t|0,y=(G+p*e)*4,L=l[y]/255,N=l[y+1]/255,J=l[y+2]/255,R=L*.3+N*.59+J*.11;b.normalize(),b.scaleInPlace(a+(s-a)*R),o=o.add(b),o.toArray(n,V)}return $.ComputeNormals(n,this.getIndices(),h),c?(this.setVerticesData(X.PositionKind,n),this.setVerticesData(X.NormalKind,h),this.setVerticesData(X.UVKind,m)):(this.updateVerticesData(X.PositionKind,n),this.updateVerticesData(X.NormalKind,h)),this}convertToFlatShadedMesh(){const l=this.getVerticesDataKinds(),e={},t={},a={};let s=!1,d,i;for(d=0;d<l.length;d++){i=l[d];const G=this.getVertexBuffer(i),p=G.getData();if(!((p instanceof Array||p instanceof Float32Array)&&p.length===0)){if(i===X.NormalKind){s=G.isUpdatable(),l.splice(d,1),d--;continue}e[i]=G,t[i]=this.getVerticesData(i),a[i]=[]}}const c=this.subMeshes.slice(0),n=this.getIndices(),h=this.getTotalIndices();let m;for(m=0;m<h;m++){const G=n[m];for(d=0;d<l.length;d++){if(i=l[d],!e[i])continue;const p=e[i].getStrideSize();for(let y=0;y<p;y++)a[i].push(t[i][G*p+y])}}const o=[],b=a[X.PositionKind],u=this.getScene().useRightHandedSystem;let V;for(u?V=this.overrideMaterialSideOrientation===1:V=this.overrideMaterialSideOrientation===0,m=0;m<h;m+=3){n[m]=m,n[m+1]=m+1,n[m+2]=m+2;const G=r.FromArray(b,m*3),p=r.FromArray(b,(m+1)*3),y=r.FromArray(b,(m+2)*3),L=G.subtract(p),N=y.subtract(p),J=r.Normalize(r.Cross(L,N));V&&J.scaleInPlace(-1);for(let R=0;R<3;R++)o.push(J.x),o.push(J.y),o.push(J.z)}for(this.setIndices(n),this.setVerticesData(X.NormalKind,o,s),d=0;d<l.length;d++)i=l[d],a[i]&&this.setVerticesData(i,a[i],e[i].isUpdatable());this.releaseSubMeshes();for(let G=0;G<c.length;G++){const p=c[G];pe.AddToMesh(p.materialIndex,p.indexStart,p.indexCount,p.indexStart,p.indexCount,this)}return this.synchronizeInstances(),this}convertToUnIndexedMesh(){const l=this.getVerticesDataKinds(),e={},t={},a={};let s,d;for(s=0;s<l.length;s++){d=l[s];const m=this.getVertexBuffer(d);e[d]=m,t[d]=e[d].getData(),a[d]=[]}const i=this.subMeshes.slice(0),c=this.getIndices(),n=this.getTotalIndices();let h;for(h=0;h<n;h++){const m=c[h];for(s=0;s<l.length;s++){d=l[s];const o=e[d].getStrideSize();for(let b=0;b<o;b++)a[d].push(t[d][m*o+b])}}for(h=0;h<n;h+=3)c[h]=h,c[h+1]=h+1,c[h+2]=h+2;for(this.setIndices(c),s=0;s<l.length;s++)d=l[s],this.setVerticesData(d,a[d],e[d].isUpdatable(),e[d].getStrideSize());this.releaseSubMeshes();for(let m=0;m<i.length;m++){const o=i[m];pe.AddToMesh(o.materialIndex,o.indexStart,o.indexCount,o.indexStart,o.indexCount,this)}return this._unIndexed=!0,this.synchronizeInstances(),this}flipFaces(l=!1){const e=$.ExtractFromMesh(this);let t;if(l&&this.isVerticesDataPresent(X.NormalKind)&&e.normals)for(t=0;t<e.normals.length;t++)e.normals[t]*=-1;if(e.indices){let a;for(t=0;t<e.indices.length;t+=3)a=e.indices[t+1],e.indices[t+1]=e.indices[t+2],e.indices[t+2]=a}return e.applyToMesh(this,this.isVertexBufferUpdatable(X.PositionKind)),this}increaseVertices(l=1){const e=$.ExtractFromMesh(this),t=e.indices&&!Array.isArray(e.indices)&&Array.from?Array.from(e.indices):e.indices,a=e.positions&&!Array.isArray(e.positions)&&Array.from?Array.from(e.positions):e.positions,s=e.uvs&&!Array.isArray(e.uvs)&&Array.from?Array.from(e.uvs):e.uvs,d=e.normals&&!Array.isArray(e.normals)&&Array.from?Array.from(e.normals):e.normals;if(!t||!a)M.Warn("Couldn't increase number of vertices : VertexData must contain at least indices and positions");else{e.indices=t,e.positions=a,s&&(e.uvs=s),d&&(e.normals=d);const i=l+1,c=new Array;for(let J=0;J<i+1;J++)c[J]=new Array;let n,h;const m=new r(0,0,0),o=new r(0,0,0),b=new Wl(0,0),u=new Array,V=new Array,G=new Array;let p,y=a.length,L;s&&(L=s.length);let N;d&&(N=d.length);for(let J=0;J<t.length;J+=3){V[0]=t[J],V[1]=t[J+1],V[2]=t[J+2];for(let R=0;R<3;R++)if(n=V[R],h=V[(R+1)%3],G[n]===void 0&&G[h]===void 0?(G[n]=new Array,G[h]=new Array):(G[n]===void 0&&(G[n]=new Array),G[h]===void 0&&(G[h]=new Array)),G[n][h]===void 0&&G[h][n]===void 0){G[n][h]=[],m.x=(a[3*h]-a[3*n])/i,m.y=(a[3*h+1]-a[3*n+1])/i,m.z=(a[3*h+2]-a[3*n+2])/i,d&&(o.x=(d[3*h]-d[3*n])/i,o.y=(d[3*h+1]-d[3*n+1])/i,o.z=(d[3*h+2]-d[3*n+2])/i),s&&(b.x=(s[2*h]-s[2*n])/i,b.y=(s[2*h+1]-s[2*n+1])/i),G[n][h].push(n);for(let S=1;S<i;S++)G[n][h].push(a.length/3),a[y++]=a[3*n]+S*m.x,a[y++]=a[3*n+1]+S*m.y,a[y++]=a[3*n+2]+S*m.z,d&&(d[N++]=d[3*n]+S*o.x,d[N++]=d[3*n+1]+S*o.y,d[N++]=d[3*n+2]+S*o.z),s&&(s[L++]=s[2*n]+S*b.x,s[L++]=s[2*n+1]+S*b.y);G[n][h].push(h),G[h][n]=new Array,p=G[n][h].length;for(let S=0;S<p;S++)G[h][n][S]=G[n][h][p-1-S]}c[0][0]=t[J],c[1][0]=G[t[J]][t[J+1]][1],c[1][1]=G[t[J]][t[J+2]][1];for(let R=2;R<i;R++){c[R][0]=G[t[J]][t[J+1]][R],c[R][R]=G[t[J]][t[J+2]][R],m.x=(a[3*c[R][R]]-a[3*c[R][0]])/R,m.y=(a[3*c[R][R]+1]-a[3*c[R][0]+1])/R,m.z=(a[3*c[R][R]+2]-a[3*c[R][0]+2])/R,d&&(o.x=(d[3*c[R][R]]-d[3*c[R][0]])/R,o.y=(d[3*c[R][R]+1]-d[3*c[R][0]+1])/R,o.z=(d[3*c[R][R]+2]-d[3*c[R][0]+2])/R),s&&(b.x=(s[2*c[R][R]]-s[2*c[R][0]])/R,b.y=(s[2*c[R][R]+1]-s[2*c[R][0]+1])/R);for(let S=1;S<R;S++)c[R][S]=a.length/3,a[y++]=a[3*c[R][0]]+S*m.x,a[y++]=a[3*c[R][0]+1]+S*m.y,a[y++]=a[3*c[R][0]+2]+S*m.z,d&&(d[N++]=d[3*c[R][0]]+S*o.x,d[N++]=d[3*c[R][0]+1]+S*o.y,d[N++]=d[3*c[R][0]+2]+S*o.z),s&&(s[L++]=s[2*c[R][0]]+S*b.x,s[L++]=s[2*c[R][0]+1]+S*b.y)}c[i]=G[t[J+1]][t[J+2]],u.push(c[0][0],c[1][0],c[1][1]);for(let R=1;R<i;R++){let S;for(S=0;S<R;S++)u.push(c[R][S],c[R+1][S],c[R+1][S+1]),u.push(c[R][S],c[R+1][S+1],c[R][S+1]);u.push(c[R][S],c[R+1][S],c[R+1][S+1])}}e.indices=u,e.applyToMesh(this,this.isVertexBufferUpdatable(X.PositionKind))}}forceSharedVertices(){const l=$.ExtractFromMesh(this),e=l.uvs,t=l.indices,a=l.positions,s=l.colors,d=l.matricesIndices,i=l.matricesWeights,c=l.matricesIndicesExtra,n=l.matricesWeightsExtra;if(t===void 0||a===void 0||t===null||a===null)M.Warn("VertexData contains empty entries");else{const h=new Array,m=new Array,o=new Array,b=new Array,u=new Array,V=new Array,G=new Array,p=new Array;let y=new Array,L=0;const N={};let J,R;for(let T=0;T<t.length;T+=3){R=[t[T],t[T+1],t[T+2]],y=new Array;for(let k=0;k<3;k++){y[k]="";for(let g=0;g<3;g++)Math.abs(a[3*R[k]+g])<1e-8&&(a[3*R[k]+g]=0),y[k]+=a[3*R[k]+g]+"|"}if(!(y[0]==y[1]||y[0]==y[2]||y[1]==y[2]))for(let k=0;k<3;k++){if(J=N[y[k]],J===void 0){N[y[k]]=L,J=L++;for(let g=0;g<3;g++)h.push(a[3*R[k]+g]);if(s!=null)for(let g=0;g<4;g++)b.push(s[4*R[k]+g]);if(e!=null)for(let g=0;g<2;g++)o.push(e[2*R[k]+g]);if(d!=null)for(let g=0;g<4;g++)u.push(d[4*R[k]+g]);if(i!=null)for(let g=0;g<4;g++)V.push(i[4*R[k]+g]);if(c!=null)for(let g=0;g<4;g++)G.push(c[4*R[k]+g]);if(n!=null)for(let g=0;g<4;g++)p.push(n[4*R[k]+g])}m.push(J)}}const S=new Array;$.ComputeNormals(h,m,S),l.positions=h,l.indices=m,l.normals=S,e!=null&&(l.uvs=o),s!=null&&(l.colors=b),d!=null&&(l.matricesIndices=u),i!=null&&(l.matricesWeights=V),c!=null&&(l.matricesIndicesExtra=G),i!=null&&(l.matricesWeightsExtra=p),l.applyToMesh(this,this.isVertexBufferUpdatable(X.PositionKind))}}static _instancedMeshFactory(l,e){throw O("InstancedMesh")}static _PhysicsImpostorParser(l,e,t){throw O("PhysicsImpostor")}createInstance(l){return E._instancedMeshFactory(l,this)}synchronizeInstances(){for(let l=0;l<this.instances.length;l++)this.instances[l]._syncSubMeshes();return this}optimizeIndices(l){const e=this.getIndices(),t=this.getVerticesData(X.PositionKind);if(!t||!e)return this;const a=new Array;for(let d=0;d<t.length;d=d+3)a.push(r.FromArray(t,d));const s=new Array;return pa.SyncAsyncForLoop(a.length,40,d=>{const i=a.length-1-d,c=a[i];for(let n=0;n<i;++n){const h=a[n];if(c.equals(h)){s[i]=n;break}}},()=>{for(let i=0;i<e.length;++i)e[i]=s[e[i]]||e[i];const d=this.subMeshes.slice(0);this.setIndices(e),this.subMeshes=d,l&&l(this)}),this}serialize(l={}){l.name=this.name,l.id=this.id,l.uniqueId=this.uniqueId,l.type=this.getClassName(),ul&&ul.HasTags(this)&&(l.tags=ul.GetTags(this)),l.position=this.position.asArray(),this.rotationQuaternion?l.rotationQuaternion=this.rotationQuaternion.asArray():this.rotation&&(l.rotation=this.rotation.asArray()),l.scaling=this.scaling.asArray(),this._postMultiplyPivotMatrix?l.pivotMatrix=this.getPivotMatrix().asArray():l.localMatrix=this.getPivotMatrix().asArray(),l.isEnabled=this.isEnabled(!1),l.isVisible=this.isVisible,l.infiniteDistance=this.infiniteDistance,l.pickable=this.isPickable,l.receiveShadows=this.receiveShadows,l.billboardMode=this.billboardMode,l.visibility=this.visibility,l.checkCollisions=this.checkCollisions,l.isBlocker=this.isBlocker,l.overrideMaterialSideOrientation=this.overrideMaterialSideOrientation,this.parent&&this.parent._serializeAsParent(l),l.isUnIndexed=this.isUnIndexed;const e=this._geometry;if(e&&this.subMeshes){l.geometryUniqueId=e.uniqueId,l.geometryId=e.id,l.subMeshes=[];for(let t=0;t<this.subMeshes.length;t++){const a=this.subMeshes[t];l.subMeshes.push({materialIndex:a.materialIndex,verticesStart:a.verticesStart,verticesCount:a.verticesCount,indexStart:a.indexStart,indexCount:a.indexCount})}}if(this.material?this.material.doNotSerialize||(l.materialUniqueId=this.material.uniqueId,l.materialId=this.material.id):(this.material=null,l.materialUniqueId=this._scene.defaultMaterial.uniqueId,l.materialId=this._scene.defaultMaterial.id),this.morphTargetManager&&(l.morphTargetManagerId=this.morphTargetManager.uniqueId),this.skeleton&&(l.skeletonId=this.skeleton.id,l.numBoneInfluencers=this.numBoneInfluencers),this.getScene()._getComponent(D.NAME_PHYSICSENGINE)){const t=this.getPhysicsImpostor();t&&(l.physicsMass=t.getParam("mass"),l.physicsFriction=t.getParam("friction"),l.physicsRestitution=t.getParam("mass"),l.physicsImpostor=t.type)}this.metadata&&(l.metadata=this.metadata),l.instances=[];for(let t=0;t<this.instances.length;t++){const a=this.instances[t];if(a.doNotSerialize)continue;const s={name:a.name,id:a.id,isEnabled:a.isEnabled(!1),isVisible:a.isVisible,isPickable:a.isPickable,checkCollisions:a.checkCollisions,position:a.position.asArray(),scaling:a.scaling.asArray()};if(a.parent&&a.parent._serializeAsParent(s),a.rotationQuaternion?s.rotationQuaternion=a.rotationQuaternion.asArray():a.rotation&&(s.rotation=a.rotation.asArray()),this.getScene()._getComponent(D.NAME_PHYSICSENGINE)){const d=a.getPhysicsImpostor();d&&(s.physicsMass=d.getParam("mass"),s.physicsFriction=d.getParam("friction"),s.physicsRestitution=d.getParam("mass"),s.physicsImpostor=d.type)}a.metadata&&(s.metadata=a.metadata),l.instances.push(s),il.AppendSerializedAnimations(a,s),s.ranges=a.serializeAnimationRanges()}if(this._thinInstanceDataStorage.instancesCount&&this._thinInstanceDataStorage.matrixData&&(l.thinInstances={instancesCount:this._thinInstanceDataStorage.instancesCount,matrixData:Array.from(this._thinInstanceDataStorage.matrixData),matrixBufferSize:this._thinInstanceDataStorage.matrixBufferSize,enablePicking:this.thinInstanceEnablePicking},this._userThinInstanceBuffersStorage)){const t={data:{},sizes:{},strides:{}};for(const a in this._userThinInstanceBuffersStorage.data)t.data[a]=Array.from(this._userThinInstanceBuffersStorage.data[a]),t.sizes[a]=this._userThinInstanceBuffersStorage.sizes[a],t.strides[a]=this._userThinInstanceBuffersStorage.strides[a];l.thinInstances.userThinInstance=t}return il.AppendSerializedAnimations(this,l),l.ranges=this.serializeAnimationRanges(),l.layerMask=this.layerMask,l.alphaIndex=this.alphaIndex,l.hasVertexAlpha=this.hasVertexAlpha,l.overlayAlpha=this.overlayAlpha,l.overlayColor=this.overlayColor.asArray(),l.renderOverlay=this.renderOverlay,l.applyFog=this.applyFog,this.actionManager&&(l.actions=this.actionManager.serialize(this.name)),l}_syncGeometryWithMorphTargetManager(){if(!this.geometry)return;this._markSubMeshesAsAttributesDirty();const l=this._internalAbstractMeshDataInfo._morphTargetManager;if(l&&l.vertexCount){if(l.vertexCount!==this.getTotalVertices()){M.Error("Mesh is incompatible with morph targets. Targets and mesh must all have the same vertices count."),this.morphTargetManager=null;return}if(l.isUsingTextureForTargets)return;for(let e=0;e<l.numInfluencers;e++){const t=l.getActiveTarget(e),a=t.getPositions();if(!a){M.Error("Invalid morph target. Target must have positions.");return}this.geometry.setVerticesData(X.PositionKind+e,a,!1,3);const s=t.getNormals();s&&this.geometry.setVerticesData(X.NormalKind+e,s,!1,3);const d=t.getTangents();d&&this.geometry.setVerticesData(X.TangentKind+e,d,!1,3);const i=t.getUVs();i&&this.geometry.setVerticesData(X.UVKind+"_"+e,i,!1,2)}}else{let e=0;for(;this.geometry.isVerticesDataPresent(X.PositionKind+e);)this.geometry.removeVerticesData(X.PositionKind+e),this.geometry.isVerticesDataPresent(X.NormalKind+e)&&this.geometry.removeVerticesData(X.NormalKind+e),this.geometry.isVerticesDataPresent(X.TangentKind+e)&&this.geometry.removeVerticesData(X.TangentKind+e),this.geometry.isVerticesDataPresent(X.UVKind+e)&&this.geometry.removeVerticesData(X.UVKind+"_"+e),e++}}static Parse(l,e,t){let a;if(l.type&&l.type==="LinesMesh"?a=E._LinesMeshParser(l,e):l.type&&l.type==="GroundMesh"?a=E._GroundMeshParser(l,e):l.type&&l.type==="GoldbergMesh"?a=E._GoldbergMeshParser(l,e):a=new E(l.name,e),a.id=l.id,a._waitingParsedUniqueId=l.uniqueId,ul&&ul.AddTagsTo(a,l.tags),a.position=r.FromArray(l.position),l.metadata!==void 0&&(a.metadata=l.metadata),l.rotationQuaternion?a.rotationQuaternion=_.FromArray(l.rotationQuaternion):l.rotation&&(a.rotation=r.FromArray(l.rotation)),a.scaling=r.FromArray(l.scaling),l.localMatrix?a.setPreTransformMatrix(Y.FromArray(l.localMatrix)):l.pivotMatrix&&a.setPivotMatrix(Y.FromArray(l.pivotMatrix)),a.setEnabled(l.isEnabled),a.isVisible=l.isVisible,a.infiniteDistance=l.infiniteDistance,a.showBoundingBox=l.showBoundingBox,a.showSubMeshesBoundingBox=l.showSubMeshesBoundingBox,l.applyFog!==void 0&&(a.applyFog=l.applyFog),l.pickable!==void 0&&(a.isPickable=l.pickable),l.alphaIndex!==void 0&&(a.alphaIndex=l.alphaIndex),a.receiveShadows=l.receiveShadows,l.billboardMode!==void 0&&(a.billboardMode=l.billboardMode),l.visibility!==void 0&&(a.visibility=l.visibility),a.checkCollisions=l.checkCollisions,a.overrideMaterialSideOrientation=l.overrideMaterialSideOrientation,l.isBlocker!==void 0&&(a.isBlocker=l.isBlocker),a._shouldGenerateFlatShading=l.useFlatShading,l.freezeWorldMatrix&&(a._waitingData.freezeWorldMatrix=l.freezeWorldMatrix),l.parentId!==void 0&&(a._waitingParentId=l.parentId),l.parentInstanceIndex!==void 0&&(a._waitingParentInstanceIndex=l.parentInstanceIndex),l.actions!==void 0&&(a._waitingData.actions=l.actions),l.overlayAlpha!==void 0&&(a.overlayAlpha=l.overlayAlpha),l.overlayColor!==void 0&&(a.overlayColor=al.FromArray(l.overlayColor)),l.renderOverlay!==void 0&&(a.renderOverlay=l.renderOverlay),a.isUnIndexed=!!l.isUnIndexed,a.hasVertexAlpha=l.hasVertexAlpha,l.delayLoadingFile?(a.delayLoadState=4,a.delayLoadingFile=t+l.delayLoadingFile,a.buildBoundingInfo(r.FromArray(l.boundingBoxMinimum),r.FromArray(l.boundingBoxMaximum)),l._binaryInfo&&(a._binaryInfo=l._binaryInfo),a._delayInfo=[],l.hasUVs&&a._delayInfo.push(X.UVKind),l.hasUVs2&&a._delayInfo.push(X.UV2Kind),l.hasUVs3&&a._delayInfo.push(X.UV3Kind),l.hasUVs4&&a._delayInfo.push(X.UV4Kind),l.hasUVs5&&a._delayInfo.push(X.UV5Kind),l.hasUVs6&&a._delayInfo.push(X.UV6Kind),l.hasColors&&a._delayInfo.push(X.ColorKind),l.hasMatricesIndices&&a._delayInfo.push(X.MatricesIndicesKind),l.hasMatricesWeights&&a._delayInfo.push(X.MatricesWeightsKind),a._delayLoadingFunction=he._ImportGeometry,gl.ForceFullSceneLoadingForIncremental&&a._checkDelayState()):he._ImportGeometry(l,a),l.materialUniqueId?a._waitingMaterialId=l.materialUniqueId:l.materialId&&(a._waitingMaterialId=l.materialId),l.morphTargetManagerId>-1&&(a.morphTargetManager=e.getMorphTargetManagerById(l.morphTargetManagerId)),l.skeletonId!==void 0&&l.skeletonId!==null&&(a.skeleton=e.getLastSkeletonById(l.skeletonId),l.numBoneInfluencers&&(a.numBoneInfluencers=l.numBoneInfluencers)),l.animations){for(let s=0;s<l.animations.length;s++){const d=l.animations[s],i=Gt("BABYLON.Animation");i&&a.animations.push(i.Parse(d))}Bl.ParseAnimationRanges(a,l,e)}if(l.autoAnimate&&e.beginAnimation(a,l.autoAnimateFrom,l.autoAnimateTo,l.autoAnimateLoop,l.autoAnimateSpeed||1),l.layerMask&&!isNaN(l.layerMask)?a.layerMask=Math.abs(parseInt(l.layerMask)):a.layerMask=268435455,l.physicsImpostor&&E._PhysicsImpostorParser(e,a,l),l.lodMeshIds&&(a._waitingData.lods={ids:l.lodMeshIds,distances:l.lodDistances?l.lodDistances:null,coverages:l.lodCoverages?l.lodCoverages:null}),l.instances)for(let s=0;s<l.instances.length;s++){const d=l.instances[s],i=a.createInstance(d.name);if(d.id&&(i.id=d.id),ul&&(d.tags?ul.AddTagsTo(i,d.tags):ul.AddTagsTo(i,l.tags)),i.position=r.FromArray(d.position),d.metadata!==void 0&&(i.metadata=d.metadata),d.parentId!==void 0&&(i._waitingParentId=d.parentId),d.parentInstanceIndex!==void 0&&(i._waitingParentInstanceIndex=d.parentInstanceIndex),d.isEnabled!==void 0&&d.isEnabled!==null&&i.setEnabled(d.isEnabled),d.isVisible!==void 0&&d.isVisible!==null&&(i.isVisible=d.isVisible),d.isPickable!==void 0&&d.isPickable!==null&&(i.isPickable=d.isPickable),d.rotationQuaternion?i.rotationQuaternion=_.FromArray(d.rotationQuaternion):d.rotation&&(i.rotation=r.FromArray(d.rotation)),i.scaling=r.FromArray(d.scaling),d.checkCollisions!=null&&d.checkCollisions!=null&&(i.checkCollisions=d.checkCollisions),d.pickable!=null&&d.pickable!=null&&(i.isPickable=d.pickable),d.showBoundingBox!=null&&d.showBoundingBox!=null&&(i.showBoundingBox=d.showBoundingBox),d.showSubMeshesBoundingBox!=null&&d.showSubMeshesBoundingBox!=null&&(i.showSubMeshesBoundingBox=d.showSubMeshesBoundingBox),d.alphaIndex!=null&&d.showSubMeshesBoundingBox!=null&&(i.alphaIndex=d.alphaIndex),d.physicsImpostor&&E._PhysicsImpostorParser(e,i,d),d.animations){for(let c=0;c<d.animations.length;c++){const n=d.animations[c],h=Gt("BABYLON.Animation");h&&i.animations.push(h.Parse(n))}Bl.ParseAnimationRanges(i,d,e),d.autoAnimate&&e.beginAnimation(i,d.autoAnimateFrom,d.autoAnimateTo,d.autoAnimateLoop,d.autoAnimateSpeed||1)}}if(l.thinInstances){const s=l.thinInstances;if(a.thinInstanceEnablePicking=!!s.enablePicking,s.matrixData?(a.thinInstanceSetBuffer("matrix",new Float32Array(s.matrixData),16,!1),a._thinInstanceDataStorage.matrixBufferSize=s.matrixBufferSize,a._thinInstanceDataStorage.instancesCount=s.instancesCount):a._thinInstanceDataStorage.matrixBufferSize=s.matrixBufferSize,l.thinInstances.userThinInstance){const d=l.thinInstances.userThinInstance;for(const i in d.data)a.thinInstanceSetBuffer(i,new Float32Array(d.data[i]),d.strides[i],!1),a._userThinInstanceBuffersStorage.sizes[i]=d.sizes[i]}}return a}setPositionsForCPUSkinning(){const l=this._internalMeshDataInfo;if(!l._sourcePositions){const e=this.getVerticesData(X.PositionKind);if(!e)return l._sourcePositions;l._sourcePositions=new Float32Array(e),this.isVertexBufferUpdatable(X.PositionKind)||this.setVerticesData(X.PositionKind,e,!0)}return l._sourcePositions}setNormalsForCPUSkinning(){const l=this._internalMeshDataInfo;if(!l._sourceNormals){const e=this.getVerticesData(X.NormalKind);if(!e)return l._sourceNormals;l._sourceNormals=new Float32Array(e),this.isVertexBufferUpdatable(X.NormalKind)||this.setVerticesData(X.NormalKind,e,!0)}return l._sourceNormals}applySkeleton(l){if(!this.geometry)return this;if(this.geometry._softwareSkinningFrameId==this.getScene().getFrameId())return this;if(this.geometry._softwareSkinningFrameId=this.getScene().getFrameId(),!this.isVerticesDataPresent(X.PositionKind))return this;if(!this.isVerticesDataPresent(X.MatricesIndicesKind))return this;if(!this.isVerticesDataPresent(X.MatricesWeightsKind))return this;const e=this.isVerticesDataPresent(X.NormalKind),t=this._internalMeshDataInfo;if(!t._sourcePositions){const p=this.subMeshes.slice();this.setPositionsForCPUSkinning(),this.subMeshes=p}e&&!t._sourceNormals&&this.setNormalsForCPUSkinning();let a=this.getVerticesData(X.PositionKind);if(!a)return this;a instanceof Float32Array||(a=new Float32Array(a));let s=this.getVerticesData(X.NormalKind);if(e){if(!s)return this;s instanceof Float32Array||(s=new Float32Array(s))}const d=this.getVerticesData(X.MatricesIndicesKind),i=this.getVerticesData(X.MatricesWeightsKind);if(!i||!d)return this;const c=this.numBoneInfluencers>4,n=c?this.getVerticesData(X.MatricesIndicesExtraKind):null,h=c?this.getVerticesData(X.MatricesWeightsExtraKind):null,m=l.getTransformMatrices(this),o=r.Zero(),b=new Y,u=new Y;let V=0,G;for(let p=0;p<a.length;p+=3,V+=4){let y;for(G=0;G<4;G++)y=i[V+G],y>0&&(Y.FromFloat32ArrayToRefScaled(m,Math.floor(d[V+G]*16),y,u),b.addToSelf(u));if(c)for(G=0;G<4;G++)y=h[V+G],y>0&&(Y.FromFloat32ArrayToRefScaled(m,Math.floor(n[V+G]*16),y,u),b.addToSelf(u));r.TransformCoordinatesFromFloatsToRef(t._sourcePositions[p],t._sourcePositions[p+1],t._sourcePositions[p+2],b,o),o.toArray(a,p),e&&(r.TransformNormalFromFloatsToRef(t._sourceNormals[p],t._sourceNormals[p+1],t._sourceNormals[p+2],b,o),o.toArray(s,p)),b.reset()}return this.updateVerticesData(X.PositionKind,a),e&&this.updateVerticesData(X.NormalKind,s),this}static MinMax(l){let e=null,t=null;return l.forEach(function(a){const s=a.getBoundingInfo().boundingBox;!e||!t?(e=s.minimumWorld,t=s.maximumWorld):(e.minimizeInPlace(s.minimumWorld),t.maximizeInPlace(s.maximumWorld))}),!e||!t?{min:r.Zero(),max:r.Zero()}:{min:e,max:t}}static Center(l){const e=l instanceof Array?E.MinMax(l):l;return r.Center(e.min,e.max)}static MergeMeshes(l,e=!0,t,a,s,d){return Ns(E._MergeMeshesCoroutine(l,e,t,a,s,d,!1))}static MergeMeshesAsync(l,e=!0,t,a,s,d){return Qi(E._MergeMeshesCoroutine(l,e,t,a,s,d,!0),Bi())}static*_MergeMeshesCoroutine(l,e=!0,t,a,s,d,i){if(l=l.filter(Boolean),l.length===0)return null;let c;if(!t){let S=0;for(c=0;c<l.length;c++)if(S+=l[c].getTotalVertices(),S>=65536)return M.Warn("Cannot merge meshes because resulting mesh will have more than 65536 vertices. Please use allow32BitsIndices = true to use 32 bits indices"),null}d&&(s=!1);const n=new Array,h=new Array,m=new Array,o=l[0].overrideMaterialSideOrientation;for(c=0;c<l.length;c++){const S=l[c];if(S.isAnInstance)return M.Warn("Cannot merge instance meshes."),null;if(o!==S.overrideMaterialSideOrientation)return M.Warn("Cannot merge meshes with different overrideMaterialSideOrientation values."),null;if(s&&m.push(S.getTotalIndices()),d)if(S.material){const T=S.material;if(T instanceof zt){for(let k=0;k<T.subMaterials.length;k++)n.indexOf(T.subMaterials[k])<0&&n.push(T.subMaterials[k]);for(let k=0;k<S.subMeshes.length;k++)h.push(n.indexOf(T.subMaterials[S.subMeshes[k].materialIndex])),m.push(S.subMeshes[k].indexCount)}else{n.indexOf(T)<0&&n.push(T);for(let k=0;k<S.subMeshes.length;k++)h.push(n.indexOf(T)),m.push(S.subMeshes[k].indexCount)}}else for(let T=0;T<S.subMeshes.length;T++)h.push(0),m.push(S.subMeshes[T].indexCount)}const b=l[0],u=S=>{const T=S.computeWorldMatrix(!0);return[$.ExtractFromMesh(S,!1,!1),T]},[V,G]=u(b);i&&(yield);const p=new Array(l.length-1);for(let S=1;S<l.length;S++)p[S-1]=u(l[S]),i&&(yield);const y=V._mergeCoroutine(G,p,t,i,!e);let L=y.next();for(;!L.done;)i&&(yield),L=y.next();const N=L.value;a||(a=new E(b.name+"_merged",b.getScene()));const J=N._applyToCoroutine(a,void 0,i);let R=J.next();for(;!R.done;)i&&(yield),R=J.next();if(a.checkCollisions=b.checkCollisions,a.overrideMaterialSideOrientation=b.overrideMaterialSideOrientation,e)for(c=0;c<l.length;c++)l[c].dispose();if(s||d){a.releaseSubMeshes(),c=0;let S=0;for(;c<m.length;)pe.CreateFromIndices(0,S,m[c],a,void 0,!1),S+=m[c],c++;for(const T of a.subMeshes)T.refreshBoundingInfo();a.computeWorldMatrix(!0)}if(d){const S=new zt(b.name+"_merged",b.getScene());S.subMaterials=n;for(let T=0;T<a.subMeshes.length;T++)a.subMeshes[T].materialIndex=h[T];a.material=S}else a.material=b.material;return a}addInstance(l){l._indexInSourceMeshInstanceArray=this.instances.length,this.instances.push(l)}removeInstance(l){const e=l._indexInSourceMeshInstanceArray;if(e!=-1){if(e!==this.instances.length-1){const t=this.instances[this.instances.length-1];this.instances[e]=t,t._indexInSourceMeshInstanceArray=e}l._indexInSourceMeshInstanceArray=-1,this.instances.pop()}}_shouldConvertRHS(){return this.overrideMaterialSideOrientation===U.CounterClockWiseSideOrientation}}E.FRONTSIDE=$.FRONTSIDE;E.BACKSIDE=$.BACKSIDE;E.DOUBLESIDE=$.DOUBLESIDE;E.DEFAULTSIDE=$.DEFAULTSIDE;E.NO_CAP=0;E.CAP_START=1;E.CAP_END=2;E.CAP_ALL=3;E.NO_FLIP=0;E.FLIP_TILE=1;E.ROTATE_TILE=2;E.FLIP_ROW=3;E.ROTATE_ROW=4;E.FLIP_N_ROTATE_TILE=5;E.FLIP_N_ROTATE_ROW=6;E.CENTER=0;E.LEFT=1;E.RIGHT=2;E.TOP=3;E.BOTTOM=4;E.INSTANCEDMESH_SORT_TRANSPARENT=!1;E._GroundMeshParser=(Z,l)=>{throw O("GroundMesh")};E._GoldbergMeshParser=(Z,l)=>{throw O("GoldbergMesh")};E._LinesMeshParser=(Z,l)=>{throw O("LinesMesh")};ce("BABYLON.Mesh",E);E.prototype.setMaterialByID=function(Z){return this.setMaterialById(Z)};E.CreateDisc=E.CreateDisc||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateBox=E.CreateBox||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateSphere=E.CreateSphere||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateCylinder=E.CreateCylinder||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateTorusKnot=E.CreateTorusKnot||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateTorus=E.CreateTorus||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreatePlane=E.CreatePlane||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateGround=E.CreateGround||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateTiledGround=E.CreateTiledGround||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateGroundFromHeightMap=E.CreateGroundFromHeightMap||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateTube=E.CreateTube||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreatePolyhedron=E.CreatePolyhedron||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateIcoSphere=E.CreateIcoSphere||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateDecal=E.CreateDecal||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.CreateCapsule=E.CreateCapsule||(()=>{throw new Error("Import MeshBuilder to populate this function")});E.ExtendToGoldberg=E.ExtendToGoldberg||(()=>{throw new Error("Import MeshBuilder to populate this function")});class je{constructor(l=0){this.priority=l}getDescription(){return""}apply(l,e){return!0}}class wa extends je{constructor(l=0,e=1024,t=.5){super(l),this.priority=l,this.maximumSize=e,this.step=t}getDescription(){return"Reducing render target texture size to "+this.maximumSize}apply(l,e){let t=!0;for(let a=0;a<l.textures.length;a++){const s=l.textures[a];if(!s.canRescale||s.getContext)continue;const d=s.getSize();Math.max(d.width,d.height)>this.maximumSize&&(s.scale(this.step),t=!1)}return t}}class Os extends je{constructor(l=0,e=2,t=.25){super(l),this.priority=l,this.maximumScale=e,this.step=t,this._currentScale=-1,this._directionOffset=1}getDescription(){return"Setting hardware scaling level to "+this._currentScale}apply(l,e){return this._currentScale===-1&&(this._currentScale=l.getEngine().getHardwareScalingLevel(),this._currentScale>this.maximumScale&&(this._directionOffset=-1)),this._currentScale+=this._directionOffset*this.step,l.getEngine().setHardwareScalingLevel(this._currentScale),this._directionOffset===1?this._currentScale>=this.maximumScale:this._currentScale<=this.maximumScale}}class _a extends je{getDescription(){return"Turning shadows on/off"}apply(l,e){return l.shadowsEnabled=e.isInImprovementMode,!0}}class Da extends je{getDescription(){return"Turning post-processes on/off"}apply(l,e){return l.postProcessesEnabled=e.isInImprovementMode,!0}}class ja extends je{getDescription(){return"Turning lens flares on/off"}apply(l,e){return l.lensFlaresEnabled=e.isInImprovementMode,!0}}class ec extends je{getDescription(){return this.onGetDescription?this.onGetDescription():"Running user defined callback"}apply(l,e){return this.onApply?this.onApply(l,e):!0}}class Aa extends je{getDescription(){return"Turning particles on/off"}apply(l,e){return l.particlesEnabled=e.isInImprovementMode,!0}}class qs extends je{getDescription(){return"Turning render targets off"}apply(l,e){return l.renderTargetsEnabled=e.isInImprovementMode,!0}}class et extends je{constructor(){super(...arguments),this._canBeMerged=l=>{if(!(l instanceof E))return!1;const e=l;return!(e.isDisposed()||!e.isVisible||!e.isEnabled()||e.instances.length>0||e.skeleton||e.hasLODLevels)}}static get UpdateSelectionTree(){return et._UpdateSelectionTree}static set UpdateSelectionTree(l){et._UpdateSelectionTree=l}getDescription(){return"Merging similar meshes together"}apply(l,e,t){const a=l.meshes.slice(0);let s=a.length;for(let i=0;i<s;i++){const c=new Array,n=a[i];if(this._canBeMerged(n)){c.push(n);for(let h=i+1;h<s;h++){const m=a[h];this._canBeMerged(m)&&m.material===n.material&&m.checkCollisions===n.checkCollisions&&(c.push(m),s--,a.splice(h,1),h--)}c.length<2||E.MergeMeshes(c,void 0,!0)}}const d=l;return d.createOrUpdateSelectionOctree&&(t!=null?t&&d.createOrUpdateSelectionOctree():et.UpdateSelectionTree&&d.createOrUpdateSelectionOctree()),!0}}et._UpdateSelectionTree=!1;class rt{constructor(l=60,e=2e3){this.targetFrameRate=l,this.trackerDuration=e,this.optimizations=new Array}addOptimization(l){return this.optimizations.push(l),this}addCustomOptimization(l,e,t=0){const a=new ec(t);return a.onApply=l,a.onGetDescription=e,this.optimizations.push(a),this}static LowDegradationAllowed(l){const e=new rt(l);let t=0;return e.addOptimization(new et(t)),e.addOptimization(new _a(t)),e.addOptimization(new ja(t)),t++,e.addOptimization(new Da(t)),e.addOptimization(new Aa(t)),t++,e.addOptimization(new wa(t,1024)),e}static ModerateDegradationAllowed(l){const e=new rt(l);let t=0;return e.addOptimization(new et(t)),e.addOptimization(new _a(t)),e.addOptimization(new ja(t)),t++,e.addOptimization(new Da(t)),e.addOptimization(new Aa(t)),t++,e.addOptimization(new wa(t,512)),t++,e.addOptimization(new qs(t)),t++,e.addOptimization(new Os(t,2)),e}static HighDegradationAllowed(l){const e=new rt(l);let t=0;return e.addOptimization(new et(t)),e.addOptimization(new _a(t)),e.addOptimization(new ja(t)),t++,e.addOptimization(new Da(t)),e.addOptimization(new Aa(t)),t++,e.addOptimization(new wa(t,256)),t++,e.addOptimization(new qs(t)),t++,e.addOptimization(new Os(t,4)),e}}class Ss{constructor(l,e,t=!0,a=!1){if(this._isRunning=!1,this._currentPriorityLevel=0,this._targetFrameRate=60,this._trackerDuration=2e3,this._currentFrameRate=0,this._improvementMode=!1,this.onSuccessObservable=new z,this.onNewOptimizationAppliedObservable=new z,this.onFailureObservable=new z,e?this._options=e:this._options=new rt,this._options.targetFrameRate&&(this._targetFrameRate=this._options.targetFrameRate),this._options.trackerDuration&&(this._trackerDuration=this._options.trackerDuration),t){let s=0;for(const d of this._options.optimizations)d.priority=s++}this._improvementMode=a,this._scene=l||bl.LastCreatedScene,this._sceneDisposeObserver=this._scene.onDisposeObservable.add(()=>{this._sceneDisposeObserver=null,this.dispose()})}get isInImprovementMode(){return this._improvementMode}set isInImprovementMode(l){this._improvementMode=l}get currentPriorityLevel(){return this._currentPriorityLevel}get currentFrameRate(){return this._currentFrameRate}get targetFrameRate(){return this._targetFrameRate}set targetFrameRate(l){this._targetFrameRate=l}get trackerDuration(){return this._trackerDuration}set trackerDuration(l){this._trackerDuration=l}get optimizations(){return this._options.optimizations}stop(){this._isRunning=!1}reset(){this._currentPriorityLevel=0}start(){this._isRunning||(this._isRunning=!0,this._scene.executeWhenReady(()=>{setTimeout(()=>{this._checkCurrentState()},this._trackerDuration)}))}_checkCurrentState(){if(!this._isRunning)return;const l=this._scene,e=this._options;if(this._currentFrameRate=Math.round(l.getEngine().getFps()),this._improvementMode&&this._currentFrameRate<=this._targetFrameRate||!this._improvementMode&&this._currentFrameRate>=this._targetFrameRate){this._isRunning=!1,this.onSuccessObservable.notifyObservers(this);return}let t=!0,a=!0;for(let s=0;s<e.optimizations.length;s++){const d=e.optimizations[s];d.priority===this._currentPriorityLevel&&(a=!1,t=t&&d.apply(l,this),this.onNewOptimizationAppliedObservable.notifyObservers(d))}if(a){this._isRunning=!1,this.onFailureObservable.notifyObservers(this);return}t&&this._currentPriorityLevel++,l.executeWhenReady(()=>{setTimeout(()=>{this._checkCurrentState()},this._trackerDuration)})}dispose(){this.stop(),this.onSuccessObservable.clear(),this.onFailureObservable.clear(),this.onNewOptimizationAppliedObservable.clear(),this._sceneDisposeObserver&&this._scene.onDisposeObservable.remove(this._sceneDisposeObserver)}static OptimizeAsync(l,e,t,a){const s=new Ss(l,e||rt.ModerateDegradationAllowed(),!1);return t&&s.onSuccessObservable.add(()=>{t()}),a&&s.onFailureObservable.add(()=>{a()}),s.start(),s}}function tc(Z){const{engine:l}=Z,e=new sl(l);e.clearColor=new Gl(0,0,0,0),e.pointerMovePredicate=()=>!1,e.pointerDownPredicate=()=>!1,e.pointerUpPredicate=()=>!1,e.clearCachedVertexData(),e.themeData={};const t=rt.LowDegradationAllowed();return t.optimizations=t.optimizations.splice(1),t.targetFrameRate=60,Ss.OptimizeAsync(e,t),e}class Kl extends j{constructor(l,e,t,a=!0){super(l,e,t,a),this._tmpUpVector=r.Zero(),this._tmpTargetVector=r.Zero(),this.cameraDirection=new r(0,0,0),this.cameraRotation=new Wl(0,0),this.ignoreParentScaling=!1,this.updateUpVectorFromRotation=!1,this._tmpQuaternion=new _,this.rotation=new r(0,0,0),this.speed=2,this.noRotationConstraint=!1,this.invertRotation=!1,this.inverseRotationSpeed=.2,this.lockedTarget=null,this._currentTarget=r.Zero(),this._initialFocalDistance=1,this._viewMatrix=Y.Zero(),this._camMatrix=Y.Zero(),this._cameraTransformMatrix=Y.Zero(),this._cameraRotationMatrix=Y.Zero(),this._referencePoint=new r(0,0,1),this._transformedReferencePoint=r.Zero(),this._defaultUp=r.Up(),this._cachedRotationZ=0,this._cachedQuaternionRotationZ=0}getFrontPosition(l){this.getWorldMatrix();const e=this.getTarget().subtract(this.position);return e.normalize(),e.scaleInPlace(l),this.globalPosition.add(e)}_getLockedTargetPosition(){return this.lockedTarget?(this.lockedTarget.absolutePosition&&this.lockedTarget.computeWorldMatrix(),this.lockedTarget.absolutePosition||this.lockedTarget):null}storeState(){return this._storedPosition=this.position.clone(),this._storedRotation=this.rotation.clone(),this.rotationQuaternion&&(this._storedRotationQuaternion=this.rotationQuaternion.clone()),super.storeState()}_restoreStateValues(){return super._restoreStateValues()?(this.position=this._storedPosition.clone(),this.rotation=this._storedRotation.clone(),this.rotationQuaternion&&(this.rotationQuaternion=this._storedRotationQuaternion.clone()),this.cameraDirection.copyFromFloats(0,0,0),this.cameraRotation.copyFromFloats(0,0),!0):!1}_initCache(){super._initCache(),this._cache.lockedTarget=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotation=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotationQuaternion=new _(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}_updateCache(l){l||super._updateCache();const e=this._getLockedTargetPosition();e?this._cache.lockedTarget?this._cache.lockedTarget.copyFrom(e):this._cache.lockedTarget=e.clone():this._cache.lockedTarget=null,this._cache.rotation.copyFrom(this.rotation),this.rotationQuaternion&&this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)}_isSynchronizedViewMatrix(){if(!super._isSynchronizedViewMatrix())return!1;const l=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(l):!l)&&(this.rotationQuaternion?this.rotationQuaternion.equals(this._cache.rotationQuaternion):this._cache.rotation.equals(this.rotation))}_computeLocalCameraSpeed(){const l=this.getEngine();return this.speed*Math.sqrt(l.getDeltaTime()/(l.getFps()*100))}setTarget(l){this.upVector.normalize(),this._initialFocalDistance=l.subtract(this.position).length(),this.position.z===l.z&&(this.position.z+=Sl),this._referencePoint.normalize().scaleInPlace(this._initialFocalDistance),Y.LookAtLHToRef(this.position,l,this._defaultUp,this._camMatrix),this._camMatrix.invert(),this.rotation.x=Math.atan(this._camMatrix.m[6]/this._camMatrix.m[10]);const e=l.subtract(this.position);e.x>=0?this.rotation.y=-Math.atan(e.z/e.x)+Math.PI/2:this.rotation.y=-Math.atan(e.z/e.x)-Math.PI/2,this.rotation.z=0,isNaN(this.rotation.x)&&(this.rotation.x=0),isNaN(this.rotation.y)&&(this.rotation.y=0),isNaN(this.rotation.z)&&(this.rotation.z=0),this.rotationQuaternion&&_.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)}get target(){return this.getTarget()}set target(l){this.setTarget(l)}getTarget(){return this._currentTarget}_decideIfNeedsToMove(){return Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0}_updatePosition(){if(this.parent){this.parent.getWorldMatrix().invertToRef(f.Matrix[0]),r.TransformNormalToRef(this.cameraDirection,f.Matrix[0],f.Vector3[0]),this.position.addInPlace(f.Vector3[0]);return}this.position.addInPlace(this.cameraDirection)}_checkInputs(){const l=this.invertRotation?-this.inverseRotationSpeed:1,e=this._decideIfNeedsToMove(),t=Math.abs(this.cameraRotation.x)>0||Math.abs(this.cameraRotation.y)>0;e&&this._updatePosition(),t&&(this.rotationQuaternion&&this.rotationQuaternion.toEulerAnglesToRef(this.rotation),this.rotation.x+=this.cameraRotation.x*l,this.rotation.y+=this.cameraRotation.y*l,this.noRotationConstraint||(this.rotation.x>1.570796&&(this.rotation.x=1.570796),this.rotation.x<-1.570796&&(this.rotation.x=-1.570796)),this.rotationQuaternion&&this.rotation.lengthSquared()&&_.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)),e&&(Math.abs(this.cameraDirection.x)<this.speed*Sl&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<this.speed*Sl&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<this.speed*Sl&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia)),t&&(Math.abs(this.cameraRotation.x)<this.speed*Sl&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<this.speed*Sl&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia)),super._checkInputs()}_updateCameraRotationMatrix(){this.rotationQuaternion?this.rotationQuaternion.toRotationMatrix(this._cameraRotationMatrix):Y.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix)}_rotateUpVectorWithCameraRotationMatrix(){return r.TransformNormalToRef(this._defaultUp,this._cameraRotationMatrix,this.upVector),this}_getViewMatrix(){return this.lockedTarget&&this.setTarget(this._getLockedTargetPosition()),this._updateCameraRotationMatrix(),this.rotationQuaternion&&this._cachedQuaternionRotationZ!=this.rotationQuaternion.z?(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedQuaternionRotationZ=this.rotationQuaternion.z):this._cachedRotationZ!==this.rotation.z&&(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedRotationZ=this.rotation.z),r.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget),this.updateUpVectorFromRotation&&(this.rotationQuaternion?Vt.Y.rotateByQuaternionToRef(this.rotationQuaternion,this.upVector):(_.FromEulerVectorToRef(this.rotation,this._tmpQuaternion),Vt.Y.rotateByQuaternionToRef(this._tmpQuaternion,this.upVector))),this._computeViewMatrix(this.position,this._currentTarget,this.upVector),this._viewMatrix}_computeViewMatrix(l,e,t){if(this.ignoreParentScaling){if(this.parent){const a=this.parent.getWorldMatrix();r.TransformCoordinatesToRef(l,a,this._globalPosition),r.TransformCoordinatesToRef(e,a,this._tmpTargetVector),r.TransformNormalToRef(t,a,this._tmpUpVector),this._markSyncedWithParent()}else this._globalPosition.copyFrom(l),this._tmpTargetVector.copyFrom(e),this._tmpUpVector.copyFrom(t);this.getScene().useRightHandedSystem?Y.LookAtRHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix):Y.LookAtLHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix);return}if(this.getScene().useRightHandedSystem?Y.LookAtRHToRef(l,e,t,this._viewMatrix):Y.LookAtLHToRef(l,e,t,this._viewMatrix),this.parent){const a=this.parent.getWorldMatrix();this._viewMatrix.invert(),this._viewMatrix.multiplyToRef(a,this._viewMatrix),this._viewMatrix.getTranslationToRef(this._globalPosition),this._viewMatrix.invert(),this._markSyncedWithParent()}else this._globalPosition.copyFrom(l)}createRigCamera(l,e){if(this.cameraRigMode!==j.RIG_MODE_NONE){const t=new Kl(l,this.position.clone(),this.getScene());return t.isRigCamera=!0,t.rigParent=this,(this.cameraRigMode===j.RIG_MODE_VR||this.cameraRigMode===j.RIG_MODE_WEBVR)&&(this.rotationQuaternion||(this.rotationQuaternion=new _),t._cameraRigParams={},t.rotationQuaternion=new _),t.mode=this.mode,t.orthoLeft=this.orthoLeft,t.orthoRight=this.orthoRight,t.orthoTop=this.orthoTop,t.orthoBottom=this.orthoBottom,t}return null}_updateRigCameras(){const l=this._rigCameras[0],e=this._rigCameras[1];switch(this.computeWorldMatrix(),this.cameraRigMode){case j.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case j.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case j.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case j.RIG_MODE_STEREOSCOPIC_OVERUNDER:case j.RIG_MODE_STEREOSCOPIC_INTERLACED:{const t=this.cameraRigMode===j.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:-1,a=this.cameraRigMode===j.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?-1:1;this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*t,l),this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*a,e);break}case j.RIG_MODE_VR:l.rotationQuaternion?(l.rotationQuaternion.copyFrom(this.rotationQuaternion),e.rotationQuaternion.copyFrom(this.rotationQuaternion)):(l.rotation.copyFrom(this.rotation),e.rotation.copyFrom(this.rotation)),l.position.copyFrom(this.position),e.position.copyFrom(this.position);break}super._updateRigCameras()}_getRigCamPositionAndTarget(l,e){this.getTarget().subtractToRef(this.position,Kl._TargetFocalPoint),Kl._TargetFocalPoint.normalize().scaleInPlace(this._initialFocalDistance);const t=Kl._TargetFocalPoint.addInPlace(this.position);Y.TranslationToRef(-t.x,-t.y,-t.z,Kl._TargetTransformMatrix),Kl._TargetTransformMatrix.multiplyToRef(Y.RotationAxis(e.upVector,l),Kl._RigCamTransformMatrix),Y.TranslationToRef(t.x,t.y,t.z,Kl._TargetTransformMatrix),Kl._RigCamTransformMatrix.multiplyToRef(Kl._TargetTransformMatrix,Kl._RigCamTransformMatrix),r.TransformCoordinatesToRef(this.position,Kl._RigCamTransformMatrix,e.position),e.setTarget(t)}getClassName(){return"TargetCamera"}}Kl._RigCamTransformMatrix=new Y;Kl._TargetTransformMatrix=new Y;Kl._TargetFocalPoint=new r;W([_e()],Kl.prototype,"rotation",void 0);W([F()],Kl.prototype,"speed",void 0);W([Mi("lockedTargetId")],Kl.prototype,"lockedTarget",void 0);function ac(Z){const{scene:l}=Z;let e;const t=36.5;return e=new Kl("TargetCamera1",new r(0,t,0),l),e.fov=.25,e.minZ=5,e.maxZ=t+1,e.setTarget(r.Zero()),e}class nl extends Bl{constructor(l,e){super(l,e),this.diffuse=new al(1,1,1),this.specular=new al(1,1,1),this.falloffType=nl.FALLOFF_DEFAULT,this.intensity=1,this._range=Number.MAX_VALUE,this._inverseSquaredRange=0,this._photometricScale=1,this._intensityMode=nl.INTENSITYMODE_AUTOMATIC,this._radius=1e-5,this.renderPriority=0,this._shadowEnabled=!0,this._excludeWithLayerMask=0,this._includeOnlyWithLayerMask=0,this._lightmapMode=0,this._shadowGenerators=null,this._excludedMeshesIds=new Array,this._includedOnlyMeshesIds=new Array,this._isLight=!0,this.getScene().addLight(this),this._uniformBuffer=new I(this.getScene().getEngine(),void 0,void 0,l),this._buildUniformLayout(),this.includedOnlyMeshes=new Array,this.excludedMeshes=new Array,this._resyncMeshes()}get range(){return this._range}set range(l){this._range=l,this._inverseSquaredRange=1/(this.range*this.range)}get intensityMode(){return this._intensityMode}set intensityMode(l){this._intensityMode=l,this._computePhotometricScale()}get radius(){return this._radius}set radius(l){this._radius=l,this._computePhotometricScale()}get shadowEnabled(){return this._shadowEnabled}set shadowEnabled(l){this._shadowEnabled!==l&&(this._shadowEnabled=l,this._markMeshesAsLightDirty())}get includedOnlyMeshes(){return this._includedOnlyMeshes}set includedOnlyMeshes(l){this._includedOnlyMeshes=l,this._hookArrayForIncludedOnly(l)}get excludedMeshes(){return this._excludedMeshes}set excludedMeshes(l){this._excludedMeshes=l,this._hookArrayForExcluded(l)}get excludeWithLayerMask(){return this._excludeWithLayerMask}set excludeWithLayerMask(l){this._excludeWithLayerMask=l,this._resyncMeshes()}get includeOnlyWithLayerMask(){return this._includeOnlyWithLayerMask}set includeOnlyWithLayerMask(l){this._includeOnlyWithLayerMask=l,this._resyncMeshes()}get lightmapMode(){return this._lightmapMode}set lightmapMode(l){this._lightmapMode!==l&&(this._lightmapMode=l,this._markMeshesAsLightDirty())}transferTexturesToEffect(l,e){return this}_bindLight(l,e,t,a,s=!0){var d;const i=l.toString();let c=!1;if(this._uniformBuffer.bindToEffect(t,"Light"+i),this._renderId!==e.getRenderId()||this._lastUseSpecular!==a||!this._uniformBuffer.useUbo){this._renderId=e.getRenderId(),this._lastUseSpecular=a;const n=this.getScaledIntensity();this.transferToEffect(t,i),this.diffuse.scaleToRef(n,Jt.Color3[0]),this._uniformBuffer.updateColor4("vLightDiffuse",Jt.Color3[0],this.range,i),a&&(this.specular.scaleToRef(n,Jt.Color3[1]),this._uniformBuffer.updateColor4("vLightSpecular",Jt.Color3[1],this.radius,i)),c=!0}if(this.transferTexturesToEffect(t,i),e.shadowsEnabled&&this.shadowEnabled&&s){const n=(d=this.getShadowGenerator(e.activeCamera))!==null&&d!==void 0?d:this.getShadowGenerator();n&&(n.bindShadowLight(i,t),c=!0)}c?this._uniformBuffer.update():this._uniformBuffer.bindUniformBuffer()}getClassName(){return"Light"}toString(l){let e="Name: "+this.name;if(e+=", type: "+["Point","Directional","Spot","Hemispheric"][this.getTypeID()],this.animations)for(let t=0;t<this.animations.length;t++)e+=", animation[0]: "+this.animations[t].toString(l);return e}_syncParentEnabledState(){super._syncParentEnabledState(),this.isDisposed()||this._resyncMeshes()}setEnabled(l){super.setEnabled(l),this._resyncMeshes()}getShadowGenerator(l=null){var e;return this._shadowGenerators===null?null:(e=this._shadowGenerators.get(l))!==null&&e!==void 0?e:null}getShadowGenerators(){return this._shadowGenerators}getAbsolutePosition(){return r.Zero()}canAffectMesh(l){return l?!(this.includedOnlyMeshes&&this.includedOnlyMeshes.length>0&&this.includedOnlyMeshes.indexOf(l)===-1||this.excludedMeshes&&this.excludedMeshes.length>0&&this.excludedMeshes.indexOf(l)!==-1||this.includeOnlyWithLayerMask!==0&&!(this.includeOnlyWithLayerMask&l.layerMask)||this.excludeWithLayerMask!==0&&this.excludeWithLayerMask&l.layerMask):!0}dispose(l,e=!1){if(this._shadowGenerators){const t=this._shadowGenerators.values();for(let a=t.next();a.done!==!0;a=t.next())a.value.dispose();this._shadowGenerators=null}if(this.getScene().stopAnimation(this),this._parentContainer){const t=this._parentContainer.lights.indexOf(this);t>-1&&this._parentContainer.lights.splice(t,1),this._parentContainer=null}for(const t of this.getScene().meshes)t._removeLightSource(this,!0);this._uniformBuffer.dispose(),this.getScene().removeLight(this),super.dispose(l,e)}getTypeID(){return 0}getScaledIntensity(){return this._photometricScale*this.intensity}clone(l,e=null){const t=nl.GetConstructorFromName(this.getTypeID(),l,this.getScene());if(!t)return null;const a=il.Clone(t,this);return l&&(a.name=l),e&&(a.parent=e),a.setEnabled(this.isEnabled()),this.onClonedObservable.notifyObservers(a),a}serialize(){const l=il.Serialize(this);return l.uniqueId=this.uniqueId,l.type=this.getTypeID(),this.parent&&this.parent._serializeAsParent(l),this.excludedMeshes.length>0&&(l.excludedMeshesIds=[],this.excludedMeshes.forEach(e=>{l.excludedMeshesIds.push(e.id)})),this.includedOnlyMeshes.length>0&&(l.includedOnlyMeshesIds=[],this.includedOnlyMeshes.forEach(e=>{l.includedOnlyMeshesIds.push(e.id)})),il.AppendSerializedAnimations(this,l),l.ranges=this.serializeAnimationRanges(),l.isEnabled=this.isEnabled(),l}static GetConstructorFromName(l,e,t){return Bl.Construct("Light_Type_"+l,e,t)||null}static Parse(l,e){const t=nl.GetConstructorFromName(l.type,l.name,e);if(!t)return null;const a=il.Parse(t,l,e);if(l.excludedMeshesIds&&(a._excludedMeshesIds=l.excludedMeshesIds),l.includedOnlyMeshesIds&&(a._includedOnlyMeshesIds=l.includedOnlyMeshesIds),l.parentId!==void 0&&(a._waitingParentId=l.parentId),l.parentInstanceIndex!==void 0&&(a._waitingParentInstanceIndex=l.parentInstanceIndex),l.falloffType!==void 0&&(a.falloffType=l.falloffType),l.lightmapMode!==void 0&&(a.lightmapMode=l.lightmapMode),l.animations){for(let s=0;s<l.animations.length;s++){const d=l.animations[s],i=Gt("BABYLON.Animation");i&&a.animations.push(i.Parse(d))}Bl.ParseAnimationRanges(a,l,e)}return l.autoAnimate&&e.beginAnimation(a,l.autoAnimateFrom,l.autoAnimateTo,l.autoAnimateLoop,l.autoAnimateSpeed||1),l.isEnabled!==void 0&&a.setEnabled(l.isEnabled),a}_hookArrayForExcluded(l){const e=l.push;l.push=(...a)=>{const s=e.apply(l,a);for(const d of a)d._resyncLightSource(this);return s};const t=l.splice;l.splice=(a,s)=>{const d=t.apply(l,[a,s]);for(const i of d)i._resyncLightSource(this);return d};for(const a of l)a._resyncLightSource(this)}_hookArrayForIncludedOnly(l){const e=l.push;l.push=(...a)=>{const s=e.apply(l,a);return this._resyncMeshes(),s};const t=l.splice;l.splice=(a,s)=>{const d=t.apply(l,[a,s]);return this._resyncMeshes(),d},this._resyncMeshes()}_resyncMeshes(){for(const l of this.getScene().meshes)l._resyncLightSource(this)}_markMeshesAsLightDirty(){for(const l of this.getScene().meshes)l.lightSources.indexOf(this)!==-1&&l._markSubMeshesAsLightDirty()}_computePhotometricScale(){this._photometricScale=this._getPhotometricScale(),this.getScene().resetCachedMaterial()}_getPhotometricScale(){let l=0;const e=this.getTypeID();let t=this.intensityMode;switch(t===nl.INTENSITYMODE_AUTOMATIC&&(e===nl.LIGHTTYPEID_DIRECTIONALLIGHT?t=nl.INTENSITYMODE_ILLUMINANCE:t=nl.INTENSITYMODE_LUMINOUSINTENSITY),e){case nl.LIGHTTYPEID_POINTLIGHT:case nl.LIGHTTYPEID_SPOTLIGHT:switch(t){case nl.INTENSITYMODE_LUMINOUSPOWER:l=1/(4*Math.PI);break;case nl.INTENSITYMODE_LUMINOUSINTENSITY:l=1;break;case nl.INTENSITYMODE_LUMINANCE:l=this.radius*this.radius;break}break;case nl.LIGHTTYPEID_DIRECTIONALLIGHT:switch(t){case nl.INTENSITYMODE_ILLUMINANCE:l=1;break;case nl.INTENSITYMODE_LUMINANCE:{let a=this.radius;a=Math.max(a,.001),l=2*Math.PI*(1-Math.cos(a));break}}break;case nl.LIGHTTYPEID_HEMISPHERICLIGHT:l=1;break}return l}_reorderLightsInScene(){const l=this.getScene();this._renderPriority!=0&&(l.requireLightSorting=!0),this.getScene().sortLightsByPriority()}}nl.FALLOFF_DEFAULT=Vl.FALLOFF_DEFAULT;nl.FALLOFF_PHYSICAL=Vl.FALLOFF_PHYSICAL;nl.FALLOFF_GLTF=Vl.FALLOFF_GLTF;nl.FALLOFF_STANDARD=Vl.FALLOFF_STANDARD;nl.LIGHTMAP_DEFAULT=Vl.LIGHTMAP_DEFAULT;nl.LIGHTMAP_SPECULAR=Vl.LIGHTMAP_SPECULAR;nl.LIGHTMAP_SHADOWSONLY=Vl.LIGHTMAP_SHADOWSONLY;nl.INTENSITYMODE_AUTOMATIC=Vl.INTENSITYMODE_AUTOMATIC;nl.INTENSITYMODE_LUMINOUSPOWER=Vl.INTENSITYMODE_LUMINOUSPOWER;nl.INTENSITYMODE_LUMINOUSINTENSITY=Vl.INTENSITYMODE_LUMINOUSINTENSITY;nl.INTENSITYMODE_ILLUMINANCE=Vl.INTENSITYMODE_ILLUMINANCE;nl.INTENSITYMODE_LUMINANCE=Vl.INTENSITYMODE_LUMINANCE;nl.LIGHTTYPEID_POINTLIGHT=Vl.LIGHTTYPEID_POINTLIGHT;nl.LIGHTTYPEID_DIRECTIONALLIGHT=Vl.LIGHTTYPEID_DIRECTIONALLIGHT;nl.LIGHTTYPEID_SPOTLIGHT=Vl.LIGHTTYPEID_SPOTLIGHT;nl.LIGHTTYPEID_HEMISPHERICLIGHT=Vl.LIGHTTYPEID_HEMISPHERICLIGHT;W([Rt()],nl.prototype,"diffuse",void 0);W([Rt()],nl.prototype,"specular",void 0);W([F()],nl.prototype,"falloffType",void 0);W([F()],nl.prototype,"intensity",void 0);W([F()],nl.prototype,"range",null);W([F()],nl.prototype,"intensityMode",null);W([F()],nl.prototype,"radius",null);W([F()],nl.prototype,"_renderPriority",void 0);W([pl("_reorderLightsInScene")],nl.prototype,"renderPriority",void 0);W([F("shadowEnabled")],nl.prototype,"_shadowEnabled",void 0);W([F("excludeWithLayerMask")],nl.prototype,"_excludeWithLayerMask",void 0);W([F("includeOnlyWithLayerMask")],nl.prototype,"_includeOnlyWithLayerMask",void 0);W([F("lightmapMode")],nl.prototype,"_lightmapMode",void 0);class Ot extends nl{constructor(){super(...arguments),this._needProjectionMatrixCompute=!0}_setPosition(l){this._position=l}get position(){return this._position}set position(l){this._setPosition(l)}_setDirection(l){this._direction=l}get direction(){return this._direction}set direction(l){this._setDirection(l)}get shadowMinZ(){return this._shadowMinZ}set shadowMinZ(l){this._shadowMinZ=l,this.forceProjectionMatrixCompute()}get shadowMaxZ(){return this._shadowMaxZ}set shadowMaxZ(l){this._shadowMaxZ=l,this.forceProjectionMatrixCompute()}computeTransformedInformation(){return this.parent&&this.parent.getWorldMatrix?(this.transformedPosition||(this.transformedPosition=r.Zero()),r.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),this.direction&&(this.transformedDirection||(this.transformedDirection=r.Zero()),r.TransformNormalToRef(this.direction,this.parent.getWorldMatrix(),this.transformedDirection)),!0):!1}getDepthScale(){return 50}getShadowDirection(l){return this.transformedDirection?this.transformedDirection:this.direction}getAbsolutePosition(){return this.transformedPosition?this.transformedPosition:this.position}setDirectionToTarget(l){return this.direction=r.Normalize(l.subtract(this.position)),this.direction}getRotation(){this.direction.normalize();const l=r.Cross(this.direction,Vt.Y),e=r.Cross(l,this.direction);return r.RotationFromAxis(l,e,this.direction)}needCube(){return!1}needProjectionMatrixCompute(){return this._needProjectionMatrixCompute}forceProjectionMatrixCompute(){this._needProjectionMatrixCompute=!0}_initCache(){super._initCache(),this._cache.position=r.Zero()}_isSynchronized(){return!!this._cache.position.equals(this.position)}computeWorldMatrix(l){return!l&&this.isSynchronized()?(this._currentRenderId=this.getScene().getRenderId(),this._worldMatrix):(this._updateCache(),this._cache.position.copyFrom(this.position),this._worldMatrix||(this._worldMatrix=Y.Identity()),Y.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this.parent&&this.parent.getWorldMatrix&&(this._worldMatrix.multiplyToRef(this.parent.getWorldMatrix(),this._worldMatrix),this._markSyncedWithParent()),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix)}getDepthMinZ(l){return this.shadowMinZ!==void 0?this.shadowMinZ:l.minZ}getDepthMaxZ(l){return this.shadowMaxZ!==void 0?this.shadowMaxZ:l.maxZ}setShadowProjectionMatrix(l,e,t){return this.customProjectionMatrixBuilder?this.customProjectionMatrixBuilder(e,t,l):this._setDefaultShadowProjectionMatrix(l,e,t),this}_syncParentEnabledState(){super._syncParentEnabledState(),(!this.parent||!this.parent.getWorldMatrix)&&(this.transformedPosition=null,this.transformedDirection=null)}}W([_e()],Ot.prototype,"position",null);W([_e()],Ot.prototype,"direction",null);W([F()],Ot.prototype,"shadowMinZ",null);W([F()],Ot.prototype,"shadowMaxZ",null);Bl.AddNodeConstructor("Light_Type_1",(Z,l)=>()=>new Me(Z,r.Zero(),l));class Me extends Ot{constructor(l,e,t){super(l,t),this._shadowFrustumSize=0,this._shadowOrthoScale=.1,this.autoUpdateExtends=!0,this.autoCalcShadowZBounds=!1,this._orthoLeft=Number.MAX_VALUE,this._orthoRight=Number.MIN_VALUE,this._orthoTop=Number.MIN_VALUE,this._orthoBottom=Number.MAX_VALUE,this.position=e.scale(-1),this.direction=e}get shadowFrustumSize(){return this._shadowFrustumSize}set shadowFrustumSize(l){this._shadowFrustumSize=l,this.forceProjectionMatrixCompute()}get shadowOrthoScale(){return this._shadowOrthoScale}set shadowOrthoScale(l){this._shadowOrthoScale=l,this.forceProjectionMatrixCompute()}get orthoLeft(){return this._orthoLeft}set orthoLeft(l){this._orthoLeft=l}get orthoRight(){return this._orthoRight}set orthoRight(l){this._orthoRight=l}get orthoTop(){return this._orthoTop}set orthoTop(l){this._orthoTop=l}get orthoBottom(){return this._orthoBottom}set orthoBottom(l){this._orthoBottom=l}getClassName(){return"DirectionalLight"}getTypeID(){return nl.LIGHTTYPEID_DIRECTIONALLIGHT}_setDefaultShadowProjectionMatrix(l,e,t){this.shadowFrustumSize>0?this._setDefaultFixedFrustumShadowProjectionMatrix(l):this._setDefaultAutoExtendShadowProjectionMatrix(l,e,t)}_setDefaultFixedFrustumShadowProjectionMatrix(l){const e=this.getScene().activeCamera;e&&Y.OrthoLHToRef(this.shadowFrustumSize,this.shadowFrustumSize,this.shadowMinZ!==void 0?this.shadowMinZ:e.minZ,this.shadowMaxZ!==void 0?this.shadowMaxZ:e.maxZ,l,this.getScene().getEngine().isNDCHalfZRange)}_setDefaultAutoExtendShadowProjectionMatrix(l,e,t){const a=this.getScene().activeCamera;if(!a)return;if(this.autoUpdateExtends||this._orthoLeft===Number.MAX_VALUE){const h=r.Zero();this._orthoLeft=Number.MAX_VALUE,this._orthoRight=Number.MIN_VALUE,this._orthoTop=Number.MIN_VALUE,this._orthoBottom=Number.MAX_VALUE;let m=Number.MAX_VALUE,o=Number.MIN_VALUE;for(let b=0;b<t.length;b++){const u=t[b];if(!u)continue;const V=u.getBoundingInfo().boundingBox;for(let G=0;G<V.vectorsWorld.length;G++)r.TransformCoordinatesToRef(V.vectorsWorld[G],e,h),h.x<this._orthoLeft&&(this._orthoLeft=h.x),h.y<this._orthoBottom&&(this._orthoBottom=h.y),h.x>this._orthoRight&&(this._orthoRight=h.x),h.y>this._orthoTop&&(this._orthoTop=h.y),this.autoCalcShadowZBounds&&(h.z<m&&(m=h.z),h.z>o&&(o=h.z))}this.autoCalcShadowZBounds&&(this._shadowMinZ=m,this._shadowMaxZ=o)}const s=this._orthoRight-this._orthoLeft,d=this._orthoTop-this._orthoBottom,i=this.shadowMinZ!==void 0?this.shadowMinZ:a.minZ,c=this.shadowMaxZ!==void 0?this.shadowMaxZ:a.maxZ,n=this.getScene().getEngine().useReverseDepthBuffer;Y.OrthoOffCenterLHToRef(this._orthoLeft-s*this.shadowOrthoScale,this._orthoRight+s*this.shadowOrthoScale,this._orthoBottom-d*this.shadowOrthoScale,this._orthoTop+d*this.shadowOrthoScale,n?c:i,n?i:c,l,this.getScene().getEngine().isNDCHalfZRange)}_buildUniformLayout(){this._uniformBuffer.addUniform("vLightData",4),this._uniformBuffer.addUniform("vLightDiffuse",4),this._uniformBuffer.addUniform("vLightSpecular",4),this._uniformBuffer.addUniform("shadowsInfo",3),this._uniformBuffer.addUniform("depthValues",2),this._uniformBuffer.create()}transferToEffect(l,e){return this.computeTransformedInformation()?(this._uniformBuffer.updateFloat4("vLightData",this.transformedDirection.x,this.transformedDirection.y,this.transformedDirection.z,1,e),this):(this._uniformBuffer.updateFloat4("vLightData",this.direction.x,this.direction.y,this.direction.z,1,e),this)}transferToNodeMaterialEffect(l,e){return this.computeTransformedInformation()?(l.setFloat3(e,this.transformedDirection.x,this.transformedDirection.y,this.transformedDirection.z),this):(l.setFloat3(e,this.direction.x,this.direction.y,this.direction.z),this)}getDepthMinZ(l){const e=this._scene.getEngine();return!e.useReverseDepthBuffer&&e.isNDCHalfZRange?0:1}getDepthMaxZ(l){const e=this._scene.getEngine();return e.useReverseDepthBuffer&&e.isNDCHalfZRange?0:1}prepareLightSpecificDefines(l,e){l["DIRLIGHT"+e]=!0}}W([F()],Me.prototype,"shadowFrustumSize",null);W([F()],Me.prototype,"shadowOrthoScale",null);W([F()],Me.prototype,"autoUpdateExtends",void 0);W([F()],Me.prototype,"autoCalcShadowZBounds",void 0);W([F("orthoLeft")],Me.prototype,"_orthoLeft",void 0);W([F("orthoRight")],Me.prototype,"_orthoRight",void 0);W([F("orthoTop")],Me.prototype,"_orthoTop",void 0);W([F("orthoBottom")],Me.prototype,"_orthoBottom",void 0);Bl.AddNodeConstructor("Light_Type_3",(Z,l)=>()=>new fa(Z,r.Zero(),l));class fa extends nl{constructor(l,e,t){super(l,t),this.groundColor=new al(0,0,0),this.direction=e||r.Up()}_buildUniformLayout(){this._uniformBuffer.addUniform("vLightData",4),this._uniformBuffer.addUniform("vLightDiffuse",4),this._uniformBuffer.addUniform("vLightSpecular",4),this._uniformBuffer.addUniform("vLightGround",3),this._uniformBuffer.addUniform("shadowsInfo",3),this._uniformBuffer.addUniform("depthValues",2),this._uniformBuffer.create()}getClassName(){return"HemisphericLight"}setDirectionToTarget(l){return this.direction=r.Normalize(l.subtract(r.Zero())),this.direction}getShadowGenerator(){return null}transferToEffect(l,e){const t=r.Normalize(this.direction);return this._uniformBuffer.updateFloat4("vLightData",t.x,t.y,t.z,0,e),this._uniformBuffer.updateColor3("vLightGround",this.groundColor.scale(this.intensity),e),this}transferToNodeMaterialEffect(l,e){const t=r.Normalize(this.direction);return l.setFloat3(e,t.x,t.y,t.z),this}computeWorldMatrix(){return this._worldMatrix||(this._worldMatrix=Y.Identity()),this._worldMatrix}getTypeID(){return nl.LIGHTTYPEID_HEMISPHERICLIGHT}prepareLightSpecificDefines(l,e){l["HEMILIGHT"+e]=!0}}W([Rt()],fa.prototype,"groundColor",void 0);W([_e()],fa.prototype,"direction",void 0);class Ee{constructor(l,e){this.width=l,this.height=e}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let l=this.width|0;return l=l*397^(this.height|0),l}copyFrom(l){this.width=l.width,this.height=l.height}copyFromFloats(l,e){return this.width=l,this.height=e,this}set(l,e){return this.copyFromFloats(l,e)}multiplyByFloats(l,e){return new Ee(this.width*l,this.height*e)}clone(){return new Ee(this.width,this.height)}equals(l){return l?this.width===l.width&&this.height===l.height:!1}get surface(){return this.width*this.height}static Zero(){return new Ee(0,0)}add(l){return new Ee(this.width+l.width,this.height+l.height)}subtract(l){return new Ee(this.width-l.width,this.height-l.height)}static Lerp(l,e,t){const a=l.width+(e.width-l.width)*t,s=l.height+(e.height-l.height)*t;return new Ee(a,s)}}class sc{constructor(l){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=Ee.Zero(),this._cachedBaseSize=Ee.Zero(),this._initialSamplingMode=2,this._texture=l,this._texture&&(this._engine=this._texture.getEngine())}get wrapU(){return this._wrapU}set wrapU(l){this._wrapU=l}get wrapV(){return this._wrapV}set wrapV(l){this._wrapV=l}get coordinatesMode(){return 0}get isCube(){return this._texture?this._texture.isCube:!1}set isCube(l){this._texture&&(this._texture.isCube=l)}get is3D(){return this._texture?this._texture.is3D:!1}set is3D(l){this._texture&&(this._texture.is3D=l)}get is2DArray(){return this._texture?this._texture.is2DArray:!1}set is2DArray(l){this._texture&&(this._texture.is2DArray=l)}getClassName(){return"ThinTexture"}isReady(){return this.delayLoadState===4?(this.delayLoad(),!1):this._texture?this._texture.isReady:!1}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return!this.isReady()||!this._texture?(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize):this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(l){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(l,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}class Nl extends sc{constructor(l,e=null){super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=Nl.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=new Array,this.onDisposeObservable=new z,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,l?Nl._IsScene(l)?this._scene=l:this._engine=l:this._scene=bl.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=e,this._uid=null}set hasAlpha(l){this._hasAlpha!==l&&(this._hasAlpha=l,this._scene&&this._scene.markAllMaterialsAsDirty(1,e=>e.hasTexture(this)))}get hasAlpha(){return this._hasAlpha}set getAlphaFromRGB(l){this._getAlphaFromRGB!==l&&(this._getAlphaFromRGB=l,this._scene&&this._scene.markAllMaterialsAsDirty(1,e=>e.hasTexture(this)))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(l){this._coordinatesIndex!==l&&(this._coordinatesIndex=l,this._scene&&this._scene.markAllMaterialsAsDirty(1,e=>e.hasTexture(this)))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(l){this._coordinatesMode!==l&&(this._coordinatesMode=l,this._scene&&this._scene.markAllMaterialsAsDirty(1,e=>e.hasTexture(this)))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(l){this._wrapU=l}get wrapV(){return this._wrapV}set wrapV(l){this._wrapV=l}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(l){this._texture?this._texture.isCube=l:this._isCube=l}get is3D(){return this._texture?this._texture.is3D:!1}set is3D(l){this._texture&&(this._texture.is3D=l)}get is2DArray(){return this._texture?this._texture.is2DArray:!1}set is2DArray(l){this._texture&&(this._texture.is2DArray=l)}get gammaSpace(){if(this._texture)this._texture._gammaSpace===null&&(this._texture._gammaSpace=this._gammaSpace);else return this._gammaSpace;return this._texture._gammaSpace&&!this._texture._useSRGBBuffer}set gammaSpace(l){if(this._texture){if(this._texture._gammaSpace===l)return;this._texture._gammaSpace=l}else{if(this._gammaSpace===l)return;this._gammaSpace=l}this._markAllSubMeshesAsTexturesDirty()}get isRGBD(){return this._texture!=null&&this._texture._isRGBD}set isRGBD(l){this._texture&&(this._texture._isRGBD=l)}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(l){this._texture&&(this._texture._lodGenerationOffset=l)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(l){this._texture&&(this._texture._lodGenerationScale=l)}get linearSpecularLOD(){return this._texture?this._texture._linearSpecularLOD:!1}set linearSpecularLOD(l){this._texture&&(this._texture._linearSpecularLOD=l)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(l){this._texture&&(this._texture._irradianceTexture=l)}get uid(){return this._uid||(this._uid=Wd()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(l){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(l)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}getScene(){return this._scene}_getEngine(){return this._engine}checkTransformsAreIdentical(l){return l!==null}getTextureMatrix(){return Y.IdentityReadOnly}getReflectionTextureMatrix(){return Y.IdentityReadOnly}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(l){}get canRescale(){return!1}_getFromCache(l,e,t,a,s,d){const i=this._getEngine();if(!i)return null;const c=i._getUseSRGBBuffer(!!s,e),n=i.getLoadedTexturesCache();for(let h=0;h<n.length;h++){const m=n[h];if((s===void 0||c===m._useSRGBBuffer)&&(a===void 0||a===m.invertY)&&m.url===l&&m.generateMipMaps===!e&&(!t||t===m.samplingMode)&&(d===void 0||d===m.isCube))return m.incrementReferences(),m}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&this._texture.type!==void 0?this._texture.type:0}get textureFormat(){return this._texture&&this._texture.format!==void 0?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const l=this.getScene();l&&l.markAllMaterialsAsDirty(1)}readPixels(l=0,e=0,t=null,a=!0,s=!1,d=0,i=0,c=Number.MAX_VALUE,n=Number.MAX_VALUE){if(!this._texture)return null;const h=this._getEngine();if(!h)return null;const m=this.getSize();let o=m.width,b=m.height;e!==0&&(o=o/Math.pow(2,e),b=b/Math.pow(2,e),o=Math.round(o),b=Math.round(b)),c=Math.min(o,c),n=Math.min(b,n);try{return this._texture.isCube?h._readTexturePixels(this._texture,c,n,l,e,t,a,s,d,i):h._readTexturePixels(this._texture,c,n,-1,e,t,a,s,d,i)}catch{return null}}_readPixelsSync(l=0,e=0,t=null,a=!0,s=!1){if(!this._texture)return null;const d=this.getSize();let i=d.width,c=d.height;const n=this._getEngine();if(!n)return null;e!=0&&(i=i/Math.pow(2,e),c=c/Math.pow(2,e),i=Math.round(i),c=Math.round(c));try{return this._texture.isCube?n._readTexturePixelsSync(this._texture,i,c,l,e,t,a,s):n._readTexturePixelsSync(this._texture,i,c,-1,e,t,a,s)}catch{return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const l=this._scene.textures.indexOf(this);if(l>=0&&this._scene.textures.splice(l,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const e=this._parentContainer.textures.indexOf(this);e>-1&&this._parentContainer.textures.splice(e,1),this._parentContainer=null}}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.metadata=null,super.dispose()}serialize(l=!1){if(!this.name&&!l)return null;const e=il.Serialize(this);return il.AppendSerializedAnimations(this,e),e}static WhenAllReady(l,e){let t=l.length;if(t===0){e();return}for(let a=0;a<l.length;a++){const s=l[a];if(s.isReady())--t===0&&e();else{const d=s.onLoadObservable;d?d.addOnce(()=>{--t===0&&e()}):--t===0&&e()}}}static _IsScene(l){return l.getClassName()==="Scene"}}Nl.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4;W([F()],Nl.prototype,"uniqueId",void 0);W([F()],Nl.prototype,"name",void 0);W([F()],Nl.prototype,"metadata",void 0);W([F("hasAlpha")],Nl.prototype,"_hasAlpha",void 0);W([F("getAlphaFromRGB")],Nl.prototype,"_getAlphaFromRGB",void 0);W([F()],Nl.prototype,"level",void 0);W([F("coordinatesIndex")],Nl.prototype,"_coordinatesIndex",void 0);W([F()],Nl.prototype,"optimizeUVAllocation",void 0);W([F("coordinatesMode")],Nl.prototype,"_coordinatesMode",void 0);W([F()],Nl.prototype,"wrapU",null);W([F()],Nl.prototype,"wrapV",null);W([F()],Nl.prototype,"wrapR",void 0);W([F()],Nl.prototype,"anisotropicFilteringLevel",void 0);W([F()],Nl.prototype,"isCube",null);W([F()],Nl.prototype,"is3D",null);W([F()],Nl.prototype,"is2DArray",null);W([F()],Nl.prototype,"gammaSpace",null);W([F()],Nl.prototype,"invertZ",void 0);W([F()],Nl.prototype,"lodLevelInAlpha",void 0);W([F()],Nl.prototype,"lodGenerationOffset",null);W([F()],Nl.prototype,"lodGenerationScale",null);W([F()],Nl.prototype,"linearSpecularLOD",null);W([ye()],Nl.prototype,"irradianceTexture",null);W([F()],Nl.prototype,"isRenderTarget",void 0);function Sd(Z,l,e=!1){const t=l.width,a=l.height;if(Z instanceof Float32Array){let c=Z.byteLength/Z.BYTES_PER_ELEMENT;const n=new Uint8Array(c);for(;--c>=0;){let h=Z[c];h<0?h=0:h>1&&(h=1),n[c]=h*255}Z=n}const s=document.createElement("canvas");s.width=t,s.height=a;const d=s.getContext("2d");if(!d)return null;const i=d.createImageData(t,a);if(i.data.set(Z),d.putImageData(i,0,0),e){const c=document.createElement("canvas");c.width=t,c.height=a;const n=c.getContext("2d");return n?(n.translate(0,a),n.scale(1,-1),n.drawImage(s,0,0),c.toDataURL("image/png")):null}return s.toDataURL("image/png")}function dc(Z,l=0,e=0){const t=Z.getInternalTexture();if(!t)return null;const a=Z._readPixelsSync(l,e);return a?Sd(a,Z.getSize(),t.invertY):null}async function ic(Z,l=0,e=0){const t=Z.getInternalTexture();if(!t)return null;const a=await Z.readPixels(l,e);return a?Sd(a,Z.getSize(),t.invertY):null}class v extends Nl{constructor(l,e,t,a,s=v.TRILINEAR_SAMPLINGMODE,d=null,i=null,c=null,n=!1,h,m,o,b,u){var V,G,p,y,L,N,J,R,S;super(e),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new z,this._isBlocking=!0,this.name=l||"",this.url=l;let T,k=!1,g=null;typeof t=="object"&&t!==null?(T=(V=t.noMipmap)!==null&&V!==void 0?V:!1,a=(G=t.invertY)!==null&&G!==void 0?G:!Xe.UseOpenGLOrientationForUV,s=(p=t.samplingMode)!==null&&p!==void 0?p:v.TRILINEAR_SAMPLINGMODE,d=(y=t.onLoad)!==null&&y!==void 0?y:null,i=(L=t.onError)!==null&&L!==void 0?L:null,c=(N=t.buffer)!==null&&N!==void 0?N:null,n=(J=t.deleteBuffer)!==null&&J!==void 0?J:!1,h=t.format,m=t.mimeType,o=t.loaderOptions,b=t.creationFlags,k=(R=t.useSRGBBuffer)!==null&&R!==void 0?R:!1,g=(S=t.internalTexture)!==null&&S!==void 0?S:null):T=!!t,this._noMipmap=T,this._invertY=a===void 0?!Xe.UseOpenGLOrientationForUV:a,this._initialSamplingMode=s,this._buffer=c,this._deleteBuffer=n,this._mimeType=m,this._loaderOptions=o,this._creationFlags=b,this._useSRGBBuffer=k,this._forcedExtension=u,h&&(this._format=h);const ll=this.getScene(),ol=this._getEngine();if(!ol)return;ol.onBeforeTextureInitObservable.notifyObservers(this);const ml=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),this._texture._cachedWrapU!==null&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),this._texture._cachedWrapV!==null&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),this._texture._cachedWrapR!==null&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),d&&d(),!this.isBlocking&&ll&&ll.resetCachedMaterial()},el=(Jl,xl)=>{this._loadingError=!0,this._errorObject={message:Jl,exception:xl},i&&i(Jl,xl),v.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!g){this._delayedOnLoad=ml,this._delayedOnError=el;return}if(this._texture=g??this._getFromCache(this.url,T,s,this._invertY,k),this._texture)if(this._texture.isReady)Va.SetImmediate(()=>ml());else{const Jl=this._texture.onLoadedObservable.add(ml);this._texture.onErrorObservable.add(xl=>{var zl;el(xl.message,xl.exception),(zl=this._texture)===null||zl===void 0||zl.onLoadedObservable.remove(Jl)})}else if(!ll||!ll.useDelayedTextureLoading){try{this._texture=ol.createTexture(this.url,T,this._invertY,ll,s,ml,el,this._buffer,void 0,this._format,this._forcedExtension,m,o,b,k)}catch(Jl){throw el("error loading",Jl),Jl}n&&(this._buffer=null)}else this.delayLoadState=4,this._delayedOnLoad=ml,this._delayedOnError=el}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(l){this._isBlocking=l}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}updateURL(l,e=null,t,a){this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1)),(!this.name||this.name.startsWith("data:"))&&(this.name=l),this.url=l,this._buffer=e,this._forcedExtension=a,this.delayLoadState=4,t&&(this._delayedOnLoad=t),this.delayLoad()}delayLoad(){if(this.delayLoadState!==4)return;const l=this.getScene();l&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer),this._texture?this._delayedOnLoad&&(this._texture.isReady?Va.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=l.getEngine().createTexture(this.url,this._noMipmap,this._invertY,l,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(l,e,t,a){l*=this._cachedUScale,e*=this._cachedVScale,l-=this.uRotationCenter*this._cachedUScale,e-=this.vRotationCenter*this._cachedVScale,t-=this.wRotationCenter,r.TransformCoordinatesFromFloatsToRef(l,e,t,this._rowGenerationMatrix,a),a.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,a.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,a.z+=this.wRotationCenter}checkTransformsAreIdentical(l){return l!==null&&this.uOffset===l.uOffset&&this.vOffset===l.vOffset&&this.uScale===l.uScale&&this.vScale===l.vScale&&this.uAng===l.uAng&&this.vAng===l.vAng&&this.wAng===l.wAng}getTextureMatrix(l=1){if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*l===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*l,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,(!this._cachedTextureMatrix||!this._rowGenerationMatrix)&&(this._cachedTextureMatrix=Y.Zero(),this._rowGenerationMatrix=new Y,this._t0=r.Zero(),this._t1=r.Zero(),this._t2=r.Zero()),Y.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(Y.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,f.Matrix[0]),Y.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,f.Matrix[1]),Y.ScalingToRef(this._cachedUScale,this._cachedVScale,0,f.Matrix[2]),Y.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,f.Matrix[3]),f.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(f.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(f.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(f.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),Y.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const e=this.getScene();return e?(this.optimizeUVAllocation&&e.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)),this._cachedTextureMatrix):this._cachedTextureMatrix}getReflectionTextureMatrix(){const l=this.getScene();if(!l)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode)if(this.coordinatesMode===v.PROJECTION_MODE){if(this._cachedReflectionProjectionMatrixId===l.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}else return this._cachedReflectionTextureMatrix;this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=Y.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=Y.Zero());const e=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case v.PLANAR_MODE:{Y.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break}case v.PROJECTION_MODE:{Y.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const t=l.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=t.updateFlag,t.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:Y.IdentityToRef(this._cachedReflectionTextureMatrix);break}return e&&l.markAllMaterialsAsDirty(1,t=>t.getActiveTextures().indexOf(this)!==-1),this._cachedReflectionTextureMatrix}clone(){const l={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,onLoad:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return il.Clone(()=>new v(this._texture?this._texture.url:null,this.getScene(),l),this)}serialize(){var l,e;const t=this.name;v.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const a=super.serialize(v._SerializeInternalTextureUniqueId);return a?((v.SerializeBuffers||v.ForceSerializeBuffers)&&(typeof this._buffer=="string"&&this._buffer.substr(0,5)==="data:"?(a.base64String=this._buffer,a.name=a.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?a.base64String="data:image/png;base64,"+Xd(this._buffer):(v.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(a.base64String=!this._engine||this._engine._features.supportSyncTextureRead?dc(this):ic(this))),a.invertY=this._invertY,a.samplingMode=this.samplingMode,a._creationFlags=this._creationFlags,a._useSRGBBuffer=this._useSRGBBuffer,v._SerializeInternalTextureUniqueId&&(a.internalTextureUniqueId=(e=(l=this._texture)===null||l===void 0?void 0:l.uniqueId)!==null&&e!==void 0?e:void 0),this.name=t,a):null}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(l,e,t){if(l.customType){const i=Bt.Instantiate(l.customType).Parse(l,e,t);return l.samplingMode&&i.updateSamplingMode&&i._samplingMode&&i._samplingMode!==l.samplingMode&&i.updateSamplingMode(l.samplingMode),i}if(l.isCube&&!l.isRenderTarget)return v._CubeTextureParser(l,e,t);const a=l.internalTextureUniqueId!==void 0;if(!l.name&&!l.isRenderTarget&&!a)return null;let s;if(a){const i=e.getEngine().getLoadedTexturesCache();for(const c of i)if(c.uniqueId===l.internalTextureUniqueId){s=c;break}}const d=i=>{var c;if(i&&i._texture&&(i._texture._cachedWrapU=null,i._texture._cachedWrapV=null,i._texture._cachedWrapR=null),l.samplingMode){const n=l.samplingMode;i&&i.samplingMode!==n&&i.updateSamplingMode(n)}if(i&&l.animations)for(let n=0;n<l.animations.length;n++){const h=l.animations[n],m=Gt("BABYLON.Animation");m&&i.animations.push(m.Parse(h))}a&&!s&&((c=i==null?void 0:i._texture)===null||c===void 0||c._setUniqueId(l.internalTextureUniqueId))};return il.Parse(()=>{var i,c,n;let h=!0;if(l.noMipmap&&(h=!1),l.mirrorPlane){const m=v._CreateMirror(l.name,l.renderTargetSize,e,h);return m._waitingRenderList=l.renderList,m.mirrorPlane=Se.FromArray(l.mirrorPlane),d(m),m}else if(l.isRenderTarget){let m=null;if(l.isCube){if(e.reflectionProbes)for(let o=0;o<e.reflectionProbes.length;o++){const b=e.reflectionProbes[o];if(b.name===l.name)return b.cubeTexture}}else m=v._CreateRenderTargetTexture(l.name,l.renderTargetSize,e,h,(i=l._creationFlags)!==null&&i!==void 0?i:0),m._waitingRenderList=l.renderList;return d(m),m}else{let m;if(l.base64String&&!s)m=v.CreateFromBase64String(l.base64String,l.base64String,e,!h,l.invertY,l.samplingMode,()=>{d(m)},(c=l._creationFlags)!==null&&c!==void 0?c:0,(n=l._useSRGBBuffer)!==null&&n!==void 0?n:!1),m.name=l.name;else{let o;l.name&&l.name.indexOf("://")>0?o=l.name:o=t+l.name,l.url&&(l.url.startsWith("data:")||v.UseSerializedUrlIfAny)&&(o=l.url);const b={noMipmap:!h,invertY:l.invertY,samplingMode:l.samplingMode,onLoad:()=>{d(m)},internalTexture:s};m=new v(o,e,b)}return m}},l,e)}static CreateFromBase64String(l,e,t,a,s,d=v.TRILINEAR_SAMPLINGMODE,i=null,c=null,n=5,h){return new v("data:"+e,t,a,s,d,i,c,l,!1,n,void 0,void 0,h)}static LoadFromDataString(l,e,t,a=!1,s,d=!0,i=v.TRILINEAR_SAMPLINGMODE,c=null,n=null,h=5,m){return l.substr(0,5)!=="data:"&&(l="data:"+l),new v(l,t,s,d,i,c,n,e,a,h,void 0,void 0,m)}}v.SerializeBuffers=!0;v.ForceSerializeBuffers=!1;v.OnTextureLoadErrorObservable=new z;v._SerializeInternalTextureUniqueId=!1;v._CubeTextureParser=(Z,l,e)=>{throw O("CubeTexture")};v._CreateMirror=(Z,l,e,t)=>{throw O("MirrorTexture")};v._CreateRenderTargetTexture=(Z,l,e,t,a)=>{throw O("RenderTargetTexture")};v.NEAREST_SAMPLINGMODE=1;v.NEAREST_NEAREST_MIPLINEAR=8;v.BILINEAR_SAMPLINGMODE=2;v.LINEAR_LINEAR_MIPNEAREST=11;v.TRILINEAR_SAMPLINGMODE=3;v.LINEAR_LINEAR_MIPLINEAR=3;v.NEAREST_NEAREST_MIPNEAREST=4;v.NEAREST_LINEAR_MIPNEAREST=5;v.NEAREST_LINEAR_MIPLINEAR=6;v.NEAREST_LINEAR=7;v.NEAREST_NEAREST=1;v.LINEAR_NEAREST_MIPNEAREST=9;v.LINEAR_NEAREST_MIPLINEAR=10;v.LINEAR_LINEAR=2;v.LINEAR_NEAREST=12;v.EXPLICIT_MODE=0;v.SPHERICAL_MODE=1;v.PLANAR_MODE=2;v.CUBIC_MODE=3;v.PROJECTION_MODE=4;v.SKYBOX_MODE=5;v.INVCUBIC_MODE=6;v.EQUIRECTANGULAR_MODE=7;v.FIXED_EQUIRECTANGULAR_MODE=8;v.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9;v.CLAMP_ADDRESSMODE=0;v.WRAP_ADDRESSMODE=1;v.MIRROR_ADDRESSMODE=2;v.UseSerializedUrlIfAny=!1;W([F()],v.prototype,"url",void 0);W([F()],v.prototype,"uOffset",void 0);W([F()],v.prototype,"vOffset",void 0);W([F()],v.prototype,"uScale",void 0);W([F()],v.prototype,"vScale",void 0);W([F()],v.prototype,"uAng",void 0);W([F()],v.prototype,"vAng",void 0);W([F()],v.prototype,"wAng",void 0);W([F()],v.prototype,"uRotationCenter",void 0);W([F()],v.prototype,"vRotationCenter",void 0);W([F()],v.prototype,"wRotationCenter",void 0);W([F()],v.prototype,"homogeneousRotationInUVTransform",void 0);W([F()],v.prototype,"isBlocking",null);ce("BABYLON.Texture",v);il._TextureParser=v.Parse;class cc{constructor(l,e,t,a){this._textures=null,this._samples=1,this._attachments=null,this._generateStencilBuffer=!1,this._generateDepthBuffer=!1,this._depthStencilTextureWithStencil=!1,this._isMulti=l,this._isCube=e,this._size=t,this._engine=a,this._depthStencilTexture=null}get depthStencilTexture(){return this._depthStencilTexture}get depthStencilTextureWithStencil(){return this._depthStencilTextureWithStencil}get isCube(){return this._isCube}get isMulti(){return this._isMulti}get is2DArray(){return this.layers>0}get size(){return this.width}get width(){return this._size.width||this._size}get height(){return this._size.height||this._size}get layers(){return this._size.layers||0}get texture(){var l,e;return(e=(l=this._textures)===null||l===void 0?void 0:l[0])!==null&&e!==void 0?e:null}get textures(){return this._textures}get samples(){return this._samples}setSamples(l,e=!0,t=!1){if(this.samples===l&&!t)return l;const a=this._isMulti?this._engine.updateMultipleRenderTargetTextureSampleCount(this,l,e):this._engine.updateRenderTargetTextureSampleCount(this,l);return this._samples=l,a}setTextures(l){Array.isArray(l)?this._textures=l:l?this._textures=[l]:this._textures=null}setTexture(l,e=0,t=!0){this._textures||(this._textures=[]),this._textures[e]&&t&&this._textures[e].dispose(),this._textures[e]=l}createDepthStencilTexture(l=0,e=!0,t=!1,a=1,s=14){var d;return(d=this._depthStencilTexture)===null||d===void 0||d.dispose(),this._depthStencilTextureWithStencil=t,this._depthStencilTexture=this._engine.createDepthStencilTexture(this._size,{bilinearFiltering:e,comparisonFunction:l,generateStencil:t,isCube:this._isCube,samples:a,depthTextureFormat:s},this),this._depthStencilTexture}_shareDepth(l){this._depthStencilTexture&&(l._depthStencilTexture&&l._depthStencilTexture.dispose(),l._depthStencilTexture=this._depthStencilTexture,this._depthStencilTexture.incrementReferences())}_swapAndDie(l){this.texture&&this.texture._swapAndDie(l),this._textures=null,this.dispose(!0)}_cloneRenderTargetWrapper(){var l,e,t,a,s,d;let i=null;if(this._isMulti){const c=this.textures;if(c&&c.length>0){let n=!1,h=c.length;const m=c[c.length-1]._source;(m===Cl.Depth||m===Cl.DepthStencil)&&(n=!0,h--);const o=[],b=[];for(let G=0;G<h;++G){const p=c[G];o.push(p.samplingMode),b.push(p.type)}const u={samplingModes:o,generateMipMaps:c[0].generateMipMaps,generateDepthBuffer:this._generateDepthBuffer,generateStencilBuffer:this._generateStencilBuffer,generateDepthTexture:n,types:b,textureCount:h},V={width:this.width,height:this.height};i=this._engine.createMultipleRenderTarget(V,u)}}else{const c={};if(c.generateDepthBuffer=this._generateDepthBuffer,c.generateMipMaps=(e=(l=this.texture)===null||l===void 0?void 0:l.generateMipMaps)!==null&&e!==void 0?e:!1,c.generateStencilBuffer=this._generateStencilBuffer,c.samplingMode=(t=this.texture)===null||t===void 0?void 0:t.samplingMode,c.type=(a=this.texture)===null||a===void 0?void 0:a.type,c.format=(s=this.texture)===null||s===void 0?void 0:s.format,this.isCube)i=this._engine.createRenderTargetCubeTexture(this.width,c);else{const n={width:this.width,height:this.height,layers:this.is2DArray?(d=this.texture)===null||d===void 0?void 0:d.depth:void 0};i=this._engine.createRenderTargetTexture(n,c)}i.texture.isReady=!0}return i}_swapRenderTargetWrapper(l){if(this._textures&&l._textures)for(let e=0;e<this._textures.length;++e)this._textures[e]._swapAndDie(l._textures[e],!1),l._textures[e].isReady=!0;this._depthStencilTexture&&l._depthStencilTexture&&(this._depthStencilTexture._swapAndDie(l._depthStencilTexture),l._depthStencilTexture.isReady=!0),this._textures=null,this._depthStencilTexture=null}_rebuild(){const l=this._cloneRenderTargetWrapper();if(l){if(this._depthStencilTexture){const e=this._depthStencilTexture.samplingMode,t=e===2||e===3||e===11;l.createDepthStencilTexture(this._depthStencilTexture._comparisonFunction,t,this._depthStencilTextureWithStencil,this._depthStencilTexture.samples)}this.samples>1&&l.setSamples(this.samples),l._swapRenderTargetWrapper(this),l.dispose()}}releaseTextures(){var l,e;if(this._textures)for(let t=0;(e=t<((l=this._textures)===null||l===void 0?void 0:l.length))!==null&&e!==void 0&&e;++t)this._textures[t].dispose();this._textures=null}dispose(l=!1){var e;l||((e=this._depthStencilTexture)===null||e===void 0||e.dispose(),this._depthStencilTexture=null,this.releaseTextures()),this._engine._releaseRenderTargetWrapper(this)}}class nc extends cc{constructor(l,e,t,a,s){super(l,e,t,a),this._framebuffer=null,this._depthStencilBuffer=null,this._MSAAFramebuffer=null,this._colorTextureArray=null,this._depthStencilTextureArray=null,this._context=s}_cloneRenderTargetWrapper(){let l=null;return this._colorTextureArray&&this._depthStencilTextureArray?(l=this._engine.createMultiviewRenderTargetTexture(this.width,this.height),l.texture.isReady=!0):l=super._cloneRenderTargetWrapper(),l}_swapRenderTargetWrapper(l){super._swapRenderTargetWrapper(l),l._framebuffer=this._framebuffer,l._depthStencilBuffer=this._depthStencilBuffer,l._MSAAFramebuffer=this._MSAAFramebuffer,l._colorTextureArray=this._colorTextureArray,l._depthStencilTextureArray=this._depthStencilTextureArray,this._framebuffer=this._depthStencilBuffer=this._MSAAFramebuffer=this._colorTextureArray=this._depthStencilTextureArray=null}_shareDepth(l){super._shareDepth(l);const e=this._context,t=this._depthStencilBuffer,a=l._MSAAFramebuffer||l._framebuffer;l._depthStencilBuffer&&e.deleteRenderbuffer(l._depthStencilBuffer),l._depthStencilBuffer=this._depthStencilBuffer,this._engine._bindUnboundFramebuffer(a),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this._engine._bindUnboundFramebuffer(null)}_bindTextureRenderTarget(l,e=0,t=-1,a=0){if(!l._hardwareTexture)return;const s=this._context,d=this._framebuffer,i=this._engine._currentFramebuffer;this._engine._bindUnboundFramebuffer(d);const c=s[this._engine.webGLVersion>1?"COLOR_ATTACHMENT"+e:"COLOR_ATTACHMENT"+e+"_WEBGL"],n=t!==-1?s.TEXTURE_CUBE_MAP_POSITIVE_X+t:s.TEXTURE_2D;s.framebufferTexture2D(s.FRAMEBUFFER,c,n,l._hardwareTexture.underlyingResource,a),this._engine._bindUnboundFramebuffer(i)}setTexture(l,e=0,t=!0){super.setTexture(l,e,t),this._bindTextureRenderTarget(l,e)}dispose(l=!1){const e=this._context;l||(this._colorTextureArray&&(this._context.deleteTexture(this._colorTextureArray),this._colorTextureArray=null),this._depthStencilTextureArray&&(this._context.deleteTexture(this._depthStencilTextureArray),this._depthStencilTextureArray=null)),this._framebuffer&&(e.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._depthStencilBuffer&&(e.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null),this._MSAAFramebuffer&&(e.deleteFramebuffer(this._MSAAFramebuffer),this._MSAAFramebuffer=null),super.dispose(l)}}Zl.prototype._createHardwareRenderTargetWrapper=function(Z,l,e){const t=new nc(Z,l,e,this,this._gl);return this._renderTargetWrapperCache.push(t),t};Zl.prototype.createRenderTargetTexture=function(Z,l){var e,t;const a=this._createHardwareRenderTargetWrapper(!1,!1,Z);let s=!0,d=!1,i=!1,c,n=1;l!==void 0&&typeof l=="object"&&(s=(e=l.generateDepthBuffer)!==null&&e!==void 0?e:!0,d=!!l.generateStencilBuffer,i=!!l.noColorAttachment,c=l.colorAttachment,n=(t=l.samples)!==null&&t!==void 0?t:1);const h=c||(i?null:this._createInternalTexture(Z,l,!0,Cl.RenderTarget)),m=Z.width||Z,o=Z.height||Z,b=this._currentFramebuffer,u=this._gl,V=u.createFramebuffer();return this._bindUnboundFramebuffer(V),a._depthStencilBuffer=this._setupFramebufferDepthAttachments(d,s,m,o),h&&!h.is2DArray&&u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,h._hardwareTexture.underlyingResource,0),this._bindUnboundFramebuffer(b),a._framebuffer=V,a._generateDepthBuffer=s,a._generateStencilBuffer=d,a.setTextures(h),this.updateRenderTargetTextureSampleCount(a,n),a};Zl.prototype.createDepthStencilTexture=function(Z,l,e){if(l.isCube){const t=Z.width||Z;return this._createDepthStencilCubeTexture(t,l,e)}else return this._createDepthStencilTexture(Z,l,e)};Zl.prototype._createDepthStencilTexture=function(Z,l,e){const t=this._gl,a=Z.layers||0,s=a!==0?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D,d=new Qe(this,Cl.DepthStencil);if(!this._caps.depthTextureExtension)return M.Error("Depth texture is not supported by your browser or hardware."),d;const i={bilinearFiltering:!1,comparisonFunction:0,generateStencil:!1,...l};if(this._bindTextureDirectly(s,d,!0),this._setupDepthStencilTexture(d,Z,i.generateStencil,i.comparisonFunction===0?!1:i.bilinearFiltering,i.comparisonFunction,i.samples),i.depthTextureFormat!==void 0){if(i.depthTextureFormat!==15&&i.depthTextureFormat!==16&&i.depthTextureFormat!==17&&i.depthTextureFormat!==13&&i.depthTextureFormat!==14&&i.depthTextureFormat!==18)return M.Error("Depth texture format is not supported."),d;d.format=i.depthTextureFormat}else d.format=i.generateStencil?13:16;const c=d.format===17||d.format===13||d.format===18;e._depthStencilTexture=d,e._depthStencilTextureWithStencil=c;let n=t.UNSIGNED_INT;d.format===15?n=t.UNSIGNED_SHORT:d.format===17||d.format===13?n=t.UNSIGNED_INT_24_8:d.format===14?n=t.FLOAT:d.format===18&&(n=t.FLOAT_32_UNSIGNED_INT_24_8_REV);const h=c?t.DEPTH_STENCIL:t.DEPTH_COMPONENT;let m=h;this.webGLVersion>1&&(d.format===15?m=t.DEPTH_COMPONENT16:d.format===16?m=t.DEPTH_COMPONENT24:d.format===17||d.format===13?m=t.DEPTH24_STENCIL8:d.format===14?m=t.DEPTH_COMPONENT32F:d.format===18&&(m=t.DEPTH32F_STENCIL8)),d.is2DArray?t.texImage3D(s,0,m,d.width,d.height,a,0,h,n,null):t.texImage2D(s,0,m,d.width,d.height,0,h,n,null),this._bindTextureDirectly(s,null),this._internalTexturesCache.push(d);const o=e;if(o._depthStencilBuffer){const b=this._currentFramebuffer;this._bindUnboundFramebuffer(o._framebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,null),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,null),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.STENCIL_ATTACHMENT,t.RENDERBUFFER,null),this._bindUnboundFramebuffer(b),t.deleteRenderbuffer(o._depthStencilBuffer),o._depthStencilBuffer=null}return d};Zl.prototype.updateRenderTargetTextureSampleCount=function(Z,l){if(this.webGLVersion<2||!Z||!Z.texture)return 1;if(Z.samples===l)return l;const e=this._gl;l=Math.min(l,this.getCaps().maxMSAASamples),Z._depthStencilBuffer&&(e.deleteRenderbuffer(Z._depthStencilBuffer),Z._depthStencilBuffer=null),Z._MSAAFramebuffer&&(e.deleteFramebuffer(Z._MSAAFramebuffer),Z._MSAAFramebuffer=null);const t=Z.texture._hardwareTexture;if(t._MSAARenderBuffer&&(e.deleteRenderbuffer(t._MSAARenderBuffer),t._MSAARenderBuffer=null),l>1&&e.renderbufferStorageMultisample){const a=e.createFramebuffer();if(!a)throw new Error("Unable to create multi sampled framebuffer");Z._MSAAFramebuffer=a,this._bindUnboundFramebuffer(Z._MSAAFramebuffer);const s=this._createRenderBuffer(Z.texture.width,Z.texture.height,l,-1,this._getRGBAMultiSampleBufferFormat(Z.texture.type),e.COLOR_ATTACHMENT0,!1);if(!s)throw new Error("Unable to create multi sampled framebuffer");t._MSAARenderBuffer=s}else this._bindUnboundFramebuffer(Z._framebuffer);return Z.texture.samples=l,Z._samples=l,Z._depthStencilBuffer=this._setupFramebufferDepthAttachments(Z._generateStencilBuffer,Z._generateDepthBuffer,Z.texture.width,Z.texture.height,l),this._bindUnboundFramebuffer(null),l};Zl.prototype.createRenderTargetCubeTexture=function(Z,l){const e=this._createHardwareRenderTargetWrapper(!1,!0,Z),t={generateMipMaps:!0,generateDepthBuffer:!0,generateStencilBuffer:!1,type:0,samplingMode:3,format:5,...l};t.generateStencilBuffer=t.generateDepthBuffer&&t.generateStencilBuffer,(t.type===1&&!this._caps.textureFloatLinearFiltering||t.type===2&&!this._caps.textureHalfFloatLinearFiltering)&&(t.samplingMode=1);const a=this._gl,s=new Qe(this,Cl.RenderTarget);this._bindTextureDirectly(a.TEXTURE_CUBE_MAP,s,!0);const d=this._getSamplingParameters(t.samplingMode,t.generateMipMaps);t.type===1&&!this._caps.textureFloat&&(t.type=0,M.Warn("Float textures are not supported. Cube render target forced to TEXTURETYPE_UNESIGNED_BYTE type")),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,d.mag),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,d.min),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);for(let c=0;c<6;c++)a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+c,0,this._getRGBABufferInternalSizedFormat(t.type,t.format),Z,Z,0,this._getInternalFormat(t.format),this._getWebGLTextureType(t.type),null);const i=a.createFramebuffer();return this._bindUnboundFramebuffer(i),e._depthStencilBuffer=this._setupFramebufferDepthAttachments(t.generateStencilBuffer,t.generateDepthBuffer,Z,Z),t.generateMipMaps&&a.generateMipmap(a.TEXTURE_CUBE_MAP),this._bindTextureDirectly(a.TEXTURE_CUBE_MAP,null),this._bindUnboundFramebuffer(null),e._framebuffer=i,e._generateDepthBuffer=t.generateDepthBuffer,e._generateStencilBuffer=t.generateStencilBuffer,s.width=Z,s.height=Z,s.isReady=!0,s.isCube=!0,s.samples=1,s.generateMipMaps=t.generateMipMaps,s.samplingMode=t.samplingMode,s.type=t.type,s.format=t.format,this._internalTexturesCache.push(s),e.setTextures(s),e};const Zc="postprocessVertexShader",hc=`attribute vec2 position;
uniform vec2 scale;
varying vec2 vUV;
const vec2 madd=vec2(0.5,0.5);
#define CUSTOM_VERTEX_DEFINITIONS
void main(void) {
#define CUSTOM_VERTEX_MAIN_BEGIN
vUV=(position*madd+madd)*scale;
gl_Position=vec4(position,0.0,1.0);
#define CUSTOM_VERTEX_MAIN_END
}`;H.ShadersStore[Zc]=hc;const Oa={positions:[1,1,-1,1,-1,-1,1,-1],indices:[0,1,2,0,2,3]};class mc{constructor(l,e=Oa){var t,a;this._fullscreenViewport=new _t(0,0,1,1);const s=(t=e.positions)!==null&&t!==void 0?t:Oa.positions,d=(a=e.indices)!==null&&a!==void 0?a:Oa.indices;this.engine=l,this._vertexBuffers={[X.PositionKind]:new X(l,s,X.PositionKind,!1,!1,2)},this._indexBuffer=l.createIndexBuffer(d),this._onContextRestoredObserver=l.onContextRestoredObservable.add(()=>{this._indexBuffer=l.createIndexBuffer(d);for(const i in this._vertexBuffers)this._vertexBuffers[i]._rebuild()})}setViewport(l=this._fullscreenViewport){this.engine.setViewport(l)}bindBuffers(l){this.engine.bindBuffers(this._vertexBuffers,this._indexBuffer,l)}applyEffectWrapper(l){this.engine.setState(!0),this.engine.depthCullingState.depthTest=!1,this.engine.stencilState.stencilTest=!1,this.engine.enableEffect(l._drawWrapper),this.bindBuffers(l.effect),l.onApplyObservable.notifyObservers({})}restoreStates(){this.engine.depthCullingState.depthTest=!0,this.engine.stencilState.stencilTest=!0}draw(){this.engine.drawElementsType(0,0,6)}_isRenderTargetTexture(l){return l.renderTarget!==void 0}render(l,e=null){if(!l.effect.isReady())return;this.setViewport();const t=e===null?null:this._isRenderTargetTexture(e)?e.renderTarget:e;t&&this.engine.bindFramebuffer(t),this.applyEffectWrapper(l),this.draw(),t&&this.engine.unBindFramebuffer(t),this.restoreStates()}dispose(){const l=this._vertexBuffers[X.PositionKind];l&&(l.dispose(),delete this._vertexBuffers[X.PositionKind]),this._indexBuffer&&this.engine._releaseBuffer(this._indexBuffer),this._onContextRestoredObserver&&(this.engine.onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)}}class oc{constructor(l){this.onApplyObservable=new z;let e;const t=l.uniformNames||[];l.vertexShader?e={fragmentSource:l.fragmentShader,vertexSource:l.vertexShader,spectorName:l.name||"effectWrapper"}:(t.push("scale"),e={fragmentSource:l.fragmentShader,vertex:"postprocess",spectorName:l.name||"effectWrapper"},this.onApplyObservable.add(()=>{this.effect.setFloat2("scale",1,1)}));const a=l.defines?l.defines.join(`
`):"";this._drawWrapper=new Mt(l.engine),l.useShaderStore?(e.fragment=e.fragmentSource,e.vertex||(e.vertex=e.vertexSource),delete e.fragmentSource,delete e.vertexSource,this.effect=l.engine.createEffect(e,l.attributeNames||["position"],t,l.samplerNames,a,void 0,l.onCompiled,void 0,void 0,l.shaderLanguage)):(this.effect=new Tl(e,l.attributeNames||["position"],t,l.samplerNames,l.engine,a,void 0,l.onCompiled,void 0,void 0,void 0,l.shaderLanguage),this._onContextRestoredObserver=l.engine.onContextRestoredObservable.add(()=>{this.effect._pipelineContext=null,this.effect._wasPreviouslyReady=!1,this.effect._prepareEffect()}))}get effect(){return this._drawWrapper.effect}set effect(l){this._drawWrapper.effect=l}dispose(){this._onContextRestoredObserver&&(this.effect.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null),this.effect.dispose()}}const Ld="passPixelShader",Jd=`varying vec2 vUV;
uniform sampler2D textureSampler;
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void) 
{
gl_FragColor=texture2D(textureSampler,vUV);
}`;H.ShadersStore[Ld]=Jd;const $s={name:Ld,shader:Jd};class le{static _CreateDumpRenderer(){if(!le._DumpToolsEngine){const l=document.createElement("canvas"),e=new Zl(l,!1,{preserveDrawingBuffer:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1});e.getCaps().parallelShaderCompile=void 0;const t=new mc(e),a=new oc({engine:e,name:$s.name,fragmentShader:$s.shader,samplerNames:["textureSampler"]});le._DumpToolsEngine={canvas:l,engine:e,renderer:t,wrapper:a}}return le._DumpToolsEngine}static async DumpFramebuffer(l,e,t,a,s="image/png",d){const i=await t.readPixels(0,0,l,e),c=new Uint8Array(i.buffer);le.DumpData(l,e,c,a,s,d,!0)}static DumpDataAsync(l,e,t,a="image/png",s,d=!1,i=!1,c){return new Promise(n=>{le.DumpData(l,e,t,h=>n(h),a,s,d,i,c)})}static DumpData(l,e,t,a,s="image/png",d,i=!1,c=!1,n){const h=le._CreateDumpRenderer();if(h.engine.setSize(l,e,!0),t instanceof Float32Array){const o=new Uint8Array(t.length);let b=t.length;for(;b--;){const u=t[b];o[b]=u<0?0:u>1?1:Math.round(u*255)}t=o}const m=h.engine.createRawTexture(t,l,e,5,!1,!i,1);h.renderer.setViewport(),h.renderer.applyEffectWrapper(h.wrapper),h.wrapper.effect._bindTexture("textureSampler",m),h.renderer.draw(),c?Q.ToBlob(h.canvas,o=>{const b=new FileReader;b.onload=u=>{const V=u.target.result;a&&a(V)},b.readAsArrayBuffer(o)},s,n):Q.EncodeScreenshotCanvasData(h.canvas,a,s,d,n),m.dispose()}static Dispose(){le._DumpToolsEngine&&(le._DumpToolsEngine.wrapper.dispose(),le._DumpToolsEngine.renderer.dispose(),le._DumpToolsEngine.engine.dispose()),le._DumpToolsEngine=null}}const bc=()=>{Q.DumpData=le.DumpData,Q.DumpDataAsync=le.DumpDataAsync,Q.DumpFramebuffer=le.DumpFramebuffer};bc();class Ge extends v{constructor(l,e,t,a=!1,s=!0,d=0,i=!1,c=v.TRILINEAR_SAMPLINGMODE,n=!0,h=!1,m=!1,o=5,b=!1,u,V,G=!1,p=!1){var y,L,N,J,R,S;let T;if(typeof a=="object"){const g=a;a=!!g.generateMipMaps,s=(y=g.doNotChangeAspectRatio)!==null&&y!==void 0?y:!0,d=(L=g.type)!==null&&L!==void 0?L:0,i=!!g.isCube,c=(N=g.samplingMode)!==null&&N!==void 0?N:v.TRILINEAR_SAMPLINGMODE,n=(J=g.generateDepthBuffer)!==null&&J!==void 0?J:!0,h=!!g.generateStencilBuffer,m=!!g.isMulti,o=(R=g.format)!==null&&R!==void 0?R:5,b=!!g.delayAllocation,u=g.samples,V=g.creationFlags,G=!!g.noColorAttachment,p=!!g.useSRGBBuffer,T=g.colorAttachment}if(super(null,t,!a,void 0,c,void 0,void 0,void 0,void 0,o),this._unObserveRenderList=null,this._renderListHasChanged=(g,ll)=>{var ol;const ml=this._renderList?this._renderList.length:0;(ll===0&&ml>0||ml===0)&&((ol=this.getScene())===null||ol===void 0||ol.meshes.forEach(el=>{el._markSubMeshesAsLightDirty()}))},this.renderParticles=!0,this.renderSprites=!1,this.forceLayerMaskCheck=!1,this.ignoreCameraViewport=!1,this.onBeforeBindObservable=new z,this.onAfterUnbindObservable=new z,this.onBeforeRenderObservable=new z,this.onAfterRenderObservable=new z,this.onClearObservable=new z,this.onResizeObservable=new z,this._cleared=!1,this.skipInitialClear=!1,this._currentRefreshId=-1,this._refreshRate=1,this._samples=1,this._canRescale=!0,this._renderTarget=null,this.boundingBoxPosition=r.Zero(),t=this.getScene(),!t)return;const k=this.getScene().getEngine();this._coordinatesMode=v.PROJECTION_MODE,this.renderList=new Array,this.name=l,this.isRenderTarget=!0,this._initialSizeParameter=e,this._renderPassIds=[],this._isCubeData=i,this._processSizeParameter(e),this.renderPassId=this._renderPassIds[0],this._resizeObserver=k.onResizeObservable.add(()=>{}),this._generateMipMaps=!!a,this._doNotChangeAspectRatio=s,this._renderingManager=new El(t),this._renderingManager._useSceneAutoClearSetup=!0,!m&&(this._renderTargetOptions={generateMipMaps:a,type:d,format:(S=this._format)!==null&&S!==void 0?S:void 0,samplingMode:this.samplingMode,generateDepthBuffer:n,generateStencilBuffer:h,samples:u,creationFlags:V,noColorAttachment:G,useSRGBBuffer:p,colorAttachment:T},this.samplingMode===v.NEAREST_SAMPLINGMODE&&(this.wrapU=v.CLAMP_ADDRESSMODE,this.wrapV=v.CLAMP_ADDRESSMODE),b||(i?(this._renderTarget=t.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions),this.coordinatesMode=v.INVCUBIC_MODE,this._textureMatrix=Y.Identity()):this._renderTarget=t.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this._texture=this._renderTarget.texture,u!==void 0&&(this.samples=u)))}get renderList(){return this._renderList}set renderList(l){this._unObserveRenderList&&(this._unObserveRenderList(),this._unObserveRenderList=null),l&&(this._unObserveRenderList=hd(l,this._renderListHasChanged)),this._renderList=l}get postProcesses(){return this._postProcesses}get _prePassEnabled(){return!!this._prePassRenderTarget&&this._prePassRenderTarget.enabled}set onAfterUnbind(l){this._onAfterUnbindObserver&&this.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=this.onAfterUnbindObservable.add(l)}set onBeforeRender(l){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(l)}set onAfterRender(l){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(l)}set onClear(l){this._onClearObserver&&this.onClearObservable.remove(this._onClearObserver),this._onClearObserver=this.onClearObservable.add(l)}get renderPassIds(){return this._renderPassIds}get currentRefreshId(){return this._currentRefreshId}setMaterialForRendering(l,e){let t;Array.isArray(l)?t=l:t=[l];for(let a=0;a<t.length;++a)for(let s=0;s<this._renderPassIds.length;++s)t[a].setMaterialForRenderPass(this._renderPassIds[s],e!==void 0?Array.isArray(e)?e[s]:e:void 0)}get renderTargetOptions(){return this._renderTargetOptions}get renderTarget(){return this._renderTarget}_onRatioRescale(){this._sizeRatio&&this.resize(this._initialSizeParameter)}set boundingBoxSize(l){if(this._boundingBoxSize&&this._boundingBoxSize.equals(l))return;this._boundingBoxSize=l;const e=this.getScene();e&&e.markAllMaterialsAsDirty(1)}get boundingBoxSize(){return this._boundingBoxSize}get depthStencilTexture(){var l,e;return(e=(l=this._renderTarget)===null||l===void 0?void 0:l._depthStencilTexture)!==null&&e!==void 0?e:null}createDepthStencilTexture(l=0,e=!0,t=!1,a=1,s=14){var d;(d=this._renderTarget)===null||d===void 0||d.createDepthStencilTexture(l,e,t,a,s)}_releaseRenderPassId(){if(this._scene){const l=this._scene.getEngine();for(let e=0;e<this._renderPassIds.length;++e)l.releaseRenderPassId(this._renderPassIds[e])}this._renderPassIds=[]}_createRenderPassId(){this._releaseRenderPassId();const l=this._scene.getEngine(),e=this._isCubeData?6:this.getRenderLayers()||1;for(let t=0;t<e;++t)this._renderPassIds[t]=l.createRenderPassId(`RenderTargetTexture - ${this.name}#${t}`)}_processSizeParameter(l){if(l.ratio){this._sizeRatio=l.ratio;const e=this._getEngine();this._size={width:this._bestReflectionRenderTargetDimension(e.getRenderWidth(),this._sizeRatio),height:this._bestReflectionRenderTargetDimension(e.getRenderHeight(),this._sizeRatio)}}else this._size=l;this._createRenderPassId()}get samples(){var l,e;return(e=(l=this._renderTarget)===null||l===void 0?void 0:l.samples)!==null&&e!==void 0?e:this._samples}set samples(l){this._renderTarget&&(this._samples=this._renderTarget.setSamples(l))}resetRefreshCounter(){this._currentRefreshId=-1}get refreshRate(){return this._refreshRate}set refreshRate(l){this._refreshRate=l,this.resetRefreshCounter()}addPostProcess(l){if(!this._postProcessManager){const e=this.getScene();if(!e)return;this._postProcessManager=new Ya(e),this._postProcesses=new Array}this._postProcesses.push(l),this._postProcesses[0].autoClear=!1}clearPostProcesses(l=!1){if(this._postProcesses){if(l)for(const e of this._postProcesses)e.dispose();this._postProcesses=[]}}removePostProcess(l){if(!this._postProcesses)return;const e=this._postProcesses.indexOf(l);e!==-1&&(this._postProcesses.splice(e,1),this._postProcesses.length>0&&(this._postProcesses[0].autoClear=!1))}_shouldRender(){return this._currentRefreshId===-1?(this._currentRefreshId=1,!0):this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1)}getRenderSize(){return this.getRenderWidth()}getRenderWidth(){return this._size.width?this._size.width:this._size}getRenderHeight(){return this._size.width?this._size.height:this._size}getRenderLayers(){return this._size.layers||0}disableRescaling(){this._canRescale=!1}get canRescale(){return this._canRescale}scale(l){const e=Math.max(1,this.getRenderSize()*l);this.resize(e)}getReflectionTextureMatrix(){return this.isCube?this._textureMatrix:super.getReflectionTextureMatrix()}resize(l){var e;const t=this.isCube;(e=this._renderTarget)===null||e===void 0||e.dispose(),this._renderTarget=null;const a=this.getScene();a&&(this._processSizeParameter(l),t?this._renderTarget=a.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions):this._renderTarget=a.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this._texture=this._renderTarget.texture,this._renderTargetOptions.samples!==void 0&&(this.samples=this._renderTargetOptions.samples),this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this))}render(l=!1,e=!1){this._render(l,e)}isReadyForRendering(){return this._render(!1,!1,!0)}_render(l=!1,e=!1,t=!1){var a;const s=this.getScene();if(!s)return t;const d=s.getEngine();if(this.useCameraPostProcesses!==void 0&&(l=this.useCameraPostProcesses),this._waitingRenderList){this.renderList=[];for(let m=0;m<this._waitingRenderList.length;m++){const o=this._waitingRenderList[m],b=s.getMeshById(o);b&&this.renderList.push(b)}this._waitingRenderList=void 0}if(this.renderListPredicate){this.renderList?this.renderList.length=0:this.renderList=[];const m=this.getScene();if(!m)return t;const o=m.meshes;for(let b=0;b<o.length;b++){const u=o[b];this.renderListPredicate(u)&&this.renderList.push(u)}}const i=d.currentRenderPassId;this.onBeforeBindObservable.notifyObservers(this);const c=(a=this.activeCamera)!==null&&a!==void 0?a:s.activeCamera,n=s.activeCamera;c&&(c!==s.activeCamera&&(s.setTransformMatrix(c.getViewMatrix(),c.getProjectionMatrix(!0)),s.activeCamera=c),d.setViewport(c.viewport,this.getRenderWidth(),this.getRenderHeight())),this._defaultRenderListPrepared=!1;let h=t;if(t){s.getViewMatrix()||s.updateTransformMatrix();const m=this.is2DArray?this.getRenderLayers():this.isCube?6:1;for(let o=0;o<m&&h;o++){let b=null;const u=this.renderList?this.renderList:s.getActiveMeshes().data,V=this.renderList?this.renderList.length:s.getActiveMeshes().length;d.currentRenderPassId=this._renderPassIds[o],this.onBeforeRenderObservable.notifyObservers(o),this.getCustomRenderList&&(b=this.getCustomRenderList(o,u,V)),b||(b=u),this._doNotChangeAspectRatio||s.updateTransformMatrix(!0);for(let G=0;G<b.length&&h;++G){const p=b[G];if(!(!p.isEnabled()||p.isBlocked||!p.isVisible||!p.subMeshes)){if(this.customIsReadyFunction){if(!this.customIsReadyFunction(p,this.refreshRate,t)){h=!1;continue}}else if(!p.isReady(!0)){h=!1;continue}}}this.onAfterRenderObservable.notifyObservers(o),(this.is2DArray||this.isCube)&&(s.incrementRenderId(),s.resetCachedMaterial())}}else if(this.is2DArray)for(let m=0;m<this.getRenderLayers();m++)this._renderToTarget(0,l,e,m,c),s.incrementRenderId(),s.resetCachedMaterial();else if(this.isCube)for(let m=0;m<6;m++)this._renderToTarget(m,l,e,void 0,c),s.incrementRenderId(),s.resetCachedMaterial();else this._renderToTarget(0,l,e,void 0,c);return this.onAfterUnbindObservable.notifyObservers(this),d.currentRenderPassId=i,n&&(s.activeCamera=n,(s.getEngine().scenes.length>1||this.activeCamera&&this.activeCamera!==s.activeCamera)&&s.setTransformMatrix(s.activeCamera.getViewMatrix(),s.activeCamera.getProjectionMatrix(!0)),d.setViewport(s.activeCamera.viewport)),s.resetCachedMaterial(),h}_bestReflectionRenderTargetDimension(l,e){const t=l*e,a=x.NearestPOT(t+128*128/(128+t));return Math.min(x.FloorPOT(l),a)}_prepareRenderingManager(l,e,t,a){const s=this.getScene();if(!s)return;this._renderingManager.reset();const d=s.getRenderId();for(let i=0;i<e;i++){const c=l[i];if(c&&!c.isBlocked){if(this.customIsReadyFunction){if(!this.customIsReadyFunction(c,this.refreshRate,!1)){this.resetRefreshCounter();continue}}else if(!c.isReady(this.refreshRate===0)){this.resetRefreshCounter();continue}if(!c._internalAbstractMeshDataInfo._currentLODIsUpToDate&&s.activeCamera&&(c._internalAbstractMeshDataInfo._currentLOD=s.customLODSelector?s.customLODSelector(c,this.activeCamera||s.activeCamera):c.getLOD(this.activeCamera||s.activeCamera),c._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0),!c._internalAbstractMeshDataInfo._currentLOD)continue;let n=c._internalAbstractMeshDataInfo._currentLOD;n._preActivateForIntermediateRendering(d);let h;if(a&&t?h=(c.layerMask&t.layerMask)===0:h=!1,c.isEnabled()&&c.isVisible&&c.subMeshes&&!h&&(n!==c&&n._activate(d,!0),c._activate(d,!0)&&c.subMeshes.length)){c.isAnInstance?c._internalAbstractMeshDataInfo._actAsRegularMesh&&(n=c):n._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!1,n._internalAbstractMeshDataInfo._isActiveIntermediate=!0;for(let m=0;m<n.subMeshes.length;m++){const o=n.subMeshes[m];this._renderingManager.dispatch(o,n)}}}}for(let i=0;i<s.particleSystems.length;i++){const c=s.particleSystems[i],n=c.emitter;!c.isStarted()||!n||!n.position||!n.isEnabled()||l.indexOf(n)>=0&&this._renderingManager.dispatchParticles(c)}}_bindFrameBuffer(l=0,e=0){const t=this.getScene();if(!t)return;const a=t.getEngine();this._renderTarget&&a.bindFramebuffer(this._renderTarget,this.isCube?l:void 0,void 0,void 0,this.ignoreCameraViewport,0,e)}_unbindFrameBuffer(l,e){this._renderTarget&&l.unBindFramebuffer(this._renderTarget,this.isCube,()=>{this.onAfterRenderObservable.notifyObservers(e)})}_prepareFrame(l,e,t,a){this._postProcessManager?this._prePassEnabled||this._postProcessManager._prepareFrame(this._texture,this._postProcesses):(!a||!l.postProcessManager._prepareFrame(this._texture))&&this._bindFrameBuffer(e,t)}_renderToTarget(l,e,t,a=0,s=null){var d,i,c,n,h,m;const o=this.getScene();if(!o)return;const b=o.getEngine();if((d=b._debugPushGroup)===null||d===void 0||d.call(b,`render to face #${l} layer #${a}`,1),this._prepareFrame(o,l,a,e),this.is2DArray?(b.currentRenderPassId=this._renderPassIds[a],this.onBeforeRenderObservable.notifyObservers(a)):(b.currentRenderPassId=this._renderPassIds[l],this.onBeforeRenderObservable.notifyObservers(l)),b.snapshotRendering&&b.snapshotRenderingMode===1)this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(b):this.skipInitialClear||b.clear(this.clearColor||o.clearColor,!0,!0,!0);else{let u=null;const V=this.renderList?this.renderList:o.getActiveMeshes().data,G=this.renderList?this.renderList.length:o.getActiveMeshes().length;this.getCustomRenderList&&(u=this.getCustomRenderList(this.is2DArray?a:l,V,G)),u?this._prepareRenderingManager(u,u.length,s,this.forceLayerMaskCheck):(this._defaultRenderListPrepared||(this._prepareRenderingManager(V,G,s,!this.renderList||this.forceLayerMaskCheck),this._defaultRenderListPrepared=!0),u=V);for(const y of o._beforeRenderTargetClearStage)y.action(this,l,a);this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(b):this.skipInitialClear||b.clear(this.clearColor||o.clearColor,!0,!0,!0),this._doNotChangeAspectRatio||o.updateTransformMatrix(!0);for(const y of o._beforeRenderTargetDrawStage)y.action(this,l,a);this._renderingManager.render(this.customRenderFunction,u,this.renderParticles,this.renderSprites);for(const y of o._afterRenderTargetDrawStage)y.action(this,l,a);const p=(c=(i=this._texture)===null||i===void 0?void 0:i.generateMipMaps)!==null&&c!==void 0?c:!1;this._texture&&(this._texture.generateMipMaps=!1),this._postProcessManager?this._postProcessManager._finalizeFrame(!1,(n=this._renderTarget)!==null&&n!==void 0?n:void 0,l,this._postProcesses,this.ignoreCameraViewport):e&&o.postProcessManager._finalizeFrame(!1,(h=this._renderTarget)!==null&&h!==void 0?h:void 0,l);for(const y of o._afterRenderTargetPostProcessStage)y.action(this,l,a);this._texture&&(this._texture.generateMipMaps=p),this._doNotChangeAspectRatio||o.updateTransformMatrix(!0),t&&le.DumpFramebuffer(this.getRenderWidth(),this.getRenderHeight(),b)}this._unbindFrameBuffer(b,l),this._texture&&this.isCube&&l===5&&b.generateMipMapsForCubemap(this._texture),(m=b._debugPopGroup)===null||m===void 0||m.call(b,1)}setRenderingOrder(l,e=null,t=null,a=null){this._renderingManager.setRenderingOrder(l,e,t,a)}setRenderingAutoClearDepthStencil(l,e){this._renderingManager.setRenderingAutoClearDepthStencil(l,e),this._renderingManager._useSceneAutoClearSetup=!1}clone(){const l=this.getSize(),e=new Ge(this.name,l,this.getScene(),this._renderTargetOptions.generateMipMaps,this._doNotChangeAspectRatio,this._renderTargetOptions.type,this.isCube,this._renderTargetOptions.samplingMode,this._renderTargetOptions.generateDepthBuffer,this._renderTargetOptions.generateStencilBuffer,void 0,this._renderTargetOptions.format,void 0,this._renderTargetOptions.samples);return e.hasAlpha=this.hasAlpha,e.level=this.level,e.coordinatesMode=this.coordinatesMode,this.renderList&&(e.renderList=this.renderList.slice(0)),e}serialize(){if(!this.name)return null;const l=super.serialize();if(l.renderTargetSize=this.getRenderSize(),l.renderList=[],this.renderList)for(let e=0;e<this.renderList.length;e++)l.renderList.push(this.renderList[e].id);return l}disposeFramebufferObjects(){var l;(l=this._renderTarget)===null||l===void 0||l.dispose(!0)}releaseInternalTexture(){var l;(l=this._renderTarget)===null||l===void 0||l.releaseTextures(),this._texture=null}dispose(){var l;this.onResizeObservable.clear(),this.onClearObservable.clear(),this.onAfterRenderObservable.clear(),this.onAfterUnbindObservable.clear(),this.onBeforeBindObservable.clear(),this.onBeforeRenderObservable.clear(),this._postProcessManager&&(this._postProcessManager.dispose(),this._postProcessManager=null),this._prePassRenderTarget&&this._prePassRenderTarget.dispose(),this._releaseRenderPassId(),this.clearPostProcesses(!0),this._resizeObserver&&(this.getScene().getEngine().onResizeObservable.remove(this._resizeObserver),this._resizeObserver=null),this.renderList=null;const e=this.getScene();if(!e)return;let t=e.customRenderTargets.indexOf(this);t>=0&&e.customRenderTargets.splice(t,1);for(const a of e.cameras)t=a.customRenderTargets.indexOf(this),t>=0&&a.customRenderTargets.splice(t,1);(l=this._renderTarget)===null||l===void 0||l.dispose(),this._renderTarget=null,this._texture=null,super.dispose()}_rebuild(){this.refreshRate===Ge.REFRESHRATE_RENDER_ONCE&&(this.refreshRate=Ge.REFRESHRATE_RENDER_ONCE),this._postProcessManager&&this._postProcessManager._rebuild()}freeRenderingGroups(){this._renderingManager&&this._renderingManager.freeRenderingGroups()}getViewCount(){return 1}}Ge.REFRESHRATE_RENDER_ONCE=0;Ge.REFRESHRATE_RENDER_ONEVERYFRAME=1;Ge.REFRESHRATE_RENDER_ONEVERYTWOFRAMES=2;v._CreateRenderTargetTexture=(Z,l,e,t,a)=>new Ge(Z,l,e,t);class yl{constructor(l,e,t,a,s,d,i=1,c,n,h=null,m=0,o="postprocess",b,u=!1,V=5,G=wl.GLSL){this._parentContainer=null,this.width=-1,this.height=-1,this.nodeMaterialSource=null,this._outputTexture=null,this.autoClear=!0,this.alphaMode=0,this.animations=new Array,this.enablePixelPerfectMode=!1,this.forceFullscreenViewport=!0,this.scaleMode=1,this.alwaysForcePOT=!1,this._samples=1,this.adaptScaleToCurrentViewport=!1,this._reusable=!1,this._renderId=0,this.externalTextureSamplerBinding=!1,this._textures=new ql(2),this._textureCache=[],this._currentRenderTextureInd=0,this._scaleRatio=new Wl(1,1),this._texelSize=Wl.Zero(),this.onActivateObservable=new z,this.onSizeChangedObservable=new z,this.onApplyObservable=new z,this.onBeforeRenderObservable=new z,this.onAfterRenderObservable=new z,this.name=l,d!=null?(this._camera=d,this._scene=d.getScene(),d.attachPostProcess(this),this._engine=this._scene.getEngine(),this._scene.postProcesses.push(this),this.uniqueId=this._scene.getUniqueId()):c&&(this._engine=c,this._engine.postProcesses.push(this)),this._options=s,this.renderTargetSamplingMode=i||1,this._reusable=n||!1,this._textureType=m,this._textureFormat=V,this._shaderLanguage=G,this._samplers=a||[],this._samplers.push("textureSampler"),this._fragmentUrl=e,this._vertexUrl=o,this._parameters=t||[],this._parameters.push("scale"),this._indexParameters=b,this._drawWrapper=new Mt(this._engine),u||this.updateEffect(h)}static RegisterShaderCodeProcessing(l,e){if(!e){delete yl._CustomShaderCodeProcessing[l??""];return}yl._CustomShaderCodeProcessing[l??""]=e}static _GetShaderCodeProcessing(l){var e;return(e=yl._CustomShaderCodeProcessing[l])!==null&&e!==void 0?e:yl._CustomShaderCodeProcessing[""]}get samples(){return this._samples}set samples(l){this._samples=Math.min(l,this._engine.getCaps().maxMSAASamples),this._textures.forEach(e=>{e.setSamples(this._samples)})}getEffectName(){return this._fragmentUrl}set onActivate(l){this._onActivateObserver&&this.onActivateObservable.remove(this._onActivateObserver),l&&(this._onActivateObserver=this.onActivateObservable.add(l))}set onSizeChanged(l){this._onSizeChangedObserver&&this.onSizeChangedObservable.remove(this._onSizeChangedObserver),this._onSizeChangedObserver=this.onSizeChangedObservable.add(l)}set onApply(l){this._onApplyObserver&&this.onApplyObservable.remove(this._onApplyObserver),this._onApplyObserver=this.onApplyObservable.add(l)}set onBeforeRender(l){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(l)}set onAfterRender(l){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(l)}get inputTexture(){return this._textures.data[this._currentRenderTextureInd]}set inputTexture(l){this._forcedOutputTexture=l}restoreDefaultInputTexture(){this._forcedOutputTexture&&(this._forcedOutputTexture=null,this.markTextureDirty())}getCamera(){return this._camera}get texelSize(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.texelSize:(this._forcedOutputTexture&&this._texelSize.copyFromFloats(1/this._forcedOutputTexture.width,1/this._forcedOutputTexture.height),this._texelSize)}getClassName(){return"PostProcess"}getEngine(){return this._engine}getEffect(){return this._drawWrapper.effect}shareOutputWith(l){return this._disposeTextures(),this._shareOutputWithPostProcess=l,this}useOwnOutput(){this._textures.length==0&&(this._textures=new ql(2)),this._shareOutputWithPostProcess=null}updateEffect(l=null,e=null,t=null,a,s,d,i,c){var n,h;const m=yl._GetShaderCodeProcessing(this.name);if(m!=null&&m.defineCustomBindings){const o=(n=e==null?void 0:e.slice())!==null&&n!==void 0?n:[];o.push(...this._parameters);const b=(h=t==null?void 0:t.slice())!==null&&h!==void 0?h:[];b.push(...this._samplers),l=m.defineCustomBindings(this.name,l,o,b),e=o,t=b}this._postProcessDefines=l,this._drawWrapper.effect=this._engine.createEffect({vertex:i??this._vertexUrl,fragment:c??this._fragmentUrl},{attributes:["position"],uniformsNames:e||this._parameters,uniformBuffersNames:[],samplers:t||this._samplers,defines:l!==null?l:"",fallbacks:null,onCompiled:s??null,onError:d??null,indexParameters:a||this._indexParameters,processCodeAfterIncludes:m!=null&&m.processCodeAfterIncludes?(o,b)=>m.processCodeAfterIncludes(this.name,o,b):null,processFinalCode:m!=null&&m.processFinalCode?(o,b)=>m.processFinalCode(this.name,o,b):null,shaderLanguage:this._shaderLanguage},this._engine)}isReusable(){return this._reusable}markTextureDirty(){this.width=-1}_createRenderTargetTexture(l,e,t=0){for(let s=0;s<this._textureCache.length;s++)if(this._textureCache[s].texture.width===l.width&&this._textureCache[s].texture.height===l.height&&this._textureCache[s].postProcessChannel===t&&this._textureCache[s].texture._generateDepthBuffer===e.generateDepthBuffer&&this._textureCache[s].texture.samples===e.samples)return this._textureCache[s].texture;const a=this._engine.createRenderTargetTexture(l,e);return this._textureCache.push({texture:a,postProcessChannel:t,lastUsedRenderId:-1}),a}_flushTextureCache(){const l=this._renderId;for(let e=this._textureCache.length-1;e>=0;e--)if(l-this._textureCache[e].lastUsedRenderId>100){let t=!1;for(let a=0;a<this._textures.length;a++)if(this._textures.data[a]===this._textureCache[e].texture){t=!0;break}t||(this._textureCache[e].texture.dispose(),this._textureCache.splice(e,1))}}_resize(l,e,t,a,s){this._textures.length>0&&this._textures.reset(),this.width=l,this.height=e;let d=null;for(let n=0;n<t._postProcesses.length;n++)if(t._postProcesses[n]!==null){d=t._postProcesses[n];break}const i={width:this.width,height:this.height},c={generateMipMaps:a,generateDepthBuffer:s||d===this,generateStencilBuffer:(s||d===this)&&this._engine.isStencilEnable,samplingMode:this.renderTargetSamplingMode,type:this._textureType,format:this._textureFormat,samples:this._samples};this._textures.push(this._createRenderTargetTexture(i,c,0)),this._reusable&&this._textures.push(this._createRenderTargetTexture(i,c,1)),this._texelSize.copyFromFloats(1/this.width,1/this.height),this.onSizeChangedObservable.notifyObservers(this)}activate(l,e=null,t){var a,s;l=l||this._camera;const d=l.getScene(),i=d.getEngine(),c=i.getCaps().maxTextureSize;let n=(e?e.width:this._engine.getRenderWidth(!0))*this._options|0;const h=(e?e.height:this._engine.getRenderHeight(!0))*this._options|0,m=l.parent;m&&(m.leftCamera==l||m.rightCamera==l)&&(n/=2);let o=this._options.width||n,b=this._options.height||h;const u=this.renderTargetSamplingMode!==7&&this.renderTargetSamplingMode!==1&&this.renderTargetSamplingMode!==2;if(!this._shareOutputWithPostProcess&&!this._forcedOutputTexture){if(this.adaptScaleToCurrentViewport){const G=i.currentViewport;G&&(o*=G.width,b*=G.height)}(u||this.alwaysForcePOT)&&(this._options.width||(o=i.needPOTTextures?x.GetExponentOfTwo(o,c,this.scaleMode):o),this._options.height||(b=i.needPOTTextures?x.GetExponentOfTwo(b,c,this.scaleMode):b)),(this.width!==o||this.height!==b)&&this._resize(o,b,l,u,t),this._textures.forEach(G=>{G.samples!==this.samples&&this._engine.updateRenderTargetTextureSampleCount(G,this.samples)}),this._flushTextureCache(),this._renderId++}let V;if(this._shareOutputWithPostProcess)V=this._shareOutputWithPostProcess.inputTexture;else if(this._forcedOutputTexture)V=this._forcedOutputTexture,this.width=this._forcedOutputTexture.width,this.height=this._forcedOutputTexture.height;else{V=this.inputTexture;let G;for(let p=0;p<this._textureCache.length;p++)if(this._textureCache[p].texture===V){G=this._textureCache[p];break}G&&(G.lastUsedRenderId=this._renderId)}return this.enablePixelPerfectMode?(this._scaleRatio.copyFromFloats(n/o,h/b),this._engine.bindFramebuffer(V,0,n,h,this.forceFullscreenViewport)):(this._scaleRatio.copyFromFloats(1,1),this._engine.bindFramebuffer(V,0,void 0,void 0,this.forceFullscreenViewport)),(s=(a=this._engine)._debugInsertMarker)===null||s===void 0||s.call(a,`post process ${this.name} input`),this.onActivateObservable.notifyObservers(l),this.autoClear&&this.alphaMode===0&&this._engine.clear(this.clearColor?this.clearColor:d.clearColor,d._allowPostProcessClearColor,!0,!0),this._reusable&&(this._currentRenderTextureInd=(this._currentRenderTextureInd+1)%2),V}get isSupported(){return this._drawWrapper.effect.isSupported}get aspectRatio(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.aspectRatio:this._forcedOutputTexture?this._forcedOutputTexture.width/this._forcedOutputTexture.height:this.width/this.height}isReady(){var l,e;return(e=(l=this._drawWrapper.effect)===null||l===void 0?void 0:l.isReady())!==null&&e!==void 0?e:!1}apply(){var l,e,t;if(!(!((l=this._drawWrapper.effect)===null||l===void 0)&&l.isReady()))return null;this._engine.enableEffect(this._drawWrapper),this._engine.setState(!1),this._engine.setDepthBuffer(!1),this._engine.setDepthWrite(!1),this._engine.setAlphaMode(this.alphaMode),this.alphaConstants&&this.getEngine().setAlphaConstants(this.alphaConstants.r,this.alphaConstants.g,this.alphaConstants.b,this.alphaConstants.a);let a;return this._shareOutputWithPostProcess?a=this._shareOutputWithPostProcess.inputTexture:this._forcedOutputTexture?a=this._forcedOutputTexture:a=this.inputTexture,this.externalTextureSamplerBinding||this._drawWrapper.effect._bindTexture("textureSampler",a==null?void 0:a.texture),this._drawWrapper.effect.setVector2("scale",this._scaleRatio),this.onApplyObservable.notifyObservers(this._drawWrapper.effect),(t=(e=yl._GetShaderCodeProcessing(this.name))===null||e===void 0?void 0:e.bindCustomBindings)===null||t===void 0||t.call(e,this.name,this._drawWrapper.effect),this._drawWrapper.effect}_disposeTextures(){if(this._shareOutputWithPostProcess||this._forcedOutputTexture){this._disposeTextureCache();return}this._disposeTextureCache(),this._textures.dispose()}_disposeTextureCache(){for(let l=this._textureCache.length-1;l>=0;l--)this._textureCache[l].texture.dispose();this._textureCache.length=0}setPrePassRenderer(l){return this._prePassEffectConfiguration?(this._prePassEffectConfiguration=l.addEffectConfiguration(this._prePassEffectConfiguration),this._prePassEffectConfiguration.enabled=!0,!0):!1}dispose(l){l=l||this._camera,this._disposeTextures();let e;if(this._scene&&(e=this._scene.postProcesses.indexOf(this),e!==-1&&this._scene.postProcesses.splice(e,1)),this._parentContainer){const t=this._parentContainer.postProcesses.indexOf(this);t>-1&&this._parentContainer.postProcesses.splice(t,1),this._parentContainer=null}if(e=this._engine.postProcesses.indexOf(this),e!==-1&&this._engine.postProcesses.splice(e,1),!!l){if(l.detachPostProcess(this),e=l._postProcesses.indexOf(this),e===0&&l._postProcesses.length>0){const t=this._camera._getFirstPostProcess();t&&t.markTextureDirty()}this.onActivateObservable.clear(),this.onAfterRenderObservable.clear(),this.onApplyObservable.clear(),this.onBeforeRenderObservable.clear(),this.onSizeChangedObservable.clear()}}serialize(){const l=il.Serialize(this),e=this.getCamera()||this._scene&&this._scene.activeCamera;return l.customType="BABYLON."+this.getClassName(),l.cameraId=e?e.id:null,l.reusable=this._reusable,l.textureType=this._textureType,l.fragmentUrl=this._fragmentUrl,l.parameters=this._parameters,l.samplers=this._samplers,l.options=this._options,l.defines=this._postProcessDefines,l.textureFormat=this._textureFormat,l.vertexUrl=this._vertexUrl,l.indexParameters=this._indexParameters,l}clone(){const l=this.serialize();l._engine=this._engine,l.cameraId=null;const e=yl.Parse(l,this._scene,"");return e?(e.onActivateObservable=this.onActivateObservable.clone(),e.onSizeChangedObservable=this.onSizeChangedObservable.clone(),e.onApplyObservable=this.onApplyObservable.clone(),e.onBeforeRenderObservable=this.onBeforeRenderObservable.clone(),e.onAfterRenderObservable=this.onAfterRenderObservable.clone(),e._prePassEffectConfiguration=this._prePassEffectConfiguration,e):null}static Parse(l,e,t){const a=Gt(l.customType);if(!a||!a._Parse)return null;const s=e?e.getCameraById(l.cameraId):null;return a._Parse(l,s,e,t)}static _Parse(l,e,t,a){return il.Parse(()=>new yl(l.name,l.fragmentUrl,l.parameters,l.samplers,l.options,e,l.renderTargetSamplingMode,l._engine,l.reusable,l.defines,l.textureType,l.vertexUrl,l.indexParameters,!1,l.textureFormat),l,t,a)}}yl._CustomShaderCodeProcessing={};W([F()],yl.prototype,"uniqueId",void 0);W([F()],yl.prototype,"name",void 0);W([F()],yl.prototype,"width",void 0);W([F()],yl.prototype,"height",void 0);W([F()],yl.prototype,"renderTargetSamplingMode",void 0);W([pd()],yl.prototype,"clearColor",void 0);W([F()],yl.prototype,"autoClear",void 0);W([F()],yl.prototype,"alphaMode",void 0);W([F()],yl.prototype,"alphaConstants",void 0);W([F()],yl.prototype,"enablePixelPerfectMode",void 0);W([F()],yl.prototype,"forceFullscreenViewport",void 0);W([F()],yl.prototype,"scaleMode",void 0);W([F()],yl.prototype,"alwaysForcePOT",void 0);W([F("samples")],yl.prototype,"_samples",void 0);W([F()],yl.prototype,"adaptScaleToCurrentViewport",void 0);ce("BABYLON.PostProcess",yl);const Xc="kernelBlurVaryingDeclaration",uc="varying vec2 sampleCoord{X};";H.IncludesShadersStore[Xc]=uc;const rc="packingFunctions",Gc=`vec4 pack(float depth)
{
const vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);
const vec4 bit_mask=vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);
vec4 res=fract(depth*bit_shift);
res-=res.xxyz*bit_mask;
return res;
}
float unpack(vec4 color)
{
const vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);
return dot(color,bit_shift);
}`;H.IncludesShadersStore[rc]=Gc;const Vc="kernelBlurFragment",Rc=`#ifdef DOF
factor=sampleCoC(sampleCoord{X}); 
computedWeight=KERNEL_WEIGHT{X}*factor;
sumOfWeights+=computedWeight;
#else
computedWeight=KERNEL_WEIGHT{X};
#endif
#ifdef PACKEDFLOAT
blend+=unpack(texture2D(textureSampler,sampleCoord{X}))*computedWeight;
#else
blend+=texture2D(textureSampler,sampleCoord{X})*computedWeight;
#endif
`;H.IncludesShadersStore[Vc]=Rc;const Wc="kernelBlurFragment2",pc=`#ifdef DOF
factor=sampleCoC(sampleCenter+delta*KERNEL_DEP_OFFSET{X});
computedWeight=KERNEL_DEP_WEIGHT{X}*factor;
sumOfWeights+=computedWeight;
#else
computedWeight=KERNEL_DEP_WEIGHT{X};
#endif
#ifdef PACKEDFLOAT
blend+=unpack(texture2D(textureSampler,sampleCenter+delta*KERNEL_DEP_OFFSET{X}))*computedWeight;
#else
blend+=texture2D(textureSampler,sampleCenter+delta*KERNEL_DEP_OFFSET{X})*computedWeight;
#endif
`;H.IncludesShadersStore[Wc]=pc;const yc="kernelBlurPixelShader",Yc=`uniform sampler2D textureSampler;
uniform vec2 delta;
varying vec2 sampleCenter;
#ifdef DOF
uniform sampler2D circleOfConfusionSampler;
float sampleCoC(in vec2 offset) {
float coc=texture2D(circleOfConfusionSampler,offset).r;
return coc; 
}
#endif
#include<kernelBlurVaryingDeclaration>[0..varyingCount]
#ifdef PACKEDFLOAT
#include<packingFunctions>
#endif
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void)
{
float computedWeight=0.0;
#ifdef PACKEDFLOAT
float blend=0.;
#else
vec4 blend=vec4(0.);
#endif
#ifdef DOF
float sumOfWeights=CENTER_WEIGHT; 
float factor=0.0;
#ifdef PACKEDFLOAT
blend+=unpack(texture2D(textureSampler,sampleCenter))*CENTER_WEIGHT;
#else
blend+=texture2D(textureSampler,sampleCenter)*CENTER_WEIGHT;
#endif
#endif
#include<kernelBlurFragment>[0..varyingCount]
#include<kernelBlurFragment2>[0..depCount]
#ifdef PACKEDFLOAT
gl_FragColor=pack(blend);
#else
gl_FragColor=blend;
#endif
#ifdef DOF
gl_FragColor/=sumOfWeights;
#endif
}`;H.ShadersStore[yc]=Yc;const Nc="kernelBlurVertex",Fc="sampleCoord{X}=sampleCenter+delta*KERNEL_OFFSET{X};";H.IncludesShadersStore[Nc]=Fc;const Sc="kernelBlurVertexShader",Lc=`attribute vec2 position;
uniform vec2 delta;
varying vec2 sampleCenter;
#include<kernelBlurVaryingDeclaration>[0..varyingCount]
const vec2 madd=vec2(0.5,0.5);
#define CUSTOM_VERTEX_DEFINITIONS
void main(void) {
#define CUSTOM_VERTEX_MAIN_BEGIN
sampleCenter=(position*madd+madd);
#include<kernelBlurVertex>[0..varyingCount]
gl_Position=vec4(position,0.0,1.0);
#define CUSTOM_VERTEX_MAIN_END
}`;H.ShadersStore[Sc]=Lc;class dt extends yl{constructor(l,e,t,a,s,d=v.BILINEAR_SAMPLINGMODE,i,c,n=0,h="",m=!1,o=5){super(l,"kernelBlur",["delta","direction"],["circleOfConfusionSampler"],a,s,d,i,c,null,n,"kernelBlur",{varyingCount:0,depCount:0},!0,o),this._blockCompilation=m,this._packedFloat=!1,this._staticDefines="",this._staticDefines=h,this.direction=e,this.onApplyObservable.add(b=>{this._outputTexture?b.setFloat2("delta",1/this._outputTexture.width*this.direction.x,1/this._outputTexture.height*this.direction.y):b.setFloat2("delta",1/this.width*this.direction.x,1/this.height*this.direction.y)}),this.kernel=t}set kernel(l){this._idealKernel!==l&&(l=Math.max(l,1),this._idealKernel=l,this._kernel=this._nearestBestKernel(l),this._blockCompilation||this._updateParameters())}get kernel(){return this._idealKernel}set packedFloat(l){this._packedFloat!==l&&(this._packedFloat=l,this._blockCompilation||this._updateParameters())}get packedFloat(){return this._packedFloat}getClassName(){return"BlurPostProcess"}updateEffect(l=null,e=null,t=null,a,s,d){this._updateParameters(s,d)}_updateParameters(l,e){const t=this._kernel,a=(t-1)/2;let s=[],d=[],i=0;for(let G=0;G<t;G++){const p=G/(t-1),y=this._gaussianWeight(p*2-1);s[G]=G-a,d[G]=y,i+=y}for(let G=0;G<d.length;G++)d[G]/=i;const c=[],n=[],h=[];for(let G=0;G<=a;G+=2){const p=Math.min(G+1,Math.floor(a));if(G===p)h.push({o:s[G],w:d[G]});else{const y=p===a,L=d[G]+d[p]*(y?.5:1),N=s[G]+1/(1+d[G]/d[p]);N===0?(h.push({o:s[G],w:d[G]}),h.push({o:s[G+1],w:d[G+1]})):(h.push({o:N,w:L}),h.push({o:-N,w:L}))}}for(let G=0;G<h.length;G++)n[G]=h[G].o,c[G]=h[G].w;s=n,d=c;const m=this.getEngine().getCaps().maxVaryingVectors,o=Math.max(m,0)-1;let b=Math.min(s.length,o),u="";u+=this._staticDefines,this._staticDefines.indexOf("DOF")!=-1&&(u+=`#define CENTER_WEIGHT ${this._glslFloat(d[b-1])}\r
`,b--);for(let G=0;G<b;G++)u+=`#define KERNEL_OFFSET${G} ${this._glslFloat(s[G])}\r
`,u+=`#define KERNEL_WEIGHT${G} ${this._glslFloat(d[G])}\r
`;let V=0;for(let G=o;G<s.length;G++)u+=`#define KERNEL_DEP_OFFSET${V} ${this._glslFloat(s[G])}\r
`,u+=`#define KERNEL_DEP_WEIGHT${V} ${this._glslFloat(d[G])}\r
`,V++;this.packedFloat&&(u+="#define PACKEDFLOAT 1"),this._blockCompilation=!1,super.updateEffect(u,null,null,{varyingCount:b,depCount:V},l,e)}_nearestBestKernel(l){const e=Math.round(l);for(const t of[e,e-1,e+1,e-2,e+2])if(t%2!==0&&Math.floor(t/2)%2===0&&t>0)return Math.max(t,3);return Math.max(e,3)}_gaussianWeight(l){const e=.3333333333333333,t=Math.sqrt(2*Math.PI)*e,a=-(l*l/(2*e*e));return 1/t*Math.exp(a)}_glslFloat(l,e=8){return l.toFixed(e).replace(/0+$/,"")}static _Parse(l,e,t,a){return il.Parse(()=>new dt(l.name,l.direction,l.kernel,l.options,e,l.renderTargetSamplingMode,t.getEngine(),l.reusable,l.textureType,void 0,!1),l,t,a)}}W([F("kernel")],dt.prototype,"_kernel",void 0);W([F("packedFloat")],dt.prototype,"_packedFloat",void 0);W([zi()],dt.prototype,"direction",void 0);ce("BABYLON.BlurPostProcess",dt);class Ls{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(l,e){this._defines[l]||(l<this._currentRank&&(this._currentRank=l),l>this._maxRank&&(this._maxRank=l),this._defines[l]=new Array),this._defines[l].push(e)}addCPUSkinningFallback(l,e){this._mesh=e,l<this._currentRank&&(this._currentRank=l),l>this._maxRank&&(this._maxRank=l)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(l,e){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,l=l.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),e._bonesComputationForcedToCPU=!0;const t=this._mesh.getScene();for(let a=0;a<t.meshes.length;a++){const s=t.meshes[a];if(!s.material){!this._mesh.material&&s.computeBonesUsingShaders&&s.numBoneInfluencers>0&&(s.computeBonesUsingShaders=!1);continue}if(!(!s.computeBonesUsingShaders||s.numBoneInfluencers===0)){if(s.material.getEffect()===e)s.computeBonesUsingShaders=!1;else if(s.subMeshes){for(const d of s.subMeshes)if(d.effect===e){s.computeBonesUsingShaders=!1;break}}}}}else{const t=this._defines[this._currentRank];if(t)for(let a=0;a<t.length;a++)l=l.replace("#define "+t[a],"");this._currentRank++}return l}}const Jc="bayerDitherFunctions",xc=`float bayerDither2(vec2 _P) {
return mod(2.0*_P.y+_P.x+1.0,4.0);
}
float bayerDither4(vec2 _P) {
vec2 P1=mod(_P,2.0); 
vec2 P2=floor(0.5*mod(_P,4.0)); 
return 4.0*bayerDither2(P1)+bayerDither2(P2);
}
float bayerDither8(vec2 _P) {
vec2 P1=mod(_P,2.0); 
vec2 P2=floor(0.5 *mod(_P,4.0)); 
vec2 P4=floor(0.25*mod(_P,8.0)); 
return 4.0*(4.0*bayerDither2(P1)+bayerDither2(P2))+bayerDither2(P4);
}
`;H.IncludesShadersStore[Jc]=xc;const Uc="shadowMapFragmentExtraDeclaration",fc=`#if SM_FLOAT==0
#include<packingFunctions>
#endif
#if SM_SOFTTRANSPARENTSHADOW==1
#include<bayerDitherFunctions>
uniform float softTransparentShadowSM;
#endif
varying float vDepthMetricSM;
#if SM_USEDISTANCE==1
uniform vec3 lightDataSM;
varying vec3 vPositionWSM;
#endif
uniform vec3 biasAndScaleSM;
uniform vec2 depthValuesSM;
#if defined(SM_DEPTHCLAMP) && SM_DEPTHCLAMP==1
varying float zSM;
#endif
`;H.IncludesShadersStore[Uc]=fc;const Tc="clipPlaneFragmentDeclaration",zc=`#ifdef CLIPPLANE
varying float fClipDistance;
#endif
#ifdef CLIPPLANE2
varying float fClipDistance2;
#endif
#ifdef CLIPPLANE3
varying float fClipDistance3;
#endif
#ifdef CLIPPLANE4
varying float fClipDistance4;
#endif
#ifdef CLIPPLANE5
varying float fClipDistance5;
#endif
#ifdef CLIPPLANE6
varying float fClipDistance6;
#endif
`;H.IncludesShadersStore[Tc]=zc;const Mc="clipPlaneFragment",gc=`#if defined(CLIPPLANE) || defined(CLIPPLANE2) || defined(CLIPPLANE3) || defined(CLIPPLANE4) || defined(CLIPPLANE5) || defined(CLIPPLANE6)
if (false) {}
#endif
#ifdef CLIPPLANE
else if (fClipDistance>0.0)
{
discard;
}
#endif
#ifdef CLIPPLANE2
else if (fClipDistance2>0.0)
{
discard;
}
#endif
#ifdef CLIPPLANE3
else if (fClipDistance3>0.0)
{
discard;
}
#endif
#ifdef CLIPPLANE4
else if (fClipDistance4>0.0)
{
discard;
}
#endif
#ifdef CLIPPLANE5
else if (fClipDistance5>0.0)
{
discard;
}
#endif
#ifdef CLIPPLANE6
else if (fClipDistance6>0.0)
{
discard;
}
#endif
`;H.IncludesShadersStore[Mc]=gc;const Cc="shadowMapFragment",vc=`float depthSM=vDepthMetricSM;
#if defined(SM_DEPTHCLAMP) && SM_DEPTHCLAMP==1
#if SM_USEDISTANCE==1
depthSM=(length(vPositionWSM-lightDataSM)+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;
#else
#ifdef USE_REVERSE_DEPTHBUFFER
depthSM=(-zSM+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;
#else
depthSM=(zSM+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;
#endif
#endif
#ifdef USE_REVERSE_DEPTHBUFFER
gl_FragDepth=clamp(1.0-depthSM,0.0,1.0);
#else
gl_FragDepth=clamp(depthSM,0.0,1.0); 
#endif
#elif SM_USEDISTANCE==1
depthSM=(length(vPositionWSM-lightDataSM)+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;
#endif
#if SM_ESM==1
depthSM=clamp(exp(-min(87.,biasAndScaleSM.z*depthSM)),0.,1.);
#endif
#if SM_FLOAT==1
gl_FragColor=vec4(depthSM,1.0,1.0,1.0);
#else
gl_FragColor=pack(depthSM);
#endif
return;`;H.IncludesShadersStore[Cc]=vc;const kc="shadowMapPixelShader",Hc=`#include<shadowMapFragmentExtraDeclaration>
#ifdef ALPHATEXTURE
varying vec2 vUV;
uniform sampler2D diffuseSampler;
#endif
#include<clipPlaneFragmentDeclaration>
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void)
{
#include<clipPlaneFragment>
#ifdef ALPHATEXTURE
float alphaFromAlphaTexture=texture2D(diffuseSampler,vUV).a;
#ifdef ALPHATESTVALUE
if (alphaFromAlphaTexture<ALPHATESTVALUE)
discard;
#endif
#endif
#if SM_SOFTTRANSPARENTSHADOW==1
#ifdef ALPHATEXTURE
if ((bayerDither8(floor(mod(gl_FragCoord.xy,8.0))))/64.0>=softTransparentShadowSM*alphaFromAlphaTexture) discard;
#else
if ((bayerDither8(floor(mod(gl_FragCoord.xy,8.0))))/64.0>=softTransparentShadowSM) discard;
#endif
#endif
#include<shadowMapFragment>
}`;H.ShadersStore[kc]=Hc;const Ic="bonesDeclaration",Ec=`#if NUM_BONE_INFLUENCERS>0
attribute vec4 matricesIndices;
attribute vec4 matricesWeights;
#if NUM_BONE_INFLUENCERS>4
attribute vec4 matricesIndicesExtra;
attribute vec4 matricesWeightsExtra;
#endif
#ifndef BAKED_VERTEX_ANIMATION_TEXTURE
#ifdef BONETEXTURE
uniform sampler2D boneSampler;
uniform float boneTextureWidth;
#else
uniform mat4 mBones[BonesPerMesh];
#ifdef BONES_VELOCITY_ENABLED
uniform mat4 mPreviousBones[BonesPerMesh];
#endif
#endif
#ifdef BONETEXTURE
#define inline
mat4 readMatrixFromRawSampler(sampler2D smp,float index)
{
float offset=index *4.0;
float dx=1.0/boneTextureWidth;
vec4 m0=texture2D(smp,vec2(dx*(offset+0.5),0.));
vec4 m1=texture2D(smp,vec2(dx*(offset+1.5),0.));
vec4 m2=texture2D(smp,vec2(dx*(offset+2.5),0.));
vec4 m3=texture2D(smp,vec2(dx*(offset+3.5),0.));
return mat4(m0,m1,m2,m3);
}
#endif
#endif
#endif
`;H.IncludesShadersStore[Ic]=Ec;const Kc="bakedVertexAnimationDeclaration",Bc=`#ifdef BAKED_VERTEX_ANIMATION_TEXTURE
uniform float bakedVertexAnimationTime;
uniform vec2 bakedVertexAnimationTextureSizeInverted;
uniform vec4 bakedVertexAnimationSettings;
uniform sampler2D bakedVertexAnimationTexture;
#ifdef INSTANCES
attribute vec4 bakedVertexAnimationSettingsInstanced;
#endif
#define inline
mat4 readMatrixFromRawSamplerVAT(sampler2D smp,float index,float frame)
{
float offset=index*4.0;
float frameUV=(frame+0.5)*bakedVertexAnimationTextureSizeInverted.y;
float dx=bakedVertexAnimationTextureSizeInverted.x;
vec4 m0=texture2D(smp,vec2(dx*(offset+0.5),frameUV));
vec4 m1=texture2D(smp,vec2(dx*(offset+1.5),frameUV));
vec4 m2=texture2D(smp,vec2(dx*(offset+2.5),frameUV));
vec4 m3=texture2D(smp,vec2(dx*(offset+3.5),frameUV));
return mat4(m0,m1,m2,m3);
}
#endif
`;H.IncludesShadersStore[Kc]=Bc;const Qc="morphTargetsVertexGlobalDeclaration",Pc=`#ifdef MORPHTARGETS
uniform float morphTargetInfluences[NUM_MORPH_INFLUENCERS];
#ifdef MORPHTARGETS_TEXTURE 
precision mediump sampler2DArray; 
uniform float morphTargetTextureIndices[NUM_MORPH_INFLUENCERS];
uniform vec3 morphTargetTextureInfo;
uniform sampler2DArray morphTargets;
vec3 readVector3FromRawSampler(int targetIndex,float vertexIndex)
{ 
float y=floor(vertexIndex/morphTargetTextureInfo.y);
float x=vertexIndex-y*morphTargetTextureInfo.y;
vec3 textureUV=vec3((x+0.5)/morphTargetTextureInfo.y,(y+0.5)/morphTargetTextureInfo.z,morphTargetTextureIndices[targetIndex]);
return texture(morphTargets,textureUV).xyz;
}
#endif
#endif
`;H.IncludesShadersStore[Qc]=Pc;const wc="morphTargetsVertexDeclaration",_c=`#ifdef MORPHTARGETS
#ifndef MORPHTARGETS_TEXTURE
attribute vec3 position{X};
#ifdef MORPHTARGETS_NORMAL
attribute vec3 normal{X};
#endif
#ifdef MORPHTARGETS_TANGENT
attribute vec3 tangent{X};
#endif
#ifdef MORPHTARGETS_UV
attribute vec2 uv_{X};
#endif
#endif
#endif
`;H.IncludesShadersStore[wc]=_c;const Dc="helperFunctions",jc=`const float PI=3.1415926535897932384626433832795;
const float HALF_MIN=5.96046448e-08; 
const float LinearEncodePowerApprox=2.2;
const float GammaEncodePowerApprox=1.0/LinearEncodePowerApprox;
const vec3 LuminanceEncodeApprox=vec3(0.2126,0.7152,0.0722);
const float Epsilon=0.0000001;
#define saturate(x) clamp(x,0.0,1.0)
#define absEps(x) abs(x)+Epsilon
#define maxEps(x) max(x,Epsilon)
#define saturateEps(x) clamp(x,Epsilon,1.0)
mat3 transposeMat3(mat3 inMatrix) {
vec3 i0=inMatrix[0];
vec3 i1=inMatrix[1];
vec3 i2=inMatrix[2];
mat3 outMatrix=mat3(
vec3(i0.x,i1.x,i2.x),
vec3(i0.y,i1.y,i2.y),
vec3(i0.z,i1.z,i2.z)
);
return outMatrix;
}
mat3 inverseMat3(mat3 inMatrix) {
float a00=inMatrix[0][0],a01=inMatrix[0][1],a02=inMatrix[0][2];
float a10=inMatrix[1][0],a11=inMatrix[1][1],a12=inMatrix[1][2];
float a20=inMatrix[2][0],a21=inMatrix[2][1],a22=inMatrix[2][2];
float b01=a22*a11-a12*a21;
float b11=-a22*a10+a12*a20;
float b21=a21*a10-a11*a20;
float det=a00*b01+a01*b11+a02*b21;
return mat3(b01,(-a22*a01+a02*a21),(a12*a01-a02*a11),
b11,(a22*a00-a02*a20),(-a12*a00+a02*a10),
b21,(-a21*a00+a01*a20),(a11*a00-a01*a10))/det;
}
#if USE_EXACT_SRGB_CONVERSIONS
vec3 toLinearSpaceExact(vec3 color)
{
vec3 nearZeroSection=0.0773993808*color;
vec3 remainingSection=pow(0.947867299*(color+vec3(0.055)),vec3(2.4));
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
return mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.04045)));
#else
return
vec3(
color.r<=0.04045 ? nearZeroSection.r : remainingSection.r,
color.g<=0.04045 ? nearZeroSection.g : remainingSection.g,
color.b<=0.04045 ? nearZeroSection.b : remainingSection.b);
#endif
}
vec3 toGammaSpaceExact(vec3 color)
{
vec3 nearZeroSection=12.92*color;
vec3 remainingSection=1.055*pow(color,vec3(0.41666))-vec3(0.055);
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
return mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.0031308)));
#else
return
vec3(
color.r<=0.0031308 ? nearZeroSection.r : remainingSection.r,
color.g<=0.0031308 ? nearZeroSection.g : remainingSection.g,
color.b<=0.0031308 ? nearZeroSection.b : remainingSection.b);
#endif
}
#endif
float toLinearSpace(float color)
{
#if USE_EXACT_SRGB_CONVERSIONS
float nearZeroSection=0.0773993808*color;
float remainingSection=pow(0.947867299*(color+0.055),2.4);
return color<=0.04045 ? nearZeroSection : remainingSection;
#else
return pow(color,LinearEncodePowerApprox);
#endif
}
vec3 toLinearSpace(vec3 color)
{
#if USE_EXACT_SRGB_CONVERSIONS
return toLinearSpaceExact(color);
#else
return pow(color,vec3(LinearEncodePowerApprox));
#endif
}
vec4 toLinearSpace(vec4 color)
{
#if USE_EXACT_SRGB_CONVERSIONS
return vec4(toLinearSpaceExact(color.rgb),color.a);
#else
return vec4(pow(color.rgb,vec3(LinearEncodePowerApprox)),color.a);
#endif
}
float toGammaSpace(float color)
{
#if USE_EXACT_SRGB_CONVERSIONS
float nearZeroSection=12.92*color;
float remainingSection=1.055*pow(color,0.41666)-0.055;
return color<=0.0031308 ? nearZeroSection : remainingSection;
#else
return pow(color,GammaEncodePowerApprox);
#endif
}
vec3 toGammaSpace(vec3 color)
{
#if USE_EXACT_SRGB_CONVERSIONS
return toGammaSpaceExact(color);
#else
return pow(color,vec3(GammaEncodePowerApprox));
#endif
}
vec4 toGammaSpace(vec4 color)
{
#if USE_EXACT_SRGB_CONVERSIONS
return vec4(toGammaSpaceExact(color.rgb),color.a);
#else
return vec4(pow(color.rgb,vec3(GammaEncodePowerApprox)),color.a);
#endif
}
float square(float value)
{
return value*value;
}
vec3 square(vec3 value)
{
return value*value;
}
float pow5(float value) {
float sq=value*value;
return sq*sq*value;
}
float getLuminance(vec3 color)
{
return clamp(dot(color,LuminanceEncodeApprox),0.,1.);
}
float getRand(vec2 seed) {
return fract(sin(dot(seed.xy ,vec2(12.9898,78.233)))*43758.5453);
}
float dither(vec2 seed,float varianceAmount) {
float rand=getRand(seed);
float normVariance=varianceAmount/255.0;
float dither=mix(-normVariance,normVariance,rand);
return dither;
}
const float rgbdMaxRange=255.0;
vec4 toRGBD(vec3 color) {
float maxRGB=maxEps(max(color.r,max(color.g,color.b)));
float D =max(rgbdMaxRange/maxRGB,1.);
D =clamp(floor(D)/255.0,0.,1.);
vec3 rgb=color.rgb*D;
rgb=toGammaSpace(rgb);
return vec4(clamp(rgb,0.,1.),D); 
}
vec3 fromRGBD(vec4 rgbd) {
rgbd.rgb=toLinearSpace(rgbd.rgb);
return rgbd.rgb/rgbd.a;
}
vec3 parallaxCorrectNormal( vec3 vertexPos,vec3 origVec,vec3 cubeSize,vec3 cubePos ) {
vec3 invOrigVec=vec3(1.0,1.0,1.0)/origVec;
vec3 halfSize=cubeSize*0.5;
vec3 intersecAtMaxPlane=(cubePos+halfSize-vertexPos)*invOrigVec;
vec3 intersecAtMinPlane=(cubePos-halfSize-vertexPos)*invOrigVec;
vec3 largestIntersec=max(intersecAtMaxPlane,intersecAtMinPlane);
float distance=min(min(largestIntersec.x,largestIntersec.y),largestIntersec.z);
vec3 intersectPositionWS=vertexPos+origVec*distance;
return intersectPositionWS-cubePos;
}
`;H.IncludesShadersStore[Dc]=jc;const Ac="sceneVertexDeclaration",Oc=`uniform mat4 viewProjection;
#ifdef MULTIVIEW
uniform mat4 viewProjectionR;
#endif
uniform mat4 view;
uniform mat4 projection;
uniform vec4 vEyePosition;
`;H.IncludesShadersStore[Ac]=Oc;const qc="meshVertexDeclaration",$c=`uniform mat4 world;
uniform float visibility;
`;H.IncludesShadersStore[qc]=$c;const ln="shadowMapVertexDeclaration",en=`#include<sceneVertexDeclaration>
#include<meshVertexDeclaration>
`;H.IncludesShadersStore[ln]=en;const tn="sceneUboDeclaration",an=`layout(std140,column_major) uniform;
uniform Scene {
mat4 viewProjection;
#ifdef MULTIVIEW
mat4 viewProjectionR;
#endif 
mat4 view;
mat4 projection;
vec4 vEyePosition;
};
`;H.IncludesShadersStore[tn]=an;const sn="meshUboDeclaration",dn=`#ifdef WEBGL2
uniform mat4 world;
uniform float visibility;
#else
layout(std140,column_major) uniform;
uniform Mesh
{
mat4 world;
float visibility;
};
#endif
#define WORLD_UBO
`;H.IncludesShadersStore[sn]=dn;const cn="shadowMapUboDeclaration",nn=`layout(std140,column_major) uniform;
#include<sceneUboDeclaration>
#include<meshUboDeclaration>
`;H.IncludesShadersStore[cn]=nn;const Zn="shadowMapVertexExtraDeclaration",hn=`#if SM_NORMALBIAS==1
uniform vec3 lightDataSM;
#endif
uniform vec3 biasAndScaleSM;
uniform vec2 depthValuesSM;
varying float vDepthMetricSM;
#if SM_USEDISTANCE==1
varying vec3 vPositionWSM;
#endif
#if defined(SM_DEPTHCLAMP) && SM_DEPTHCLAMP==1
varying float zSM;
#endif
`;H.IncludesShadersStore[Zn]=hn;const mn="clipPlaneVertexDeclaration",on=`#ifdef CLIPPLANE
uniform vec4 vClipPlane;
varying float fClipDistance;
#endif
#ifdef CLIPPLANE2
uniform vec4 vClipPlane2;
varying float fClipDistance2;
#endif
#ifdef CLIPPLANE3
uniform vec4 vClipPlane3;
varying float fClipDistance3;
#endif
#ifdef CLIPPLANE4
uniform vec4 vClipPlane4;
varying float fClipDistance4;
#endif
#ifdef CLIPPLANE5
uniform vec4 vClipPlane5;
varying float fClipDistance5;
#endif
#ifdef CLIPPLANE6
uniform vec4 vClipPlane6;
varying float fClipDistance6;
#endif
`;H.IncludesShadersStore[mn]=on;const bn="morphTargetsVertexGlobal",Xn=`#ifdef MORPHTARGETS
#ifdef MORPHTARGETS_TEXTURE
float vertexID;
#endif
#endif
`;H.IncludesShadersStore[bn]=Xn;const un="morphTargetsVertex",rn=`#ifdef MORPHTARGETS
#ifdef MORPHTARGETS_TEXTURE 
vertexID=float(gl_VertexID)*morphTargetTextureInfo.x;
positionUpdated+=(readVector3FromRawSampler({X},vertexID)-position)*morphTargetInfluences[{X}];
vertexID+=1.0;
#ifdef MORPHTARGETS_NORMAL
normalUpdated+=(readVector3FromRawSampler({X},vertexID) -normal)*morphTargetInfluences[{X}];
vertexID+=1.0;
#endif
#ifdef MORPHTARGETS_UV
uvUpdated+=(readVector3FromRawSampler({X},vertexID).xy-uv)*morphTargetInfluences[{X}];
vertexID+=1.0;
#endif
#ifdef MORPHTARGETS_TANGENT
tangentUpdated.xyz+=(readVector3FromRawSampler({X},vertexID) -tangent.xyz)*morphTargetInfluences[{X}];
#endif
#else
positionUpdated+=(position{X}-position)*morphTargetInfluences[{X}];
#ifdef MORPHTARGETS_NORMAL
normalUpdated+=(normal{X}-normal)*morphTargetInfluences[{X}];
#endif
#ifdef MORPHTARGETS_TANGENT
tangentUpdated.xyz+=(tangent{X}-tangent.xyz)*morphTargetInfluences[{X}];
#endif
#ifdef MORPHTARGETS_UV
uvUpdated+=(uv_{X}-uv)*morphTargetInfluences[{X}];
#endif
#endif
#endif
`;H.IncludesShadersStore[un]=rn;const Gn="instancesVertex",Vn=`#ifdef INSTANCES
mat4 finalWorld=mat4(world0,world1,world2,world3);
#if defined(PREPASS_VELOCITY) || defined(VELOCITY)
mat4 finalPreviousWorld=mat4(previousWorld0,previousWorld1,previousWorld2,previousWorld3);
#endif
#ifdef THIN_INSTANCES
finalWorld=world*finalWorld;
#if defined(PREPASS_VELOCITY) || defined(VELOCITY)
finalPreviousWorld=previousWorld*finalPreviousWorld;
#endif
#endif
#else
mat4 finalWorld=world;
#if defined(PREPASS_VELOCITY) || defined(VELOCITY)
mat4 finalPreviousWorld=previousWorld;
#endif
#endif
`;H.IncludesShadersStore[Gn]=Vn;const Rn="bonesVertex",Wn=`#ifndef BAKED_VERTEX_ANIMATION_TEXTURE
#if NUM_BONE_INFLUENCERS>0
mat4 influence;
#ifdef BONETEXTURE
influence=readMatrixFromRawSampler(boneSampler,matricesIndices[0])*matricesWeights[0];
#if NUM_BONE_INFLUENCERS>1
influence+=readMatrixFromRawSampler(boneSampler,matricesIndices[1])*matricesWeights[1];
#endif
#if NUM_BONE_INFLUENCERS>2
influence+=readMatrixFromRawSampler(boneSampler,matricesIndices[2])*matricesWeights[2];
#endif
#if NUM_BONE_INFLUENCERS>3
influence+=readMatrixFromRawSampler(boneSampler,matricesIndices[3])*matricesWeights[3];
#endif
#if NUM_BONE_INFLUENCERS>4
influence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[0])*matricesWeightsExtra[0];
#endif
#if NUM_BONE_INFLUENCERS>5
influence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[1])*matricesWeightsExtra[1];
#endif
#if NUM_BONE_INFLUENCERS>6
influence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[2])*matricesWeightsExtra[2];
#endif
#if NUM_BONE_INFLUENCERS>7
influence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[3])*matricesWeightsExtra[3];
#endif
#else
influence=mBones[int(matricesIndices[0])]*matricesWeights[0];
#if NUM_BONE_INFLUENCERS>1
influence+=mBones[int(matricesIndices[1])]*matricesWeights[1];
#endif
#if NUM_BONE_INFLUENCERS>2
influence+=mBones[int(matricesIndices[2])]*matricesWeights[2];
#endif
#if NUM_BONE_INFLUENCERS>3
influence+=mBones[int(matricesIndices[3])]*matricesWeights[3];
#endif
#if NUM_BONE_INFLUENCERS>4
influence+=mBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];
#endif
#if NUM_BONE_INFLUENCERS>5
influence+=mBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];
#endif
#if NUM_BONE_INFLUENCERS>6
influence+=mBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];
#endif
#if NUM_BONE_INFLUENCERS>7
influence+=mBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];
#endif
#endif
finalWorld=finalWorld*influence;
#endif
#endif
`;H.IncludesShadersStore[Rn]=Wn;const pn="bakedVertexAnimation",yn=`#ifdef BAKED_VERTEX_ANIMATION_TEXTURE
{
#ifdef INSTANCES
#define BVASNAME bakedVertexAnimationSettingsInstanced
#else
#define BVASNAME bakedVertexAnimationSettings
#endif
float VATStartFrame=BVASNAME.x;
float VATEndFrame=BVASNAME.y;
float VATOffsetFrame=BVASNAME.z;
float VATSpeed=BVASNAME.w;
float totalFrames=VATEndFrame-VATStartFrame+1.0;
float time=bakedVertexAnimationTime*VATSpeed/totalFrames;
float frameCorrection=time<1.0 ? 0.0 : 1.0;
float numOfFrames=totalFrames-frameCorrection;
float VATFrameNum=fract(time)*numOfFrames;
VATFrameNum=mod(VATFrameNum+VATOffsetFrame,numOfFrames);
VATFrameNum=floor(VATFrameNum);
VATFrameNum+=VATStartFrame+frameCorrection;
mat4 VATInfluence;
VATInfluence=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[0],VATFrameNum)*matricesWeights[0];
#if NUM_BONE_INFLUENCERS>1
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[1],VATFrameNum)*matricesWeights[1];
#endif
#if NUM_BONE_INFLUENCERS>2
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[2],VATFrameNum)*matricesWeights[2];
#endif
#if NUM_BONE_INFLUENCERS>3
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[3],VATFrameNum)*matricesWeights[3];
#endif
#if NUM_BONE_INFLUENCERS>4
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[0],VATFrameNum)*matricesWeightsExtra[0];
#endif
#if NUM_BONE_INFLUENCERS>5
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[1],VATFrameNum)*matricesWeightsExtra[1];
#endif
#if NUM_BONE_INFLUENCERS>6
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[2],VATFrameNum)*matricesWeightsExtra[2];
#endif
#if NUM_BONE_INFLUENCERS>7
VATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[3],VATFrameNum)*matricesWeightsExtra[3];
#endif
finalWorld=finalWorld*VATInfluence;
}
#endif
`;H.IncludesShadersStore[pn]=yn;const Yn="shadowMapVertexNormalBias",Nn=`#if SM_NORMALBIAS==1
#if SM_DIRECTIONINLIGHTDATA==1
vec3 worldLightDirSM=normalize(-lightDataSM.xyz);
#else
vec3 directionToLightSM=lightDataSM.xyz-worldPos.xyz;
vec3 worldLightDirSM=normalize(directionToLightSM);
#endif
float ndlSM=dot(vNormalW,worldLightDirSM);
float sinNLSM=sqrt(1.0-ndlSM*ndlSM);
float normalBiasSM=biasAndScaleSM.y*sinNLSM;
worldPos.xyz-=vNormalW*normalBiasSM;
#endif
`;H.IncludesShadersStore[Yn]=Nn;const Fn="shadowMapVertexMetric",Sn=`#if SM_USEDISTANCE==1
vPositionWSM=worldPos.xyz;
#endif
#if SM_DEPTHTEXTURE==1
#ifdef IS_NDC_HALF_ZRANGE
#define BIASFACTOR 0.5
#else
#define BIASFACTOR 1.0
#endif
#ifdef USE_REVERSE_DEPTHBUFFER
gl_Position.z-=biasAndScaleSM.x*gl_Position.w*BIASFACTOR;
#else
gl_Position.z+=biasAndScaleSM.x*gl_Position.w*BIASFACTOR;
#endif
#endif
#if defined(SM_DEPTHCLAMP) && SM_DEPTHCLAMP==1
zSM=gl_Position.z;
gl_Position.z=0.0;
#elif SM_USEDISTANCE==0
#ifdef USE_REVERSE_DEPTHBUFFER
vDepthMetricSM=(-gl_Position.z+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;
#else
vDepthMetricSM=(gl_Position.z+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;
#endif
#endif
`;H.IncludesShadersStore[Fn]=Sn;const Ln="clipPlaneVertex",Jn=`#ifdef CLIPPLANE
fClipDistance=dot(worldPos,vClipPlane);
#endif
#ifdef CLIPPLANE2
fClipDistance2=dot(worldPos,vClipPlane2);
#endif
#ifdef CLIPPLANE3
fClipDistance3=dot(worldPos,vClipPlane3);
#endif
#ifdef CLIPPLANE4
fClipDistance4=dot(worldPos,vClipPlane4);
#endif
#ifdef CLIPPLANE5
fClipDistance5=dot(worldPos,vClipPlane5);
#endif
#ifdef CLIPPLANE6
fClipDistance6=dot(worldPos,vClipPlane6);
#endif
`;H.IncludesShadersStore[Ln]=Jn;const xn="shadowMapVertexShader",Un=`attribute vec3 position;
#ifdef NORMAL
attribute vec3 normal;
#endif
#include<bonesDeclaration>
#include<bakedVertexAnimationDeclaration>
#include<morphTargetsVertexGlobalDeclaration>
#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]
#ifdef INSTANCES
attribute vec4 world0;
attribute vec4 world1;
attribute vec4 world2;
attribute vec4 world3;
#endif
#include<helperFunctions>
#include<__decl__shadowMapVertex>
#ifdef ALPHATEXTURE
varying vec2 vUV;
uniform mat4 diffuseMatrix;
#ifdef UV1
attribute vec2 uv;
#endif
#ifdef UV2
attribute vec2 uv2;
#endif
#endif
#include<shadowMapVertexExtraDeclaration>
#include<clipPlaneVertexDeclaration>
#define CUSTOM_VERTEX_DEFINITIONS
void main(void)
{
vec3 positionUpdated=position;
#ifdef UV1
vec2 uvUpdated=uv;
#endif
#ifdef NORMAL
vec3 normalUpdated=normal;
#endif
#include<morphTargetsVertexGlobal>
#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]
#include<instancesVertex>
#include<bonesVertex>
#include<bakedVertexAnimation>
vec4 worldPos=finalWorld*vec4(positionUpdated,1.0);
#ifdef NORMAL
mat3 normWorldSM=mat3(finalWorld);
#if defined(INSTANCES) && defined(THIN_INSTANCES)
vec3 vNormalW=normalUpdated/vec3(dot(normWorldSM[0],normWorldSM[0]),dot(normWorldSM[1],normWorldSM[1]),dot(normWorldSM[2],normWorldSM[2]));
vNormalW=normalize(normWorldSM*vNormalW);
#else
#ifdef NONUNIFORMSCALING
normWorldSM=transposeMat3(inverseMat3(normWorldSM));
#endif
vec3 vNormalW=normalize(normWorldSM*normalUpdated);
#endif
#endif
#include<shadowMapVertexNormalBias>
gl_Position=viewProjection*worldPos;
#include<shadowMapVertexMetric>
#ifdef ALPHATEXTURE
#ifdef UV1
vUV=vec2(diffuseMatrix*vec4(uvUpdated,1.0,0.0));
#endif
#ifdef UV2
vUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));
#endif
#endif
#include<clipPlaneVertex>
}`;H.ShadersStore[xn]=Un;const fn="depthBoxBlurPixelShader",Tn=`varying vec2 vUV;
uniform sampler2D textureSampler;
uniform vec2 screenSize;
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void)
{
vec4 colorDepth=vec4(0.0);
for (int x=-OFFSET; x<=OFFSET; x++)
for (int y=-OFFSET; y<=OFFSET; y++)
colorDepth+=texture2D(textureSampler,vUV+vec2(x,y)/screenSize);
gl_FragColor=(colorDepth/float((OFFSET*2+1)*(OFFSET*2+1)));
}`;H.ShadersStore[fn]=Tn;const zn="shadowMapFragmentSoftTransparentShadow",Mn=`#if SM_SOFTTRANSPARENTSHADOW==1
if ((bayerDither8(floor(mod(gl_FragCoord.xy,8.0))))/64.0>=softTransparentShadowSM*alpha) discard;
#endif
`;H.IncludesShadersStore[zn]=Mn;class B{constructor(l,e,t,a){this.onBeforeShadowMapRenderObservable=new z,this.onAfterShadowMapRenderObservable=new z,this.onBeforeShadowMapRenderMeshObservable=new z,this.onAfterShadowMapRenderMeshObservable=new z,this._bias=5e-5,this._normalBias=0,this._blurBoxOffset=1,this._blurScale=2,this._blurKernel=1,this._useKernelBlur=!1,this._filter=B.FILTER_NONE,this._filteringQuality=B.QUALITY_HIGH,this._contactHardeningLightSizeUVRatio=.1,this._darkness=0,this._transparencyShadow=!1,this.enableSoftTransparentShadow=!1,this.useOpacityTextureForTransparentShadow=!1,this.frustumEdgeFalloff=0,this.forceBackFacesOnly=!1,this._lightDirection=r.Zero(),this._viewMatrix=Y.Zero(),this._projectionMatrix=Y.Zero(),this._transformMatrix=Y.Zero(),this._cachedPosition=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cachedDirection=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._currentFaceIndex=0,this._currentFaceIndexCache=0,this._defaultTextureMatrix=Y.Identity(),this._mapSize=l,this._light=e,this._scene=e.getScene(),this._camera=a??null;let s=e._shadowGenerators;s||(s=e._shadowGenerators=new Map),s.set(this._camera,this),this.id=e.id,this._useUBO=this._scene.getEngine().supportsUniformBuffers,this._useUBO&&(this._sceneUBOs=[],this._sceneUBOs.push(this._scene.createSceneUniformBuffer(`Scene for Shadow Generator (light "${this._light.name}")`))),B._SceneComponentInitialization(this._scene);const d=this._scene.getEngine().getCaps();t?d.textureFloatRender&&d.textureFloatLinearFiltering?this._textureType=1:d.textureHalfFloatRender&&d.textureHalfFloatLinearFiltering?this._textureType=2:this._textureType=0:d.textureHalfFloatRender&&d.textureHalfFloatLinearFiltering?this._textureType=2:d.textureFloatRender&&d.textureFloatLinearFiltering?this._textureType=1:this._textureType=0,this._initializeGenerator(),this._applyFilterValues()}get bias(){return this._bias}set bias(l){this._bias=l}get normalBias(){return this._normalBias}set normalBias(l){this._normalBias=l}get blurBoxOffset(){return this._blurBoxOffset}set blurBoxOffset(l){this._blurBoxOffset!==l&&(this._blurBoxOffset=l,this._disposeBlurPostProcesses())}get blurScale(){return this._blurScale}set blurScale(l){this._blurScale!==l&&(this._blurScale=l,this._disposeBlurPostProcesses())}get blurKernel(){return this._blurKernel}set blurKernel(l){this._blurKernel!==l&&(this._blurKernel=l,this._disposeBlurPostProcesses())}get useKernelBlur(){return this._useKernelBlur}set useKernelBlur(l){this._useKernelBlur!==l&&(this._useKernelBlur=l,this._disposeBlurPostProcesses())}get depthScale(){return this._depthScale!==void 0?this._depthScale:this._light.getDepthScale()}set depthScale(l){this._depthScale=l}_validateFilter(l){return l}get filter(){return this._filter}set filter(l){if(l=this._validateFilter(l),this._light.needCube()){if(l===B.FILTER_BLUREXPONENTIALSHADOWMAP){this.useExponentialShadowMap=!0;return}else if(l===B.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP){this.useCloseExponentialShadowMap=!0;return}else if(l===B.FILTER_PCF||l===B.FILTER_PCSS){this.usePoissonSampling=!0;return}}if((l===B.FILTER_PCF||l===B.FILTER_PCSS)&&!this._scene.getEngine()._features.supportShadowSamplers){this.usePoissonSampling=!0;return}this._filter!==l&&(this._filter=l,this._disposeBlurPostProcesses(),this._applyFilterValues(),this._light._markMeshesAsLightDirty())}get usePoissonSampling(){return this.filter===B.FILTER_POISSONSAMPLING}set usePoissonSampling(l){const e=this._validateFilter(B.FILTER_POISSONSAMPLING);!l&&this.filter!==B.FILTER_POISSONSAMPLING||(this.filter=l?e:B.FILTER_NONE)}get useExponentialShadowMap(){return this.filter===B.FILTER_EXPONENTIALSHADOWMAP}set useExponentialShadowMap(l){const e=this._validateFilter(B.FILTER_EXPONENTIALSHADOWMAP);!l&&this.filter!==B.FILTER_EXPONENTIALSHADOWMAP||(this.filter=l?e:B.FILTER_NONE)}get useBlurExponentialShadowMap(){return this.filter===B.FILTER_BLUREXPONENTIALSHADOWMAP}set useBlurExponentialShadowMap(l){const e=this._validateFilter(B.FILTER_BLUREXPONENTIALSHADOWMAP);!l&&this.filter!==B.FILTER_BLUREXPONENTIALSHADOWMAP||(this.filter=l?e:B.FILTER_NONE)}get useCloseExponentialShadowMap(){return this.filter===B.FILTER_CLOSEEXPONENTIALSHADOWMAP}set useCloseExponentialShadowMap(l){const e=this._validateFilter(B.FILTER_CLOSEEXPONENTIALSHADOWMAP);!l&&this.filter!==B.FILTER_CLOSEEXPONENTIALSHADOWMAP||(this.filter=l?e:B.FILTER_NONE)}get useBlurCloseExponentialShadowMap(){return this.filter===B.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP}set useBlurCloseExponentialShadowMap(l){const e=this._validateFilter(B.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP);!l&&this.filter!==B.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP||(this.filter=l?e:B.FILTER_NONE)}get usePercentageCloserFiltering(){return this.filter===B.FILTER_PCF}set usePercentageCloserFiltering(l){const e=this._validateFilter(B.FILTER_PCF);!l&&this.filter!==B.FILTER_PCF||(this.filter=l?e:B.FILTER_NONE)}get filteringQuality(){return this._filteringQuality}set filteringQuality(l){this._filteringQuality!==l&&(this._filteringQuality=l,this._disposeBlurPostProcesses(),this._applyFilterValues(),this._light._markMeshesAsLightDirty())}get useContactHardeningShadow(){return this.filter===B.FILTER_PCSS}set useContactHardeningShadow(l){const e=this._validateFilter(B.FILTER_PCSS);!l&&this.filter!==B.FILTER_PCSS||(this.filter=l?e:B.FILTER_NONE)}get contactHardeningLightSizeUVRatio(){return this._contactHardeningLightSizeUVRatio}set contactHardeningLightSizeUVRatio(l){this._contactHardeningLightSizeUVRatio=l}get darkness(){return this._darkness}set darkness(l){this.setDarkness(l)}getDarkness(){return this._darkness}setDarkness(l){return l>=1?this._darkness=1:l<=0?this._darkness=0:this._darkness=l,this}get transparencyShadow(){return this._transparencyShadow}set transparencyShadow(l){this.setTransparencyShadow(l)}setTransparencyShadow(l){return this._transparencyShadow=l,this}getShadowMap(){return this._shadowMap}getShadowMapForRendering(){return this._shadowMap2?this._shadowMap2:this._shadowMap}getClassName(){return B.CLASSNAME}addShadowCaster(l,e=!0){if(!this._shadowMap)return this;if(this._shadowMap.renderList||(this._shadowMap.renderList=[]),this._shadowMap.renderList.indexOf(l)===-1&&this._shadowMap.renderList.push(l),e)for(const t of l.getChildMeshes())this._shadowMap.renderList.indexOf(t)===-1&&this._shadowMap.renderList.push(t);return this}removeShadowCaster(l,e=!0){if(!this._shadowMap||!this._shadowMap.renderList)return this;const t=this._shadowMap.renderList.indexOf(l);if(t!==-1&&this._shadowMap.renderList.splice(t,1),e)for(const a of l.getChildren())this.removeShadowCaster(a);return this}getLight(){return this._light}_getCamera(){var l;return(l=this._camera)!==null&&l!==void 0?l:this._scene.activeCamera}get mapSize(){return this._mapSize}set mapSize(l){this._mapSize=l,this._light._markMeshesAsLightDirty(),this.recreateShadowMap()}_initializeGenerator(){this._light._markMeshesAsLightDirty(),this._initializeShadowMap()}_createTargetRenderTexture(){const l=this._scene.getEngine();l._features.supportDepthStencilTexture?(this._shadowMap=new Ge(this._light.name+"_shadowMap",this._mapSize,this._scene,!1,!0,this._textureType,this._light.needCube(),void 0,!1,!1),this._shadowMap.createDepthStencilTexture(l.useReverseDepthBuffer?516:513,!0)):this._shadowMap=new Ge(this._light.name+"_shadowMap",this._mapSize,this._scene,!1,!0,this._textureType,this._light.needCube())}_initializeShadowMap(){if(this._createTargetRenderTexture(),this._shadowMap===null)return;this._shadowMap.wrapU=v.CLAMP_ADDRESSMODE,this._shadowMap.wrapV=v.CLAMP_ADDRESSMODE,this._shadowMap.anisotropicFilteringLevel=1,this._shadowMap.updateSamplingMode(v.BILINEAR_SAMPLINGMODE),this._shadowMap.renderParticles=!1,this._shadowMap.ignoreCameraViewport=!0,this._storedUniqueId&&(this._shadowMap.uniqueId=this._storedUniqueId),this._shadowMap.customRenderFunction=this._renderForShadowMap.bind(this),this._shadowMap.customIsReadyFunction=()=>!0;const l=this._scene.getEngine();this._shadowMap.onBeforeBindObservable.add(()=>{var a;this._currentSceneUBO=this._scene.getSceneUniformBuffer(),(a=l._debugPushGroup)===null||a===void 0||a.call(l,`shadow map generation for pass id ${l.currentRenderPassId}`,1)}),this._shadowMap.onBeforeRenderObservable.add(a=>{this._sceneUBOs&&this._scene.setSceneUniformBuffer(this._sceneUBOs[0]),this._currentFaceIndex=a,this._filter===B.FILTER_PCF&&l.setColorWrite(!1),this.getTransformMatrix(),this._scene.setTransformMatrix(this._viewMatrix,this._projectionMatrix),this._useUBO&&(this._scene.getSceneUniformBuffer().unbindEffect(),this._scene.finalizeSceneUbo())}),this._shadowMap.onAfterUnbindObservable.add(()=>{var a,s;if(this._sceneUBOs&&this._scene.setSceneUniformBuffer(this._currentSceneUBO),this._scene.updateTransformMatrix(),this._filter===B.FILTER_PCF&&l.setColorWrite(!0),!this.useBlurExponentialShadowMap&&!this.useBlurCloseExponentialShadowMap){(a=l._debugPopGroup)===null||a===void 0||a.call(l,1);return}const d=this.getShadowMapForRendering();d&&(this._scene.postProcessManager.directRender(this._blurPostProcesses,d.renderTarget,!0),l.unBindFramebuffer(d.renderTarget,!0),(s=l._debugPopGroup)===null||s===void 0||s.call(l,1))});const e=new Gl(0,0,0,0),t=new Gl(1,1,1,1);this._shadowMap.onClearObservable.add(a=>{this._filter===B.FILTER_PCF?a.clear(t,!1,!0,!1):this.useExponentialShadowMap||this.useBlurExponentialShadowMap?a.clear(e,!0,!0,!1):a.clear(t,!0,!0,!1)}),this._shadowMap.onResizeObservable.add(a=>{this._storedUniqueId=this._shadowMap.uniqueId,this._mapSize=a.getRenderSize(),this._light._markMeshesAsLightDirty(),this.recreateShadowMap()});for(let a=El.MIN_RENDERINGGROUPS;a<El.MAX_RENDERINGGROUPS;a++)this._shadowMap.setRenderingAutoClearDepthStencil(a,!1)}_initializeBlurRTTAndPostProcesses(){const l=this._scene.getEngine(),e=this._mapSize/this.blurScale;(!this.useKernelBlur||this.blurScale!==1)&&(this._shadowMap2=new Ge(this._light.name+"_shadowMap2",e,this._scene,!1,!0,this._textureType,void 0,void 0,!1),this._shadowMap2.wrapU=v.CLAMP_ADDRESSMODE,this._shadowMap2.wrapV=v.CLAMP_ADDRESSMODE,this._shadowMap2.updateSamplingMode(v.BILINEAR_SAMPLINGMODE)),this.useKernelBlur?(this._kernelBlurXPostprocess=new dt(this._light.name+"KernelBlurX",new Wl(1,0),this.blurKernel,1,null,v.BILINEAR_SAMPLINGMODE,l,!1,this._textureType),this._kernelBlurXPostprocess.width=e,this._kernelBlurXPostprocess.height=e,this._kernelBlurXPostprocess.externalTextureSamplerBinding=!0,this._kernelBlurXPostprocess.onApplyObservable.add(t=>{t.setTexture("textureSampler",this._shadowMap)}),this._kernelBlurYPostprocess=new dt(this._light.name+"KernelBlurY",new Wl(0,1),this.blurKernel,1,null,v.BILINEAR_SAMPLINGMODE,l,!1,this._textureType),this._kernelBlurXPostprocess.autoClear=!1,this._kernelBlurYPostprocess.autoClear=!1,this._textureType===0&&(this._kernelBlurXPostprocess.packedFloat=!0,this._kernelBlurYPostprocess.packedFloat=!0),this._blurPostProcesses=[this._kernelBlurXPostprocess,this._kernelBlurYPostprocess]):(this._boxBlurPostprocess=new yl(this._light.name+"DepthBoxBlur","depthBoxBlur",["screenSize","boxOffset"],[],1,null,v.BILINEAR_SAMPLINGMODE,l,!1,"#define OFFSET "+this._blurBoxOffset,this._textureType),this._boxBlurPostprocess.externalTextureSamplerBinding=!0,this._boxBlurPostprocess.onApplyObservable.add(t=>{t.setFloat2("screenSize",e,e),t.setTexture("textureSampler",this._shadowMap)}),this._boxBlurPostprocess.autoClear=!1,this._blurPostProcesses=[this._boxBlurPostprocess])}_renderForShadowMap(l,e,t,a){let s;if(a.length)for(s=0;s<a.length;s++)this._renderSubMeshForShadowMap(a.data[s]);for(s=0;s<l.length;s++)this._renderSubMeshForShadowMap(l.data[s]);for(s=0;s<e.length;s++)this._renderSubMeshForShadowMap(e.data[s]);if(this._transparencyShadow)for(s=0;s<t.length;s++)this._renderSubMeshForShadowMap(t.data[s],!0);else for(s=0;s<t.length;s++)t.data[s].getEffectiveMesh()._internalAbstractMeshDataInfo._isActiveIntermediate=!1}_bindCustomEffectForRenderSubMeshForShadowMap(l,e,t){e.setMatrix("viewProjection",this.getTransformMatrix())}_renderSubMeshForShadowMap(l,e=!1){var t,a;const s=l.getRenderingMesh(),d=l.getEffectiveMesh(),i=this._scene,c=i.getEngine(),n=l.getMaterial();if(d._internalAbstractMeshDataInfo._isActiveIntermediate=!1,!n||l.verticesCount===0||l._renderId===i.getRenderId())return;const h=d._getWorldMatrixDeterminant()<0;let m=(t=s.overrideMaterialSideOrientation)!==null&&t!==void 0?t:n.sideOrientation;h&&(m=m===0?1:0);const o=m===0;c.setState(n.backFaceCulling,void 0,void 0,o,n.cullBackFaces);const b=s._getInstancesRenderList(l._id,!!l.getReplacementMesh());if(b.mustReturn)return;const u=c.getCaps().instancedArrays&&(b.visibleInstances[l._id]!==null&&b.visibleInstances[l._id]!==void 0||s.hasThinInstances);if(!(this.customAllowRendering&&!this.customAllowRendering(l)))if(this.isReady(l,u,e)){l._renderId=i.getRenderId();const V=n.shadowDepthWrapper,G=(a=V==null?void 0:V.getEffect(l,this,c.currentRenderPassId))!==null&&a!==void 0?a:l._getDrawWrapper(),p=Mt.GetEffect(G);c.enableEffect(G),u||s._bind(l,p,n.fillMode),this.getTransformMatrix(),p.setFloat3("biasAndScaleSM",this.bias,this.normalBias,this.depthScale),this.getLight().getTypeID()===nl.LIGHTTYPEID_DIRECTIONALLIGHT?p.setVector3("lightDataSM",this._cachedDirection):p.setVector3("lightDataSM",this._cachedPosition);const y=this._getCamera();if(y&&p.setFloat2("depthValuesSM",this.getLight().getDepthMinZ(y),this.getLight().getDepthMinZ(y)+this.getLight().getDepthMaxZ(y)),e&&this.enableSoftTransparentShadow&&p.setFloat("softTransparentShadowSM",d.visibility*n.alpha),V)l._setMainDrawWrapperOverride(G),V.standalone?V.baseMaterial.bindForSubMesh(d.getWorldMatrix(),s,l):n.bindForSubMesh(d.getWorldMatrix(),s,l),l._setMainDrawWrapperOverride(null);else{if(this.useOpacityTextureForTransparentShadow){const N=n.opacityTexture;N&&(p.setTexture("diffuseSampler",N),p.setMatrix("diffuseMatrix",N.getTextureMatrix()||this._defaultTextureMatrix))}else if(n.needAlphaTesting()||n.needAlphaBlending()){const N=n.getAlphaTestTexture();N&&(p.setTexture("diffuseSampler",N),p.setMatrix("diffuseMatrix",N.getTextureMatrix()||this._defaultTextureMatrix))}if(s.useBones&&s.computeBonesUsingShaders&&s.skeleton){const N=s.skeleton;if(N.isUsingTextureForMatrices){const J=N.getTransformMatrixTexture(s);if(!J)return;p.setTexture("boneSampler",J),p.setFloat("boneTextureWidth",4*(N.bones.length+1))}else p.setMatrices("mBones",N.getTransformMatrices(s))}tl.BindMorphTargetParameters(s,p),s.morphTargetManager&&s.morphTargetManager.isUsingTextureForTargets&&s.morphTargetManager._bind(p),Ua(p,n,i)}!this._useUBO&&!V&&this._bindCustomEffectForRenderSubMeshForShadowMap(l,p,d),tl.BindSceneUniformBuffer(p,this._scene.getSceneUniformBuffer()),this._scene.getSceneUniformBuffer().bindUniformBuffer();const L=d.getWorldMatrix();u&&(d.getMeshUniformBuffer().bindToEffect(p,"Mesh"),d.transferToEffect(L)),this.forceBackFacesOnly&&c.setState(!0,0,!1,!0,n.cullBackFaces),this.onBeforeShadowMapRenderMeshObservable.notifyObservers(s),this.onBeforeShadowMapRenderObservable.notifyObservers(p),s._processRendering(d,l,p,n.fillMode,b,u,(N,J)=>{d!==s&&!N?(s.getMeshUniformBuffer().bindToEffect(p,"Mesh"),s.transferToEffect(J)):(d.getMeshUniformBuffer().bindToEffect(p,"Mesh"),d.transferToEffect(N?J:L))}),this.forceBackFacesOnly&&c.setState(!0,0,!1,!1,n.cullBackFaces),this.onAfterShadowMapRenderObservable.notifyObservers(p),this.onAfterShadowMapRenderMeshObservable.notifyObservers(s)}else this._shadowMap&&this._shadowMap.resetRefreshCounter()}_applyFilterValues(){this._shadowMap&&(this.filter===B.FILTER_NONE||this.filter===B.FILTER_PCSS?this._shadowMap.updateSamplingMode(v.NEAREST_SAMPLINGMODE):this._shadowMap.updateSamplingMode(v.BILINEAR_SAMPLINGMODE))}forceCompilation(l,e){const t={useInstances:!1,...e},a=this.getShadowMap();if(!a){l&&l(this);return}const s=a.renderList;if(!s){l&&l(this);return}const d=new Array;for(const n of s)d.push(...n.subMeshes);if(d.length===0){l&&l(this);return}let i=0;const c=()=>{var n,h;if(!(!this._scene||!this._scene.getEngine())){for(;this.isReady(d[i],t.useInstances,(h=(n=d[i].getMaterial())===null||n===void 0?void 0:n.needAlphaBlendingForMesh(d[i].getMesh()))!==null&&h!==void 0?h:!1);)if(i++,i>=d.length){l&&l(this);return}setTimeout(c,16)}};c()}forceCompilationAsync(l){return new Promise(e=>{this.forceCompilation(()=>{e()},l)})}_isReadyCustomDefines(l,e,t){}_prepareShadowDefines(l,e,t,a){t.push("#define SM_LIGHTTYPE_"+this._light.getClassName().toUpperCase()),t.push("#define SM_FLOAT "+(this._textureType!==0?"1":"0")),t.push("#define SM_ESM "+(this.useExponentialShadowMap||this.useBlurExponentialShadowMap?"1":"0")),t.push("#define SM_DEPTHTEXTURE "+(this.usePercentageCloserFiltering||this.useContactHardeningShadow?"1":"0"));const s=l.getMesh();return t.push("#define SM_NORMALBIAS "+(this.normalBias&&s.isVerticesDataPresent(X.NormalKind)?"1":"0")),t.push("#define SM_DIRECTIONINLIGHTDATA "+(this.getLight().getTypeID()===nl.LIGHTTYPEID_DIRECTIONALLIGHT?"1":"0")),t.push("#define SM_USEDISTANCE "+(this._light.needCube()?"1":"0")),t.push("#define SM_SOFTTRANSPARENTSHADOW "+(this.enableSoftTransparentShadow&&a?"1":"0")),this._isReadyCustomDefines(t,l,e),t}isReady(l,e,t){var a;const s=l.getMaterial(),d=s==null?void 0:s.shadowDepthWrapper;if(!s)return!1;const i=[];if(this._prepareShadowDefines(l,e,i,t),d){if(!d.isReadyForSubMesh(l,i,this,e,this._scene.getEngine().currentRenderPassId))return!1}else{const c=l._getDrawWrapper(void 0,!0);let n=c.effect,h=c.defines;const m=[X.PositionKind],o=l.getMesh();this.normalBias&&o.isVerticesDataPresent(X.NormalKind)&&(m.push(X.NormalKind),i.push("#define NORMAL"),o.nonUniformScaling&&i.push("#define NONUNIFORMSCALING"));const b=s==null?void 0:s.needAlphaTesting(),u=s==null?void 0:s.needAlphaBlending();if(s&&(b||u)){let L=null;if(this.useOpacityTextureForTransparentShadow?L=s.opacityTexture:L=s.getAlphaTestTexture(),L){if(!L.isReady())return!1;const N=(a=s.alphaCutOff)!==null&&a!==void 0?a:B.DEFAULT_ALPHA_CUTOFF;i.push("#define ALPHATEXTURE"),b&&i.push(`#define ALPHATESTVALUE ${N}${N%1===0?".":""}`),o.isVerticesDataPresent(X.UVKind)&&(m.push(X.UVKind),i.push("#define UV1")),o.isVerticesDataPresent(X.UV2Kind)&&L.coordinatesIndex===1&&(m.push(X.UV2Kind),i.push("#define UV2"))}}const V=new Ls;if(o.useBones&&o.computeBonesUsingShaders&&o.skeleton){m.push(X.MatricesIndicesKind),m.push(X.MatricesWeightsKind),o.numBoneInfluencers>4&&(m.push(X.MatricesIndicesExtraKind),m.push(X.MatricesWeightsExtraKind));const L=o.skeleton;i.push("#define NUM_BONE_INFLUENCERS "+o.numBoneInfluencers),o.numBoneInfluencers>0&&V.addCPUSkinningFallback(0,o),L.isUsingTextureForMatrices?i.push("#define BONETEXTURE"):i.push("#define BonesPerMesh "+(L.bones.length+1))}else i.push("#define NUM_BONE_INFLUENCERS 0");const G=o.morphTargetManager;let p=0;if(G&&G.numInfluencers>0&&(i.push("#define MORPHTARGETS"),p=G.numInfluencers,i.push("#define NUM_MORPH_INFLUENCERS "+p),G.isUsingTextureForTargets&&i.push("#define MORPHTARGETS_TEXTURE"),tl.PrepareAttributesForMorphTargetsInfluencers(m,o,p)),Fs(s,this._scene,i),e&&(i.push("#define INSTANCES"),tl.PushAttributesForInstances(m),l.getRenderingMesh().hasThinInstances&&i.push("#define THIN_INSTANCES")),this.customShaderOptions&&this.customShaderOptions.defines)for(const L of this.customShaderOptions.defines)i.indexOf(L)===-1&&i.push(L);const y=i.join(`
`);if(h!==y){h=y;let L="shadowMap";const N=["world","mBones","viewProjection","diffuseMatrix","lightDataSM","depthValuesSM","biasAndScaleSM","morphTargetInfluences","boneTextureWidth","softTransparentShadowSM","morphTargetTextureInfo","morphTargetTextureIndices"],J=["diffuseSampler","boneSampler","morphTargets"],R=["Scene","Mesh"];if(xa(N),this.customShaderOptions){if(L=this.customShaderOptions.shaderName,this.customShaderOptions.attributes)for(const T of this.customShaderOptions.attributes)m.indexOf(T)===-1&&m.push(T);if(this.customShaderOptions.uniforms)for(const T of this.customShaderOptions.uniforms)N.indexOf(T)===-1&&N.push(T);if(this.customShaderOptions.samplers)for(const T of this.customShaderOptions.samplers)J.indexOf(T)===-1&&J.push(T)}const S=this._scene.getEngine();n=S.createEffect(L,{attributes:m,uniformsNames:N,uniformBuffersNames:R,samplers:J,defines:y,fallbacks:V,onCompiled:null,onError:null,indexParameters:{maxSimultaneousMorphTargets:p}},S),c.setEffect(n,h)}if(!n.isReady())return!1}return(this.useBlurExponentialShadowMap||this.useBlurCloseExponentialShadowMap)&&(!this._blurPostProcesses||!this._blurPostProcesses.length)&&this._initializeBlurRTTAndPostProcesses(),!(this._kernelBlurXPostprocess&&!this._kernelBlurXPostprocess.isReady()||this._kernelBlurYPostprocess&&!this._kernelBlurYPostprocess.isReady()||this._boxBlurPostprocess&&!this._boxBlurPostprocess.isReady())}prepareDefines(l,e){const t=this._scene,a=this._light;!t.shadowsEnabled||!a.shadowEnabled||(l["SHADOW"+e]=!0,this.useContactHardeningShadow?(l["SHADOWPCSS"+e]=!0,this._filteringQuality===B.QUALITY_LOW?l["SHADOWLOWQUALITY"+e]=!0:this._filteringQuality===B.QUALITY_MEDIUM&&(l["SHADOWMEDIUMQUALITY"+e]=!0)):this.usePercentageCloserFiltering?(l["SHADOWPCF"+e]=!0,this._filteringQuality===B.QUALITY_LOW?l["SHADOWLOWQUALITY"+e]=!0:this._filteringQuality===B.QUALITY_MEDIUM&&(l["SHADOWMEDIUMQUALITY"+e]=!0)):this.usePoissonSampling?l["SHADOWPOISSON"+e]=!0:this.useExponentialShadowMap||this.useBlurExponentialShadowMap?l["SHADOWESM"+e]=!0:(this.useCloseExponentialShadowMap||this.useBlurCloseExponentialShadowMap)&&(l["SHADOWCLOSEESM"+e]=!0),a.needCube()&&(l["SHADOWCUBE"+e]=!0))}bindShadowLight(l,e){const t=this._light;if(!this._scene.shadowsEnabled||!t.shadowEnabled)return;const a=this._getCamera();if(!a)return;const s=this.getShadowMap();s&&(t.needCube()||e.setMatrix("lightMatrix"+l,this.getTransformMatrix()),this._filter===B.FILTER_PCF?(e.setDepthStencilTexture("shadowSampler"+l,this.getShadowMapForRendering()),t._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),s.getSize().width,1/s.getSize().width,this.frustumEdgeFalloff,l)):this._filter===B.FILTER_PCSS?(e.setDepthStencilTexture("shadowSampler"+l,this.getShadowMapForRendering()),e.setTexture("depthSampler"+l,this.getShadowMapForRendering()),t._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),1/s.getSize().width,this._contactHardeningLightSizeUVRatio*s.getSize().width,this.frustumEdgeFalloff,l)):(e.setTexture("shadowSampler"+l,this.getShadowMapForRendering()),t._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),this.blurScale/s.getSize().width,this.depthScale,this.frustumEdgeFalloff,l)),t._uniformBuffer.updateFloat2("depthValues",this.getLight().getDepthMinZ(a),this.getLight().getDepthMinZ(a)+this.getLight().getDepthMaxZ(a),l))}getTransformMatrix(){const l=this._scene;if(this._currentRenderId===l.getRenderId()&&this._currentFaceIndexCache===this._currentFaceIndex)return this._transformMatrix;this._currentRenderId=l.getRenderId(),this._currentFaceIndexCache=this._currentFaceIndex;let e=this._light.position;if(this._light.computeTransformedInformation()&&(e=this._light.transformedPosition),r.NormalizeToRef(this._light.getShadowDirection(this._currentFaceIndex),this._lightDirection),Math.abs(r.Dot(this._lightDirection,r.Up()))===1&&(this._lightDirection.z=1e-13),this._light.needProjectionMatrixCompute()||!this._cachedPosition||!this._cachedDirection||!e.equals(this._cachedPosition)||!this._lightDirection.equals(this._cachedDirection)){this._cachedPosition.copyFrom(e),this._cachedDirection.copyFrom(this._lightDirection),Y.LookAtLHToRef(e,e.add(this._lightDirection),r.Up(),this._viewMatrix);const t=this.getShadowMap();if(t){const a=t.renderList;a&&this._light.setShadowProjectionMatrix(this._projectionMatrix,this._viewMatrix,a)}this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix)}return this._transformMatrix}recreateShadowMap(){const l=this._shadowMap;if(!l)return;const e=l.renderList;if(this._disposeRTTandPostProcesses(),this._initializeGenerator(),this.filter=this._filter,this._applyFilterValues(),e){this._shadowMap.renderList||(this._shadowMap.renderList=[]);for(const t of e)this._shadowMap.renderList.push(t)}else this._shadowMap.renderList=null}_disposeBlurPostProcesses(){this._shadowMap2&&(this._shadowMap2.dispose(),this._shadowMap2=null),this._boxBlurPostprocess&&(this._boxBlurPostprocess.dispose(),this._boxBlurPostprocess=null),this._kernelBlurXPostprocess&&(this._kernelBlurXPostprocess.dispose(),this._kernelBlurXPostprocess=null),this._kernelBlurYPostprocess&&(this._kernelBlurYPostprocess.dispose(),this._kernelBlurYPostprocess=null),this._blurPostProcesses=[]}_disposeRTTandPostProcesses(){this._shadowMap&&(this._shadowMap.dispose(),this._shadowMap=null),this._disposeBlurPostProcesses()}_disposeSceneUBOs(){if(this._sceneUBOs){for(const l of this._sceneUBOs)l.dispose();this._sceneUBOs=[]}}dispose(){if(this._disposeRTTandPostProcesses(),this._disposeSceneUBOs(),this._light){if(this._light._shadowGenerators){const l=this._light._shadowGenerators.entries();for(let e=l.next();e.done!==!0;e=l.next()){const[t,a]=e.value;a===this&&this._light._shadowGenerators.delete(t)}this._light._shadowGenerators.size===0&&(this._light._shadowGenerators=null)}this._light._markMeshesAsLightDirty()}this.onBeforeShadowMapRenderMeshObservable.clear(),this.onBeforeShadowMapRenderObservable.clear(),this.onAfterShadowMapRenderMeshObservable.clear(),this.onAfterShadowMapRenderObservable.clear()}serialize(){var l;const e={},t=this.getShadowMap();if(!t)return e;if(e.className=this.getClassName(),e.lightId=this._light.id,e.cameraId=(l=this._camera)===null||l===void 0?void 0:l.id,e.id=this.id,e.mapSize=t.getRenderSize(),e.forceBackFacesOnly=this.forceBackFacesOnly,e.darkness=this.getDarkness(),e.transparencyShadow=this._transparencyShadow,e.frustumEdgeFalloff=this.frustumEdgeFalloff,e.bias=this.bias,e.normalBias=this.normalBias,e.usePercentageCloserFiltering=this.usePercentageCloserFiltering,e.useContactHardeningShadow=this.useContactHardeningShadow,e.contactHardeningLightSizeUVRatio=this.contactHardeningLightSizeUVRatio,e.filteringQuality=this.filteringQuality,e.useExponentialShadowMap=this.useExponentialShadowMap,e.useBlurExponentialShadowMap=this.useBlurExponentialShadowMap,e.useCloseExponentialShadowMap=this.useBlurExponentialShadowMap,e.useBlurCloseExponentialShadowMap=this.useBlurExponentialShadowMap,e.usePoissonSampling=this.usePoissonSampling,e.depthScale=this.depthScale,e.blurBoxOffset=this.blurBoxOffset,e.blurKernel=this.blurKernel,e.blurScale=this.blurScale,e.useKernelBlur=this.useKernelBlur,e.renderList=[],t.renderList)for(let a=0;a<t.renderList.length;a++){const s=t.renderList[a];e.renderList.push(s.id)}return e}static Parse(l,e,t){const a=e.getLightById(l.lightId),s=l.cameraId!==void 0?e.getCameraById(l.cameraId):null,d=t?t(l.mapSize,a,s):new B(l.mapSize,a,void 0,s),i=d.getShadowMap();for(let c=0;c<l.renderList.length;c++)e.getMeshesById(l.renderList[c]).forEach(function(n){i&&(i.renderList||(i.renderList=[]),i.renderList.push(n))});return l.id!==void 0&&(d.id=l.id),d.forceBackFacesOnly=!!l.forceBackFacesOnly,l.darkness!==void 0&&d.setDarkness(l.darkness),l.transparencyShadow&&d.setTransparencyShadow(!0),l.frustumEdgeFalloff!==void 0&&(d.frustumEdgeFalloff=l.frustumEdgeFalloff),l.bias!==void 0&&(d.bias=l.bias),l.normalBias!==void 0&&(d.normalBias=l.normalBias),l.usePercentageCloserFiltering?d.usePercentageCloserFiltering=!0:l.useContactHardeningShadow?d.useContactHardeningShadow=!0:l.usePoissonSampling?d.usePoissonSampling=!0:l.useExponentialShadowMap?d.useExponentialShadowMap=!0:l.useBlurExponentialShadowMap?d.useBlurExponentialShadowMap=!0:l.useCloseExponentialShadowMap?d.useCloseExponentialShadowMap=!0:l.useBlurCloseExponentialShadowMap?d.useBlurCloseExponentialShadowMap=!0:l.useVarianceShadowMap?d.useExponentialShadowMap=!0:l.useBlurVarianceShadowMap&&(d.useBlurExponentialShadowMap=!0),l.contactHardeningLightSizeUVRatio!==void 0&&(d.contactHardeningLightSizeUVRatio=l.contactHardeningLightSizeUVRatio),l.filteringQuality!==void 0&&(d.filteringQuality=l.filteringQuality),l.depthScale&&(d.depthScale=l.depthScale),l.blurScale&&(d.blurScale=l.blurScale),l.blurBoxOffset&&(d.blurBoxOffset=l.blurBoxOffset),l.useKernelBlur&&(d.useKernelBlur=l.useKernelBlur),l.blurKernel&&(d.blurKernel=l.blurKernel),d}}B.CLASSNAME="ShadowGenerator";B.FILTER_NONE=0;B.FILTER_EXPONENTIALSHADOWMAP=1;B.FILTER_POISSONSAMPLING=2;B.FILTER_BLUREXPONENTIALSHADOWMAP=3;B.FILTER_CLOSEEXPONENTIALSHADOWMAP=4;B.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP=5;B.FILTER_PCF=6;B.FILTER_PCSS=7;B.QUALITY_HIGH=0;B.QUALITY_MEDIUM=1;B.QUALITY_LOW=2;B.DEFAULT_ALPHA_CUTOFF=.5;B._SceneComponentInitialization=Z=>{throw O("ShadowGeneratorSceneComponent")};const gn="depthPixelShader",Cn=`#ifdef ALPHATEST
varying vec2 vUV;
uniform sampler2D diffuseSampler;
#endif
#include<clipPlaneFragmentDeclaration>
varying float vDepthMetric;
#ifdef PACKED
#include<packingFunctions>
#endif
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void)
{
#include<clipPlaneFragment>
#ifdef ALPHATEST
if (texture2D(diffuseSampler,vUV).a<0.4)
discard;
#endif
#ifdef NONLINEARDEPTH
#ifdef PACKED
gl_FragColor=pack(gl_FragCoord.z);
#else
gl_FragColor=vec4(gl_FragCoord.z,0.0,0.0,0.0);
#endif
#else
#ifdef PACKED
gl_FragColor=pack(vDepthMetric);
#else
gl_FragColor=vec4(vDepthMetric,0.0,0.0,1.0);
#endif
#endif
}`;H.ShadersStore[gn]=Cn;const vn="instancesDeclaration",kn=`#ifdef INSTANCES
attribute vec4 world0;
attribute vec4 world1;
attribute vec4 world2;
attribute vec4 world3;
#ifdef INSTANCESCOLOR
attribute vec4 instanceColor;
#endif
#if defined(THIN_INSTANCES) && !defined(WORLD_UBO)
uniform mat4 world;
#endif
#if defined(VELOCITY) || defined(PREPASS_VELOCITY)
attribute vec4 previousWorld0;
attribute vec4 previousWorld1;
attribute vec4 previousWorld2;
attribute vec4 previousWorld3;
#ifdef THIN_INSTANCES
uniform mat4 previousWorld;
#endif
#endif
#else
#if !defined(WORLD_UBO)
uniform mat4 world;
#endif
#if defined(VELOCITY) || defined(PREPASS_VELOCITY)
uniform mat4 previousWorld;
#endif
#endif
`;H.IncludesShadersStore[vn]=kn;const Hn="depthVertexShader",In=`attribute vec3 position;
#include<bonesDeclaration>
#include<bakedVertexAnimationDeclaration>
#include<morphTargetsVertexGlobalDeclaration>
#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]
#include<clipPlaneVertexDeclaration>
#include<instancesDeclaration>
uniform mat4 viewProjection;
uniform vec2 depthValues;
#if defined(ALPHATEST) || defined(NEED_UV)
varying vec2 vUV;
uniform mat4 diffuseMatrix;
#ifdef UV1
attribute vec2 uv;
#endif
#ifdef UV2
attribute vec2 uv2;
#endif
#endif
varying float vDepthMetric;
#define CUSTOM_VERTEX_DEFINITIONS
void main(void)
{
vec3 positionUpdated=position;
#ifdef UV1
vec2 uvUpdated=uv;
#endif
#include<morphTargetsVertexGlobal>
#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]
#include<instancesVertex>
#include<bonesVertex>
#include<bakedVertexAnimation>
vec4 worldPos=finalWorld*vec4(positionUpdated,1.0);
#include<clipPlaneVertex>
gl_Position=viewProjection*worldPos;
#ifdef USE_REVERSE_DEPTHBUFFER
vDepthMetric=((-gl_Position.z+depthValues.x)/(depthValues.y));
#else
vDepthMetric=((gl_Position.z+depthValues.x)/(depthValues.y));
#endif
#if defined(ALPHATEST) || defined(BASIC_RENDER)
#ifdef UV1
vUV=vec2(diffuseMatrix*vec4(uvUpdated,1.0,0.0));
#endif
#ifdef UV2
vUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));
#endif
#endif
}
`;H.ShadersStore[Hn]=In;class Ta{constructor(l,e=1,t=null,a=!1,s=v.TRILINEAR_SAMPLINGMODE){this.enabled=!0,this.forceDepthWriteTransparentMeshes=!1,this.useOnlyInActiveCamera=!1,this._scene=l,this._storeNonLinearDepth=a,this.isPacked=e===0,this.isPacked?this._clearColor=new Gl(1,1,1,1):this._clearColor=new Gl(1,0,0,1),Ta._SceneComponentInitialization(this._scene);const d=l.getEngine();this._camera=t,s!==v.NEAREST_SAMPLINGMODE&&(e===1&&!d._caps.textureFloatLinearFiltering&&(s=v.NEAREST_SAMPLINGMODE),e===2&&!d._caps.textureHalfFloatLinearFiltering&&(s=v.NEAREST_SAMPLINGMODE));const i=this.isPacked||!d._features.supportExtendedTextureFormats?5:6;this._depthMap=new Ge("DepthRenderer",{width:d.getRenderWidth(),height:d.getRenderHeight()},this._scene,!1,!0,e,!1,s,void 0,void 0,void 0,i),this._depthMap.wrapU=v.CLAMP_ADDRESSMODE,this._depthMap.wrapV=v.CLAMP_ADDRESSMODE,this._depthMap.refreshRate=1,this._depthMap.renderParticles=!1,this._depthMap.renderList=null,this._depthMap.activeCamera=this._camera,this._depthMap.ignoreCameraViewport=!0,this._depthMap.useCameraPostProcesses=!1,this._depthMap.onClearObservable.add(n=>{n.clear(this._clearColor,!0,!0,!0)}),this._depthMap.onBeforeBindObservable.add(()=>{var n;(n=d._debugPushGroup)===null||n===void 0||n.call(d,"depth renderer",1)}),this._depthMap.onAfterUnbindObservable.add(()=>{var n;(n=d._debugPopGroup)===null||n===void 0||n.call(d,1)}),this._depthMap.customIsReadyFunction=(n,h,m)=>{if((m||h===0)&&n.subMeshes)for(let o=0;o<n.subMeshes.length;++o){const b=n.subMeshes[o],u=b.getRenderingMesh(),V=u._getInstancesRenderList(b._id,!!b.getReplacementMesh()),G=d.getCaps().instancedArrays&&(V.visibleInstances[b._id]!==null&&V.visibleInstances[b._id]!==void 0||u.hasThinInstances);if(!this.isReady(b,G))return!1}return!0};const c=n=>{var h,m;const o=n.getRenderingMesh(),b=n.getEffectiveMesh(),u=this._scene,V=u.getEngine(),G=n.getMaterial();if(b._internalAbstractMeshDataInfo._isActiveIntermediate=!1,!G||b.infiniteDistance||G.disableDepthWrite||n.verticesCount===0||n._renderId===u.getRenderId())return;const p=b._getWorldMatrixDeterminant()<0;let y=(h=o.overrideMaterialSideOrientation)!==null&&h!==void 0?h:G.sideOrientation;p&&(y=y===0?1:0);const L=y===0;V.setState(G.backFaceCulling,0,!1,L,G.cullBackFaces);const N=o._getInstancesRenderList(n._id,!!n.getReplacementMesh());if(N.mustReturn)return;const J=V.getCaps().instancedArrays&&(N.visibleInstances[n._id]!==null&&N.visibleInstances[n._id]!==void 0||o.hasThinInstances),R=this._camera||u.activeCamera;if(this.isReady(n,J)&&R){n._renderId=u.getRenderId();const S=(m=b._internalAbstractMeshDataInfo._materialForRenderPass)===null||m===void 0?void 0:m[V.currentRenderPassId];let T=n._getDrawWrapper();!T&&S&&(T=S._getDrawWrapper());const k=R.mode===j.ORTHOGRAPHIC_CAMERA;if(!T)return;const g=T.effect;V.enableEffect(T),J||o._bind(n,g,G.fillMode),S?S.bindForSubMesh(b.getWorldMatrix(),b,n):(g.setMatrix("viewProjection",u.getTransformMatrix()),g.setMatrix("world",b.getWorldMatrix()));let ll,ol;if(k?(ll=!V.useReverseDepthBuffer&&V.isNDCHalfZRange?0:1,ol=V.useReverseDepthBuffer&&V.isNDCHalfZRange?0:1):(ll=V.useReverseDepthBuffer&&V.isNDCHalfZRange?R.minZ:V.isNDCHalfZRange?0:R.minZ,ol=V.useReverseDepthBuffer&&V.isNDCHalfZRange?0:R.maxZ),g.setFloat2("depthValues",ll,ll+ol),!S){if(G.needAlphaTesting()){const ml=G.getAlphaTestTexture();ml&&(g.setTexture("diffuseSampler",ml),g.setMatrix("diffuseMatrix",ml.getTextureMatrix()))}if(o.useBones&&o.computeBonesUsingShaders&&o.skeleton){const ml=o.skeleton;if(ml.isUsingTextureForMatrices){const el=ml.getTransformMatrixTexture(o);if(!el)return;g.setTexture("boneSampler",el),g.setFloat("boneTextureWidth",4*(ml.bones.length+1))}else g.setMatrices("mBones",ml.getTransformMatrices(o))}Ua(g,G,u),tl.BindMorphTargetParameters(o,g),o.morphTargetManager&&o.morphTargetManager.isUsingTextureForTargets&&o.morphTargetManager._bind(g)}o._processRendering(b,n,g,G.fillMode,N,J,(ml,el)=>g.setMatrix("world",el))}};this._depthMap.customRenderFunction=(n,h,m,o)=>{let b;if(o.length)for(b=0;b<o.length;b++)c(o.data[b]);for(b=0;b<n.length;b++)c(n.data[b]);for(b=0;b<h.length;b++)c(h.data[b]);if(this.forceDepthWriteTransparentMeshes)for(b=0;b<m.length;b++)c(m.data[b]);else for(b=0;b<m.length;b++)m.data[b].getEffectiveMesh()._internalAbstractMeshDataInfo._isActiveIntermediate=!1}}setMaterialForRendering(l,e){this._depthMap.setMaterialForRendering(l,e)}isReady(l,e){var t;const a=this._scene.getEngine(),s=l.getMesh(),d=s.getScene(),i=(t=s._internalAbstractMeshDataInfo._materialForRenderPass)===null||t===void 0?void 0:t[a.currentRenderPassId];if(i)return i.isReadyForSubMesh(s,l,e);const c=l.getMaterial();if(!c||c.disableDepthWrite)return!1;const n=[],h=[X.PositionKind];if(c&&c.needAlphaTesting()&&c.getAlphaTestTexture()&&(n.push("#define ALPHATEST"),s.isVerticesDataPresent(X.UVKind)&&(h.push(X.UVKind),n.push("#define UV1")),s.isVerticesDataPresent(X.UV2Kind)&&(h.push(X.UV2Kind),n.push("#define UV2"))),s.useBones&&s.computeBonesUsingShaders){h.push(X.MatricesIndicesKind),h.push(X.MatricesWeightsKind),s.numBoneInfluencers>4&&(h.push(X.MatricesIndicesExtraKind),h.push(X.MatricesWeightsExtraKind)),n.push("#define NUM_BONE_INFLUENCERS "+s.numBoneInfluencers),n.push("#define BonesPerMesh "+(s.skeleton?s.skeleton.bones.length+1:0));const G=l.getRenderingMesh().skeleton;G!=null&&G.isUsingTextureForMatrices&&n.push("#define BONETEXTURE")}else n.push("#define NUM_BONE_INFLUENCERS 0");const m=s.morphTargetManager;let o=0;m&&m.numInfluencers>0&&(o=m.numInfluencers,n.push("#define MORPHTARGETS"),n.push("#define NUM_MORPH_INFLUENCERS "+o),m.isUsingTextureForTargets&&n.push("#define MORPHTARGETS_TEXTURE"),tl.PrepareAttributesForMorphTargetsInfluencers(h,s,o)),e&&(n.push("#define INSTANCES"),tl.PushAttributesForInstances(h),l.getRenderingMesh().hasThinInstances&&n.push("#define THIN_INSTANCES")),this._storeNonLinearDepth&&n.push("#define NONLINEARDEPTH"),this.isPacked&&n.push("#define PACKED"),Fs(c,d,n);const b=l._getDrawWrapper(void 0,!0),u=b.defines,V=n.join(`
`);if(u!==V){const G=["world","mBones","boneTextureWidth","viewProjection","diffuseMatrix","depthValues","morphTargetInfluences","morphTargetTextureInfo","morphTargetTextureIndices"];xa(G),b.setEffect(a.createEffect("depth",h,G,["diffuseSampler","morphTargets","boneSampler"],V,void 0,void 0,void 0,{maxSimultaneousMorphTargets:o}),V)}return b.effect.isReady()}getDepthMap(){return this._depthMap}dispose(){const l=[];for(const e in this._scene._depthRenderer)this._scene._depthRenderer[e]===this&&l.push(e);if(l.length>0){this._depthMap.dispose();for(const e of l)delete this._scene._depthRenderer[e]}}}Ta._SceneComponentInitialization=Z=>{throw O("DepthRendererSceneComponent")};const En="minmaxReduxPixelShader",Kn=`varying vec2 vUV;
uniform sampler2D textureSampler;
#if defined(INITIAL)
uniform sampler2D sourceTexture;
uniform vec2 texSize;
void main(void)
{
ivec2 coord=ivec2(vUV*(texSize-1.0));
float f1=texelFetch(sourceTexture,coord,0).r;
float f2=texelFetch(sourceTexture,coord+ivec2(1,0),0).r;
float f3=texelFetch(sourceTexture,coord+ivec2(1,1),0).r;
float f4=texelFetch(sourceTexture,coord+ivec2(0,1),0).r;
float minz=min(min(min(f1,f2),f3),f4);
#ifdef DEPTH_REDUX
float maxz=max(max(max(sign(1.0-f1)*f1,sign(1.0-f2)*f2),sign(1.0-f3)*f3),sign(1.0-f4)*f4);
#else
float maxz=max(max(max(f1,f2),f3),f4);
#endif
glFragColor=vec4(minz,maxz,0.,0.);
}
#elif defined(MAIN)
uniform vec2 texSize;
void main(void)
{
ivec2 coord=ivec2(vUV*(texSize-1.0));
vec2 f1=texelFetch(textureSampler,coord,0).rg;
vec2 f2=texelFetch(textureSampler,coord+ivec2(1,0),0).rg;
vec2 f3=texelFetch(textureSampler,coord+ivec2(1,1),0).rg;
vec2 f4=texelFetch(textureSampler,coord+ivec2(0,1),0).rg;
float minz=min(min(min(f1.x,f2.x),f3.x),f4.x);
float maxz=max(max(max(f1.y,f2.y),f3.y),f4.y);
glFragColor=vec4(minz,maxz,0.,0.);
}
#elif defined(ONEBEFORELAST)
uniform ivec2 texSize;
void main(void)
{
ivec2 coord=ivec2(vUV*vec2(texSize-1));
vec2 f1=texelFetch(textureSampler,coord % texSize,0).rg;
vec2 f2=texelFetch(textureSampler,(coord+ivec2(1,0)) % texSize,0).rg;
vec2 f3=texelFetch(textureSampler,(coord+ivec2(1,1)) % texSize,0).rg;
vec2 f4=texelFetch(textureSampler,(coord+ivec2(0,1)) % texSize,0).rg;
float minz=min(f1.x,f2.x);
float maxz=max(f1.y,f2.y);
glFragColor=vec4(minz,maxz,0.,0.);
}
#elif defined(LAST)
void main(void)
{
glFragColor=vec4(0.);
if (true) { 
discard;
}
}
#endif
`;H.ShadersStore[En]=Kn;class Bn{constructor(l){this.onAfterReductionPerformed=new z,this._forceFullscreenViewport=!0,this._activated=!1,this._camera=l,this._postProcessManager=new Ya(l.getScene()),this._onContextRestoredObserver=l.getEngine().onContextRestoredObservable.add(()=>{this._postProcessManager._rebuild()})}get sourceTexture(){return this._sourceTexture}setSourceTexture(l,e,t=2,a=!0){if(l===this._sourceTexture)return;this.dispose(!1),this._sourceTexture=l,this._reductionSteps=[],this._forceFullscreenViewport=a;const s=this._camera.getScene(),d=new yl("Initial reduction phase","minmaxRedux",["texSize"],["sourceTexture"],1,null,1,s.getEngine(),!1,"#define INITIAL"+(e?`
#define DEPTH_REDUX`:""),t,void 0,void 0,void 0,7);d.autoClear=!1,d.forceFullscreenViewport=a;let i=this._sourceTexture.getRenderWidth(),c=this._sourceTexture.getRenderHeight();d.onApply=((h,m)=>o=>{o.setTexture("sourceTexture",this._sourceTexture),o.setFloat2("texSize",h,m)})(i,c),this._reductionSteps.push(d);let n=1;for(;i>1||c>1;){i=Math.max(Math.round(i/2),1),c=Math.max(Math.round(c/2),1);const h=new yl("Reduction phase "+n,"minmaxRedux",["texSize"],null,{width:i,height:c},null,1,s.getEngine(),!1,"#define "+(i==1&&c==1?"LAST":i==1||c==1?"ONEBEFORELAST":"MAIN"),t,void 0,void 0,void 0,7);if(h.autoClear=!1,h.forceFullscreenViewport=a,h.onApply=((m,o)=>b=>{m==1||o==1?b.setInt2("texSize",m,o):b.setFloat2("texSize",m,o)})(i,c),this._reductionSteps.push(h),n++,i==1&&c==1){const m=(o,b,u)=>{const V=new Float32Array(4*o*b),G={min:0,max:0};return()=>{s.getEngine()._readTexturePixels(u.inputTexture.texture,o,b,-1,0,V,!1),G.min=V[0],G.max=V[1],this.onAfterReductionPerformed.notifyObservers(G)}};h.onAfterRenderObservable.add(m(i,c,h))}}}get refreshRate(){return this._sourceTexture?this._sourceTexture.refreshRate:-1}set refreshRate(l){this._sourceTexture&&(this._sourceTexture.refreshRate=l)}get activated(){return this._activated}activate(){this._onAfterUnbindObserver||!this._sourceTexture||(this._onAfterUnbindObserver=this._sourceTexture.onAfterUnbindObservable.add(()=>{var l,e;const t=this._camera.getScene().getEngine();(l=t._debugPushGroup)===null||l===void 0||l.call(t,"min max reduction",1),this._reductionSteps[0].activate(this._camera),this._postProcessManager.directRender(this._reductionSteps,this._reductionSteps[0].inputTexture,this._forceFullscreenViewport),t.unBindFramebuffer(this._reductionSteps[0].inputTexture,!1),(e=t._debugPopGroup)===null||e===void 0||e.call(t,1)}),this._activated=!0)}deactivate(){!this._onAfterUnbindObserver||!this._sourceTexture||(this._sourceTexture.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=null,this._activated=!1)}dispose(l=!0){if(l&&(this.onAfterReductionPerformed.clear(),this._onContextRestoredObserver&&(this._camera.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)),this.deactivate(),this._reductionSteps){for(let e=0;e<this._reductionSteps.length;++e)this._reductionSteps[e].dispose();this._reductionSteps=null}this._postProcessManager&&l&&this._postProcessManager.dispose(),this._sourceTexture=null}}class Qn extends Bn{constructor(l){super(l)}get depthRenderer(){return this._depthRenderer}setDepthRenderer(l=null,e=2,t=!0){const a=this._camera.getScene();this._depthRenderer&&(delete a._depthRenderer[this._depthRendererId],this._depthRenderer.dispose(),this._depthRenderer=null),l===null&&(a._depthRenderer||(a._depthRenderer={}),l=this._depthRenderer=new Ta(a,e,this._camera,!1,1),l.enabled=!1,this._depthRendererId="minmax"+this._camera.id,a._depthRenderer[this._depthRendererId]=l),super.setSourceTexture(l.getDepthMap(),!0,e,t)}setSourceTexture(l,e,t=2,a=!0){super.setSourceTexture(l,e,t,a)}activate(){this._depthRenderer&&(this._depthRenderer.enabled=!0),super.activate()}deactivate(){super.deactivate(),this._depthRenderer&&(this._depthRenderer.enabled=!1)}dispose(l=!0){if(super.dispose(l),this._depthRenderer&&l){const e=this._depthRenderer.getDepthMap().getScene();e&&delete e._depthRenderer[this._depthRendererId],this._depthRenderer.dispose(),this._depthRenderer=null}}}const ld=r.Up(),Pn=r.Zero(),Ml=new r,Ft=new r,sa=new Y;class vl extends B{constructor(l,e,t,a){if(!vl.IsSupported){M.Error("CascadedShadowMap is not supported by the current engine.");return}super(l,e,t,a),this.usePercentageCloserFiltering=!0}_validateFilter(l){return l===B.FILTER_NONE||l===B.FILTER_PCF||l===B.FILTER_PCSS?l:(console.error('Unsupported filter "'+l+'"!'),B.FILTER_NONE)}get numCascades(){return this._numCascades}set numCascades(l){l=Math.min(Math.max(l,vl.MIN_CASCADES_COUNT),vl.MAX_CASCADES_COUNT),l!==this._numCascades&&(this._numCascades=l,this.recreateShadowMap(),this._recreateSceneUBOs())}get freezeShadowCastersBoundingInfo(){return this._freezeShadowCastersBoundingInfo}set freezeShadowCastersBoundingInfo(l){this._freezeShadowCastersBoundingInfoObservable&&l&&(this._scene.onBeforeRenderObservable.remove(this._freezeShadowCastersBoundingInfoObservable),this._freezeShadowCastersBoundingInfoObservable=null),!this._freezeShadowCastersBoundingInfoObservable&&!l&&(this._freezeShadowCastersBoundingInfoObservable=this._scene.onBeforeRenderObservable.add(this._computeShadowCastersBoundingInfo.bind(this))),this._freezeShadowCastersBoundingInfo=l,l&&this._computeShadowCastersBoundingInfo()}_computeShadowCastersBoundingInfo(){if(this._scbiMin.copyFromFloats(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._scbiMax.copyFromFloats(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE),this._shadowMap&&this._shadowMap.renderList){const l=this._shadowMap.renderList;for(let t=0;t<l.length;t++){const a=l[t];if(!a)continue;const s=a.getBoundingInfo(),d=s.boundingBox;this._scbiMin.minimizeInPlace(d.minimumWorld),this._scbiMax.maximizeInPlace(d.maximumWorld)}const e=this._scene.meshes;for(let t=0;t<e.length;t++){const a=e[t];if(!a||!a.isVisible||!a.isEnabled||!a.receiveShadows)continue;const s=a.getBoundingInfo(),d=s.boundingBox;this._scbiMin.minimizeInPlace(d.minimumWorld),this._scbiMax.maximizeInPlace(d.maximumWorld)}}this._shadowCastersBoundingInfo.reConstruct(this._scbiMin,this._scbiMax)}get shadowCastersBoundingInfo(){return this._shadowCastersBoundingInfo}set shadowCastersBoundingInfo(l){this._shadowCastersBoundingInfo=l}setMinMaxDistance(l,e){this._minDistance===l&&this._maxDistance===e||(l>e&&(l=0,e=1),l<0&&(l=0),e>1&&(e=1),this._minDistance=l,this._maxDistance=e,this._breaksAreDirty=!0)}get minDistance(){return this._minDistance}get maxDistance(){return this._maxDistance}getClassName(){return vl.CLASSNAME}getCascadeMinExtents(l){return l>=0&&l<this._numCascades?this._cascadeMinExtents[l]:null}getCascadeMaxExtents(l){return l>=0&&l<this._numCascades?this._cascadeMaxExtents[l]:null}get shadowMaxZ(){return this._getCamera()?this._shadowMaxZ:0}set shadowMaxZ(l){const e=this._getCamera();if(!e){this._shadowMaxZ=l;return}this._shadowMaxZ===l||l<e.minZ||l>e.maxZ||(this._shadowMaxZ=l,this._light._markMeshesAsLightDirty(),this._breaksAreDirty=!0)}get debug(){return this._debug}set debug(l){this._debug=l,this._light._markMeshesAsLightDirty()}get depthClamp(){return this._depthClamp}set depthClamp(l){this._depthClamp=l}get cascadeBlendPercentage(){return this._cascadeBlendPercentage}set cascadeBlendPercentage(l){this._cascadeBlendPercentage=l,this._light._markMeshesAsLightDirty()}get lambda(){return this._lambda}set lambda(l){const e=Math.min(Math.max(l,0),1);this._lambda!=e&&(this._lambda=e,this._breaksAreDirty=!0)}getCascadeViewMatrix(l){return l>=0&&l<this._numCascades?this._viewMatrices[l]:null}getCascadeProjectionMatrix(l){return l>=0&&l<this._numCascades?this._projectionMatrices[l]:null}getCascadeTransformMatrix(l){return l>=0&&l<this._numCascades?this._transformMatrices[l]:null}setDepthRenderer(l){this._depthRenderer=l,this._depthReducer&&this._depthReducer.setDepthRenderer(this._depthRenderer)}get autoCalcDepthBounds(){return this._autoCalcDepthBounds}set autoCalcDepthBounds(l){const e=this._getCamera();if(e){if(this._autoCalcDepthBounds=l,!l){this._depthReducer&&this._depthReducer.deactivate(),this.setMinMaxDistance(0,1);return}this._depthReducer||(this._depthReducer=new Qn(e),this._depthReducer.onAfterReductionPerformed.add(t=>{let a=t.min,s=t.max;a>=s&&(a=0,s=1),(a!=this._minDistance||s!=this._maxDistance)&&this.setMinMaxDistance(a,s)}),this._depthReducer.setDepthRenderer(this._depthRenderer)),this._depthReducer.activate()}}get autoCalcDepthBoundsRefreshRate(){var l,e,t;return(t=(e=(l=this._depthReducer)===null||l===void 0?void 0:l.depthRenderer)===null||e===void 0?void 0:e.getDepthMap().refreshRate)!==null&&t!==void 0?t:-1}set autoCalcDepthBoundsRefreshRate(l){var e;!((e=this._depthReducer)===null||e===void 0)&&e.depthRenderer&&(this._depthReducer.depthRenderer.getDepthMap().refreshRate=l)}splitFrustum(){this._breaksAreDirty=!0}_splitFrustum(){const l=this._getCamera();if(!l)return;const e=l.minZ,t=l.maxZ,a=t-e,s=this._minDistance,d=this._shadowMaxZ<t&&this._shadowMaxZ>=e?Math.min((this._shadowMaxZ-e)/(t-e),this._maxDistance):this._maxDistance,i=e+s*a,c=e+d*a,n=c-i,h=c/i;for(let m=0;m<this._cascades.length;++m){const o=(m+1)/this._numCascades,b=i*h**o,u=i+n*o,V=this._lambda*(b-u)+u;this._cascades[m].prevBreakDistance=m===0?s:this._cascades[m-1].breakDistance,this._cascades[m].breakDistance=(V-e)/a,this._viewSpaceFrustumsZ[m]=V,this._frustumLengths[m]=(this._cascades[m].breakDistance-this._cascades[m].prevBreakDistance)*a}this._breaksAreDirty=!1}_computeMatrices(){const l=this._scene;if(!this._getCamera())return;r.NormalizeToRef(this._light.getShadowDirection(0),this._lightDirection),Math.abs(r.Dot(this._lightDirection,r.Up()))===1&&(this._lightDirection.z=1e-13),this._cachedDirection.copyFrom(this._lightDirection);const e=l.getEngine().useReverseDepthBuffer;for(let t=0;t<this._numCascades;++t){this._computeFrustumInWorldSpace(t),this._computeCascadeFrustum(t),this._cascadeMaxExtents[t].subtractToRef(this._cascadeMinExtents[t],Ml),this._frustumCenter[t].addToRef(this._lightDirection.scale(this._cascadeMinExtents[t].z),this._shadowCameraPos[t]),Y.LookAtLHToRef(this._shadowCameraPos[t],this._frustumCenter[t],ld,this._viewMatrices[t]);let a=0,s=Ml.z;const d=this._shadowCastersBoundingInfo;d.update(this._viewMatrices[t]),s=Math.min(s,d.boundingBox.maximumWorld.z),!this._depthClamp||this.filter===B.FILTER_PCSS?a=Math.min(a,d.boundingBox.minimumWorld.z):a=Math.max(a,d.boundingBox.minimumWorld.z),Y.OrthoOffCenterLHToRef(this._cascadeMinExtents[t].x,this._cascadeMaxExtents[t].x,this._cascadeMinExtents[t].y,this._cascadeMaxExtents[t].y,e?s:a,e?a:s,this._projectionMatrices[t],l.getEngine().isNDCHalfZRange),this._cascadeMinExtents[t].z=a,this._cascadeMaxExtents[t].z=s,this._viewMatrices[t].multiplyToRef(this._projectionMatrices[t],this._transformMatrices[t]),r.TransformCoordinatesToRef(Pn,this._transformMatrices[t],Ml),Ml.scaleInPlace(this._mapSize/2),Ft.copyFromFloats(Math.round(Ml.x),Math.round(Ml.y),Math.round(Ml.z)),Ft.subtractInPlace(Ml).scaleInPlace(2/this._mapSize),Y.TranslationToRef(Ft.x,Ft.y,0,sa),this._projectionMatrices[t].multiplyToRef(sa,this._projectionMatrices[t]),this._viewMatrices[t].multiplyToRef(this._projectionMatrices[t],this._transformMatrices[t]),this._transformMatrices[t].copyToArray(this._transformMatricesAsArray,t*16)}}_computeFrustumInWorldSpace(l){const e=this._getCamera();if(!e)return;const t=this._cascades[l].prevBreakDistance,a=this._cascades[l].breakDistance,s=this._scene.getEngine().isNDCHalfZRange;e.getViewMatrix();const d=Y.Invert(e.getTransformationMatrix()),i=this._scene.getEngine().useReverseDepthBuffer?4:0;for(let c=0;c<vl._FrustumCornersNDCSpace.length;++c)Ml.copyFrom(vl._FrustumCornersNDCSpace[(c+i)%vl._FrustumCornersNDCSpace.length]),s&&Ml.z===-1&&(Ml.z=0),r.TransformCoordinatesToRef(Ml,d,this._frustumCornersWorldSpace[l][c]);for(let c=0;c<vl._FrustumCornersNDCSpace.length/2;++c)Ml.copyFrom(this._frustumCornersWorldSpace[l][c+4]).subtractInPlace(this._frustumCornersWorldSpace[l][c]),Ft.copyFrom(Ml).scaleInPlace(t),Ml.scaleInPlace(a),Ml.addInPlace(this._frustumCornersWorldSpace[l][c]),this._frustumCornersWorldSpace[l][c+4].copyFrom(Ml),this._frustumCornersWorldSpace[l][c].addInPlace(Ft)}_computeCascadeFrustum(l){if(this._cascadeMinExtents[l].copyFromFloats(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cascadeMaxExtents[l].copyFromFloats(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE),this._frustumCenter[l].copyFromFloats(0,0,0),!!this._getCamera()){for(let e=0;e<this._frustumCornersWorldSpace[l].length;++e)this._frustumCenter[l].addInPlace(this._frustumCornersWorldSpace[l][e]);if(this._frustumCenter[l].scaleInPlace(1/this._frustumCornersWorldSpace[l].length),this.stabilizeCascades){let e=0;for(let t=0;t<this._frustumCornersWorldSpace[l].length;++t){const a=this._frustumCornersWorldSpace[l][t].subtractToRef(this._frustumCenter[l],Ml).length();e=Math.max(e,a)}e=Math.ceil(e*16)/16,this._cascadeMaxExtents[l].copyFromFloats(e,e,e),this._cascadeMinExtents[l].copyFromFloats(-e,-e,-e)}else{const e=this._frustumCenter[l];this._frustumCenter[l].addToRef(this._lightDirection,Ml),Y.LookAtLHToRef(e,Ml,ld,sa);for(let t=0;t<this._frustumCornersWorldSpace[l].length;++t)r.TransformCoordinatesToRef(this._frustumCornersWorldSpace[l][t],sa,Ml),this._cascadeMinExtents[l].minimizeInPlace(Ml),this._cascadeMaxExtents[l].maximizeInPlace(Ml)}}}_recreateSceneUBOs(){if(this._disposeSceneUBOs(),this._sceneUBOs)for(let l=0;l<this._numCascades;++l)this._sceneUBOs.push(this._scene.createSceneUniformBuffer(`Scene for CSM Shadow Generator (light "${this._light.name}" cascade #${l})`))}static get IsSupported(){const l=bl.LastCreatedEngine;return l?l._features.supportCSM:!1}_initializeGenerator(){var l,e,t,a,s,d,i,c,n,h,m,o,b,u,V,G,p,y,L,N;this.penumbraDarkness=(l=this.penumbraDarkness)!==null&&l!==void 0?l:1,this._numCascades=(e=this._numCascades)!==null&&e!==void 0?e:vl.DEFAULT_CASCADES_COUNT,this.stabilizeCascades=(t=this.stabilizeCascades)!==null&&t!==void 0?t:!1,this._freezeShadowCastersBoundingInfoObservable=(a=this._freezeShadowCastersBoundingInfoObservable)!==null&&a!==void 0?a:null,this.freezeShadowCastersBoundingInfo=(s=this.freezeShadowCastersBoundingInfo)!==null&&s!==void 0?s:!1,this._scbiMin=(d=this._scbiMin)!==null&&d!==void 0?d:new r(0,0,0),this._scbiMax=(i=this._scbiMax)!==null&&i!==void 0?i:new r(0,0,0),this._shadowCastersBoundingInfo=(c=this._shadowCastersBoundingInfo)!==null&&c!==void 0?c:new re(new r(0,0,0),new r(0,0,0)),this._breaksAreDirty=(n=this._breaksAreDirty)!==null&&n!==void 0?n:!0,this._minDistance=(h=this._minDistance)!==null&&h!==void 0?h:0,this._maxDistance=(m=this._maxDistance)!==null&&m!==void 0?m:1,this._currentLayer=(o=this._currentLayer)!==null&&o!==void 0?o:0,this._shadowMaxZ=(V=(b=this._shadowMaxZ)!==null&&b!==void 0?b:(u=this._getCamera())===null||u===void 0?void 0:u.maxZ)!==null&&V!==void 0?V:1e4,this._debug=(G=this._debug)!==null&&G!==void 0?G:!1,this._depthClamp=(p=this._depthClamp)!==null&&p!==void 0?p:!0,this._cascadeBlendPercentage=(y=this._cascadeBlendPercentage)!==null&&y!==void 0?y:.1,this._lambda=(L=this._lambda)!==null&&L!==void 0?L:.5,this._autoCalcDepthBounds=(N=this._autoCalcDepthBounds)!==null&&N!==void 0?N:!1,this._recreateSceneUBOs(),super._initializeGenerator()}_createTargetRenderTexture(){const l=this._scene.getEngine(),e={width:this._mapSize,height:this._mapSize,layers:this.numCascades};this._shadowMap=new Ge(this._light.name+"_CSMShadowMap",e,this._scene,!1,!0,this._textureType,!1,void 0,!1,!1,void 0),this._shadowMap.createDepthStencilTexture(l.useReverseDepthBuffer?516:513,!0)}_initializeShadowMap(){if(super._initializeShadowMap(),this._shadowMap===null)return;this._transformMatricesAsArray=new Float32Array(this._numCascades*16),this._viewSpaceFrustumsZ=new Array(this._numCascades),this._frustumLengths=new Array(this._numCascades),this._lightSizeUVCorrection=new Array(this._numCascades*2),this._depthCorrection=new Array(this._numCascades),this._cascades=[],this._viewMatrices=[],this._projectionMatrices=[],this._transformMatrices=[],this._cascadeMinExtents=[],this._cascadeMaxExtents=[],this._frustumCenter=[],this._shadowCameraPos=[],this._frustumCornersWorldSpace=[];for(let e=0;e<this._numCascades;++e){this._cascades[e]={prevBreakDistance:0,breakDistance:0},this._viewMatrices[e]=Y.Zero(),this._projectionMatrices[e]=Y.Zero(),this._transformMatrices[e]=Y.Zero(),this._cascadeMinExtents[e]=new r,this._cascadeMaxExtents[e]=new r,this._frustumCenter[e]=new r,this._shadowCameraPos[e]=new r,this._frustumCornersWorldSpace[e]=new Array(vl._FrustumCornersNDCSpace.length);for(let t=0;t<vl._FrustumCornersNDCSpace.length;++t)this._frustumCornersWorldSpace[e][t]=new r}const l=this._scene.getEngine();this._shadowMap.onBeforeBindObservable.clear(),this._shadowMap.onBeforeRenderObservable.clear(),this._shadowMap.onBeforeRenderObservable.add(e=>{this._sceneUBOs&&this._scene.setSceneUniformBuffer(this._sceneUBOs[e]),this._currentLayer=e,this._filter===B.FILTER_PCF&&l.setColorWrite(!1),this._scene.setTransformMatrix(this.getCascadeViewMatrix(e),this.getCascadeProjectionMatrix(e)),this._useUBO&&(this._scene.getSceneUniformBuffer().unbindEffect(),this._scene.finalizeSceneUbo())}),this._shadowMap.onBeforeBindObservable.add(()=>{var e;this._currentSceneUBO=this._scene.getSceneUniformBuffer(),(e=l._debugPushGroup)===null||e===void 0||e.call(l,`cascaded shadow map generation for pass id ${l.currentRenderPassId}`,1),this._breaksAreDirty&&this._splitFrustum(),this._computeMatrices()}),this._splitFrustum()}_bindCustomEffectForRenderSubMeshForShadowMap(l,e){e.setMatrix("viewProjection",this.getCascadeTransformMatrix(this._currentLayer))}_isReadyCustomDefines(l){l.push("#define SM_DEPTHCLAMP "+(this._depthClamp&&this._filter!==B.FILTER_PCSS?"1":"0"))}prepareDefines(l,e){super.prepareDefines(l,e);const t=this._scene,a=this._light;if(!t.shadowsEnabled||!a.shadowEnabled)return;l["SHADOWCSM"+e]=!0,l["SHADOWCSMDEBUG"+e]=this.debug,l["SHADOWCSMNUM_CASCADES"+e]=this.numCascades,l["SHADOWCSM_RIGHTHANDED"+e]=t.useRightHandedSystem;const s=this._getCamera();s&&this._shadowMaxZ<s.maxZ&&(l["SHADOWCSMUSESHADOWMAXZ"+e]=!0),this.cascadeBlendPercentage===0&&(l["SHADOWCSMNOBLEND"+e]=!0)}bindShadowLight(l,e){const t=this._light;if(!this._scene.shadowsEnabled||!t.shadowEnabled)return;const a=this._getCamera();if(!a)return;const s=this.getShadowMap();if(!s)return;const d=s.getSize().width;if(e.setMatrices("lightMatrix"+l,this._transformMatricesAsArray),e.setArray("viewFrustumZ"+l,this._viewSpaceFrustumsZ),e.setFloat("cascadeBlendFactor"+l,this.cascadeBlendPercentage===0?1e4:1/this.cascadeBlendPercentage),e.setArray("frustumLengths"+l,this._frustumLengths),this._filter===B.FILTER_PCF)e.setDepthStencilTexture("shadowSampler"+l,s),t._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),d,1/d,this.frustumEdgeFalloff,l);else if(this._filter===B.FILTER_PCSS){for(let i=0;i<this._numCascades;++i)this._lightSizeUVCorrection[i*2+0]=i===0?1:(this._cascadeMaxExtents[0].x-this._cascadeMinExtents[0].x)/(this._cascadeMaxExtents[i].x-this._cascadeMinExtents[i].x),this._lightSizeUVCorrection[i*2+1]=i===0?1:(this._cascadeMaxExtents[0].y-this._cascadeMinExtents[0].y)/(this._cascadeMaxExtents[i].y-this._cascadeMinExtents[i].y),this._depthCorrection[i]=i===0?1:(this._cascadeMaxExtents[i].z-this._cascadeMinExtents[i].z)/(this._cascadeMaxExtents[0].z-this._cascadeMinExtents[0].z);e.setDepthStencilTexture("shadowSampler"+l,s),e.setTexture("depthSampler"+l,s),e.setArray2("lightSizeUVCorrection"+l,this._lightSizeUVCorrection),e.setArray("depthCorrection"+l,this._depthCorrection),e.setFloat("penumbraDarkness"+l,this.penumbraDarkness),t._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),1/d,this._contactHardeningLightSizeUVRatio*d,this.frustumEdgeFalloff,l)}else e.setTexture("shadowSampler"+l,s),t._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),d,1/d,this.frustumEdgeFalloff,l);t._uniformBuffer.updateFloat2("depthValues",this.getLight().getDepthMinZ(a),this.getLight().getDepthMinZ(a)+this.getLight().getDepthMaxZ(a),l)}getTransformMatrix(){return this.getCascadeTransformMatrix(0)}dispose(){super.dispose(),this._freezeShadowCastersBoundingInfoObservable&&(this._scene.onBeforeRenderObservable.remove(this._freezeShadowCastersBoundingInfoObservable),this._freezeShadowCastersBoundingInfoObservable=null),this._depthReducer&&(this._depthReducer.dispose(),this._depthReducer=null)}serialize(){const l=super.serialize(),e=this.getShadowMap();if(!e)return l;if(l.numCascades=this._numCascades,l.debug=this._debug,l.stabilizeCascades=this.stabilizeCascades,l.lambda=this._lambda,l.cascadeBlendPercentage=this.cascadeBlendPercentage,l.depthClamp=this._depthClamp,l.autoCalcDepthBounds=this.autoCalcDepthBounds,l.shadowMaxZ=this._shadowMaxZ,l.penumbraDarkness=this.penumbraDarkness,l.freezeShadowCastersBoundingInfo=this._freezeShadowCastersBoundingInfo,l.minDistance=this.minDistance,l.maxDistance=this.maxDistance,l.renderList=[],e.renderList)for(let t=0;t<e.renderList.length;t++){const a=e.renderList[t];l.renderList.push(a.id)}return l}static Parse(l,e){const t=B.Parse(l,e,(a,s,d)=>new vl(a,s,void 0,d));return l.numCascades!==void 0&&(t.numCascades=l.numCascades),l.debug!==void 0&&(t.debug=l.debug),l.stabilizeCascades!==void 0&&(t.stabilizeCascades=l.stabilizeCascades),l.lambda!==void 0&&(t.lambda=l.lambda),l.cascadeBlendPercentage!==void 0&&(t.cascadeBlendPercentage=l.cascadeBlendPercentage),l.depthClamp!==void 0&&(t.depthClamp=l.depthClamp),l.autoCalcDepthBounds!==void 0&&(t.autoCalcDepthBounds=l.autoCalcDepthBounds),l.shadowMaxZ!==void 0&&(t.shadowMaxZ=l.shadowMaxZ),l.penumbraDarkness!==void 0&&(t.penumbraDarkness=l.penumbraDarkness),l.freezeShadowCastersBoundingInfo!==void 0&&(t.freezeShadowCastersBoundingInfo=l.freezeShadowCastersBoundingInfo),l.minDistance!==void 0&&l.maxDistance!==void 0&&t.setMinMaxDistance(l.minDistance,l.maxDistance),t}}vl._FrustumCornersNDCSpace=[new r(-1,1,-1),new r(1,1,-1),new r(1,-1,-1),new r(-1,-1,-1),new r(-1,1,1),new r(1,1,1),new r(1,-1,1),new r(-1,-1,1)];vl.CLASSNAME="CascadedShadowGenerator";vl.DEFAULT_CASCADES_COUNT=4;vl.MIN_CASCADES_COUNT=2;vl.MAX_CASCADES_COUNT=4;vl._SceneComponentInitialization=Z=>{throw O("ShadowGeneratorSceneComponent")};Sa.AddParser(D.NAME_SHADOWGENERATOR,(Z,l)=>{if(Z.shadowGenerators!==void 0&&Z.shadowGenerators!==null)for(let e=0,t=Z.shadowGenerators.length;e<t;e++){const a=Z.shadowGenerators[e];a.className===vl.CLASSNAME?vl.Parse(a,l):B.Parse(a,l)}});class wn{constructor(l){this.name=D.NAME_SHADOWGENERATOR,this.scene=l}register(){this.scene._gatherRenderTargetsStage.registerStep(D.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR,this,this._gatherRenderTargets)}rebuild(){}serialize(l){l.shadowGenerators=[];const e=this.scene.lights;for(const t of e){const a=t.getShadowGenerators();if(a){const s=a.values();for(let d=s.next();d.done!==!0;d=s.next()){const i=d.value;l.shadowGenerators.push(i.serialize())}}}}addFromContainer(l){}removeFromContainer(l,e){}dispose(){}_gatherRenderTargets(l){const e=this.scene;if(this.scene.shadowsEnabled)for(let t=0;t<e.lights.length;t++){const a=e.lights[t],s=a.getShadowGenerators();if(a.isEnabled()&&a.shadowEnabled&&s){const d=s.values();for(let i=d.next();i.done!==!0;i=d.next()){const c=i.value.getShadowMap();e.textures.indexOf(c)!==-1&&l.push(c)}}}}}B._SceneComponentInitialization=Z=>{let l=Z._getComponent(D.NAME_SHADOWGENERATOR);l||(l=new wn(Z),Z._addComponent(l))};const _n={enableShadows:!0};function ed(Z=_n){const{enableShadows:l,shadowTransparency:e,intensity:t,scene:a}=Z,s=new Me("DirectionalLight",new r(-.3,-1,.4),a);s.position=new r(-50,65,-50),s.intensity=.65*t;const d=new fa("HemisphericLight",new r(1,1,0),a);return d.intensity=.4*t,l&&(s.shadowMinZ=1,s.shadowMaxZ=70,s.shadowGenerator=new B(2048,s),s.shadowGenerator.useCloseExponentialShadowMap=!0,s.shadowGenerator.darkness=e),{directional:s,hemispheric:d}}function xd(Z){let l=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];const e=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],t=[];let a=[];const s=Z.width||Z.size||1,d=Z.height||Z.size||1,i=Z.depth||Z.size||1,c=Z.wrap||!1;let n=Z.topBaseAt===void 0?1:Z.topBaseAt,h=Z.bottomBaseAt===void 0?0:Z.bottomBaseAt;n=(n+4)%4,h=(h+4)%4;const m=[2,0,3,1],o=[2,0,1,3];let b=m[n],u=o[h],V=[1,-1,1,-1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,1,-1,-1,1,-1,1,1,1,1,-1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,1];if(c){l=[2,3,0,2,0,1,4,5,6,4,6,7,9,10,11,9,11,8,12,14,15,12,13,14],V=[-1,1,1,1,1,1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,1,1,1,-1,1,-1,-1,1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1];let R=[[1,1,1],[-1,1,1],[-1,1,-1],[1,1,-1]],S=[[-1,-1,1],[1,-1,1],[1,-1,-1],[-1,-1,-1]];const T=[17,18,19,16],k=[22,23,20,21];for(;b>0;)R.unshift(R.pop()),T.unshift(T.pop()),b--;for(;u>0;)S.unshift(S.pop()),k.unshift(k.pop()),u--;R=R.flat(),S=S.flat(),V=V.concat(R).concat(S),l.push(T[0],T[2],T[3],T[0],T[1],T[2]),l.push(k[0],k[2],k[3],k[0],k[1],k[2])}const G=[s/2,d/2,i/2];a=V.reduce((R,S,T)=>R.concat(S*G[T%3]),[]);const p=Z.sideOrientation===0?0:Z.sideOrientation||$.DEFAULTSIDE,y=Z.faceUV||new Array(6),L=Z.faceColors,N=[];for(let R=0;R<6;R++)y[R]===void 0&&(y[R]=new Fl(0,0,1,1)),L&&L[R]===void 0&&(L[R]=new Gl(1,1,1,1));for(let R=0;R<6;R++)if(t.push(y[R].z,Xe.UseOpenGLOrientationForUV?1-y[R].w:y[R].w),t.push(y[R].x,Xe.UseOpenGLOrientationForUV?1-y[R].w:y[R].w),t.push(y[R].x,Xe.UseOpenGLOrientationForUV?1-y[R].y:y[R].y),t.push(y[R].z,Xe.UseOpenGLOrientationForUV?1-y[R].y:y[R].y),L)for(let S=0;S<4;S++)N.push(L[R].r,L[R].g,L[R].b,L[R].a);$._ComputeSides(p,a,l,e,t,Z.frontUVs,Z.backUVs);const J=new $;if(J.indices=l,J.positions=a,J.normals=e,J.uvs=t,L){const R=p===$.DOUBLESIDE?N.concat(N):N;J.colors=R}return J}function Lt(Z,l={},e=null){const t=new E(Z,e);return l.sideOrientation=E._GetDefaultSideOrientation(l.sideOrientation),t._originalBuilderSideOrientation=l.sideOrientation,xd(l).applyToMesh(t,l.updatable),t}$.CreateBox=xd;E.CreateBox=(Z,l,e=null,t,a)=>Lt(Z,{size:l,sideOrientation:a,updatable:t},e);class td{constructor(){this.previousWorldMatrices={},this.previousBones={}}static AddUniforms(l){l.push("previousWorld","previousViewProjection","mPreviousBones")}static AddSamplers(l){}bindForSubMesh(l,e,t,a,s){if(e.prePassRenderer&&e.prePassRenderer.enabled&&e.prePassRenderer.currentRTisSceneRT&&e.prePassRenderer.getIndex(2)!==-1){this.previousWorldMatrices[t.uniqueId]||(this.previousWorldMatrices[t.uniqueId]=a.clone()),this.previousViewProjection||(this.previousViewProjection=e.getTransformMatrix().clone(),this.currentViewProjection=e.getTransformMatrix().clone());const d=e.getEngine();this.currentViewProjection.updateFlag!==e.getTransformMatrix().updateFlag?(this._lastUpdateFrameId=d.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection),this.currentViewProjection.copyFrom(e.getTransformMatrix())):this._lastUpdateFrameId!==d.frameId&&(this._lastUpdateFrameId=d.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection)),l.setMatrix("previousWorld",this.previousWorldMatrices[t.uniqueId]),l.setMatrix("previousViewProjection",this.previousViewProjection),this.previousWorldMatrices[t.uniqueId]=a.clone()}}}class Ud extends U{constructor(l,e,t=!0){super(l,e),this._normalMatrix=new Y,this._storeEffectOnSubMeshes=t}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(l,e){return l?!this._storeEffectOnSubMeshes||!l.subMeshes||l.subMeshes.length===0?!0:this.isReadyForSubMesh(l,l.subMeshes[0],e):!1}_isReadyForSubMesh(l){const e=l.materialDefines;return!!(!this.checkReadyOnEveryCall&&l.effect&&e&&e._renderId===this.getScene().getRenderId())}bindOnlyWorldMatrix(l){this._activeEffect.setMatrix("world",l)}bindOnlyNormalMatrix(l){this._activeEffect.setMatrix("normalMatrix",l)}bind(l,e){e&&this.bindForSubMesh(l,e,e.subMeshes[0])}_afterBind(l,e=null){super._afterBind(l,e),this.getScene()._cachedEffect=e,e&&(e._forceRebindOnNextCall=!1)}_mustRebind(l,e,t=1){return l.isCachedMaterialInvalid(this,e,t)}}class hl{static get DiffuseTextureEnabled(){return this._DiffuseTextureEnabled}static set DiffuseTextureEnabled(l){this._DiffuseTextureEnabled!==l&&(this._DiffuseTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get DetailTextureEnabled(){return this._DetailTextureEnabled}static set DetailTextureEnabled(l){this._DetailTextureEnabled!==l&&(this._DetailTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get AmbientTextureEnabled(){return this._AmbientTextureEnabled}static set AmbientTextureEnabled(l){this._AmbientTextureEnabled!==l&&(this._AmbientTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get OpacityTextureEnabled(){return this._OpacityTextureEnabled}static set OpacityTextureEnabled(l){this._OpacityTextureEnabled!==l&&(this._OpacityTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get ReflectionTextureEnabled(){return this._ReflectionTextureEnabled}static set ReflectionTextureEnabled(l){this._ReflectionTextureEnabled!==l&&(this._ReflectionTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get EmissiveTextureEnabled(){return this._EmissiveTextureEnabled}static set EmissiveTextureEnabled(l){this._EmissiveTextureEnabled!==l&&(this._EmissiveTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get SpecularTextureEnabled(){return this._SpecularTextureEnabled}static set SpecularTextureEnabled(l){this._SpecularTextureEnabled!==l&&(this._SpecularTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get BumpTextureEnabled(){return this._BumpTextureEnabled}static set BumpTextureEnabled(l){this._BumpTextureEnabled!==l&&(this._BumpTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get LightmapTextureEnabled(){return this._LightmapTextureEnabled}static set LightmapTextureEnabled(l){this._LightmapTextureEnabled!==l&&(this._LightmapTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get RefractionTextureEnabled(){return this._RefractionTextureEnabled}static set RefractionTextureEnabled(l){this._RefractionTextureEnabled!==l&&(this._RefractionTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get ColorGradingTextureEnabled(){return this._ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(l){this._ColorGradingTextureEnabled!==l&&(this._ColorGradingTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get FresnelEnabled(){return this._FresnelEnabled}static set FresnelEnabled(l){this._FresnelEnabled!==l&&(this._FresnelEnabled=l,x.MarkAllMaterialsAsDirty(4))}static get ClearCoatTextureEnabled(){return this._ClearCoatTextureEnabled}static set ClearCoatTextureEnabled(l){this._ClearCoatTextureEnabled!==l&&(this._ClearCoatTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get ClearCoatBumpTextureEnabled(){return this._ClearCoatBumpTextureEnabled}static set ClearCoatBumpTextureEnabled(l){this._ClearCoatBumpTextureEnabled!==l&&(this._ClearCoatBumpTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get ClearCoatTintTextureEnabled(){return this._ClearCoatTintTextureEnabled}static set ClearCoatTintTextureEnabled(l){this._ClearCoatTintTextureEnabled!==l&&(this._ClearCoatTintTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get SheenTextureEnabled(){return this._SheenTextureEnabled}static set SheenTextureEnabled(l){this._SheenTextureEnabled!==l&&(this._SheenTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get AnisotropicTextureEnabled(){return this._AnisotropicTextureEnabled}static set AnisotropicTextureEnabled(l){this._AnisotropicTextureEnabled!==l&&(this._AnisotropicTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get ThicknessTextureEnabled(){return this._ThicknessTextureEnabled}static set ThicknessTextureEnabled(l){this._ThicknessTextureEnabled!==l&&(this._ThicknessTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get RefractionIntensityTextureEnabled(){return this._ThicknessTextureEnabled}static set RefractionIntensityTextureEnabled(l){this._RefractionIntensityTextureEnabled!==l&&(this._RefractionIntensityTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get TranslucencyIntensityTextureEnabled(){return this._ThicknessTextureEnabled}static set TranslucencyIntensityTextureEnabled(l){this._TranslucencyIntensityTextureEnabled!==l&&(this._TranslucencyIntensityTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}static get IridescenceTextureEnabled(){return this._IridescenceTextureEnabled}static set IridescenceTextureEnabled(l){this._IridescenceTextureEnabled!==l&&(this._IridescenceTextureEnabled=l,x.MarkAllMaterialsAsDirty(1))}}hl._DiffuseTextureEnabled=!0;hl._DetailTextureEnabled=!0;hl._AmbientTextureEnabled=!0;hl._OpacityTextureEnabled=!0;hl._ReflectionTextureEnabled=!0;hl._EmissiveTextureEnabled=!0;hl._SpecularTextureEnabled=!0;hl._BumpTextureEnabled=!0;hl._LightmapTextureEnabled=!0;hl._RefractionTextureEnabled=!0;hl._ColorGradingTextureEnabled=!0;hl._FresnelEnabled=!0;hl._ClearCoatTextureEnabled=!0;hl._ClearCoatBumpTextureEnabled=!0;hl._ClearCoatTintTextureEnabled=!0;hl._SheenTextureEnabled=!0;hl._AnisotropicTextureEnabled=!0;hl._ThicknessTextureEnabled=!0;hl._RefractionIntensityTextureEnabled=!0;hl._TranslucencyIntensityTextureEnabled=!0;hl._IridescenceTextureEnabled=!0;const Dn="defaultFragmentDeclaration",jn=`uniform vec4 vEyePosition;
uniform vec4 vDiffuseColor;
#ifdef SPECULARTERM
uniform vec4 vSpecularColor;
#endif
uniform vec3 vEmissiveColor;
uniform vec3 vAmbientColor;
uniform float visibility;
#ifdef DIFFUSE
uniform vec2 vDiffuseInfos;
#endif
#ifdef AMBIENT
uniform vec2 vAmbientInfos;
#endif
#ifdef OPACITY 
uniform vec2 vOpacityInfos;
#endif
#ifdef EMISSIVE
uniform vec2 vEmissiveInfos;
#endif
#ifdef LIGHTMAP
uniform vec2 vLightmapInfos;
#endif
#ifdef BUMP
uniform vec3 vBumpInfos;
uniform vec2 vTangentSpaceParams;
#endif
#ifdef ALPHATEST
uniform float alphaCutOff;
#endif
#if defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_PROJECTION) || defined(REFRACTION) || defined(PREPASS)
uniform mat4 view;
#endif
#ifdef REFRACTION
uniform vec4 vRefractionInfos;
#ifndef REFRACTIONMAP_3D
uniform mat4 refractionMatrix;
#endif
#ifdef REFRACTIONFRESNEL
uniform vec4 refractionLeftColor;
uniform vec4 refractionRightColor;
#endif
#if defined(USE_LOCAL_REFRACTIONMAP_CUBIC) && defined(REFRACTIONMAP_3D)
uniform vec3 vRefractionPosition;
uniform vec3 vRefractionSize; 
#endif
#endif
#if defined(SPECULAR) && defined(SPECULARTERM)
uniform vec2 vSpecularInfos;
#endif
#ifdef DIFFUSEFRESNEL
uniform vec4 diffuseLeftColor;
uniform vec4 diffuseRightColor;
#endif
#ifdef OPACITYFRESNEL
uniform vec4 opacityParts;
#endif
#ifdef EMISSIVEFRESNEL
uniform vec4 emissiveLeftColor;
uniform vec4 emissiveRightColor;
#endif
#ifdef REFLECTION
uniform vec2 vReflectionInfos;
#if defined(REFLECTIONMAP_PLANAR) || defined(REFLECTIONMAP_CUBIC) || defined(REFLECTIONMAP_PROJECTION) || defined(REFLECTIONMAP_EQUIRECTANGULAR) || defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_SKYBOX)
uniform mat4 reflectionMatrix;
#endif
#ifndef REFLECTIONMAP_SKYBOX
#if defined(USE_LOCAL_REFLECTIONMAP_CUBIC) && defined(REFLECTIONMAP_CUBIC)
uniform vec3 vReflectionPosition;
uniform vec3 vReflectionSize; 
#endif
#endif
#ifdef REFLECTIONFRESNEL
uniform vec4 reflectionLeftColor;
uniform vec4 reflectionRightColor;
#endif
#endif
#ifdef DETAIL
uniform vec4 vDetailInfos;
#endif
#define ADDITIONAL_FRAGMENT_DECLARATION
`;H.IncludesShadersStore[Dn]=jn;const An="defaultUboDeclaration",On=`layout(std140,column_major) uniform;
uniform Material
{
vec4 diffuseLeftColor;
vec4 diffuseRightColor;
vec4 opacityParts;
vec4 reflectionLeftColor;
vec4 reflectionRightColor;
vec4 refractionLeftColor;
vec4 refractionRightColor;
vec4 emissiveLeftColor;
vec4 emissiveRightColor;
vec2 vDiffuseInfos;
vec2 vAmbientInfos;
vec2 vOpacityInfos;
vec2 vReflectionInfos;
vec3 vReflectionPosition;
vec3 vReflectionSize;
vec2 vEmissiveInfos;
vec2 vLightmapInfos;
vec2 vSpecularInfos;
vec3 vBumpInfos;
mat4 diffuseMatrix;
mat4 ambientMatrix;
mat4 opacityMatrix;
mat4 reflectionMatrix;
mat4 emissiveMatrix;
mat4 lightmapMatrix;
mat4 specularMatrix;
mat4 bumpMatrix;
vec2 vTangentSpaceParams;
float pointSize;
float alphaCutOff;
mat4 refractionMatrix;
vec4 vRefractionInfos;
vec3 vRefractionPosition;
vec3 vRefractionSize;
vec4 vSpecularColor;
vec3 vEmissiveColor;
vec4 vDiffuseColor;
vec3 vAmbientColor;
#define ADDITIONAL_UBO_DECLARATION
};
#include<sceneUboDeclaration>
#include<meshUboDeclaration>
`;H.IncludesShadersStore[An]=On;const qn="prePassDeclaration",$n=`#ifdef PREPASS
#extension GL_EXT_draw_buffers : require
layout(location=0) out highp vec4 glFragData[{X}];highp vec4 gl_FragColor;
#ifdef PREPASS_DEPTH
varying highp vec3 vViewPos;
#endif
#ifdef PREPASS_VELOCITY
varying highp vec4 vCurrentPosition;varying highp vec4 vPreviousPosition;
#endif
#endif
`;H.IncludesShadersStore[qn]=$n;const lZ="oitDeclaration",eZ=`#ifdef ORDER_INDEPENDENT_TRANSPARENCY
#extension GL_EXT_draw_buffers : require
layout(location=0) out vec2 depth; 
layout(location=1) out vec4 frontColor;
layout(location=2) out vec4 backColor;
#define MAX_DEPTH 99999.0
highp vec4 gl_FragColor;
uniform sampler2D oitDepthSampler;
uniform sampler2D oitFrontColorSampler;
#endif
`;H.IncludesShadersStore[lZ]=eZ;const tZ="mainUVVaryingDeclaration",aZ=`#ifdef MAINUV{X}
varying vec2 vMainUV{X};
#endif
`;H.IncludesShadersStore[tZ]=aZ;const sZ="lightFragmentDeclaration",dZ=`#ifdef LIGHT{X}
uniform vec4 vLightData{X};
uniform vec4 vLightDiffuse{X};
#ifdef SPECULARTERM
uniform vec4 vLightSpecular{X};
#else
vec4 vLightSpecular{X}=vec4(0.);
#endif
#ifdef SHADOW{X}
#ifdef SHADOWCSM{X}
uniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];
uniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];
uniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];
uniform float cascadeBlendFactor{X};
varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];
varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];
varying vec4 vPositionFromCamera{X};
#if defined(SHADOWPCSS{X})
uniform highp sampler2DArrayShadow shadowSampler{X};
uniform highp sampler2DArray depthSampler{X};
uniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];
uniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];
uniform float penumbraDarkness{X};
#elif defined(SHADOWPCF{X})
uniform highp sampler2DArrayShadow shadowSampler{X};
#else
uniform highp sampler2DArray shadowSampler{X};
#endif
#ifdef SHADOWCSMDEBUG{X}
const vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]
(
vec3 ( 1.5,0.0,0.0 ),
vec3 ( 0.0,1.5,0.0 ),
vec3 ( 0.0,0.0,5.5 ),
vec3 ( 1.5,0.0,5.5 ),
vec3 ( 1.5,1.5,0.0 ),
vec3 ( 1.0,1.0,1.0 ),
vec3 ( 0.0,1.0,5.5 ),
vec3 ( 0.5,3.5,0.75 )
);
vec3 shadowDebug{X};
#endif
#ifdef SHADOWCSMUSESHADOWMAXZ{X}
int index{X}=-1;
#else
int index{X}=SHADOWCSMNUM_CASCADES{X}-1;
#endif
float diff{X}=0.;
#elif defined(SHADOWCUBE{X})
uniform samplerCube shadowSampler{X};
#else
varying vec4 vPositionFromLight{X};
varying float vDepthMetric{X};
#if defined(SHADOWPCSS{X})
uniform highp sampler2DShadow shadowSampler{X};
uniform highp sampler2D depthSampler{X};
#elif defined(SHADOWPCF{X})
uniform highp sampler2DShadow shadowSampler{X};
#else
uniform sampler2D shadowSampler{X};
#endif
uniform mat4 lightMatrix{X};
#endif
uniform vec4 shadowsInfo{X};
uniform vec2 depthValues{X};
#endif
#ifdef SPOTLIGHT{X}
uniform vec4 vLightDirection{X};
uniform vec4 vLightFalloff{X};
#elif defined(POINTLIGHT{X})
uniform vec4 vLightFalloff{X};
#elif defined(HEMILIGHT{X})
uniform vec3 vLightGround{X};
#endif
#ifdef PROJECTEDLIGHTTEXTURE{X}
uniform mat4 textureProjectionMatrix{X};
uniform sampler2D projectionLightSampler{X};
#endif
#endif
`;H.IncludesShadersStore[sZ]=dZ;const iZ="lightUboDeclaration",cZ=`#ifdef LIGHT{X}
uniform Light{X}
{
vec4 vLightData;
vec4 vLightDiffuse;
vec4 vLightSpecular;
#ifdef SPOTLIGHT{X}
vec4 vLightDirection;
vec4 vLightFalloff;
#elif defined(POINTLIGHT{X})
vec4 vLightFalloff;
#elif defined(HEMILIGHT{X})
vec3 vLightGround;
#endif
vec4 shadowsInfo;
vec2 depthValues;
} light{X};
#ifdef PROJECTEDLIGHTTEXTURE{X}
uniform mat4 textureProjectionMatrix{X};
uniform sampler2D projectionLightSampler{X};
#endif
#ifdef SHADOW{X}
#ifdef SHADOWCSM{X}
uniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];
uniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];
uniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];
uniform float cascadeBlendFactor{X};
varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];
varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];
varying vec4 vPositionFromCamera{X};
#if defined(SHADOWPCSS{X})
uniform highp sampler2DArrayShadow shadowSampler{X};
uniform highp sampler2DArray depthSampler{X};
uniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];
uniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];
uniform float penumbraDarkness{X};
#elif defined(SHADOWPCF{X})
uniform highp sampler2DArrayShadow shadowSampler{X};
#else
uniform highp sampler2DArray shadowSampler{X};
#endif
#ifdef SHADOWCSMDEBUG{X}
const vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]
(
vec3 ( 1.5,0.0,0.0 ),
vec3 ( 0.0,1.5,0.0 ),
vec3 ( 0.0,0.0,5.5 ),
vec3 ( 1.5,0.0,5.5 ),
vec3 ( 1.5,1.5,0.0 ),
vec3 ( 1.0,1.0,1.0 ),
vec3 ( 0.0,1.0,5.5 ),
vec3 ( 0.5,3.5,0.75 )
);
vec3 shadowDebug{X};
#endif
#ifdef SHADOWCSMUSESHADOWMAXZ{X}
int index{X}=-1;
#else
int index{X}=SHADOWCSMNUM_CASCADES{X}-1;
#endif
float diff{X}=0.;
#elif defined(SHADOWCUBE{X})
uniform samplerCube shadowSampler{X}; 
#else
varying vec4 vPositionFromLight{X};
varying float vDepthMetric{X};
#if defined(SHADOWPCSS{X})
uniform highp sampler2DShadow shadowSampler{X};
uniform highp sampler2D depthSampler{X};
#elif defined(SHADOWPCF{X})
uniform highp sampler2DShadow shadowSampler{X};
#else
uniform sampler2D shadowSampler{X};
#endif
uniform mat4 lightMatrix{X};
#endif
#endif
#endif
`;H.IncludesShadersStore[iZ]=cZ;const nZ="lightsFragmentFunctions",ZZ=`struct lightingInfo
{
vec3 diffuse;
#ifdef SPECULARTERM
vec3 specular;
#endif
#ifdef NDOTL
float ndl;
#endif
};
lightingInfo computeLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {
lightingInfo result;
vec3 lightVectorW;
float attenuation=1.0;
if (lightData.w==0.)
{
vec3 direction=lightData.xyz-vPositionW;
attenuation=max(0.,1.0-length(direction)/range);
lightVectorW=normalize(direction);
}
else
{
lightVectorW=normalize(-lightData.xyz);
}
float ndl=max(0.,dot(vNormal,lightVectorW));
#ifdef NDOTL
result.ndl=ndl;
#endif
result.diffuse=ndl*diffuseColor*attenuation;
#ifdef SPECULARTERM
vec3 angleW=normalize(viewDirectionW+lightVectorW);
float specComp=max(0.,dot(vNormal,angleW));
specComp=pow(specComp,max(1.,glossiness));
result.specular=specComp*specularColor*attenuation;
#endif
return result;
}
lightingInfo computeSpotLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec4 lightDirection,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {
lightingInfo result;
vec3 direction=lightData.xyz-vPositionW;
vec3 lightVectorW=normalize(direction);
float attenuation=max(0.,1.0-length(direction)/range);
float cosAngle=max(0.,dot(lightDirection.xyz,-lightVectorW));
if (cosAngle>=lightDirection.w)
{
cosAngle=max(0.,pow(cosAngle,lightData.w));
attenuation*=cosAngle;
float ndl=max(0.,dot(vNormal,lightVectorW));
#ifdef NDOTL
result.ndl=ndl;
#endif
result.diffuse=ndl*diffuseColor*attenuation;
#ifdef SPECULARTERM
vec3 angleW=normalize(viewDirectionW+lightVectorW);
float specComp=max(0.,dot(vNormal,angleW));
specComp=pow(specComp,max(1.,glossiness));
result.specular=specComp*specularColor*attenuation;
#endif
return result;
}
result.diffuse=vec3(0.);
#ifdef SPECULARTERM
result.specular=vec3(0.);
#endif
#ifdef NDOTL
result.ndl=0.;
#endif
return result;
}
lightingInfo computeHemisphericLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,vec3 groundColor,float glossiness) {
lightingInfo result;
float ndl=dot(vNormal,lightData.xyz)*0.5+0.5;
#ifdef NDOTL
result.ndl=ndl;
#endif
result.diffuse=mix(groundColor,diffuseColor,ndl);
#ifdef SPECULARTERM
vec3 angleW=normalize(viewDirectionW+lightData.xyz);
float specComp=max(0.,dot(vNormal,angleW));
specComp=pow(specComp,max(1.,glossiness));
result.specular=specComp*specularColor;
#endif
return result;
}
#define inline
vec3 computeProjectionTextureDiffuseLighting(sampler2D projectionLightSampler,mat4 textureProjectionMatrix){
vec4 strq=textureProjectionMatrix*vec4(vPositionW,1.0);
strq/=strq.w;
vec3 textureColor=texture2D(projectionLightSampler,strq.xy).rgb;
return textureColor;
}`;H.IncludesShadersStore[nZ]=ZZ;const hZ="shadowsFragmentFunctions",mZ=`#ifdef SHADOWS
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
#define TEXTUREFUNC(s,c,l) texture2DLodEXT(s,c,l)
#else
#define TEXTUREFUNC(s,c,b) texture2D(s,c,b)
#endif
#ifndef SHADOWFLOAT
float unpack(vec4 color)
{
const vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);
return dot(color,bit_shift);
}
#endif
float computeFallOff(float value,vec2 clipSpace,float frustumEdgeFalloff)
{
float mask=smoothstep(1.0-frustumEdgeFalloff,1.00000012,clamp(dot(clipSpace,clipSpace),0.,1.));
return mix(value,1.0,mask);
}
#define inline
float computeShadowCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,vec2 depthValues)
{
vec3 directionToLight=vPositionW-lightPosition;
float depth=length(directionToLight);
depth=(depth+depthValues.x)/(depthValues.y);
depth=clamp(depth,0.,1.0);
directionToLight=normalize(directionToLight);
directionToLight.y=-directionToLight.y;
#ifndef SHADOWFLOAT
float shadow=unpack(textureCube(shadowSampler,directionToLight));
#else
float shadow=textureCube(shadowSampler,directionToLight).x;
#endif
return depth>shadow ? darkness : 1.0;
}
#define inline
float computeShadowWithPoissonSamplingCube(vec3 lightPosition,samplerCube shadowSampler,float mapSize,float darkness,vec2 depthValues)
{
vec3 directionToLight=vPositionW-lightPosition;
float depth=length(directionToLight);
depth=(depth+depthValues.x)/(depthValues.y);
depth=clamp(depth,0.,1.0);
directionToLight=normalize(directionToLight);
directionToLight.y=-directionToLight.y;
float visibility=1.;
vec3 poissonDisk[4];
poissonDisk[0]=vec3(-1.0,1.0,-1.0);
poissonDisk[1]=vec3(1.0,-1.0,-1.0);
poissonDisk[2]=vec3(-1.0,-1.0,-1.0);
poissonDisk[3]=vec3(1.0,-1.0,1.0);
#ifndef SHADOWFLOAT
if (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize))<depth) visibility-=0.25;
if (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize))<depth) visibility-=0.25;
if (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize))<depth) visibility-=0.25;
if (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize))<depth) visibility-=0.25;
#else
if (textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize).x<depth) visibility-=0.25;
if (textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize).x<depth) visibility-=0.25;
if (textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize).x<depth) visibility-=0.25;
if (textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize).x<depth) visibility-=0.25;
#endif
return min(1.0,visibility+darkness);
}
#define inline
float computeShadowWithESMCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)
{
vec3 directionToLight=vPositionW-lightPosition;
float depth=length(directionToLight);
depth=(depth+depthValues.x)/(depthValues.y);
float shadowPixelDepth=clamp(depth,0.,1.0);
directionToLight=normalize(directionToLight);
directionToLight.y=-directionToLight.y;
#ifndef SHADOWFLOAT
float shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));
#else
float shadowMapSample=textureCube(shadowSampler,directionToLight).x;
#endif
float esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness); 
return esm;
}
#define inline
float computeShadowWithCloseESMCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)
{
vec3 directionToLight=vPositionW-lightPosition;
float depth=length(directionToLight);
depth=(depth+depthValues.x)/(depthValues.y);
float shadowPixelDepth=clamp(depth,0.,1.0);
directionToLight=normalize(directionToLight);
directionToLight.y=-directionToLight.y;
#ifndef SHADOWFLOAT
float shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));
#else
float shadowMapSample=textureCube(shadowSampler,directionToLight).x;
#endif
float esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);
return esm;
}
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
#define inline
float computeShadowCSM(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray shadowSampler,float darkness,float frustumEdgeFalloff)
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec2 uv=0.5*clipSpace.xy+vec2(0.5);
vec3 uvLayer=vec3(uv.x,uv.y,layer);
float shadowPixelDepth=clamp(depthMetric,0.,1.0);
#ifndef SHADOWFLOAT
float shadow=unpack(texture2D(shadowSampler,uvLayer));
#else
float shadow=texture2D(shadowSampler,uvLayer).x;
#endif
return shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;
}
#endif
#define inline
float computeShadow(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float frustumEdgeFalloff)
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec2 uv=0.5*clipSpace.xy+vec2(0.5);
if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)
{
return 1.0;
}
else
{
float shadowPixelDepth=clamp(depthMetric,0.,1.0);
#ifndef SHADOWFLOAT
float shadow=unpack(TEXTUREFUNC(shadowSampler,uv,0.));
#else
float shadow=TEXTUREFUNC(shadowSampler,uv,0.).x;
#endif
return shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;
}
}
#define inline
float computeShadowWithPoissonSampling(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float mapSize,float darkness,float frustumEdgeFalloff)
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec2 uv=0.5*clipSpace.xy+vec2(0.5);
if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)
{
return 1.0;
}
else
{
float shadowPixelDepth=clamp(depthMetric,0.,1.0);
float visibility=1.;
vec2 poissonDisk[4];
poissonDisk[0]=vec2(-0.94201624,-0.39906216);
poissonDisk[1]=vec2(0.94558609,-0.76890725);
poissonDisk[2]=vec2(-0.094184101,-0.92938870);
poissonDisk[3]=vec2(0.34495938,0.29387760);
#ifndef SHADOWFLOAT
if (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[0]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;
if (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[1]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;
if (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[2]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;
if (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[3]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;
#else
if (TEXTUREFUNC(shadowSampler,uv+poissonDisk[0]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;
if (TEXTUREFUNC(shadowSampler,uv+poissonDisk[1]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;
if (TEXTUREFUNC(shadowSampler,uv+poissonDisk[2]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;
if (TEXTUREFUNC(shadowSampler,uv+poissonDisk[3]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;
#endif
return computeFallOff(min(1.0,visibility+darkness),clipSpace.xy,frustumEdgeFalloff);
}
}
#define inline
float computeShadowWithESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec2 uv=0.5*clipSpace.xy+vec2(0.5);
if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)
{
return 1.0;
}
else
{
float shadowPixelDepth=clamp(depthMetric,0.,1.0);
#ifndef SHADOWFLOAT
float shadowMapSample=unpack(TEXTUREFUNC(shadowSampler,uv,0.));
#else
float shadowMapSample=TEXTUREFUNC(shadowSampler,uv,0.).x;
#endif
float esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness);
return computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);
}
}
#define inline
float computeShadowWithCloseESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec2 uv=0.5*clipSpace.xy+vec2(0.5);
if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)
{
return 1.0;
}
else
{
float shadowPixelDepth=clamp(depthMetric,0.,1.0); 
#ifndef SHADOWFLOAT
float shadowMapSample=unpack(TEXTUREFUNC(shadowSampler,uv,0.));
#else
float shadowMapSample=TEXTUREFUNC(shadowSampler,uv,0.).x;
#endif
float esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);
return computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);
}
}
#ifdef IS_NDC_HALF_ZRANGE
#define ZINCLIP clipSpace.z
#else
#define ZINCLIP uvDepth.z
#endif
#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)
#define GREATEST_LESS_THAN_ONE 0.99999994
#define inline
float computeShadowWithCSMPCF1(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,float darkness,float frustumEdgeFalloff)
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));
uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);
vec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);
float shadow=texture2D(shadowSampler,uvDepthLayer);
shadow=mix(darkness,1.,shadow);
return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);
}
#define inline
float computeShadowWithCSMPCF3(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));
uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);
vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; 
uv+=0.5; 
vec2 st=fract(uv); 
vec2 base_uv=floor(uv)-0.5; 
base_uv*=shadowMapSizeAndInverse.y; 
vec2 uvw0=3.-2.*st;
vec2 uvw1=1.+2.*st;
vec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;
vec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;
float shadow=0.;
shadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));
shadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));
shadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));
shadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));
shadow=shadow/16.;
shadow=mix(darkness,1.,shadow);
return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);
}
#define inline
float computeShadowWithCSMPCF5(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));
uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);
vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; 
uv+=0.5; 
vec2 st=fract(uv); 
vec2 base_uv=floor(uv)-0.5; 
base_uv*=shadowMapSizeAndInverse.y; 
vec2 uvw0=4.-3.*st;
vec2 uvw1=vec2(7.);
vec2 uvw2=1.+3.*st;
vec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;
vec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;
float shadow=0.;
shadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));
shadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));
shadow+=uvw2.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[0]),layer,uvDepth.z));
shadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));
shadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));
shadow+=uvw2.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[1]),layer,uvDepth.z));
shadow+=uvw0.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[2]),layer,uvDepth.z));
shadow+=uvw1.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[2]),layer,uvDepth.z));
shadow+=uvw2.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[2]),layer,uvDepth.z));
shadow=shadow/144.;
shadow=mix(darkness,1.,shadow);
return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);
}
#define inline
float computeShadowWithPCF1(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,float darkness,float frustumEdgeFalloff)
{
if (depthMetric>1.0 || depthMetric<0.0) {
return 1.0;
}
else
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));
uvDepth.z=ZINCLIP;
float shadow=TEXTUREFUNC(shadowSampler,uvDepth,0.);
shadow=mix(darkness,1.,shadow);
return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);
}
}
#define inline
float computeShadowWithPCF3(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)
{
if (depthMetric>1.0 || depthMetric<0.0) {
return 1.0;
}
else
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));
uvDepth.z=ZINCLIP;
vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; 
uv+=0.5; 
vec2 st=fract(uv); 
vec2 base_uv=floor(uv)-0.5; 
base_uv*=shadowMapSizeAndInverse.y; 
vec2 uvw0=3.-2.*st;
vec2 uvw1=1.+2.*st;
vec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;
vec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;
float shadow=0.;
shadow+=uvw0.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z),0.);
shadow+=uvw1.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z),0.);
shadow+=uvw0.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z),0.);
shadow+=uvw1.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z),0.);
shadow=shadow/16.;
shadow=mix(darkness,1.,shadow);
return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);
}
}
#define inline
float computeShadowWithPCF5(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)
{
if (depthMetric>1.0 || depthMetric<0.0) {
return 1.0;
}
else
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));
uvDepth.z=ZINCLIP;
vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; 
uv+=0.5; 
vec2 st=fract(uv); 
vec2 base_uv=floor(uv)-0.5; 
base_uv*=shadowMapSizeAndInverse.y; 
vec2 uvw0=4.-3.*st;
vec2 uvw1=vec2(7.);
vec2 uvw2=1.+3.*st;
vec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;
vec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;
float shadow=0.;
shadow+=uvw0.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z),0.);
shadow+=uvw1.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z),0.);
shadow+=uvw2.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[0]),uvDepth.z),0.);
shadow+=uvw0.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z),0.);
shadow+=uvw1.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z),0.);
shadow+=uvw2.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[1]),uvDepth.z),0.);
shadow+=uvw0.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[2]),uvDepth.z),0.);
shadow+=uvw1.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[2]),uvDepth.z),0.);
shadow+=uvw2.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[2]),uvDepth.z),0.);
shadow=shadow/144.;
shadow=mix(darkness,1.,shadow);
return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);
}
}
const vec3 PoissonSamplers32[64]=vec3[64](
vec3(0.06407013,0.05409927,0.),
vec3(0.7366577,0.5789394,0.),
vec3(-0.6270542,-0.5320278,0.),
vec3(-0.4096107,0.8411095,0.),
vec3(0.6849564,-0.4990818,0.),
vec3(-0.874181,-0.04579735,0.),
vec3(0.9989998,0.0009880066,0.),
vec3(-0.004920578,-0.9151649,0.),
vec3(0.1805763,0.9747483,0.),
vec3(-0.2138451,0.2635818,0.),
vec3(0.109845,0.3884785,0.),
vec3(0.06876755,-0.3581074,0.),
vec3(0.374073,-0.7661266,0.),
vec3(0.3079132,-0.1216763,0.),
vec3(-0.3794335,-0.8271583,0.),
vec3(-0.203878,-0.07715034,0.),
vec3(0.5912697,0.1469799,0.),
vec3(-0.88069,0.3031784,0.),
vec3(0.5040108,0.8283722,0.),
vec3(-0.5844124,0.5494877,0.),
vec3(0.6017799,-0.1726654,0.),
vec3(-0.5554981,0.1559997,0.),
vec3(-0.3016369,-0.3900928,0.),
vec3(-0.5550632,-0.1723762,0.),
vec3(0.925029,0.2995041,0.),
vec3(-0.2473137,0.5538505,0.),
vec3(0.9183037,-0.2862392,0.),
vec3(0.2469421,0.6718712,0.),
vec3(0.3916397,-0.4328209,0.),
vec3(-0.03576927,-0.6220032,0.),
vec3(-0.04661255,0.7995201,0.),
vec3(0.4402924,0.3640312,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.),
vec3(0.,0.,0.)
);
const vec3 PoissonSamplers64[64]=vec3[64](
vec3(-0.613392,0.617481,0.),
vec3(0.170019,-0.040254,0.),
vec3(-0.299417,0.791925,0.),
vec3(0.645680,0.493210,0.),
vec3(-0.651784,0.717887,0.),
vec3(0.421003,0.027070,0.),
vec3(-0.817194,-0.271096,0.),
vec3(-0.705374,-0.668203,0.),
vec3(0.977050,-0.108615,0.),
vec3(0.063326,0.142369,0.),
vec3(0.203528,0.214331,0.),
vec3(-0.667531,0.326090,0.),
vec3(-0.098422,-0.295755,0.),
vec3(-0.885922,0.215369,0.),
vec3(0.566637,0.605213,0.),
vec3(0.039766,-0.396100,0.),
vec3(0.751946,0.453352,0.),
vec3(0.078707,-0.715323,0.),
vec3(-0.075838,-0.529344,0.),
vec3(0.724479,-0.580798,0.),
vec3(0.222999,-0.215125,0.),
vec3(-0.467574,-0.405438,0.),
vec3(-0.248268,-0.814753,0.),
vec3(0.354411,-0.887570,0.),
vec3(0.175817,0.382366,0.),
vec3(0.487472,-0.063082,0.),
vec3(-0.084078,0.898312,0.),
vec3(0.488876,-0.783441,0.),
vec3(0.470016,0.217933,0.),
vec3(-0.696890,-0.549791,0.),
vec3(-0.149693,0.605762,0.),
vec3(0.034211,0.979980,0.),
vec3(0.503098,-0.308878,0.),
vec3(-0.016205,-0.872921,0.),
vec3(0.385784,-0.393902,0.),
vec3(-0.146886,-0.859249,0.),
vec3(0.643361,0.164098,0.),
vec3(0.634388,-0.049471,0.),
vec3(-0.688894,0.007843,0.),
vec3(0.464034,-0.188818,0.),
vec3(-0.440840,0.137486,0.),
vec3(0.364483,0.511704,0.),
vec3(0.034028,0.325968,0.),
vec3(0.099094,-0.308023,0.),
vec3(0.693960,-0.366253,0.),
vec3(0.678884,-0.204688,0.),
vec3(0.001801,0.780328,0.),
vec3(0.145177,-0.898984,0.),
vec3(0.062655,-0.611866,0.),
vec3(0.315226,-0.604297,0.),
vec3(-0.780145,0.486251,0.),
vec3(-0.371868,0.882138,0.),
vec3(0.200476,0.494430,0.),
vec3(-0.494552,-0.711051,0.),
vec3(0.612476,0.705252,0.),
vec3(-0.578845,-0.768792,0.),
vec3(-0.772454,-0.090976,0.),
vec3(0.504440,0.372295,0.),
vec3(0.155736,0.065157,0.),
vec3(0.391522,0.849605,0.),
vec3(-0.620106,-0.328104,0.),
vec3(0.789239,-0.419965,0.),
vec3(-0.545396,0.538133,0.),
vec3(-0.178564,-0.596057,0.)
);
#define inline
float computeShadowWithCSMPCSS(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));
uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);
vec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);
float blockerDepth=0.0;
float sumBlockerDepth=0.0;
float numBlocker=0.0;
for (int i=0; i<searchTapCount; i ++) {
blockerDepth=texture2D(depthSampler,vec3(uvDepth.xy+(lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse*PoissonSamplers32[i].xy),layer)).r;
if (blockerDepth<depthMetric) {
sumBlockerDepth+=blockerDepth;
numBlocker++;
}
}
float avgBlockerDepth=sumBlockerDepth/numBlocker;
float AAOffset=shadowMapSizeInverse*10.;
float penumbraRatio=((depthMetric-avgBlockerDepth)*depthCorrection+AAOffset);
vec4 filterRadius=vec4(penumbraRatio*lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse,0.,0.);
float random=getRand(vPositionFromLight.xy);
float rotationAngle=random*3.1415926;
vec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));
float shadow=0.;
for (int i=0; i<pcfTapCount; i++) {
vec4 offset=vec4(poissonSamplers[i],0.);
offset=vec4(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.,0.);
shadow+=texture2D(shadowSampler,uvDepthLayer+offset*filterRadius);
}
shadow/=float(pcfTapCount);
shadow=mix(shadow,1.,min((depthMetric-avgBlockerDepth)*depthCorrection*penumbraDarkness,1.));
shadow=mix(darkness,1.,shadow);
if (numBlocker<1.0) {
return 1.0;
}
else
{
return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);
}
}
#define inline
float computeShadowWithPCSS(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers)
{
if (depthMetric>1.0 || depthMetric<0.0) {
return 1.0;
}
else
{
vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;
vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));
uvDepth.z=ZINCLIP;
float blockerDepth=0.0;
float sumBlockerDepth=0.0;
float numBlocker=0.0;
for (int i=0; i<searchTapCount; i ++) {
blockerDepth=TEXTUREFUNC(depthSampler,uvDepth.xy+(lightSizeUV*shadowMapSizeInverse*PoissonSamplers32[i].xy),0.).r;
if (blockerDepth<depthMetric) {
sumBlockerDepth+=blockerDepth;
numBlocker++;
}
}
if (numBlocker<1.0) {
return 1.0;
}
else
{
float avgBlockerDepth=sumBlockerDepth/numBlocker;
float AAOffset=shadowMapSizeInverse*10.;
float penumbraRatio=((depthMetric-avgBlockerDepth)+AAOffset);
float filterRadius=penumbraRatio*lightSizeUV*shadowMapSizeInverse;
float random=getRand(vPositionFromLight.xy);
float rotationAngle=random*3.1415926;
vec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));
float shadow=0.;
for (int i=0; i<pcfTapCount; i++) {
vec3 offset=poissonSamplers[i];
offset=vec3(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.);
shadow+=TEXTUREFUNC(shadowSampler,uvDepth+offset*filterRadius,0.);
}
shadow/=float(pcfTapCount);
shadow=mix(shadow,1.,depthMetric-avgBlockerDepth);
shadow=mix(darkness,1.,shadow);
return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);
}
}
}
#define inline
float computeShadowWithPCSS16(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)
{
return computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32);
}
#define inline
float computeShadowWithPCSS32(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)
{
return computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32);
}
#define inline
float computeShadowWithPCSS64(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)
{
return computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64);
}
#define inline
float computeShadowWithCSMPCSS16(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)
{
return computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);
}
#define inline
float computeShadowWithCSMPCSS32(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)
{
return computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);
}
#define inline
float computeShadowWithCSMPCSS64(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)
{
return computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64,lightSizeUVCorrection,depthCorrection,penumbraDarkness);
}
#endif
#endif
`;H.IncludesShadersStore[hZ]=mZ;const oZ="samplerFragmentDeclaration",bZ=`#ifdef _DEFINENAME_
#if _DEFINENAME_DIRECTUV==1
#define v_VARYINGNAME_UV vMainUV1
#elif _DEFINENAME_DIRECTUV==2
#define v_VARYINGNAME_UV vMainUV2
#elif _DEFINENAME_DIRECTUV==3
#define v_VARYINGNAME_UV vMainUV3
#elif _DEFINENAME_DIRECTUV==4
#define v_VARYINGNAME_UV vMainUV4
#elif _DEFINENAME_DIRECTUV==5
#define v_VARYINGNAME_UV vMainUV5
#elif _DEFINENAME_DIRECTUV==6
#define v_VARYINGNAME_UV vMainUV6
#else
varying vec2 v_VARYINGNAME_UV;
#endif
uniform sampler2D _SAMPLERNAME_Sampler;
#endif
`;H.IncludesShadersStore[oZ]=bZ;const XZ="fresnelFunction",uZ=`#ifdef FRESNEL
float computeFresnelTerm(vec3 viewDirection,vec3 worldNormal,float bias,float power)
{
float fresnelTerm=pow(bias+abs(dot(viewDirection,worldNormal)),power);
return clamp(fresnelTerm,0.,1.);
}
#endif
`;H.IncludesShadersStore[XZ]=uZ;const rZ="reflectionFunction",GZ=`vec3 computeFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)
{
float lon=atan(direction.z,direction.x);
float lat=acos(direction.y);
vec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;
float s=sphereCoords.x*0.5+0.5;
float t=sphereCoords.y;
return vec3(s,t,0); 
}
vec3 computeMirroredFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)
{
float lon=atan(direction.z,direction.x);
float lat=acos(direction.y);
vec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;
float s=sphereCoords.x*0.5+0.5;
float t=sphereCoords.y;
return vec3(1.0-s,t,0); 
}
vec3 computeEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)
{
vec3 cameraToVertex=normalize(worldPos.xyz-eyePosition);
vec3 r=normalize(reflect(cameraToVertex,worldNormal));
r=vec3(reflectionMatrix*vec4(r,0));
float lon=atan(r.z,r.x);
float lat=acos(r.y);
vec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;
float s=sphereCoords.x*0.5+0.5;
float t=sphereCoords.y;
return vec3(s,t,0);
}
vec3 computeSphericalCoords(vec4 worldPos,vec3 worldNormal,mat4 view,mat4 reflectionMatrix)
{
vec3 viewDir=normalize(vec3(view*worldPos));
vec3 viewNormal=normalize(vec3(view*vec4(worldNormal,0.0)));
vec3 r=reflect(viewDir,viewNormal);
r=vec3(reflectionMatrix*vec4(r,0));
r.z=r.z-1.0;
float m=2.0*length(r);
return vec3(r.x/m+0.5,1.0-r.y/m-0.5,0);
}
vec3 computePlanarCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)
{
vec3 viewDir=worldPos.xyz-eyePosition;
vec3 coords=normalize(reflect(viewDir,worldNormal));
return vec3(reflectionMatrix*vec4(coords,1));
}
vec3 computeCubicCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)
{
vec3 viewDir=normalize(worldPos.xyz-eyePosition);
vec3 coords=reflect(viewDir,worldNormal);
coords=vec3(reflectionMatrix*vec4(coords,0));
#ifdef INVERTCUBICMAP
coords.y*=-1.0;
#endif
return coords;
}
vec3 computeCubicLocalCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix,vec3 reflectionSize,vec3 reflectionPosition)
{
vec3 viewDir=normalize(worldPos.xyz-eyePosition);
vec3 coords=reflect(viewDir,worldNormal);
coords=parallaxCorrectNormal(worldPos.xyz,coords,reflectionSize,reflectionPosition);
coords=vec3(reflectionMatrix*vec4(coords,0));
#ifdef INVERTCUBICMAP
coords.y*=-1.0;
#endif
return coords;
}
vec3 computeProjectionCoords(vec4 worldPos,mat4 view,mat4 reflectionMatrix)
{
return vec3(reflectionMatrix*(view*worldPos));
}
vec3 computeSkyBoxCoords(vec3 positionW,mat4 reflectionMatrix)
{
return vec3(reflectionMatrix*vec4(positionW,1.));
}
#ifdef REFLECTION
vec3 computeReflectionCoords(vec4 worldPos,vec3 worldNormal)
{
#ifdef REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED
vec3 direction=normalize(vDirectionW);
return computeMirroredFixedEquirectangularCoords(worldPos,worldNormal,direction);
#endif
#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED
vec3 direction=normalize(vDirectionW);
return computeFixedEquirectangularCoords(worldPos,worldNormal,direction);
#endif
#ifdef REFLECTIONMAP_EQUIRECTANGULAR
return computeEquirectangularCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);
#endif
#ifdef REFLECTIONMAP_SPHERICAL
return computeSphericalCoords(worldPos,worldNormal,view,reflectionMatrix);
#endif
#ifdef REFLECTIONMAP_PLANAR
return computePlanarCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);
#endif
#ifdef REFLECTIONMAP_CUBIC
#ifdef USE_LOCAL_REFLECTIONMAP_CUBIC
return computeCubicLocalCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix,vReflectionSize,vReflectionPosition);
#else
return computeCubicCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);
#endif
#endif
#ifdef REFLECTIONMAP_PROJECTION
return computeProjectionCoords(worldPos,view,reflectionMatrix);
#endif
#ifdef REFLECTIONMAP_SKYBOX
return computeSkyBoxCoords(vPositionUVW,reflectionMatrix);
#endif
#ifdef REFLECTIONMAP_EXPLICIT
return vec3(0,0,0);
#endif
}
#endif
`;H.IncludesShadersStore[rZ]=GZ;const VZ="imageProcessingDeclaration",RZ=`#ifdef EXPOSURE
uniform float exposureLinear;
#endif
#ifdef CONTRAST
uniform float contrast;
#endif
#if defined(VIGNETTE) || defined(DITHER)
uniform vec2 vInverseScreenSize;
#endif
#ifdef VIGNETTE
uniform vec4 vignetteSettings1;
uniform vec4 vignetteSettings2;
#endif
#ifdef COLORCURVES
uniform vec4 vCameraColorCurveNegative;
uniform vec4 vCameraColorCurveNeutral;
uniform vec4 vCameraColorCurvePositive;
#endif
#ifdef COLORGRADING
#ifdef COLORGRADING3D
uniform highp sampler3D txColorTransform;
#else
uniform sampler2D txColorTransform;
#endif
uniform vec4 colorTransformSettings;
#endif
#ifdef DITHER
uniform float ditherIntensity;
#endif
`;H.IncludesShadersStore[VZ]=RZ;const WZ="imageProcessingFunctions",pZ=`#if defined(COLORGRADING) && !defined(COLORGRADING3D)
/** 
* Polyfill for SAMPLE_TEXTURE_3D,which is unsupported in WebGL.
* sampler3dSetting.x=textureOffset (0.5/textureSize).
* sampler3dSetting.y=textureSize.
*/
#define inline
vec3 sampleTexture3D(sampler2D colorTransform,vec3 color,vec2 sampler3dSetting)
{
float sliceSize=2.0*sampler3dSetting.x; 
#ifdef SAMPLER3DGREENDEPTH
float sliceContinuous=(color.g-sampler3dSetting.x)*sampler3dSetting.y;
#else
float sliceContinuous=(color.b-sampler3dSetting.x)*sampler3dSetting.y;
#endif
float sliceInteger=floor(sliceContinuous);
float sliceFraction=sliceContinuous-sliceInteger;
#ifdef SAMPLER3DGREENDEPTH
vec2 sliceUV=color.rb;
#else
vec2 sliceUV=color.rg;
#endif
sliceUV.x*=sliceSize;
sliceUV.x+=sliceInteger*sliceSize;
sliceUV=saturate(sliceUV);
vec4 slice0Color=texture2D(colorTransform,sliceUV);
sliceUV.x+=sliceSize;
sliceUV=saturate(sliceUV);
vec4 slice1Color=texture2D(colorTransform,sliceUV);
vec3 result=mix(slice0Color.rgb,slice1Color.rgb,sliceFraction);
#ifdef SAMPLER3DBGRMAP
color.rgb=result.rgb;
#else
color.rgb=result.bgr;
#endif
return color;
}
#endif
#ifdef TONEMAPPING_ACES
const mat3 ACESInputMat=mat3(
vec3(0.59719,0.07600,0.02840),
vec3(0.35458,0.90834,0.13383),
vec3(0.04823,0.01566,0.83777)
);
const mat3 ACESOutputMat=mat3(
vec3( 1.60475,-0.10208,-0.00327),
vec3(-0.53108, 1.10813,-0.07276),
vec3(-0.07367,-0.00605, 1.07602)
);
vec3 RRTAndODTFit(vec3 v)
{
vec3 a=v*(v+0.0245786)-0.000090537;
vec3 b=v*(0.983729*v+0.4329510)+0.238081;
return a/b;
}
vec3 ACESFitted(vec3 color)
{
color=ACESInputMat*color;
color=RRTAndODTFit(color);
color=ACESOutputMat*color;
color=saturate(color);
return color;
}
#endif
#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_DEFINITIONS
vec4 applyImageProcessing(vec4 result) {
#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_UPDATERESULT_ATSTART
#ifdef EXPOSURE
result.rgb*=exposureLinear;
#endif
#ifdef VIGNETTE
vec2 viewportXY=gl_FragCoord.xy*vInverseScreenSize;
viewportXY=viewportXY*2.0-1.0;
vec3 vignetteXY1=vec3(viewportXY*vignetteSettings1.xy+vignetteSettings1.zw,1.0);
float vignetteTerm=dot(vignetteXY1,vignetteXY1);
float vignette=pow(vignetteTerm,vignetteSettings2.w);
vec3 vignetteColor=vignetteSettings2.rgb;
#ifdef VIGNETTEBLENDMODEMULTIPLY
vec3 vignetteColorMultiplier=mix(vignetteColor,vec3(1,1,1),vignette);
result.rgb*=vignetteColorMultiplier;
#endif
#ifdef VIGNETTEBLENDMODEOPAQUE
result.rgb=mix(vignetteColor,result.rgb,vignette);
#endif
#endif
#ifdef TONEMAPPING
#ifdef TONEMAPPING_ACES
result.rgb=ACESFitted(result.rgb);
#else
const float tonemappingCalibration=1.590579;
result.rgb=1.0-exp2(-tonemappingCalibration*result.rgb);
#endif
#endif
result.rgb=toGammaSpace(result.rgb);
result.rgb=saturate(result.rgb);
#ifdef CONTRAST
vec3 resultHighContrast=result.rgb*result.rgb*(3.0-2.0*result.rgb);
if (contrast<1.0) {
result.rgb=mix(vec3(0.5,0.5,0.5),result.rgb,contrast);
} else {
result.rgb=mix(result.rgb,resultHighContrast,contrast-1.0);
}
#endif
#ifdef COLORGRADING
vec3 colorTransformInput=result.rgb*colorTransformSettings.xxx+colorTransformSettings.yyy;
#ifdef COLORGRADING3D
vec3 colorTransformOutput=texture(txColorTransform,colorTransformInput).rgb;
#else
vec3 colorTransformOutput=sampleTexture3D(txColorTransform,colorTransformInput,colorTransformSettings.yz).rgb;
#endif
result.rgb=mix(result.rgb,colorTransformOutput,colorTransformSettings.www);
#endif
#ifdef COLORCURVES
float luma=getLuminance(result.rgb);
vec2 curveMix=clamp(vec2(luma*3.0-1.5,luma*-3.0+1.5),vec2(0.0),vec2(1.0));
vec4 colorCurve=vCameraColorCurveNeutral+curveMix.x*vCameraColorCurvePositive-curveMix.y*vCameraColorCurveNegative;
result.rgb*=colorCurve.rgb;
result.rgb=mix(vec3(luma),result.rgb,colorCurve.a);
#endif
#ifdef DITHER
float rand=getRand(gl_FragCoord.xy*vInverseScreenSize);
float dither=mix(-ditherIntensity,ditherIntensity,rand);
result.rgb=saturate(result.rgb+vec3(dither));
#endif
#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_UPDATERESULT_ATEND
return result;
}`;H.IncludesShadersStore[WZ]=pZ;const yZ="bumpFragmentMainFunctions",YZ=`#if defined(BUMP) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC) || defined(DETAIL)
#if defined(TANGENT) && defined(NORMAL) 
varying mat3 vTBN;
#endif
#ifdef OBJECTSPACE_NORMALMAP
uniform mat4 normalMatrix;
#endif
vec3 perturbNormalBase(mat3 cotangentFrame,vec3 normal,float scale)
{
#ifdef NORMALXYSCALE
normal=normalize(normal*vec3(scale,scale,1.0));
#endif
return normalize(cotangentFrame*normal);
}
vec3 perturbNormal(mat3 cotangentFrame,vec3 textureSample,float scale)
{
return perturbNormalBase(cotangentFrame,textureSample*2.0-1.0,scale);
}
mat3 cotangent_frame(vec3 normal,vec3 p,vec2 uv,vec2 tangentSpaceParams)
{
vec3 dp1=dFdx(p);
vec3 dp2=dFdy(p);
vec2 duv1=dFdx(uv);
vec2 duv2=dFdy(uv);
vec3 dp2perp=cross(dp2,normal);
vec3 dp1perp=cross(normal,dp1);
vec3 tangent=dp2perp*duv1.x+dp1perp*duv2.x;
vec3 bitangent=dp2perp*duv1.y+dp1perp*duv2.y;
tangent*=tangentSpaceParams.x;
bitangent*=tangentSpaceParams.y;
float det=max(dot(tangent,tangent),dot(bitangent,bitangent));
float invmax=det==0.0 ? 0.0 : inversesqrt(det);
return mat3(tangent*invmax,bitangent*invmax,normal);
}
#endif
`;H.IncludesShadersStore[yZ]=YZ;const NZ="bumpFragmentFunctions",FZ=`#if defined(BUMP)
#include<samplerFragmentDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_SAMPLERNAME_,bump)
#endif
#if defined(DETAIL)
#include<samplerFragmentDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_SAMPLERNAME_,detail)
#endif
#if defined(BUMP) && defined(PARALLAX)
const float minSamples=4.;
const float maxSamples=15.;
const int iMaxSamples=15;
vec2 parallaxOcclusion(vec3 vViewDirCoT,vec3 vNormalCoT,vec2 texCoord,float parallaxScale) {
float parallaxLimit=length(vViewDirCoT.xy)/vViewDirCoT.z;
parallaxLimit*=parallaxScale;
vec2 vOffsetDir=normalize(vViewDirCoT.xy);
vec2 vMaxOffset=vOffsetDir*parallaxLimit;
float numSamples=maxSamples+(dot(vViewDirCoT,vNormalCoT)*(minSamples-maxSamples));
float stepSize=1.0/numSamples;
float currRayHeight=1.0;
vec2 vCurrOffset=vec2(0,0);
vec2 vLastOffset=vec2(0,0);
float lastSampledHeight=1.0;
float currSampledHeight=1.0;
bool keepWorking=true;
for (int i=0; i<iMaxSamples; i++)
{
currSampledHeight=texture2D(bumpSampler,texCoord+vCurrOffset).w;
if (!keepWorking)
{
}
else if (currSampledHeight>currRayHeight)
{
float delta1=currSampledHeight-currRayHeight;
float delta2=(currRayHeight+stepSize)-lastSampledHeight;
float ratio=delta1/(delta1+delta2);
vCurrOffset=(ratio)* vLastOffset+(1.0-ratio)*vCurrOffset;
keepWorking=false;
}
else
{
currRayHeight-=stepSize;
vLastOffset=vCurrOffset;
vCurrOffset+=stepSize*vMaxOffset;
lastSampledHeight=currSampledHeight;
}
}
return vCurrOffset;
}
vec2 parallaxOffset(vec3 viewDir,float heightScale)
{
float height=texture2D(bumpSampler,vBumpUV).w;
vec2 texCoordOffset=heightScale*viewDir.xy*height;
return -texCoordOffset;
}
#endif
`;H.IncludesShadersStore[NZ]=FZ;const SZ="logDepthDeclaration",LZ=`#ifdef LOGARITHMICDEPTH
uniform float logarithmicDepthConstant;
varying float vFragmentDepth;
#endif
`;H.IncludesShadersStore[SZ]=LZ;const JZ="fogFragmentDeclaration",xZ=`#ifdef FOG
#define FOGMODE_NONE 0.
#define FOGMODE_EXP 1.
#define FOGMODE_EXP2 2.
#define FOGMODE_LINEAR 3.
#define E 2.71828
uniform vec4 vFogInfos;
uniform vec3 vFogColor;
varying vec3 vFogDistance;
float CalcFogFactor()
{
float fogCoeff=1.0;
float fogStart=vFogInfos.y;
float fogEnd=vFogInfos.z;
float fogDensity=vFogInfos.w;
float fogDistance=length(vFogDistance);
if (FOGMODE_LINEAR==vFogInfos.x)
{
fogCoeff=(fogEnd-fogDistance)/(fogEnd-fogStart);
}
else if (FOGMODE_EXP==vFogInfos.x)
{
fogCoeff=1.0/pow(E,fogDistance*fogDensity);
}
else if (FOGMODE_EXP2==vFogInfos.x)
{
fogCoeff=1.0/pow(E,fogDistance*fogDistance*fogDensity*fogDensity);
}
return clamp(fogCoeff,0.0,1.0);
}
#endif
`;H.IncludesShadersStore[JZ]=xZ;const UZ="bumpFragment",fZ=`vec2 uvOffset=vec2(0.0,0.0);
#if defined(BUMP) || defined(PARALLAX) || defined(DETAIL)
#ifdef NORMALXYSCALE
float normalScale=1.0;
#elif defined(BUMP)
float normalScale=vBumpInfos.y;
#else
float normalScale=1.0;
#endif
#if defined(TANGENT) && defined(NORMAL)
mat3 TBN=vTBN;
#elif defined(BUMP)
vec2 TBNUV=gl_FrontFacing ? vBumpUV : -vBumpUV;
mat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vTangentSpaceParams);
#else
vec2 TBNUV=gl_FrontFacing ? vDetailUV : -vDetailUV;
mat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vec2(1.,1.));
#endif
#elif defined(ANISOTROPIC)
#if defined(TANGENT) && defined(NORMAL)
mat3 TBN=vTBN;
#else
vec2 TBNUV=gl_FrontFacing ? vMainUV1 : -vMainUV1;
mat3 TBN=cotangent_frame(normalW,vPositionW,TBNUV,vec2(1.,1.));
#endif
#endif
#ifdef PARALLAX
mat3 invTBN=transposeMat3(TBN);
#ifdef PARALLAXOCCLUSION
uvOffset=parallaxOcclusion(invTBN*-viewDirectionW,invTBN*normalW,vBumpUV,vBumpInfos.z);
#else
uvOffset=parallaxOffset(invTBN*viewDirectionW,vBumpInfos.z);
#endif
#endif
#ifdef DETAIL
vec4 detailColor=texture2D(detailSampler,vDetailUV+uvOffset);
vec2 detailNormalRG=detailColor.wy*2.0-1.0;
float detailNormalB=sqrt(1.-saturate(dot(detailNormalRG,detailNormalRG)));
vec3 detailNormal=vec3(detailNormalRG,detailNormalB);
#endif
#ifdef BUMP
#ifdef OBJECTSPACE_NORMALMAP
normalW=normalize(texture2D(bumpSampler,vBumpUV).xyz *2.0-1.0);
normalW=normalize(mat3(normalMatrix)*normalW);
#elif !defined(DETAIL)
normalW=perturbNormal(TBN,texture2D(bumpSampler,vBumpUV+uvOffset).xyz,vBumpInfos.y);
#else
vec3 bumpNormal=texture2D(bumpSampler,vBumpUV+uvOffset).xyz*2.0-1.0;
#if DETAIL_NORMALBLENDMETHOD==0 
detailNormal.xy*=vDetailInfos.z;
vec3 blendedNormal=normalize(vec3(bumpNormal.xy+detailNormal.xy,bumpNormal.z*detailNormal.z));
#elif DETAIL_NORMALBLENDMETHOD==1 
detailNormal.xy*=vDetailInfos.z;
bumpNormal+=vec3(0.0,0.0,1.0);
detailNormal*=vec3(-1.0,-1.0,1.0);
vec3 blendedNormal=bumpNormal*dot(bumpNormal,detailNormal)/bumpNormal.z-detailNormal;
#endif
normalW=perturbNormalBase(TBN,blendedNormal,vBumpInfos.y);
#endif
#elif defined(DETAIL)
detailNormal.xy*=vDetailInfos.z;
normalW=perturbNormalBase(TBN,detailNormal,vDetailInfos.z);
#endif
`;H.IncludesShadersStore[UZ]=fZ;const TZ="depthPrePass",zZ=`#ifdef DEPTHPREPASS
gl_FragColor=vec4(0.,0.,0.,1.0);
return;
#endif
`;H.IncludesShadersStore[TZ]=zZ;const MZ="lightFragment",gZ=`#ifdef LIGHT{X}
#if defined(SHADOWONLY) || defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X}) && defined(LIGHTMAPNOSPECULAR{X})
#else
#ifdef PBR
#ifdef SPOTLIGHT{X}
preInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);
#elif defined(POINTLIGHT{X})
preInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);
#elif defined(HEMILIGHT{X})
preInfo=computeHemisphericPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);
#elif defined(DIRLIGHT{X})
preInfo=computeDirectionalPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);
#endif
preInfo.NdotV=NdotV;
#ifdef SPOTLIGHT{X}
#ifdef LIGHT_FALLOFF_GLTF{X}
preInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);
preInfo.attenuation*=computeDirectionalLightFalloff_GLTF(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);
#elif defined(LIGHT_FALLOFF_PHYSICAL{X})
preInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);
preInfo.attenuation*=computeDirectionalLightFalloff_Physical(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w);
#elif defined(LIGHT_FALLOFF_STANDARD{X})
preInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);
preInfo.attenuation*=computeDirectionalLightFalloff_Standard(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w);
#else
preInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);
preInfo.attenuation*=computeDirectionalLightFalloff(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);
#endif
#elif defined(POINTLIGHT{X})
#ifdef LIGHT_FALLOFF_GLTF{X}
preInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);
#elif defined(LIGHT_FALLOFF_PHYSICAL{X})
preInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);
#elif defined(LIGHT_FALLOFF_STANDARD{X})
preInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);
#else
preInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);
#endif
#else
preInfo.attenuation=1.0;
#endif
#ifdef HEMILIGHT{X}
preInfo.roughness=roughness;
#else
preInfo.roughness=adjustRoughnessFromLightProperties(roughness,light{X}.vLightSpecular.a,preInfo.lightDistance);
#endif
#ifdef IRIDESCENCE
preInfo.iridescenceIntensity=iridescenceIntensity;
#endif
#ifdef HEMILIGHT{X}
info.diffuse=computeHemisphericDiffuseLighting(preInfo,light{X}.vLightDiffuse.rgb,light{X}.vLightGround);
#elif defined(SS_TRANSLUCENCY)
info.diffuse=computeDiffuseAndTransmittedLighting(preInfo,light{X}.vLightDiffuse.rgb,subSurfaceOut.transmittance);
#else
info.diffuse=computeDiffuseLighting(preInfo,light{X}.vLightDiffuse.rgb);
#endif
#ifdef SPECULARTERM
#ifdef ANISOTROPIC
info.specular=computeAnisotropicSpecularLighting(preInfo,viewDirectionW,normalW,anisotropicOut.anisotropicTangent,anisotropicOut.anisotropicBitangent,anisotropicOut.anisotropy,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);
#else
info.specular=computeSpecularLighting(preInfo,normalW,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);
#endif
#endif
#ifdef SHEEN
#ifdef SHEEN_LINKWITHALBEDO
preInfo.roughness=sheenOut.sheenIntensity;
#else
#ifdef HEMILIGHT{X}
preInfo.roughness=sheenOut.sheenRoughness;
#else
preInfo.roughness=adjustRoughnessFromLightProperties(sheenOut.sheenRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);
#endif
#endif
info.sheen=computeSheenLighting(preInfo,normalW,sheenOut.sheenColor,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);
#endif
#ifdef CLEARCOAT
#ifdef HEMILIGHT{X}
preInfo.roughness=clearcoatOut.clearCoatRoughness;
#else
preInfo.roughness=adjustRoughnessFromLightProperties(clearcoatOut.clearCoatRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);
#endif
info.clearCoat=computeClearCoatLighting(preInfo,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatAARoughnessFactors.x,clearcoatOut.clearCoatIntensity,light{X}.vLightDiffuse.rgb);
#ifdef CLEARCOAT_TINT
absorption=computeClearCoatLightingAbsorption(clearcoatOut.clearCoatNdotVRefract,preInfo.L,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatColor,clearcoatOut.clearCoatThickness,clearcoatOut.clearCoatIntensity);
info.diffuse*=absorption;
#ifdef SPECULARTERM
info.specular*=absorption;
#endif
#endif
info.diffuse*=info.clearCoat.w;
#ifdef SPECULARTERM
info.specular*=info.clearCoat.w;
#endif
#ifdef SHEEN
info.sheen*=info.clearCoat.w;
#endif
#endif
#else
#ifdef SPOTLIGHT{X}
info=computeSpotLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDirection,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightDiffuse.a,glossiness);
#elif defined(HEMILIGHT{X})
info=computeHemisphericLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightGround,glossiness);
#elif defined(POINTLIGHT{X}) || defined(DIRLIGHT{X})
info=computeLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightDiffuse.a,glossiness);
#endif
#endif
#ifdef PROJECTEDLIGHTTEXTURE{X}
info.diffuse*=computeProjectionTextureDiffuseLighting(projectionLightSampler{X},textureProjectionMatrix{X});
#endif
#endif
#ifdef SHADOW{X}
#ifdef SHADOWCSM{X}
for (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) 
{
#ifdef SHADOWCSM_RIGHTHANDED{X}
diff{X}=viewFrustumZ{X}[i]+vPositionFromCamera{X}.z;
#else
diff{X}=viewFrustumZ{X}[i]-vPositionFromCamera{X}.z;
#endif
if (diff{X}>=0.) {
index{X}=i;
break;
}
}
#ifdef SHADOWCSMUSESHADOWMAXZ{X}
if (index{X}>=0)
#endif
{
#if defined(SHADOWPCF{X})
#if defined(SHADOWLOWQUALITY{X})
shadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#elif defined(SHADOWMEDIUMQUALITY{X})
shadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#else
shadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWPCSS{X})
#if defined(SHADOWLOWQUALITY{X})
shadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#elif defined(SHADOWMEDIUMQUALITY{X})
shadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#else
shadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#endif
#else
shadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#ifdef SHADOWCSMDEBUG{X}
shadowDebug{X}=vec3(shadow)*vCascadeColorsMultiplier{X}[index{X}];
#endif
#ifndef SHADOWCSMNOBLEND{X}
float frustumLength=frustumLengths{X}[index{X}];
float diffRatio=clamp(diff{X}/frustumLength,0.,1.)*cascadeBlendFactor{X};
if (index{X}<(SHADOWCSMNUM_CASCADES{X}-1) && diffRatio<1.)
{
index{X}+=1;
float nextShadow=0.;
#if defined(SHADOWPCF{X})
#if defined(SHADOWLOWQUALITY{X})
nextShadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#elif defined(SHADOWMEDIUMQUALITY{X})
nextShadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#else
nextShadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWPCSS{X})
#if defined(SHADOWLOWQUALITY{X})
nextShadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#elif defined(SHADOWMEDIUMQUALITY{X})
nextShadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#else
nextShadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});
#endif
#else
nextShadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
shadow=mix(nextShadow,shadow,diffRatio);
#ifdef SHADOWCSMDEBUG{X}
shadowDebug{X}=mix(vec3(nextShadow)*vCascadeColorsMultiplier{X}[index{X}],shadowDebug{X},diffRatio);
#endif
}
#endif
}
#elif defined(SHADOWCLOSEESM{X})
#if defined(SHADOWCUBE{X})
shadow=computeShadowWithCloseESMCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);
#else
shadow=computeShadowWithCloseESM(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWESM{X})
#if defined(SHADOWCUBE{X})
shadow=computeShadowWithESMCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);
#else
shadow=computeShadowWithESM(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWPOISSON{X})
#if defined(SHADOWCUBE{X})
shadow=computeShadowWithPoissonSamplingCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.depthValues);
#else
shadow=computeShadowWithPoissonSampling(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWPCF{X})
#if defined(SHADOWLOWQUALITY{X})
shadow=computeShadowWithPCF1(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#elif defined(SHADOWMEDIUMQUALITY{X})
shadow=computeShadowWithPCF3(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#else
shadow=computeShadowWithPCF5(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#elif defined(SHADOWPCSS{X})
#if defined(SHADOWLOWQUALITY{X})
shadow=computeShadowWithPCSS16(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#elif defined(SHADOWMEDIUMQUALITY{X})
shadow=computeShadowWithPCSS32(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#else
shadow=computeShadowWithPCSS64(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#else
#if defined(SHADOWCUBE{X})
shadow=computeShadowCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.depthValues);
#else
shadow=computeShadow(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);
#endif
#endif
#ifdef SHADOWONLY
#ifndef SHADOWINUSE
#define SHADOWINUSE
#endif
globalShadow+=shadow;
shadowLightCount+=1.0;
#endif
#else
shadow=1.;
#endif
#ifndef SHADOWONLY
#ifdef CUSTOMUSERLIGHTING
diffuseBase+=computeCustomDiffuseLighting(info,diffuseBase,shadow);
#ifdef SPECULARTERM
specularBase+=computeCustomSpecularLighting(info,specularBase,shadow);
#endif
#elif defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X})
diffuseBase+=lightmapColor.rgb*shadow;
#ifdef SPECULARTERM
#ifndef LIGHTMAPNOSPECULAR{X}
specularBase+=info.specular*shadow*lightmapColor.rgb;
#endif
#endif
#ifdef CLEARCOAT
#ifndef LIGHTMAPNOSPECULAR{X}
clearCoatBase+=info.clearCoat.rgb*shadow*lightmapColor.rgb;
#endif
#endif
#ifdef SHEEN
#ifndef LIGHTMAPNOSPECULAR{X}
sheenBase+=info.sheen.rgb*shadow;
#endif
#endif
#else
#ifdef SHADOWCSMDEBUG{X}
diffuseBase+=info.diffuse*shadowDebug{X};
#else 
diffuseBase+=info.diffuse*shadow;
#endif
#ifdef SPECULARTERM
specularBase+=info.specular*shadow;
#endif
#ifdef CLEARCOAT
clearCoatBase+=info.clearCoat.rgb*shadow;
#endif
#ifdef SHEEN
sheenBase+=info.sheen.rgb*shadow;
#endif
#endif
#endif
#endif
`;H.IncludesShadersStore[MZ]=gZ;const CZ="logDepthFragment",vZ=`#ifdef LOGARITHMICDEPTH
gl_FragDepthEXT=log2(vFragmentDepth)*logarithmicDepthConstant*0.5;
#endif
`;H.IncludesShadersStore[CZ]=vZ;const kZ="fogFragment",HZ=`#ifdef FOG
float fog=CalcFogFactor();
#ifdef PBR
fog=toLinearSpace(fog);
#endif
color.rgb=mix(vFogColor,color.rgb,fog);
#endif
`;H.IncludesShadersStore[kZ]=HZ;const IZ="oitFragment",EZ=`#ifdef ORDER_INDEPENDENT_TRANSPARENCY
float fragDepth=gl_FragCoord.z; 
#ifdef ORDER_INDEPENDENT_TRANSPARENCY_16BITS
uint halfFloat=packHalf2x16(vec2(fragDepth));
vec2 full=unpackHalf2x16(halfFloat);
fragDepth=full.x;
#endif
ivec2 fragCoord=ivec2(gl_FragCoord.xy);
vec2 lastDepth=texelFetch(oitDepthSampler,fragCoord,0).rg;
vec4 lastFrontColor=texelFetch(oitFrontColorSampler,fragCoord,0);
depth.rg=vec2(-MAX_DEPTH);
frontColor=lastFrontColor;
backColor=vec4(0.0);
#ifdef USE_REVERSE_DEPTHBUFFER
float furthestDepth=-lastDepth.x;
float nearestDepth=lastDepth.y;
#else
float nearestDepth=-lastDepth.x;
float furthestDepth=lastDepth.y;
#endif
float alphaMultiplier=1.0-lastFrontColor.a;
#ifdef USE_REVERSE_DEPTHBUFFER
if (fragDepth>nearestDepth || fragDepth<furthestDepth) {
#else
if (fragDepth<nearestDepth || fragDepth>furthestDepth) {
#endif
return;
}
#ifdef USE_REVERSE_DEPTHBUFFER
if (fragDepth<nearestDepth && fragDepth>furthestDepth) {
#else
if (fragDepth>nearestDepth && fragDepth<furthestDepth) {
#endif
depth.rg=vec2(-fragDepth,fragDepth);
return;
}
#endif
`;H.IncludesShadersStore[IZ]=EZ;const KZ="defaultPixelShader",BZ=`#include<__decl__defaultFragment>
#if defined(BUMP) || !defined(NORMAL)
#extension GL_OES_standard_derivatives : enable
#endif
#include<prePassDeclaration>[SCENE_MRT_COUNT]
#include<oitDeclaration>
#define CUSTOM_FRAGMENT_BEGIN
#ifdef LOGARITHMICDEPTH
#extension GL_EXT_frag_depth : enable
#endif
#define RECIPROCAL_PI2 0.15915494
varying vec3 vPositionW;
#ifdef NORMAL
varying vec3 vNormalW;
#endif
#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
varying vec4 vColor;
#endif
#include<mainUVVaryingDeclaration>[1..7]
#include<helperFunctions>
#include<__decl__lightFragment>[0..maxSimultaneousLights]
#include<lightsFragmentFunctions>
#include<shadowsFragmentFunctions>
#include<samplerFragmentDeclaration>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse,_SAMPLERNAME_,diffuse)
#include<samplerFragmentDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_SAMPLERNAME_,ambient)
#include<samplerFragmentDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_SAMPLERNAME_,opacity)
#include<samplerFragmentDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_SAMPLERNAME_,emissive)
#include<samplerFragmentDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_SAMPLERNAME_,lightmap)
#ifdef REFRACTION
#ifdef REFRACTIONMAP_3D
uniform samplerCube refractionCubeSampler;
#else
uniform sampler2D refraction2DSampler;
#endif
#endif
#if defined(SPECULARTERM)
#include<samplerFragmentDeclaration>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular,_SAMPLERNAME_,specular)
#endif
#include<fresnelFunction>
#ifdef REFLECTION
#ifdef REFLECTIONMAP_3D
uniform samplerCube reflectionCubeSampler;
#else
uniform sampler2D reflection2DSampler;
#endif
#ifdef REFLECTIONMAP_SKYBOX
varying vec3 vPositionUVW;
#else
#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)
varying vec3 vDirectionW;
#endif
#endif
#include<reflectionFunction>
#endif
#include<imageProcessingDeclaration>
#include<imageProcessingFunctions>
#include<bumpFragmentMainFunctions>
#include<bumpFragmentFunctions>
#include<clipPlaneFragmentDeclaration>
#include<logDepthDeclaration>
#include<fogFragmentDeclaration>
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void) {
#define CUSTOM_FRAGMENT_MAIN_BEGIN
#include<clipPlaneFragment>
vec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);
vec4 baseColor=vec4(1.,1.,1.,1.);
vec3 diffuseColor=vDiffuseColor.rgb;
float alpha=vDiffuseColor.a;
#ifdef NORMAL
vec3 normalW=normalize(vNormalW);
#else
vec3 normalW=normalize(-cross(dFdx(vPositionW),dFdy(vPositionW)));
#endif
#include<bumpFragment>
#ifdef TWOSIDEDLIGHTING
normalW=gl_FrontFacing ? normalW : -normalW;
#endif
#ifdef DIFFUSE
baseColor=texture2D(diffuseSampler,vDiffuseUV+uvOffset);
#if defined(ALPHATEST) && !defined(ALPHATEST_AFTERALLALPHACOMPUTATIONS)
if (baseColor.a<alphaCutOff)
discard;
#endif
#ifdef ALPHAFROMDIFFUSE
alpha*=baseColor.a;
#endif
#define CUSTOM_FRAGMENT_UPDATE_ALPHA
baseColor.rgb*=vDiffuseInfos.y;
#endif
#include<depthPrePass>
#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
baseColor.rgb*=vColor.rgb;
#endif
#ifdef DETAIL
baseColor.rgb=baseColor.rgb*2.0*mix(0.5,detailColor.r,vDetailInfos.y);
#endif
#define CUSTOM_FRAGMENT_UPDATE_DIFFUSE
vec3 baseAmbientColor=vec3(1.,1.,1.);
#ifdef AMBIENT
baseAmbientColor=texture2D(ambientSampler,vAmbientUV+uvOffset).rgb*vAmbientInfos.y;
#endif
#define CUSTOM_FRAGMENT_BEFORE_LIGHTS
#ifdef SPECULARTERM
float glossiness=vSpecularColor.a;
vec3 specularColor=vSpecularColor.rgb;
#ifdef SPECULAR
vec4 specularMapColor=texture2D(specularSampler,vSpecularUV+uvOffset);
specularColor=specularMapColor.rgb;
#ifdef GLOSSINESS
glossiness=glossiness*specularMapColor.a;
#endif
#endif
#else
float glossiness=0.;
#endif
vec3 diffuseBase=vec3(0.,0.,0.);
lightingInfo info;
#ifdef SPECULARTERM
vec3 specularBase=vec3(0.,0.,0.);
#endif
float shadow=1.;
#ifdef LIGHTMAP
vec4 lightmapColor=texture2D(lightmapSampler,vLightmapUV+uvOffset);
#ifdef RGBDLIGHTMAP
lightmapColor.rgb=fromRGBD(lightmapColor);
#endif
lightmapColor.rgb*=vLightmapInfos.y;
#endif
#include<lightFragment>[0..maxSimultaneousLights]
vec4 refractionColor=vec4(0.,0.,0.,1.);
#ifdef REFRACTION
vec3 refractionVector=normalize(refract(-viewDirectionW,normalW,vRefractionInfos.y));
#ifdef REFRACTIONMAP_3D
#ifdef USE_LOCAL_REFRACTIONMAP_CUBIC
refractionVector=parallaxCorrectNormal(vPositionW,refractionVector,vRefractionSize,vRefractionPosition);
#endif
refractionVector.y=refractionVector.y*vRefractionInfos.w;
if (dot(refractionVector,viewDirectionW)<1.0) {
refractionColor=textureCube(refractionCubeSampler,refractionVector);
}
#else
vec3 vRefractionUVW=vec3(refractionMatrix*(view*vec4(vPositionW+refractionVector*vRefractionInfos.z,1.0)));
vec2 refractionCoords=vRefractionUVW.xy/vRefractionUVW.z;
refractionCoords.y=1.0-refractionCoords.y;
refractionColor=texture2D(refraction2DSampler,refractionCoords);
#endif
#ifdef RGBDREFRACTION
refractionColor.rgb=fromRGBD(refractionColor);
#endif
#ifdef IS_REFRACTION_LINEAR
refractionColor.rgb=toGammaSpace(refractionColor.rgb);
#endif
refractionColor.rgb*=vRefractionInfos.x;
#endif
vec4 reflectionColor=vec4(0.,0.,0.,1.);
#ifdef REFLECTION
vec3 vReflectionUVW=computeReflectionCoords(vec4(vPositionW,1.0),normalW);
#ifdef REFLECTIONMAP_OPPOSITEZ
vReflectionUVW.z*=-1.0;
#endif
#ifdef REFLECTIONMAP_3D
#ifdef ROUGHNESS
float bias=vReflectionInfos.y;
#ifdef SPECULARTERM
#ifdef SPECULAR
#ifdef GLOSSINESS
bias*=(1.0-specularMapColor.a);
#endif
#endif
#endif
reflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW,bias);
#else
reflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW);
#endif
#else
vec2 coords=vReflectionUVW.xy;
#ifdef REFLECTIONMAP_PROJECTION
coords/=vReflectionUVW.z;
#endif
coords.y=1.0-coords.y;
reflectionColor=texture2D(reflection2DSampler,coords);
#endif
#ifdef RGBDREFLECTION
reflectionColor.rgb=fromRGBD(reflectionColor);
#endif
#ifdef IS_REFLECTION_LINEAR
reflectionColor.rgb=toGammaSpace(reflectionColor.rgb);
#endif
reflectionColor.rgb*=vReflectionInfos.x;
#ifdef REFLECTIONFRESNEL
float reflectionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,reflectionRightColor.a,reflectionLeftColor.a);
#ifdef REFLECTIONFRESNELFROMSPECULAR
#ifdef SPECULARTERM
reflectionColor.rgb*=specularColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;
#else
reflectionColor.rgb*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;
#endif
#else
reflectionColor.rgb*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;
#endif
#endif
#endif
#ifdef REFRACTIONFRESNEL
float refractionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,refractionRightColor.a,refractionLeftColor.a);
refractionColor.rgb*=refractionLeftColor.rgb*(1.0-refractionFresnelTerm)+refractionFresnelTerm*refractionRightColor.rgb;
#endif
#ifdef OPACITY
vec4 opacityMap=texture2D(opacitySampler,vOpacityUV+uvOffset);
#ifdef OPACITYRGB
opacityMap.rgb=opacityMap.rgb*vec3(0.3,0.59,0.11);
alpha*=(opacityMap.x+opacityMap.y+opacityMap.z)* vOpacityInfos.y;
#else
alpha*=opacityMap.a*vOpacityInfos.y;
#endif
#endif
#if defined(VERTEXALPHA) || defined(INSTANCESCOLOR) && defined(INSTANCES)
alpha*=vColor.a;
#endif
#ifdef OPACITYFRESNEL
float opacityFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,opacityParts.z,opacityParts.w);
alpha+=opacityParts.x*(1.0-opacityFresnelTerm)+opacityFresnelTerm*opacityParts.y;
#endif
#ifdef ALPHATEST
#ifdef ALPHATEST_AFTERALLALPHACOMPUTATIONS
if (alpha<alphaCutOff)
discard;
#endif
#ifndef ALPHABLEND
alpha=1.0;
#endif
#endif
vec3 emissiveColor=vEmissiveColor;
#ifdef EMISSIVE
emissiveColor+=texture2D(emissiveSampler,vEmissiveUV+uvOffset).rgb*vEmissiveInfos.y;
#endif
#ifdef EMISSIVEFRESNEL
float emissiveFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,emissiveRightColor.a,emissiveLeftColor.a);
emissiveColor*=emissiveLeftColor.rgb*(1.0-emissiveFresnelTerm)+emissiveFresnelTerm*emissiveRightColor.rgb;
#endif
#ifdef DIFFUSEFRESNEL
float diffuseFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,diffuseRightColor.a,diffuseLeftColor.a);
diffuseBase*=diffuseLeftColor.rgb*(1.0-diffuseFresnelTerm)+diffuseFresnelTerm*diffuseRightColor.rgb;
#endif
#ifdef EMISSIVEASILLUMINATION
vec3 finalDiffuse=clamp(diffuseBase*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;
#else
#ifdef LINKEMISSIVEWITHDIFFUSE
vec3 finalDiffuse=clamp((diffuseBase+emissiveColor)*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;
#else
vec3 finalDiffuse=clamp(diffuseBase*diffuseColor+emissiveColor+vAmbientColor,0.0,1.0)*baseColor.rgb;
#endif
#endif
#ifdef SPECULARTERM
vec3 finalSpecular=specularBase*specularColor;
#ifdef SPECULAROVERALPHA
alpha=clamp(alpha+dot(finalSpecular,vec3(0.3,0.59,0.11)),0.,1.);
#endif
#else
vec3 finalSpecular=vec3(0.0);
#endif
#ifdef REFLECTIONOVERALPHA
alpha=clamp(alpha+dot(reflectionColor.rgb,vec3(0.3,0.59,0.11)),0.,1.);
#endif
#ifdef EMISSIVEASILLUMINATION
vec4 color=vec4(clamp(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor.rgb+emissiveColor+refractionColor.rgb,0.0,1.0),alpha);
#else
vec4 color=vec4(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor.rgb+refractionColor.rgb,alpha);
#endif
#ifdef LIGHTMAP
#ifndef LIGHTMAPEXCLUDED
#ifdef USELIGHTMAPASSHADOWMAP
color.rgb*=lightmapColor.rgb;
#else
color.rgb+=lightmapColor.rgb;
#endif
#endif
#endif
#define CUSTOM_FRAGMENT_BEFORE_FOG
color.rgb=max(color.rgb,0.);
#include<logDepthFragment>
#include<fogFragment>
#ifdef IMAGEPROCESSINGPOSTPROCESS
color.rgb=toLinearSpace(color.rgb);
#else
#ifdef IMAGEPROCESSING
color.rgb=toLinearSpace(color.rgb);
color=applyImageProcessing(color);
#endif
#endif
color.a*=visibility;
#ifdef PREMULTIPLYALPHA
color.rgb*=color.a;
#endif
#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR
#ifdef PREPASS
float writeGeometryInfo=color.a>0.4 ? 1.0 : 0.0;
gl_FragData[0]=color; 
#ifdef PREPASS_POSITION
gl_FragData[PREPASS_POSITION_INDEX]=vec4(vPositionW,writeGeometryInfo);
#endif
#ifdef PREPASS_VELOCITY
vec2 a=(vCurrentPosition.xy/vCurrentPosition.w)*0.5+0.5;
vec2 b=(vPreviousPosition.xy/vPreviousPosition.w)*0.5+0.5;
vec2 velocity=abs(a-b);
velocity=vec2(pow(velocity.x,1.0/3.0),pow(velocity.y,1.0/3.0))*sign(a-b)*0.5+0.5;
gl_FragData[PREPASS_VELOCITY_INDEX]=vec4(velocity,0.0,writeGeometryInfo);
#endif
#ifdef PREPASS_IRRADIANCE
gl_FragData[PREPASS_IRRADIANCE_INDEX]=vec4(0.0,0.0,0.0,writeGeometryInfo); 
#endif
#ifdef PREPASS_DEPTH
gl_FragData[PREPASS_DEPTH_INDEX]=vec4(vViewPos.z,0.0,0.0,writeGeometryInfo); 
#endif
#ifdef PREPASS_NORMAL
gl_FragData[PREPASS_NORMAL_INDEX]=vec4((view*vec4(normalW,0.0)).rgb,writeGeometryInfo); 
#endif
#ifdef PREPASS_ALBEDO_SQRT
gl_FragData[PREPASS_ALBEDO_SQRT_INDEX]=vec4(0.0,0.0,0.0,writeGeometryInfo); 
#endif
#ifdef PREPASS_REFLECTIVITY
#if defined(SPECULARTERM)
#if defined(SPECULAR)
gl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(specularMapColor)*writeGeometryInfo; 
#else
gl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(specularColor,1.0)*writeGeometryInfo;
#endif
#else
gl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(0.0,0.0,0.0,1.0)*writeGeometryInfo;
#endif
#endif
#endif
#if !defined(PREPASS) || defined(WEBGL2)
gl_FragColor=color;
#endif
#include<oitFragment>
#if ORDER_INDEPENDENT_TRANSPARENCY
if (fragDepth==nearestDepth) {
frontColor.rgb+=color.rgb*color.a*alphaMultiplier;
frontColor.a=1.0-alphaMultiplier*(1.0-color.a);
} else {
backColor+=color;
}
#endif
#define CUSTOM_FRAGMENT_MAIN_END
}
`;H.ShadersStore[KZ]=BZ;const QZ="defaultVertexDeclaration",PZ=`uniform mat4 viewProjection;
uniform mat4 view;
#ifdef DIFFUSE
uniform mat4 diffuseMatrix;
uniform vec2 vDiffuseInfos;
#endif
#ifdef AMBIENT
uniform mat4 ambientMatrix;
uniform vec2 vAmbientInfos;
#endif
#ifdef OPACITY
uniform mat4 opacityMatrix;
uniform vec2 vOpacityInfos;
#endif
#ifdef EMISSIVE
uniform vec2 vEmissiveInfos;
uniform mat4 emissiveMatrix;
#endif
#ifdef LIGHTMAP
uniform vec2 vLightmapInfos;
uniform mat4 lightmapMatrix;
#endif
#if defined(SPECULAR) && defined(SPECULARTERM)
uniform vec2 vSpecularInfos;
uniform mat4 specularMatrix;
#endif
#ifdef BUMP
uniform vec3 vBumpInfos;
uniform mat4 bumpMatrix;
#endif
#ifdef REFLECTION
uniform mat4 reflectionMatrix;
#endif
#ifdef POINTSIZE
uniform float pointSize;
#endif
#ifdef DETAIL
uniform vec4 vDetailInfos;
uniform mat4 detailMatrix;
#endif
#define ADDITIONAL_VERTEX_DECLARATION
`;H.IncludesShadersStore[QZ]=PZ;const wZ="uvAttributeDeclaration",_Z=`#ifdef UV{X}
attribute vec2 uv{X};
#endif
`;H.IncludesShadersStore[wZ]=_Z;const DZ="prePassVertexDeclaration",jZ=`#ifdef PREPASS
#ifdef PREPASS_DEPTH
varying vec3 vViewPos;
#endif
#ifdef PREPASS_VELOCITY
uniform mat4 previousViewProjection;
varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
#endif
#endif
`;H.IncludesShadersStore[DZ]=jZ;const AZ="samplerVertexDeclaration",OZ=`#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0
varying vec2 v_VARYINGNAME_UV;
#endif
`;H.IncludesShadersStore[AZ]=OZ;const qZ="bumpVertexDeclaration",$Z=`#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)
#if defined(TANGENT) && defined(NORMAL) 
varying mat3 vTBN;
#endif
#endif
`;H.IncludesShadersStore[qZ]=$Z;const lh="fogVertexDeclaration",eh=`#ifdef FOG
varying vec3 vFogDistance;
#endif
`;H.IncludesShadersStore[lh]=eh;const th="lightVxFragmentDeclaration",ah=`#ifdef LIGHT{X}
uniform vec4 vLightData{X};
uniform vec4 vLightDiffuse{X};
#ifdef SPECULARTERM
uniform vec4 vLightSpecular{X};
#else
vec4 vLightSpecular{X}=vec4(0.);
#endif
#ifdef SHADOW{X}
#ifdef SHADOWCSM{X}
uniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];
varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];
varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];
varying vec4 vPositionFromCamera{X};
#elif defined(SHADOWCUBE{X})
#else
varying vec4 vPositionFromLight{X};
varying float vDepthMetric{X};
uniform mat4 lightMatrix{X};
#endif
uniform vec4 shadowsInfo{X};
uniform vec2 depthValues{X};
#endif
#ifdef SPOTLIGHT{X}
uniform vec4 vLightDirection{X};
uniform vec4 vLightFalloff{X};
#elif defined(POINTLIGHT{X})
uniform vec4 vLightFalloff{X};
#elif defined(HEMILIGHT{X})
uniform vec3 vLightGround{X};
#endif
#endif
`;H.IncludesShadersStore[th]=ah;const sh="lightVxUboDeclaration",dh=`#ifdef LIGHT{X}
uniform Light{X}
{
vec4 vLightData;
vec4 vLightDiffuse;
vec4 vLightSpecular;
#ifdef SPOTLIGHT{X}
vec4 vLightDirection;
vec4 vLightFalloff;
#elif defined(POINTLIGHT{X})
vec4 vLightFalloff;
#elif defined(HEMILIGHT{X})
vec3 vLightGround;
#endif
vec4 shadowsInfo;
vec2 depthValues;
} light{X};
#ifdef SHADOW{X}
#ifdef SHADOWCSM{X}
uniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];
varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];
varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];
varying vec4 vPositionFromCamera{X};
#elif defined(SHADOWCUBE{X})
#else
varying vec4 vPositionFromLight{X};
varying float vDepthMetric{X};
uniform mat4 lightMatrix{X};
#endif
#endif
#endif
`;H.IncludesShadersStore[sh]=dh;const ih="prePassVertex",ch=`#ifdef PREPASS_DEPTH
vViewPos=(view*worldPos).rgb;
#endif
#if defined(PREPASS_VELOCITY) && defined(BONES_VELOCITY_ENABLED)
vCurrentPosition=viewProjection*worldPos;
#if NUM_BONE_INFLUENCERS>0
mat4 previousInfluence;
previousInfluence=mPreviousBones[int(matricesIndices[0])]*matricesWeights[0];
#if NUM_BONE_INFLUENCERS>1
previousInfluence+=mPreviousBones[int(matricesIndices[1])]*matricesWeights[1];
#endif 
#if NUM_BONE_INFLUENCERS>2
previousInfluence+=mPreviousBones[int(matricesIndices[2])]*matricesWeights[2];
#endif 
#if NUM_BONE_INFLUENCERS>3
previousInfluence+=mPreviousBones[int(matricesIndices[3])]*matricesWeights[3];
#endif
#if NUM_BONE_INFLUENCERS>4
previousInfluence+=mPreviousBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];
#endif 
#if NUM_BONE_INFLUENCERS>5
previousInfluence+=mPreviousBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];
#endif 
#if NUM_BONE_INFLUENCERS>6
previousInfluence+=mPreviousBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];
#endif 
#if NUM_BONE_INFLUENCERS>7
previousInfluence+=mPreviousBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];
#endif
vPreviousPosition=previousViewProjection*finalPreviousWorld*previousInfluence*vec4(positionUpdated,1.0);
#else
vPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);
#endif
#endif
`;H.IncludesShadersStore[ih]=ch;const nh="uvVariableDeclaration",Zh=`#if !defined(UV{X}) && defined(MAINUV{X})
vec2 uv{X}=vec2(0.,0.);
#endif
#ifdef MAINUV{X}
vMainUV{X}=uv{X};
#endif
`;H.IncludesShadersStore[nh]=Zh;const hh="samplerVertexImplementation",mh=`#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0
if (v_INFONAME_==0.)
{
v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uvUpdated,1.0,0.0));
}
#ifdef UV2
else if (v_INFONAME_==1.)
{
v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv2,1.0,0.0));
}
#endif
#ifdef UV3
else if (v_INFONAME_==2.)
{
v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv3,1.0,0.0));
}
#endif
#ifdef UV4
else if (v_INFONAME_==3.)
{
v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv4,1.0,0.0));
}
#endif
#ifdef UV5
else if (v_INFONAME_==4.)
{
v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv5,1.0,0.0));
}
#endif
#ifdef UV6
else if (v_INFONAME_==5.)
{
v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv6,1.0,0.0));
}
#endif
#endif
`;H.IncludesShadersStore[hh]=mh;const oh="bumpVertex",bh=`#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)
#if defined(TANGENT) && defined(NORMAL)
vec3 tbnNormal=normalize(normalUpdated);
vec3 tbnTangent=normalize(tangentUpdated.xyz);
vec3 tbnBitangent=cross(tbnNormal,tbnTangent)*tangentUpdated.w;
vTBN=mat3(finalWorld)*mat3(tbnTangent,tbnBitangent,tbnNormal);
#endif
#endif
`;H.IncludesShadersStore[oh]=bh;const Xh="fogVertex",uh=`#ifdef FOG
vFogDistance=(view*worldPos).xyz;
#endif
`;H.IncludesShadersStore[Xh]=uh;const rh="shadowsVertex",Gh=`#ifdef SHADOWS
#if defined(SHADOWCSM{X})
vPositionFromCamera{X}=view*worldPos;
for (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) {
vPositionFromLight{X}[i]=lightMatrix{X}[i]*worldPos;
#ifdef USE_REVERSE_DEPTHBUFFER
vDepthMetric{X}[i]=(-vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;
#else
vDepthMetric{X}[i]=(vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;
#endif
}
#elif defined(SHADOW{X}) && !defined(SHADOWCUBE{X})
vPositionFromLight{X}=lightMatrix{X}*worldPos;
#ifdef USE_REVERSE_DEPTHBUFFER
vDepthMetric{X}=(-vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;
#else
vDepthMetric{X}=(vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;
#endif
#endif
#endif
`;H.IncludesShadersStore[rh]=Gh;const Vh="vertexColorMixing",Rh=`#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
vColor=vec4(1.0);
#ifdef VERTEXCOLOR
#ifdef VERTEXALPHA
vColor*=color;
#else
vColor.rgb*=color.rgb;
#endif
#endif
#ifdef INSTANCESCOLOR
vColor*=instanceColor;
#endif
#endif
`;H.IncludesShadersStore[Vh]=Rh;const Wh="pointCloudVertex",ph=`#if defined(POINTSIZE) && !defined(WEBGPU)
gl_PointSize=pointSize;
#endif
`;H.IncludesShadersStore[Wh]=ph;const yh="logDepthVertex",Yh=`#ifdef LOGARITHMICDEPTH
vFragmentDepth=1.0+gl_Position.w;
gl_Position.z=log2(max(0.000001,vFragmentDepth))*logarithmicDepthConstant;
#endif
`;H.IncludesShadersStore[yh]=Yh;const Nh="defaultVertexShader",Fh=`#include<__decl__defaultVertex>
#define CUSTOM_VERTEX_BEGIN
attribute vec3 position;
#ifdef NORMAL
attribute vec3 normal;
#endif
#ifdef TANGENT
attribute vec4 tangent;
#endif
#ifdef UV1
attribute vec2 uv;
#endif
#include<uvAttributeDeclaration>[2..7]
#ifdef VERTEXCOLOR
attribute vec4 color;
#endif
#include<helperFunctions>
#include<bonesDeclaration>
#include<bakedVertexAnimationDeclaration>
#include<instancesDeclaration>
#include<prePassVertexDeclaration>
#include<mainUVVaryingDeclaration>[1..7]
#include<samplerVertexDeclaration>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse)
#include<samplerVertexDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail)
#include<samplerVertexDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient)
#include<samplerVertexDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity)
#include<samplerVertexDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive)
#include<samplerVertexDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap)
#if defined(SPECULARTERM)
#include<samplerVertexDeclaration>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular)
#endif
#include<samplerVertexDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump)
varying vec3 vPositionW;
#ifdef NORMAL
varying vec3 vNormalW;
#endif
#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)
varying vec4 vColor;
#endif
#include<bumpVertexDeclaration>
#include<clipPlaneVertexDeclaration>
#include<fogVertexDeclaration>
#include<__decl__lightVxFragment>[0..maxSimultaneousLights]
#include<morphTargetsVertexGlobalDeclaration>
#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]
#ifdef REFLECTIONMAP_SKYBOX
varying vec3 vPositionUVW;
#endif
#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)
varying vec3 vDirectionW;
#endif
#include<logDepthDeclaration>
#define CUSTOM_VERTEX_DEFINITIONS
void main(void) {
#define CUSTOM_VERTEX_MAIN_BEGIN
vec3 positionUpdated=position;
#ifdef NORMAL
vec3 normalUpdated=normal;
#endif
#ifdef TANGENT
vec4 tangentUpdated=tangent;
#endif
#ifdef UV1
vec2 uvUpdated=uv;
#endif
#include<morphTargetsVertexGlobal>
#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]
#ifdef REFLECTIONMAP_SKYBOX
vPositionUVW=positionUpdated;
#endif
#define CUSTOM_VERTEX_UPDATE_POSITION
#define CUSTOM_VERTEX_UPDATE_NORMAL
#include<instancesVertex>
#if defined(PREPASS) && defined(PREPASS_VELOCITY) && !defined(BONES_VELOCITY_ENABLED)
vCurrentPosition=viewProjection*finalWorld*vec4(positionUpdated,1.0);
vPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);
#endif
#include<bonesVertex>
#include<bakedVertexAnimation>
vec4 worldPos=finalWorld*vec4(positionUpdated,1.0);
#ifdef NORMAL
mat3 normalWorld=mat3(finalWorld);
#if defined(INSTANCES) && defined(THIN_INSTANCES)
vNormalW=normalUpdated/vec3(dot(normalWorld[0],normalWorld[0]),dot(normalWorld[1],normalWorld[1]),dot(normalWorld[2],normalWorld[2]));
vNormalW=normalize(normalWorld*vNormalW);
#else
#ifdef NONUNIFORMSCALING
normalWorld=transposeMat3(inverseMat3(normalWorld));
#endif
vNormalW=normalize(normalWorld*normalUpdated);
#endif
#endif
#define CUSTOM_VERTEX_UPDATE_WORLDPOS
#ifdef MULTIVIEW
if (gl_ViewID_OVR==0u) {
gl_Position=viewProjection*worldPos;
} else {
gl_Position=viewProjectionR*worldPos;
}
#else
gl_Position=viewProjection*worldPos;
#endif
vPositionW=vec3(worldPos);
#include<prePassVertex>
#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)
vDirectionW=normalize(vec3(finalWorld*vec4(positionUpdated,0.0)));
#endif
#ifndef UV1
vec2 uvUpdated=vec2(0.,0.);
#endif
#ifdef MAINUV1
vMainUV1=uvUpdated;
#endif
#include<uvVariableDeclaration>[2..7]
#include<samplerVertexImplementation>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse,_MATRIXNAME_,diffuse,_INFONAME_,DiffuseInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_MATRIXNAME_,detail,_INFONAME_,DetailInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_MATRIXNAME_,ambient,_INFONAME_,AmbientInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_MATRIXNAME_,opacity,_INFONAME_,OpacityInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_MATRIXNAME_,emissive,_INFONAME_,EmissiveInfos.x)
#include<samplerVertexImplementation>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_MATRIXNAME_,lightmap,_INFONAME_,LightmapInfos.x)
#if defined(SPECULARTERM)
#include<samplerVertexImplementation>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular,_MATRIXNAME_,specular,_INFONAME_,SpecularInfos.x)
#endif
#include<samplerVertexImplementation>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_MATRIXNAME_,bump,_INFONAME_,BumpInfos.x)
#include<bumpVertex>
#include<clipPlaneVertex>
#include<fogVertex>
#include<shadowsVertex>[0..maxSimultaneousLights]
#include<vertexColorMixing>
#include<pointCloudVertex>
#include<logDepthVertex>
#define CUSTOM_VERTEX_MAIN_END
}
`;H.ShadersStore[Nh]=Fh;const Sh=new RegExp("^([gimus]+)!");class lt{constructor(l){this._plugins=[],this._activePlugins=[],this._activePluginsForExtraEvents=[],this._material=l,this._scene=l.getScene(),this._engine=this._scene.getEngine()}_addPlugin(l){for(let a=0;a<this._plugins.length;++a)if(this._plugins[a].name===l.name)throw`Plugin "${l.name}" already added to the material "${this._material.name}"!`;if(this._material._uniformBufferLayoutBuilt)throw`The plugin "${l.name}" can't be added to the material "${this._material.name}" because this material has already been used for rendering! Please add plugins to materials before any rendering with this material occurs.`;const e=l.getClassName();lt._MaterialPluginClassToMainDefine[e]||(lt._MaterialPluginClassToMainDefine[e]="MATERIALPLUGIN_"+ ++lt._MaterialPluginCounter),this._material._callbackPluginEventGeneric=this._handlePluginEvent.bind(this),this._plugins.push(l),this._plugins.sort((a,s)=>a.priority-s.priority),this._codeInjectionPoints={};const t={};t[lt._MaterialPluginClassToMainDefine[e]]={type:"boolean",default:!0};for(const a of this._plugins)a.collectDefines(t),this._collectPointNames("vertex",a.getCustomCode("vertex")),this._collectPointNames("fragment",a.getCustomCode("fragment"));this._defineNamesFromPlugins=t}_activatePlugin(l){this._activePlugins.indexOf(l)===-1&&(this._activePlugins.push(l),this._activePlugins.sort((e,t)=>e.priority-t.priority),this._material._callbackPluginEventIsReadyForSubMesh=this._handlePluginEventIsReadyForSubMesh.bind(this),this._material._callbackPluginEventPrepareDefinesBeforeAttributes=this._handlePluginEventPrepareDefinesBeforeAttributes.bind(this),this._material._callbackPluginEventPrepareDefines=this._handlePluginEventPrepareDefines.bind(this),this._material._callbackPluginEventBindForSubMesh=this._handlePluginEventBindForSubMesh.bind(this),l.registerForExtraEvents&&(this._activePluginsForExtraEvents.push(l),this._activePluginsForExtraEvents.sort((e,t)=>e.priority-t.priority),this._material._callbackPluginEventHasRenderTargetTextures=this._handlePluginEventHasRenderTargetTextures.bind(this),this._material._callbackPluginEventFillRenderTargetTextures=this._handlePluginEventFillRenderTargetTextures.bind(this),this._material._callbackPluginEventHardBindForSubMesh=this._handlePluginEventHardBindForSubMesh.bind(this)))}getPlugin(l){for(let e=0;e<this._plugins.length;++e)if(this._plugins[e].name===l)return this._plugins[e];return null}_handlePluginEventIsReadyForSubMesh(l){let e=!0;for(const t of this._activePlugins)e=e&&t.isReadyForSubMesh(l.defines,this._scene,this._engine,l.subMesh);l.isReadyForSubMesh=e}_handlePluginEventPrepareDefinesBeforeAttributes(l){for(const e of this._activePlugins)e.prepareDefinesBeforeAttributes(l.defines,this._scene,l.mesh)}_handlePluginEventPrepareDefines(l){for(const e of this._activePlugins)e.prepareDefines(l.defines,this._scene,l.mesh)}_handlePluginEventHardBindForSubMesh(l){for(const e of this._activePluginsForExtraEvents)e.hardBindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,l.subMesh)}_handlePluginEventBindForSubMesh(l){for(const e of this._activePlugins)e.bindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,l.subMesh)}_handlePluginEventHasRenderTargetTextures(l){let e=!1;for(const t of this._activePluginsForExtraEvents)if(e=t.hasRenderTargetTextures(),e)break;l.hasRenderTargetTextures=e}_handlePluginEventFillRenderTargetTextures(l){for(const e of this._activePluginsForExtraEvents)e.fillRenderTargetTextures(l.renderTargets)}_handlePluginEvent(l,e){switch(l){case Ol.GetActiveTextures:{const t=e;for(const a of this._activePlugins)a.getActiveTextures(t.activeTextures);break}case Ol.GetAnimatables:{const t=e;for(const a of this._activePlugins)a.getAnimatables(t.animatables);break}case Ol.HasTexture:{const t=e;let a=!1;for(const s of this._activePlugins)if(a=s.hasTexture(t.texture),a)break;t.hasTexture=a;break}case Ol.Disposed:{const t=e;for(const a of this._plugins)a.dispose(t.forceDisposeTextures);break}case Ol.GetDefineNames:{const t=e;t.defineNames=this._defineNamesFromPlugins;break}case Ol.PrepareEffect:{const t=e;for(const a of this._activePlugins)t.fallbackRank=a.addFallbacks(t.defines,t.fallbacks,t.fallbackRank),a.getAttributes(t.attributes,this._scene,t.mesh);this._uniformList.length>0&&t.uniforms.push(...this._uniformList),this._samplerList.length>0&&t.samplers.push(...this._samplerList),this._uboList.length>0&&t.uniformBuffersNames.push(...this._uboList),t.customCode=this._injectCustomCode(t.customCode);break}case Ol.PrepareUniformBuffer:{const t=e;this._uboDeclaration="",this._vertexDeclaration="",this._fragmentDeclaration="",this._uniformList=[],this._samplerList=[],this._uboList=[];for(const a of this._plugins){const s=a.getUniforms();if(s){if(s.ubo)for(const d of s.ubo)t.ubo.addUniform(d.name,d.size),this._uboDeclaration+=`${d.type} ${d.name};\r
`,this._uniformList.push(d.name);s.vertex&&(this._vertexDeclaration+=s.vertex+`\r
`),s.fragment&&(this._fragmentDeclaration+=s.fragment+`\r
`)}a.getSamplers(this._samplerList),a.getUniformBuffersNames(this._uboList)}break}}}_collectPointNames(l,e){if(e)for(const t in e)this._codeInjectionPoints[l]||(this._codeInjectionPoints[l]={}),this._codeInjectionPoints[l][t]=!0}_injectCustomCode(l){return(e,t)=>{var a;l&&(t=l(e,t)),this._uboDeclaration&&(t=t.replace("#define ADDITIONAL_UBO_DECLARATION",this._uboDeclaration)),this._vertexDeclaration&&(t=t.replace("#define ADDITIONAL_VERTEX_DECLARATION",this._vertexDeclaration)),this._fragmentDeclaration&&(t=t.replace("#define ADDITIONAL_FRAGMENT_DECLARATION",this._fragmentDeclaration));const s=(a=this._codeInjectionPoints)===null||a===void 0?void 0:a[e];if(!s)return t;for(let d in s){let i="";for(const c of this._activePlugins){const n=c.getCustomCode(e);n!=null&&n[d]&&(i+=n[d]+`\r
`)}if(i.length>0)if(d.charAt(0)==="!"){d=d.substring(1);let c="g";if(d.charAt(0)==="!")c="",d=d.substring(1);else{const o=Sh.exec(d);o&&o.length>=2&&(c=o[1],d=d.substring(c.length+1))}c.indexOf("g")<0&&(c+="g");const n=t,h=new RegExp(d,c);let m=h.exec(n);for(;m!==null;){let o=i;for(let b=0;b<m.length;++b)o=o.replace("$"+b,m[b]);t=t.replace(m[0],o),m=h.exec(n)}}else{const c="#define "+d;t=t.replace(c,`\r
`+i+`\r
`+c)}}return t}}}lt._MaterialPluginClassToMainDefine={};lt._MaterialPluginCounter=0;class za{constructor(l,e,t,a,s=!0,d=!1){this.priority=500,this.registerForExtraEvents=!1,this._material=l,this.name=e,this.priority=t,l.pluginManager||(l.pluginManager=new lt(l)),this._pluginDefineNames=a,this._pluginManager=l.pluginManager,s&&this._pluginManager._addPlugin(this),d&&this._enable(!0),this.markAllDefinesAsDirty=l._dirtyCallbacks[63]}_enable(l){l&&this._pluginManager._activatePlugin(this)}getClassName(){return"MaterialPluginBase"}isReadyForSubMesh(l,e,t,a){return!0}hardBindForSubMesh(l,e,t,a){}bindForSubMesh(l,e,t,a){}dispose(l){}getCustomCode(l){return null}collectDefines(l){if(this._pluginDefineNames)for(const e of Object.keys(this._pluginDefineNames)){if(e[0]==="_")continue;const t=typeof this._pluginDefineNames[e];l[e]={type:t==="number"?"number":t==="string"?"string":t==="boolean"?"boolean":"object",default:this._pluginDefineNames[e]}}}prepareDefinesBeforeAttributes(l,e,t){}prepareDefines(l,e,t){}hasTexture(l){return!1}hasRenderTargetTextures(){return!1}fillRenderTargetTextures(l){}getActiveTextures(l){}getAnimatables(l){}addFallbacks(l,e,t){return t}getSamplers(l){}getAttributes(l,e,t){}getUniformBuffersNames(l){}getUniforms(){return{}}copyTo(l){il.Clone(()=>l,this)}serialize(){return il.Serialize(this)}parse(l,e,t){il.Parse(()=>this,l,e,t)}}W([F()],za.prototype,"name",void 0);W([F()],za.prototype,"priority",void 0);W([F()],za.prototype,"registerForExtraEvents",void 0);class Lh extends Ys{constructor(){super(...arguments),this.DETAIL=!1,this.DETAILDIRECTUV=0,this.DETAIL_NORMALBLENDMETHOD=0}}class Wt extends za{constructor(l,e=!0){super(l,"DetailMap",140,new Lh,e),this._texture=null,this.diffuseBlendLevel=1,this.roughnessBlendLevel=1,this.bumpLevel=1,this._normalBlendMethod=U.MATERIAL_NORMALBLENDMETHOD_WHITEOUT,this._isEnabled=!1,this.isEnabled=!1,this._internalMarkAllSubMeshesAsTexturesDirty=l._dirtyCallbacks[1]}_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isReadyForSubMesh(l,e,t){return this._isEnabled?!(l._areTexturesDirty&&e.texturesEnabled&&t.getCaps().standardDerivatives&&this._texture&&hl.DetailTextureEnabled&&!this._texture.isReady()):!0}prepareDefines(l,e){if(this._isEnabled){l.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod;const t=e.getEngine();l._areTexturesDirty&&(t.getCaps().standardDerivatives&&this._texture&&hl.DetailTextureEnabled&&this._isEnabled?(tl.PrepareDefinesForMergedUV(this._texture,l,"DETAIL"),l.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod):l.DETAIL=!1)}else l.DETAIL=!1}bindForSubMesh(l,e){if(!this._isEnabled)return;const t=this._material.isFrozen;(!l.useUbo||!t||!l.isSync)&&this._texture&&hl.DetailTextureEnabled&&(l.updateFloat4("vDetailInfos",this._texture.coordinatesIndex,this.diffuseBlendLevel,this.bumpLevel,this.roughnessBlendLevel),tl.BindTextureMatrix(this._texture,l,"detail")),e.texturesEnabled&&this._texture&&hl.DetailTextureEnabled&&l.setTexture("detailSampler",this._texture)}hasTexture(l){return this._texture===l}getActiveTextures(l){this._texture&&l.push(this._texture)}getAnimatables(l){this._texture&&this._texture.animations&&this._texture.animations.length>0&&l.push(this._texture)}dispose(l){var e;l&&((e=this._texture)===null||e===void 0||e.dispose())}getClassName(){return"DetailMapConfiguration"}getSamplers(l){l.push("detailSampler")}getUniforms(){return{ubo:[{name:"vDetailInfos",size:4,type:"vec4"},{name:"detailMatrix",size:16,type:"mat4"}]}}}W([ye("detailTexture"),pl("_markAllSubMeshesAsTexturesDirty")],Wt.prototype,"texture",void 0);W([F()],Wt.prototype,"diffuseBlendLevel",void 0);W([F()],Wt.prototype,"roughnessBlendLevel",void 0);W([F()],Wt.prototype,"bumpLevel",void 0);W([F(),pl("_markAllSubMeshesAsTexturesDirty")],Wt.prototype,"normalBlendMethod",void 0);W([F(),pl("_markAllSubMeshesAsTexturesDirty")],Wt.prototype,"isEnabled",void 0);const qa={effect:null,subMesh:null};class Jh extends Ys{constructor(l){super(l),this.MAINUV1=!1,this.MAINUV2=!1,this.MAINUV3=!1,this.MAINUV4=!1,this.MAINUV5=!1,this.MAINUV6=!1,this.DIFFUSE=!1,this.DIFFUSEDIRECTUV=0,this.BAKED_VERTEX_ANIMATION_TEXTURE=!1,this.AMBIENT=!1,this.AMBIENTDIRECTUV=0,this.OPACITY=!1,this.OPACITYDIRECTUV=0,this.OPACITYRGB=!1,this.REFLECTION=!1,this.EMISSIVE=!1,this.EMISSIVEDIRECTUV=0,this.SPECULAR=!1,this.SPECULARDIRECTUV=0,this.BUMP=!1,this.BUMPDIRECTUV=0,this.PARALLAX=!1,this.PARALLAXOCCLUSION=!1,this.SPECULAROVERALPHA=!1,this.CLIPPLANE=!1,this.CLIPPLANE2=!1,this.CLIPPLANE3=!1,this.CLIPPLANE4=!1,this.CLIPPLANE5=!1,this.CLIPPLANE6=!1,this.ALPHATEST=!1,this.DEPTHPREPASS=!1,this.ALPHAFROMDIFFUSE=!1,this.POINTSIZE=!1,this.FOG=!1,this.SPECULARTERM=!1,this.DIFFUSEFRESNEL=!1,this.OPACITYFRESNEL=!1,this.REFLECTIONFRESNEL=!1,this.REFRACTIONFRESNEL=!1,this.EMISSIVEFRESNEL=!1,this.FRESNEL=!1,this.NORMAL=!1,this.TANGENT=!1,this.UV1=!1,this.UV2=!1,this.UV3=!1,this.UV4=!1,this.UV5=!1,this.UV6=!1,this.VERTEXCOLOR=!1,this.VERTEXALPHA=!1,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.BONETEXTURE=!1,this.BONES_VELOCITY_ENABLED=!1,this.INSTANCES=!1,this.THIN_INSTANCES=!1,this.INSTANCESCOLOR=!1,this.GLOSSINESS=!1,this.ROUGHNESS=!1,this.EMISSIVEASILLUMINATION=!1,this.LINKEMISSIVEWITHDIFFUSE=!1,this.REFLECTIONFRESNELFROMSPECULAR=!1,this.LIGHTMAP=!1,this.LIGHTMAPDIRECTUV=0,this.OBJECTSPACE_NORMALMAP=!1,this.USELIGHTMAPASSHADOWMAP=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFRACTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_OPPOSITEZ=!1,this.INVERTCUBICMAP=!1,this.LOGARITHMICDEPTH=!1,this.REFRACTION=!1,this.REFRACTIONMAP_3D=!1,this.REFLECTIONOVERALPHA=!1,this.TWOSIDEDLIGHTING=!1,this.SHADOWFLOAT=!1,this.MORPHTARGETS=!1,this.MORPHTARGETS_NORMAL=!1,this.MORPHTARGETS_TANGENT=!1,this.MORPHTARGETS_UV=!1,this.NUM_MORPH_INFLUENCERS=0,this.MORPHTARGETS_TEXTURE=!1,this.NONUNIFORMSCALING=!1,this.PREMULTIPLYALPHA=!1,this.ALPHATEST_AFTERALLALPHACOMPUTATIONS=!1,this.ALPHABLEND=!0,this.PREPASS=!1,this.PREPASS_IRRADIANCE=!1,this.PREPASS_IRRADIANCE_INDEX=-1,this.PREPASS_ALBEDO_SQRT=!1,this.PREPASS_ALBEDO_SQRT_INDEX=-1,this.PREPASS_DEPTH=!1,this.PREPASS_DEPTH_INDEX=-1,this.PREPASS_NORMAL=!1,this.PREPASS_NORMAL_INDEX=-1,this.PREPASS_POSITION=!1,this.PREPASS_POSITION_INDEX=-1,this.PREPASS_VELOCITY=!1,this.PREPASS_VELOCITY_INDEX=-1,this.PREPASS_REFLECTIVITY=!1,this.PREPASS_REFLECTIVITY_INDEX=-1,this.SCENE_MRT_COUNT=0,this.RGBDLIGHTMAP=!1,this.RGBDREFLECTION=!1,this.RGBDREFRACTION=!1,this.IMAGEPROCESSING=!1,this.VIGNETTE=!1,this.VIGNETTEBLENDMODEMULTIPLY=!1,this.VIGNETTEBLENDMODEOPAQUE=!1,this.TONEMAPPING=!1,this.TONEMAPPING_ACES=!1,this.CONTRAST=!1,this.COLORCURVES=!1,this.COLORGRADING=!1,this.COLORGRADING3D=!1,this.SAMPLER3DGREENDEPTH=!1,this.SAMPLER3DBGRMAP=!1,this.DITHER=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.SKIPFINALCOLORCLAMP=!1,this.MULTIVIEW=!1,this.ORDER_INDEPENDENT_TRANSPARENCY=!1,this.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!1,this.CAMERA_ORTHOGRAPHIC=!1,this.CAMERA_PERSPECTIVE=!1,this.IS_REFLECTION_LINEAR=!1,this.IS_REFRACTION_LINEAR=!1,this.EXPOSURE=!1,this.rebuild()}setReflectionMode(l){const e=["REFLECTIONMAP_CUBIC","REFLECTIONMAP_EXPLICIT","REFLECTIONMAP_PLANAR","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_SKYBOX","REFLECTIONMAP_SPHERICAL","REFLECTIONMAP_EQUIRECTANGULAR","REFLECTIONMAP_EQUIRECTANGULAR_FIXED","REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED"];for(const t of e)this[t]=t===l}}class C extends Ud{constructor(l,e){super(l,e),this._diffuseTexture=null,this._ambientTexture=null,this._opacityTexture=null,this._reflectionTexture=null,this._emissiveTexture=null,this._specularTexture=null,this._bumpTexture=null,this._lightmapTexture=null,this._refractionTexture=null,this.ambientColor=new al(0,0,0),this.diffuseColor=new al(1,1,1),this.specularColor=new al(1,1,1),this.emissiveColor=new al(0,0,0),this.specularPower=64,this._useAlphaFromDiffuseTexture=!1,this._useEmissiveAsIllumination=!1,this._linkEmissiveWithDiffuse=!1,this._useSpecularOverAlpha=!1,this._useReflectionOverAlpha=!1,this._disableLighting=!1,this._useObjectSpaceNormalMap=!1,this._useParallax=!1,this._useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this._roughness=0,this.indexOfRefraction=.98,this.invertRefractionY=!0,this.alphaCutOff=.4,this._useLightmapAsShadowmap=!1,this._useReflectionFresnelFromSpecular=!1,this._useGlossinessFromSpecularMapAlpha=!1,this._maxSimultaneousLights=4,this._invertNormalMapX=!1,this._invertNormalMapY=!1,this._twoSidedLighting=!1,this._renderTargets=new ql(16),this._worldViewProjectionMatrix=Y.Zero(),this._globalAmbientColor=new al(0,0,0),this._cacheHasRenderTargetTextures=!1,this.detailMap=new Wt(this),this._attachImageProcessingConfiguration(null),this.prePassConfiguration=new td,this.getRenderTargetTextures=()=>(this._renderTargets.reset(),C.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._renderTargets.push(this._reflectionTexture),C.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget&&this._renderTargets.push(this._refractionTexture),this._eventInfo.renderTargets=this._renderTargets,this._callbackPluginEventFillRenderTargetTextures(this._eventInfo),this._renderTargets)}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(l){this._attachImageProcessingConfiguration(l),this._markAllSubMeshesAsTexturesDirty()}_attachImageProcessingConfiguration(l){l!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),l?this._imageProcessingConfiguration=l:this._imageProcessingConfiguration=this.getScene().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add(()=>{this._markAllSubMeshesAsImageProcessingDirty()})))}get isPrePassCapable(){return!this.disableDepthWrite}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(l){this.imageProcessingConfiguration.colorCurvesEnabled=l}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(l){this.imageProcessingConfiguration.colorGradingEnabled=l}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(l){this._imageProcessingConfiguration.toneMappingEnabled=l}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(l){this._imageProcessingConfiguration.exposure=l}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(l){this._imageProcessingConfiguration.contrast=l}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(l){this._imageProcessingConfiguration.colorGradingTexture=l}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(l){this._imageProcessingConfiguration.colorCurves=l}get canRenderToMRT(){return!0}get hasRenderTargetTextures(){return C.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget||C.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget?!0:this._cacheHasRenderTargetTextures}getClassName(){return"StandardMaterial"}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(l){this._useLogarithmicDepth=l&&this.getScene().getEngine().getCaps().fragmentDepthSupported,this._markAllSubMeshesAsMiscDirty()}needAlphaBlending(){return this._disableAlphaBlending?!1:this.alpha<1||this._opacityTexture!=null||this._shouldUseAlphaFromDiffuseTexture()||this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled}needAlphaTesting(){return this._forceAlphaTest?!0:this._hasAlphaChannel()&&(this._transparencyMode==null||this._transparencyMode===U.MATERIAL_ALPHATEST)}_shouldUseAlphaFromDiffuseTexture(){return this._diffuseTexture!=null&&this._diffuseTexture.hasAlpha&&this._useAlphaFromDiffuseTexture&&this._transparencyMode!==U.MATERIAL_OPAQUE}_hasAlphaChannel(){return this._diffuseTexture!=null&&this._diffuseTexture.hasAlpha||this._opacityTexture!=null}getAlphaTestTexture(){return this._diffuseTexture}isReadyForSubMesh(l,e,t=!1){if(this._uniformBufferLayoutBuilt||this.buildUniformLayout(),e.effect&&this.isFrozen&&e.effect._wasPreviouslyReady&&e.effect._wasPreviouslyUsingInstances===t)return!0;e.materialDefines||(this._callbackPluginEventGeneric(Ol.GetDefineNames,this._eventInfo),e.materialDefines=new Jh(this._eventInfo.defineNames));const a=this.getScene(),s=e.materialDefines;if(this._isReadyForSubMesh(e))return!0;const d=a.getEngine();s._needNormals=tl.PrepareDefinesForLights(a,l,s,!0,this._maxSimultaneousLights,this._disableLighting),tl.PrepareDefinesForMultiview(a,s);const i=this.needAlphaBlendingForMesh(l)&&this.getScene().useOrderIndependentTransparency;if(tl.PrepareDefinesForPrePass(a,s,this.canRenderToMRT&&!i),tl.PrepareDefinesForOIT(a,s,i),s._areTexturesDirty){this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures,s._needUVs=!1;for(let n=1;n<=6;++n)s["MAINUV"+n]=!1;if(a.texturesEnabled){if(s.DIFFUSEDIRECTUV=0,s.BUMPDIRECTUV=0,s.AMBIENTDIRECTUV=0,s.OPACITYDIRECTUV=0,s.EMISSIVEDIRECTUV=0,s.SPECULARDIRECTUV=0,s.LIGHTMAPDIRECTUV=0,this._diffuseTexture&&C.DiffuseTextureEnabled)if(this._diffuseTexture.isReadyOrNotBlocking())tl.PrepareDefinesForMergedUV(this._diffuseTexture,s,"DIFFUSE");else return!1;else s.DIFFUSE=!1;if(this._ambientTexture&&C.AmbientTextureEnabled)if(this._ambientTexture.isReadyOrNotBlocking())tl.PrepareDefinesForMergedUV(this._ambientTexture,s,"AMBIENT");else return!1;else s.AMBIENT=!1;if(this._opacityTexture&&C.OpacityTextureEnabled)if(this._opacityTexture.isReadyOrNotBlocking())tl.PrepareDefinesForMergedUV(this._opacityTexture,s,"OPACITY"),s.OPACITYRGB=this._opacityTexture.getAlphaFromRGB;else return!1;else s.OPACITY=!1;if(this._reflectionTexture&&C.ReflectionTextureEnabled)if(this._reflectionTexture.isReadyOrNotBlocking()){switch(s._needNormals=!0,s.REFLECTION=!0,s.ROUGHNESS=this._roughness>0,s.REFLECTIONOVERALPHA=this._useReflectionOverAlpha,s.INVERTCUBICMAP=this._reflectionTexture.coordinatesMode===v.INVCUBIC_MODE,s.REFLECTIONMAP_3D=this._reflectionTexture.isCube,s.REFLECTIONMAP_OPPOSITEZ=s.REFLECTIONMAP_3D&&this.getScene().useRightHandedSystem?!this._reflectionTexture.invertZ:this._reflectionTexture.invertZ,s.RGBDREFLECTION=this._reflectionTexture.isRGBD,this._reflectionTexture.coordinatesMode){case v.EXPLICIT_MODE:s.setReflectionMode("REFLECTIONMAP_EXPLICIT");break;case v.PLANAR_MODE:s.setReflectionMode("REFLECTIONMAP_PLANAR");break;case v.PROJECTION_MODE:s.setReflectionMode("REFLECTIONMAP_PROJECTION");break;case v.SKYBOX_MODE:s.setReflectionMode("REFLECTIONMAP_SKYBOX");break;case v.SPHERICAL_MODE:s.setReflectionMode("REFLECTIONMAP_SPHERICAL");break;case v.EQUIRECTANGULAR_MODE:s.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR");break;case v.FIXED_EQUIRECTANGULAR_MODE:s.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR_FIXED");break;case v.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:s.setReflectionMode("REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED");break;case v.CUBIC_MODE:case v.INVCUBIC_MODE:default:s.setReflectionMode("REFLECTIONMAP_CUBIC");break}s.USE_LOCAL_REFLECTIONMAP_CUBIC=!!this._reflectionTexture.boundingBoxSize}else return!1;else s.REFLECTION=!1,s.REFLECTIONMAP_OPPOSITEZ=!1;if(this._emissiveTexture&&C.EmissiveTextureEnabled)if(this._emissiveTexture.isReadyOrNotBlocking())tl.PrepareDefinesForMergedUV(this._emissiveTexture,s,"EMISSIVE");else return!1;else s.EMISSIVE=!1;if(this._lightmapTexture&&C.LightmapTextureEnabled)if(this._lightmapTexture.isReadyOrNotBlocking())tl.PrepareDefinesForMergedUV(this._lightmapTexture,s,"LIGHTMAP"),s.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,s.RGBDLIGHTMAP=this._lightmapTexture.isRGBD;else return!1;else s.LIGHTMAP=!1;if(this._specularTexture&&C.SpecularTextureEnabled)if(this._specularTexture.isReadyOrNotBlocking())tl.PrepareDefinesForMergedUV(this._specularTexture,s,"SPECULAR"),s.GLOSSINESS=this._useGlossinessFromSpecularMapAlpha;else return!1;else s.SPECULAR=!1;if(a.getEngine().getCaps().standardDerivatives&&this._bumpTexture&&C.BumpTextureEnabled){if(this._bumpTexture.isReady())tl.PrepareDefinesForMergedUV(this._bumpTexture,s,"BUMP"),s.PARALLAX=this._useParallax,s.PARALLAXOCCLUSION=this._useParallaxOcclusion;else return!1;s.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap}else s.BUMP=!1,s.PARALLAX=!1,s.PARALLAXOCCLUSION=!1;if(this._refractionTexture&&C.RefractionTextureEnabled)if(this._refractionTexture.isReadyOrNotBlocking())s._needUVs=!0,s.REFRACTION=!0,s.REFRACTIONMAP_3D=this._refractionTexture.isCube,s.RGBDREFRACTION=this._refractionTexture.isRGBD,s.USE_LOCAL_REFRACTIONMAP_CUBIC=!!this._refractionTexture.boundingBoxSize;else return!1;else s.REFRACTION=!1;s.TWOSIDEDLIGHTING=!this._backFaceCulling&&this._twoSidedLighting}else s.DIFFUSE=!1,s.AMBIENT=!1,s.OPACITY=!1,s.REFLECTION=!1,s.EMISSIVE=!1,s.LIGHTMAP=!1,s.BUMP=!1,s.REFRACTION=!1;s.ALPHAFROMDIFFUSE=this._shouldUseAlphaFromDiffuseTexture(),s.EMISSIVEASILLUMINATION=this._useEmissiveAsIllumination,s.LINKEMISSIVEWITHDIFFUSE=this._linkEmissiveWithDiffuse,s.SPECULAROVERALPHA=this._useSpecularOverAlpha,s.PREMULTIPLYALPHA=this.alphaMode===7||this.alphaMode===8,s.ALPHATEST_AFTERALLALPHACOMPUTATIONS=this.transparencyMode!==null,s.ALPHABLEND=this.transparencyMode===null||this.needAlphaBlendingForMesh(l)}if(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=s,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh)return!1;if(s._areImageProcessingDirty&&this._imageProcessingConfiguration){if(!this._imageProcessingConfiguration.isReady())return!1;this._imageProcessingConfiguration.prepareDefines(s),s.IS_REFLECTION_LINEAR=this.reflectionTexture!=null&&!this.reflectionTexture.gammaSpace,s.IS_REFRACTION_LINEAR=this.refractionTexture!=null&&!this.refractionTexture.gammaSpace}s._areFresnelDirty&&(C.FresnelEnabled?(this._diffuseFresnelParameters||this._opacityFresnelParameters||this._emissiveFresnelParameters||this._refractionFresnelParameters||this._reflectionFresnelParameters)&&(s.DIFFUSEFRESNEL=this._diffuseFresnelParameters&&this._diffuseFresnelParameters.isEnabled,s.OPACITYFRESNEL=this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled,s.REFLECTIONFRESNEL=this._reflectionFresnelParameters&&this._reflectionFresnelParameters.isEnabled,s.REFLECTIONFRESNELFROMSPECULAR=this._useReflectionFresnelFromSpecular,s.REFRACTIONFRESNEL=this._refractionFresnelParameters&&this._refractionFresnelParameters.isEnabled,s.EMISSIVEFRESNEL=this._emissiveFresnelParameters&&this._emissiveFresnelParameters.isEnabled,s._needNormals=!0,s.FRESNEL=!0):s.FRESNEL=!1),tl.PrepareDefinesForMisc(l,a,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(l)||this._forceAlphaTest,s),tl.PrepareDefinesForFrameBoundValues(a,d,this,s,t,null,e.getRenderingMesh().hasThinInstances),this._eventInfo.defines=s,this._eventInfo.mesh=l,this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo),tl.PrepareDefinesForAttributes(l,s,!0,!0,!0),this._callbackPluginEventPrepareDefines(this._eventInfo);let c=!1;if(s.isDirty){const n=s._areLightsDisposed;s.markAsProcessed();const h=new Ls;s.REFLECTION&&h.addFallback(0,"REFLECTION"),s.SPECULAR&&h.addFallback(0,"SPECULAR"),s.BUMP&&h.addFallback(0,"BUMP"),s.PARALLAX&&h.addFallback(1,"PARALLAX"),s.PARALLAXOCCLUSION&&h.addFallback(0,"PARALLAXOCCLUSION"),s.SPECULAROVERALPHA&&h.addFallback(0,"SPECULAROVERALPHA"),s.FOG&&h.addFallback(1,"FOG"),s.POINTSIZE&&h.addFallback(0,"POINTSIZE"),s.LOGARITHMICDEPTH&&h.addFallback(0,"LOGARITHMICDEPTH"),tl.HandleFallbacksForShadows(s,h,this._maxSimultaneousLights),s.SPECULARTERM&&h.addFallback(0,"SPECULARTERM"),s.DIFFUSEFRESNEL&&h.addFallback(1,"DIFFUSEFRESNEL"),s.OPACITYFRESNEL&&h.addFallback(2,"OPACITYFRESNEL"),s.REFLECTIONFRESNEL&&h.addFallback(3,"REFLECTIONFRESNEL"),s.EMISSIVEFRESNEL&&h.addFallback(4,"EMISSIVEFRESNEL"),s.FRESNEL&&h.addFallback(4,"FRESNEL"),s.MULTIVIEW&&h.addFallback(0,"MULTIVIEW");const m=[X.PositionKind];s.NORMAL&&m.push(X.NormalKind),s.TANGENT&&m.push(X.TangentKind);for(let N=1;N<=6;++N)s["UV"+N]&&m.push(`uv${N===1?"":N}`);s.VERTEXCOLOR&&m.push(X.ColorKind),tl.PrepareAttributesForBones(m,l,s,h),tl.PrepareAttributesForInstances(m,s),tl.PrepareAttributesForMorphTargets(m,l,s),tl.PrepareAttributesForBakedVertexAnimation(m,l,s);let o="default";const b=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vDiffuseColor","vSpecularColor","vEmissiveColor","visibility","vFogInfos","vFogColor","pointSize","vDiffuseInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vEmissiveInfos","vSpecularInfos","vBumpInfos","vLightmapInfos","vRefractionInfos","mBones","diffuseMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","specularMatrix","bumpMatrix","normalMatrix","lightmapMatrix","refractionMatrix","diffuseLeftColor","diffuseRightColor","opacityParts","reflectionLeftColor","reflectionRightColor","emissiveLeftColor","emissiveRightColor","refractionLeftColor","refractionRightColor","vReflectionPosition","vReflectionSize","vRefractionPosition","vRefractionSize","logarithmicDepthConstant","vTangentSpaceParams","alphaCutOff","boneTextureWidth","morphTargetTextureInfo","morphTargetTextureIndices"],u=["diffuseSampler","ambientSampler","opacitySampler","reflectionCubeSampler","reflection2DSampler","emissiveSampler","specularSampler","bumpSampler","lightmapSampler","refractionCubeSampler","refraction2DSampler","boneSampler","morphTargets","oitDepthSampler","oitFrontColorSampler"],V=["Material","Scene","Mesh"];this._eventInfo.fallbacks=h,this._eventInfo.fallbackRank=0,this._eventInfo.defines=s,this._eventInfo.uniforms=b,this._eventInfo.attributes=m,this._eventInfo.samplers=u,this._eventInfo.uniformBuffersNames=V,this._eventInfo.customCode=void 0,this._eventInfo.mesh=l,this._callbackPluginEventGeneric(Ol.PrepareEffect,this._eventInfo),td.AddUniforms(b),rl&&(rl.PrepareUniforms(b,s),rl.PrepareSamplers(u,s)),tl.PrepareUniformsAndSamplersList({uniformsNames:b,uniformBuffersNames:V,samplers:u,defines:s,maxSimultaneousLights:this._maxSimultaneousLights}),xa(b);const G={};this.customShaderNameResolve&&(o=this.customShaderNameResolve(o,b,V,u,s,m,G));const p=s.toString(),y=e.effect;let L=a.getEngine().createEffect(o,{attributes:m,uniformsNames:b,uniformBuffersNames:V,samplers:u,defines:p,fallbacks:h,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:s.NUM_MORPH_INFLUENCERS},processFinalCode:G.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,multiTarget:s.PREPASS},d);if(this._eventInfo.customCode=void 0,L)if(this._onEffectCreatedObservable&&(qa.effect=L,qa.subMesh=e,this._onEffectCreatedObservable.notifyObservers(qa)),this.allowShaderHotSwapping&&y&&!L.isReady()){if(L=y,s.markAsUnprocessed(),c=this.isFrozen,n)return s._areLightsDisposed=!0,!1}else a.resetCachedMaterial(),e.setEffect(L,s,this._materialContext)}return!e.effect||!e.effect.isReady()?!1:(s._renderId=a.getRenderId(),e.effect._wasPreviouslyReady=!c,e.effect._wasPreviouslyUsingInstances=t,a.performancePriority!==Te.BackwardCompatible&&(this.checkReadyOnlyOnce=!0),!0)}buildUniformLayout(){const l=this._uniformBuffer;l.addUniform("diffuseLeftColor",4),l.addUniform("diffuseRightColor",4),l.addUniform("opacityParts",4),l.addUniform("reflectionLeftColor",4),l.addUniform("reflectionRightColor",4),l.addUniform("refractionLeftColor",4),l.addUniform("refractionRightColor",4),l.addUniform("emissiveLeftColor",4),l.addUniform("emissiveRightColor",4),l.addUniform("vDiffuseInfos",2),l.addUniform("vAmbientInfos",2),l.addUniform("vOpacityInfos",2),l.addUniform("vReflectionInfos",2),l.addUniform("vReflectionPosition",3),l.addUniform("vReflectionSize",3),l.addUniform("vEmissiveInfos",2),l.addUniform("vLightmapInfos",2),l.addUniform("vSpecularInfos",2),l.addUniform("vBumpInfos",3),l.addUniform("diffuseMatrix",16),l.addUniform("ambientMatrix",16),l.addUniform("opacityMatrix",16),l.addUniform("reflectionMatrix",16),l.addUniform("emissiveMatrix",16),l.addUniform("lightmapMatrix",16),l.addUniform("specularMatrix",16),l.addUniform("bumpMatrix",16),l.addUniform("vTangentSpaceParams",2),l.addUniform("pointSize",1),l.addUniform("alphaCutOff",1),l.addUniform("refractionMatrix",16),l.addUniform("vRefractionInfos",4),l.addUniform("vRefractionPosition",3),l.addUniform("vRefractionSize",3),l.addUniform("vSpecularColor",4),l.addUniform("vEmissiveColor",3),l.addUniform("vDiffuseColor",4),l.addUniform("vAmbientColor",3),super.buildUniformLayout()}bindForSubMesh(l,e,t){var a;const s=this.getScene(),d=t.materialDefines;if(!d)return;const i=t.effect;if(!i)return;this._activeEffect=i,e.getMeshUniformBuffer().bindToEffect(i,"Mesh"),e.transferToEffect(l),this._uniformBuffer.bindToEffect(i,"Material"),this.prePassConfiguration.bindForSubMesh(this._activeEffect,s,e,l,this.isFrozen),this._eventInfo.subMesh=t,this._callbackPluginEventHardBindForSubMesh(this._eventInfo),d.OBJECTSPACE_NORMALMAP&&(l.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));const c=i._forceRebindOnNextCall||this._mustRebind(s,i,e.visibility);tl.BindBonesParameters(e,i);const n=this._uniformBuffer;if(c){if(this.bindViewProjection(i),!n.useUbo||!this.isFrozen||!n.isSync||i._forceRebindOnNextCall){if(C.FresnelEnabled&&d.FRESNEL&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(n.updateColor4("diffuseLeftColor",this.diffuseFresnelParameters.leftColor,this.diffuseFresnelParameters.power),n.updateColor4("diffuseRightColor",this.diffuseFresnelParameters.rightColor,this.diffuseFresnelParameters.bias)),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&n.updateColor4("opacityParts",new al(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(n.updateColor4("reflectionLeftColor",this.reflectionFresnelParameters.leftColor,this.reflectionFresnelParameters.power),n.updateColor4("reflectionRightColor",this.reflectionFresnelParameters.rightColor,this.reflectionFresnelParameters.bias)),this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled&&(n.updateColor4("refractionLeftColor",this.refractionFresnelParameters.leftColor,this.refractionFresnelParameters.power),n.updateColor4("refractionRightColor",this.refractionFresnelParameters.rightColor,this.refractionFresnelParameters.bias)),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(n.updateColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),n.updateColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),s.texturesEnabled){if(this._diffuseTexture&&C.DiffuseTextureEnabled&&(n.updateFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),tl.BindTextureMatrix(this._diffuseTexture,n,"diffuse")),this._ambientTexture&&C.AmbientTextureEnabled&&(n.updateFloat2("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level),tl.BindTextureMatrix(this._ambientTexture,n,"ambient")),this._opacityTexture&&C.OpacityTextureEnabled&&(n.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),tl.BindTextureMatrix(this._opacityTexture,n,"opacity")),this._hasAlphaChannel()&&n.updateFloat("alphaCutOff",this.alphaCutOff),this._reflectionTexture&&C.ReflectionTextureEnabled&&(n.updateFloat2("vReflectionInfos",this._reflectionTexture.level,this.roughness),n.updateMatrix("reflectionMatrix",this._reflectionTexture.getReflectionTextureMatrix()),this._reflectionTexture.boundingBoxSize)){const h=this._reflectionTexture;n.updateVector3("vReflectionPosition",h.boundingBoxPosition),n.updateVector3("vReflectionSize",h.boundingBoxSize)}if(this._emissiveTexture&&C.EmissiveTextureEnabled&&(n.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),tl.BindTextureMatrix(this._emissiveTexture,n,"emissive")),this._lightmapTexture&&C.LightmapTextureEnabled&&(n.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),tl.BindTextureMatrix(this._lightmapTexture,n,"lightmap")),this._specularTexture&&C.SpecularTextureEnabled&&(n.updateFloat2("vSpecularInfos",this._specularTexture.coordinatesIndex,this._specularTexture.level),tl.BindTextureMatrix(this._specularTexture,n,"specular")),this._bumpTexture&&s.getEngine().getCaps().standardDerivatives&&C.BumpTextureEnabled&&(n.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,1/this._bumpTexture.level,this.parallaxScaleBias),tl.BindTextureMatrix(this._bumpTexture,n,"bump"),s._mirroredCameraPosition?n.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):n.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1)),this._refractionTexture&&C.RefractionTextureEnabled){let h=1;if(this._refractionTexture.isCube||(n.updateMatrix("refractionMatrix",this._refractionTexture.getReflectionTextureMatrix()),this._refractionTexture.depth&&(h=this._refractionTexture.depth)),n.updateFloat4("vRefractionInfos",this._refractionTexture.level,this.indexOfRefraction,h,this.invertRefractionY?-1:1),this._refractionTexture.boundingBoxSize){const m=this._refractionTexture;n.updateVector3("vRefractionPosition",m.boundingBoxPosition),n.updateVector3("vRefractionSize",m.boundingBoxSize)}}}this.pointsCloud&&n.updateFloat("pointSize",this.pointSize),d.SPECULARTERM&&n.updateColor4("vSpecularColor",this.specularColor,this.specularPower),n.updateColor3("vEmissiveColor",C.EmissiveTextureEnabled?this.emissiveColor:al.BlackReadOnly),n.updateColor4("vDiffuseColor",this.diffuseColor,this.alpha),s.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor),n.updateColor3("vAmbientColor",this._globalAmbientColor)}s.texturesEnabled&&(this._diffuseTexture&&C.DiffuseTextureEnabled&&i.setTexture("diffuseSampler",this._diffuseTexture),this._ambientTexture&&C.AmbientTextureEnabled&&i.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&C.OpacityTextureEnabled&&i.setTexture("opacitySampler",this._opacityTexture),this._reflectionTexture&&C.ReflectionTextureEnabled&&(this._reflectionTexture.isCube?i.setTexture("reflectionCubeSampler",this._reflectionTexture):i.setTexture("reflection2DSampler",this._reflectionTexture)),this._emissiveTexture&&C.EmissiveTextureEnabled&&i.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&C.LightmapTextureEnabled&&i.setTexture("lightmapSampler",this._lightmapTexture),this._specularTexture&&C.SpecularTextureEnabled&&i.setTexture("specularSampler",this._specularTexture),this._bumpTexture&&s.getEngine().getCaps().standardDerivatives&&C.BumpTextureEnabled&&i.setTexture("bumpSampler",this._bumpTexture),this._refractionTexture&&C.RefractionTextureEnabled&&(this._refractionTexture.isCube?i.setTexture("refractionCubeSampler",this._refractionTexture):i.setTexture("refraction2DSampler",this._refractionTexture))),this.getScene().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(e)&&this.getScene().depthPeelingRenderer.bind(i),this._eventInfo.subMesh=t,this._callbackPluginEventBindForSubMesh(this._eventInfo),Ua(i,this,s),this.bindEyePosition(i)}else s.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);(c||!this.isFrozen)&&(s.lightsEnabled&&!this._disableLighting&&tl.BindLights(s,e,i,d,this._maxSimultaneousLights),(s.fogEnabled&&e.applyFog&&s.fogMode!==sl.FOGMODE_NONE||this._reflectionTexture||this._refractionTexture||e.receiveShadows||d.PREPASS)&&this.bindView(i),tl.BindFogParameters(s,e,i),d.NUM_MORPH_INFLUENCERS&&tl.BindMorphTargetParameters(e,i),d.BAKED_VERTEX_ANIMATION_TEXTURE&&((a=e.bakedVertexAnimationManager)===null||a===void 0||a.bind(i,d.INSTANCES)),this.useLogarithmicDepth&&tl.BindLogDepth(d,i,s),this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.applyByPostProcess&&this._imageProcessingConfiguration.bind(this._activeEffect)),this._afterBind(e,this._activeEffect),n.update()}getAnimatables(){const l=super.getAnimatables();return this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&l.push(this._diffuseTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&l.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&l.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&l.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&l.push(this._emissiveTexture),this._specularTexture&&this._specularTexture.animations&&this._specularTexture.animations.length>0&&l.push(this._specularTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&l.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&l.push(this._lightmapTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&l.push(this._refractionTexture),l}getActiveTextures(){const l=super.getActiveTextures();return this._diffuseTexture&&l.push(this._diffuseTexture),this._ambientTexture&&l.push(this._ambientTexture),this._opacityTexture&&l.push(this._opacityTexture),this._reflectionTexture&&l.push(this._reflectionTexture),this._emissiveTexture&&l.push(this._emissiveTexture),this._specularTexture&&l.push(this._specularTexture),this._bumpTexture&&l.push(this._bumpTexture),this._lightmapTexture&&l.push(this._lightmapTexture),this._refractionTexture&&l.push(this._refractionTexture),l}hasTexture(l){return!!(super.hasTexture(l)||this._diffuseTexture===l||this._ambientTexture===l||this._opacityTexture===l||this._reflectionTexture===l||this._emissiveTexture===l||this._specularTexture===l||this._bumpTexture===l||this._lightmapTexture===l||this._refractionTexture===l)}dispose(l,e){var t,a,s,d,i,c,n,h,m;e&&((t=this._diffuseTexture)===null||t===void 0||t.dispose(),(a=this._ambientTexture)===null||a===void 0||a.dispose(),(s=this._opacityTexture)===null||s===void 0||s.dispose(),(d=this._reflectionTexture)===null||d===void 0||d.dispose(),(i=this._emissiveTexture)===null||i===void 0||i.dispose(),(c=this._specularTexture)===null||c===void 0||c.dispose(),(n=this._bumpTexture)===null||n===void 0||n.dispose(),(h=this._lightmapTexture)===null||h===void 0||h.dispose(),(m=this._refractionTexture)===null||m===void 0||m.dispose()),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),super.dispose(l,e)}clone(l){const e=il.Clone(()=>new C(l,this.getScene()),this);return e.name=l,e.id=l,this.stencil.copyTo(e.stencil),e}static Parse(l,e,t){const a=il.Parse(()=>new C(l.name,e),l,e,t);return l.stencil&&a.stencil.parse(l.stencil,e,t),a}static get DiffuseTextureEnabled(){return hl.DiffuseTextureEnabled}static set DiffuseTextureEnabled(l){hl.DiffuseTextureEnabled=l}static get DetailTextureEnabled(){return hl.DetailTextureEnabled}static set DetailTextureEnabled(l){hl.DetailTextureEnabled=l}static get AmbientTextureEnabled(){return hl.AmbientTextureEnabled}static set AmbientTextureEnabled(l){hl.AmbientTextureEnabled=l}static get OpacityTextureEnabled(){return hl.OpacityTextureEnabled}static set OpacityTextureEnabled(l){hl.OpacityTextureEnabled=l}static get ReflectionTextureEnabled(){return hl.ReflectionTextureEnabled}static set ReflectionTextureEnabled(l){hl.ReflectionTextureEnabled=l}static get EmissiveTextureEnabled(){return hl.EmissiveTextureEnabled}static set EmissiveTextureEnabled(l){hl.EmissiveTextureEnabled=l}static get SpecularTextureEnabled(){return hl.SpecularTextureEnabled}static set SpecularTextureEnabled(l){hl.SpecularTextureEnabled=l}static get BumpTextureEnabled(){return hl.BumpTextureEnabled}static set BumpTextureEnabled(l){hl.BumpTextureEnabled=l}static get LightmapTextureEnabled(){return hl.LightmapTextureEnabled}static set LightmapTextureEnabled(l){hl.LightmapTextureEnabled=l}static get RefractionTextureEnabled(){return hl.RefractionTextureEnabled}static set RefractionTextureEnabled(l){hl.RefractionTextureEnabled=l}static get ColorGradingTextureEnabled(){return hl.ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(l){hl.ColorGradingTextureEnabled=l}static get FresnelEnabled(){return hl.FresnelEnabled}static set FresnelEnabled(l){hl.FresnelEnabled=l}}W([ye("diffuseTexture")],C.prototype,"_diffuseTexture",void 0);W([pl("_markAllSubMeshesAsTexturesAndMiscDirty")],C.prototype,"diffuseTexture",void 0);W([ye("ambientTexture")],C.prototype,"_ambientTexture",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"ambientTexture",void 0);W([ye("opacityTexture")],C.prototype,"_opacityTexture",void 0);W([pl("_markAllSubMeshesAsTexturesAndMiscDirty")],C.prototype,"opacityTexture",void 0);W([ye("reflectionTexture")],C.prototype,"_reflectionTexture",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"reflectionTexture",void 0);W([ye("emissiveTexture")],C.prototype,"_emissiveTexture",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"emissiveTexture",void 0);W([ye("specularTexture")],C.prototype,"_specularTexture",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"specularTexture",void 0);W([ye("bumpTexture")],C.prototype,"_bumpTexture",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"bumpTexture",void 0);W([ye("lightmapTexture")],C.prototype,"_lightmapTexture",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"lightmapTexture",void 0);W([ye("refractionTexture")],C.prototype,"_refractionTexture",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"refractionTexture",void 0);W([Rt("ambient")],C.prototype,"ambientColor",void 0);W([Rt("diffuse")],C.prototype,"diffuseColor",void 0);W([Rt("specular")],C.prototype,"specularColor",void 0);W([Rt("emissive")],C.prototype,"emissiveColor",void 0);W([F()],C.prototype,"specularPower",void 0);W([F("useAlphaFromDiffuseTexture")],C.prototype,"_useAlphaFromDiffuseTexture",void 0);W([pl("_markAllSubMeshesAsTexturesAndMiscDirty")],C.prototype,"useAlphaFromDiffuseTexture",void 0);W([F("useEmissiveAsIllumination")],C.prototype,"_useEmissiveAsIllumination",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"useEmissiveAsIllumination",void 0);W([F("linkEmissiveWithDiffuse")],C.prototype,"_linkEmissiveWithDiffuse",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"linkEmissiveWithDiffuse",void 0);W([F("useSpecularOverAlpha")],C.prototype,"_useSpecularOverAlpha",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"useSpecularOverAlpha",void 0);W([F("useReflectionOverAlpha")],C.prototype,"_useReflectionOverAlpha",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"useReflectionOverAlpha",void 0);W([F("disableLighting")],C.prototype,"_disableLighting",void 0);W([pl("_markAllSubMeshesAsLightsDirty")],C.prototype,"disableLighting",void 0);W([F("useObjectSpaceNormalMap")],C.prototype,"_useObjectSpaceNormalMap",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"useObjectSpaceNormalMap",void 0);W([F("useParallax")],C.prototype,"_useParallax",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"useParallax",void 0);W([F("useParallaxOcclusion")],C.prototype,"_useParallaxOcclusion",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"useParallaxOcclusion",void 0);W([F()],C.prototype,"parallaxScaleBias",void 0);W([F("roughness")],C.prototype,"_roughness",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"roughness",void 0);W([F()],C.prototype,"indexOfRefraction",void 0);W([F()],C.prototype,"invertRefractionY",void 0);W([F()],C.prototype,"alphaCutOff",void 0);W([F("useLightmapAsShadowmap")],C.prototype,"_useLightmapAsShadowmap",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"useLightmapAsShadowmap",void 0);W([At("diffuseFresnelParameters")],C.prototype,"_diffuseFresnelParameters",void 0);W([pl("_markAllSubMeshesAsFresnelDirty")],C.prototype,"diffuseFresnelParameters",void 0);W([At("opacityFresnelParameters")],C.prototype,"_opacityFresnelParameters",void 0);W([pl("_markAllSubMeshesAsFresnelAndMiscDirty")],C.prototype,"opacityFresnelParameters",void 0);W([At("reflectionFresnelParameters")],C.prototype,"_reflectionFresnelParameters",void 0);W([pl("_markAllSubMeshesAsFresnelDirty")],C.prototype,"reflectionFresnelParameters",void 0);W([At("refractionFresnelParameters")],C.prototype,"_refractionFresnelParameters",void 0);W([pl("_markAllSubMeshesAsFresnelDirty")],C.prototype,"refractionFresnelParameters",void 0);W([At("emissiveFresnelParameters")],C.prototype,"_emissiveFresnelParameters",void 0);W([pl("_markAllSubMeshesAsFresnelDirty")],C.prototype,"emissiveFresnelParameters",void 0);W([F("useReflectionFresnelFromSpecular")],C.prototype,"_useReflectionFresnelFromSpecular",void 0);W([pl("_markAllSubMeshesAsFresnelDirty")],C.prototype,"useReflectionFresnelFromSpecular",void 0);W([F("useGlossinessFromSpecularMapAlpha")],C.prototype,"_useGlossinessFromSpecularMapAlpha",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"useGlossinessFromSpecularMapAlpha",void 0);W([F("maxSimultaneousLights")],C.prototype,"_maxSimultaneousLights",void 0);W([pl("_markAllSubMeshesAsLightsDirty")],C.prototype,"maxSimultaneousLights",void 0);W([F("invertNormalMapX")],C.prototype,"_invertNormalMapX",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"invertNormalMapX",void 0);W([F("invertNormalMapY")],C.prototype,"_invertNormalMapY",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"invertNormalMapY",void 0);W([F("twoSidedLighting")],C.prototype,"_twoSidedLighting",void 0);W([pl("_markAllSubMeshesAsTexturesDirty")],C.prototype,"twoSidedLighting",void 0);W([F()],C.prototype,"useLogarithmicDepth",null);ce("BABYLON.StandardMaterial",C);sl.DefaultMaterialFactory=Z=>new C("default material",Z);const xh="imageProcessingCompatibility",Uh=`#ifdef IMAGEPROCESSINGPOSTPROCESS
gl_FragColor.rgb=pow(gl_FragColor.rgb,vec3(2.2));
#endif
`;H.IncludesShadersStore[xh]=Uh;const fh="shadowOnlyPixelShader",Th=`precision highp float;
uniform vec4 vEyePosition;
uniform float alpha;
uniform vec3 shadowColor;
varying vec3 vPositionW;
#ifdef NORMAL
varying vec3 vNormalW;
#endif
#include<helperFunctions>
#include<__decl__lightFragment>[0..maxSimultaneousLights]
#include<lightsFragmentFunctions>
#include<shadowsFragmentFunctions>
#include<clipPlaneFragmentDeclaration>
#include<fogFragmentDeclaration>
#define CUSTOM_FRAGMENT_DEFINITIONS
void main(void) {
#define CUSTOM_FRAGMENT_MAIN_BEGIN
#include<clipPlaneFragment>
vec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);
#ifdef NORMAL
vec3 normalW=normalize(vNormalW);
#else
vec3 normalW=vec3(1.0,1.0,1.0);
#endif
vec3 diffuseBase=vec3(0.,0.,0.);
lightingInfo info;
float shadow=1.;
float glossiness=0.;
#include<lightFragment>[0..1]
vec4 color=vec4(shadowColor,(1.0-clamp(shadow,0.,1.))*alpha);
#include<fogFragment>
gl_FragColor=color;
#include<imageProcessingCompatibility>
#define CUSTOM_FRAGMENT_MAIN_END
}`;H.ShadersStore[fh]=Th;const zh="shadowOnlyVertexShader",Mh=`precision highp float;
attribute vec3 position;
#ifdef NORMAL
attribute vec3 normal;
#endif
#include<bonesDeclaration>
#include<bakedVertexAnimationDeclaration>
#include<instancesDeclaration>
uniform mat4 view;
uniform mat4 viewProjection;
#ifdef POINTSIZE
uniform float pointSize;
#endif
varying vec3 vPositionW;
#ifdef NORMAL
varying vec3 vNormalW;
#endif
#ifdef VERTEXCOLOR
varying vec4 vColor;
#endif
#include<clipPlaneVertexDeclaration>
#include<fogVertexDeclaration>
#include<__decl__lightFragment>[0..maxSimultaneousLights]
#define CUSTOM_VERTEX_DEFINITIONS
void main(void) {
#define CUSTOM_VERTEX_MAIN_BEGIN
#include<instancesVertex>
#include<bonesVertex>
#include<bakedVertexAnimation>
vec4 worldPos=finalWorld*vec4(position,1.0);
gl_Position=viewProjection*worldPos;
vPositionW=vec3(worldPos);
#ifdef NORMAL
vNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));
#endif
#include<clipPlaneVertex>
#include<fogVertex>
#include<shadowsVertex>[0..maxSimultaneousLights]
#if defined(POINTSIZE) && !defined(WEBGPU)
gl_PointSize=pointSize;
#endif
#define CUSTOM_VERTEX_MAIN_END
}
`;H.ShadersStore[zh]=Mh;class gh extends Ys{constructor(){super(),this.CLIPPLANE=!1,this.CLIPPLANE2=!1,this.CLIPPLANE3=!1,this.CLIPPLANE4=!1,this.CLIPPLANE5=!1,this.CLIPPLANE6=!1,this.POINTSIZE=!1,this.FOG=!1,this.NORMAL=!1,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.INSTANCES=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.SKIPFINALCOLORCLAMP=!1,this.rebuild()}}class Dt extends Ud{constructor(l,e){super(l,e),this._needAlphaBlending=!0,this.shadowColor=al.Black()}needAlphaBlending(){return this._needAlphaBlending}needAlphaTesting(){return!1}getAlphaTestTexture(){return null}get activeLight(){return this._activeLight}set activeLight(l){this._activeLight=l}_getFirstShadowLightForMesh(l){for(const e of l.lightSources)if(e.shadowEnabled)return e;return null}isReadyForSubMesh(l,e,t){var a;if(this.isFrozen&&e.effect&&e.effect._wasPreviouslyReady&&e.effect._wasPreviouslyUsingInstances===t)return!0;e.materialDefines||(e.materialDefines=new gh);const s=e.materialDefines,d=this.getScene();if(this._isReadyForSubMesh(e))return!0;const i=d.getEngine();if(this._activeLight){for(const n of l.lightSources)if(n.shadowEnabled){if(this._activeLight===n)break;const h=l.lightSources.indexOf(this._activeLight);h!==-1&&(l.lightSources.splice(h,1),l.lightSources.splice(0,0,this._activeLight));break}}tl.PrepareDefinesForFrameBoundValues(d,i,this,s,!!t),tl.PrepareDefinesForMisc(l,d,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(l),s),s._needNormals=tl.PrepareDefinesForLights(d,l,s,!1,1);const c=(a=this._getFirstShadowLightForMesh(l))===null||a===void 0?void 0:a.getShadowGenerator();if(this._needAlphaBlending=!0,c&&c.getClassName&&c.getClassName()==="CascadedShadowGenerator"){const n=c;this._needAlphaBlending=!n.autoCalcDepthBounds}if(tl.PrepareDefinesForAttributes(l,s,!1,!0),s.isDirty){s.markAsProcessed(),d.resetCachedMaterial();const n=new Ls;s.FOG&&n.addFallback(1,"FOG"),tl.HandleFallbacksForShadows(s,n,1),s.NUM_BONE_INFLUENCERS>0&&n.addCPUSkinningFallback(0,l),s.IMAGEPROCESSINGPOSTPROCESS=d.imageProcessingConfiguration.applyByPostProcess;const h=[X.PositionKind];s.NORMAL&&h.push(X.NormalKind),tl.PrepareAttributesForBones(h,l,s,n),tl.PrepareAttributesForInstances(h,s);const m="shadowOnly",o=s.toString(),b=["world","view","viewProjection","vEyePosition","vLightsType","vFogInfos","vFogColor","pointSize","alpha","shadowColor","mBones"],u=new Array,V=new Array;xa(b),tl.PrepareUniformsAndSamplersList({uniformsNames:b,uniformBuffersNames:V,samplers:u,defines:s,maxSimultaneousLights:1}),e.setEffect(d.getEngine().createEffect(m,{attributes:h,uniformsNames:b,uniformBuffersNames:V,samplers:u,defines:o,fallbacks:n,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:1}},i),s,this._materialContext)}return!e.effect||!e.effect.isReady()?!1:(s._renderId=d.getRenderId(),e.effect._wasPreviouslyReady=!0,e.effect._wasPreviouslyUsingInstances=!!t,!0)}bindForSubMesh(l,e,t){const a=this.getScene(),s=t.materialDefines;if(!s)return;const d=t.effect;if(d){if(this._activeEffect=d,this.bindOnlyWorldMatrix(l),this._activeEffect.setMatrix("viewProjection",a.getTransformMatrix()),tl.BindBonesParameters(e,this._activeEffect),this._mustRebind(a,d)&&(Ua(d,this,a),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),this._activeEffect.setFloat("alpha",this.alpha),this._activeEffect.setColor3("shadowColor",this.shadowColor),a.bindEyePosition(d)),a.lightsEnabled){tl.BindLights(a,e,this._activeEffect,s,1);const i=this._getFirstShadowLightForMesh(e);i&&(i._renderId=-1)}(a.fogEnabled&&e.applyFog&&a.fogMode!==sl.FOGMODE_NONE||s.SHADOWCSM0)&&this._activeEffect.setMatrix("view",a.getViewMatrix()),tl.BindFogParameters(a,e,this._activeEffect),this._afterBind(e,this._activeEffect)}}clone(l){return il.Clone(()=>new Dt(l,this.getScene()),this)}serialize(){const l=super.serialize();return l.customType="BABYLON.ShadowOnlyMaterial",l}getClassName(){return"ShadowOnlyMaterial"}static Parse(l,e,t){return il.Parse(()=>new Dt(l.name,e),l,e,t)}}ce("BABYLON.ShadowOnlyMaterial",Dt);const Ch={aspect:300/150,enableDebugging:!1,enableShadows:!0};class vh{constructor(l){Le(this,"size",9.5),this.config={...Ch,...l},this.create()}create(l){this.destroy(),Object.assign(this.config,l);const{aspect:e,enableDebugging:t=!0,enableShadows:a}=this.config,s=30;let d;this.box=new q("diceBox"),t?(d=new C("diceBox_material"),d.alpha=.7,d.diffuseColor=new al(1,1,0)):a&&(d=new Dt("shadowOnly",this.config.scene));const i=Lt("ground",{width:this.size*2,height:1,depth:this.size*2},this.config.scene);if(i.scaling=new r(e,1,1),i.material=d,i.receiveShadows=!0,i.setParent(this.box),t){const c=Lt("wallTop",{width:this.size,height:s,depth:1},this.config.scene);c.position.y=s/2,c.position.z=this.size/-2,c.scaling=new r(e,1,1),c.material=d,c.setParent(this.box);const n=Lt("wallRight",{width:1,height:s,depth:this.size},this.config.scene);n.position.x=this.size*e/2,n.position.y=s/2,n.material=d,n.setParent(this.box);const h=Lt("wallBottom",{width:this.size,height:s,depth:1},this.config.scene);h.position.y=s/2,h.position.z=this.size/2,h.scaling=new r(e,1,1),h.material=d,h.setParent(this.box);const m=Lt("wallLeft",{width:1,height:s,depth:this.size},this.config.scene);m.position.x=this.size*e/-2,m.position.y=s/2,m.material=d,m.setParent(this.box)}}destroy(){this.box&&this.box.dispose()}}var $e;(function(Z){Z[Z.Clean=0]="Clean",Z[Z.Stop=1]="Stop",Z[Z.Sync=2]="Sync",Z[Z.NoSync=3]="NoSync"})($e||($e={}));class cl{static get ForceFullSceneLoadingForIncremental(){return gl.ForceFullSceneLoadingForIncremental}static set ForceFullSceneLoadingForIncremental(l){gl.ForceFullSceneLoadingForIncremental=l}static get ShowLoadingScreen(){return gl.ShowLoadingScreen}static set ShowLoadingScreen(l){gl.ShowLoadingScreen=l}static get loggingLevel(){return gl.loggingLevel}static set loggingLevel(l){gl.loggingLevel=l}static get CleanBoneMatrixWeights(){return gl.CleanBoneMatrixWeights}static set CleanBoneMatrixWeights(l){gl.CleanBoneMatrixWeights=l}static GetDefaultPlugin(){return cl._RegisteredPlugins[".babylon"]}static _GetPluginForExtension(l){return cl._RegisteredPlugins[l]||(M.Warn("Unable to find a plugin to load "+l+" files. Trying to use .babylon default plugin. To load from a specific filetype (eg. gltf) see: https://doc.babylonjs.com/features/featuresDeepDive/importers/loadingFileTypes"),cl.GetDefaultPlugin())}static _GetPluginForDirectLoad(l){for(const e in cl._RegisteredPlugins){const t=cl._RegisteredPlugins[e].plugin;if(t.canDirectLoad&&t.canDirectLoad(l))return cl._RegisteredPlugins[e]}return cl.GetDefaultPlugin()}static _GetPluginForFilename(l){const e=l.indexOf("?");e!==-1&&(l=l.substring(0,e));const t=l.lastIndexOf("."),a=l.substring(t,l.length).toLowerCase();return cl._GetPluginForExtension(a)}static _GetDirectLoad(l){return l.substr(0,5)==="data:"?l.substr(5):null}static _FormatErrorMessage(l,e,t){let a="Unable to load from "+l.url;return e?a+=`: ${e}`:t&&(a+=`: ${t}`),a}static _LoadData(l,e,t,a,s,d,i){const c=cl._GetDirectLoad(l.url),n=i?cl._GetPluginForExtension(i):c?cl._GetPluginForDirectLoad(l.url):cl._GetPluginForFilename(l.url);let h;if(n.plugin.createPlugin!==void 0?h=n.plugin.createPlugin():h=n.plugin,!h)throw"The loader plugin corresponding to the file type you are trying to load has not been found. If using es6, please import the plugin you wish to use before.";if(cl.OnPluginActivatedObservable.notifyObservers(h),c&&(h.canDirectLoad&&h.canDirectLoad(l.url)||!ps(l.url))){if(h.directLoad){const L=h.directLoad(e,c);L.then?L.then(N=>{t(h,N)}).catch(N=>{s("Error in directLoad of _loadData: "+N,N)}):t(h,L)}else t(h,c);return h}const m=n.isBinary,o=(L,N)=>{if(e.isDisposed){s("Scene has been disposed");return}t(h,L,N)};let b=null,u=!1;const V=h.onDisposeObservable;V&&V.add(()=>{u=!0,b&&(b.abort(),b=null),d()});const G=()=>{if(u)return;const L=(J,R)=>{s(J==null?void 0:J.statusText,R)},N=l.file||l.url;b=h.loadFile?h.loadFile(e,N,o,a,m,L):e._loadFile(N,o,a,!0,m,L)},p=e.getEngine();let y=p.enableOfflineSupport;if(y){let L=!1;for(const N of e.disableOfflineSupportExceptionRules)if(N.test(l.url)){L=!0;break}y=!L}return y&&x.OfflineProviderFactory?e.offlineProvider=x.OfflineProviderFactory(l.url,G,p.disableManifestCheck):G(),h}static _GetFileInfo(l,e){let t,a,s=null;if(!e)t=l,a=Q.GetFilename(l),l=Q.GetFolderPath(l);else if(e.name){const d=e;t=`file:${d.name}`,a=d.name,s=d}else if(typeof e=="string"&&e.startsWith("data:"))t=e,a="";else{const d=e;if(d.substr(0,1)==="/")return Q.Error("Wrong sceneFilename parameter"),null;t=l+d,a=d}return{url:t,rootUrl:l,name:a,file:s}}static GetPluginForExtension(l){return cl._GetPluginForExtension(l).plugin}static IsPluginForExtensionAvailable(l){return!!cl._RegisteredPlugins[l]}static RegisterPlugin(l){if(typeof l.extensions=="string"){const e=l.extensions;cl._RegisteredPlugins[e.toLowerCase()]={plugin:l,isBinary:!1}}else{const e=l.extensions;Object.keys(e).forEach(t=>{cl._RegisteredPlugins[t.toLowerCase()]={plugin:l,isBinary:e[t].isBinary}})}}static ImportMesh(l,e,t="",a=bl.LastCreatedScene,s=null,d=null,i=null,c=null){if(!a)return M.Error("No scene available to import mesh to"),null;const n=cl._GetFileInfo(e,t);if(!n)return null;const h={};a.addPendingData(h);const m=()=>{a.removePendingData(h)},o=(V,G)=>{const p=cl._FormatErrorMessage(n,V,G);i?i(a,p,new Pe(p,Xt.SceneLoaderError,G)):M.Error(p),m()},b=d?V=>{try{d(V)}catch(G){o("Error in onProgress callback: "+G,G)}}:void 0,u=(V,G,p,y,L,N,J)=>{if(a.importedMeshesFiles.push(n.url),s)try{s(V,G,p,y,L,N,J)}catch(R){o("Error in onSuccess callback: "+R,R)}a.removePendingData(h)};return cl._LoadData(n,a,(V,G,p)=>{if(V.rewriteRootURL&&(n.rootUrl=V.rewriteRootURL(n.rootUrl,p)),V.importMesh){const y=V,L=new Array,N=new Array,J=new Array;if(!y.importMesh(l,a,G,n.rootUrl,L,N,J,o))return;a.loadingPluginName=V.name,u(L,N,J,[],[],[],[])}else V.importMeshAsync(l,a,G,n.rootUrl,b,n.name).then(y=>{a.loadingPluginName=V.name,u(y.meshes,y.particleSystems,y.skeletons,y.animationGroups,y.transformNodes,y.geometries,y.lights)}).catch(y=>{o(y.message,y)})},b,o,m,c)}static ImportMeshAsync(l,e,t="",a=bl.LastCreatedScene,s=null,d=null){return new Promise((i,c)=>{cl.ImportMesh(l,e,t,a,(n,h,m,o,b,u,V)=>{i({meshes:n,particleSystems:h,skeletons:m,animationGroups:o,transformNodes:b,geometries:u,lights:V})},s,(n,h,m)=>{c(m||new Error(h))},d)})}static Load(l,e="",t=bl.LastCreatedEngine,a=null,s=null,d=null,i=null){return t?cl.Append(l,e,new sl(t),a,s,d,i):(Q.Error("No engine available"),null)}static LoadAsync(l,e="",t=bl.LastCreatedEngine,a=null,s=null){return new Promise((d,i)=>{cl.Load(l,e,t,c=>{d(c)},a,(c,n,h)=>{i(h||new Error(n))},s)})}static Append(l,e="",t=bl.LastCreatedScene,a=null,s=null,d=null,i=null){if(!t)return M.Error("No scene available to append to"),null;const c=cl._GetFileInfo(l,e);if(!c)return null;const n={};t.addPendingData(n);const h=()=>{t.removePendingData(n)};cl.ShowLoadingScreen&&!this._ShowingLoadingScreen&&(this._ShowingLoadingScreen=!0,t.getEngine().displayLoadingUI(),t.executeWhenReady(()=>{t.getEngine().hideLoadingUI(),this._ShowingLoadingScreen=!1}));const m=(u,V)=>{const G=cl._FormatErrorMessage(c,u,V);d?d(t,G,new Pe(G,Xt.SceneLoaderError,V)):M.Error(G),h()},o=s?u=>{try{s(u)}catch(V){m("Error in onProgress callback",V)}}:void 0,b=()=>{if(a)try{a(t)}catch(u){m("Error in onSuccess callback",u)}t.removePendingData(n)};return cl._LoadData(c,t,(u,V)=>{if(u.load){if(!u.load(t,V,c.rootUrl,m))return;t.loadingPluginName=u.name,b()}else u.loadAsync(t,V,c.rootUrl,o,c.name).then(()=>{t.loadingPluginName=u.name,b()}).catch(G=>{m(G.message,G)})},o,m,h,i)}static AppendAsync(l,e="",t=bl.LastCreatedScene,a=null,s=null){return new Promise((d,i)=>{cl.Append(l,e,t,c=>{d(c)},a,(c,n,h)=>{i(h||new Error(n))},s)})}static LoadAssetContainer(l,e="",t=bl.LastCreatedScene,a=null,s=null,d=null,i=null){if(!t)return M.Error("No scene available to load asset container to"),null;const c=cl._GetFileInfo(l,e);if(!c)return null;const n={};t.addPendingData(n);const h=()=>{t.removePendingData(n)},m=(u,V)=>{const G=cl._FormatErrorMessage(c,u,V);d?d(t,G,new Pe(G,Xt.SceneLoaderError,V)):M.Error(G),h()},o=s?u=>{try{s(u)}catch(V){m("Error in onProgress callback",V)}}:void 0,b=u=>{if(a)try{a(u)}catch(V){m("Error in onSuccess callback",V)}t.removePendingData(n)};return cl._LoadData(c,t,(u,V)=>{if(u.loadAssetContainer){const G=u.loadAssetContainer(t,V,c.rootUrl,m);if(!G)return;t.loadingPluginName=u.name,b(G)}else u.loadAssetContainerAsync?u.loadAssetContainerAsync(t,V,c.rootUrl,o,c.name).then(G=>{t.loadingPluginName=u.name,b(G)}).catch(G=>{m(G.message,G)}):m("LoadAssetContainer is not supported by this plugin. Plugin did not provide a loadAssetContainer or loadAssetContainerAsync method.")},o,m,h,i)}static LoadAssetContainerAsync(l,e="",t=bl.LastCreatedScene,a=null,s=null){return new Promise((d,i)=>{cl.LoadAssetContainer(l,e,t,c=>{d(c)},a,(c,n,h)=>{i(h||new Error(n))},s)})}static ImportAnimations(l,e="",t=bl.LastCreatedScene,a=!0,s=$e.Clean,d=null,i=null,c=null,n=null,h=null){if(!t){M.Error("No scene available to load animations to");return}if(a){for(const b of t.animatables)b.reset();t.stopAllAnimations(),t.animationGroups.slice().forEach(b=>{b.dispose()}),t.getNodes().forEach(b=>{b.animations&&(b.animations=[])})}else switch(s){case $e.Clean:t.animationGroups.slice().forEach(b=>{b.dispose()});break;case $e.Stop:t.animationGroups.forEach(b=>{b.stop()});break;case $e.Sync:t.animationGroups.forEach(b=>{b.reset(),b.restart()});break;case $e.NoSync:break;default:M.Error("Unknown animation group loading mode value '"+s+"'");return}const m=t.animatables.length,o=b=>{b.mergeAnimationsTo(t,t.animatables.slice(m),d),b.dispose(),t.onAnimationFileImportedObservable.notifyObservers(t),i&&i(t)};this.LoadAssetContainer(l,e,t,o,c,n,h)}static ImportAnimationsAsync(l,e="",t=bl.LastCreatedScene,a=!0,s=$e.Clean,d=null,i=null,c=null,n=null,h=null){return new Promise((m,o)=>{cl.ImportAnimations(l,e,t,a,s,d,b=>{m(b)},c,(b,u,V)=>{o(V||new Error(u))},h)})}}cl.NO_LOGGING=0;cl.MINIMAL_LOGGING=1;cl.SUMMARY_LOGGING=2;cl.DETAILED_LOGGING=3;cl.OnPluginActivatedObservable=new z;cl._RegisteredPlugins={};cl._ShowingLoadingScreen=!1;class Xl{constructor(l,e,t=Number.MAX_VALUE){this.origin=l,this.direction=e,this.length=t}clone(){return new Xl(this.origin.clone(),this.direction.clone(),this.length)}intersectsBoxMinMax(l,e,t=0){const a=Xl._TmpVector3[0].copyFromFloats(l.x-t,l.y-t,l.z-t),s=Xl._TmpVector3[1].copyFromFloats(e.x+t,e.y+t,e.z+t);let d=0,i=Number.MAX_VALUE,c,n,h,m;if(Math.abs(this.direction.x)<1e-7){if(this.origin.x<a.x||this.origin.x>s.x)return!1}else if(c=1/this.direction.x,n=(a.x-this.origin.x)*c,h=(s.x-this.origin.x)*c,h===-1/0&&(h=1/0),n>h&&(m=n,n=h,h=m),d=Math.max(n,d),i=Math.min(h,i),d>i)return!1;if(Math.abs(this.direction.y)<1e-7){if(this.origin.y<a.y||this.origin.y>s.y)return!1}else if(c=1/this.direction.y,n=(a.y-this.origin.y)*c,h=(s.y-this.origin.y)*c,h===-1/0&&(h=1/0),n>h&&(m=n,n=h,h=m),d=Math.max(n,d),i=Math.min(h,i),d>i)return!1;if(Math.abs(this.direction.z)<1e-7){if(this.origin.z<a.z||this.origin.z>s.z)return!1}else if(c=1/this.direction.z,n=(a.z-this.origin.z)*c,h=(s.z-this.origin.z)*c,h===-1/0&&(h=1/0),n>h&&(m=n,n=h,h=m),d=Math.max(n,d),i=Math.min(h,i),d>i)return!1;return!0}intersectsBox(l,e=0){return this.intersectsBoxMinMax(l.minimum,l.maximum,e)}intersectsSphere(l,e=0){const t=l.center.x-this.origin.x,a=l.center.y-this.origin.y,s=l.center.z-this.origin.z,d=t*t+a*a+s*s,i=l.radius+e,c=i*i;if(d<=c)return!0;const n=t*this.direction.x+a*this.direction.y+s*this.direction.z;return n<0?!1:d-n*n<=c}intersectsTriangle(l,e,t){const a=Xl._TmpVector3[0],s=Xl._TmpVector3[1],d=Xl._TmpVector3[2],i=Xl._TmpVector3[3],c=Xl._TmpVector3[4];e.subtractToRef(l,a),t.subtractToRef(l,s),r.CrossToRef(this.direction,s,d);const n=r.Dot(a,d);if(n===0)return null;const h=1/n;this.origin.subtractToRef(l,i);const m=r.Dot(i,d)*h;if(m<0||m>1)return null;r.CrossToRef(i,a,c);const o=r.Dot(this.direction,c)*h;if(o<0||m+o>1)return null;const b=r.Dot(s,c)*h;return b>this.length?null:new Zs(1-m-o,m,b)}intersectsPlane(l){let e;const t=r.Dot(l.normal,this.direction);if(Math.abs(t)<999999997475243e-21)return null;{const a=r.Dot(l.normal,this.origin);return e=(-l.d-a)/t,e<0?e<-999999997475243e-21?null:0:e}}intersectsAxis(l,e=0){switch(l){case"y":{const t=(this.origin.y-e)/this.direction.y;return t>0?null:new r(this.origin.x+this.direction.x*-t,e,this.origin.z+this.direction.z*-t)}case"x":{const t=(this.origin.x-e)/this.direction.x;return t>0?null:new r(e,this.origin.y+this.direction.y*-t,this.origin.z+this.direction.z*-t)}case"z":{const t=(this.origin.z-e)/this.direction.z;return t>0?null:new r(this.origin.x+this.direction.x*-t,this.origin.y+this.direction.y*-t,e)}default:return null}}intersectsMesh(l,e){const t=f.Matrix[0];return l.getWorldMatrix().invertToRef(t),this._tmpRay?Xl.TransformToRef(this,t,this._tmpRay):this._tmpRay=Xl.Transform(this,t),l.intersects(this._tmpRay,e)}intersectsMeshes(l,e,t){t?t.length=0:t=[];for(let a=0;a<l.length;a++){const s=this.intersectsMesh(l[a],e);s.hit&&t.push(s)}return t.sort(this._comparePickingInfo),t}_comparePickingInfo(l,e){return l.distance<e.distance?-1:l.distance>e.distance?1:0}intersectionSegment(l,e,t){const a=this.origin,s=f.Vector3[0],d=f.Vector3[1],i=f.Vector3[2],c=f.Vector3[3];e.subtractToRef(l,s),this.direction.scaleToRef(Xl._Rayl,i),a.addToRef(i,d),l.subtractToRef(a,c);const n=r.Dot(s,s),h=r.Dot(s,i),m=r.Dot(i,i),o=r.Dot(s,c),b=r.Dot(i,c),u=n*m-h*h;let V,G=u,p,y=u;u<Xl._Smallnum?(V=0,G=1,p=b,y=m):(V=h*b-m*o,p=n*b-h*o,V<0?(V=0,p=b,y=m):V>G&&(V=G,p=b+h,y=m)),p<0?(p=0,-o<0?V=0:-o>n?V=G:(V=-o,G=n)):p>y&&(p=y,-o+h<0?V=0:-o+h>n?V=G:(V=-o+h,G=n));const L=Math.abs(V)<Xl._Smallnum?0:V/G,N=Math.abs(p)<Xl._Smallnum?0:p/y,J=f.Vector3[4];i.scaleToRef(N,J);const R=f.Vector3[5];s.scaleToRef(L,R),R.addInPlace(c);const S=f.Vector3[6];return R.subtractToRef(J,S),N>0&&N<=this.length&&S.lengthSquared()<t*t?R.length():-1}update(l,e,t,a,s,d,i,c=!1){if(c){Xl._RayDistant||(Xl._RayDistant=Xl.Zero()),Xl._RayDistant.unprojectRayToRef(l,e,t,a,Y.IdentityReadOnly,d,i);const n=f.Matrix[0];s.invertToRef(n),Xl.TransformToRef(Xl._RayDistant,n,this)}else this.unprojectRayToRef(l,e,t,a,s,d,i);return this}static Zero(){return new Xl(r.Zero(),r.Zero())}static CreateNew(l,e,t,a,s,d,i){return Xl.Zero().update(l,e,t,a,s,d,i)}static CreateNewFromTo(l,e,t=Y.IdentityReadOnly){const a=e.subtract(l),s=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);return a.normalize(),Xl.Transform(new Xl(l,a,s),t)}static Transform(l,e){const t=new Xl(new r(0,0,0),new r(0,0,0));return Xl.TransformToRef(l,e,t),t}static TransformToRef(l,e,t){r.TransformCoordinatesToRef(l.origin,e,t.origin),r.TransformNormalToRef(l.direction,e,t.direction),t.length=l.length;const a=t.direction,s=a.length();if(!(s===0||s===1)){const d=1/s;a.x*=d,a.y*=d,a.z*=d,t.length*=s}}unprojectRayToRef(l,e,t,a,s,d,i){var c;const n=f.Matrix[0];s.multiplyToRef(d,n),n.multiplyToRef(i,n),n.invert();const h=f.Vector3[0];h.x=l/t*2-1,h.y=-(e/a*2-1),h.z=!((c=bl.LastCreatedEngine)===null||c===void 0)&&c.isNDCHalfZRange?0:-1;const m=f.Vector3[1].copyFromFloats(h.x,h.y,1-1e-8),o=f.Vector3[2],b=f.Vector3[3];r._UnprojectFromInvertedMatrixToRef(h,n,o),r._UnprojectFromInvertedMatrixToRef(m,n,b),this.origin.copyFrom(o),b.subtractToRef(o,this.direction),this.direction.normalize()}}Xl._TmpVector3=_l.BuildArray(6,r.Zero);Xl._RayDistant=Xl.Zero();Xl._Smallnum=1e-8;Xl._Rayl=1e9;sl.prototype.createPickingRay=function(Z,l,e,t,a=!1){const s=Xl.Zero();return this.createPickingRayToRef(Z,l,e,s,t,a),s};sl.prototype.createPickingRayToRef=function(Z,l,e,t,a,s=!1,d=!1){const i=this.getEngine();if(!a){if(!this.activeCamera)return this;a=this.activeCamera}const c=a.viewport.toGlobal(i.getRenderWidth(),i.getRenderHeight());return Z=Z/i.getHardwareScalingLevel()-c.x,l=l/i.getHardwareScalingLevel()-(i.getRenderHeight()-c.y-c.height),t.update(Z,l,c.width,c.height,e||Y.IdentityReadOnly,s?Y.IdentityReadOnly:a.getViewMatrix(),a.getProjectionMatrix(),d),this};sl.prototype.createPickingRayInCameraSpace=function(Z,l,e){const t=Xl.Zero();return this.createPickingRayInCameraSpaceToRef(Z,l,t,e),t};sl.prototype.createPickingRayInCameraSpaceToRef=function(Z,l,e,t){if(!we)return this;const a=this.getEngine();if(!t){if(!this.activeCamera)throw new Error("Active camera not set");t=this.activeCamera}const s=t.viewport.toGlobal(a.getRenderWidth(),a.getRenderHeight()),d=Y.Identity();return Z=Z/a.getHardwareScalingLevel()-s.x,l=l/a.getHardwareScalingLevel()-(a.getRenderHeight()-s.y-s.height),e.update(Z,l,s.width,s.height,d,d,t.getProjectionMatrix()),this};sl.prototype._internalPickForMesh=function(Z,l,e,t,a,s,d,i){const c=l(t,e.enableDistantPicking),n=e.intersects(c,a,d,s,t,i);return!n||!n.hit||!a&&Z!=null&&n.distance>=Z.distance?null:n};sl.prototype._internalPick=function(Z,l,e,t,a){let s=null;for(let d=0;d<this.meshes.length;d++){const i=this.meshes[d];if(l){if(!l(i))continue}else if(!i.isEnabled()||!i.isVisible||!i.isPickable)continue;const c=i.getWorldMatrix();if(i.hasThinInstances&&i.thinInstanceEnablePicking){const n=this._internalPickForMesh(s,Z,i,c,!0,!0,a);if(n){if(t)return n;const h=f.Matrix[1],m=i.thinInstanceGetWorldMatrices();for(let o=0;o<m.length;o++){m[o].multiplyToRef(c,h);const b=this._internalPickForMesh(s,Z,i,h,e,t,a,!0);if(b&&(s=b,s.thinInstanceIndex=o,e))return s}}}else{const n=this._internalPickForMesh(s,Z,i,c,e,t,a);if(n&&(s=n,e))return s}}return s||new we};sl.prototype._internalMultiPick=function(Z,l,e){if(!we)return null;const t=new Array;for(let a=0;a<this.meshes.length;a++){const s=this.meshes[a];if(l){if(!l(s))continue}else if(!s.isEnabled()||!s.isVisible||!s.isPickable)continue;const d=s.getWorldMatrix();if(s.hasThinInstances&&s.thinInstanceEnablePicking){if(this._internalPickForMesh(null,Z,s,d,!0,!0,e)){const i=f.Matrix[1],c=s.thinInstanceGetWorldMatrices();for(let n=0;n<c.length;n++){c[n].multiplyToRef(d,i);const h=this._internalPickForMesh(null,Z,s,i,!1,!1,e,!0);h&&(h.thinInstanceIndex=n,t.push(h))}}}else{const i=this._internalPickForMesh(null,Z,s,d,!1,!1,e);i&&t.push(i)}}return t};sl.prototype.pickWithBoundingInfo=function(Z,l,e,t,a){if(!we)return null;const s=this._internalPick(d=>(this._tempPickingRay||(this._tempPickingRay=Xl.Zero()),this.createPickingRayToRef(Z,l,d,this._tempPickingRay,a||null),this._tempPickingRay),e,t,!0);return s&&(s.ray=this.createPickingRay(Z,l,Y.Identity(),a||null)),s};Object.defineProperty(sl.prototype,"_pickingAvailable",{get:()=>!0,enumerable:!1,configurable:!1});sl.prototype.pick=function(Z,l,e,t,a,s,d=!1){const i=this._internalPick((c,n)=>(this._tempPickingRay||(this._tempPickingRay=Xl.Zero()),this.createPickingRayToRef(Z,l,c,this._tempPickingRay,a||null,!1,n),this._tempPickingRay),e,t,!1,s);return i&&(i.ray=this.createPickingRay(Z,l,Y.Identity(),a||null)),i};sl.prototype.pickWithRay=function(Z,l,e,t){const a=this._internalPick(s=>(this._pickWithRayInverseMatrix||(this._pickWithRayInverseMatrix=Y.Identity()),s.invertToRef(this._pickWithRayInverseMatrix),this._cachedRayForTransform||(this._cachedRayForTransform=Xl.Zero()),Xl.TransformToRef(Z,this._pickWithRayInverseMatrix,this._cachedRayForTransform),this._cachedRayForTransform),l,e,!1,t);return a&&(a.ray=Z),a};sl.prototype.multiPick=function(Z,l,e,t,a){return this._internalMultiPick(s=>this.createPickingRay(Z,l,s,t||null),e,a)};sl.prototype.multiPickWithRay=function(Z,l,e){return this._internalMultiPick(t=>(this._pickWithRayInverseMatrix||(this._pickWithRayInverseMatrix=Y.Identity()),t.invertToRef(this._pickWithRayInverseMatrix),this._cachedRayForTransform||(this._cachedRayForTransform=Xl.Zero()),Xl.TransformToRef(Z,this._pickWithRayInverseMatrix,this._cachedRayForTransform),this._cachedRayForTransform),l,e)};j.prototype.getForwardRay=function(Z=100,l,e){return this.getForwardRayToRef(new Xl(r.Zero(),r.Zero(),Z),Z,l,e)};j.prototype.getForwardRayToRef=function(Z,l=100,e,t){return e||(e=this.getWorldMatrix()),Z.length=l,t?Z.origin.copyFrom(t):Z.origin.copyFrom(this.position),f.Vector3[2].set(0,0,this._scene.useRightHandedSystem?-1:1),r.TransformNormalToRef(f.Vector3[2],e,f.Vector3[3]),r.NormalizeToRef(f.Vector3[3],Z.direction),Z};var kh=function(Z,l,e){for(var t in l)if(Z.name===l[t])return e.push(Z.id),!0;return Z.parentId&&e.indexOf(Z.parentId)!==-1?(e.push(Z.id),!0):!1},da=function(Z,l){return Z+" of "+(l?l.file+" from "+l.name+" version: "+l.version+", exporter version: "+l.exporter_version:"unknown")};cl.RegisterPlugin({name:"babylon.js",extensions:".json",canDirectLoad:function(Z){return Z.indexOf("json"),!0},importMesh:function(Z,l,e,t,a,s,d,i){var c="importMesh has failed JSON parse";try{var n=JSON.parse(e);n.physicsEnabled=!1,n==null||n.meshes.map(y=>delete y.physicsImpostor),c="";var h=cl.loggingLevel===cl.DETAILED_LOGGING;Z?Array.isArray(Z)||(Z=[Z]):Z=null;var m=new Array;if(n.meshes!==void 0&&n.meshes!==null){var o,b;for(o=0,b=n.meshes.length;o<b;o++){var u=n.meshes[o];if(Z===null||kh(u,Z,m)){Z!==null&&delete Z[Z.indexOf(u.name)];var V=E.Parse(u,l,t);a.push(V),c+=`
	Mesh `+V.toString(h)}}var G;for(o=0,b=l.meshes.length;o<b;o++)G=l.meshes[o],G._waitingParentId&&(G.parent=l.getLastEntryByID(G._waitingParentId),G._waitingParentId=null),G.computeWorldMatrix(!0)}return!0}catch(y){var p=da("importMesh",n?n.producer:"Unknown")+c;if(i)i(p,y);else throw M.Log(p),y}finally{c!==null&&cl.loggingLevel!==cl.NO_LOGGING&&M.Log(da("importMesh",n?n.producer:"Unknown")+(cl.loggingLevel!==cl.MINIMAL_LOGGING?c:""))}return!1},load:function(Z,l,e,t){var a="importScene has failed JSON parse";try{var s=JSON.parse(l);a="",s.clearColor!==void 0&&s.clearColor!==null&&(Z.clearColor=Color4.FromArray(s.clearColor));var d=loadAssetContainer(Z,l,e,t,!0);return!!d}catch(c){var i=da("importScene",s?s.producer:"Unknown")+a;if(t)t(i,c);else throw M.Log(i),c}finally{a!==null&&cl.loggingLevel!==cl.NO_LOGGING&&M.Log(da("importScene",s?s.producer:"Unknown")+(cl.loggingLevel!==cl.MINIMAL_LOGGING?a:""))}return!1},loadAssetContainer:function(Z,l,e,t){var a=loadAssetContainer(Z,l,e,t);return a}});E._instancedMeshFactory=(Z,l)=>{const e=new Hh(Z,l);if(l.instancedBuffers){e.instancedBuffers={};for(const t in l.instancedBuffers)e.instancedBuffers[t]=l.instancedBuffers[t]}return e};class Hh extends me{constructor(l,e){super(l,e.getScene()),this._indexInSourceMeshInstanceArray=-1,this._distanceToCamera=0,e.addInstance(this),this._sourceMesh=e,this._unIndexed=e._unIndexed,this.position.copyFrom(e.position),this.rotation.copyFrom(e.rotation),this.scaling.copyFrom(e.scaling),e.rotationQuaternion&&(this.rotationQuaternion=e.rotationQuaternion.clone()),this.animations=e.animations.slice();for(const t of e.getAnimationRanges())t!=null&&this.createAnimationRange(t.name,t.from,t.to);this.infiniteDistance=e.infiniteDistance,this.setPivotMatrix(e.getPivotMatrix()),this.refreshBoundingInfo(!0,!0),this._syncSubMeshes()}getClassName(){return"InstancedMesh"}get lightSources(){return this._sourceMesh._lightSources}_resyncLightSources(){}_resyncLightSource(){}_removeLightSource(){}get receiveShadows(){return this._sourceMesh.receiveShadows}get material(){return this._sourceMesh.material}get visibility(){return this._sourceMesh.visibility}get skeleton(){return this._sourceMesh.skeleton}get renderingGroupId(){return this._sourceMesh.renderingGroupId}set renderingGroupId(l){!this._sourceMesh||l===this._sourceMesh.renderingGroupId||M.Warn("Note - setting renderingGroupId of an instanced mesh has no effect on the scene")}getTotalVertices(){return this._sourceMesh?this._sourceMesh.getTotalVertices():0}getTotalIndices(){return this._sourceMesh.getTotalIndices()}get sourceMesh(){return this._sourceMesh}createInstance(l){return this._sourceMesh.createInstance(l)}isReady(l=!1){return this._sourceMesh.isReady(l,!0)}getVerticesData(l,e){return this._sourceMesh.getVerticesData(l,e)}setVerticesData(l,e,t,a){return this.sourceMesh&&this.sourceMesh.setVerticesData(l,e,t,a),this.sourceMesh}updateVerticesData(l,e,t,a){return this.sourceMesh&&this.sourceMesh.updateVerticesData(l,e,t,a),this.sourceMesh}setIndices(l,e=null){return this.sourceMesh&&this.sourceMesh.setIndices(l,e),this.sourceMesh}isVerticesDataPresent(l){return this._sourceMesh.isVerticesDataPresent(l)}getIndices(){return this._sourceMesh.getIndices()}get _positions(){return this._sourceMesh._positions}refreshBoundingInfo(l=!1,e=!1){if(this.hasBoundingInfo&&this.getBoundingInfo().isLocked)return this;const t=this._sourceMesh.geometry?this._sourceMesh.geometry.boundingBias:null;return this._refreshBoundingInfo(this._sourceMesh._getPositionData(l,e),t),this}_preActivate(){return this._currentLOD&&this._currentLOD._preActivate(),this}_activate(l,e){if(super._activate(l,e),this._sourceMesh.subMeshes||M.Warn("Instances should only be created for meshes with geometry."),this._currentLOD){if(this._currentLOD._getWorldMatrixDeterminant()>=0!=this._getWorldMatrixDeterminant()>=0)return this._internalAbstractMeshDataInfo._actAsRegularMesh=!0,!0;if(this._internalAbstractMeshDataInfo._actAsRegularMesh=!1,this._currentLOD._registerInstanceForRenderId(this,l),e){if(!this._currentLOD._internalAbstractMeshDataInfo._isActiveIntermediate)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!0,!0}else if(!this._currentLOD._internalAbstractMeshDataInfo._isActive)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstances=!0,!0}return!1}_postActivate(){this._sourceMesh.edgesShareWithInstances&&this._sourceMesh._edgesRenderer&&this._sourceMesh._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup?(this._sourceMesh._renderingGroup._edgesRenderers.pushNoDuplicate(this._sourceMesh._edgesRenderer),this._sourceMesh._edgesRenderer.customInstances.push(this.getWorldMatrix())):this._edgesRenderer&&this._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup&&this._sourceMesh._renderingGroup._edgesRenderers.push(this._edgesRenderer)}getWorldMatrix(){if(this._currentLOD&&this._currentLOD.billboardMode!==q.BILLBOARDMODE_NONE&&this._currentLOD._masterMesh!==this){this._billboardWorldMatrix||(this._billboardWorldMatrix=new Y);const l=this._currentLOD._masterMesh;return this._currentLOD._masterMesh=this,f.Vector3[7].copyFrom(this._currentLOD.position),this._currentLOD.position.set(0,0,0),this._billboardWorldMatrix.copyFrom(this._currentLOD.computeWorldMatrix(!0)),this._currentLOD.position.copyFrom(f.Vector3[7]),this._currentLOD._masterMesh=l,this._billboardWorldMatrix}return super.getWorldMatrix()}get isAnInstance(){return!0}getLOD(l){if(!l)return this;const e=this.sourceMesh.getLODLevels();if(!e||e.length===0)this._currentLOD=this.sourceMesh;else{const t=this.getBoundingInfo();this._currentLOD=this.sourceMesh.getLOD(l,t.boundingSphere)}return this._currentLOD}_preActivateForIntermediateRendering(l){return this.sourceMesh._preActivateForIntermediateRendering(l)}_syncSubMeshes(){if(this.releaseSubMeshes(),this._sourceMesh.subMeshes)for(let l=0;l<this._sourceMesh.subMeshes.length;l++)this._sourceMesh.subMeshes[l].clone(this,this._sourceMesh);return this}_generatePointsArray(){return this._sourceMesh._generatePointsArray()}_updateBoundingInfo(){return this.hasBoundingInfo?this.getBoundingInfo().update(this.worldMatrixFromCache):this.buildBoundingInfo(this.absolutePosition,this.absolutePosition,this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}clone(l,e=null,t,a){const s=(a||this._sourceMesh).createInstance(l);if(rs.DeepCopy(this,s,["name","subMeshes","uniqueId","parent","lightSources","receiveShadows","material","visibility","skeleton","sourceMesh","isAnInstance","facetNb","isFacetDataEnabled","isBlocked","useBones","hasInstances","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","isWorldMatrixFrozen","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","hasBoundingInfo"],[]),this.refreshBoundingInfo(),e&&(s.parent=e),!t)for(let d=0;d<this.getScene().meshes.length;d++){const i=this.getScene().meshes[d];i.parent===this&&i.clone(i.name,s)}return s.computeWorldMatrix(!0),this.onClonedObservable.notifyObservers(s),s}dispose(l,e=!1){this._sourceMesh.removeInstance(this),super.dispose(l,e)}_serializeAsParent(l){super._serializeAsParent(l),l.parentId=this._sourceMesh.uniqueId,l.parentInstanceIndex=this._indexInSourceMeshInstanceArray}instantiateHierarchy(l=null,e,t){const a=this.clone("Clone of "+(this.name||this.id),l||this.parent,!0,e&&e.newSourcedMesh);a&&t&&t(this,a);for(const s of this.getChildTransformNodes(!0))s.instantiateHierarchy(a,e,t);return a}}E.prototype.registerInstancedBuffer=function(Z,l){var e,t;if((t=(e=this._userInstancedBuffersStorage)===null||e===void 0?void 0:e.vertexBuffers[Z])===null||t===void 0||t.dispose(),!this.instancedBuffers){this.instancedBuffers={};for(const a of this.instances)a.instancedBuffers={};this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0})}this.instancedBuffers[Z]=null,this._userInstancedBuffersStorage.strides[Z]=l,this._userInstancedBuffersStorage.sizes[Z]=l*32,this._userInstancedBuffersStorage.data[Z]=new Float32Array(this._userInstancedBuffersStorage.sizes[Z]),this._userInstancedBuffersStorage.vertexBuffers[Z]=new X(this.getEngine(),this._userInstancedBuffersStorage.data[Z],Z,!0,!1,l,!0);for(const a of this.instances)a.instancedBuffers[Z]=null;this._invalidateInstanceVertexArrayObject(),this._markSubMeshesAsAttributesDirty()};E.prototype._processInstancedBuffers=function(Z,l){const e=Z?Z.length:0;for(const t in this.instancedBuffers){let a=this._userInstancedBuffersStorage.sizes[t];const s=this._userInstancedBuffersStorage.strides[t],d=(e+1)*s;for(;a<d;)a*=2;this._userInstancedBuffersStorage.data[t].length!=a&&(this._userInstancedBuffersStorage.data[t]=new Float32Array(a),this._userInstancedBuffersStorage.sizes[t]=a,this._userInstancedBuffersStorage.vertexBuffers[t]&&(this._userInstancedBuffersStorage.vertexBuffers[t].dispose(),this._userInstancedBuffersStorage.vertexBuffers[t]=null));const i=this._userInstancedBuffersStorage.data[t];let c=0;if(l){const n=this.instancedBuffers[t];n.toArray?n.toArray(i,c):n.copyToArray?n.copyToArray(i,c):i[c]=n,c+=s}for(let n=0;n<e;n++){const h=Z[n].instancedBuffers[t];h.toArray?h.toArray(i,c):h.copyToArray?h.copyToArray(i,c):i[c]=h,c+=s}this._userInstancedBuffersStorage.vertexBuffers[t]?this._userInstancedBuffersStorage.vertexBuffers[t].updateDirectly(i,0):(this._userInstancedBuffersStorage.vertexBuffers[t]=new X(this.getEngine(),this._userInstancedBuffersStorage.data[t],t,!0,!1,s,!0),this._invalidateInstanceVertexArrayObject())}};E.prototype._invalidateInstanceVertexArrayObject=function(){if(!(!this._userInstancedBuffersStorage||this._userInstancedBuffersStorage.vertexArrayObjects===void 0)){for(const Z in this._userInstancedBuffersStorage.vertexArrayObjects)this.getEngine().releaseVertexArrayObject(this._userInstancedBuffersStorage.vertexArrayObjects[Z]);this._userInstancedBuffersStorage.vertexArrayObjects={}}};E.prototype._disposeInstanceSpecificData=function(){for(this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null);this.instances.length;)this.instances[0].dispose();for(const Z in this.instancedBuffers)this._userInstancedBuffersStorage.vertexBuffers[Z]&&this._userInstancedBuffersStorage.vertexBuffers[Z].dispose();this._invalidateInstanceVertexArrayObject(),this.instancedBuffers={}};const Ih={assetPath:"",enableShadows:!1,groupId:null,id:null,lights:[],rollId:null,scene:null},qe=class{constructor(Z,l){Le(this,"value",0),Le(this,"asleep",!1),this.config={...Ih,...Z},this.id=this.config.id!==void 0?this.config.id:Date.now(),this.sides=this.config.sides,this.dieType=this.config.dieType,this.comboKey=`${this.config.theme}_${this.config.dieType}`,this.scene=l,this.createInstance()}createInstance(){const Z=`${this.config.meshName}_${this.dieType}_${this.config.theme}${this.config.colorSuffix}`,l=`${Z}-instance-${this.id}`,e=this.scene.getMeshByName(Z).createInstance(l);if(this.config.colorSuffix.length>0){const t=al.FromHexString(this.config.themeColor);e.instancedBuffers.customColor=t}e.position.y=-100,e.scaling=new r(e.scaling.x*this.config.scale,e.scaling.y*this.config.scale,e.scaling.z*this.config.scale),this.config.enableShadows&&this.config.lights.directional.shadowGenerator.addShadowCaster(e),this.mesh=e}static async loadDie(Z,l){const{sides:e,theme:t="default",meshName:a,colorSuffix:s}=Z;Z.dieType||(Z.dieType=Number.isInteger(e)?`d${e}`:e);const d=a+"_"+Z.dieType,i=d+"_"+t+s;let c=l.getMeshByName(i);return c||(c=l.getMeshByName(d).clone(i)),c.material||(c.material=l.getMaterialByName(t+s),s.length>0&&c.registerInstancedBuffer("customColor",3)),Z}static async loadModels(Z,l){const{meshFilePath:e,meshName:t,scale:a,d4FaceDown:s=!0}=Z;let d=!1,i=!1;const c=await fetch(`${e}`).then(n=>{if(n.ok){const h=n.headers.get("content-type");if(h&&h.indexOf("application/json")!==-1||n.type&&n.type==="basic")return n.json();throw new Error(`Incorrect contentType: ${h}. Expected "application/json" or "basic"`)}else throw new Error(`Unable to load 3D mesh file: '${e}'. Request rejected with status ${n.status}: ${n.statusText}`)}).catch(n=>console.error(n));if(c)return cl.ImportMeshAsync(null,null,"data:"+JSON.stringify(c),l).then(n=>{if(n.meshes.forEach(h=>{h.name==="__root__"&&h.dispose(),h.name.includes("collider")&&(h.scaling=new r(h.scaling.x*.9,h.scaling.y*.9,h.scaling.z*.9)),d||(d=h.name==="d100"),i||(i=h.name==="d10"),h.setEnabled(!1),h.freezeNormals(),h.freezeWorldMatrix(),h.isPickable=!1,h.doNotSyncBoundingInfo=!0,h.name=t+"_"+h.name}),!d&&i&&(l.getMeshByName(t+"_d10").clone(t+"_d100"),l.getMeshByName(t+"_d10_collider").clone(t+"_d100_collider"),c.colliderFaceMap&&(c.colliderFaceMap.d100=sd(c.colliderFaceMap.d10),Object.values(c.colliderFaceMap.d100).forEach((h,m)=>{c.colliderFaceMap.d100[m]=h*(h===10?0:10)}))),!c.colliderFaceMap)throw new Error(`'colliderFaceMap' data not found in ${e}. Without the colliderFaceMap data dice values can not be resolved.`);l.themeData[t]={},l.themeData[t].colliderFaceMap=c.colliderFaceMap,l.themeData[t].d4FaceDown=s}).catch(n=>console.error(n)),c.meshes.filter(n=>n.name.includes("collider"))}updateConfig(Z){this.config={...this.config,...Z}}static setVector3(Z,l,e){return qe.vector3.set(Z,l,e)}static getVector3(){return qe.vector3}static async getRollResult(Z,l){const e=(t=Z)=>new Promise((a,s)=>{const d=Z.config.parentMesh||Z.config.meshName,i=l.themeData[d].colliderFaceMap,c=l.themeData[d].d4FaceDown;if(!i[t.dieType])throw new Error(`No colliderFaceMap data for ${t.dieType}`);const n=l.getMeshByName(`${d}_${t.dieType}_collider`).createInstance(`${d}_${t.dieType}-hitbox-${t.id}`);n.isPickable=!0,n.isVisible=!0,n.setEnabled(!0),n.position=t.mesh.position,n.rotationQuaternion=t.mesh.rotationQuaternion;let h=qe.setVector3(0,1,0);t.dieType==="d4"&&c&&(h=qe.setVector3(0,-1,0)),qe.ray.direction=h,qe.ray.origin=Z.mesh.position;const m=l.pickWithRay(qe.ray);if(n.dispose(),t.value=i[t.dieType][m.faceId],t.value===void 0)throw new Error(`colliderFaceMap Error: No value found for ${t.dieType} mesh face ${m.faceId}`);return a(t.value)}).catch(a=>console.error(a));return Z.mesh?await e():Z.value}};let tt=qe;Le(tt,"ray",new Xl(r.Zero(),r.Zero(),1)),Le(tt,"vector3",r.Zero());class Eh{constructor(){}}class it extends C{constructor(l,e){super(l,e),this.CustomParts=new Eh,this.customShaderNameResolve=this.Builder,this.FragmentShader=Tl.ShadersStore.defaultPixelShader,this.VertexShader=Tl.ShadersStore.defaultVertexShader}AttachAfterBind(l,e){if(this._newUniformInstances)for(const t in this._newUniformInstances){const a=t.toString().split("-");a[0]=="vec2"?e.setVector2(a[1],this._newUniformInstances[t]):a[0]=="vec3"?e.setVector3(a[1],this._newUniformInstances[t]):a[0]=="vec4"?e.setVector4(a[1],this._newUniformInstances[t]):a[0]=="mat4"?e.setMatrix(a[1],this._newUniformInstances[t]):a[0]=="float"&&e.setFloat(a[1],this._newUniformInstances[t])}if(this._newSamplerInstances)for(const t in this._newSamplerInstances){const a=t.toString().split("-");a[0]=="sampler2D"&&this._newSamplerInstances[t].isReady&&this._newSamplerInstances[t].isReady()&&e.setTexture(a[1],this._newSamplerInstances[t])}}ReviewUniform(l,e){if(l=="uniform"&&this._newUniforms)for(let t=0;t<this._newUniforms.length;t++)this._customUniform[t].indexOf("sampler")==-1&&e.push(this._newUniforms[t]);if(l=="sampler"&&this._newUniforms)for(let t=0;t<this._newUniforms.length;t++)this._customUniform[t].indexOf("sampler")!=-1&&e.push(this._newUniforms[t]);return e}Builder(l,e,t,a,s,d){if(d&&this._customAttributes&&this._customAttributes.length>0&&d.push(...this._customAttributes),this.ReviewUniform("uniform",e),this.ReviewUniform("sampler",a),this._isCreatedShader)return this._createdShaderName;this._isCreatedShader=!1,it.ShaderIndexer++;const i="custom_"+it.ShaderIndexer,c=this._afterBind.bind(this);return this._afterBind=(n,h)=>{if(h){this.AttachAfterBind(n,h);try{c(n,h)}catch{}}},Tl.ShadersStore[i+"VertexShader"]=this.VertexShader.replace("#define CUSTOM_VERTEX_BEGIN",this.CustomParts.Vertex_Begin?this.CustomParts.Vertex_Begin:"").replace("#define CUSTOM_VERTEX_DEFINITIONS",(this._customUniform?this._customUniform.join(`
`):"")+(this.CustomParts.Vertex_Definitions?this.CustomParts.Vertex_Definitions:"")).replace("#define CUSTOM_VERTEX_MAIN_BEGIN",this.CustomParts.Vertex_MainBegin?this.CustomParts.Vertex_MainBegin:"").replace("#define CUSTOM_VERTEX_UPDATE_POSITION",this.CustomParts.Vertex_Before_PositionUpdated?this.CustomParts.Vertex_Before_PositionUpdated:"").replace("#define CUSTOM_VERTEX_UPDATE_NORMAL",this.CustomParts.Vertex_Before_NormalUpdated?this.CustomParts.Vertex_Before_NormalUpdated:"").replace("#define CUSTOM_VERTEX_MAIN_END",this.CustomParts.Vertex_MainEnd?this.CustomParts.Vertex_MainEnd:""),this.CustomParts.Vertex_After_WorldPosComputed&&(Tl.ShadersStore[i+"VertexShader"]=Tl.ShadersStore[i+"VertexShader"].replace("#define CUSTOM_VERTEX_UPDATE_WORLDPOS",this.CustomParts.Vertex_After_WorldPosComputed)),Tl.ShadersStore[i+"PixelShader"]=this.FragmentShader.replace("#define CUSTOM_FRAGMENT_BEGIN",this.CustomParts.Fragment_Begin?this.CustomParts.Fragment_Begin:"").replace("#define CUSTOM_FRAGMENT_MAIN_BEGIN",this.CustomParts.Fragment_MainBegin?this.CustomParts.Fragment_MainBegin:"").replace("#define CUSTOM_FRAGMENT_DEFINITIONS",(this._customUniform?this._customUniform.join(`
`):"")+(this.CustomParts.Fragment_Definitions?this.CustomParts.Fragment_Definitions:"")).replace("#define CUSTOM_FRAGMENT_UPDATE_DIFFUSE",this.CustomParts.Fragment_Custom_Diffuse?this.CustomParts.Fragment_Custom_Diffuse:"").replace("#define CUSTOM_FRAGMENT_UPDATE_ALPHA",this.CustomParts.Fragment_Custom_Alpha?this.CustomParts.Fragment_Custom_Alpha:"").replace("#define CUSTOM_FRAGMENT_BEFORE_LIGHTS",this.CustomParts.Fragment_Before_Lights?this.CustomParts.Fragment_Before_Lights:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR",this.CustomParts.Fragment_Before_FragColor?this.CustomParts.Fragment_Before_FragColor:"").replace("#define CUSTOM_FRAGMENT_MAIN_END",this.CustomParts.Fragment_MainEnd?this.CustomParts.Fragment_MainEnd:""),this.CustomParts.Fragment_Before_Fog&&(Tl.ShadersStore[i+"PixelShader"]=Tl.ShadersStore[i+"PixelShader"].replace("#define CUSTOM_FRAGMENT_BEFORE_FOG",this.CustomParts.Fragment_Before_Fog)),this._isCreatedShader=!0,this._createdShaderName=i,i}AddUniform(l,e,t){return this._customUniform||(this._customUniform=new Array,this._newUniforms=new Array,this._newSamplerInstances={},this._newUniformInstances={}),t&&(e.indexOf("sampler")!=-1?this._newSamplerInstances[e+"-"+l]=t:this._newUniformInstances[e+"-"+l]=t),this._customUniform.push("uniform "+e+" "+l+";"),this._newUniforms.push(l),this}AddAttribute(l){return this._customAttributes||(this._customAttributes=[]),this._customAttributes.push(l),this}Fragment_Begin(l){return this.CustomParts.Fragment_Begin=l,this}Fragment_Definitions(l){return this.CustomParts.Fragment_Definitions=l,this}Fragment_MainBegin(l){return this.CustomParts.Fragment_MainBegin=l,this}Fragment_MainEnd(l){return this.CustomParts.Fragment_MainEnd=l,this}Fragment_Custom_Diffuse(l){return this.CustomParts.Fragment_Custom_Diffuse=l.replace("result","diffuseColor"),this}Fragment_Custom_Alpha(l){return this.CustomParts.Fragment_Custom_Alpha=l.replace("result","alpha"),this}Fragment_Before_Lights(l){return this.CustomParts.Fragment_Before_Lights=l,this}Fragment_Before_Fog(l){return this.CustomParts.Fragment_Before_Fog=l,this}Fragment_Before_FragColor(l){return this.CustomParts.Fragment_Before_FragColor=l.replace("result","color"),this}Vertex_Begin(l){return this.CustomParts.Vertex_Begin=l,this}Vertex_Definitions(l){return this.CustomParts.Vertex_Definitions=l,this}Vertex_MainBegin(l){return this.CustomParts.Vertex_MainBegin=l,this}Vertex_Before_PositionUpdated(l){return this.CustomParts.Vertex_Before_PositionUpdated=l.replace("result","positionUpdated"),this}Vertex_Before_NormalUpdated(l){return this.CustomParts.Vertex_Before_NormalUpdated=l.replace("result","normalUpdated"),this}Vertex_After_WorldPosComputed(l){return this.CustomParts.Vertex_After_WorldPosComputed=l,this}Vertex_MainEnd(l){return this.CustomParts.Vertex_MainEnd=l,this}}it.ShaderIndexer=1;ce("BABYLON.CustomMaterial",it);it.prototype.clone=function(Z){const l=this,e=il.Clone(()=>new it(Z,this.getScene()),this);return e.name=Z,e.id=Z,e.CustomParts.Fragment_Begin=l.CustomParts.Fragment_Begin,e.CustomParts.Fragment_Definitions=l.CustomParts.Fragment_Definitions,e.CustomParts.Fragment_MainBegin=l.CustomParts.Fragment_MainBegin,e.CustomParts.Fragment_Custom_Diffuse=l.CustomParts.Fragment_Custom_Diffuse,e.CustomParts.Fragment_Before_Lights=l.CustomParts.Fragment_Before_Lights,e.CustomParts.Fragment_Before_Fog=l.CustomParts.Fragment_Before_Fog,e.CustomParts.Fragment_Custom_Alpha=l.CustomParts.Fragment_Custom_Alpha,e.CustomParts.Fragment_Before_FragColor=l.CustomParts.Fragment_Before_FragColor,e.CustomParts.Vertex_Begin=l.CustomParts.Vertex_Begin,e.CustomParts.Vertex_Definitions=l.CustomParts.Vertex_Definitions,e.CustomParts.Vertex_MainBegin=l.CustomParts.Vertex_MainBegin,e.CustomParts.Vertex_Before_PositionUpdated=l.CustomParts.Vertex_Before_PositionUpdated,e.CustomParts.Vertex_Before_NormalUpdated=l.CustomParts.Vertex_Before_NormalUpdated,e.CustomParts.Vertex_After_WorldPosComputed=l.CustomParts.Vertex_After_WorldPosComputed,e.CustomParts.Vertex_MainEnd=l.CustomParts.Vertex_MainEnd,e};class Kh{constructor(l){Le(this,"loadedThemes",{}),Le(this,"themeData",{}),this.scene=l.scene}async loadStandardMaterial(l){const{theme:e,material:t}=l,a=new C(e,this.scene);t.diffuseTexture&&(a.diffuseTexture=await this.getTexture("diffuse",l)),t.bumpTexture&&(a.bumpTexture=await this.getTexture("bump",l)),t.specularTexture&&(a.specularTexture=await this.getTexture("specular",l)),a.allowShaderHotSwapping=!1}async loadColorMaterial(l){const{theme:e,material:t}=l,a=new it(e+"_light",this.scene),s=sd(l);t.diffuseTexture&&t.diffuseTexture.light&&(s.material.diffuseTexture=l.material.diffuseTexture.light,a.diffuseTexture=await this.getTexture("diffuse",s)),t.bumpTexture&&(a.bumpTexture=await this.getTexture("bump",l)),t.specularTexture&&(a.specularTexture=await this.getTexture("specular",l)),a.allowShaderHotSwapping=!1,a.Vertex_Definitions(`
      attribute vec3 customColor;
      varying vec3 vColor;
    `).Vertex_MainEnd(`
      vColor = customColor;
    `).Fragment_Definitions(`
      varying vec3 vColor;
    `).Fragment_Custom_Diffuse(`
      baseColor.rgb = mix(vColor.rgb, baseColor.rgb, baseColor.a);
    `),a.AddAttribute("customColor");const d=a.clone(e+"_dark");t.diffuseTexture&&t.diffuseTexture.dark&&(s.material.diffuseTexture=l.material.diffuseTexture.dark,d.diffuseTexture=await this.getTexture("diffuse",s)),d.AddAttribute("customColor")}async getTexture(l,e){const{basePath:t,material:a,theme:s}=e;let d;const i=l+"Level",c=l+"Texture";try{switch(l){case"diffuse":d=await this.importTextureAsync(`${t}/${a[c]}`,s),a[i]&&(d.level=a[i]);break;case"bump":d=await this.importTextureAsync(`${t}/${a[c]}`,s),a[i]&&(d.level=a[i]);break;case"specular":d=await this.importTextureAsync(`${t}/${a[c]}`,s),a.specularPower&&(d.specularPower=a.specularPower);break;default:throw new Error(`Texture type: ${l} is not supported`)}}catch(n){console.error(n)}return d}async importTextureAsync(l,e){return new Promise((t,a)=>{let s=l.match(/^(.*\/)(.*)$/),d=new v(l,this.scene,void 0,!0,void 0,()=>t(d),()=>a(`Unable to load texture '${s[2]}' for theme: '${e}'. Check that your assetPath is configured correctly and that the files exist at path: '${s[1]}'`))}).catch(t=>console.error(t))}async load(l){const{material:e}=l;e.type==="color"?await this.loadColorMaterial(l):e.type==="standard"?await this.loadStandardMaterial(l):console.error(`Material type: ${e.type} not supported`)}}var Ql,vt,He,kt,Je,Ne,$l,hs,xe,ma,oa,Ve,ba,ms,fd;class Bh{constructor(l){ne(this,ms),Le(this,"config"),Le(this,"initialized",!1),ne(this,Ql,{}),ne(this,vt,0),ne(this,He,0),ne(this,kt,[]),ne(this,Je,void 0),ne(this,Ne,void 0),ne(this,$l,void 0),ne(this,hs,void 0),ne(this,xe,void 0),ne(this,ma,void 0),ne(this,oa,void 0),ne(this,Ve,void 0),ne(this,ba,{}),Le(this,"noop",()=>{}),Le(this,"diceBufferView",new Float32Array(8e3)),this.onInitComplete=l.onInitComplete||this.noop,this.onThemeLoaded=l.onThemeLoaded||this.noop,this.onRollResult=l.onRollResult||this.noop,this.onRollComplete=l.onRollComplete||this.noop,this.onDieRemoved=l.onDieRemoved||this.noop,this.initialized=this.initScene(l)}async initScene(l){oe(this,Je,l.canvas),w(this,Je).width=l.width,w(this,Je).height=l.height,this.config=l.options,oe(this,Ne,Yi(w(this,Je))),oe(this,$l,tc({engine:w(this,Ne)})),oe(this,hs,ac({engine:w(this,Ne),scene:w(this,$l)})),oe(this,xe,ed({enableShadows:this.config.enableShadows,shadowTransparency:this.config.shadowTransparency,intensity:this.config.lightIntensity,scene:w(this,$l)})),oe(this,ma,new vh({enableShadows:this.config.enableShadows,aspect:w(this,Je).width/w(this,Je).height,lights:w(this,xe),scene:w(this,$l)})),oe(this,oa,new Kh({scene:w(this,$l)})),this.onInitComplete()}connect(l){oe(this,Ve,l),w(this,Ve).postMessage({action:"initBuffer",diceBuffer:this.diceBufferView.buffer},[this.diceBufferView.buffer]),w(this,Ve).onmessage=e=>{switch(e.data.action){case"updates":this.updatesFromPhysics(e.data.diceBuffer);break;default:console.error("action from physicsWorker not found in offscreen worker");break}}}updateConfig(l){const e=this.config;this.config=l,e.enableShadows!==this.config.enableShadows&&(Object.values(w(this,xe)).forEach(t=>t.dispose()),oe(this,xe,ed({enableShadows:this.config.enableShadows}))),e.scale!==this.config.scale&&Object.values(w(this,Ql)).forEach(({mesh:t})=>{t&&(t.scaling=new r(this.config.scale,this.config.scale,this.config.scale))}),e.shadowTransparency!==this.config.shadowTransparency&&(w(this,xe).directional.shadowGenerator.darkness=this.config.shadowTransparency),e.lightIntensity!==this.config.lightIntensity&&(w(this,xe).directional.intensity=.65*this.config.lightIntensity,w(this,xe).hemispheric.intensity=.4*this.config.lightIntensity)}render(l){w(this,Ne).runRenderLoop(this.renderLoop.bind(this)),w(this,Ve).postMessage({action:"resumeSimulation",newStartPoint:l})}renderLoop(){w(this,He)&&w(this,He)===Object.keys(w(this,Ql)).length?(w(this,Ne).stopRenderLoop(),w(this,Ve).postMessage({action:"stopSimulation"}),this.onRollComplete()):w(this,$l).render()}async loadTheme(l){const{theme:e,basePath:t,material:a,meshFilePath:s,meshName:d}=l;if(await w(this,oa).load({theme:e,basePath:t,material:a}),!Object.keys(w(this,ba)).includes(d)){w(this,ba)[d]=s;const i=await tt.loadModels({meshFilePath:s,meshName:d},w(this,$l));if(!i)throw new Error("No colliders returned from the 3D mesh file. Low poly colliders are expected to be in the same file as the high poly dice and the mesh name contains the word 'collider'");w(this,Ve).postMessage({action:"loadModels",options:{colliders:i,meshName:d}})}this.onThemeLoaded({id:e})}clear(){!Object.keys(w(this,Ql)).length&&!w(this,He)||(this.diceBufferView.byteLength&&this.diceBufferView.fill(0),w(this,kt).forEach(l=>clearTimeout(l)),w(this,Ne).stopRenderLoop(),Object.values(w(this,Ql)).forEach(l=>{l.mesh&&l.mesh.dispose()}),oe(this,Ql,{}),oe(this,vt,0),oe(this,He,0),w(this,$l).render())}add(l){tt.loadDie(l,w(this,$l)).then(e=>{w(this,kt).push(setTimeout(()=>{qd(this,ms,fd).call(this,e)},gt(this,vt)._++*this.config.delay))})}addNonDie(l){w(this,Ne).activeRenderLoops.length===0&&this.render(!1);const{id:e,value:t,...a}=l,s={id:e,value:t,config:a};w(this,Ql)[e]=s,setTimeout(()=>{w(this,kt).push(setTimeout(()=>{this.handleAsleep(s)},gt(this,vt)._++*this.config.delay))},10)}remove(l){const e=w(this,Ql)[l.id];e.hasOwnProperty("d10Instance")&&(w(this,Ql)[e.d10Instance.id].mesh&&(w(this,Ql)[e.d10Instance.id].mesh.dispose(),w(this,Ve).postMessage({action:"removeDie",id:e.d10Instance.id})),delete w(this,Ql)[e.d10Instance.id],gt(this,He)._--),w(this,Ql)[l.id].mesh&&w(this,Ql)[l.id].mesh.dispose(),delete w(this,Ql)[l.id],gt(this,He)._--,w(this,$l).render(),this.onDieRemoved(l.rollId)}updatesFromPhysics(l){this.diceBufferView=new Float32Array(l);let e=1;for(let t=0,a=this.diceBufferView[0];t<a;t++){if(!Object.keys(w(this,Ql)).length)continue;const s=w(this,Ql)[`${this.diceBufferView[e]}`];if(!s){console.log("Error: die not available in scene to animate");break}if(this.diceBufferView[e+1]===-1)this.handleAsleep(s);else{const d=this.diceBufferView[e+1],i=this.diceBufferView[e+2],c=this.diceBufferView[e+3],n=this.diceBufferView[e+4],h=this.diceBufferView[e+5],m=this.diceBufferView[e+6],o=this.diceBufferView[e+7];s.mesh.position.set(d,i,c),s.mesh.rotationQuaternion.set(n,h,m,o)}e=e+8}requestAnimationFrame(()=>{w(this,Ve).postMessage({action:"stepSimulation",diceBuffer:this.diceBufferView.buffer},[this.diceBufferView.buffer])})}async handleAsleep(l){var e,t;if(l.asleep=!0,await tt.getRollResult(l,w(this,$l)),l.d10Instance||l.dieParent){if((e=l==null?void 0:l.d10Instance)!=null&&e.asleep||(t=l==null?void 0:l.dieParent)!=null&&t.asleep){const a=l.config.sides===100?l:l.dieParent,s=l.config.sides===10?l:l.d10Instance;s.value===0&&a.value===0?a.value=100:a.value=a.value+s.value,this.onRollResult({rollId:a.config.rollId,value:a.value})}}else l.config.sides===10&&l.value===0&&(l.value=10),this.onRollResult({rollId:l.config.rollId,value:l.value});gt(this,He)._++}resize(l){const e=w(this,Je).width=l.width,t=w(this,Je).height=l.height;w(this,ma).create({aspect:e/t}),w(this,Ne).resize()}}Ql=new WeakMap,vt=new WeakMap,He=new WeakMap,kt=new WeakMap,Je=new WeakMap,Ne=new WeakMap,$l=new WeakMap,hs=new WeakMap,xe=new WeakMap,ma=new WeakMap,oa=new WeakMap,Ve=new WeakMap,ba=new WeakMap,ms=new WeakSet,fd=async function(Z){w(this,Ne).activeRenderLoops.length===0&&this.render(Z.newStartPoint);const l={...Z,assetPath:this.config.assetPath,enableShadows:this.config.enableShadows,scale:this.config.scale,lights:w(this,xe)},e=new tt(l,w(this,$l));return w(this,Ql)[e.id]=e,w(this,Ve).postMessage({action:"addDie",options:{sides:Z.sides,scale:this.config.scale,id:e.id,newStartPoint:Z.newStartPoint,theme:Z.theme,meshName:Z.meshName}}),Z.sides===100&&Z.data!=="single"&&(e.d10Instance=await tt.loadDie({...l,dieType:"d10",sides:10,id:e.id+1e4},w(this,$l)).then(t=>{const a=new tt(t,w(this,$l));return a.dieParent=e,a}),w(this,Ql)[`${e.d10Instance.id}`]=e.d10Instance,w(this,Ve).postMessage({action:"addDie",options:{sides:10,scale:this.config.scale,id:e.d10Instance.id,theme:Z.theme,meshName:Z.meshName}})),e};const Qh=Object.freeze(Object.defineProperty({__proto__:null,default:Bh},Symbol.toStringTag,{value:"Module"}));export{wh as i};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}